-------------------------0 sample_num
```sql
SELECT movie_title 
FROM movies 
WHERE movie_release_year = 1945 
ORDER BY movie_popularity DESC;
```
-------------------------1 sample_num
```sql
SELECT movie_title, movie_release_year, director_name 
FROM movies 
WHERE movie_popularity = (SELECT MAX(movie_popularity) FROM movies);
```
-------------------------2 sample_num
```sql
SELECT movie_title, movie_release_year 
FROM movies 
WHERE LENGTH(movie_title) = (SELECT MAX(LENGTH(movie_title)) FROM movies);
```
-------------------------3 sample_num
```sql
SELECT m.movie_title
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
GROUP BY m.movie_id
ORDER BY SUM(r.rating_score) DESC
LIMIT 1;
```
-------------------------4 sample_num
```sql
SELECT AVG(m.movie_popularity) AS average_users_loving_kubrick_movies
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.director_name = 'Stanley Kubrick';
```
-------------------------5 sample_num
```sql
SELECT AVG(r.rating_score) AS average_rating
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_title = 'When Will I Be Loved';
```
-------------------------6 sample_num
```sql
SELECT 
    ru.user_avatar_image_url, 
    m.movie_title 
FROM 
    ratings_users ru 
JOIN 
    ratings r ON ru.user_id = r.user_id 
JOIN 
    movies m ON r.movie_id = m.movie_id 
WHERE 
    ru.user_id = 41579158 
ORDER BY 
    r.rating_timestamp_utc DESC 
LIMIT 1;
```
-------------------------7 sample_num
```sql
SELECT 
    (SUM(CASE WHEN user_subscriber = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percent
FROM 
    ratings;
```
-------------------------8 sample_num
```sql
SELECT m.movie_title
FROM ratings r
JOIN ratings_users ru ON r.user_id = ru.user_id
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.rating_timestamp_utc LIKE '%2020-04-%' AND ru.user_trialist = 1;
```
-------------------------9 sample_num
```sql
SELECT r.user_id
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_title = 'Love Will Tear Us Apart' AND r.rating_score = 1;
```
-------------------------10 sample_num
```sql
SELECT m.movie_title, m.movie_popularity
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE r.rating_score = 5;
```
-------------------------11 sample_num
```sql
SELECT DISTINCT m.movie_title
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.rating_timestamp_utc LIKE '%2020%'
AND r.rating_score >= 4;
```
-------------------------12 sample_num
```sql
SELECT
    m.movie_title,
    r.user_id,
    r.rating_score,
    r.critic_comments
FROM
    movies m
JOIN
    ratings r ON m.movie_id = r.movie_id
WHERE
    r.critic IS NOT NULL;
```
-------------------------13 sample_num
```sql
SELECT
    (SUM(rating_score = 5) * 100.0 / COUNT(rating_score)) AS percentage_highest_score
FROM
    ratings r
JOIN
    movies m ON r.movie_id = m.movie_id
WHERE
    m.movie_title = 'Welcome to the Dollhouse';
```
-------------------------14 sample_num
```sql
SELECT
    (SUM(CASE WHEN m.movie_release_year = 2021 THEN 1 ELSE 0 END) * 100.0 / COUNT(r.rating_id)) AS percent
FROM
    ratings r
JOIN
    movies m ON r.movie_id = m.movie_id;
```
-------------------------15 sample_num
```sql
SELECT director_name
FROM movies
WHERE movie_title = 'Sex, Drink and Bloodshed';
```
-------------------------16 sample_num
```sql
SELECT list_title
FROM lists
ORDER BY list_followers DESC
LIMIT 1;
```
-------------------------17 sample_num
```sql
SELECT list_url
FROM lists
WHERE list_followers IN (1, 2)
AND list_update_timestamp_utc BETWEEN '2012-01-01' AND '2012-12-31';
```
-------------------------18 sample_num
```sql
SELECT list_id
FROM lists
WHERE user_id = 85981819
ORDER BY list_creation_timestamp_utc ASC
LIMIT 1;
```
-------------------------19 sample_num
```sql
SELECT COUNT(DISTINCT user_id)
FROM ratings
WHERE movie_id = 1269
  AND user_has_payment_method = 1
  AND user_eligible_for_trial = 1
  AND rating_score <= 2;
```
-------------------------20 sample_num
```sql
SELECT movie_title, movie_popularity
FROM movies
WHERE movie_release_year = 2021 AND director_name = 'Steven Spielberg';
```
-------------------------21 sample_num
```sql
SELECT movie_title, director_name, movie_release_year
FROM movies
WHERE movie_release_year = (SELECT MIN(movie_release_year) FROM movies);
```
-------------------------22 sample_num
```sql
SELECT DISTINCT lu.user_id
FROM lists_users lu
JOIN lists l ON lu.list_id = l.list_id
WHERE lu.user_subscriber = 1
AND lu.list_creation_date_utc BETWEEN DATE_SUB(CURDATE(), INTERVAL 10 YEAR) AND CURDATE()
GROUP BY lu.user_id
HAVING COUNT(DISTINCT YEAR(lu.list_creation_date_utc)) = 10;
```
-------------------------23 sample_num
```sql
SELECT COUNT(*)
FROM ratings
WHERE movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'Pavee Lackeen: The Traveller Girl')
AND rating_score = 4;
```
-------------------------24 sample_num
```sql
SELECT l.list_followers, lu.user_eligible_for_trial
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE l.list_title = 'World War 2 and Kids';
```
-------------------------25 sample_num
```sql
SELECT m.movie_release_year, r.user_id
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.director_name = 'Quentin Tarantino'
ORDER BY m.movie_release_year
LIMIT 1 OFFSET 2;
```
-------------------------26 sample_num
```sql
SELECT m.director_url
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.user_id = 2452551 AND r.critic_likes = 39;
```
-------------------------27 sample_num
```sql
SELECT AVG(r.rating_score) AS average_rating, m.director_name
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.movie_title = 'When Will I Be Loved'
GROUP BY m.director_name;
```
-------------------------28 sample_num
```sql
SELECT l.list_movie_number,
       CASE WHEN lu.user_has_payment_method = 1 THEN 'Paying Subscriber'
            ELSE 'Not a Paying Subscriber' END AS subscription_status
FROM lists l
JOIN lists_users lu ON l.user_id = lu.user_id AND l.list_id = lu.list_id
WHERE l.list_movie_number = (SELECT MAX(list_movie_number) FROM lists);
```
-------------------------29 sample_num
```sql
SELECT m.movie_title
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.critic_likes = (
    SELECT MAX(critic_likes)
    FROM ratings
    WHERE user_id = r.user_id AND movie_id = r.movie_id
)
```
-------------------------30 sample_num
```sql
SELECT
    m.movie_popularity,
    MIN(r.rating_timestamp_utc) AS first_rating_score_1_date
FROM
    movies m
JOIN
    ratings r ON m.movie_id = r.movie_id
WHERE
    m.movie_release_year BETWEEN 1920 AND 1929
    AND r.rating_score = 1
    AND r.user_has_payment_method = 1
GROUP BY
    m.movie_id
ORDER BY
    m.movie_popularity DESC
LIMIT 1;
```
-------------------------31 sample_num
```sql
SELECT COUNT(m.movie_id) AS movie_count,
       m.movie_title,
       MAX(r.critic_likes) AS max_critic_likes
FROM movies m
LEFT JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.director_name = 'Francis Ford Coppola'
  AND m.movie_popularity > 1000
GROUP BY m.movie_id, m.movie_title;
```
-------------------------32 sample_num
```sql
SELECT user_avatar_image_url
FROM ratings
WHERE movie_id = 1103 AND rating_score = 5 AND rating_date_utc = '2020-04-19';
```
-------------------------33 sample_num
```sql
SELECT l.list_id, l.list_title, l.list_followers, lu.user_subscriber
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE l.user_id = 4208563
ORDER BY l.list_followers DESC
LIMIT 1;
```
-------------------------34 sample_num
```sql
SELECT movie_release_year, movie_title
FROM movies
JOIN ratings ON movies.movie_id = ratings.movie_id
WHERE movie_release_year = (
    SELECT movie_release_year
    FROM movies
    GROUP BY movie_release_year
    ORDER BY COUNT(movie_id) ASC
    LIMIT 1
)
AND rating_score = '1'
GROUP BY movie_title
ORDER BY COUNT(rating_score) DESC
LIMIT 1;
```
-------------------------35 sample_num
```sql
SELECT COUNT(DISTINCT r.user_id) AS user_count
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_release_year = 1924
  AND m.director_name = 'Erich von Stroheim'
  AND r.rating_score = 5
  AND r.user_has_payment_method = 1;
```
-------------------------36 sample_num
```sql
SELECT AVG(list_movie_number) AS average_movies_added, user_avatar_image_url
FROM lists
JOIN ratings_users ON lists.user_id = ratings_users.user_id
WHERE lists.user_id = 8516503;
```
-------------------------37 sample_num
```sql
SELECT COUNT(DISTINCT r.user_id) AS user_count, r.rating_url
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_title = 'The Magnificent Ambersons' AND r.rating_score <= 2;
```
-------------------------38 sample_num
```sql
SELECT COUNT(DISTINCT lu.user_id) AS eligible_users,
       lu.user_id
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE l.list_creation_timestamp_utc BETWEEN '2016-02-01' AND '2016-02-29'
  AND lu.user_eligible_for_trial = 1
GROUP BY lu.user_id
ORDER BY MAX(l.list_followers) DESC
LIMIT 1;
```
-------------------------39 sample_num
```sql
SELECT rating_url
FROM ratings
WHERE movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'Riff-Raff')
AND user_id = 22030372
ORDER BY rating_score DESC
LIMIT 1;
```
-------------------------40 sample_num
```sql
SELECT d.director_name, m.movie_title
FROM (
    SELECT director_id, director_name, COUNT(movie_id) AS movie_count
    FROM movies
    WHERE movie_release_year BETWEEN 1960 AND 1985
    GROUP BY director_id, director_name
    HAVING COUNT(movie_id) >= 10
) AS d
JOIN movies AS m ON d.director_id = m.director_id
JOIN ratings AS r ON m.movie_id = r.movie_id
WHERE r.rating_score = 5
AND m.movie_release_year BETWEEN 1960 AND 1985
GROUP BY d.director_id, d.director_name
ORDER BY COUNT(r.rating_score) DESC
LIMIT 1;
```
-------------------------41 sample_num
```sql
SELECT COUNT(DISTINCT r.user_id) AS user_count
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_title = 'The South'
  AND r.user_trialist = 0
  AND r.rating_score < 2;
```
-------------------------42 sample_num
```sql
SELECT critic_likes
FROM ratings
WHERE movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'Apocalypse Now')
AND rating_score = '5';
```
-------------------------43 sample_num
```sql
SELECT AVG(r.rating_score) AS average_rating, m.director_name
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.movie_title = 'The Crowd'
GROUP BY m.director_name;
```
-------------------------44 sample_num
```sql
SELECT
    MIN(movies.movie_release_year) AS first_movie_release_year,
    ratings.user_id AS user_id_with_most_comments
FROM
    movies
JOIN
    (SELECT director_id, COUNT(*) AS movie_count
     FROM movies
     GROUP BY director_id
     ORDER BY movie_count DESC
     LIMIT 1) AS top_director ON movies.director_id = top_director.director_id
JOIN
    ratings ON movies.movie_id = ratings.movie_id
GROUP BY
    ratings.user_id
ORDER BY
    COUNT(ratings.critic_comments) DESC
LIMIT 1;
```
-------------------------45 sample_num
```sql
SELECT m.movie_title, MAX(r.rating_score) AS highest_rating_score
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.movie_popularity BETWEEN 400 AND 500
GROUP BY m.movie_title;
```
-------------------------46 sample_num
```sql
SELECT rating_url
FROM ratings
WHERE user_id = 45579900
AND movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'The Vertical Ray of the Sun')
AND critic_likes = '20';
```
-------------------------47 sample_num
```sql
SELECT
    m.movie_title,
    AVG(m.movie_popularity) AS average_popularity,
    COUNT(CASE WHEN r.rating_score = 5 THEN 1 END) AS five_star_count
FROM
    movies m
LEFT JOIN
    ratings r ON m.movie_id = r.movie_id
WHERE
    m.director_name = 'Christopher Nolan'
GROUP BY
    m.movie_title
ORDER BY
    five_star_count DESC
LIMIT 1;
```
-------------------------48 sample_num
```sql
SELECT m.movie_title, AVG(r.rating_score) AS average_rating_score
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
JOIN lists l ON l.user_id = r.user_id
WHERE r.rating_timestamp_utc BETWEEN '2013-01-01' AND '2013-12-31'
AND l.list_title = '100 Greatest Living American Filmmakers'
GROUP BY m.movie_title;
```
-------------------------49 sample_num
```sql
SELECT AVG(r.rating_score) AS average_rating_score, m.movie_release_year
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.movie_title = 'Pavee Lackeen: The Traveller Girl';
```
-------------------------50 sample_num
```sql
SELECT COUNT(*)
FROM lists
WHERE list_update_timestamp_utc > (list_creation_timestamp_utc + INTERVAL '10 years');
```
-------------------------51 sample_num
```sql
SELECT list_description
FROM lists
WHERE list_title = 'Short and pretty damn sweet';
```
-------------------------52 sample_num
```sql
SELECT list_url
FROM lists
WHERE list_title = 'Short and pretty damn sweet';
```
-------------------------53 sample_num
```sql
SELECT COUNT(*)
FROM lists
WHERE list_update_timestamp_utc > '2010-01-01'
AND list_followers > 200;
```
-------------------------54 sample_num
```sql
SELECT COUNT(*)
FROM lists
JOIN lists_users ON lists.list_id = lists_users.list_id
WHERE lists_users.user_id = 83373278 AND lists_users.user_subscriber = 1;
```
-------------------------55 sample_num
```sql
SELECT movie_release_year FROM movies WHERE movie_title = 'La Antena';
```
-------------------------56 sample_num
```sql
SELECT movie_url FROM movies WHERE movie_title = 'La Antena';
```
-------------------------57 sample_num
```sql
SELECT movie_title, movie_popularity
FROM movies
WHERE movie_title IN ('The General', 'Il grido')
ORDER BY movie_popularity DESC
LIMIT 1;
```
-------------------------58 sample_num
```sql
SELECT COUNT(*)
FROM movies
WHERE director_name = 'Hong Sang-soo';
```
-------------------------59 sample_num
```sql
SELECT lu.user_trialist
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE l.list_title = '250 Favourite Films';
```
-------------------------60 sample_num
```sql
SELECT list_title
FROM lists
WHERE user_id = 32172230
AND list_creation_timestamp_utc IN (
    SELECT list_creation_date_utc
    FROM lists_users
    WHERE user_id = 32172230
    AND user_eligible_for_trial = 1
);
```
-------------------------61 sample_num
```sql
SELECT COUNT(*)
FROM lists
WHERE user_id = 85981819
  AND list_movie_number > 100
  AND list_creation_timestamp_utc IN (
      SELECT list_creation_date_utc
      FROM lists_users
      WHERE user_id = 85981819
        AND user_has_payment_method = 1
  );
```
-------------------------62 sample_num
```sql
SELECT list_description
FROM lists
WHERE user_id = 85981819
ORDER BY list_followers DESC
LIMIT 1;
```
-------------------------63 sample_num
```sql
SELECT list_update_timestamp_utc
FROM lists
WHERE list_title = '250 Favourite Films';
```
-------------------------64 sample_num
```sql
SELECT l.user_avatar_image_url
FROM lists l
WHERE l.list_title = '250 Favourite Films';
```
-------------------------65 sample_num
```sql
SELECT COUNT(*) - 1 AS additional_lists_created
FROM lists
WHERE user_id = (SELECT user_id FROM lists WHERE list_title = '250 Favourite Films');
```
-------------------------66 sample_num
```sql
SELECT COUNT(DISTINCT user_id) AS users_liked
FROM ratings
WHERE movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'A Way of Life')
AND rating_score = 5;
```
-------------------------67 sample_num
```sql
SELECT r.critic, r.critic_likes, r.critic_comments
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_title = 'A Way of Life' AND r.user_id IS NOT NULL;
```
-------------------------68 sample_num
```sql
SELECT COUNT(DISTINCT critic)
FROM ratings
WHERE movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'Imitation of Life')
AND critic_likes > 1;
```
-------------------------69 sample_num
```sql
SELECT user_id
FROM ratings
WHERE movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'When Will I Be Loved')
AND critic_comments = 2;
```
-------------------------70 sample_num
```sql
SELECT rating_timestamp_utc
FROM ratings
JOIN movies ON ratings.movie_id = movies.movie_id
WHERE movies.movie_title = 'A Way of Life' AND ratings.user_id = 39115684;
```
-------------------------71 sample_num
```sql
SELECT r.rating_url
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.user_id = 39115684 AND m.movie_title = 'When Will I Be Loved';
```
-------------------------72 sample_num
```sql
SELECT user_trialist
FROM ratings
JOIN movies ON ratings.movie_id = movies.movie_id
WHERE movies.movie_title = 'A Way of Life'
AND ratings.user_id = 39115684;
```
-------------------------73 sample_num
```sql
SELECT COUNT(DISTINCT r.user_id) AS trialist_count
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_title = 'A Way of Life' AND r.user_trialist = 1;
```
-------------------------74 sample_num
```sql
SELECT rating_url
FROM ratings
WHERE movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'A Way of Life')
AND critic IS NOT NULL;
```
-------------------------75 sample_num
```sql
SELECT COUNT(DISTINCT r.user_id) AS user_count
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_popularity = (SELECT MAX(movie_popularity) FROM movies);
```
-------------------------76 sample_num
```sql
SELECT m.movie_title
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.user_id = 58149469 AND r.critic_likes = 1 AND r.critic_comments = 2;
```
-------------------------77 sample_num
```sql
SELECT COUNT(DISTINCT r.user_id) AS trialist_count
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_title = 'When Will I Be Loved'
  AND r.user_trialist = 1
  AND r.rating_score = 1;
```
-------------------------78 sample_num
```sql
SELECT COUNT(*)
FROM ratings
WHERE movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'A Way of Life')
AND rating_timestamp_utc > '2011-01-01';
```
-------------------------79 sample_num
```sql
SELECT r.rating_score
FROM ratings r
JOIN lists l ON l.user_id = r.user_id
WHERE l.list_title = '250 Favourite Films'
AND l.list_id IN (SELECT list_id FROM lists WHERE list_title = '250 Favourite Films')
AND r.movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'Innocence Unprotected');
```
-------------------------80 sample_num
```sql
SELECT m.movie_title
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
JOIN lists l ON l.list_id = r.list_id
WHERE l.list_title = '250 Favourite Films' AND l.user_id = r.user_id;
```
-------------------------81 sample_num
```sql
SELECT AVG(rating_score) AS average_rating_score
FROM ratings
JOIN movies ON ratings.movie_id = movies.movie_id
WHERE movies.movie_title = 'A Way of Life';
```
-------------------------82 sample_num
```sql
SELECT
    (COUNT(CASE WHEN r.rating_score = 1 THEN 1 END) * 100.0 / COUNT(r.rating_id)) AS percentage
FROM
    ratings r
JOIN
    movies m ON r.movie_id = m.movie_id
WHERE
    m.movie_title = 'When Will I Be Loved';
```
-------------------------83 sample_num
```sql
SELECT
    (SELECT AVG(rating_score)
     FROM ratings
     JOIN movies ON ratings.movie_id = movies.movie_id
     WHERE movies.movie_title = 'Innocence Unprotected') -
    (SELECT AVG(rating_score)
     FROM ratings
     JOIN movies ON ratings.movie_id = movies.movie_id
     WHERE movies.movie_title = 'When Will I Be Loved') AS average_rating_difference;
```
-------------------------84 sample_num
```sql
SELECT director_name
FROM movies
WHERE movie_title = 'Tokyo Eyes';
```
-------------------------85 sample_num
```sql
SELECT COUNT(*)
FROM movies
WHERE movie_release_year = 2007;
```
-------------------------86 sample_num
```sql
SELECT movie_title
FROM movies
WHERE movie_release_year = 2006
ORDER BY movie_popularity DESC
LIMIT 1;
```
-------------------------87 sample_num
```sql
SELECT COUNT(*)
FROM movies
WHERE director_name = 'Åke Sandgren';
```
-------------------------88 sample_num
```sql
SELECT movie_title
FROM movies
WHERE director_name = 'Álex de la Iclesia'
ORDER BY movie_popularity DESC
LIMIT 1;
```
-------------------------89 sample_num
```sql
SELECT movie_release_year FROM movies WHERE movie_title = 'Cops';
```
-------------------------90 sample_num
```sql
SELECT director_id FROM movies WHERE movie_title = "It's Winter";
```
-------------------------91 sample_num
```sql
SELECT user_id
FROM lists
WHERE list_followers = (SELECT MAX(list_followers) FROM lists);
```
-------------------------92 sample_num
```sql
SELECT list_title
FROM lists
ORDER BY list_comments DESC
LIMIT 1;
```
-------------------------93 sample_num
```sql
SELECT movie_title, MAX(rating_score) AS highest_score
FROM movies
JOIN ratings ON movies.movie_id = ratings.movie_id
WHERE movies.movie_release_year = 2008
GROUP BY movie_title
ORDER BY highest_score DESC
LIMIT 1;
```
-------------------------94 sample_num
```sql
SELECT movie_title
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
ORDER BY r.critic_likes DESC
LIMIT 3;
```
-------------------------95 sample_num
```sql
SELECT COUNT(DISTINCT l.user_id) AS user_count
FROM lists l
WHERE l.list_followers > 100 AND YEAR(l.list_creation_timestamp_utc) = 2009;
```
-------------------------96 sample_num
```sql
SELECT COUNT(DISTINCT user_id)
FROM ratings
WHERE movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'White Night Wedding')
AND rating_score = 5;
```
-------------------------97 sample_num
```sql
SELECT lu.user_cover_image_url
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE l.list_title = 'Georgia related films';
```
-------------------------98 sample_num
```sql
SELECT l.list_followers
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE lu.user_avatar_image_url = 'https://assets.mubicdn.net/images/avatars/74983/images-w150.jpg?1523895214';
```
-------------------------99 sample_num
```sql
SELECT m.movie_title
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE r.user_id = 94978 AND r.rating_score = 5;
```
-------------------------100 sample_num
```sql
SELECT m.movie_title
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.movie_release_year = 2003 AND r.user_id = 2941;
```
-------------------------101 sample_num
```sql
SELECT COUNT(DISTINCT r.user_id) AS non_trialist_users
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_title = 'Patti Smith: Dream of Life' AND r.user_trialist = 0;
```
-------------------------102 sample_num
```sql
SELECT m.movie_id, m.movie_title, AVG(r.rating_score) AS average_score
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
GROUP BY m.movie_id, m.movie_title
ORDER BY average_score DESC
LIMIT 1;
```
-------------------------103 sample_num
```sql
SELECT movie_title
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
ORDER BY r.critic_comments DESC
LIMIT 3;
```
-------------------------104 sample_num
```sql
SELECT l.list_title, lu.user_avatar_image_url
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE lu.user_id = 85981819
ORDER BY l.list_creation_timestamp_utc ASC
LIMIT 1;
```
-------------------------105 sample_num
```sql
SELECT m.movie_title
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.rating_timestamp_utc LIKE '2020%'
GROUP BY m.movie_title
ORDER BY COUNT(r.rating_id) DESC
LIMIT 1;
```
-------------------------106 sample_num
```sql
SELECT AVG(rating_score) AS average_score
FROM ratings
JOIN movies ON ratings.movie_id = movies.movie_id
WHERE movies.movie_title = 'Versailles Rive-Gauche';
```
-------------------------107 sample_num
```sql
SELECT m.movie_title
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.user_id = 59988436 AND r.critic_comments = 21;
```
-------------------------108 sample_num
```sql
SELECT m.movie_title
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE r.critic_likes > 20;
```
-------------------------109 sample_num
```sql
SELECT AVG(rating_score) AS average_score
FROM ratings
JOIN movies ON ratings.movie_id = movies.movie_id
WHERE movies.movie_title = 'The Fall of Berlin' AND YEAR(ratings.rating_timestamp_utc) = 2019;
```
-------------------------110 sample_num
```sql
SELECT (COUNT(CASE WHEN r.rating_score > 3 THEN 1 END) * 100.0 / COUNT(r.rating_score)) AS percentage
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_title = 'Patti Smith: Dream of Life';
```
-------------------------111 sample_num
```sql
SELECT m.movie_title, AVG(r.rating_score) AS average_score
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.director_name = 'Abbas Kiarostami'
GROUP BY m.movie_id, m.movie_title
ORDER BY average_score DESC
LIMIT 1;
```
-------------------------112 sample_num
```sql
SELECT movie_release_year
FROM movies
GROUP BY movie_release_year
ORDER BY COUNT(movie_id) DESC
LIMIT 1;
```
-------------------------113 sample_num
```sql
SELECT director_id
FROM movies
GROUP BY director_id
ORDER BY COUNT(movie_id) DESC
LIMIT 1;
```
-------------------------114 sample_num
```sql
SELECT COUNT(*)
FROM movies
WHERE director_id = (
    SELECT director_id
    FROM movies
    WHERE movie_popularity = (SELECT MAX(movie_popularity) FROM movies)
);
```
-------------------------115 sample_num
```sql
SELECT COUNT(DISTINCT user_id) AS paying_subscribers
FROM ratings
WHERE user_has_payment_method = 1 AND rating_timestamp_utc > '2014-01-01';
```
-------------------------116 sample_num
```sql
SELECT l.user_id
FROM lists l
JOIN ratings_users ru ON l.user_id = ru.user_id
WHERE l.list_followers = 0
ORDER BY l.list_creation_timestamp_utc ASC
LIMIT 1;
```
-------------------------117 sample_num
```sql
SELECT lu.user_id, lu.user_subscriber AS number_of_followers
FROM lists_users lu
GROUP BY lu.user_id
ORDER BY COUNT(lu.list_id) DESC
LIMIT 1;
```
-------------------------118 sample_num
```sql
SELECT list_followers
FROM lists
WHERE list_title = 'Non-American Films about World War II';
```
-------------------------119 sample_num
```sql
SELECT COUNT(DISTINCT user_id)
FROM ratings
WHERE movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'Downfall')
AND rating_score = 4;
```
-------------------------120 sample_num
```sql
SELECT m.movie_title
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.rating_score = 5
GROUP BY m.movie_title
ORDER BY COUNT(r.rating_id) DESC
LIMIT 1;
```
-------------------------121 sample_num
```sql
SELECT movie_title
FROM movies
JOIN ratings ON movies.movie_id = ratings.movie_id
ORDER BY critic_comments DESC
LIMIT 1;
```
-------------------------122 sample_num
```sql
SELECT user_avatar_image_url
FROM ratings
WHERE rating_timestamp_utc = '2019/10/17 1:36:36';
```
-------------------------123 sample_num
```sql
SELECT lu.user_avatar_image_url
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE l.list_title = 'Vladimir Vladimirovich Nabokov';
```
-------------------------124 sample_num
```sql
SELECT lu.user_id, lu.user_has_payment_method
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE l.list_movie_number = (SELECT MAX(list_movie_number) FROM lists)
LIMIT 1;
```
-------------------------125 sample_num
```sql
SELECT user_avatar_image_url
FROM ratings
WHERE rating_score = 5
GROUP BY user_id
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------126 sample_num
```sql
SELECT COUNT(critic) AS critic_count
FROM ratings
WHERE movie_id = (
    SELECT movie_id
    FROM movies
    ORDER BY movie_popularity DESC
    LIMIT 1
);
```
-------------------------127 sample_num
```sql
SELECT user_id
FROM ratings
WHERE rating_score = 4
  AND movie_id = (SELECT movie_id FROM movies WHERE movie_title = 'Freaks')
  AND rating_timestamp_utc = '2013-05-04 06:33:32';
```
-------------------------128 sample_num
```sql
SELECT movie_url
FROM ratings
JOIN movies ON ratings.movie_id = movies.movie_id
WHERE rating_score = 5 AND rating_timestamp_utc = '2013-05-03 05:11:17';
```
-------------------------129 sample_num
```sql
SELECT COUNT(*)
FROM ratings
WHERE movie_id = (
    SELECT movie_id
    FROM movies
    WHERE movie_release_year = '1998'
    ORDER BY movie_popularity DESC
    LIMIT 1
) AND rating_score = 4;
```
-------------------------130 sample_num
```sql
SELECT m.movie_id, m.movie_title, COUNT(r.rating_id) AS rating_count
FROM movies m
LEFT JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.movie_popularity > 13000
GROUP BY m.movie_id, m.movie_title
ORDER BY rating_count ASC
LIMIT 1;
```
-------------------------131 sample_num
```sql
SELECT COUNT(DISTINCT r.user_id) AS paying_subscriber_count
FROM ratings r
JOIN ratings_users ru ON r.user_id = ru.user_id
WHERE r.movie_id = 'One Flew Over the Cuckoo''s Nest' AND ru.user_has_payment_method = 1;
```
-------------------------132 sample_num
```sql
SELECT COUNT(DISTINCT l.user_id) AS paying_subscriber_count
FROM lists l
JOIN ratings_users ru ON l.user_id = ru.user_id
WHERE l.list_followers > 3000 AND ru.user_has_payment_method = 1;
```
-------------------------133 sample_num
```sql
SELECT m.movie_title, COUNT(r.rating_id) AS total_ratings
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.movie_release_year = '1988'
GROUP BY m.movie_id
ORDER BY total_ratings DESC
LIMIT 1;
```
-------------------------134 sample_num
```sql
SELECT COUNT(*) AS low_ratings_count
FROM ratings
WHERE movie_id = (
    SELECT movie_id
    FROM movies
    WHERE movie_release_year = '1995'
    ORDER BY movie_popularity DESC
    LIMIT 1
) AND rating_score < 3;
```
-------------------------135 sample_num
```sql
SELECT
    (COUNT(CASE WHEN r.rating_score = 5 THEN 1 END) * 100.0 / COUNT(r.rating_score)) AS percentage
FROM
    ratings r
JOIN
    movies m ON r.movie_id = m.movie_id
WHERE
    m.movie_title = 'Go Go Tales';
```
-------------------------136 sample_num
```sql
SELECT
    (COUNT(CASE WHEN r.user_subscriber = 1 THEN 1 END) * 100.0 / COUNT(r.user_subscriber)) AS subscriber_rating_percentage
FROM
    ratings r
JOIN
    movies m ON r.movie_id = m.movie_id
WHERE
    m.movie_title = 'G.I. Jane';
```
-------------------------137 sample_num
```sql
SELECT
    (COUNT(CASE WHEN r.user_has_payment_method = 1 THEN 1 END) * 100.0 / COUNT(*)) AS subscriber_percentage
FROM
    ratings r
JOIN
    movies m ON r.movie_id = m.movie_id
WHERE
    m.movie_title = 'A Shot in the Dark';
```
-------------------------138 sample_num
```sql
SELECT list_title
FROM lists
WHERE user_id = 4208563;
```
-------------------------139 sample_num
```sql
SELECT list_id, list_title, MAX(list_update_timestamp_utc) AS most_recent_update
FROM lists
WHERE list_creation_timestamp_utc LIKE '2016%'
GROUP BY list_id, list_title
ORDER BY most_recent_update DESC
LIMIT 1;
```
-------------------------140 sample_num
```sql
SELECT
    (COUNT(CASE WHEN user_subscriber = 1 THEN 1 END) * 100.0 / COUNT(list_id)) AS subscriber_percentage
FROM
    lists_users
JOIN
    lists ON lists_users.list_id = lists.list_id;
```
-------------------------141 sample_num
```sql
SELECT l.list_title
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE lu.user_subscriber = 1;
```
-------------------------142 sample_num
```sql
SELECT l.list_title
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE lu.user_eligible_for_trial = 1;
```
-------------------------143 sample_num
```sql
SELECT COUNT(*) AS subscriber_lists_count
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE l.list_followers >= 1 AND lu.user_subscriber = 1;
```
-------------------------144 sample_num
```sql
SELECT AVG(list_followers) AS average_followers
FROM lists
WHERE list_movie_number > 200;
```
-------------------------145 sample_num
```sql
SELECT l.list_title
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE lu.user_subscriber = 1 AND l.list_movie_number < 50;
```
-------------------------146 sample_num
```sql
SELECT list_title,
       CURRENT_TIMESTAMP - MIN(list_update_timestamp_utc) AS time_since_last_update
FROM lists
GROUP BY list_title
ORDER BY MIN(list_update_timestamp_utc) ASC
LIMIT 1;
```
-------------------------147 sample_num
```sql
SELECT lu.user_id, lu.user_subscriber
FROM lists l
JOIN lists_users lu ON l.list_id = lu.list_id
WHERE l.list_title = 'Sound and Vision';
```
-------------------------148 sample_num
```sql
SELECT list_title,
       SUBTRACT(CURRENT_TIMESTAMP, list_creation_timestamp_utc) AS creation_duration
FROM lists
WHERE list_followers > 200;
```
-------------------------149 sample_num
```sql
SELECT
    (COUNT(m.movie_id) - COUNT(r.movie_id)) * 100.0 / COUNT(m.movie_id) AS percentage_unrated
FROM
    movies m
LEFT JOIN
    ratings r ON m.movie_id = r.movie_id
WHERE
    m.movie_id IN (SELECT movie_id FROM lists WHERE list_id = :list_id);
```
-------------------------150 sample_num
```sql
SELECT m.movie_title, r.rating_timestamp_utc AS rating_date, r.rating_score
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.user_id = 39115684;
```
-------------------------151 sample_num
```sql
SELECT COUNT(*)
FROM movies
WHERE movie_release_year BETWEEN 1970 AND 1980
AND movie_popularity > 11000;
```
-------------------------152 sample_num
```sql
SELECT COUNT(*)
FROM movies
WHERE director_name = 'Felipe Cazals' AND movie_release_year = 1976;
```
-------------------------153 sample_num
```sql
SELECT director_url
FROM movies
WHERE movie_title = 'Red Blooded American Girl';
```
-------------------------154 sample_num
```sql
SELECT list_title
FROM lists
ORDER BY list_update_timestamp_utc DESC
LIMIT 1;
```
-------------------------155 sample_num
```sql
SELECT user_id
FROM lists
WHERE list_comments = 142;
```
-------------------------156 sample_num
```sql
SELECT m.movie_title, AVG(r.rating_score) AS average_rating_score
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.director_name = 'Jeannot Szwarc'
GROUP BY m.movie_id, m.movie_title
ORDER BY m.movie_popularity DESC
LIMIT 1;
```
-------------------------157 sample_num
```sql
SELECT director_name, COUNT(T1.movie_id) AS movie_count, MAX(T2.rating_score) AS highest_rating
FROM movies T1
LEFT JOIN ratings T2 ON T1.movie_id = T2.movie_id
WHERE T1.movie_release_year BETWEEN 1970 AND 1979
GROUP BY director_name
HAVING COUNT(T1.movie_id) = (
    SELECT MAX(movie_count)
    FROM (
        SELECT COUNT(movie_id) AS movie_count
        FROM movies
        WHERE movie_release_year BETWEEN 1970 AND 1979
        GROUP BY director_id
    ) AS subquery
);
```
-------------------------158 sample_num
```sql
SELECT COUNT(DISTINCT lu.user_id) AS trialist_users
FROM lists_users lu
JOIN ratings r ON lu.user_id = r.user_id
JOIN movies m ON r.movie_id = m.movie_id
WHERE lu.user_trialist = 1
  AND r.rating_score = 3
  AND m.movie_title = 'The Secret Life of Words'
  AND r.rating_timestamp_utc BETWEEN '2010-01-01' AND '2020-12-31';
```
-------------------------159 sample_num
```sql
SELECT m.movie_title, r.rating_url
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.critic_likes = (SELECT MAX(critic_likes) FROM ratings);
```
-------------------------160 sample_num
```sql
SELECT m.movie_id, m.movie_title, m.movie_release_year, m.movie_popularity, COUNT(r.rating_id) AS five_star_ratings
FROM movies m
LEFT JOIN ratings r ON m.movie_id = r.movie_id AND r.rating_score = 5
WHERE m.movie_release_year >= 2000
GROUP BY m.movie_id, m.movie_title, m.movie_release_year, m.movie_popularity
ORDER BY m.movie_popularity DESC
LIMIT 5;
```
-------------------------161 sample_num
```sql
SELECT AVG(l.list_followers) AS average_followers
FROM lists l
JOIN ratings r ON l.user_id = r.user_id
JOIN movies m ON r.movie_id = m.movie_id
WHERE m.movie_title = 'Pavee Lackeen: The Traveller Girl'
AND r.rating_timestamp_utc = '2011-03-27 02:06:34';
```
-------------------------162 sample_num
```sql
SELECT COUNT(DISTINCT r.user_id) AS eligible_users_count, m.movie_image_url
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.rating_timestamp_utc BETWEEN '2017-01-01 00:00:00' AND '2017-12-31 00:00:00'
AND r.user_eligible_for_trial = 1
AND m.movie_title = 'Patti Smith: Dream of Life';
```
-------------------------163 sample_num
```sql
SELECT
    AVG(list_movie_number) AS average_movies_added,
    COUNT(CASE WHEN rating_score = 5 THEN 1 END) AS movies_rated_5
FROM
    lists
LEFT JOIN
    ratings ON lists.user_id = ratings.user_id
WHERE
    lists.user_id = 8516503;
```
-------------------------164 sample_num
```sql
SELECT m.director_name, m.movie_release_year, AVG(r.rating_score) AS average_rating_score
FROM movies m
JOIN ratings r ON m.movie_id = r.movie_id
WHERE m.movie_popularity = (SELECT MAX(movie_popularity) FROM movies)
AND r.user_trialist = 1
GROUP BY m.director_name, m.movie_release_year;
```
-------------------------165 sample_num
```sql
SELECT m.movie_title
FROM ratings r
JOIN movies m ON r.movie_id = m.movie_id
WHERE r.user_id = 57756708
AND r.rating_timestamp_utc = (SELECT MAX(rating_timestamp_utc) FROM ratings WHERE user_id = 57756708);
```
-------------------------166 sample_num
```sql
SELECT
    M.movie_title,
    M.movie_release_year,
    M.director_name,
    AVG(R.rating_score) AS average_rating_score
FROM
    movies M
LEFT JOIN
    ratings R ON M.movie_id = R.movie_id
GROUP BY
    M.movie_id, M.movie_title, M.movie_release_year, M.director_name
ORDER BY
    M.movie_release_year ASC
LIMIT 10;
```
-------------------------167 sample_num
```sql
SELECT ord_date, SUM(qty) AS total_order_quantity
FROM sales
GROUP BY ord_date
ORDER BY total_order_quantity DESC
LIMIT 1;
```
-------------------------168 sample_num
```sql
SELECT title_id
FROM sales
WHERE YEAR(ord_date) = 1992
GROUP BY title_id
ORDER BY SUM(qty) DESC
LIMIT 1;
```
-------------------------169 sample_num
```sql
SELECT t.title, t.price, t.pubdate
FROM titles t
JOIN sales s ON t.title_id = s.title_id
WHERE s.payterms = 'ON invoice';
```
-------------------------170 sample_num
```sql
SELECT title
FROM titles
JOIN roysched ON titles.title_id = roysched.title_id
WHERE roysched.royalty >= 10 AND roysched.lorange <> 0;
```
-------------------------171 sample_num
```sql
SELECT t.title, ta.royaltyper
FROM titles t
JOIN roysched r ON t.title_id = r.title_id
JOIN titleauthor ta ON t.title_id = ta.title_id
WHERE t.title_id = 'BU2075' AND r.lorange > 10000 AND r.hirange < 50000;
```
-------------------------172 sample_num
```sql
SELECT t.title, r.lorange
FROM titles t
JOIN roysched r ON t.title_id = r.title_id
ORDER BY r.royalty DESC
LIMIT 1;
```
-------------------------173 sample_num
```sql
SELECT titles.title, publishers.pub_name
FROM titles
JOIN publishers ON titles.pub_id = publishers.pub_id
WHERE publishers.country = 'USA';
```
-------------------------174 sample_num
```sql
SELECT r.royalty
FROM titles t
JOIN roysched r ON t.title_id = r.title_id
WHERE t.ytd_sales = (SELECT MAX(ytd_sales) FROM titles WHERE ytd_sales < 20000);
```
-------------------------175 sample_num
```sql
SELECT titles.title, titles.notes, publishers.pub_name
FROM titles
JOIN publishers ON titles.pub_id = publishers.pub_id
WHERE YEAR(titles.pubdate) = 1991;
```
-------------------------176 sample_num
```sql
SELECT t.title
FROM titles t
JOIN sales s ON t.title_id = s.title_id
JOIN stores st ON s.stor_id = st.stor_id
WHERE s.qty > 20 AND st.state = 'CA';
```
-------------------------177 sample_num
```sql
SELECT stor_id, MAX(qty) AS highest_quantity
FROM sales
GROUP BY stor_id
ORDER BY highest_quantity DESC
LIMIT 1;

SELECT title_id, MIN(qty) AS least_quantity
FROM sales
WHERE stor_id = (SELECT stor_id
                 FROM sales
                 GROUP BY stor_id
                 ORDER BY SUM(qty) DESC
                 LIMIT 1)
GROUP BY title_id;
```
-------------------------178 sample_num
```sql
SELECT t.title, p.pub_name, r.royalty
FROM titles t
JOIN publishers p ON t.pub_id = p.pub_id
JOIN roysched r ON t.title_id = r.title_id
WHERE t.title_id = 'BU 2075';
```
-------------------------179 sample_num
```sql
SELECT stor_name,
       (SUM(CASE WHEN payterms = 'Net 30' THEN qty ELSE 0 END) * 100.0 / SUM(qty)) AS percentage_net_30
FROM stores
JOIN sales ON stores.stor_id = sales.stor_id
WHERE stores.stor_id = '7066'
GROUP BY stor_name;
```
-------------------------180 sample_num
```sql
SELECT pub_name, AVG(ytd_sales) AS average_ytd_sales
FROM publishers
JOIN titles ON publishers.pub_id = titles.pub_id
WHERE publishers.pub_id = 877;
```
-------------------------181 sample_num
```sql
SELECT fname, minit, lname
FROM employee
WHERE YEAR(hire_date) < 1990;
```
-------------------------182 sample_num
```sql
SELECT fname, lname, hire_date
FROM employee
WHERE job_lvl = (SELECT MIN(job_lvl) FROM employee);
```
-------------------------183 sample_num
```sql
SELECT YEAR(hire_date) AS hire_year, COUNT(emp_id) AS employee_count
FROM employee
GROUP BY YEAR(hire_date)
ORDER BY employee_count DESC
LIMIT 1;
```
-------------------------184 sample_num
```sql
SELECT e.emp_id, e.fname, e.lname, e.job_id, e.job_lvl
FROM employee e
JOIN jobs j ON e.job_id = j.job_id
WHERE e.job_lvl = j.max_lvl;
```
-------------------------185 sample_num
```sql
SELECT e.fname, e.lname, e.hire_date
FROM employee e
JOIN jobs j ON e.job_id = j.job_id
WHERE j.job_desc = 'Chief Executive Officer';
```
-------------------------186 sample_num
```sql
SELECT e.fname, e.lname, p.pub_name
FROM employee e
JOIN publishers p ON e.pub_id = p.pub_id
WHERE p.country != 'USA';
```
-------------------------187 sample_num
```sql
SELECT e.fname, e.lname, j.job_desc
FROM employee e
JOIN jobs j ON e.job_id = j.job_id
JOIN publishers p ON e.pub_id = p.pub_id
WHERE p.pub_name = 'GGG&G';
```
-------------------------188 sample_num
```sql
SELECT p.pub_name, t.type
FROM publishers p
JOIN titles t ON p.pub_id = t.pub_id
ORDER BY p.pub_name;
```
-------------------------189 sample_num
```sql
SELECT pub_name
FROM publishers
JOIN titles ON publishers.pub_id = titles.pub_id
WHERE YEAR(pubdate) = 1991
GROUP BY publishers.pub_id, pub_name
ORDER BY COUNT(titles.title_id) DESC
LIMIT 1;
```
-------------------------190 sample_num
```sql
SELECT title
FROM titles
WHERE pub_id = (SELECT pub_id FROM publishers WHERE pub_name = 'Binnet & Hardley')
ORDER BY price DESC
LIMIT 1;
```
-------------------------191 sample_num
```sql
SELECT e.fname, e.lname, j.job_desc
FROM employee e
JOIN jobs j ON e.job_id = j.job_id
WHERE e.job_lvl > 200;
```
-------------------------192 sample_num
```sql
SELECT a.au_lname, a.au_fname
FROM authors a
JOIN titleauthor ta ON a.au_id = ta.au_id
JOIN titles t ON ta.title_id = t.title_id
WHERE t.type = 'business';
```
-------------------------193 sample_num
```sql
SELECT t.title, t.ytd_sales
FROM titles t
JOIN titleauthor ta ON t.title_id = ta.title_id
JOIN authors a ON ta.au_id = a.au_id
WHERE a.contract = 0;
```
-------------------------194 sample_num
```sql
SELECT t.title
FROM authors a
JOIN titleauthor ta ON a.au_id = ta.au_id
JOIN titles t ON ta.title_id = t.title_id
WHERE a.state = 'CA' AND a.contract = 0
ORDER BY t.ytd_sales DESC
LIMIT 1;
```
-------------------------195 sample_num
```sql
SELECT a.au_fname, a.au_lname
FROM authors a
JOIN titleauthor ta ON a.au_id = ta.au_id
JOIN titles t ON ta.title_id = t.title_id
WHERE t.title = 'Sushi, Anyone?' AND a.contract = 1;
```
-------------------------196 sample_num
```sql
SELECT (COUNT(CASE WHEN j.job_desc IN ('Editor', 'Designer') THEN 1 END) * 100.0) / COUNT(e.emp_id) AS percentage
FROM employee e
JOIN jobs j ON e.job_id = j.job_id;
```
-------------------------197 sample_num
```sql
SELECT t.title
FROM titles t
JOIN publishers p ON t.pub_id = p.pub_id
WHERE t.ytd_sales > (SELECT AVG(ytd_sales) FROM titles)
ORDER BY p.pub_name;
```
-------------------------198 sample_num
```sql
SELECT COUNT(*) FROM publishers WHERE country = 'USA';
```
-------------------------199 sample_num
```sql
SELECT * FROM publishers WHERE pub_name = 'New Moon Books';
```
-------------------------200 sample_num
```sql
SELECT e.fname
FROM employee e
JOIN jobs j ON e.job_id = j.job_id
WHERE j.job_desc = 'Managing Editor';
```
-------------------------201 sample_num
```sql
SELECT MAX(job_lvl)
FROM employee
WHERE hire_date = (SELECT MIN(hire_date) FROM employee);
```
-------------------------202 sample_num
```sql
SELECT city
FROM stores
WHERE stor_id = (
    SELECT stor_id
    FROM sales
    GROUP BY stor_id
    ORDER BY SUM(qty) DESC
    LIMIT 1
);
```
-------------------------203 sample_num
```sql
SELECT t.price
FROM titles t
JOIN sales s ON t.title_id = s.title_id
GROUP BY t.title_id
ORDER BY SUM(s.qty) DESC
LIMIT 1;
```
-------------------------204 sample_num
```sql
SELECT DISTINCT s.stor_name
FROM stores s
JOIN sales sa ON s.stor_id = sa.stor_id
JOIN titles t ON sa.title_id = t.title_id
WHERE t.title = 'Life Without Fear';
```
-------------------------205 sample_num
```sql
SELECT COUNT(DISTINCT s.stor_id)
FROM stores s
JOIN sales sa ON s.stor_id = sa.stor_id
JOIN titles t ON sa.title_id = t.title_id
WHERE t.title = 'Life Without Fear' AND s.state = 'Massachusetts';
```
-------------------------206 sample_num
```sql
SELECT p.country
FROM publishers p
JOIN titles t ON p.pub_id = t.pub_id
WHERE t.title = 'Life Without Fear';
```
-------------------------207 sample_num
```sql
SELECT p.pub_name
FROM publishers p
JOIN titles t ON p.pub_id = t.pub_id
WHERE t.price = (SELECT MAX(price) FROM titles);
```
-------------------------208 sample_num
```sql
SELECT COUNT(DISTINCT p.pub_id)
FROM publishers p
JOIN titles t ON p.pub_id = t.pub_id
WHERE p.country = 'USA' AND t.price > 15;
```
-------------------------209 sample_num
```sql
SELECT t.title, t.price, t.pubdate, SUM(s.qty) AS total_sales
FROM titles t
JOIN sales s ON t.title_id = s.title_id
GROUP BY t.title_id
ORDER BY total_sales DESC
LIMIT 3;
```
-------------------------210 sample_num
```sql
SELECT SUM(s.qty) AS total_books_ordered
FROM sales s
JOIN titles t ON s.title_id = t.title_id
JOIN stores st ON s.stor_id = st.stor_id
WHERE t.type = 'business' AND st.state = 'MA';
```
-------------------------211 sample_num
```sql
SELECT AVG(qty) AS average_quantity
FROM sales
JOIN titles ON sales.title_id = titles.title_id
WHERE titles.title = 'Life Without Fear';
```
-------------------------212 sample_num
```sql
SELECT
    MAX(j.max_lvl) - AVG(e.job_lvl) AS levels_between
FROM
    jobs j
JOIN
    employee e ON j.job_id = e.job_id
WHERE
    j.job_desc = 'Managing Editor';
```
-------------------------213 sample_num
```sql
SELECT title, MIN(price) AS cheapest_price
FROM titles
WHERE type = 'business'
GROUP BY title
ORDER BY cheapest_price
LIMIT 1;
```
-------------------------214 sample_num
```sql
SELECT type
FROM titles
WHERE advance = (SELECT MAX(advance) FROM titles);
```
-------------------------215 sample_num
```sql
SELECT r.royalty
FROM sales s
JOIN titles t ON s.title_id = t.title_id
JOIN roysched r ON t.title_id = r.title_id
WHERE s.qty = (SELECT MAX(qty) FROM sales);
```
-------------------------216 sample_num
```sql
SELECT job_lvl FROM employee WHERE lname = 'O''Rourke';
```
-------------------------217 sample_num
```sql
SELECT emp_id
FROM employee
WHERE job_lvl = (SELECT MAX(job_lvl) FROM employee)
AND minit IS NULL;
```
-------------------------218 sample_num
```sql
SELECT a.contract
FROM authors a
JOIN titleauthor ta ON a.au_id = ta.au_id
JOIN titles t ON ta.title_id = t.title_id
WHERE t.title = 'Sushi, Anyone?';
```
-------------------------219 sample_num
```sql
SELECT CONCAT(e.fname, ' ', e.lname) AS full_name
FROM employee e
JOIN publishers p ON e.pub_id = p.pub_id
WHERE e.job_lvl = (SELECT MAX(job_lvl) FROM employee);
```
-------------------------220 sample_num
```sql
SELECT j.job_desc
FROM employee e
JOIN jobs j ON e.job_id = j.job_id
WHERE e.fname = 'Pedro' AND e.lname = 'Afonso';
```
-------------------------221 sample_num
```sql
SELECT j.max_lvl - e.job_lvl AS levels_left
FROM employee e
JOIN jobs j ON e.job_id = j.job_id
WHERE e.fname = 'Diego' AND e.lname = 'Roel';
```
-------------------------222 sample_num
```sql
SELECT t.notes
FROM sales s
JOIN titles t ON s.title_id = t.title_id
WHERE s.ord_date = '1994-09-14';
```
-------------------------223 sample_num
```sql
SELECT t.type
FROM sales s
JOIN titles t ON s.title_id = t.title_id
WHERE s.ord_date = '1993-05-29';
```
-------------------------224 sample_num
```sql
SELECT * FROM publishers WHERE country = 'France';
```
-------------------------225 sample_num
```sql
SELECT p.pub_name
FROM titles t
JOIN publishers p ON t.pub_id = p.pub_id
WHERE t.title = 'Silicon Valley Gastronomic Treats';
```
-------------------------226 sample_num
```sql
SELECT e.city
FROM employee e
JOIN authors a ON e.fname = a.au_fname AND e.lname = a.au_lname
WHERE a.au_fname = 'Victoria' AND a.au_lname = 'Ashworth';
```
-------------------------227 sample_num
```sql
SELECT COUNT(ord_num) AS total_sales
FROM sales
WHERE stor_id IN (
    SELECT stor_id
    FROM stores
    WHERE city = 'Remulade'
);
```
-------------------------228 sample_num
```sql
SELECT
    (SUM(CASE WHEN s.city = 'Fremont' THEN s.qty ELSE 0 END) -
     SUM(CASE WHEN s.city = 'Portland' THEN s.qty ELSE 0 END)) * 100.0 /
    NULLIF(SUM(CASE WHEN s.city = 'Fremont' THEN s.qty ELSE 0 END), 0) AS percent_more
FROM
    sales s
JOIN
    stores st ON s.stor_id = st.stor_id
WHERE
    YEAR(s.ord_date) = 1993;
```
-------------------------229 sample_num
```sql
SELECT
    100 * (SUM(CASE WHEN j.job_desc = 'publisher' THEN 1 ELSE 0 END) -
            SUM(CASE WHEN j.job_desc = 'designer' THEN 1 ELSE 0 END)) /
    NULLIF(SUM(CASE WHEN j.job_desc = 'designer' THEN 1 ELSE 0 END), 0) AS percent_more
FROM
    employee e
JOIN
    jobs j ON e.job_id = j.job_id;
```
-------------------------230 sample_num
```sql
SELECT CONCAT(fname, ' ', lname) AS full_name
FROM employee
WHERE YEAR(hire_date) BETWEEN 1990 AND 1995
ORDER BY job_lvl DESC;
```
-------------------------231 sample_num
```sql
SELECT title, type, price
FROM titles
WHERE royalty > (SELECT AVG(royalty) FROM titles);
```
-------------------------232 sample_num
```sql
SELECT t.title, t.type, t.price
FROM titles t
JOIN sales s ON t.title_id = s.title_id
WHERE YEAR(s.ord_date) = 1994
GROUP BY t.title_id
HAVING SUM(s.ord_num) < (SELECT AVG(order_qty)
                          FROM (SELECT SUM(ord_num) AS order_qty
                                FROM sales
                                WHERE YEAR(ord_date) = 1994
                                GROUP BY title_id) AS avg_orders);
```
-------------------------233 sample_num
```sql
SELECT title, type, price
FROM titles
WHERE pub_id = (SELECT pub_id FROM publishers WHERE pub_name = 'New Moon Books')
ORDER BY price ASC;
```
-------------------------234 sample_num
```sql
SELECT t.title, t.royalty
FROM titles t
JOIN publishers p ON t.pub_id = p.pub_id
WHERE p.country = 'USA'
ORDER BY t.royalty DESC;
```
-------------------------235 sample_num
```sql
SELECT
    (SELECT AVG(royalty)
     FROM titles t
     JOIN publishers p ON t.pub_id = p.pub_id
     WHERE p.country = 'USA') -
    (SELECT AVG(royalty)
     FROM titles t
     JOIN publishers p ON t.pub_id = p.pub_id
     WHERE p.country != 'USA') AS royalty_difference;
```
-------------------------236 sample_num
```sql
SELECT
    (SELECT AVG(job_lvl) FROM employee e
     JOIN publishers p ON e.pub_id = p.pub_id
     JOIN jobs j ON e.job_id = j.job_id
     WHERE j.job_desc = 'Marketing manager' AND p.country = 'USA') -
    (SELECT AVG(job_lvl) FROM employee e
     JOIN publishers p ON e.pub_id = p.pub_id
     JOIN jobs j ON e.job_id = j.job_id
     WHERE j.job_desc = 'Marketing manager' AND p.country != 'USA') AS avg_level_difference;
```
-------------------------237 sample_num
```sql
SELECT t.title, p.pub_name, t.price
FROM titles t
JOIN publishers p ON t.pub_id = p.pub_id
WHERE t.notes LIKE '%helpful hints on how to use your electronic resources%';
```
-------------------------238 sample_num
```sql
SELECT t.title, p.state, t.ytd_sales
FROM titles t
JOIN publishers p ON t.pub_id = p.pub_id
WHERE t.notes LIKE '%Carefully researched study of the effects of strong emotions on the body%';
```
-------------------------239 sample_num
```sql
SELECT t.title, SUM(s.qty) AS total_sales
FROM titles t
JOIN sales s ON t.title_id = s.title_id
JOIN stores st ON s.stor_id = st.stor_id
WHERE st.state = 'CA'
GROUP BY t.title
HAVING SUM(s.qty) > (SELECT AVG(qty) FROM sales WHERE stor_id IN (SELECT stor_id FROM stores WHERE state = 'CA'))
ORDER BY total_sales DESC
LIMIT 5;
```
-------------------------240 sample_num
```sql
SELECT "Date received"
FROM callcenterlogs
WHERE ser_time = (SELECT MAX(ser_time) FROM callcenterlogs);
```
-------------------------241 sample_num
```sql
SELECT MIN(ser_start) AS earliest_complaint_start
FROM callcenterlogs
WHERE "Date received" = '2017-03-22';
```
-------------------------242 sample_num
```sql
SELECT Complaint_ID, MAX(priority) AS Urgency
FROM callcenterlogs
WHERE Complaint_ID IN ('CR2400594', 'CR2405641')
GROUP BY Complaint_ID
ORDER BY Urgency DESC
LIMIT 1;
```
-------------------------243 sample_num
```sql
SELECT CONCAT(first, ' ', middle, ' ', last) AS full_name
FROM client
WHERE sex = 'Male' AND year > 1990;
```
-------------------------244 sample_num
```sql
SELECT COUNT(*)
FROM events
WHERE Client_ID IN (SELECT client_id FROM client WHERE first = 'Diesel' AND last = 'Galloway');
```
-------------------------245 sample_num
```sql
SELECT e."Sub-product"
FROM events e
JOIN client c ON e."Client_ID" = c."client_id"
WHERE c."first" = 'Diesel' AND c."last" = 'Galloway' AND e."Date received" = '2014-07-03';
```
-------------------------246 sample_num
```sql
SELECT
    CASE
        WHEN "Consumer consent provided?" IS NOT NULL AND "Consumer consent provided?" NOT IN ('N/A', 'Empty') THEN 'Approved'
        ELSE 'Not Approved'
    END AS ApprovalStatus
FROM
    events
WHERE
    "Date received" = '2016-10-28'
    AND "Client_ID" = (SELECT client_id FROM client WHERE first = 'Matthew' AND last = 'Pierce');
```
-------------------------247 sample_num
```sql
SELECT DATEDIFF(e.`Date sent to company`, e.`Date received`) AS delay_duration
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.first = 'Matthew' AND c.last = 'Pierce' AND e.`Date received` = '2016-10-28';
```
-------------------------248 sample_num
```sql
SELECT CONCAT(c.first, ' ', c.middle, ' ', c.last) AS full_name
FROM client c
JOIN callcenterlogs cl ON c.client_id = cl.rand_client
WHERE cl."Date received" = '2017-03-27' AND cl.server = 'MICHAL';
```
-------------------------249 sample_num
```sql
SELECT ser_time
FROM callcenterlogs
WHERE "Date received" = '2017-03-27'
AND client_id = (SELECT client_id FROM client WHERE first = 'Rachel' AND last = 'Hicks');
```
-------------------------250 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id) AS complaint_count
FROM client c
JOIN events e ON c.client_id = e.Client_ID
JOIN district d ON c.district_id = d.district_id
WHERE d.city = 'New York' AND e.Issue = 'Deposits and withdrawals';
```
-------------------------251 sample_num
```sql
SELECT CONCAT(c.first, ' ', c.middle, ' ', c.last) AS full_name
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e."Company response to consumer" = 'In progress';
```
-------------------------252 sample_num
```sql
SELECT COUNT(DISTINCT e.Client_ID) AS New_York_Clients
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE e."Timely response?" = 'Yes' AND c.city = 'New York';
```
-------------------------253 sample_num
```sql
SELECT COUNT(*)
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE e.Product = 'Credit card'
AND YEAR(e.Date received) = 2016
AND c.sex = 'Male';
```
-------------------------254 sample_num
```sql
SELECT d.division
FROM client c
JOIN district d ON c.district_id = d.district_id
WHERE c.first = 'Diesel' AND c.last = 'Galloway';
```
-------------------------255 sample_num
```sql
SELECT CONCAT(first, ' ', middle, ' ', last) AS full_name
FROM client
WHERE sex = 'Male' AND district_id IN (
    SELECT district_id
    FROM district
    WHERE division = 'Pacific'
);
```
-------------------------256 sample_num
```sql
SELECT AVG(complaint_count) AS average_complaints
FROM (
    SELECT COUNT(e.Complaint_ID) AS complaint_count
    FROM events e
    JOIN client c ON e.Client_ID = c.client_id
    WHERE e.Product = 'Credit card'
      AND c.city = 'New York'
      AND e.Date_received BETWEEN '2015-01-01' AND '2017-12-31'
    GROUP BY YEAR(e.Date_received)
) AS yearly_complaints;
```
-------------------------257 sample_num
```sql
SELECT
    (SUM(CASE WHEN YEAR(e.`Date received`) = 2017 THEN 1 ELSE 0 END) -
     SUM(CASE WHEN YEAR(e.`Date received`) = 2016 THEN 1 ELSE 0 END)) /
    NULLIF(SUM(CASE WHEN YEAR(e.`Date received`) = 2016 THEN 1 ELSE 0 END), 0) * 100 AS percentage_increase
FROM
    events e
JOIN
    client c ON e.Client_ID = c.client_id
JOIN
    district d ON c.district_id = d.district_id
WHERE
    d.city = 'New York' AND
    YEAR(e.`Date received`) IN (2016, 2017);
```
-------------------------258 sample_num
```sql
SELECT ser_time
FROM callcenterlogs
WHERE rand_client = 'C00007127' AND Date_received = '2017-02-22';
```
-------------------------259 sample_num
```sql
SELECT s.State
FROM client c
JOIN state s ON c.state = s.StateCode
WHERE c.email = 'wyatt.collins@gmail.com';
```
-------------------------260 sample_num
```sql
SELECT e."Sub-product"
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.first = 'Lennox' AND c.middle = 'Oliver' AND c.last = 'Drake' AND c.sex = 'Male';
```
-------------------------261 sample_num
```sql
SELECT e.Sub_issue
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.first = 'Gunner' AND c.middle = 'Omer' AND c.last = 'Fuller';
```
-------------------------262 sample_num
```sql
SELECT
    e."Consumer consent provided?"
FROM
    client c
JOIN
    events e ON c.client_id = e.Client_ID
WHERE
    c.first = 'Lyric'
    AND c.middle = 'Emely'
    AND c.last = 'Taylor'
    AND c.sex = 'Female'
    AND e."Date received" = '2016-05-20';
```
-------------------------263 sample_num
```sql
SELECT DATEDIFF(e.`Date sent to company`, e.`Date received`) AS days_delay
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.first = 'Brantley' AND c.middle = 'Julian' AND c.last = 'Stanley'
AND c.sex = 'Male' AND e.`Date received` = '2012-05-18';
```
-------------------------264 sample_num
```sql
SELECT d.city
FROM reviews r
JOIN district d ON r.district_id = d.district_id
WHERE r.Date = '2018-09-11';
```
-------------------------265 sample_num
```sql
SELECT *
FROM reviews
WHERE district_id IN (SELECT district_id FROM district WHERE city = 'Jacksonville')
AND Date = '2017-07-22';
```
-------------------------266 sample_num
```sql
SELECT Product
FROM reviews
WHERE district_id IN (SELECT district_id FROM district WHERE city = 'Indianapolis')
AND Date = '2016-10-07';
```
-------------------------267 sample_num
```sql
SELECT Stars
FROM reviews
WHERE Product = 'Eagle Capital'
AND district_id IN (SELECT district_id FROM district WHERE city = 'Little Rock')
AND Date = '2013-04-04';
```
-------------------------268 sample_num
```sql
SELECT CONCAT(year, '-', month, '-', day) AS birthday
FROM client
WHERE client_id = (
    SELECT Client_ID
    FROM events
    WHERE Complaint_ID = 'CR0217298'
);
```
-------------------------269 sample_num
```sql
SELECT c.phone
FROM callcenterlogs cl
JOIN client c ON cl.rand_client = c.client_id
WHERE cl.Complaint_ID = 'CR0100432';
```
-------------------------270 sample_num
```sql
SELECT
    (SUM(CASE WHEN c.sex = 'Female' THEN 1 ELSE 0 END) * 100.0 / COUNT(c.client_id)) AS female_percentage
FROM
    callcenterlogs cl
JOIN
    client c ON cl.rand_client = c.client_id
WHERE
    cl.Date_received = '2017-03-27';
```
-------------------------271 sample_num
```sql
SELECT
    (SUM(CASE WHEN e."Consumer consent provided?" = 'Consent provided' THEN 1 ELSE 0 END) * 100.0) / COUNT(e.client_id) AS consent_percentage
FROM
    events e
JOIN
    client c ON e.Client_ID = c.client_id
WHERE
    c.first = 'Mason' AND
    c.middle = 'Javen' AND
    c.last = 'Lopez' AND
    c.sex = 'Male';
```
-------------------------272 sample_num
```sql
SELECT "Complaint ID"
FROM callcenterlogs
WHERE priority = 2 AND "Date received" BETWEEN '2017-03-01' AND '2017-03-31';
```
-------------------------273 sample_num
```sql
SELECT CONCAT(first, ' ', middle, ' ', last) AS full_name,
       CONCAT(year, '-', month, '-', day) AS date_of_birth,
       email
FROM client
WHERE age > 65
ORDER BY age DESC;
```
-------------------------274 sample_num
```sql
SELECT Product, COUNT(Stars) AS FiveStarCount
FROM reviews
WHERE Stars = 5
GROUP BY Product
ORDER BY FiveStarCount DESC
LIMIT 1;
```
-------------------------275 sample_num
```sql
SELECT State FROM state WHERE Region = 'South';
```
-------------------------276 sample_num
```sql
SELECT c.email
FROM callcenterlogs cl
JOIN client c ON cl.rand_client = c.client_id
WHERE cl.outcome = 'Hang';
```
-------------------------277 sample_num
```sql
SELECT AVG(c.age) AS average_age
FROM client c
JOIN state s ON c.state = s.State
WHERE s.Region = 'Midwest';
```
-------------------------278 sample_num
```sql
SELECT CONCAT(c.first, ' ', c.middle, ' ', c.last) AS full_name, c.phone
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Submitted_via = 'fax';
```
-------------------------279 sample_num
```sql
SELECT d.city
FROM district d
JOIN reviews r ON d.district_id = r.district_id
WHERE r.Product = 'Eagle Capital' AND r.Stars < (SELECT AVG(Stars) FROM reviews WHERE Product = 'Eagle Capital');
```
-------------------------280 sample_num
```sql
SELECT COUNT(*)
FROM callcenterlogs ccl
JOIN client cl ON ccl.rand_client = cl.client_id
JOIN district d ON cl.district_id = d.district_id
WHERE d.division = 'mountain' AND cl.age BETWEEN 12 AND 20;
```
-------------------------281 sample_num
```sql
SELECT COUNT(*) AS number_of_complaints
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE e.Product = 'Credit card' AND c.sex = 'female';
```
-------------------------282 sample_num
```sql
SELECT first, middle, last
FROM client
JOIN events ON client.client_id = events.Client_ID
WHERE year BETWEEN 1980 AND 2000
AND sex = 'Male'
AND "Submitted via" = 'Referral';
```
-------------------------283 sample_num
```sql
SELECT "Submitted via", COUNT(*) AS complaint_count
FROM events
JOIN client ON events.Client_ID = client.client_id
WHERE client.state = 'florida'
GROUP BY "Submitted via"
ORDER BY complaint_count DESC
LIMIT 1;
```
-------------------------284 sample_num
```sql
SELECT YEAR(e.Date_received) AS Year, AVG(e.Complaint_ID) AS Average_Complaints
FROM events e
JOIN district d ON e.Client_ID = d.district_id
WHERE d.city = 'New Bedford' AND e.Company_response_to_consumer = 'Closed with explanation'
GROUP BY YEAR(e.Date_received);
```
-------------------------285 sample_num
```sql
SELECT
    (SUM(CASE WHEN e."Consumer disputed?" = 'Yes' THEN 1 ELSE 0 END) * 100.0 / COUNT(e.client_id)) AS percentage
FROM
    events e
JOIN
    client c ON e.Client_ID = c.client_id
WHERE
    c.city = 'Houston';
```
-------------------------286 sample_num
```sql
SELECT COUNT(DISTINCT client_id) AS service_member_complaints
FROM client
WHERE city = 'Syracuse';
```
-------------------------287 sample_num
```sql
SELECT
    (SUM(CASE WHEN priority = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT("Complaint ID")) AS percentage_priority_1
FROM
    callcenterlogs
WHERE
    client IN (SELECT client_id FROM client WHERE state = 'California');
```
-------------------------288 sample_num
```sql
SELECT
    (SELECT AVG(age) FROM client
     WHERE age BETWEEN 35 AND 55 AND state IN
     (SELECT StateCode FROM state WHERE Region = 'Northeast')) -
    (SELECT AVG(age) FROM client
     WHERE age > 65 AND state IN
     (SELECT StateCode FROM state WHERE Region = 'Northeast')) AS age_difference;
```
-------------------------289 sample_num
```sql
SELECT "Complaint ID"
FROM callcenterlogs
ORDER BY ser_time DESC
LIMIT 3;
```
-------------------------290 sample_num
```sql
SELECT COUNT(*)
FROM client
WHERE email NOT LIKE '%@gmail.com';
```
-------------------------291 sample_num
```sql
SELECT DISTINCT Client_ID
FROM events
WHERE "Consumer consent provided?" IS NULL
   OR "Consumer consent provided?" = 'N/A'
   OR "Consumer consent provided?" = '';
```
-------------------------292 sample_num
```sql
SELECT "Complaint ID"
FROM events
WHERE "Date sent to company" = '2014-09-25'
ORDER BY ("Date sent to company" - "Date received") DESC
LIMIT 1;
```
-------------------------293 sample_num
```sql
SELECT * FROM callcenterlogs WHERE priority = 2 ORDER BY "Date received";
```
-------------------------294 sample_num
```sql
SELECT COUNT(*) AS complaints_not_in_process
FROM callcenterlogs
WHERE outcome != 'AGENT';
```
-------------------------295 sample_num
```sql
SELECT COUNT(*)
FROM callcenterlogs
WHERE type = 'Credit Card' AND server = 'SHARON';
```
-------------------------296 sample_num
```sql
SELECT s.Region, COUNT(r.Stars) AS OneStarCount
FROM reviews r
JOIN district d ON r.district_id = d.district_id
JOIN state s ON d.state_abbrev = s.StateCode
WHERE r.Stars = 1
GROUP BY s.Region
ORDER BY OneStarCount DESC
LIMIT 1;
```
-------------------------297 sample_num
```sql
SELECT DISTINCT year
FROM client
WHERE client_id IN (
    SELECT Client_ID
    FROM events
    WHERE Sub_product = '(CD) Certificate of deposit'
    GROUP BY Client_ID
    HAVING COUNT(*) = (
        SELECT MAX(problem_count)
        FROM (
            SELECT COUNT(*) AS problem_count
            FROM events
            WHERE Sub_product = '(CD) Certificate of deposit'
            GROUP BY Client_ID
        ) AS subquery
    )
);
```
-------------------------298 sample_num
```sql
SELECT COUNT(*)
FROM events
JOIN district ON events.Client_ID = district.district_id
WHERE events.Issue = 'Billing disputes'
AND district.division = 'Mountain';
```
-------------------------299 sample_num
```sql
SELECT COUNT(*)
FROM client
WHERE sex = 'Male' AND state = 'Massachusetts';
```
-------------------------300 sample_num
```sql
SELECT DISTINCT c.last
FROM client c
JOIN callcenterlogs cl ON c.client_id = cl.rand_client
WHERE cl.type = 'PS' AND cl.server = 'TOVA';
```
-------------------------301 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id)
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE c.age < 35 AND e.Product = 'Eagle National Mortgage' AND e.Stars = 1;
```
-------------------------302 sample_num
```sql
SELECT COUNT(*)
FROM client c
JOIN callcenterlogs cl ON c.client_id = cl.rand_client
WHERE c.sex = 'Male'
  AND c.year = 1977
  AND cl.priority = 0;
```
-------------------------303 sample_num
```sql
SELECT DISTINCT c.first
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Tags = 'Older American'
AND e."Consumer consent provided?" NOT IN ('N/A', null, 'empty');
```
-------------------------304 sample_num
```sql
SELECT s.State
FROM state s
JOIN callcenterlogs c ON s.StateCode = c.rand_client
WHERE c.priority = 0
GROUP BY s.State
ORDER BY COUNT(c.Complaint_ID) DESC
LIMIT 1;
```
-------------------------305 sample_num
```sql
SELECT COUNT(*)
FROM callcenterlogs ccl
JOIN events e ON ccl.Complaint_ID = e.Complaint_ID
JOIN client cl ON e.Client_ID = cl.client_id
WHERE cl.sex = 'Female'
AND ccl.ser_time BETWEEN '15:00:01' AND '23:59:59'
AND e."Timely response?" = 'Yes';
```
-------------------------306 sample_num
```sql
SELECT COUNT(*)
FROM callcenterlogs
JOIN events ON callcenterlogs.Complaint_ID = events.Complaint_ID
WHERE callcenterlogs.ser_time < '00:05:00'
  AND callcenterlogs.server = 'DORIT'
  AND events."Company response to consumer" = 'Closed with explanation'
  AND events."Submitted via" = 'Phone';
```
-------------------------307 sample_num
```sql
SELECT COUNT(*)
FROM client
WHERE last = 'Alvarado' AND state = 'MD';
```
-------------------------308 sample_num
```sql
SELECT COUNT(*)
FROM reviews r
JOIN client c ON r.district_id = c.district_id
WHERE c.age BETWEEN 30 AND 50 AND r.Reviews LIKE '%great%';
```
-------------------------309 sample_num
```sql
SELECT c.address_1, c.address_2
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE e."Timely response?" = 'Yes' AND e."Consumer disputed?" = 'Yes';
```
-------------------------310 sample_num
```sql
SELECT COUNT(*)
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.sex = 'Female'
  AND c.year = 2000
  AND e.Submitted_via != 'Web';
```
-------------------------311 sample_num
```sql
SELECT "Consumer complaint narrative"
FROM events
WHERE Client_ID IN (
    SELECT client_id
    FROM client
    WHERE first = 'Brenda' AND last = 'Mayer'
);
```
-------------------------312 sample_num
```sql
SELECT COUNT(*)
FROM events
WHERE "Date received" BETWEEN '2017-02-01' AND '2017-02-28'
AND Client_ID IN (
    SELECT client_id
    FROM client
    WHERE email LIKE '%gmail.com'
);
```
-------------------------313 sample_num
```sql
SELECT AVG(Stars) AS average_stars
FROM reviews r
JOIN client c ON r.district_id = c.district_id
WHERE c.state = 'Oregon';
```
-------------------------314 sample_num
```sql
SELECT
    (COUNT(CASE WHEN age >= 50 THEN 1 END) * 100.0 / COUNT(client_id)) AS percentage
FROM
    events
JOIN
    client ON events.Client_ID = client.client_id
WHERE
    events."Submitted via" = 'Postal mail';
```
-------------------------315 sample_num
```sql
SELECT AVG(age) AS average_age
FROM client
WHERE city = 'Norwalk';
```
-------------------------316 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id) AS client_count
FROM client c
JOIN reviews r ON c.district_id = r.district_id
WHERE c.city = 'Kansas City' AND r.Stars = 1;
```
-------------------------317 sample_num
```sql
SELECT s.State
FROM state s
JOIN client c ON s.StateCode = c.state
JOIN reviews r ON c.district_id = r.district_id
WHERE r.Stars = 5
GROUP BY s.State
ORDER BY COUNT(DISTINCT c.client_id) DESC
LIMIT 1;
```
-------------------------318 sample_num
```sql
SELECT Region
FROM state
WHERE State = (SELECT state FROM client WHERE first = 'Noah' AND last = 'Thompson');
```
-------------------------319 sample_num
```sql
SELECT "Submitted via"
FROM events
JOIN client ON events.Client_ID = client.client_id
WHERE client.first = 'Kyran' AND client.last = 'Muller';
```
-------------------------320 sample_num
```sql
SELECT DISTINCT e.Product
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.year > 2005;
```
-------------------------321 sample_num
```sql
SELECT ser_time
FROM callcenterlogs
JOIN events ON callcenterlogs.Complaint_ID = events.Complaint_ID
JOIN client ON events.Client_ID = client.client_id
WHERE client.first = 'Kendall' AND client.last = 'Allen' AND events.Product = 'Credit Card';
```
-------------------------322 sample_num
```sql
SELECT e.Issue
FROM callcenterlogs ccl
JOIN events e ON ccl.Complaint_ID = e.Complaint_ID
WHERE ccl.ser_time = (SELECT MAX(ser_time) FROM callcenterlogs);
```
-------------------------323 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id) AS client_count
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE c.city = 'New York City' AND e.Submitted_via = 'Fax';
```
-------------------------324 sample_num
```sql
SELECT
    (SUM(CASE WHEN c.sex = 'Male' THEN 1 ELSE 0 END) * 100.0) / COUNT(c.client_id) AS male_percentage
FROM
    client c
JOIN
    events e ON c.client_id = e.Client_ID
WHERE
    e.Product = 'Credit card';
```
-------------------------325 sample_num
```sql
SELECT CONCAT(c.first, ' ', c.middle, ' ', c.last) AS full_name
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Tags = 'Older American'
AND (e."Consumer consent provided?" IS NULL OR e."Consumer consent provided?" = 'N/A' OR e."Consumer consent provided?" = '')
LIMIT 2;
```
-------------------------326 sample_num
```sql
SELECT MAX(CONCAT(year, '-', month, '-', day)) AS birth_date
FROM client;
```
-------------------------327 sample_num
```sql
SELECT COUNT(*)
FROM events
WHERE "Consumer disputed?" = 'No'
AND "Timely response?" = 'No';
```
-------------------------328 sample_num
```sql
SELECT COUNT(*) AS complaints_longer_than_15_minutes
FROM callcenterlogs
WHERE ser_time > '00:15:00';
```
-------------------------329 sample_num
```sql
SELECT Issue, COUNT(Issue) AS issue_count
FROM callcenterlogs
WHERE priority = 2
GROUP BY Issue
ORDER BY issue_count DESC
LIMIT 1;
```
-------------------------330 sample_num
```sql
SELECT CONCAT(c.first, ' ', c.last) AS full_name
FROM client c
JOIN district d ON c.district_id = d.district_id
WHERE d.division = 'Pacific';
```
-------------------------331 sample_num
```sql
SELECT social
FROM client
WHERE client_id = (
    SELECT Client_ID
    FROM events
    GROUP BY Client_ID
    ORDER BY COUNT(Client_ID) DESC
    LIMIT 1
);
```
-------------------------332 sample_num
```sql
SELECT city, COUNT(*) AS review_count
FROM reviews r
JOIN district d ON r.district_id = d.district_id
WHERE r.Stars = 1
GROUP BY city
ORDER BY review_count DESC
LIMIT 1;
```
-------------------------333 sample_num
```sql
SELECT c.address_1, c.address_2
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Submitted_via = 'Postal mail' AND e.Date_received = '2012-03-14';
```
-------------------------334 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id) AS female_complaints
FROM client c
JOIN callcenterlogs cl ON c.client_id = cl.rand_client
WHERE c.sex = 'Female' AND cl.priority = 1;
```
-------------------------335 sample_num
```sql
SELECT DISTINCT e.server
FROM events e
WHERE e.Submitted_via = 'Phone' AND e.Timely_response? = 'No';
```
-------------------------336 sample_num
```sql
SELECT e.Issue
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.first = 'Kaitlyn' AND c.middle = 'Eliza' AND c.last = 'Elliott';
```
-------------------------337 sample_num
```sql
SELECT s.State
FROM client c
JOIN state s ON c.state = s.StateCode
WHERE c.email = 'skylar.ramirez@gmail.com';
```
-------------------------338 sample_num
```sql
SELECT Region
FROM (
    SELECT Region, COUNT(client_id) AS client_count
    FROM client
    JOIN district ON client.district_id = district.district_id
    GROUP BY Region
    ORDER BY client_count DESC
) AS ranked_regions
LIMIT 1 OFFSET 1;
```
-------------------------339 sample_num
```sql
SELECT c.first, c.middle, c.last
FROM callcenterlogs cl
JOIN client c ON cl.rand_client = c.client_id
WHERE cl.server = 'MORIAH' AND cl.Date_received = '2013-09-11';
```
-------------------------340 sample_num
```sql
SELECT
    CASE
        WHEN age BETWEEN 13 AND 19 THEN 'teenager'
        WHEN age BETWEEN 20 AND 65 THEN 'adult'
        WHEN age > 65 THEN 'elder'
    END AS age_group,
    AVG(ser_time) / 60 AS average_time_minutes
FROM
    client
JOIN
    callcenterlogs ON client.client_id = callcenterlogs.rand_client
GROUP BY
    age_group;
```
-------------------------341 sample_num
```sql
SELECT (SUM(CASE WHEN age <= 65 THEN 1 ELSE 0 END) * 100.0 / COUNT(client_id)) AS percentage_elderly
FROM client;
```
-------------------------342 sample_num
```sql
SELECT
    (COUNT(CASE WHEN sex = 'Male' THEN 1 END) * 100.0 / COUNT(client_id)) AS male_percentage
FROM
    client
WHERE
    city = 'Indianapolis';
```
-------------------------343 sample_num
```sql
SELECT
    CASE
        WHEN COUNT(CASE WHEN email LIKE '%@gmail.com' THEN 1 END) > COUNT(CASE WHEN email LIKE '%@outlook.com' THEN 1 END) THEN 'Google'
        WHEN COUNT(CASE WHEN email LIKE '%@gmail.com' THEN 1 END) < COUNT(CASE WHEN email LIKE '%@outlook.com' THEN 1 END) THEN 'Microsoft'
        ELSE 'Equal'
    END AS More_Clients
FROM client
WHERE age > 13 AND age <= 19
AND (email LIKE '%@gmail.com' OR email LIKE '%@outlook.com');
```
-------------------------344 sample_num
```sql
SELECT CONCAT(first, ' ', middle, ' ', last) AS full_name
FROM client
WHERE email = 'emily.garcia43@outlook.com';
```
-------------------------345 sample_num
```sql
SELECT first
FROM client
WHERE client_id IN (
    SELECT rand_client
    FROM callcenterlogs
    WHERE priority = 2
);
```
-------------------------346 sample_num
```sql
SELECT c.email
FROM client c
JOIN callcenterlogs cl ON c.client_id = cl.rand_client
WHERE cl.type = 'PS';
```
-------------------------347 sample_num
```sql
SELECT c.last
FROM client c
JOIN callcenterlogs cl ON c.client_id = cl.rand_client
WHERE c.age <= 65 AND cl.server = 'YIFAT';
```
-------------------------348 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id)
FROM client c
JOIN callcenterlogs cl ON c.client_id = cl.rand_client
WHERE c.city = 'New York City' AND cl.outcome = 'AGENT';
```
-------------------------349 sample_num
```sql
SELECT CONCAT(c.first, ' ', c.middle, ' ', c.last) AS full_name
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Consumer_disputed? = 'Yes';
```
-------------------------350 sample_num
```sql
SELECT DISTINCT e.Complaint_ID
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.year = 1931;
```
-------------------------351 sample_num
```sql
SELECT
    (COUNT(CASE WHEN c.email LIKE '%@gmail.com' THEN e.Complaint_ID END) * 100.0 / COUNT(e.Complaint_ID)) AS percentage
FROM
    events e
JOIN
    client c ON e.Client_ID = c.client_id
WHERE
    c.phone LIKE '%ZOHARI%';
```
-------------------------352 sample_num
```sql
SELECT CONCAT(c.first, ' ', c.middle, ' ', c.last) AS full_name
FROM callcenterlogs cl
JOIN client c ON cl.rand_client = c.client_id
WHERE cl.ser_time > '00:20:00';
```
-------------------------353 sample_num
```sql
SELECT last
FROM client
WHERE client_id IN (
    SELECT rand_client
    FROM callcenterlogs
    WHERE priority = 0
    LIMIT 5
);
```
-------------------------354 sample_num
```sql
SELECT callcenterlogs.call_id
FROM callcenterlogs
JOIN client ON callcenterlogs.rand_client = client.client_id
WHERE client.first LIKE 'B%';
```
-------------------------355 sample_num
```sql
SELECT e.Product
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.first = 'Alexander' AND c.middle = 'Bronx' AND c.last = 'Lewis';
```
-------------------------356 sample_num
```sql
SELECT c.first
FROM client c
JOIN callcenterlogs cl ON c.client_id = cl.rand_client
JOIN events e ON cl.Complaint_ID = e.Complaint_ID
WHERE c.sex = 'Male' AND e."Timely response?" = 'No';
```
-------------------------357 sample_num
```sql
SELECT e.Product, COUNT(e.Complaint_ID) AS complaint_count
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.age > 65
GROUP BY e.Product
ORDER BY complaint_count DESC
LIMIT 1;
```
-------------------------358 sample_num
```sql
SELECT
    CASE
        WHEN age BETWEEN 13 AND 19 THEN 'Teenager'
        WHEN age BETWEEN 20 AND 65 THEN 'Adult'
        ELSE 'Elder'
    END AS Age_Group,
    COUNT(*) AS Complaint_Count
FROM
    events e
JOIN
    client c ON e.Client_ID = c.client_id
WHERE
    e.Product = 'Credit Card'
GROUP BY
    Age_Group
ORDER BY
    Complaint_Count DESC;
```
-------------------------359 sample_num
```sql
SELECT Issue
FROM callcenterlogs
WHERE ser_time < '00:10:00';
```
-------------------------360 sample_num
```sql
SELECT "Date received"
FROM events
WHERE "Submitted via" = 'Fax';
```
-------------------------361 sample_num
```sql
SELECT CONCAT(c.first, ' ', c.middle, ' ', c.last) AS full_name
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Issue = 'Balance transfer';
```
-------------------------362 sample_num
```sql
SELECT c.email
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Submitted_via = 'Postal mail';
```
-------------------------363 sample_num
```sql
SELECT AVG(c.age) AS average_age
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Company_response_to_consumer = 'Closed with relief';
```
-------------------------364 sample_num
```sql
SELECT AVG(age) AS average_age
FROM client
JOIN callcenterlogs ON client.client_id = callcenterlogs.rand_client
WHERE callcenterlogs.type = 'TT';
```
-------------------------365 sample_num
```sql
SELECT Complaint_ID, call_id, phonefinal
FROM callcenterlogs
WHERE server = 'AVIDAN'
AND "Date received" BETWEEN '2014-01-01' AND '2014-12-30';
```
-------------------------366 sample_num
```sql
SELECT AVG(ser_time) AS average_server_time
FROM callcenterlogs
WHERE "Date received" BETWEEN '2017-01-01' AND '2017-04-01'
AND server = 'DARMON';
```
-------------------------367 sample_num
```sql
SELECT YEAR(Date_received) AS Year, COUNT(*) AS ComplaintCount
FROM events
WHERE Product = 'Credit card' AND Issue = 'Overlimit fee'
GROUP BY YEAR(Date_received);
```
-------------------------368 sample_num
```sql
SELECT COUNT(*)
FROM client
WHERE sex = 'Female'
AND age < 18
AND district_id IN (SELECT district_id FROM district WHERE division = 'Middle Atlantic');
```
-------------------------369 sample_num
```sql
SELECT CONCAT(year, '-', month, '-', day) AS full_birthdate, email, phone
FROM client
WHERE city = 'Indianapolis'
ORDER BY year DESC, month DESC, day DESC
LIMIT 1;
```
-------------------------370 sample_num
```sql
SELECT district.city, COUNT(*) AS five_star_count
FROM reviews
JOIN district ON reviews.district_id = district.district_id
WHERE reviews.Stars = 5 AND reviews.Date LIKE '2016%'
GROUP BY district.city
ORDER BY five_star_count DESC
LIMIT 5;
```
-------------------------371 sample_num
```sql
SELECT MAX(ser_time) AS longest_server_time
FROM callcenterlogs
WHERE type = 'arbitration';
```
-------------------------372 sample_num
```sql
SELECT social, state FROM client WHERE phone = '100-121-8371';
```
-------------------------373 sample_num
```sql
SELECT CONCAT(c.first, ' ', c.middle, ' ', c.last) AS full_name, c.phone
FROM client c
JOIN district d ON c.district_id = d.district_id
WHERE d.division = 'Pacific';
```
-------------------------374 sample_num
```sql
SELECT c.social,
       DATEDIFF(e.`Date sent to company`, e.`Date received`) AS days_of_delay,
       e.`Company response to consumer`
FROM events e
JOIN client c ON e.Client_ID = c.client_id
ORDER BY days_of_delay DESC
LIMIT 1;
```
-------------------------375 sample_num
```sql
SELECT COUNT(*)
FROM client
WHERE sex = 'Female' AND age > 30;
```
-------------------------376 sample_num
```sql
SELECT first, last
FROM client
WHERE city = 'New York City';
```
-------------------------377 sample_num
```sql
SELECT MAX(age) AS oldest_age
FROM client
WHERE sex = 'Male';
```
-------------------------378 sample_num
```sql
SELECT d.division, COUNT(c.client_id) AS client_count
FROM client c
JOIN district d ON c.district_id = d.district_id
GROUP BY d.division;
```
-------------------------379 sample_num
```sql
SELECT
    (COUNT(CASE WHEN c.sex = 'Female' THEN 1 END) * 100.0 / COUNT(c.client_id)) AS female_percentage
FROM
    client c
JOIN
    district d ON c.district_id = d.district_id
WHERE
    d.division = 'Middle Atlantic';
```
-------------------------380 sample_num
```sql
SELECT AVG(c.age) AS average_age
FROM client c
JOIN district d ON c.district_id = d.district_id
WHERE d.division = 'South Atlantic';
```
-------------------------381 sample_num
```sql
SELECT d.city
FROM district d
JOIN client c ON d.district_id = c.district_id
JOIN state s ON d.state_abbrev = s.StateCode
WHERE s.Region = 'Midwest'
GROUP BY d.city
ORDER BY COUNT(c.client_id) ASC
LIMIT 1;
```
-------------------------382 sample_num
```sql
SELECT COUNT(*)
FROM client c
JOIN state s ON c.state = s.State
WHERE s.Region = 'Northeast' AND c.email LIKE '%@outlook.com';
```
-------------------------383 sample_num
```sql
SELECT d.city, COUNT(c.client_id) AS customer_count
FROM client c
JOIN district d ON c.district_id = d.district_id
JOIN state s ON d.state_abbrev = s.StateCode
WHERE s.Region = 'North Central' AND c.age > 60
GROUP BY d.city
ORDER BY customer_count DESC
LIMIT 1;
```
-------------------------384 sample_num
```sql
SELECT
    (COUNT(CASE WHEN priority = 2 THEN Complaint_ID END) * 100.0 / COUNT(Complaint_ID)) AS percentage
FROM
    events
WHERE
    Issue = 'Late Fee' AND
    YEAR(Date_received) = 2017;
```
-------------------------385 sample_num
```sql
SELECT state_abbrev, COUNT(city) AS city_count
FROM district
GROUP BY state_abbrev
ORDER BY city_count DESC
LIMIT 1;
```
-------------------------386 sample_num
```sql
SELECT first, phone
FROM client
WHERE client_id = (SELECT Client_ID FROM events WHERE Complaint_ID = 'CR0922485');
```
-------------------------387 sample_num
```sql
SELECT c.email
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Date_received = '2014-07-03';
```
-------------------------388 sample_num
```sql
SELECT COUNT(*)
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE e.Product = 'Credit card'
AND c.city = 'Omaha'
AND e.Date received LIKE '2012%';
```
-------------------------389 sample_num
```sql
SELECT COUNT(*)
FROM events
JOIN client ON events.Client_ID = client.client_id
WHERE events.Date_received BETWEEN '2012-01-01' AND '2015-12-31'
AND events.Submitted_via = 'Email'
AND client.sex = 'Female';
```
-------------------------390 sample_num
```sql
SELECT c.phone, e.Complaint_ID
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Company_response_to_consumer = 'In progress';
```
-------------------------391 sample_num
```sql
SELECT COUNT(*)
FROM events
WHERE Date_received LIKE '2015%'
AND Issue = 'Billing disputes'
AND Client_ID IN (SELECT client_id FROM client WHERE city = 'Portland');
```
-------------------------392 sample_num
```sql
SELECT
    (COUNT(CASE WHEN DATEDIFF(Date_sent_to_company, Date_received) > 5 THEN Complaint_ID END) * 100.0 / COUNT(Complaint_ID)) AS percentage
FROM
    events e
JOIN
    client c ON e.Client_ID = c.client_id
WHERE
    e.Date_received LIKE '2014%' AND
    c.city = 'Houston';
```
-------------------------393 sample_num
```sql
SELECT COUNT(*)
FROM events
WHERE Date_received LIKE '2012%' AND Submitted_via = 'Email';
```
-------------------------394 sample_num
```sql
SELECT Client_ID
FROM events
WHERE Date_received = '2014-04-16' AND Submitted_via = 'Fax';
```
-------------------------395 sample_num
```sql
SELECT r.Date
FROM reviews r
JOIN district d ON r.district_id = d.district_id
WHERE r.Product = 'Eagle Capital'
AND d.city = 'Indianapolis'
AND d.state_abbrev = 'IN';
```
-------------------------396 sample_num
```sql
SELECT COUNT(*) AS total_complaints
FROM events
WHERE Date_received LIKE '2015%'
  AND "Timely response?" = 'Yes'
  AND "Company response to consumer" = 'Closed with explanation';
```
-------------------------397 sample_num
```sql
SELECT e.Date_received
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.sex = 'Female' AND c.age BETWEEN 20 AND 40;
```
-------------------------398 sample_num
```sql
SELECT Product
FROM reviews
WHERE Stars = 1
AND Date = '2016-03-14'
AND district_id IN (SELECT district_id FROM district WHERE city = 'Newton' AND state_abbrev = 'MA');
```
-------------------------399 sample_num
```sql
SELECT COUNT(*)
FROM reviews r
JOIN district d ON r.district_id = d.district_id
WHERE r.Product = 'Eagle National Bank'
AND r.Stars = 5
AND d.city = 'Nashville'
AND d.state_abbrev = 'TN';
```
-------------------------400 sample_num
```sql
SELECT e.Issue
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.sex = 'Male' AND c.age < 25;
```
-------------------------401 sample_num
```sql
SELECT r.Product
FROM reviews r
JOIN district d ON r.district_id = d.district_id
JOIN state s ON d.state_abbrev = s.StateCode
WHERE r.Stars = 1 AND s.Region = 'Midwest';
```
-------------------------402 sample_num
```sql
SELECT DISTINCT Product
FROM events
WHERE Date received LIKE '%03%' AND Date received LIKE '2017%' AND Company response to consumer LIKE '%TOVA%';
```
-------------------------403 sample_num
```sql
SELECT d.division
FROM reviews r
JOIN district d ON r.district_id = d.district_id
WHERE r.Stars = 5 AND r.Date = '2017-12-17' AND r.Product = 'Eagle National Mortgage';
```
-------------------------404 sample_num
```sql
SELECT c.phone
FROM client c
JOIN events e ON c.client_id = e.Client_ID
WHERE e.Product = 'Credit Card'
ORDER BY c.age DESC
LIMIT 1;
```
-------------------------405 sample_num
```sql
SELECT COUNT(*)
FROM events
WHERE Date_received LIKE '2014%' AND Submitted_via = 'Phone';
```
-------------------------406 sample_num
```sql
SELECT e.Product, e.Issue
FROM events e
JOIN client c ON e.Client_ID = c.client_id
WHERE c.age > (SELECT AVG(age) * 0.6 FROM client);
```
-------------------------407 sample_num
```sql
SELECT
    (COUNT(CASE WHEN d.division = 'East North Central' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM
    reviews r
JOIN
    district d ON r.district_id = d.district_id
WHERE
    r.Stars = 5;
```
-------------------------408 sample_num
```sql
SELECT pc.company_name
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE m.title = 'Four Rooms';
```
-------------------------409 sample_num
```sql
SELECT COUNT(DISTINCT mc.company_id) AS production_company_count
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
WHERE m.title = 'Four Rooms';
```
-------------------------410 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Universal Pictures';
```
-------------------------411 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Universal Pictures'
ORDER BY m.release_date DESC
LIMIT 1;
```
-------------------------412 sample_num
```sql
SELECT p.person_name
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'Pirates of the Caribbean: At World''s End'
AND mc.job = 'Director of Photography';
```
-------------------------413 sample_num
```sql
SELECT mc.job
FROM movie_crew mc
JOIN movie m ON mc.movie_id = m.movie_id
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'Dariusz Wolski' AND m.title = 'Pirates of the Caribbean: At World''s End';
```
-------------------------414 sample_num
```sql
SELECT p.person_name
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'Pirates of the Caribbean: At World''s End';
```
-------------------------415 sample_num
```sql
SELECT COUNT(*)
FROM movie_crew mc
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'Pirates of the Caribbean: At World''s End'
AND mc.job = 'Producer';
```
-------------------------416 sample_num
```sql
SELECT p.person_name
FROM person p
JOIN movie_crew mc ON p.person_id = mc.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE mc.job = 'Producer' AND m.title = 'Pirates of the Caribbean: At World''s End';
```
-------------------------417 sample_num
```sql
SELECT COUNT(DISTINCT mc.movie_id) AS movie_count
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'Dariusz Wolski' AND mc.job = 'Director of Photography';
```
-------------------------418 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_crew mc ON m.movie_id = mc.movie_id
WHERE mc.person_id = (SELECT person_id FROM person WHERE person_name = 'Dariusz Wolski')
AND mc.job = 'Director of Photography'
ORDER BY m.vote_average DESC
LIMIT 1;
```
-------------------------419 sample_num
```sql
SELECT MAX(m.release_date) AS latest_release_date
FROM movie m
JOIN movie_crew mc ON m.movie_id = mc.movie_id
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'Dariusz Wolski';
```
-------------------------420 sample_num
```sql
SELECT
    (SUM(CASE WHEN m.vote_average > 5.0 THEN 1 ELSE 0 END) * 100.0 / COUNT(m.movie_id)) AS percentage
FROM
    movie_crew mc
JOIN
    movie m ON mc.movie_id = m.movie_id
WHERE
    mc.person_id = (SELECT person_id FROM person WHERE person_name = 'Dariusz Wolski')
    AND mc.job = 'Director of Photography';
```
-------------------------421 sample_num
```sql
SELECT AVG(revenue) AS average_revenue
FROM movie
WHERE movie_id IN (
    SELECT movie_id
    FROM movie_crew
    WHERE person_id = (
        SELECT person_id
        FROM person
        WHERE person_name = 'Dariusz Wolski'
    ) AND job = 'Director of Photography'
);
```
-------------------------422 sample_num
```sql
SELECT title FROM movie WHERE revenue = 559852396;
```
-------------------------423 sample_num
```sql
SELECT mc.job
FROM movie_crew mc
JOIN movie m ON mc.movie_id = m.movie_id
JOIN person p ON mc.person_id = p.person_id
WHERE m.title = 'Days of Thunder' AND p.person_name = 'David Rubin';
```
-------------------------424 sample_num
```sql
SELECT COUNT(DISTINCT mc.movie_id) AS directed_movies_count
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'Michael Bay' AND mc.job = 'Director';
```
-------------------------425 sample_num
```sql
SELECT COUNT(mk.keyword_id) AS total_keywords
FROM movie_keywords mk
JOIN movie m ON mk.movie_id = m.movie_id
WHERE m.title = 'I Hope They Serve Beer in Hell';
```
-------------------------426 sample_num
```sql
SELECT p.person_name
FROM movie m
JOIN movie_crew mc ON m.movie_id = mc.movie_id
JOIN person p ON mc.person_id = p.person_id
WHERE m.title = 'Land of the Dead' AND mc.job = 'Director';
```
-------------------------427 sample_num
```sql
SELECT COUNT(m.movie_id) AS number_of_movies
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Paramount Animation';
```
-------------------------428 sample_num
```sql
SELECT COUNT(*)
FROM movie_cast mc
JOIN gender g ON mc.gender_id = g.gender_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE g.gender = 'Female' AND m.title = 'Spider-Man 3';
```
-------------------------429 sample_num
```sql
SELECT k.keyword_name
FROM keyword k
JOIN movie_keywords mk ON k.keyword_id = mk.keyword_id
GROUP BY k.keyword_name
ORDER BY COUNT(mk.keyword_id) DESC
LIMIT 1;
```
-------------------------430 sample_num
```sql
SELECT COUNT(DISTINCT mc.person_id) AS producer_count
FROM movie_crew mc
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'The Amityville Horror' AND mc.job = 'Producer';
```
-------------------------431 sample_num
```sql
SELECT pc.company_name
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE m.title = 'Crazy Heart';
```
-------------------------432 sample_num
```sql
SELECT COUNT(DISTINCT movie_id) AS number_of_movies
FROM movie_keywords
JOIN keyword ON movie_keywords.keyword_id = keyword.keyword_id
WHERE keyword.keyword_name = 'saving the world';
```
-------------------------433 sample_num
```sql
SELECT m.title, m.popularity
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Cruel and Unusual Films'
ORDER BY m.popularity DESC
LIMIT 1;
```
-------------------------434 sample_num
```sql
SELECT d.department_name
FROM movie m
JOIN movie_crew mc ON m.movie_id = mc.movie_id
JOIN person p ON mc.person_id = p.person_id
JOIN department d ON mc.department_id = d.department_id
WHERE m.title = 'Reign of Fire' AND p.person_name = 'Marcia Ross';
```
-------------------------435 sample_num
```sql
SELECT AVG(m.budget) AS average_budget
FROM movie m
JOIN movie_crew mc ON m.movie_id = mc.movie_id
JOIN person p ON mc.person_id = p.person_id
WHERE mc.job = 'Director' AND p.person_name = 'Jaume Collet-Serra';
```
-------------------------436 sample_num
```sql
SELECT
    (SUM(CASE WHEN mc.gender_id = (SELECT gender_id FROM gender WHERE gender = 'Male') THEN 1 ELSE 0 END) * 100.0 / COUNT(mc.gender_id)) AS percentage
FROM
    movie_cast mc
JOIN
    movie m ON mc.movie_id = m.movie_id
WHERE
    m.title = 'Bride Wars';
```
-------------------------437 sample_num
```sql
SELECT title
FROM movie
ORDER BY budget DESC
LIMIT 1;
```
-------------------------438 sample_num
```sql
SELECT COUNT(*)
FROM movie
WHERE revenue > 1000000000;
```
-------------------------439 sample_num
```sql
SELECT MIN(release_date) AS first_movie_release_date FROM movie;
```
-------------------------440 sample_num
```sql
SELECT COUNT(*)
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'John Young';
```
-------------------------441 sample_num
```sql
SELECT title
FROM movie
ORDER BY popularity DESC
LIMIT 1;
```
-------------------------442 sample_num
```sql
SELECT person_name FROM person WHERE person_id = 1325273;
```
-------------------------443 sample_num
```sql
SELECT pc.company_name
FROM production_company pc
JOIN movie_company mc ON pc.company_id = mc.company_id
GROUP BY pc.company_name
ORDER BY COUNT(mc.movie_id) DESC
LIMIT 1;
```
-------------------------444 sample_num
```sql
SELECT p.person_name
FROM movie_cast mc
JOIN person p ON mc.person_id = p.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE mc.character_name = 'Captain Jack Sparrow'
AND m.title LIKE 'Pirates of the Caribbean%';
```
-------------------------445 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Walt Disney Pictures'
ORDER BY m.popularity DESC
LIMIT 1;
```
-------------------------446 sample_num
```sql
SELECT COUNT(*)
FROM movie_company mc
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Universal Studios';
```
-------------------------447 sample_num
```sql
SELECT pc.company_name
FROM production_company pc
JOIN movie_company mc ON pc.company_id = mc.company_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.revenue = (SELECT MAX(revenue) FROM movie);
```
-------------------------448 sample_num
```sql
SELECT COUNT(*)
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
JOIN gender g ON p.gender_id = g.gender_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'Mr. Smith Goes to Washington' AND g.gender = 'Female';
```
-------------------------449 sample_num
```sql
SELECT pc.company_name
FROM production_company pc
JOIN movie_company mc ON pc.company_id = mc.company_id
GROUP BY pc.company_name
HAVING COUNT(mc.movie_id) >= 200;
```
-------------------------450 sample_num
```sql
SELECT COUNT(*) AS total_movies
FROM movie_cast
WHERE person_id = (SELECT person_id FROM person WHERE person_name = 'Harrison Ford');
```
-------------------------451 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_cast mc ON m.movie_id = mc.movie_id
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'Jamie Foxx'
ORDER BY m.release_date DESC
LIMIT 1;
```
-------------------------452 sample_num
```sql
SELECT COUNT(DISTINCT mc.movie_id) AS movie_count
FROM movie_cast mc
JOIN person p ON mc.person_id = p.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE p.person_name = 'Quentin Tarantino' AND m.release_date LIKE '1995%';
```
-------------------------453 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE g.genre_name = 'Crime'
ORDER BY m.release_date ASC
LIMIT 1;
```
-------------------------454 sample_num
```sql
SELECT COUNT(*)
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE g.genre_name = 'Horror';
```
-------------------------455 sample_num
```sql
SELECT person_id
FROM movie_crew
WHERE movie_id = 12 AND job = 'Second Film Editor';
```
-------------------------456 sample_num
```sql
SELECT COUNT(*)
FROM movie_crew
WHERE movie_id = 129 AND job = 'Animation';
```
-------------------------457 sample_num
```sql
SELECT person_id, job
FROM movie_crew
WHERE movie_id = 19 AND department_id = 7;
```
-------------------------458 sample_num
```sql
SELECT person_id, character_name
FROM movie_cast
WHERE movie_id = 285 AND cast_order BETWEEN 2 AND 9;
```
-------------------------459 sample_num
```sql
SELECT COUNT(*) AS appearance_count
FROM movie_cast
WHERE person_id = (SELECT person_id FROM person WHERE person_name = 'Bob Peterson')
   OR movie_crew.person_id = (SELECT person_id FROM person WHERE person_name = 'Bob Peterson');
```
-------------------------460 sample_num
```sql
SELECT mc.movie_id, mc.character_name
FROM movie_cast mc
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'Jim Carrey';
```
-------------------------461 sample_num
```sql
SELECT p.person_name
FROM movie_cast mc
JOIN person p ON mc.person_id = p.person_id
JOIN gender g ON mc.gender_id = g.gender_id
WHERE mc.movie_id = 1865 AND g.gender = 'Female';
```
-------------------------462 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_cast mc ON m.movie_id = mc.movie_id
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'Jim Carrey';
```
-------------------------463 sample_num
```sql
SELECT p.person_name
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE mc.job = 'Director' AND m.release_date BETWEEN '1916-01-01' AND '1925-12-31';
```
-------------------------464 sample_num
```sql
SELECT COUNT(*)
FROM movie m
JOIN movie_cast mc ON m.movie_id = mc.movie_id
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'Uma Thurman'
AND m.release_date BETWEEN '1990-01-02' AND '2000-12-30';
```
-------------------------465 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE g.genre_name = 'Horror' AND m.vote_average > 7;
```
-------------------------466 sample_num
```sql
SELECT g.genre_name, m.popularity
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE m.revenue >= 120000000
AND m.release_date BETWEEN '2012-01-01' AND '2015-12-31';
```
-------------------------467 sample_num
```sql
SELECT COUNT(*)
FROM movie m
JOIN production_country pc ON m.movie_id = pc.movie_id
JOIN country c ON pc.country_id = c.country_id
WHERE c.country_name = 'India'
AND m.release_date BETWEEN '1990-01-02' AND '2003-12-30'
AND m.revenue > 75000000
AND m.popularity >= 20;
```
-------------------------468 sample_num
```sql
SELECT m.title, m.budget, m.revenue, c.country_name
FROM movie m
JOIN production_country pc ON m.movie_id = pc.movie_id
JOIN country c ON pc.country_id = c.country_id
WHERE m.budget = (SELECT MAX(budget) FROM movie);
```
-------------------------469 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_languages ml ON m.movie_id = ml.movie_id
JOIN language l ON ml.language_id = l.language_id
WHERE l.language_name = 'Latin'
AND m.release_date BETWEEN '1990-01-01' AND '1995-12-31';
```
-------------------------470 sample_num
```sql
SELECT AVG(m.revenue) AS average_revenue
FROM movie m
JOIN production_country pc ON m.movie_id = pc.movie_id
JOIN country c ON pc.country_id = c.country_id
WHERE c.country_name = 'United States of America' AND m.release_date LIKE '2006%';
```
-------------------------471 sample_num
```sql
SELECT
    (SELECT AVG(revenue)
     FROM movie m
     JOIN production_country pc ON m.movie_id = pc.movie_id
     WHERE m.release_date LIKE '2016%'
     AND pc.country_id = (SELECT country_id FROM country WHERE country_name = 'United States of America')) -
    (SELECT AVG(revenue)
     FROM movie m
     JOIN production_country pc ON m.movie_id = pc.movie_id
     WHERE m.release_date LIKE '2016%'
     AND pc.country_id = (SELECT country_id FROM country WHERE country_name = 'India')) AS revenue_gap;
```
-------------------------472 sample_num
```sql
SELECT
    (SUM(CASE WHEN g.genre_name = 'Romance' THEN 1 ELSE 0 END) * 100.0 / COUNT(m.movie_id)) AS percentage
FROM
    movie m
JOIN
    production_country pc ON m.movie_id = pc.movie_id
JOIN
    country c ON pc.country_id = c.country_id
JOIN
    movie_genres mg ON m.movie_id = mg.movie_id
JOIN
    genre g ON mg.genre_id = g.genre_id
WHERE
    c.country_name = 'India'
    AND m.release_date BETWEEN '2015-01-01' AND '2015-12-31';
```
-------------------------473 sample_num
```sql
SELECT p.person_name
FROM movie_cast mc
JOIN person p ON mc.person_id = p.person_id
WHERE mc.character_name = 'Optimus Prime (voice)';
```
-------------------------474 sample_num
```sql
SELECT g.gender
FROM movie_cast mc
JOIN gender g ON mc.gender_id = g.gender_id
WHERE mc.character_name = 'USAF Master Sgt. Epps';
```
-------------------------475 sample_num
```sql
SELECT pc.company_name
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE m.title = 'Ultramarines: A Warhammer 40,000 Movie';
```
-------------------------476 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Radiant Film GmbH';
```
-------------------------477 sample_num
```sql
SELECT g.genre_name
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE m.title = 'Sky Captain and the World of Tomorrow';
```
-------------------------478 sample_num
```sql
SELECT k.keyword_name
FROM movie_keywords mk
JOIN keyword k ON mk.keyword_id = k.keyword_id
JOIN movie m ON mk.movie_id = m.movie_id
WHERE m.title = 'Sky Captain and the World of Tomorrow';
```
-------------------------479 sample_num
```sql
SELECT c.country_name
FROM movie m
JOIN production_country pc ON m.movie_id = pc.movie_id
JOIN country c ON pc.country_id = c.country_id
WHERE m.title = 'Gojira ni-sen mireniamu';
```
-------------------------480 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_keywords mk ON m.movie_id = mk.movie_id
JOIN keyword k ON mk.keyword_id = k.keyword_id
WHERE k.keyword_name = 'extremis';
```
-------------------------481 sample_num
```sql
SELECT m.title
FROM movie m
JOIN production_country pc ON m.movie_id = pc.movie_id
JOIN country c ON pc.country_id = c.country_id
WHERE c.country_name = 'France'
LIMIT 10;
```
-------------------------482 sample_num
```sql
SELECT p.person_name
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'Transformers' AND mc.job = 'Director';
```
-------------------------483 sample_num
```sql
SELECT p.person_name, mc.job
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'Mad Max: Fury Road'
LIMIT 10;
```
-------------------------484 sample_num
```sql
SELECT
    (COUNT(CASE WHEN g.genre_name = 'animation' THEN m.movie_id END) * 100.0 / COUNT(m.movie_id)) AS percentage
FROM
    movie m
JOIN
    production_country pc ON m.movie_id = pc.movie_id
JOIN
    country c ON pc.country_id = c.country_id
JOIN
    movie_genres mg ON m.movie_id = mg.movie_id
JOIN
    genre g ON mg.genre_id = g.genre_id
WHERE
    c.country_name = 'Japan';
```
-------------------------485 sample_num
```sql
SELECT
    SUM(CASE WHEN g.gender = 'Female' THEN 1 ELSE 0 END) AS female_count,
    SUM(CASE WHEN g.gender = 'Male' THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN g.gender IS NULL THEN 1 ELSE 0 END) AS unspecified_gender_count,
    CASE
        WHEN SUM(CASE WHEN g.gender = 'Male' THEN 1 ELSE 0 END) = 0 THEN NULL
        ELSE SUM(CASE WHEN g.gender = 'Female' THEN 1 ELSE 0 END) * 1.0 / SUM(CASE WHEN g.gender = 'Male' THEN 1 ELSE 0 END)
    END AS gender_ratio
FROM
    movie_cast mc
JOIN
    movie m ON mc.movie_id = m.movie_id
JOIN
    gender g ON mc.gender_id = g.gender_id
WHERE
    m.title = 'Iron Man';
```
-------------------------486 sample_num
```sql
SELECT title
FROM movie
WHERE release_date < '2000-01-01'
LIMIT 5;
```
-------------------------487 sample_num
```sql
SELECT mk.keyword_id
FROM movie_keywords mk
JOIN movie m ON mk.movie_id = m.movie_id
WHERE m.title = 'Sin City';
```
-------------------------488 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_keywords mk ON m.movie_id = mk.movie_id
JOIN keyword k ON mk.keyword_id = k.keyword_id
WHERE k.keyword_name = 'angel';
```
-------------------------489 sample_num
```sql
SELECT k.keyword_name
FROM movie m
JOIN movie_keywords mk ON m.movie_id = mk.movie_id
JOIN keyword k ON mk.keyword_id = k.keyword_id
WHERE m.popularity = (SELECT MAX(popularity) FROM movie);
```
-------------------------490 sample_num
```sql
SELECT mg.genre_id
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
WHERE m.title = 'The Dark Knight';
```
-------------------------491 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE g.genre_name = 'Thriller';
```
-------------------------492 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE m.movie_status = 'rumoured' AND g.genre_name = 'Drama'
LIMIT 5;
```
-------------------------493 sample_num
```sql
SELECT g.genre_name
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE m.revenue = (SELECT MIN(revenue) FROM movie);
```
-------------------------494 sample_num
```sql
SELECT g.genre_name
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE m.runtime = 14;
```
-------------------------495 sample_num
```sql
SELECT g.genre_name
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE m.revenue = (SELECT MIN(revenue)
                   FROM movie
                   WHERE vote_average = (SELECT MAX(vote_average) FROM movie));
```
-------------------------496 sample_num
```sql
SELECT g.genre_name
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE m.tagline = 'A long time ago in a galaxy far, far away…';
```
-------------------------497 sample_num
```sql
SELECT pc.country_id
FROM movie m
JOIN production_country pc ON m.movie_id = pc.movie_id
WHERE m.title = 'Pirates of the Caribbean: Dead Man''s Chest';
```
-------------------------498 sample_num
```sql
SELECT m.title
FROM movie m
JOIN production_country pc ON m.movie_id = pc.movie_id
JOIN country c ON pc.country_id = c.country_id
WHERE c.country_name = 'Canada';
```
-------------------------499 sample_num
```sql
SELECT SUM(m.budget) AS total_budget
FROM movie m
JOIN movie_keywords mk ON m.movie_id = mk.movie_id
JOIN keyword k ON mk.keyword_id = k.keyword_id
WHERE k.keyword_name = 'video game';
```
-------------------------500 sample_num
```sql
SELECT AVG(m.revenue) AS average_revenue
FROM movie m
JOIN movie_keywords mk ON m.movie_id = mk.movie_id
JOIN keyword k ON mk.keyword_id = k.keyword_id
WHERE k.keyword_name = 'civil war';
```
-------------------------501 sample_num
```sql
SELECT title, popularity
FROM movie
WHERE vote_count = (SELECT MAX(vote_count) FROM movie);
```
-------------------------502 sample_num
```sql
SELECT title
FROM movie
WHERE budget = 0
ORDER BY revenue DESC
LIMIT 1;
```
-------------------------503 sample_num
```sql
SELECT pc.company_id
FROM production_company pc
JOIN movie_company mc ON pc.company_id = mc.company_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'Gladiator';
```
-------------------------504 sample_num
```sql
SELECT DISTINCT pc.company_id
FROM production_company pc
JOIN movie_company mc ON pc.company_id = mc.company_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.release_date LIKE '1916%';
```
-------------------------505 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Lucasfilm';
```
-------------------------506 sample_num
```sql
SELECT title
FROM movie
JOIN movie_company ON movie.movie_id = movie_company.movie_id
JOIN production_company ON movie_company.company_id = production_company.company_id
WHERE production_company.company_name = 'Warner Bros. Pictures'
ORDER BY revenue DESC
LIMIT 1;
```
-------------------------507 sample_num
```sql
SELECT m.release_date
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Twentieth Century Fox Film Corporation';
```
-------------------------508 sample_num
```sql
SELECT ml.language_id
FROM movie_languages ml
JOIN movie m ON ml.movie_id = m.movie_id
WHERE m.title = 'Walk the Line';
```
-------------------------509 sample_num
```sql
SELECT ml.language_id
FROM movie m
JOIN movie_languages ml ON m.movie_id = ml.movie_id
WHERE m.popularity = (SELECT MAX(popularity) FROM movie);
```
-------------------------510 sample_num
```sql
SELECT l.language_name
FROM movie m
JOIN movie_languages ml ON m.movie_id = ml.movie_id
JOIN language l ON ml.language_id = l.language_id
WHERE m.title = 'C''era una volta il West';
```
-------------------------511 sample_num
```sql
SELECT DISTINCT m.title
FROM movie m
JOIN movie_languages ml ON m.movie_id = ml.movie_id
JOIN language l ON ml.language_id = l.language_id
WHERE m.movie_status = 'Post Production' AND l.language_name = 'Nederlands';
```
-------------------------512 sample_num
```sql
SELECT m.tagline
FROM movie m
JOIN movie_languages ml ON m.movie_id = ml.movie_id
JOIN language l ON ml.language_id = l.language_id
WHERE l.language_name = 'Polski';
```
-------------------------513 sample_num
```sql
SELECT m.homepage
FROM movie m
JOIN movie_languages ml ON m.movie_id = ml.movie_id
JOIN language l ON ml.language_id = l.language_id
WHERE l.language_name = 'Bahasa Indonesia';
```
-------------------------514 sample_num
```sql
SELECT
    (SUM(CASE WHEN l.language_name = 'English' THEN m.revenue ELSE 0 END) -
     SUM(CASE WHEN l.language_name = 'Latin' THEN m.revenue ELSE 0 END)) AS revenue_difference
FROM
    movie m
JOIN
    movie_languages ml ON m.movie_id = ml.movie_id
JOIN
    language l ON ml.language_id = l.language_id;
```
-------------------------515 sample_num
```sql
SELECT SUM(m.revenue) AS total_revenue
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name IN ('Fantasy Films', 'Live Entertainment');
```
-------------------------516 sample_num
```sql
SELECT AVG(m.revenue) AS average_revenue
FROM movie m
JOIN movie_languages ml ON m.movie_id = ml.movie_id
JOIN language l ON ml.language_id = l.language_id
WHERE l.language_name = 'Latin';
```
-------------------------517 sample_num
```sql
SELECT SUBSTRING_INDEX(person_name, ' ', 1) AS first_name, COUNT(*) AS name_count
FROM person
GROUP BY first_name
ORDER BY name_count DESC
LIMIT 1;
```
-------------------------518 sample_num
```sql
SELECT AVG(crew_count) AS average_crew_count
FROM (
    SELECT movie_id, COUNT(person_id) AS crew_count
    FROM movie_crew
    GROUP BY movie_id
) AS crew_counts;
```
-------------------------519 sample_num
```sql
SELECT keyword_name FROM keyword WHERE keyword_name LIKE '%christmas%';
```
-------------------------520 sample_num
```sql
SELECT MAX(runtime) AS longest_runtime FROM movie;
```
-------------------------521 sample_num
```sql
SELECT country_iso_code FROM country WHERE country_name = 'Kyrgyz Republic';
```
-------------------------522 sample_num
```sql
SELECT overview FROM movie WHERE title = 'The Pacifier';
```
-------------------------523 sample_num
```sql
SELECT COUNT(DISTINCT mc.movie_id) AS movie_count
FROM movie_company mc
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Eddie Murphy Productions';
```
-------------------------524 sample_num
```sql
SELECT DISTINCT p.person_name
FROM person p
JOIN movie_cast mc ON p.person_id = mc.person_id
WHERE mc.character_name LIKE '%captain%';
```
-------------------------525 sample_num
```sql
SELECT k.keyword_name
FROM movie_keywords mk
JOIN keyword k ON mk.keyword_id = k.keyword_id
JOIN movie m ON mk.movie_id = m.movie_id
WHERE m.release_date LIKE '%2006%'
GROUP BY k.keyword_name
ORDER BY COUNT(k.keyword_name) DESC
LIMIT 1;
```
-------------------------526 sample_num
```sql
SELECT COUNT(*)
FROM movie_languages
WHERE language_id IN (SELECT language_id FROM language WHERE language_code = 'vi');
```
-------------------------527 sample_num
```sql
SELECT genre_name
FROM genre g
JOIN movie_genres mg ON g.genre_id = mg.genre_id
GROUP BY g.genre_id, g.genre_name
ORDER BY COUNT(mg.movie_id) ASC
LIMIT 1 OFFSET 2;
```
-------------------------528 sample_num
```sql
SELECT l.language_name
FROM movie_languages ml
JOIN language l ON ml.language_id = l.language_id
WHERE ml.movie_id = (SELECT m.movie_id
                     FROM movie m
                     WHERE m.tagline = "An offer you can't refuse.")
AND ml.language_role_id = (SELECT lr.role_id
                           FROM language_role lr
                           WHERE lr.language_role = 'Original');
```
-------------------------529 sample_num
```sql
SELECT AVG(m.revenue) AS average_revenue
FROM movie m
JOIN production_country pc ON m.movie_id = pc.movie_id
JOIN country c ON pc.country_id = c.country_id
WHERE c.country_name = 'France';
```
-------------------------530 sample_num
```sql
SELECT character_name
FROM movie_cast
WHERE gender_id = (SELECT gender_id FROM gender WHERE gender = 'Unspecified');
```
-------------------------531 sample_num
```sql
SELECT pc.person_name, MAX(m.popularity) AS max_popularity
FROM movie_crew mc
JOIN person pc ON mc.person_id = pc.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE mc.job = 'Director'
GROUP BY pc.person_name
ORDER BY max_popularity DESC
LIMIT 5;
```
-------------------------532 sample_num
```sql
SELECT g.genre_name, m.title, m.budget
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE m.budget = (
    SELECT MAX(m2.budget)
    FROM movie m2
    JOIN movie_genres mg2 ON m2.movie_id = mg2.movie_id
    WHERE mg2.genre_id = mg.genre_id
)
ORDER BY g.genre_name;
```
-------------------------533 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_keywords mk ON m.movie_id = mk.movie_id
GROUP BY m.movie_id
ORDER BY COUNT(mk.keyword_id) DESC
LIMIT 1;
```
-------------------------534 sample_num
```sql
SELECT d.department_name, COUNT(mc.person_id) AS people_count
FROM department d
JOIN movie_crew mc ON d.department_id = mc.department_id
GROUP BY d.department_name
ORDER BY people_count DESC
LIMIT 1;
```
-------------------------535 sample_num
```sql
SELECT
    (SUM(CASE WHEN pc.country_id IN (SELECT country_id FROM country WHERE country_iso_code = 'US') THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage
FROM
    movie m
JOIN
    production_country pc ON m.movie_id = pc.movie_id;
```
-------------------------536 sample_num
```sql
SELECT
    AVG(CASE
            WHEN gender = 'Female' THEN female_count
            ELSE 0
        END / NULLIF(male_count, 0)) AS average_female_to_male_ratio
FROM (
    SELECT
        mc.movie_id,
        SUM(CASE WHEN m.gender_id = (SELECT gender_id FROM gender WHERE gender = 'Female') THEN 1 ELSE 0 END) AS female_count,
        SUM(CASE WHEN m.gender_id = (SELECT gender_id FROM gender WHERE gender = 'Male') THEN 1 ELSE 0 END) AS male_count
    FROM
        movie_cast mc
    JOIN
        person p ON mc.person_id = p.person_id
    JOIN
        gender m ON mc.gender_id = m.gender_id
    GROUP BY
        mc.movie_id
) AS gender_counts;
```
-------------------------537 sample_num
```sql
SELECT title FROM movie WHERE release_date LIKE '1945%';
```
-------------------------538 sample_num
```sql
SELECT country_id, country_iso_code FROM country WHERE country_name = 'Belgium';
```
-------------------------539 sample_num
```sql
SELECT mc.character_name
FROM movie_cast mc
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'Catherine Deneuve';
```
-------------------------540 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_languages ml ON m.movie_id = ml.movie_id
JOIN language l ON ml.language_id = l.language_id
WHERE l.language_name = 'Somali';
```
-------------------------541 sample_num
```sql
SELECT m.release_date, l.language_name
FROM movie m
JOIN movie_languages ml ON m.movie_id = ml.movie_id
JOIN language l ON ml.language_id = l.language_id
WHERE m.popularity = (SELECT MAX(popularity) FROM movie);
```
-------------------------542 sample_num
```sql
SELECT l.language_name
FROM movie_languages ml
JOIN language l ON ml.language_id = l.language_id
WHERE ml.movie_id = (SELECT movie_id FROM movie WHERE title = 'Four Rooms')
AND ml.language_role_id = (SELECT role_id FROM language_role WHERE language_role = 'Original');
```
-------------------------543 sample_num
```sql
SELECT character_name
FROM movie_cast
WHERE movie_id = (SELECT movie_id FROM movie WHERE title = 'Open Water');
```
-------------------------544 sample_num
```sql
SELECT pc.person_name
FROM movie_cast mc
JOIN person pc ON mc.person_id = pc.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'Pirates of the Caribbean: At World''s End'
AND mc.cast_order = (SELECT MIN(cast_order) FROM movie_cast WHERE movie_id = m.movie_id);
```
-------------------------545 sample_num
```sql
SELECT p.person_name
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
WHERE mc.job = 'Camera Supervisor';
```
-------------------------546 sample_num
```sql
SELECT job FROM movie_crew
WHERE person_id = (SELECT person_id FROM person WHERE person_name = 'Sally Menke');
```
-------------------------547 sample_num
```sql
SELECT p.person_name, d.department_name
FROM person p
JOIN movie_crew mc ON p.person_id = mc.person_id
JOIN department d ON mc.department_id = d.department_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE mc.job = 'Music Editor' AND m.title = 'Pirates of the Caribbean: At World''s End';
```
-------------------------548 sample_num
```sql
SELECT m.title, m.revenue
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'DreamWorks';
```
-------------------------549 sample_num
```sql
SELECT COUNT(m.movie_id) AS number_of_movies
FROM movie m
JOIN production_country pc ON m.movie_id = pc.movie_id
JOIN country c ON pc.country_id = c.country_id
WHERE c.country_name = 'Canada';
```
-------------------------550 sample_num
```sql
SELECT g.genre_name
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE m.title = 'Forrest Gump';
```
-------------------------551 sample_num
```sql
SELECT pc.company_name
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE m.release_date LIKE '2016%'
AND (m.runtime - (SELECT AVG(runtime) FROM movie WHERE release_date LIKE '2016%')) / (SELECT AVG(runtime) FROM movie WHERE release_date LIKE '2016%') * 100 > 35;
```
-------------------------552 sample_num
```sql
SELECT
    (COUNT(CASE WHEN k.keyword_name = 'woman director' THEN mk.movie_id END) -
     COUNT(CASE WHEN k.keyword_name = 'independent film' THEN mk.movie_id END)) * 100.0 /
    COUNT(mk.movie_id) AS percentage
FROM
    movie_keywords mk
JOIN
    keyword k ON mk.keyword_id = k.keyword_id;
```
-------------------------553 sample_num
```sql
SELECT g.genre_name
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE m.title = 'Dancer in the Dark';
```
-------------------------554 sample_num
```sql
SELECT COUNT(*)
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE g.genre_name = 'Adventure' AND m.release_date LIKE '2000%';
```
-------------------------555 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_company mc ON m.movie_id = mc.movie_id
JOIN production_company pc ON mc.company_id = pc.company_id
WHERE pc.company_name = 'Paramount Pictures'
AND m.release_date LIKE '2000%';
```
-------------------------556 sample_num
```sql
SELECT k.keyword_name
FROM movie_keywords mk
JOIN keyword k ON mk.keyword_id = k.keyword_id
JOIN movie m ON mk.movie_id = m.movie_id
WHERE m.title = 'Finding Nemo';
```
-------------------------557 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_genres mg ON m.movie_id = mg.movie_id
JOIN genre g ON mg.genre_id = g.genre_id
WHERE g.genre_name = 'horror' AND m.vote_average > 7;
```
-------------------------558 sample_num
```sql
SELECT COUNT(*) AS production_company_count
FROM production_company
WHERE company_id IN (
    SELECT company_id
    FROM movie_company
    GROUP BY company_id
    HAVING COUNT(movie_id) > 150
);
```
-------------------------559 sample_num
```sql
SELECT DISTINCT mc.job
FROM person p
JOIN movie_crew mc ON p.person_id = mc.person_id
WHERE p.person_name = 'Mark Hammil';
```
-------------------------560 sample_num
```sql
SELECT COUNT(*) AS main_actor_count
FROM movie_cast mc
JOIN movie m ON mc.movie_id = m.movie_id
JOIN gender g ON mc.gender_id = g.gender_id
WHERE m.title = 'Pirates of the Caribbean: At World''s End'
AND g.gender = 'male'
AND mc.cast_order = (SELECT MIN(cast_order)
                     FROM movie_cast
                     WHERE movie_id = m.movie_id);
```
-------------------------561 sample_num
```sql
SELECT m.title
FROM movie m
JOIN movie_cast mc ON m.movie_id = mc.movie_id
JOIN person p ON mc.person_id = p.person_id
WHERE p.person_name = 'Harrison Ford';
```
-------------------------562 sample_num
```sql
SELECT mc.character_name
FROM movie_cast mc
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'Pirates of the Caribbean: The Curse of the Black Pearl'
AND mc.person_id = (SELECT person_id FROM person WHERE person_name = 'Orlando Bloom');
```
-------------------------563 sample_num
```sql
SELECT AVG(horror_count) AS average_horror_movies
FROM (
    SELECT COUNT(mg.movie_id) AS horror_count
    FROM movie_genres mg
    JOIN genre g ON mg.genre_id = g.genre_id
    GROUP BY mg.movie_id
    HAVING g.genre_name = 'horror'
) AS horror_movies;
```
-------------------------564 sample_num
```sql
SELECT p.person_name
FROM movie_crew mc
JOIN person p ON mc.person_id = p.person_id
JOIN movie m ON mc.movie_id = m.movie_id
WHERE m.title = 'Pirates of the Caribbean: At World\'s End' AND mc.job = 'Producer';
```
-------------------------565 sample_num
```sql
SELECT m.title, AVG(m.revenue) AS average_income
FROM movie m
JOIN movie_keywords mk ON m.movie_id = mk.movie_id
JOIN keyword k ON mk.keyword_id = k.keyword_id
WHERE k.keyword_name = 'paris'
GROUP BY m.title;
```
-------------------------566 sample_num
```sql
SELECT COUNT(*)
FROM Method
WHERE Lang = 'en' AND CommentIsXml = 1;
```
-------------------------567 sample_num
```sql
SELECT SUBSTRING_INDEX(Name, '.', 2) AS Task
FROM Method
WHERE NameTokenized = 'online median filter test median window filling';
```
-------------------------568 sample_num
```sql
SELECT SolutionId, SampledAt
FROM Method
WHERE SampledAt = (SELECT MAX(SampledAt) FROM Method);
```
-------------------------569 sample_num
```sql
SELECT Url, Forks
FROM Repo
WHERE Forks = (SELECT MAX(Forks) FROM Repo);
```
-------------------------570 sample_num
```sql
SELECT RepoId
FROM Solution
GROUP BY RepoId
ORDER BY COUNT(Path) DESC
LIMIT 1;
```
-------------------------571 sample_num
```sql
SELECT Url, Stars
FROM Repo
ORDER BY Stars DESC
LIMIT 1;
```
-------------------------572 sample_num
```sql
SELECT Path
FROM Solution
WHERE ProcessedTime = (SELECT MAX(ProcessedTime) FROM Solution);
```
-------------------------573 sample_num
```sql
SELECT ProcessedTime
FROM Repo
WHERE Id = (SELECT Id FROM Repo ORDER BY Watchers DESC LIMIT 1);
```
-------------------------574 sample_num
```sql
SELECT r.Url
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE s.Path = 'nofear_Mara\\Mara.sln';
```
-------------------------575 sample_num
```sql
SELECT r.Url, MAX(r.ProcessedTime) AS LongestProcessedTime, s.WasCompiled
FROM Repo r
JOIN Solution s ON r.Id = s.RepoId
GROUP BY r.Url, s.WasCompiled
HAVING s.WasCompiled = 1
ORDER BY LongestProcessedTime DESC
LIMIT 1;
```
-------------------------576 sample_num
```sql
SELECT m.NameTokenized
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE s.Path = 'maravillas_linq-to-delicious\tasty.sln';
```
-------------------------577 sample_num
```sql
SELECT r.Id, r.Url, COUNT(s.Path) AS SolutionPathCount
FROM Repo r
JOIN Solution s ON r.Id = s.RepoId
WHERE r.Stars BETWEEN 6000 AND 9000
GROUP BY r.Id, r.Url
HAVING COUNT(s.Path) = (
    SELECT MAX(SolutionPathCount)
    FROM (
        SELECT COUNT(s2.Path) AS SolutionPathCount
        FROM Repo r2
        JOIN Solution s2 ON r2.Id = s2.RepoId
        WHERE r2.Stars BETWEEN 6000 AND 9000
        GROUP BY r2.Id
    ) AS subquery
)
AND SUM(CASE WHEN s.WasCompiled = 0 THEN 1 ELSE 0 END) > 0;
```
-------------------------578 sample_num
```sql
SELECT M.ApiCalls
FROM Method M
JOIN Solution S ON M.SolutionId = S.Id
JOIN Repo R ON S.RepoId = R.Id
WHERE R.Url = 'https://github.com/wallerdev/htmlsharp.git';
```
-------------------------579 sample_num
```sql
SELECT COUNT(Path)
FROM Solution
WHERE RepoId = (
    SELECT Id
    FROM Repo
    ORDER BY Watchers DESC
    LIMIT 1 OFFSET 1
);
```
-------------------------580 sample_num
```sql
SELECT AVG(Solution.ProcessedTime) AS AverageProcessedTime
FROM Solution
JOIN Repo ON Solution.RepoId = Repo.Id
WHERE Repo.Url = 'https://github.com/zphingphong/DiscardCustomerApp.git';
```
-------------------------581 sample_num
```sql
SELECT m.FullComment
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE s.Path = 'bmatzelle_nini\Source\Nini.sln'
AND m.NameTokenized = 'alias text add alias';
```
-------------------------582 sample_num
```sql
SELECT m.ApiCalls
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE s.Path = 'mauriciodeamorim_tdd.encontro2\Tdd.Encontro2.sln';
```
-------------------------583 sample_num
```sql
SELECT COUNT(*)
FROM Solution
WHERE RepoId = (SELECT Id FROM Repo WHERE Url = 'https://github.com/jeffdik/tachy.git')
AND WasCompiled = 0;
```
-------------------------584 sample_num
```sql
SELECT ProcessedTime, Lang
FROM Method
WHERE NameTokenized = 'about box1 dispose';
```
-------------------------585 sample_num
```sql
SELECT m.SampledAt
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Name = 'GitHubRepo.Cli.GitHubClientWrapper.GetReleases'
AND s.Path = 'maxild_playground\Playground.sln';
```
-------------------------586 sample_num
```sql
SELECT m.Lang
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE s.Path = 'opendns_diagnosticapp\windows\OpenDnsDiagnostic.sln';
```
-------------------------587 sample_num
```sql
SELECT SUBSTRING_INDEX(Name, '.', 2) AS Task
FROM Method
WHERE NameTokenized = 'html parser feed';
```
-------------------------588 sample_num
```sql
SELECT CommentIsXml
FROM Method
WHERE Name = 'HtmlSharp.HtmlParser.Feed';
```
-------------------------589 sample_num
```sql
SELECT * FROM Method WHERE Summary = 'Write a command to the log';
```
-------------------------590 sample_num
```sql
SELECT COUNT(*)
FROM Solution
WHERE RepoId = (SELECT Id FROM Repo ORDER BY Stars DESC LIMIT 1);
```
-------------------------591 sample_num
```sql
SELECT s.Path
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE r.Stars = (SELECT MAX(Stars) FROM Repo);
```
-------------------------592 sample_num
```sql
SELECT r.Url
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE s.Id = 12;
```
-------------------------593 sample_num
```sql
SELECT COUNT(*)
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE r.Forks > 1000 AND s.WasCompiled = 1;
```
-------------------------594 sample_num
```sql
SELECT
    CASE
        WHEN (SELECT Watchers FROM Repo WHERE Id = (SELECT RepoId FROM Solution WHERE Id = 18)) >
             (SELECT Watchers FROM Repo WHERE Id = (SELECT RepoId FROM Solution WHERE Id = 19))
        THEN 18
        ELSE 19
    END AS MorePopularSolution
```
-------------------------595 sample_num
```sql
SELECT COUNT(*)
FROM Solution
WHERE ProcessedTime = (SELECT MAX(ProcessedTime) FROM Solution)
AND WasCompiled = 0;
```
-------------------------596 sample_num
```sql
SELECT r.ProcessedTime
FROM Repo r
JOIN Solution s ON r.Id = s.RepoId
WHERE s.Path = 'jeffdik_tachy\src\Tachy.sln';
```
-------------------------597 sample_num
```sql
SELECT r.Url
FROM Repo r
JOIN Solution s ON r.Id = s.RepoId
WHERE s.Id = 9;
```
-------------------------598 sample_num
```sql
SELECT Solution.Path
FROM Solution
JOIN Repo ON Solution.RepoId = Repo.Id
WHERE Repo.Url = 'https://github.com/maxild/playground.git';
```
-------------------------599 sample_num
```sql
SELECT COUNT(DISTINCT r.Id)
FROM Repo r
JOIN Solution s ON r.Id = s.RepoId
WHERE r.Stars > 200 AND s.ProcessedTime < 636439500080712000;
```
-------------------------600 sample_num
```sql
SELECT DISTINCT s.Id
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
ORDER BY r.Forks DESC
LIMIT 3;
```
-------------------------601 sample_num
```sql
SELECT AVG(Solution.ProcessedTime) AS AverageProcessingTime
FROM Solution
JOIN Repo ON Solution.RepoId = Repo.Id
WHERE Repo.Url = 'https://github.com/jeffdik/tachy.git';
```
-------------------------602 sample_num
```sql
SELECT
    (SELECT Forks FROM Repo WHERE Id = (SELECT RepoId FROM Solution WHERE Id = 18)) -
    (SELECT Forks FROM Repo WHERE Id = (SELECT RepoId FROM Solution WHERE Id = 19)) AS ForksDifference,
    ((SELECT Forks FROM Repo WHERE Id = (SELECT RepoId FROM Solution WHERE Id = 18)) -
    (SELECT Forks FROM Repo WHERE Id = (SELECT RepoId FROM Solution WHERE Id = 19))) * 100.0 /
    (SELECT Forks FROM Repo WHERE Id = (SELECT RepoId FROM Solution WHERE Id = 19)) AS PercentageDifference
```
-------------------------603 sample_num
```sql
SELECT Lang FROM Method WHERE Name = 'PixieTests.SqlConnectionLayerTests.TestSqlCreateGuidColumn';
```
-------------------------604 sample_num
```sql
SELECT FullComment
FROM Method
WHERE Name = 'DE2_UE_Fahrradkurier.de2_uebung_fahrradkurierDataSet1TableAdapters.TableAdapterManager.UpdateInsertedRows';
```
-------------------------605 sample_num
```sql
SELECT Summary
FROM Method
WHERE Name = 'Castle.MonoRail.Framework.Test.StubViewComponentContext.RenderSection';
```
-------------------------606 sample_num
```sql
SELECT NameTokenized FROM Method WHERE Name = 'Supay.Irc.Messages.KnockMessage.GetTokens';
```
-------------------------607 sample_num
```sql
SELECT Stars FROM Repo WHERE Id = (SELECT RepoId FROM Solution WHERE Id = 45997);
```
-------------------------608 sample_num
```sql
SELECT COUNT(*) AS SolutionCount
FROM Solution
WHERE RepoId = (SELECT Id FROM Repo WHERE Stars = 8094);
```
-------------------------609 sample_num
```sql
SELECT s.Path
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Name = 'IQ.Data.DbQueryProvider.CanBeEvaluatedLocally';
```
-------------------------610 sample_num
```sql
SELECT s.ProcessedTime
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.NameTokenized = 'interp parser expr';
```
-------------------------611 sample_num
```sql
SELECT s.RepoId
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Name = 'SCore.Poisson.ngtIndex';
```
-------------------------612 sample_num
```sql
SELECT s.Path
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Name = 'ExportToRTF.RTFStyleSheet.H6Write';
```
-------------------------613 sample_num
```sql
SELECT COUNT(*)
FROM Solution
WHERE RepoId = (SELECT Id FROM Repo WHERE Watchers = 8094);
```
-------------------------614 sample_num
```sql
SELECT r.Url
FROM Repo r
JOIN Solution s ON r.Id = s.RepoId
GROUP BY r.Url
ORDER BY COUNT(s.Id) DESC
LIMIT 1;
```
-------------------------615 sample_num
```sql
SELECT COUNT(*)
FROM Solution
WHERE RepoId = (SELECT Id FROM Repo WHERE Forks = 1445);
```
-------------------------616 sample_num
```sql
SELECT Path
FROM Solution s
JOIN Method m ON s.Id = m.SolutionId
WHERE m.Lang = 'zh-cn'
GROUP BY Path
ORDER BY COUNT(Path) DESC
LIMIT 1;
```
-------------------------617 sample_num
```sql
SELECT r.Watchers
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE s.Id = 338082;
```
-------------------------618 sample_num
```sql
SELECT COUNT(*)
FROM Solution
WHERE RepoId = (SELECT Id FROM Repo WHERE Stars = 189)
AND WasCompiled = 0;
```
-------------------------619 sample_num
```sql
SELECT s.Path
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Name = 'Mosa.Platform.x86.Instructions.IMul.EmitLegacy';
```
-------------------------620 sample_num
```sql
SELECT s.ProcessedTime
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.NameTokenized = 't jadwal entity get single mpic';
```
-------------------------621 sample_num
```sql
SELECT s.RepoId
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Name = 'Kalibrasi.Data.EntityClasses.THistoryJadwalEntity.GetSingleTjadwal';
```
-------------------------622 sample_num
```sql
SELECT s.Path
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Summary = 'Refetches the Entity from the persistent storage. Refetch is used to re-load an Entity which is marked "Out-of-sync", due to a save action. Refetching an empty Entity has no effect.';
```
-------------------------623 sample_num
```sql
SELECT COUNT(*)
FROM Solution
WHERE RepoId = (SELECT Id FROM Repo WHERE Stars = 3060);
```
-------------------------624 sample_num
```sql
SELECT s.Path
FROM Solution s
JOIN Method m ON s.Id = m.SolutionId
WHERE m.Lang = 'sw'
GROUP BY s.Id
ORDER BY COUNT(m.Lang) DESC
LIMIT 1;
```
-------------------------625 sample_num
```sql
SELECT
    (SELECT r1.Watchers
     FROM Solution s1
     JOIN Repo r1 ON s1.RepoId = r1.Id
     WHERE s1.Id = 83855) * 100.0 /
    (SELECT r2.Watchers
     FROM Solution s2
     JOIN Repo r2 ON s2.RepoId = r2.Id
     WHERE s2.Id = 1502) - 100 AS PercentageIncrease;
```
-------------------------626 sample_num
```sql
SELECT
    (SELECT r1.Stars
     FROM Solution s1
     JOIN Repo r1 ON s1.RepoId = r1.Id
     WHERE s1.Id = 51424) * 100.0 /
    (SELECT r2.Stars
     FROM Solution s2
     JOIN Repo r2 ON s2.RepoId = r2.Id
     WHERE s2.Id = 167053) - 100 AS PercentMoreStars;
```
-------------------------627 sample_num
```sql
SELECT
    ( (r1.Forks - r2.Forks) * 100.0 / r2.Forks ) AS PercentMoreForks
FROM
    Solution s1
JOIN
    Repo r1 ON s1.RepoId = r1.Id
JOIN
    Solution s2 ON s2.Id = 1502
JOIN
    Repo r2 ON s2.RepoId = r2.Id
WHERE
    s1.Id = 53546;
```
-------------------------628 sample_num
```sql
SELECT m.Name
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE s.ProcessedTime = '636449700980488000';
```
-------------------------629 sample_num
```sql
SELECT COUNT(*)
FROM Solution
WHERE RepoId = (SELECT Id FROM Repo WHERE Url = 'https://github.com/derickbailey/presentations-and-training.git');
```
-------------------------630 sample_num
```sql
SELECT SUM(S.ProcessedTime) AS TotalProcessedTime
FROM Solution S
JOIN Repo R ON S.RepoId = R.Id
WHERE R.Id = (
    SELECT R2.Id
    FROM Repo R2
    ORDER BY R2.Forks DESC
    LIMIT 1
);
```
-------------------------631 sample_num
```sql
SELECT DISTINCT s.Path
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Lang = 'it';
```
-------------------------632 sample_num
```sql
SELECT s.Path
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Name = 'spinachLexer.mT__55';
```
-------------------------633 sample_num
```sql
SELECT m.*
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Lang = 'en' AND s.RepoId = 1093;
```
-------------------------634 sample_num
```sql
SELECT Path FROM Solution WHERE RepoId = (SELECT Id FROM Repo WHERE Url = 'https://github.com/ecoffey/Bebop.git');
```
-------------------------635 sample_num
```sql
SELECT DISTINCT r.Id
FROM Repo r
JOIN Solution s ON r.Id = s.RepoId
JOIN Method m ON s.Id = m.SolutionId
WHERE m.Lang = 'ro';
```
-------------------------636 sample_num
```sql
SELECT Solution.RepoId
FROM Method
JOIN Solution ON Method.SolutionId = Solution.Id
WHERE Method.NameTokenized = 'crc parameters get hash code';
```
-------------------------637 sample_num
```sql
SELECT COUNT(*)
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE s.Path = 'maravillas_linq-to-delicious\tasty.sln';
```
-------------------------638 sample_num
```sql
SELECT Id FROM Solution WHERE ProcessedTime = '636430969128176000';
```
-------------------------639 sample_num
```sql
SELECT r.Url
FROM Repo r
JOIN Solution s ON r.Id = s.RepoId
WHERE s.ProcessedTime = (SELECT MAX(ProcessedTime) FROM Solution);
```
-------------------------640 sample_num
```sql
SELECT *
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE r.Forks > (r.Watchers / 2);
```
-------------------------641 sample_num
```sql
SELECT (F.Forks * 100.0 / S.Stars) AS Percentage
FROM Solution AS S
JOIN Repo AS R ON S.RepoId = R.Id
WHERE S.Id = 104086;
```
-------------------------642 sample_num
```sql
SELECT Id FROM Repo WHERE Stars = (SELECT MAX(Stars) FROM Repo);
```
-------------------------643 sample_num
```sql
SELECT s.Path
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Name = 'HtmlSharp.HtmlParser.Feed';
```
-------------------------644 sample_num
```sql
SELECT r.Forks
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE s.Id = 35;
```
-------------------------645 sample_num
```sql
SELECT Id FROM Solution
WHERE RepoId = (SELECT Id FROM Repo ORDER BY Watchers DESC LIMIT 1);
```
-------------------------646 sample_num
```sql
SELECT Stars FROM Repo WHERE Id = (SELECT RepoId FROM Solution WHERE Id = 20);
```
-------------------------647 sample_num
```sql
SELECT COUNT(m.Id) AS MethodCount, s.WasCompiled
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE s.Id = 1;
```
-------------------------648 sample_num
```sql
SELECT
    (SUM(CASE WHEN s.WasCompiled = 0 THEN 1 ELSE 0 END) * 100.0 / COUNT(s.Id)) AS Percentage
FROM
    Method m
JOIN
    Solution s ON m.SolutionId = s.Id
WHERE
    m.CommentIsXml = 1;
```
-------------------------649 sample_num
```sql
SELECT m.Name
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE s.Path = 'wallerdev_htmlsharp\HtmlSharp.sln';
```
-------------------------650 sample_num
```sql
SELECT DIVIDE(MULTIPLY(COUNT(CASE WHEN Stars > 2000 THEN 1 END), 100), COUNT(Id)) AS Percentage
FROM Repo;
```
-------------------------651 sample_num
```sql
SELECT r.Url
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE s.Id = 1;
```
-------------------------652 sample_num
```sql
SELECT Id
FROM Repo
WHERE Stars = 21
ORDER BY Forks DESC
LIMIT 1;
```
-------------------------653 sample_num
```sql
SELECT
    (COUNT(CASE WHEN Lang = 'en' THEN 1 END) * 100.0 / COUNT(*)) AS PercentageEnglishMethods
FROM
    Method
WHERE
    CommentIsXml = 1;
```
-------------------------654 sample_num
```sql
SELECT s.Path
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.NameTokenized = 'html parser feed';
```
-------------------------655 sample_num
```sql
SELECT s.Id
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE r.Forks = 238;
```
-------------------------656 sample_num
```sql
SELECT NameTokenized
FROM Method
WHERE Lang = 'en' AND SolutionId IN (SELECT Id FROM Solution WHERE WasCompiled = 0);
```
-------------------------657 sample_num
```sql
SELECT COUNT(*)
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE (r.Stars * (1/3)) > r.Forks;
```
-------------------------658 sample_num
```sql
SELECT s.Path
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.FullComment = 'Feeds data into the parser';
```
-------------------------659 sample_num
```sql
SELECT COUNT(*)
FROM Method
WHERE SolutionId IN (SELECT Id FROM Solution WHERE RepoId = 3)
AND CommentIsXml = 1;
```
-------------------------660 sample_num
```sql
SELECT
    (SUM(CASE WHEN s.WasCompiled = 0 THEN 1 ELSE 0 END) * 100.0 / COUNT(s.Id)) AS PercentageOfUncompiledSolutions
FROM
    Method m
JOIN
    Solution s ON m.SolutionId = s.Id
WHERE
    m.Lang = 'en';
```
-------------------------661 sample_num
```sql
SELECT
    (100.0 * (r1.Stars - r2.Stars) / r2.Stars) AS PercentageDifference
FROM
    Solution s1
JOIN
    Repo r1 ON s1.RepoId = r1.Id
JOIN
    Solution s2 ON s2.Id = 2
JOIN
    Repo r2 ON s2.RepoId = r2.Id
WHERE
    s1.Id = 1;
```
-------------------------662 sample_num
```sql
SELECT COUNT(*)
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE r.Stars > (r.Forks / 3);
```
-------------------------663 sample_num
```sql
SELECT SUBSTRING_INDEX(Name, '.', -1) AS Task
FROM Method
WHERE Id = 2;
```
-------------------------664 sample_num
```sql
SELECT CommentIsXml FROM Method WHERE Id = 8;
```
-------------------------665 sample_num
```sql
SELECT Url FROM Repo WHERE Watchers = (SELECT MAX(Watchers) FROM Repo);
```
-------------------------666 sample_num
```sql
SELECT SUBSTRING_INDEX(m.Name, '.', -1) AS Task
FROM Method m
WHERE m.Lang = 'cs';
```
-------------------------667 sample_num
```sql
SELECT s.Path
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Id = 3;
```
-------------------------668 sample_num
```sql
SELECT Lang
FROM Method
WHERE Id = 28 AND SolutionId IN (SELECT Id FROM Solution WHERE RepoId = 3);
```
-------------------------669 sample_num
```sql
SELECT s.ProcessedTime, COUNT(m.Id) AS MethodCount
FROM Solution s
LEFT JOIN Method m ON s.Id = m.SolutionId
WHERE s.Id = 1
GROUP BY s.ProcessedTime;
```
-------------------------670 sample_num
```sql
SELECT COUNT(*) AS MethodCount
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.NameTokenized LIKE 'query language%'
GROUP BY s.RepoId
HAVING COUNT(m.Id) > 1;
```
-------------------------671 sample_num
```sql
SELECT M.ApiCalls, S.Path
FROM Method M
JOIN Solution S ON M.SolutionId = S.Id
WHERE M.Id = 10;
```
-------------------------672 sample_num
```sql
SELECT COUNT(*)
FROM Method
WHERE SolutionId IN (SELECT Id FROM Solution WHERE RepoId = 150)
AND FullComment IS NULL
AND Summary IS NULL;
```
-------------------------673 sample_num
```sql
SELECT m.CommentIsXml
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE m.Id = 50 AND s.Path = 'managedfusion_managedfusion\ManagedFusion.sln';
```
-------------------------674 sample_num
```sql
SELECT Name
FROM Method
WHERE NameTokenized = 'string extensions to pascal case';
```
-------------------------675 sample_num
```sql
SELECT NameTokenized FROM Method WHERE Name = 'Sky.Excel.ExcelBook.TypeConvert';
```
-------------------------676 sample_num
```sql
SELECT COUNT(Path)
FROM Solution
WHERE RepoId = (SELECT Id FROM Repo WHERE Url = 'https://github.com/jeffdik/tachy.git');
```
-------------------------677 sample_num
```sql
SELECT r.Watchers
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE s.Path = 'maff_se3ue7\US7.sln';
```
-------------------------678 sample_num
```sql
SELECT Url
FROM Repo
JOIN Solution ON Repo.Id = Solution.RepoId
WHERE Solution.WasCompiled = 1
LIMIT 5;
```
-------------------------679 sample_num
```sql
SELECT s.Path
FROM Solution s
JOIN Method m ON s.Id = m.SolutionId
WHERE m.NameTokenized = 'matrix multiply';
```
-------------------------680 sample_num
```sql
SELECT COUNT(*)
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
JOIN Repo r ON s.RepoId = r.Id
WHERE r.Url = 'https://github.com/dogeth/vss2git.git' AND m.CommentIsXml = 1;
```
-------------------------681 sample_num
```sql
SELECT DISTINCT s.Path
FROM Solution s
JOIN Method m ON s.Id = m.SolutionId
WHERE m.SampledAt = '636431758961741000'
LIMIT 5;
```
-------------------------682 sample_num
```sql
SELECT r.Url
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE s.Path = 'joeyrobert_bloomfilter\DataTypes.BloomFilter.sln';
```
-------------------------683 sample_num
```sql
SELECT m.Name
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE s.Path = 'graffen_NLog.Targets.Syslog\src\NLog.Targets.Syslog.sln';
```
-------------------------684 sample_num
```sql
SELECT m.NameTokenized
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
WHERE s.Path = 'jurney_P4Backup\P4Backup\P4Backup.sln';
```
-------------------------685 sample_num
```sql
SELECT r.Url, m.Summary
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
JOIN Repo r ON s.RepoId = r.Id
WHERE m.Summary = 'A test for Decompose';
```
-------------------------686 sample_num
```sql
SELECT Stars
FROM Solution s
JOIN Repo r ON s.RepoId = r.Id
WHERE s.Path = 'ninject_Ninject\Ninject.sln';
```
-------------------------687 sample_num
```sql
SELECT COUNT(Path)
FROM Solution
WHERE RepoId = (SELECT Id FROM Repo WHERE Stars = 111 AND Forks = 58 AND Watchers = 111);
```
-------------------------688 sample_num
```sql
SELECT AVG(S.ProcessedTime) AS AverageProcessedTime
FROM Solution S
JOIN Repo R ON S.RepoId = R.Id
WHERE R.Stars = 254 AND R.Forks = 88 AND R.Watchers = 254;
```
-------------------------689 sample_num
```sql
SELECT COUNT(DISTINCT m.Lang)
FROM Method m
JOIN Solution s ON m.SolutionId = s.Id
JOIN Repo r ON s.RepoId = r.Id
WHERE r.Url = 'https://github.com/managedfusion/managedfusion.git';
```
-------------------------690 sample_num
```sql
SELECT COUNT(*) FROM trains WHERE direction = 'east';
```
-------------------------691 sample_num
```sql
SELECT COUNT(*) FROM cars WHERE train_id = 1;
```
-------------------------692 sample_num
```sql
SELECT shape FROM cars WHERE train_id = 1 AND position = 4;
```
-------------------------693 sample_num
```sql
SELECT DISTINCT t.id
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE c.shape IN ('elipse', 'bucket');
```
-------------------------694 sample_num
```sql
SELECT COUNT(*)
FROM cars
WHERE train_id = 1 AND roof = 'none';
```
-------------------------695 sample_num
```sql
SELECT id FROM cars WHERE train_id = 1 AND wheels = 2;
```
-------------------------696 sample_num
```sql
SELECT COUNT(DISTINCT t.id)
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE t.direction = 'east' AND c.shape IN ('elipse', 'bucket');
```
-------------------------697 sample_num
```sql
SELECT t.id
FROM trains t
JOIN (
    SELECT train_id, COUNT(*) AS carsNum
    FROM cars
    GROUP BY train_id
) c ON t.id = c.train_id
WHERE t.direction = 'east' AND c.carsNum < 4;
```
-------------------------698 sample_num
```sql
SELECT cars.id
FROM cars
JOIN trains ON cars.train_id = trains.id
WHERE cars.sides = 'double' AND trains.direction = 'west';
```
-------------------------699 sample_num
```sql
SELECT COUNT(DISTINCT t.id)
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE t.direction = 'east'
GROUP BY t.id
HAVING SUM(CASE WHEN c.len = 'long' THEN 1 ELSE 0 END) > 2;
```
-------------------------700 sample_num
```sql
SELECT DISTINCT t.direction
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE c.load_num = 0;
```
-------------------------701 sample_num
```sql
SELECT t.direction
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE c.shape = 'ellipse';
```
-------------------------702 sample_num
```sql
SELECT COUNT(*)
FROM cars
JOIN trains ON cars.train_id = trains.id
WHERE trains.direction = 'east' AND cars.len = 'short';
```
-------------------------703 sample_num
```sql
SELECT c.shape
FROM cars c
JOIN trains t ON c.train_id = t.id
WHERE t.direction = 'east' AND c.position = 1;
```
-------------------------704 sample_num
```sql
SELECT COUNT(*)
FROM cars
JOIN trains ON cars.train_id = trains.id
WHERE trains.direction = 'east' AND cars.roof = 'flat';
```
-------------------------705 sample_num
```sql
SELECT COUNT(*)
FROM cars c
JOIN trains t ON c.train_id = t.id
WHERE t.direction = 'east' AND c.roof = 'flat' AND c.load_shape = 'circle';
```
-------------------------706 sample_num
```sql
SELECT t.direction, COUNT(c.shape) AS rectCarsNum
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE c.shape = 'rectangle'
GROUP BY t.direction
ORDER BY rectCarsNum DESC
LIMIT 1;
```
-------------------------707 sample_num
```sql
SELECT DISTINCT t.direction
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE c.len = 'short' AND c.position = 4;
```
-------------------------708 sample_num
```sql
SELECT AVG(car_count) AS average_cars
FROM (
    SELECT COUNT(c.id) AS car_count
    FROM cars c
    JOIN trains t ON c.train_id = t.id
    WHERE t.direction = 'east'
    GROUP BY c.train_id
) AS train_car_counts;
```
-------------------------709 sample_num
```sql
SELECT
    (COUNT(CASE WHEN t.direction = 'east' THEN t.id END) * 100.0 / COUNT(t.id)) AS east_percentage
FROM
    trains t
JOIN
    cars c ON t.id = c.train_id
WHERE
    c.shape IN ('bucket', 'ellipse')
GROUP BY
    t.id;
```
-------------------------710 sample_num
```sql
SELECT COUNT(*)
FROM cars
WHERE len = 'short' AND shape = 'hexagon';
```
-------------------------711 sample_num
```sql
SELECT COUNT(*) FROM trains WHERE direction = 'west';
```
-------------------------712 sample_num
```sql
SELECT load_shape
FROM cars
WHERE len = 'short' AND shape = 'ellipse';
```
-------------------------713 sample_num
```sql
SELECT id FROM trains WHERE direction = 'east';
```
-------------------------714 sample_num
```sql
SELECT SUM(wheels) FROM cars WHERE len = 'long';
```
-------------------------715 sample_num
```sql
SELECT direction
FROM trains
GROUP BY direction
ORDER BY COUNT(id) DESC
LIMIT 1;
```
-------------------------716 sample_num
```sql
SELECT COUNT(DISTINCT t.id) AS trains_with_at_least_4_cars
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE t.direction = 'east'
GROUP BY t.id
HAVING COUNT(c.id) >= 4;
```
-------------------------717 sample_num
```sql
SELECT t.direction
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE c.position = 2 AND c.shape = 'rectangle'
GROUP BY t.direction
ORDER BY COUNT(t.id) DESC
LIMIT 1;
```
-------------------------718 sample_num
```sql
SELECT COUNT(*)
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE t.direction = 'west' AND c.sides = 'double' AND c.position = 3;
```
-------------------------719 sample_num
```sql
SELECT COUNT(*)
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE t.direction = 'east' AND c.shape = 'rectangular' AND c.position = 1;
```
-------------------------720 sample_num
```sql
SELECT COUNT(DISTINCT t.id)
FROM trains t
LEFT JOIN cars c ON t.id = c.train_id
WHERE t.direction = 'west'
GROUP BY t.id
HAVING SUM(c.roof = 'none') <= 1;
```
-------------------------721 sample_num
```sql
SELECT direction
FROM trains
WHERE id IN (
    SELECT train_id
    FROM cars
    GROUP BY train_id
    HAVING COUNT(*) = 3
)
GROUP BY direction
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------722 sample_num
```sql
SELECT COUNT(DISTINCT t.id)
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE c.load_num = 3 AND c.position = 1 AND t.direction = 'east';
```
-------------------------723 sample_num
```sql
SELECT COUNT(*)
FROM cars c
JOIN trains t ON c.train_id = t.id
WHERE t.direction = 'east' AND c.sides = 'double' AND c.position = 'trailPosi';
```
-------------------------724 sample_num
```sql
SELECT DISTINCT t.direction
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE c.load_num = 0;
```
-------------------------725 sample_num
```sql
SELECT t.direction
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE c.position = 2 AND c.load_shape = 'diamond';
```
-------------------------726 sample_num
```sql
SELECT COUNT(DISTINCT t.id)
FROM trains t
JOIN cars c ON t.id = c.train_id
WHERE t.direction = 'west' AND c.wheels = 3 AND c.roof = 'jagged';
```
-------------------------727 sample_num
```sql
SELECT t.direction
FROM trains t
JOIN (
    SELECT train_id
    FROM cars
    GROUP BY train_id
    HAVING COUNT(*) <= 2
) c ON t.id = c.train_id;
```
-------------------------728 sample_num
```sql
SELECT
    t.direction,
    (COUNT(CASE WHEN car_count >= 4 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM
    trains t
JOIN
    (SELECT train_id, COUNT(*) AS car_count
     FROM cars
     GROUP BY train_id) c ON t.id = c.train_id
GROUP BY
    t.direction;
```
-------------------------729 sample_num
```sql
WITH head_cars AS (
    SELECT c.load_shape, t.direction
    FROM cars c
    JOIN trains t ON c.train_id = t.id
    WHERE c.position = 1
),
load_shape_counts AS (
    SELECT load_shape, COUNT(*) AS count
    FROM head_cars
    GROUP BY load_shape
),
max_load_shape AS (
    SELECT load_shape
    FROM load_shape_counts
    WHERE count = (SELECT MAX(count) FROM load_shape_counts)
),
east_trains AS (
    SELECT COUNT(*) AS east_count
    FROM head_cars
    WHERE direction = 'east' AND load_shape IN (SELECT load_shape FROM max_load_shape)
),
total_trains AS (
    SELECT COUNT(*) AS total_count
    FROM head_cars
    WHERE load_shape IN (SELECT load_shape FROM max_load_shape)
)
SELECT (east_count * 100.0 / total_count) AS east_percentage
FROM east_trains, total_trains;
```
-------------------------730 sample_num
```sql
SELECT c."Character Name"
FROM characters c
JOIN movie m ON c.MovieID = m.MovieID
WHERE m.Title = 'Look Who\'s Talking';
```
-------------------------731 sample_num
```sql
SELECT c."Character Name"
FROM characters c
JOIN movie m ON c.MovieID = m.MovieID
WHERE m.Title = 'Batman'
ORDER BY c.screentime DESC
LIMIT 1;
```
-------------------------732 sample_num
```sql
SELECT a.Name
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE c.Character_Name = 'Joker' AND m.Title = 'Batman';
```
-------------------------733 sample_num
```sql
SELECT a.Name
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE m.Title = 'Batman';
```
-------------------------734 sample_num
```sql
SELECT m.Title
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
WHERE c.Character_Name = 'Dr. Archibald ''Moonlight'' Graham';
```
-------------------------735 sample_num
```sql
SELECT m.Title
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
JOIN actor a ON c.ActorID = a.ActorID
WHERE a.Name = 'Tom Cruise';
```
-------------------------736 sample_num
```sql
SELECT COUNT(*)
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
JOIN actor a ON c.ActorID = a.ActorID
WHERE a.Name = 'Morgan Freeman' AND m.MPAA_Rating = 'PG';
```
-------------------------737 sample_num
```sql
SELECT m.Title, m.Rating
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
JOIN actor a ON c.ActorID = a.ActorID
WHERE a.Name = 'Tom Cruise'
ORDER BY m.Rating DESC
LIMIT 1;
```
-------------------------738 sample_num
```sql
SELECT c."Character Name"
FROM characters c
JOIN actor a ON c.ActorID = a.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE a.Name = 'Tom Cruise' AND m.Title = 'Born on the Fourth of July';
```
-------------------------739 sample_num
```sql
SELECT c."Character Name"
FROM characters c
JOIN actor a ON c.ActorID = a.ActorID
WHERE a.Name = 'Tom Cruise';
```
-------------------------740 sample_num
```sql
SELECT a.Name, MAX(a.Height) AS TallestHeight
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE m.Title = 'Batman'
GROUP BY a.Name
ORDER BY TallestHeight DESC
LIMIT 1;
```
-------------------------741 sample_num
```sql
SELECT COUNT(DISTINCT c.MovieID) AS NumberOfMovies
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
WHERE a.Gender = 'Male' AND a.Ethnicity = 'African American';
```
-------------------------742 sample_num
```sql
SELECT AVG(m.Rating) AS AverageRating
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
JOIN actor a ON c.ActorID = a.ActorID
WHERE a.Name = 'Tom Cruise';
```
-------------------------743 sample_num
```sql
SELECT
    (MAX(screentime) - MIN(screentime)) / MIN(screentime) * 100 AS percentage_difference
FROM
    characters
WHERE
    MovieID = (SELECT MovieID FROM movie WHERE Title = 'Batman');
```
-------------------------744 sample_num
```sql
SELECT Title
FROM movie
WHERE Budget = (SELECT MAX(Budget) FROM movie);
```
-------------------------745 sample_num
```sql
SELECT m.MPAA_Rating
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
WHERE c.Character_Name = 'Peter Quill';
```
-------------------------746 sample_num
```sql
SELECT c."Character Name"
FROM characters c
JOIN movie m ON c.MovieID = m.MovieID
WHERE c.creditOrder = '1'
AND m.Genre = 'Thriller'
AND m.Rating = (SELECT MAX(Rating) FROM movie WHERE Genre = 'Thriller');
```
-------------------------747 sample_num
```sql
SELECT a.Name
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE m.Title = 'Batman'
ORDER BY c.screentime DESC
LIMIT 1;
```
-------------------------748 sample_num
```sql
SELECT COUNT(DISTINCT c.MovieID) AS MovieCount
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
WHERE a.NetWorth = (SELECT MAX(NetWorth) FROM actor);
```
-------------------------749 sample_num
```sql
SELECT a.Name
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
WHERE c.CharacterName = 'Chanice Kobolowski';
```
-------------------------750 sample_num
```sql
SELECT a."Date of Birth"
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
WHERE c."Character Name" = 'Sully';
```
-------------------------751 sample_num
```sql
SELECT a.BirthCity
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
WHERE c.CharacterName = 'Gabriel Martin';
```
-------------------------752 sample_num
```sql
SELECT a.Biography
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
WHERE c.Character_Name = 'Michael Moscovitz';
```
-------------------------753 sample_num
```sql
SELECT a.Height
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
WHERE c.CharacterName = 'Lurch';
```
-------------------------754 sample_num
```sql
SELECT `Character Name`
FROM characters
WHERE MovieID = (SELECT MovieID FROM movie WHERE Title = 'G.I. Joe: The Rise of Cobra')
AND creditOrder = 3;
```
-------------------------755 sample_num
```sql
SELECT a.Name
FROM characters c
JOIN actor a ON c.ActorID = a.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE m.Title = 'American Hustle' AND c.creditOrder = '2';
```
-------------------------756 sample_num
```sql
SELECT a.Name
FROM characters c
JOIN actor a ON c.ActorID = a.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE c.creditOrder = '1' AND m.Release_Date = '2015-10-26';
```
-------------------------757 sample_num
```sql
SELECT
    (COUNT(CASE WHEN a.BirthCountry = 'USA' THEN 1 END) * 100.0 / COUNT(a.ActorID)) AS PercentageUSAActors
FROM
    actor a
JOIN
    characters c ON a.ActorID = c.ActorID
JOIN
    movie m ON c.MovieID = m.MovieID
WHERE
    m.Title = 'Mrs. Doubtfire';
```
-------------------------758 sample_num
```sql
SELECT
    (COUNT(CASE WHEN a."Date of Birth" > '1970-01-01' THEN 1 END) * 100.0 / COUNT(a."ActorID")) AS percentage
FROM
    actor a
JOIN
    characters c ON a."ActorID" = c."ActorID"
JOIN
    movie m ON c."MovieID" = m."MovieID"
WHERE
    m."Title" = 'Dawn of the Planet of the Apes';
```
-------------------------759 sample_num
```sql
SELECT MovieID
FROM movie
WHERE Budget = 15000000 AND Rating BETWEEN 7 AND 8;
```
-------------------------760 sample_num
```sql
SELECT COUNT(*)
FROM movie
WHERE MPAA_Rating = 'PG'
AND Release_Date BETWEEN '1990-06-01' AND '1990-06-30';
```
-------------------------761 sample_num
```sql
SELECT Name
FROM actor
WHERE ActorID = 439 AND Gender = 'Male' AND Ethnicity = 'White';
```
-------------------------762 sample_num
```sql
SELECT DISTINCT m.Genre
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE a.BirthCity = 'New York City' AND m.Rating > 5;
```
-------------------------763 sample_num
```sql
SELECT COUNT(DISTINCT m.MovieID)
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
JOIN actor a ON c.ActorID = a.ActorID
WHERE m.Genre = 'Romance' AND a.Name = 'John Travolta';
```
-------------------------764 sample_num
```sql
SELECT a.Height, a.NetWorth
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE m.Title = 'Three Men and a Little Lady';
```
-------------------------765 sample_num
```sql
SELECT m.Genre
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
JOIN actor a ON c.ActorID = a.ActorID
WHERE m.MPAA_Rating = 'PG' AND a.NetWorth = (SELECT MAX(NetWorth) FROM actor);
```
-------------------------766 sample_num
```sql
SELECT a.NetWorth
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE m.Title = 'Misery' AND a.Height BETWEEN 60 AND 70;
```
-------------------------767 sample_num
```sql
SELECT COUNT(DISTINCT a.ActorID)
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE a.Gender = 'Male'
AND a.BirthCountry = 'USA'
AND m.Title = 'Ghost';
```
-------------------------768 sample_num
```sql
SELECT m.MPAA_Rating, m.Title
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
JOIN actor a ON c.ActorID = a.ActorID
WHERE a.Name = 'Leonardo DiCaprio'
ORDER BY m.Budget DESC
LIMIT 1;
```
-------------------------769 sample_num
```sql
SELECT a.NetWorth, a.Date_of_Birth
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE m.Title = 'Die Hard 2' AND a.Height_Inches BETWEEN 60 AND 65;
```
-------------------------770 sample_num
```sql
SELECT m.Runtime
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
JOIN actor a ON c.ActorID = a.ActorID
WHERE a.Ethnicity = 'African American' AND a.Date_of_Birth = '1954-12-28';
```
-------------------------771 sample_num
```sql
SELECT a.Name
FROM actor a
JOIN characters c ON a.ActorID = c.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE c.CharacterName = 'Don Altobello'
AND m.Genre = 'Drama'
AND m.Gross = 136766062;
```
-------------------------772 sample_num
```sql
SELECT m.Gross
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
JOIN actor a ON c.ActorID = a.ActorID
WHERE m.Genre = 'Comedy'
AND m.Rating < 7
AND a.NetWorth > 375000000.00;
```
-------------------------773 sample_num
```sql
SELECT m.Runtime
FROM movie m
JOIN characters c ON m.MovieID = c.MovieID
JOIN actor a ON c.ActorID = a.ActorID
WHERE a.Name = 'Jackie Chan' AND m.Rating > 7;
```
-------------------------774 sample_num
```sql
SELECT
    (COUNT(CASE WHEN a.NetWorth > 400000000 THEN 1 END) * 100.0 / COUNT(a.ActorID)) AS Percentage
FROM
    actor a
JOIN
    characters c ON a.ActorID = c.ActorID
JOIN
    movie m ON c.MovieID = m.MovieID
WHERE
    m.Genre = 'Drama';
```
-------------------------775 sample_num
```sql
SELECT c.Character_Name
FROM characters c
JOIN actor a ON c.ActorID = a.ActorID
JOIN movie m ON c.MovieID = m.MovieID
WHERE a.Gender = 'Female'
  AND a.Birth_City = 'Sherman Oaks'
  AND m.Title = 'Bruce Almighty'
  AND a.Height_Inches > (SELECT AVG(Height_Inches) * 0.5 FROM actor);
```
-------------------------776 sample_num
```sql
SELECT COUNT(*) AS EnglishTweetCount
FROM twitter
WHERE Lang = 'en';
```
-------------------------777 sample_num
```sql
SELECT text FROM twitter WHERE IsReshare = 'TRUE';
```
-------------------------778 sample_num
```sql
SELECT COUNT(*) AS TweetCount
FROM twitter
WHERE Reach > 1000;
```
-------------------------779 sample_num
```sql
SELECT COUNT(*)
FROM twitter
WHERE Sentiment > 0 AND Weekday = 'Thursday';
```
-------------------------780 sample_num
```sql
SELECT text
FROM twitter
WHERE Likes = (SELECT MAX(Likes) FROM twitter);
```
-------------------------781 sample_num
```sql
SELECT City FROM location WHERE Country = 'Argentina';
```
-------------------------782 sample_num
```sql
SELECT COUNT(*) AS TotalTweets
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
JOIN user u ON t.UserID = u.UserID
WHERE l.Country = 'Argentina';
```
-------------------------783 sample_num
```sql
SELECT City, COUNT(TweetID) AS TweetCount
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE l.Country = 'Argentina'
GROUP BY City
ORDER BY TweetCount DESC
LIMIT 1;
```
-------------------------784 sample_num
```sql
SELECT COUNT(*)
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
JOIN user u ON t.UserID = u.UserID
WHERE t.IsReshare = 'TRUE' AND l.City = 'Buenos Aires';
```
-------------------------785 sample_num
```sql
SELECT twitter.text
FROM twitter
JOIN location ON twitter.LocationID = location.LocationID
WHERE location.City = 'Buenos Aires' AND twitter.Sentiment > 0;
```
-------------------------786 sample_num
```sql
SELECT Country
FROM location
JOIN twitter ON location.LocationID = twitter.LocationID
WHERE twitter.Likes = (SELECT MAX(Likes) FROM twitter);
```
-------------------------787 sample_num
```sql
SELECT Country, COUNT(TweetID) AS PositiveTweetCount
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.Sentiment > 0 AND (l.Country = 'Argentina' OR l.Country = 'Australia')
GROUP BY l.Country
ORDER BY PositiveTweetCount DESC
LIMIT 1;
```
-------------------------788 sample_num
```sql
SELECT COUNT(*)
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE l.City = 'Buenos Aires' AND t.Weekday = 'Thursday';
```
-------------------------789 sample_num
```sql
SELECT COUNT(DISTINCT u.UserID) AS MaleUserCount
FROM user u
JOIN twitter t ON u.UserID = t.UserID
WHERE t.Likes > 1000 AND u.Gender = 'Male';
```
-------------------------790 sample_num
```sql
SELECT COUNT(TweetID) AS TotalTweets
FROM twitter
JOIN user ON twitter.UserID = user.UserID
WHERE user.Gender = 'Male';
```
-------------------------791 sample_num
```sql
SELECT u.Gender
FROM twitter t
JOIN user u ON t.UserID = u.UserID
WHERE t.Reach = (SELECT MAX(Reach) FROM twitter);
```
-------------------------792 sample_num
```sql
SELECT COUNT(*)
FROM twitter t
JOIN user u ON t.UserID = u.UserID
JOIN location l ON t.LocationID = l.LocationID
WHERE u.Gender = 'Male' AND l.Country = 'Argentina';
```
-------------------------793 sample_num
```sql
SELECT twitter.text
FROM twitter
JOIN user ON twitter.UserID = user.UserID
JOIN location ON twitter.LocationID = location.LocationID
WHERE user.Gender = 'Male' AND location.City = 'Buenos Aires';
```
-------------------------794 sample_num
```sql
SELECT AVG(TweetCount) AS AverageTweets
FROM (
    SELECT COUNT(t.TweetID) AS TweetCount
    FROM twitter t
    JOIN location l ON t.LocationID = l.LocationID
    WHERE l.Country = 'Argentina'
    GROUP BY l.City
) AS CityTweetCounts;
```
-------------------------795 sample_num
```sql
SELECT
    (COUNT(CASE WHEN u.Gender = 'Male' THEN 1 END) * 100.0 / COUNT(t.TweetID)) AS MalePercentage
FROM
    twitter t
JOIN
    user u ON t.UserID = u.UserID
WHERE
    t.Sentiment > 0;
```
-------------------------796 sample_num
```sql
SELECT COUNT(*) AS NumberOfUsersWithoutGender
FROM user
WHERE Gender = 'Unknown';
```
-------------------------797 sample_num
```sql
SELECT COUNT(DISTINCT State) AS NumberOfStates
FROM location
WHERE Country = 'United Kingdom';
```
-------------------------798 sample_num
```sql
SELECT StateCode FROM location WHERE State = 'Gwynedd';
```
-------------------------799 sample_num
```sql
SELECT LocationID FROM location WHERE State = 'West Sussex';
```
-------------------------800 sample_num
```sql
SELECT COUNT(*)
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.IsReshare = 'TRUE' AND l.State = 'Texas';
```
-------------------------801 sample_num
```sql
SELECT l.Country
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.Reach = 547851;
```
-------------------------802 sample_num
```sql
SELECT COUNT(*)
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE l.State = 'Ha Noi' AND t.Sentiment > 0;
```
-------------------------803 sample_num
```sql
SELECT text
FROM twitter
WHERE LocationID IN (SELECT LocationID FROM location WHERE State = 'Connecticut')
ORDER BY Klout DESC
LIMIT 1;
```
-------------------------804 sample_num
```sql
SELECT COUNT(DISTINCT u.UserID)
FROM user u
JOIN twitter t ON u.UserID = t.UserID
JOIN location l ON t.LocationID = l.LocationID
WHERE u.Gender = 'Female' AND l.State = 'Wisconsin';
```
-------------------------805 sample_num
```sql
SELECT u.Gender
FROM user u
JOIN twitter t ON u.UserID = t.UserID
WHERE t.TweetID = 'tw-715909161071091712';
```
-------------------------806 sample_num
```sql
SELECT l.City
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.text = 'One of our favorite stories is @FINRA_News''s move to the cloud with AWS Enterprise Support! https://amp.twimg.com/v/991837f1-4815-4edc-a88f-e68ded09a02a';
```
-------------------------807 sample_num
```sql
SELECT u.Gender
FROM user u
JOIN twitter t ON u.UserID = t.UserID
WHERE t.RetweetCount = 535;
```
-------------------------808 sample_num
```sql
SELECT u.Gender
FROM twitter t
JOIN user u ON t.UserID = u.UserID
WHERE t.Weekday = 'Wednesday'
ORDER BY t.Klout DESC
LIMIT 1;
```
-------------------------809 sample_num
```sql
SELECT u.Gender
FROM twitter t
JOIN user u ON t.UserID = u.UserID
WHERE t.Likes = (SELECT MAX(Likes) FROM twitter);
```
-------------------------810 sample_num
```sql
SELECT COUNT(t.TweetID) AS NumberOfTweets
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE l.State = 'Michigan' AND t.Weekday = 'Thursday';
```
-------------------------811 sample_num
```sql
SELECT l.State, l.StateCode
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.TweetID = 'tw-685681052912873473';
```
-------------------------812 sample_num
```sql
SELECT
    (COUNT(CASE WHEN u.Gender = 'Male' THEN 1 END) * 100.0 / COUNT(u.UserID)) AS MalePercentage
FROM
    user u
JOIN
    twitter t ON u.UserID = t.UserID
JOIN
    location l ON t.LocationID = l.LocationID
WHERE
    l.State = 'Florida';
```
-------------------------813 sample_num
```sql
SELECT
    (COUNT(CASE WHEN t.Sentiment > 0 THEN 1 END) * 100.0 / COUNT(t.TweetID)) AS PositiveTweetPercentage
FROM
    twitter t
JOIN
    location l ON t.LocationID = l.LocationID
WHERE
    l.State = 'California';
```
-------------------------814 sample_num
```sql
SELECT Weekday
FROM twitter
WHERE TweetID = 'tw-682712873332805633';
```
-------------------------815 sample_num
```sql
SELECT COUNT(DISTINCT UserID) AS UniqueUsers
FROM twitter
WHERE text = 'Happy New Year to all those AWS instances of ours!';
```
-------------------------816 sample_num
```sql
SELECT COUNT(TweetID) AS TotalTweetIDs
FROM twitter
WHERE Lang = 'en';
```
-------------------------817 sample_num
```sql
SELECT LocationID FROM twitter WHERE TweetID = 'tw-682714048199311366' AND LocationID = 3751;
```
-------------------------818 sample_num
```sql
SELECT COUNT(*) AS TweetCount
FROM twitter
WHERE Weekday = 'Wednesday';
```
-------------------------819 sample_num
```sql
SELECT text FROM twitter WHERE Weekday = 'Thursday';
```
-------------------------820 sample_num
```sql
SELECT u.Gender
FROM user u
JOIN twitter t ON u.UserID = t.UserID
WHERE t.TweetID = 'tw-682714583044243456';
```
-------------------------821 sample_num
```sql
SELECT twitter.text
FROM twitter
JOIN user ON twitter.UserID = user.UserID
WHERE user.Gender = 'Unknown';
```
-------------------------822 sample_num
```sql
SELECT COUNT(t.TweetID) AS TotalMaleTweetIDs
FROM twitter t
JOIN user u ON t.UserID = u.UserID
WHERE u.Gender = 'Male';
```
-------------------------823 sample_num
```sql
SELECT u.Gender, COUNT(t.TweetID) AS TweetCount
FROM twitter t
JOIN user u ON t.UserID = u.UserID
WHERE t.Lang = 'en'
GROUP BY u.Gender
ORDER BY TweetCount DESC
LIMIT 1;
```
-------------------------824 sample_num
```sql
SELECT u.Gender
FROM user u
JOIN twitter t ON u.UserID = t.UserID
WHERE t.RetweetCount > 30
GROUP BY u.Gender;
```
-------------------------825 sample_num
```sql
SELECT COUNT(DISTINCT u.UserID) AS FemaleReshares
FROM user u
JOIN twitter t ON u.UserID = t.UserID
WHERE u.Gender = 'Female' AND t.IsReshare = 'TRUE';
```
-------------------------826 sample_num
```sql
SELECT l.Country, SUM(t.Likes) AS TotalLikes
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
GROUP BY l.Country
ORDER BY TotalLikes DESC
LIMIT 1;
```
-------------------------827 sample_num
```sql
SELECT l.Country
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.TweetID = 'tw-682723090279841798';
```
-------------------------828 sample_num
```sql
SELECT twitter.text
FROM twitter
JOIN location ON twitter.LocationID = location.LocationID
WHERE location.Country = 'Australia';
```
-------------------------829 sample_num
```sql
SELECT t.text
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE l.City = 'Rawang' AND l.State = 'Selangor' AND l.Country = 'Malaysia';
```
-------------------------830 sample_num
```sql
SELECT DISTINCT Lang
FROM twitter
JOIN location ON twitter.LocationID = location.LocationID
WHERE location.Country = 'Brazil';
```
-------------------------831 sample_num
```sql
SELECT l.Country
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.Sentiment > 0
GROUP BY l.Country
ORDER BY COUNT(t.Sentiment) DESC
LIMIT 1;
```
-------------------------832 sample_num
```sql
SELECT SUM(t.Likes) AS TotalLikes
FROM twitter t
JOIN user u ON t.UserID = u.UserID
WHERE t.Lang = 'ru' AND u.Gender = 'Male';
```
-------------------------833 sample_num
```sql
SELECT AVG(TweetCount) AS AverageMaleTweetsPerWeek
FROM (
    SELECT UserID, COUNT(TweetID) AS TweetCount
    FROM twitter
    JOIN user ON twitter.UserID = user.UserID
    WHERE user.Gender = 'Male'
    GROUP BY UserID
) AS MaleUserTweets;
```
-------------------------834 sample_num
```sql
SELECT COUNT(*) FROM twitter WHERE Klout > 50;
```
-------------------------835 sample_num
```sql
SELECT text FROM twitter WHERE Lang <> 'en';
```
-------------------------836 sample_num
```sql
SELECT UserID
FROM twitter
GROUP BY UserID
ORDER BY COUNT(TweetID) DESC
LIMIT 1;
```
-------------------------837 sample_num
```sql
SELECT COUNT(*) AS ResharedTweets
FROM twitter
WHERE Weekday = 'Monday' AND IsReshare = 'TRUE';
```
-------------------------838 sample_num
```sql
SELECT text
FROM twitter
ORDER BY Reach DESC
LIMIT 3;
```
-------------------------839 sample_num
```sql
SELECT COUNT(*)
FROM twitter
WHERE IsReshare = 'TRUE' AND Likes > 100;
```
-------------------------840 sample_num
```sql
SELECT COUNT(TweetID) AS TotalTweets
FROM twitter
JOIN user ON twitter.UserID = user.UserID
WHERE user.Gender = 'Male' AND twitter.Weekday = 'Monday';
```
-------------------------841 sample_num
```sql
SELECT u.Gender
FROM twitter t
JOIN user u ON t.UserID = u.UserID
WHERE t.Likes = (SELECT MAX(Likes) FROM twitter);
```
-------------------------842 sample_num
```sql
SELECT twitter.text
FROM twitter
JOIN user ON twitter.UserID = user.UserID
WHERE twitter.Lang = 'fr' AND user.Gender = 'Male';
```
-------------------------843 sample_num
```sql
SELECT COUNT(*)
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.Lang = 'fr' AND l.Country = 'Australia';
```
-------------------------844 sample_num
```sql
SELECT COUNT(*)
FROM twitter t
JOIN user u ON t.UserID = u.UserID
JOIN location l ON t.LocationID = l.LocationID
WHERE t.Sentiment > 0 AND u.Gender = 'Male' AND l.Country = 'Australia';
```
-------------------------845 sample_num
```sql
SELECT
    (COUNT(CASE WHEN t.Sentiment > 0 THEN t.TweetID END) -
     COUNT(CASE WHEN t.Sentiment = 0 THEN t.TweetID END)) AS Difference
FROM
    twitter t
JOIN
    user u ON t.UserID = u.UserID
WHERE
    u.Gender = 'Male';
```
-------------------------846 sample_num
```sql
SELECT l.City
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.RetweetCount = (SELECT MAX(RetweetCount) FROM twitter);
```
-------------------------847 sample_num
```sql
SELECT City, COUNT(TweetID) AS TweetCount
FROM twitter
JOIN location ON twitter.LocationID = location.LocationID
WHERE City IN ('Bangkok', 'Chiang Mai')
GROUP BY City
ORDER BY TweetCount DESC
LIMIT 1;
```
-------------------------848 sample_num
```sql
SELECT COUNT(*)
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE l.State = 'Santa Fe' AND l.Country = 'Argentina' AND t.Day = 31;
```
-------------------------849 sample_num
```sql
SELECT City, COUNT(TweetID) AS TweetCount
FROM twitter
JOIN location ON twitter.LocationID = location.LocationID
WHERE location.Country = 'Canada'
GROUP BY City
ORDER BY TweetCount DESC
LIMIT 3;
```
-------------------------850 sample_num
```sql
SELECT DISTINCT l.City
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.Sentiment = 0;
```
-------------------------851 sample_num
```sql
SELECT text
FROM twitter
JOIN user ON twitter.UserID = user.UserID
JOIN location ON twitter.LocationID = location.LocationID
WHERE user.Gender = 'Male' AND location.Country = 'Argentina'
ORDER BY Likes DESC
LIMIT 1;
```
-------------------------852 sample_num
```sql
SELECT AVG(Likes) AS AverageLikes
FROM twitter
JOIN user ON twitter.UserID = user.UserID
WHERE user.Gender = 'Male' AND twitter.Weekday = 'Monday';
```
-------------------------853 sample_num
```sql
SELECT City, AVG(Likes) AS AverageLikes
FROM twitter t
JOIN location l ON t.LocationID = l.LocationID
WHERE City IN ('Bangkok', 'Chiang Mai')
GROUP BY City
ORDER BY AverageLikes DESC
LIMIT 1;
```
-------------------------854 sample_num
```sql
SELECT name, diff
FROM course
WHERE name IN ('Intro to BlockChain', 'Computer Network');
```
-------------------------855 sample_num
```sql
SELECT name
FROM course
WHERE credit < (SELECT credit FROM course WHERE name = 'Machine Learning Theory');
```
-------------------------856 sample_num
```sql
SELECT COUNT(*)
FROM prof
WHERE popularity > (SELECT popularity FROM prof WHERE first_name = 'Zhou' AND last_name = 'Zhihua');
```
-------------------------857 sample_num
```sql
SELECT phone_number FROM student WHERE f_name = 'Kerry' AND l_name = 'Pryor';
```
-------------------------858 sample_num
```sql
SELECT CONCAT(p.first_name, ' ', p.last_name) AS full_name
FROM RA ra
JOIN prof p ON ra.prof_id = p.prof_id
JOIN student s ON ra.student_id = s.student_id
WHERE s.f_name = 'Faina' AND s.l_name = 'Mallinar';
```
-------------------------859 sample_num
```sql
SELECT COUNT(*)
FROM RA
WHERE prof_id IN (SELECT prof_id FROM prof WHERE first_name = 'Sauveur' AND last_name = 'Skyme');
```
-------------------------860 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name
FROM RA r
JOIN student s ON r.student_id = s.student_id
WHERE r.capability = 5;
```
-------------------------861 sample_num
```sql
SELECT COUNT(*)
FROM RA
WHERE prof_id = (SELECT prof_id FROM prof WHERE first_name = 'Ogdon' AND last_name = 'Zywicki')
AND salary = 'med';
```
-------------------------862 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE c.name = 'Machine Learning Theory';
```
-------------------------863 sample_num
```sql
SELECT COUNT(*)
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE r.grade = 'B' AND s.gpa > 3 AND c.name = 'Machine Learning Theory';
```
-------------------------864 sample_num
```sql
SELECT c.name
FROM course c
JOIN registration r ON c.course_id = r.course_id
JOIN student s ON r.student_id = s.student_id
WHERE s.f_name = 'Laughton' AND s.l_name = 'Antonio';
```
-------------------------865 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE c.name = 'Intro to Database 2' AND r.grade IS NULL;
```
-------------------------866 sample_num
```sql
SELECT s.f_name, s.l_name, r.sat
FROM registration r
JOIN student s ON r.student_id = s.student_id
JOIN course c ON r.course_id = c.course_id
WHERE c.name = 'Machine Learning Theory' AND s.f_name IN ('Willie', 'Laughton')
ORDER BY r.sat DESC
LIMIT 1;
```
-------------------------867 sample_num
```sql
SELECT COUNT(DISTINCT p.prof_id) AS male_professors
FROM prof p
JOIN RA r ON p.prof_id = r.prof_id
WHERE p.gender = 'male'
GROUP BY p.prof_id
HAVING COUNT(r.student_id) > 3;
```
-------------------------868 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id) AS undergraduate_count
FROM registration r
JOIN course c ON r.course_id = c.course_id
JOIN student s ON r.student_id = s.student_id
WHERE c.name = 'Machine Learning Theory' AND s.type = 'UG';
```
-------------------------869 sample_num
```sql
SELECT CONCAT(p.first_name, ' ', p.last_name) AS full_name
FROM RA r
JOIN prof p ON r.prof_id = p.prof_id
JOIN student s ON r.student_id = s.student_id
WHERE s.f_name = 'Willie' AND s.l_name = 'Rechert';
```
-------------------------870 sample_num
```sql
SELECT AVG(s.gpa) AS average_gpa
FROM RA r
JOIN student s ON r.student_id = s.student_id
JOIN prof p ON r.prof_id = p.prof_id
WHERE p.first_name = 'Ogdon' AND p.last_name = 'Zywicki';
```
-------------------------871 sample_num
```sql
SELECT AVG(sat) AS average_satisfaction
FROM registration
JOIN course ON registration.course_id = course.course_id
WHERE course.name = 'Machine Learning Theory';
```
-------------------------872 sample_num
```sql
SELECT COUNT(*) FROM student WHERE type = 'RPG';
```
-------------------------873 sample_num
```sql
SELECT CONCAT(f_name, ' ', l_name) AS full_name
FROM student
WHERE gpa = (SELECT MAX(gpa) FROM student);
```
-------------------------874 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id)
FROM registration r
JOIN course c ON r.course_id = c.course_id
WHERE c.credit = 3 AND c.diff = 1 AND r.grade = 'A';
```
-------------------------875 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id) AS num_students
FROM registration r
JOIN course c ON r.course_id = c.course_id
WHERE c.diff = 5;
```
-------------------------876 sample_num
```sql
SELECT CONCAT(p.first_name, ' ', p.last_name) AS full_name
FROM RA r
JOIN prof p ON r.prof_id = p.prof_id
JOIN student s ON r.student_id = s.student_id
WHERE CONCAT(s.f_name, ' ', s.l_name) = 'Oliy Spratling';
```
-------------------------877 sample_num
```sql
SELECT p.popularity
FROM prof p
JOIN RA r ON p.prof_id = r.prof_id
JOIN student s ON r.student_id = s.student_id
WHERE s.f_name = 'Harrietta' AND s.l_name = 'Lydford';
```
-------------------------878 sample_num
```sql
SELECT COUNT(*)
FROM RA
WHERE prof_id = (SELECT prof_id FROM prof WHERE gender = 'female' ORDER BY teachingability ASC LIMIT 1);
```
-------------------------879 sample_num
```sql
SELECT CONCAT(p.first_name, ' ', p.last_name) AS full_name
FROM prof p
JOIN RA r ON p.prof_id = r.prof_id
GROUP BY p.prof_id
HAVING COUNT(r.student_id) > 2
ORDER BY MAX(p.teachingability) DESC
LIMIT 1;
```
-------------------------880 sample_num
```sql
SELECT r.grade
FROM registration r
JOIN student s ON r.student_id = s.student_id
JOIN course c ON r.course_id = c.course_id
WHERE s.f_name = 'Rik' AND s.l_name = 'Unsworth' AND c.name = 'Computer Network';
```
-------------------------881 sample_num
```sql
SELECT COUNT(*)
FROM registration r
JOIN student s ON r.student_id = s.student_id
WHERE s.f_name = 'Alvera' AND s.l_name = 'McQuillin';
```
-------------------------882 sample_num
```sql
SELECT s.f_name, s.l_name
FROM RA r
JOIN student s ON r.student_id = s.student_id
JOIN prof p ON r.prof_id = p.prof_id
WHERE s.type = 'RPG' AND p.first_name = 'Zhihua' AND p.last_name = 'Zhou';
```
-------------------------883 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id) AS number_of_students
FROM registration r
JOIN course c ON r.course_id = c.course_id
WHERE c.name = 'Statistical Learning';
```
-------------------------884 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE c.name = 'Applied Deep Learning' AND (r.grade IS NULL OR r.grade = '');
```
-------------------------885 sample_num
```sql
SELECT s.phone_number
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE r.grade = 'A' AND c.name = 'Intro to BlockChain';
```
-------------------------886 sample_num
```sql
SELECT
    (COUNT(CASE WHEN s.type = 'TPG' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM
    RA r
JOIN
    student s ON r.student_id = s.student_id
JOIN
    prof p ON r.prof_id = p.prof_id
WHERE
    p.first_name = 'Ogdon' AND p.last_name = 'Zywicki';
```
-------------------------887 sample_num
```sql
SELECT
    (COUNT(CASE WHEN r.grade = 'B' THEN r.student_id END) * 100.0 / COUNT(r.student_id)) AS percentage
FROM
    registration r
JOIN
    course c ON r.course_id = c.course_id
WHERE
    c.name = 'Computer Network';
```
-------------------------888 sample_num
```sql
SELECT COUNT(*) AS num_courses
FROM course
WHERE diff = 5;
```
-------------------------889 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM prof
WHERE graduate_from IN ('Brown University', 'Columbia University', 'Cornell University', 'Dartmouth College', 'Harvard University', 'Princeton University', 'University of Pennsylvania', 'Yale University');
```
-------------------------890 sample_num
```sql
SELECT name
FROM course
WHERE credit = (SELECT MAX(credit) FROM course)
ORDER BY diff DESC
LIMIT 1;
```
-------------------------891 sample_num
```sql
SELECT COUNT(*)
FROM student
WHERE type = 'UG' AND intelligence = (SELECT MAX(intelligence) FROM student WHERE type = 'UG');
```
-------------------------892 sample_num
```sql
SELECT COUNT(*)
FROM prof
WHERE gender = 'female'
AND popularity = (SELECT MAX(popularity) FROM prof);
```
-------------------------893 sample_num
```sql
SELECT COUNT(*) FROM student WHERE type = 'RPG';
```
-------------------------894 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id)
FROM registration r
JOIN course c ON r.course_id = c.course_id
WHERE r.grade = 'A' AND c.name = 'Applied Deep Learning';
```
-------------------------895 sample_num
```sql
SELECT s.gpa
FROM student s
JOIN RA r ON s.student_id = r.student_id
WHERE r.salary = 'free';
```
-------------------------896 sample_num
```sql
SELECT c.name
FROM course c
JOIN registration r ON c.course_id = r.course_id
WHERE c.diff = 1 AND r.grade = 'A'
GROUP BY c.name
ORDER BY COUNT(r.student_id) DESC
LIMIT 1;
```
-------------------------897 sample_num
```sql
SELECT COUNT(*)
FROM registration
WHERE student_id = (SELECT student_id FROM student ORDER BY gpa DESC LIMIT 1);
```
-------------------------898 sample_num
```sql
SELECT COUNT(DISTINCT RA.student_id)
FROM RA
JOIN prof ON RA.prof_id = prof.prof_id
WHERE prof.first_name = 'Ogdon' AND prof.last_name = 'Zywicki';
```
-------------------------899 sample_num
```sql
SELECT c.name
FROM course c
JOIN registration r ON c.course_id = r.course_id
WHERE r.sat = 5
ORDER BY r.sat DESC
LIMIT 1;
```
-------------------------900 sample_num
```sql
SELECT c.name
FROM course c
JOIN registration r ON c.course_id = r.course_id
JOIN student s ON r.student_id = s.student_id
WHERE s.intelligence = 1 AND r.sat = 1;
```
-------------------------901 sample_num
```sql
SELECT course.name, COUNT(registration.grade) AS A_count
FROM registration
JOIN course ON registration.course_id = course.course_id
WHERE registration.grade = 'A' AND course.name IN ('Advanced Operating System', 'Intro to BlockChain')
GROUP BY course.name
ORDER BY A_count DESC
LIMIT 1;
```
-------------------------902 sample_num
```sql
SELECT p.popularity
FROM prof p
JOIN RA r ON p.prof_id = r.prof_id
WHERE r.capability = (SELECT MAX(capability) FROM RA)
GROUP BY p.prof_id
ORDER BY COUNT(r.student_id) DESC
LIMIT 1;
```
-------------------------903 sample_num
```sql
SELECT AVG(student_count) AS average_students
FROM (
    SELECT COUNT(r.student_id) AS student_count
    FROM registration r
    JOIN course c ON r.course_id = c.course_id
    WHERE c.diff = 4
    GROUP BY r.course_id
) AS course_registrations;
```
-------------------------904 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id) AS failed_students
FROM registration r
JOIN student s ON r.student_id = s.student_id
WHERE s.gpa BETWEEN 3 AND 4 AND (r.grade IS NULL OR r.grade = '');
```
-------------------------905 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id)
FROM registration r
JOIN student s ON r.student_id = s.student_id
WHERE s.type = 'UG'
GROUP BY r.student_id
HAVING COUNT(CASE WHEN r.grade = 'A' THEN 1 END) = COUNT(r.course_id);
```
-------------------------906 sample_num
```sql
SELECT AVG(s.gpa) AS average_gpa, CONCAT(s.f_name, ' ', s.l_name) AS full_name
FROM RA r
JOIN student s ON r.student_id = s.student_id
WHERE r.capability = 5 AND r.salary = 'high'
GROUP BY s.student_id;
```
-------------------------907 sample_num
```sql
SELECT p.prof_id, r.student_id
FROM prof p, RA r
WHERE r.capability = (SELECT MIN(capability) FROM RA);
```
-------------------------908 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM prof
WHERE graduate_from = 'University of Boston';
```
-------------------------909 sample_num
```sql
SELECT r.course_id, r.student_id
FROM registration r
WHERE r.grade IS NULL OR r.grade = '';
```
-------------------------910 sample_num
```sql
SELECT
    COUNT(CASE WHEN gender = 'Male' THEN 1 END) * 1.0 /
    COUNT(CASE WHEN gender = 'Female' THEN 1 END) AS male_female_ratio
FROM
    prof;
```
-------------------------911 sample_num
```sql
SELECT name, credit
FROM course
WHERE diff = (SELECT MIN(diff) FROM course);
```
-------------------------912 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name, s.gpa
FROM student s
JOIN RA r ON s.student_id = r.student_id
JOIN prof p ON r.prof_id = p.prof_id
WHERE p.popularity = (SELECT MAX(popularity) FROM prof);
```
-------------------------913 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name, s.email
FROM RA r
JOIN student s ON r.student_id = s.student_id
WHERE r.salary = 'free';
```
-------------------------914 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name, ra.capability, s.gpa
FROM RA ra
JOIN student s ON ra.student_id = s.student_id
JOIN prof p ON ra.prof_id = p.prof_id
WHERE CONCAT(p.first_name, ' ', p.last_name) = 'Merwyn Conkay';
```
-------------------------915 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name, r.grade
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE c.name = 'Intro to BlockChain';
```
-------------------------916 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE c.diff = (SELECT MAX(diff) FROM course)
AND r.grade = 'A';
```
-------------------------917 sample_num
```sql
SELECT CONCAT(p.first_name, ' ', p.last_name) AS full_name, p.graduate_from
FROM prof p
JOIN RA r ON p.prof_id = r.prof_id
JOIN student s ON r.student_id = s.student_id
WHERE s.f_name = 'Olia' AND s.l_name = 'Rabier';
```
-------------------------918 sample_num
```sql
SELECT s.f_name, s.l_name
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE c.name = 'Advanced Database Systems' AND r.sat = (
    SELECT MAX(sat)
    FROM registration
    JOIN course ON registration.course_id = course.course_id
    WHERE course.name = 'Advanced Database Systems'
);
```
-------------------------919 sample_num
```sql
SELECT
    DIVIDE(SUM(c.credit *
        CASE
            WHEN r.grade = 'A' THEN 4
            WHEN r.grade = 'B' THEN 3
            WHEN r.grade = 'C' THEN 2
            WHEN r.grade = 'D' THEN 1
            ELSE 0
        END),
    SUM(c.credit)) AS semester_gpa
FROM
    registration r
JOIN
    student s ON r.student_id = s.student_id
JOIN
    course c ON r.course_id = c.course_id
WHERE
    s.f_name = 'Antonio' AND s.l_name = 'Laughton';
```
-------------------------920 sample_num
```sql
SELECT c.name
FROM course c
JOIN registration r ON c.course_id = r.course_id
JOIN student s ON r.student_id = s.student_id
WHERE s.type = 'UG' AND s.gpa > 3.7;
```
-------------------------921 sample_num
```sql
SELECT s.f_name, s.l_name, r.capability
FROM student s
JOIN RA r ON s.student_id = r.student_id
JOIN prof p ON r.prof_id = p.prof_id
WHERE p.graduate_from = 'University of Washington';
```
-------------------------922 sample_num
```sql
SELECT s.f_name || ' ' || s.l_name AS full_name, s.email, s.intelligence
FROM student s
JOIN RA r ON s.student_id = r.student_id
WHERE r.capability = (SELECT MAX(capability) FROM RA)
  AND r.salary = 'high';
```
-------------------------923 sample_num
```sql
SELECT c.name, c.credit
FROM course c
JOIN registration r ON c.course_id = r.course_id
JOIN RA ra ON r.student_id = ra.student_id
JOIN prof p ON ra.prof_id = p.prof_id
WHERE p.gender = 'Female' AND p.teachingability = (SELECT MAX(teachingability) FROM prof WHERE gender = 'Female');
```
-------------------------924 sample_num
```sql
SELECT COUNT(*) FROM prof WHERE gender = 'Female';
```
-------------------------925 sample_num
```sql
SELECT name FROM course WHERE diff = (SELECT MAX(diff) FROM course);
```
-------------------------926 sample_num
```sql
SELECT COUNT(*)
FROM student
WHERE gpa BETWEEN 3.1 AND 3.7 AND type = 'UG';
```
-------------------------927 sample_num
```sql
SELECT credit FROM course WHERE name = 'Computer Vision';
```
-------------------------928 sample_num
```sql
SELECT s.student_id
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE s.gpa = 2.5 AND c.name = 'C for Programmers';
```
-------------------------929 sample_num
```sql
SELECT s.l_name
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE c.name = 'Intro to Database 2'
ORDER BY r.sat DESC
LIMIT 1;
```
-------------------------930 sample_num
```sql
SELECT COUNT(*)
FROM student
WHERE student_id IN (SELECT student_id FROM RA WHERE salary = 'high')
AND gpa > 3;
```
-------------------------931 sample_num
```sql
SELECT c.name
FROM course c
JOIN registration r ON c.course_id = r.course_id
JOIN student s ON r.student_id = s.student_id
WHERE s.type = 'UG'
AND r.sat = (SELECT MAX(sat) FROM registration r2 JOIN student s2 ON r2.student_id = s2.student_id WHERE s2.type = 'UG');
```
-------------------------932 sample_num
```sql
SELECT RA.capability
FROM RA
JOIN student ON RA.student_id = student.student_id
WHERE student.type = 'RPG' AND student.intelligence >= 4;
```
-------------------------933 sample_num
```sql
SELECT COUNT(*)
FROM student s
JOIN registration r ON s.student_id = r.student_id
WHERE r.grade = 'B' AND s.intelligence = 3;
```
-------------------------934 sample_num
```sql
SELECT c.diff
FROM course c
JOIN registration r ON c.course_id = r.course_id
JOIN student s ON r.student_id = s.student_id
WHERE s.intelligence = 5 AND r.grade = 'A';
```
-------------------------935 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id) AS student_count
FROM prof p
JOIN RA r ON p.prof_id = r.prof_id
WHERE p.popularity = (SELECT MAX(popularity) FROM prof)
AND r.capability = 5;
```
-------------------------936 sample_num
```sql
SELECT c.name
FROM course c
JOIN registration r ON c.course_id = r.course_id
WHERE r.grade = 'D';
```
-------------------------937 sample_num
```sql
SELECT RA.capability
FROM student
JOIN RA ON student.student_id = RA.student_id
WHERE student.f_name = 'Alvera' AND student.l_name = 'McQuillin';
```
-------------------------938 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id) AS student_count
FROM registration r
JOIN course c ON r.course_id = c.course_id
JOIN student s ON r.student_id = s.student_id
WHERE c.credit = 3 AND s.gpa = 3.2;
```
-------------------------939 sample_num
```sql
SELECT COUNT(*)
FROM RA
JOIN student ON RA.student_id = student.student_id
WHERE RA.salary = 'low' AND student.gpa = 3.5;
```
-------------------------940 sample_num
```sql
SELECT s.email
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE r.grade = 'B' AND c.diff > (SELECT AVG(diff) * 0.8 FROM course);
```
-------------------------941 sample_num
```sql
SELECT
    (COUNT(CASE WHEN r.salary = 'low' THEN 1 END) * 100.0 / COUNT(r.salary)) AS percentage
FROM
    prof p
JOIN
    RA r ON p.prof_id = r.prof_id
WHERE
    p.teachingability <= 3;
```
-------------------------942 sample_num
```sql
SELECT MAX(credit) AS most_important_course, MAX(diff) AS most_difficult_course
FROM course;
```
-------------------------943 sample_num
```sql
SELECT AVG(teachingability) AS average_teaching_ability
FROM prof
WHERE popularity = (SELECT MAX(popularity) FROM prof);
```
-------------------------944 sample_num
```sql
SELECT DIVIDE(SUM(r.sat), COUNT(r.course_id)) AS average_satisfaction
FROM registration r
JOIN student s ON r.student_id = s.student_id
WHERE s.grade = 'B';
```
-------------------------945 sample_num
```sql
SELECT CONCAT(f_name, ' ', l_name) AS full_name, phone_number
FROM student
WHERE intelligence < 4 AND gpa > 3;
```
-------------------------946 sample_num
```sql
SELECT s.f_name, s.l_name
FROM student s
JOIN RA r ON s.student_id = r.student_id
WHERE r.capability > (SELECT AVG(capability) FROM RA);
```
-------------------------947 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name, c.name AS course_name
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE s.intelligence = 5 AND s.gpa < 3;
```
-------------------------948 sample_num
```sql
SELECT AVG(RA.capability) AS average_capability
FROM RA
JOIN student ON RA.student_id = student.student_id
WHERE student.gpa < 2.5;
```
-------------------------949 sample_num
```sql
SELECT CONCAT(p.first_name, ' ', p.last_name) AS full_name
FROM prof p
JOIN RA r ON p.prof_id = r.prof_id
JOIN student s ON r.student_id = s.student_id
WHERE s.intelligence = 1;
```
-------------------------950 sample_num
```sql
SELECT
    (SELECT AVG(s.gpa)
     FROM student s
     JOIN registration r ON s.student_id = r.student_id
     JOIN course c ON r.course_id = c.course_id
     WHERE c.diff = (SELECT MAX(diff) FROM course)) -
    (SELECT AVG(s.gpa)
     FROM student s
     JOIN registration r ON s.student_id = r.student_id
     JOIN course c ON r.course_id = c.course_id
     WHERE c.diff = (SELECT MIN(diff) FROM course)) AS gpa_difference;
```
-------------------------951 sample_num
```sql
SELECT CONCAT(s.f_name, ' ', s.l_name) AS full_name, r.capability
FROM student s
JOIN registration reg ON s.student_id = reg.student_id
JOIN RA r ON s.student_id = r.student_id
WHERE reg.grade IS NULL;
```
-------------------------952 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id)
FROM RA r
JOIN registration reg ON r.student_id = reg.student_id
JOIN course c ON reg.course_id = c.course_id
WHERE r.salary = 'High' AND c.name = 'computer vision';
```
-------------------------953 sample_num
```sql
SELECT CONCAT(p.first_name, ' ', p.last_name) AS full_name, p.popularity
FROM prof p
JOIN RA r ON p.prof_id = r.prof_id
GROUP BY p.prof_id
ORDER BY COUNT(r.student_id) DESC
LIMIT 1;
```
-------------------------954 sample_num
```sql
SELECT c.name, CONCAT(s.f_name, ' ', s.l_name) AS full_name
FROM registration r
JOIN course c ON r.course_id = c.course_id
JOIN student s ON r.student_id = s.student_id
WHERE r.grade = 'A'
GROUP BY c.course_id, c.name
HAVING COUNT(s.student_id) = (
    SELECT MAX(A_count)
    FROM (
        SELECT COUNT(student_id) AS A_count
        FROM registration
        WHERE grade = 'A'
        GROUP BY course_id
    ) AS subquery
);
```
-------------------------955 sample_num
```sql
SELECT
    (SELECT AVG(sat) FROM registration r JOIN RA ra ON r.student_id = ra.student_id WHERE ra.salary = 'high') -
    (SELECT AVG(sat) FROM registration r JOIN RA ra ON r.student_id = ra.student_id WHERE ra.salary = 'free') AS average_satisfaction_difference;
```
-------------------------956 sample_num
```sql
SELECT graduate_from
FROM prof
WHERE prof_id = (
    SELECT prof_id
    FROM RA
    JOIN student ON RA.student_id = student.student_id
    WHERE student.type = 'UG'
    GROUP BY prof_id
    ORDER BY COUNT(student.student_id) DESC
    LIMIT 1
);
```
-------------------------957 sample_num
```sql
SELECT CONCAT(p.first_name, ' ', p.last_name) AS full_name, p.email
FROM prof p
JOIN RA r ON p.prof_id = r.prof_id
WHERE p.teachingability > (SELECT AVG(teachingability) FROM prof)
GROUP BY p.prof_id
HAVING COUNT(r.student_id) >= 2;
```
-------------------------958 sample_num
```sql
SELECT (COUNT(CASE WHEN sat = (SELECT MAX(sat) FROM registration WHERE course_id = (SELECT course_id FROM course WHERE name = 'Intro to Database 2')) THEN student_id END) * 100.0) / COUNT(student_id) AS percentage
FROM registration;
```
-------------------------959 sample_num
```sql
SELECT f_name, l_name
FROM student
WHERE gpa = (SELECT MAX(gpa) FROM student);
```
-------------------------960 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id) AS high_salary_students
FROM prof p
JOIN RA r ON p.prof_id = r.prof_id
WHERE p.teachingability = (SELECT MAX(teachingability) FROM prof)
AND r.salary = 'high';
```
-------------------------961 sample_num
```sql
SELECT MIN(salary) AS min_salary, MAX(salary) AS max_salary
FROM RA
WHERE student_id = (SELECT student_id FROM student WHERE email = 'grosellg@hku.hk');
```
-------------------------962 sample_num
```sql
SELECT COUNT(*)
FROM registration r
JOIN course c ON r.course_id = c.course_id
JOIN student s ON r.student_id = s.student_id
WHERE c.name = 'Statistical Learning' AND r.sat = 4 AND s.gpa = 3.8;
```
-------------------------963 sample_num
```sql
SELECT COUNT(DISTINCT r.student_id)
FROM registration r
JOIN course c ON r.course_id = c.course_id
JOIN student s ON r.student_id = s.student_id
WHERE c.diff = 3 AND s.intelligence = 2;
```
-------------------------964 sample_num
```sql
SELECT s.f_name, s.l_name
FROM student s
JOIN registration r ON s.student_id = r.student_id
JOIN course c ON r.course_id = c.course_id
WHERE r.grade = 'C' AND c.name = 'Applied Deep Learning';
```
-------------------------965 sample_num
```sql
SELECT c.name
FROM course c
JOIN registration r ON c.course_id = r.course_id
JOIN student s ON r.student_id = s.student_id
WHERE s.type = 'RPG' AND r.sat = 1;
```
-------------------------966 sample_num
```sql
SELECT
    (SELECT COUNT(*) FROM student s JOIN RA r ON s.student_id = r.student_id WHERE r.capability < 3 AND s.type = 'UG') -
    (SELECT COUNT(*) FROM student s JOIN RA r ON s.student_id = r.student_id WHERE r.capability < 3 AND s.type = 'RPG') AS difference
```
-------------------------967 sample_num
```sql
SELECT advisedBy.p_id_dummy, AVG(student_count) AS average_students
FROM (
    SELECT p_id_dummy, COUNT(p_id) AS student_count
    FROM advisedBy
    GROUP BY p_id_dummy
) AS advisor_counts
GROUP BY p_id_dummy;
```
-------------------------968 sample_num
```sql
SELECT COUNT(DISTINCT p_id) AS professor_count
FROM taughtBy
WHERE course_id = 18;
```
-------------------------969 sample_num
```sql
SELECT course_id FROM course WHERE courseLevel = 'Level_500';
```
-------------------------970 sample_num
```sql
SELECT COUNT(course_id)
FROM course
WHERE courseLevel IN ('Level_100', 'Level_200');
```
-------------------------971 sample_num
```sql
SELECT p.p_id, t.course_id
FROM person p
JOIN taughtBy t ON p.p_id = t.p_id
WHERE p.professor = 1 AND p.hasPosition = 0;
```
-------------------------972 sample_num
```sql
SELECT DISTINCT taughtBy.p_id
FROM taughtBy
JOIN course ON taughtBy.course_id = course.course_id
WHERE course.courseLevel = 'Level_400';
```
-------------------------973 sample_num
```sql
SELECT DISTINCT c.course_id
FROM course c
JOIN taughtBy t ON c.course_id = t.course_id
JOIN advisedBy a ON t.p_id = a.p_id_dummy
WHERE a.p_id = 376;
```
-------------------------974 sample_num
```sql
SELECT a.p_id_dummy
FROM person p
JOIN advisedBy a ON p.p_id = a.p_id
WHERE p.yearsInProgram = 'Year_3';
```
-------------------------975 sample_num
```sql
SELECT c.courseLevel
FROM course c
JOIN taughtBy t ON c.course_id = t.course_id
WHERE t.p_id = 297;
```
-------------------------976 sample_num
```sql
SELECT c.courseLevel, t.p_id
FROM course c
JOIN taughtBy t ON c.course_id = t.course_id
WHERE c.course_id = 165;
```
-------------------------977 sample_num
```sql
SELECT p.p_id, p.yearsInProgram
FROM person p
JOIN advisedBy a ON p.p_id = a.p_id
WHERE a.p_id_dummy = 5 AND p.student = 1;
```
-------------------------978 sample_num
```sql
SELECT c.course_id, c.courseLevel
FROM course c
JOIN taughtBy t ON c.course_id = t.course_id
JOIN person p ON t.p_id = p.p_id
WHERE p.professor = 1 AND p.hasPosition = 'Faculty_eme';
```
-------------------------979 sample_num
```sql
SELECT c.courseLevel
FROM advisedBy ab
JOIN person p ON ab.p_id_dummy = p.p_id
JOIN taughtBy tb ON p.p_id = tb.p_id
JOIN course c ON tb.course_id = c.course_id
WHERE ab.p_id = 80;
```
-------------------------980 sample_num
```sql
SELECT DISTINCT t1.p_id
FROM taughtBy t1
JOIN course c1 ON t1.course_id = c1.course_id AND c1.courseLevel = 'Level_400'
JOIN taughtBy t2 ON t1.p_id = t2.p_id
JOIN course c2 ON t2.course_id = c2.course_id AND c2.courseLevel = 'Level_500';
```
-------------------------981 sample_num
```sql
SELECT DISTINCT p_id_dummy
FROM advisedBy
JOIN person ON advisedBy.p_id = person.p_id
WHERE person.yearsInProgram = 'Year_12';
```
-------------------------982 sample_num
```sql
SELECT t.course_id, c.courseLevel
FROM taughtBy t
JOIN course c ON t.course_id = c.course_id
GROUP BY t.course_id, c.courseLevel
HAVING COUNT(t.p_id) = (
    SELECT MAX(professor_count)
    FROM (
        SELECT COUNT(p_id) AS professor_count
        FROM taughtBy
        GROUP BY course_id
    ) AS counts
);
```
-------------------------983 sample_num
```sql
SELECT COUNT(course_id) AS total_courses
FROM course
WHERE courseLevel IN ('Level_300');
```
-------------------------984 sample_num
```sql
SELECT COUNT(*)
FROM taughtBy
WHERE course_id = 11;
```
-------------------------985 sample_num
```sql
SELECT
    course_id,
    COUNT(p_id) AS teacher_count
FROM
    taughtBy
WHERE
    course_id IN (16, 18)
GROUP BY
    course_id
ORDER BY
    teacher_count DESC
LIMIT 1;
```
-------------------------986 sample_num
```sql
SELECT COUNT(*)
FROM person
WHERE professor = 1 AND hasPosition = 'Faculty_eme';
```
-------------------------987 sample_num
```sql
SELECT a.p_id_dummy
FROM advisedBy a
GROUP BY a.p_id_dummy
HAVING COUNT(a.p_id) > 4;
```
-------------------------988 sample_num
```sql
SELECT COUNT(*)
FROM course c
JOIN taughtBy t ON c.course_id = t.course_id
JOIN person p ON t.p_id = p.p_id
WHERE c.courseLevel IN ('Level_100', 'Level_200') AND p.professor = 1;
```
-------------------------989 sample_num
```sql
SELECT DISTINCT p.p_id
FROM person p
JOIN taughtBy t ON p.p_id = t.p_id
JOIN course c ON t.course_id = c.course_id
WHERE p.hasPosition = 'Faculty_eme' AND c.courseLevel = 'Level_300';
```
-------------------------990 sample_num
```sql
SELECT COUNT(*) > 0 AS is_faculty_member
FROM taughtBy t
JOIN person p ON t.p_id = p.p_id
WHERE t.course_id = 9 AND p.hasPosition != 0;
```
-------------------------991 sample_num
```sql
SELECT c.courseLevel
FROM course c
JOIN taughtBy t ON c.course_id = t.course_id
WHERE t.p_id = 79;
```
-------------------------992 sample_num
```sql
SELECT a.p_id_dummy
FROM person p
JOIN advisedBy a ON p.p_id = a.p_id
WHERE p.yearsInProgram = 'Year_5';
```
-------------------------993 sample_num
```sql
SELECT COUNT(DISTINCT ab.p_id) AS student_count
FROM advisedBy ab
JOIN taughtBy tb ON ab.p_id_dummy = tb.p_id
JOIN course c ON tb.course_id = c.course_id
WHERE c.courseLevel IN ('Level_100', 'Level_200', 'Level_300') AND tb.p_id = 1;
```
-------------------------994 sample_num
```sql
SELECT COUNT(DISTINCT c.course_id)
FROM course c
JOIN taughtBy t ON c.course_id = t.course_id
JOIN person p ON t.p_id = p.p_id
WHERE c.courseLevel IN ('Level_100', 'Level_200') AND p.hasPosition != 0;
```
-------------------------995 sample_num
```sql
SELECT taughtBy.course_id
FROM advisedBy
JOIN person ON advisedBy.p_id_dummy = person.p_id
JOIN taughtBy ON person.p_id = taughtBy.p_id
WHERE advisedBy.p_id = 6;
```
-------------------------996 sample_num
```sql
SELECT c.courseLevel
FROM course c
JOIN taughtBy t ON c.course_id = t.course_id
GROUP BY c.course_id, c.courseLevel
ORDER BY COUNT(t.p_id) DESC
LIMIT 1;
```
-------------------------997 sample_num
```sql
SELECT p_id
FROM taughtBy
GROUP BY p_id
HAVING COUNT(course_id) > 3;
```
-------------------------998 sample_num
```sql
SELECT p_id, COUNT(course_id) AS course_count
FROM taughtBy
GROUP BY p_id
ORDER BY course_count DESC
LIMIT 3;
```
-------------------------999 sample_num
```sql
SELECT COUNT(DISTINCT a.p_id_dummy) AS total_professors
FROM person p
JOIN advisedBy a ON p.p_id = a.p_id
WHERE p.yearsInProgram = 'Year_3';
```
-------------------------1000 sample_num
```sql
SELECT AVG(course_count) AS average_courses_taught
FROM (
    SELECT COUNT(taughtBy.course_id) AS course_count
    FROM person
    JOIN taughtBy ON person.p_id = taughtBy.p_id
    WHERE person.professor = 1
    GROUP BY taughtBy.p_id
) AS professor_courses;
```
-------------------------1001 sample_num
```sql
SELECT
    COUNT(CASE WHEN professor = 1 THEN p_id END) * 1.0 /
    NULLIF(COUNT(CASE WHEN student = 1 THEN p_id END), 0) AS ratio
FROM
    person;
```
-------------------------1002 sample_num
```sql
SELECT
    (COUNT(CASE WHEN courseLevel = 'Level_400' THEN course_id END) * 100.0 / COUNT(course_id)) AS percentage_high_level_undergraduate
FROM
    course;
```
-------------------------1003 sample_num
```sql
SELECT p_id FROM taughtBy WHERE course_id = 18;
```
-------------------------1004 sample_num
```sql
SELECT p.hasPosition, a.p_id_dummy
FROM advisedBy a
JOIN person p ON a.p_id = 303 AND a.p_id_dummy = p.p_id;
```
-------------------------1005 sample_num
```sql
SELECT p.p_id, c.courseLevel
FROM person p
JOIN taughtBy t ON p.p_id = t.p_id
JOIN course c ON t.course_id = c.course_id
WHERE p.professor = 1 AND p.hasPosition = 'Faculty_aff';
```
-------------------------1006 sample_num
```sql
SELECT p.yearsInProgram, p.inPhase
FROM person p
JOIN advisedBy a ON p.p_id = a.p_id
WHERE a.p_id_dummy = (
    SELECT a1.p_id_dummy
    FROM advisedBy a1
    GROUP BY a1.p_id_dummy
    ORDER BY COUNT(a1.p_id) DESC
    LIMIT 1
);
```
-------------------------1007 sample_num
```sql
SELECT p.p_id AS advised_student_id, a.p_id_dummy AS employing_professor_id
FROM person p
JOIN advisedBy a ON p.p_id = a.p_id
WHERE p.hasPosition = 'Faculty_eme';
```
-------------------------1008 sample_num
```sql
SELECT t.course_id, c.courseLevel
FROM taughtBy t
JOIN course c ON t.course_id = c.course_id
WHERE t.p_id BETWEEN 40 AND 50;
```
-------------------------1009 sample_num
```sql
SELECT c.courseLevel, tb.p_id
FROM course c
JOIN taughtBy tb ON c.course_id = tb.course_id
WHERE c.course_id = 147;
```
-------------------------1010 sample_num
```sql
SELECT p.p_id, c.courseLevel
FROM person p
JOIN taughtBy t ON p.p_id = t.p_id
JOIN course c ON t.course_id = c.course_id
WHERE c.course_id = 104 AND p.professor = 1 AND p.hasPosition != 0;
```
-------------------------1011 sample_num
```sql
SELECT p.p_id, p.hasPosition
FROM person p
JOIN taughtBy t ON p.p_id = t.p_id
JOIN course c ON t.course_id = c.course_id
WHERE p.professor = 1 AND c.courseLevel = 'Level_400' AND c.course_id < 10;
```
-------------------------1012 sample_num
```sql
SELECT DISTINCT taughtBy.p_id
FROM taughtBy
JOIN course ON taughtBy.course_id = course.course_id
WHERE course.course_id BETWEEN 121 AND 130 AND course.courseLevel = 'Level_300';
```
-------------------------1013 sample_num
```sql
SELECT DISTINCT a.p_id_dummy
FROM advisedBy a
JOIN person p ON a.p_id = p.p_id_dummy
WHERE p.yearsInProgram = 'Year_8' AND p.professor = 1 AND p.hasPosition = 1;
```
-------------------------1014 sample_num
```sql
SELECT DISTINCT taughtBy.course_id, taughtBy.p_id
FROM taughtBy
JOIN course ON taughtBy.course_id = course.course_id
WHERE course.courseLevel = 'Level_500'
LIMIT 5;
```
-------------------------1015 sample_num
```sql
SELECT COUNT(*)
FROM advisedBy
WHERE p_id_dummy = 415;
```
-------------------------1016 sample_num
```sql
SELECT COUNT(*) FROM course WHERE courseLevel = 'Level_500';
```
-------------------------1017 sample_num
```sql
SELECT COUNT(*)
FROM person
WHERE hasPosition = 0 AND inPhase = 0;
```
-------------------------1018 sample_num
```sql
SELECT p_id, COUNT(course_id) AS course_count
FROM taughtBy
GROUP BY p_id
ORDER BY course_count ASC
LIMIT 1;
```
-------------------------1019 sample_num
```sql
SELECT COUNT(*)
FROM person
WHERE p_id IN (SELECT p_id FROM advisedBy WHERE p_id_dummy = 5)
AND yearsInProgram = 'Year_5';
```
-------------------------1020 sample_num
```sql
SELECT taughtBy.p_id
FROM taughtBy
JOIN course ON taughtBy.course_id = course.course_id
WHERE course.courseLevel = 'Level_500'
GROUP BY taughtBy.p_id
ORDER BY COUNT(taughtBy.course_id) DESC
LIMIT 1;
```
-------------------------1021 sample_num
```sql
SELECT COUNT(DISTINCT p.p_id) AS professor_count
FROM person p
JOIN taughtBy t ON p.p_id = t.p_id
JOIN course c ON t.course_id = c.course_id
WHERE p.professor = 1
  AND p.hasPosition = 'Faculty_aff'
  AND c.courseLevel = 'Level_500';
```
-------------------------1022 sample_num
```sql
SELECT t.p_id, COUNT(c.course_id) AS course_count
FROM taughtBy t
JOIN course c ON t.course_id = c.course_id
WHERE c.courseLevel = 'Level_500'
GROUP BY t.p_id
ORDER BY course_count DESC
LIMIT 5;
```
-------------------------1023 sample_num
```sql
SELECT COUNT(DISTINCT a.p_id_dummy)
FROM advisedBy a
JOIN person p ON a.p_id = p.p_id
WHERE p.student = 1 AND p.yearsInProgram = 'Year_1';
```
-------------------------1024 sample_num
```sql
SELECT COUNT(DISTINCT tb.p_id)
FROM taughtBy tb
JOIN course c ON tb.course_id = c.course_id
WHERE c.courseLevel = 'Level_400'
GROUP BY tb.p_id
HAVING COUNT(tb.course_id) <= 2;
```
-------------------------1025 sample_num
```sql
SELECT DISTINCT p.p_id
FROM person p
JOIN taughtBy t ON p.p_id = t.p_id
JOIN course c ON t.course_id = c.course_id
WHERE p.hasPosition = 'Faculty_eme' AND p.professor = 1 AND c.courseLevel = 'Level_400';
```
-------------------------1026 sample_num
```sql
SELECT p.hasPosition
FROM person p
JOIN taughtBy t ON p.p_id = t.p_id
WHERE p.professor = 1
GROUP BY p.p_id, p.hasPosition
ORDER BY COUNT(t.course_id) DESC
LIMIT 1;
```
-------------------------1027 sample_num
```sql
SELECT p.yearsInProgram
FROM person p
JOIN advisedBy a ON p.p_id = a.p_id
WHERE p.student = 1
GROUP BY p.yearsInProgram
HAVING COUNT(a.p_id_dummy) > 2;
```
-------------------------1028 sample_num
```sql
SELECT COUNT(DISTINCT t.p_id)
FROM taughtBy t
JOIN course c ON t.course_id = c.course_id
WHERE c.courseLevel IN ('Level_100', 'Level_200');
```
-------------------------1029 sample_num
```sql
SELECT yearsInProgram
FROM person AS s
JOIN advisedBy AS a ON s.p_id = a.p_id_dummy
WHERE s.student = 1
GROUP BY yearsInProgram
ORDER BY COUNT(yearsInProgram) DESC
LIMIT 1;
```
-------------------------1030 sample_num
```sql
SELECT COUNT(*)
FROM person p
JOIN advisedBy a ON p.p_id = a.p_id
WHERE p.student = 1 AND p.inPhase = 'Pre-Quals';
```
-------------------------1031 sample_num
```sql
SELECT AVG(course_count) AS average_courses
FROM (
    SELECT taughtBy.p_id, COUNT(taughtBy.course_id) AS course_count
    FROM taughtBy
    JOIN course ON taughtBy.course_id = course.course_id
    WHERE course.courseLevel = 'Level_500'
    GROUP BY taughtBy.p_id
) AS professor_courses;
```
-------------------------1032 sample_num
```sql
SELECT COUNT(course_id)
FROM taughtBy
GROUP BY course_id
HAVING COUNT(p_id) > 4;
```
-------------------------1033 sample_num
```sql
SELECT course_id
FROM course
WHERE courseLevel = 'Level_500';
```
-------------------------1034 sample_num
```sql
SELECT COUNT(*) AS sum_of_year_1_and_year_2_students
FROM person
WHERE (yearsInProgram = 'Year_1' OR yearsInProgram = 'Year_2') AND student = 1;
```
-------------------------1035 sample_num
```sql
SELECT COUNT(DISTINCT t.course_id) AS course_count
FROM taughtBy t
JOIN person p ON t.p_id = p.p_id
WHERE p.professor = 1 AND p.hasPosition <> 0;
```
-------------------------1036 sample_num
```sql
SELECT p.hasPosition
FROM person p
JOIN taughtBy t ON p.p_id = t.p_id
GROUP BY p.p_id
ORDER BY COUNT(t.course_id) DESC
LIMIT 1;
```
-------------------------1037 sample_num
```sql
SELECT DISTINCT c.course_id
FROM course c
JOIN taughtBy t ON c.course_id = t.course_id
JOIN person p ON t.p_id = p.p_id
WHERE p.professor = 1 AND p.hasPosition = 0;
```
-------------------------1038 sample_num
```sql
SELECT p.professor, c.courseLevel
FROM person p
JOIN taughtBy t ON p.p_id = t.p_id
JOIN course c ON t.course_id = c.course_id
WHERE p.hasPosition <> 0
GROUP BY p.professor, c.courseLevel
HAVING COUNT(t.course_id) = (
    SELECT MAX(course_count)
    FROM (
        SELECT COUNT(t2.course_id) AS course_count
        FROM person p2
        JOIN taughtBy t2 ON p2.p_id = t2.p_id
        WHERE p2.hasPosition <> 0
        GROUP BY p2.p_id
    ) AS counts
);
```
-------------------------1039 sample_num
```sql
SELECT device_id
FROM gender_age
WHERE age = (SELECT MAX(age) FROM gender_age);
```
-------------------------1040 sample_num
```sql
SELECT COUNT(*)
FROM events
WHERE longitude = 97 AND latitude = 40;
```
-------------------------1041 sample_num
```sql
SELECT COUNT(*)
FROM gender_age
WHERE gender = 'M' AND group = 'M32-38';
```
-------------------------1042 sample_num
```sql
SELECT COUNT(*)
FROM gender_age
WHERE gender = 'F' AND age > 50;
```
-------------------------1043 sample_num
```sql
SELECT COUNT(*) AS active_users
FROM app_events
WHERE event_id = 2 AND is_active = 1;
```
-------------------------1044 sample_num
```sql
SELECT gender
FROM gender_age
WHERE age = (SELECT MIN(age) FROM gender_age);
```
-------------------------1045 sample_num
```sql
SELECT lc.category
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
GROUP BY lc.category
ORDER BY COUNT(al.app_id) DESC
LIMIT 1;
```
-------------------------1046 sample_num
```sql
SELECT pd.device_model
FROM gender_age_train gat
JOIN phone_brand_device_model2 pd ON gat.device_id = pd.device_id
WHERE gat.age = (SELECT MAX(age) FROM gender_age_train);
```
-------------------------1047 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM gender_age g
JOIN app_labels al ON g.device_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'Home Decoration';
```
-------------------------1048 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS male_active_users
FROM gender_age g
JOIN events e ON g.device_id = e.device_id
WHERE g.gender = 'M' AND e.is_active = 1 AND e.timestamp LIKE '2016-05-01%';
```
-------------------------1049 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS female_users
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.gender = 'F' AND p.device_model = 'ZenFone 5';
```
-------------------------1050 sample_num
```sql
SELECT MAX(ga.age) AS oldest_age
FROM events e
JOIN gender_age ga ON e.device_id = ga.device_id
WHERE e.timestamp LIKE '2016-05-06%'
  AND e.longitude = 121
  AND e.latitude = 31
  AND EXISTS (
      SELECT 1
      FROM app_events ae
      WHERE ae.event_id = e.event_id
        AND ae.is_active = 1
  );
```
-------------------------1051 sample_num
```sql
SELECT device_model, COUNT(device_id) AS device_count
FROM gender_age_train
JOIN phone_brand_device_model2 ON gender_age_train.device_id = phone_brand_device_model2.device_id
WHERE gender = 'F' AND group = 'F27-28'
GROUP BY device_model
ORDER BY device_count DESC
LIMIT 1;
```
-------------------------1052 sample_num
```sql
SELECT lc.category
FROM events e
JOIN label_categories lc ON e.event_id = lc.label_id
WHERE e.timestamp IN (
    SELECT MIN(timestamp)
    FROM events
    GROUP BY event_id
    ORDER BY MIN(timestamp)
    LIMIT 2
);
```
-------------------------1053 sample_num
```sql
SELECT gender, COUNT(*) as count
FROM gender_age
WHERE device_id IN (
    SELECT device_id
    FROM phone_brand_device_model2
    WHERE phone_brand = 'vivo'
)
GROUP BY gender
ORDER BY count DESC
LIMIT 1;
```
-------------------------1054 sample_num
```sql
SELECT lc.category, COUNT(DISTINCT al.app_id) AS user_count
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
GROUP BY lc.category
ORDER BY user_count DESC
LIMIT 1;
```
-------------------------1055 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM gender_age g
JOIN app_labels al ON g.device_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'MOBA';
```
-------------------------1056 sample_num
```sql
SELECT
    (COUNT(CASE WHEN g.gender = 'F' AND p.phone_brand = 'OPPO' THEN 1 END) * 100.0 / NULLIF(COUNT(CASE WHEN p.phone_brand = 'OPPO' THEN 1 END), 0)) AS female_percentage,
    (COUNT(CASE WHEN g.gender = 'M' AND p.phone_brand = 'OPPO' THEN 1 END) * 100.0 / NULLIF(COUNT(CASE WHEN p.phone_brand = 'OPPO' THEN 1 END), 0)) AS male_percentage
FROM
    gender_age g
JOIN
    phone_brand_device_model2 p ON g.device_id = p.device_id;
```
-------------------------1057 sample_num
```sql
SELECT longitude, latitude
FROM events
WHERE timestamp LIKE '2016-05-08%';
```
-------------------------1058 sample_num
```sql
SELECT app_id, is_installed
FROM app_events
WHERE event_id = 844;
```
-------------------------1059 sample_num
```sql
SELECT COUNT(*) AS event_count
FROM events
WHERE timestamp LIKE '2016-04-30%';
```
-------------------------1060 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM phone_brand_device_model2 AS p
JOIN gender_age AS g ON p.device_id = g.device_id
WHERE p.phone_brand = 'vivo' AND p.device_model = 'Xplay3S';
```
-------------------------1061 sample_num
```sql
SELECT
    DIVIDE(COUNT(CASE WHEN gender = 'M' AND `group` = 'M27-28' THEN device_id END),
           COUNT(CASE WHEN gender = 'F' AND `group` = 'F27-28' THEN device_id END)) AS male_female_ratio
FROM
    gender_age_train;
```
-------------------------1062 sample_num
```sql
SELECT label_id
FROM label_categories
WHERE category IN ('online shopping', 'online malls');
```
-------------------------1063 sample_num
```sql
SELECT DISTINCT pbdm.phone_brand, pbdm.device_model
FROM events e
JOIN phone_brand_device_model2 pbdm ON e.device_id = pbdm.device_id
WHERE e.timestamp LIKE '2016-05-05%'
AND e.longitude = 112
AND e.latitude = 44;
```
-------------------------1064 sample_num
```sql
SELECT a.app_id, e.timestamp
FROM app_events e
JOIN app_all a ON e.app_id = a.app_id
WHERE e.event_id = 82;
```
-------------------------1065 sample_num
```sql
SELECT g.gender, g.age
FROM events e
JOIN gender_age g ON e.device_id = g.device_id
WHERE e.event_id = 15251;
```
-------------------------1066 sample_num
```sql
SELECT COUNT(e.event_id) AS event_count
FROM events e
JOIN gender_age ga ON e.device_id = ga.device_id
WHERE ga.age = 88 AND ga.gender = 'M' AND e.timestamp LIKE '2016-05-04%';
```
-------------------------1067 sample_num
```sql
SELECT
    ga.age,
    ga.gender,
    COUNT(e.event_id) AS event_count
FROM
    events e
JOIN
    gender_age ga ON e.device_id = ga.device_id
WHERE
    e.longitude = -102 AND e.latitude = 38
GROUP BY
    ga.age, ga.gender;
```
-------------------------1068 sample_num
```sql
SELECT DISTINCT p.phone_brand, p.device_model
FROM events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
WHERE e.longitude = 80 AND e.latitude = 44;
```
-------------------------1069 sample_num
```sql
SELECT DISTINCT lc.category
FROM events e
JOIN app_events ae ON e.event_id = ae.event_id
JOIN app_labels al ON ae.app_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE e.event_id = 155;
```
-------------------------1070 sample_num
```sql
SELECT g.device_id
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE p.phone_brand = 'HTC' AND p.device_model = 'Butterfly' AND g.gender = 'F'
LIMIT 5;
```
-------------------------1071 sample_num
```sql
SELECT COUNT(DISTINCT al.app_id) AS science_fiction_app_count
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'science fiction';
```
-------------------------1072 sample_num
```sql
SELECT g.gender, g.age
FROM phone_brand_device_model2 p
JOIN gender_age g ON p.device_id = g.device_id
WHERE p.phone_brand = 'LG' AND p.device_model = 'L70';
```
-------------------------1073 sample_num
```sql
SELECT
    (COUNT(app_id) * 100.0 / (SELECT COUNT(app_id) FROM app_all)) AS percentage
FROM
    app_labels
JOIN
    label_categories ON app_labels.label_id = label_categories.label_id
WHERE
    label_categories.category = 'Industry tag';
```
-------------------------1074 sample_num
```sql
SELECT
    (COUNT(CASE WHEN device_model = 'Nexus 5' THEN device_id END) * 100.0 / COUNT(device_id)) AS percentage_nexus_5,
    (COUNT(CASE WHEN device_model = 'Nexus 5' AND gender = 'M' THEN device_id END) * 1.0 / NULLIF(COUNT(CASE WHEN device_model = 'Nexus 5' AND gender = 'F' THEN device_id END), 0)) AS male_female_ratio
FROM
    phone_brand_device_model2 p
JOIN
    gender_age g ON p.device_id = g.device_id
WHERE
    p.phone_brand = 'LG';
```
-------------------------1075 sample_num
```sql
SELECT COUNT(DISTINCT e.device_id) AS inactive_users
FROM events e
JOIN app_events ae ON e.event_id = ae.event_id
WHERE ae.is_active = 0 AND e.event_id = 2;
```
-------------------------1076 sample_num
```sql
SELECT COUNT(*) AS total_events
FROM events
WHERE timestamp LIKE '2016%';
```
-------------------------1077 sample_num
```sql
SELECT COUNT(*)
FROM events
WHERE device_id = 29182687948017100 AND timestamp LIKE '2016%';
```
-------------------------1078 sample_num
```sql
SELECT COUNT(DISTINCT device_id) AS male_device_users
FROM gender_age
WHERE gender = 'M';
```
-------------------------1079 sample_num
```sql
SELECT MAX(age) AS oldest_user_age
FROM gender_age_train;
```
-------------------------1080 sample_num
```sql
SELECT COUNT(*)
FROM gender_age
WHERE gender = 'F' AND age < 30;
```
-------------------------1081 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS female_users
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE p.device_model = 'Galaxy Note 2' AND g.gender = 'F';
```
-------------------------1082 sample_num
```sql
SELECT g.age
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE p.device_model = 'Galaxy Note 2';
```
-------------------------1083 sample_num
```sql
SELECT pd.device_model
FROM gender_age_train g
JOIN phone_brand_device_model2 pd ON g.device_id = pd.device_id
WHERE g.age = (SELECT MAX(age) FROM gender_age_train);
```
-------------------------1084 sample_num
```sql
SELECT group, COUNT(*) AS user_count
FROM gender_age
WHERE device_id IN (
    SELECT device_id
    FROM phone_brand_device_model2
    WHERE phone_brand = 'vivo'
)
GROUP BY group
ORDER BY user_count DESC
LIMIT 1;
```
-------------------------1085 sample_num
```sql
SELECT COUNT(DISTINCT a.app_id) AS user_count
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
JOIN app_all a ON al.app_id = a.app_id
WHERE lc.category = 'Securities';
```
-------------------------1086 sample_num
```sql
SELECT lc.category
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE al.app_id = 1977658975649780000;
```
-------------------------1087 sample_num
```sql
SELECT lc.category
FROM app_events ae
JOIN app_labels al ON ae.app_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE ae.event_id = 2 AND ae.is_active = 0;
```
-------------------------1088 sample_num
```sql
SELECT e.longitude, e.latitude
FROM app_events ae
JOIN events e ON ae.event_id = e.event_id
WHERE ae.is_active = 0 AND ae.event_id = 2;
```
-------------------------1089 sample_num
```sql
SELECT MIN(e.timestamp) AS earliest_time
FROM events e
JOIN app_events ae ON e.event_id = ae.event_id
WHERE e.event_id = 2 AND ae.is_active = 0;
```
-------------------------1090 sample_num
```sql
SELECT e.event_id
FROM events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
WHERE p.phone_brand = 'vivo';
```
-------------------------1091 sample_num
```sql
SELECT COUNT(DISTINCT e.device_id) AS vivo_device_count
FROM events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
WHERE e.event_id = 2 AND p.phone_brand = 'vivo';
```
-------------------------1092 sample_num
```sql
SELECT e.timestamp
FROM events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
WHERE e.event_id = '2' AND p.phone_brand = 'vivo';
```
-------------------------1093 sample_num
```sql
SELECT COUNT(*) AS total_events
FROM events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
WHERE p.phone_brand = 'vivo' AND YEAR(e.timestamp) = 2016;
```
-------------------------1094 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS female_under_30_count
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE p.phone_brand = 'vivo' AND g.gender = 'F' AND g.age < 30;
```
-------------------------1095 sample_num
```sql
SELECT lc.category, COUNT(al.app_id) AS user_count
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
GROUP BY lc.category
ORDER BY user_count DESC
LIMIT 1;
```
-------------------------1096 sample_num
```sql
SELECT pb.phone_brand
FROM gender_age ga
JOIN phone_brand_device_model2 pb ON ga.device_id = pb.device_id
WHERE ga.gender = 'F'
ORDER BY ga.age ASC
LIMIT 1;
```
-------------------------1097 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.group = 'M23-26' AND p.phone_brand = 'vivo';
```
-------------------------1098 sample_num
```sql
SELECT
    (COUNT(CASE WHEN g.group = 'M23-26' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM
    gender_age g
JOIN
    phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE
    p.phone_brand = 'vivo';
```
-------------------------1099 sample_num
```sql
SELECT
    (SUM(IF(pb.phone_brand = 'vivo', 1, 0)) / COUNT(e.device_id)) * 100 AS vivo_percentage
FROM
    events e
JOIN
    phone_brand_device_model2 pb ON e.device_id = pb.device_id
WHERE
    e.event_id = 2;
```
-------------------------1100 sample_num
```sql
SELECT AVG(gender_age.age) AS average_age
FROM gender_age
JOIN phone_brand_device_model2 ON gender_age.device_id = phone_brand_device_model2.device_id
WHERE phone_brand_device_model2.phone_brand = 'vivo';
```
-------------------------1101 sample_num
```sql
SELECT COUNT(*)
FROM gender_age
WHERE gender = 'F' AND group = 'F27-28';
```
-------------------------1102 sample_num
```sql
SELECT MAX(age) AS oldest_male_age
FROM gender_age_train
WHERE gender = 'M';
```
-------------------------1103 sample_num
```sql
SELECT COUNT(DISTINCT app_events.device_id) AS inactive_users
FROM app_events
WHERE is_installed = 1 AND is_active = 0;
```
-------------------------1104 sample_num
```sql
SELECT MIN(age) AS youngest_female_age
FROM gender_age
WHERE gender = 'F';
```
-------------------------1105 sample_num
```sql
SELECT COUNT(DISTINCT device_model) AS model_count
FROM phone_brand_device_model2
WHERE phone_brand = 'VIVO';
```
-------------------------1106 sample_num
```sql
SELECT DISTINCT device_model
FROM phone_brand_device_model2
WHERE phone_brand = 'OPPO'
LIMIT 15;
```
-------------------------1107 sample_num
```sql
SELECT DISTINCT p.device_model
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.gender = 'M' AND g.group = 'M39+'
LIMIT 10;
```
-------------------------1108 sample_num
```sql
SELECT DISTINCT p.device_model
FROM app_events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
WHERE e.is_installed = 1 AND e.is_active = 1
LIMIT 5;
```
-------------------------1109 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM gender_age g
JOIN app_labels al ON g.device_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'Financial Information';
```
-------------------------1110 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM gender_age g
JOIN app_labels al ON g.device_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'game-Art Style';
```
-------------------------1111 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS total_male_users
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.gender = 'Male' AND p.phone_brand = 'OPPO';
```
-------------------------1112 sample_num
```sql
SELECT pb.phone_brand
FROM gender_age ga
JOIN phone_brand_device_model2 pb ON ga.device_id = pb.device_id
WHERE ga.age = (SELECT MIN(age) FROM gender_age);
```
-------------------------1113 sample_num
```sql
SELECT lc.category, COUNT(gl.device_id) AS user_count
FROM label_categories lc
JOIN app_labels al ON lc.label_id = al.label_id
JOIN gender_age ga ON al.app_id = ga.device_id
GROUP BY lc.category
ORDER BY user_count ASC
LIMIT 3;
```
-------------------------1114 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS male_users
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.gender = 'M' AND p.device_model = 'Galaxy Ace Plus';
```
-------------------------1115 sample_num
```sql
SELECT group, COUNT(*) AS user_count
FROM phone_brand_device_model2 p
JOIN gender_age g ON p.device_id = g.device_id
WHERE p.phone_brand = 'OPPO'
GROUP BY group
ORDER BY user_count DESC
LIMIT 1;
```
-------------------------1116 sample_num
```sql
SELECT device_model, COUNT(device_model) AS model_count
FROM gender_age ga
JOIN phone_brand_device_model2 pd ON ga.device_id = pd.device_id
WHERE ga.gender = 'F'
GROUP BY device_model
ORDER BY model_count DESC
LIMIT 5;
```
-------------------------1117 sample_num
```sql
SELECT
    (SUM(IF(lc.category = '80s Japanese comic', 1, 0)) / COUNT(DISTINCT al.app_id)) * 100 AS '80s',
    (SUM(IF(lc.category = '90s Japanese comic', 1, 0)) / COUNT(DISTINCT al.app_id)) * 100 AS '90s',
    (SUM(IF(lc.category = '80s Japanese comic', 1, 0)) / NULLIF(SUM(IF(lc.category = '90s Japanese comic', 1, 0)), 0)) * 100 AS 'ratio_percentage'
FROM
    app_labels al
JOIN
    label_categories lc ON al.label_id = lc.label_id
GROUP BY
    lc.category;
```
-------------------------1118 sample_num
```sql
SELECT
    (SUM(IF(pb.phone_brand = 'OPPO' AND ga.gender = 'F', 1, 0)) /
     SUM(IF(pb.device_id = 'R815T', 1, 0))) * 100 AS percentage
FROM
    phone_brand_device_model2 pb
JOIN
    gender_age ga ON pb.device_id = ga.device_id
WHERE
    ga.gender = 'F';
```
-------------------------1119 sample_num
```sql
SELECT phone_brand
FROM phone_brand_device_model2
WHERE device_model = '坚果手机';
```
-------------------------1120 sample_num
```sql
SELECT COUNT(DISTINCT device_model) AS device_model_count
FROM phone_brand_device_model2
WHERE phone_brand = '中兴';
```
-------------------------1121 sample_num
```sql
SELECT group FROM gender_age WHERE age = 24;
```
-------------------------1122 sample_num
```sql
SELECT timestamp FROM events WHERE event_id = '887711';
```
-------------------------1123 sample_num
```sql
SELECT COUNT(*)
FROM events
WHERE DATE(timestamp) = '2016-05-06';
```
-------------------------1124 sample_num
```sql
SELECT p.device_model
FROM events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
WHERE e.timestamp = '2016/5/7 23:55:16' AND e.longitude = 113 AND e.latitude = 28;
```
-------------------------1125 sample_num
```sql
SELECT COUNT(DISTINCT a.app_id) AS game_fishing_app_count
FROM app_all a
JOIN app_labels al ON a.app_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'game-Fishing';
```
-------------------------1126 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS num_users
FROM phone_brand_device_model2 p
JOIN gender_age g ON p.device_id = g.device_id
WHERE p.device_model = '魅蓝Note 2' AND g.group = 'F29-32';
```
-------------------------1127 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS num_30_year_old_users
FROM gender_age g
JOIN events e ON g.device_id = e.device_id
WHERE g.age = '30'
  AND g.device_id IN (SELECT device_id FROM app_events WHERE is_active = 1)
  AND e.timestamp >= '2016-05-02 00:00:00'
  AND e.timestamp < '2016-05-03 00:00:00';
```
-------------------------1128 sample_num
```sql
SELECT COUNT(DISTINCT ae.app_id) AS installed_apps_count
FROM app_events ae
JOIN events e ON ae.event_id = e.event_id
WHERE e.timestamp = '2016/5/6 23:33:34' AND ae.is_installed = 1;
```
-------------------------1129 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS female_users
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.gender = 'F' AND p.phone_brand = 'E派';
```
-------------------------1130 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS male_users
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.gender = 'M' AND p.device_model = 'Galaxy S5';
```
-------------------------1131 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS active_users
FROM events e
JOIN gender_age g ON e.device_id = g.device_id
WHERE g.group = 'F29-32'
AND g.device_id IN (
    SELECT device_id
    FROM app_events
    WHERE is_active = '1'
)
AND e.timestamp BETWEEN '2016-05-07 00:00:00' AND '2016-05-07 23:59:59';
```
-------------------------1132 sample_num
```sql
SELECT lc.category
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE al.app_id = 894384172610331000;
```
-------------------------1133 sample_num
```sql
SELECT COUNT(DISTINCT ae.app_id) AS active_apps_count
FROM app_events ae
JOIN events e ON ae.event_id = e.event_id
WHERE e.timestamp = '2016/5/6 14:09:49'
  AND e.longitude = '116'
  AND e.latitude = '40'
  AND ae.is_active = '1';
```
-------------------------1134 sample_num
```sql
SELECT
    DIVIDE(
        SUM(IF(e1.timestamp = '2016/5/2 7:50:28' AND ae.is_active = '1', 1, 0)),
        SUM(IF(e2.timestamp = '2016/5/2 7:41:03' AND ae2.is_active = '1', 1, 0))
    ) AS active_app_ratio
FROM
    events e1
JOIN
    app_events ae ON e1.event_id = ae.event_id
JOIN
    events e2 ON e2.event_id = ae.event_id
JOIN
    app_events ae2 ON e2.event_id = ae2.event_id;
```
-------------------------1135 sample_num
```sql
SELECT COUNT(*) AS device_count
FROM phone_brand_device_model2
WHERE phone_brand = 'vivo';
```
-------------------------1136 sample_num
```sql
SELECT
    (SUM(IF(phone_brand = 'vivo', 1, 0)) - SUM(IF(phone_brand = 'LG', 1, 0))) AS device_difference
FROM
    phone_brand_device_model2;
```
-------------------------1137 sample_num
```sql
SELECT device_id
FROM gender_age
WHERE age = (SELECT MIN(age) FROM gender_age);
```
-------------------------1138 sample_num
```sql
SELECT COUNT(*)
FROM gender_age
WHERE gender = 'F' AND age > 30;
```
-------------------------1139 sample_num
```sql
SELECT gender
FROM gender_age
WHERE age = (SELECT MAX(age) FROM gender_age);
```
-------------------------1140 sample_num
```sql
SELECT MIN(age) AS youngest_female_age
FROM gender_age
WHERE gender = 'F';
```
-------------------------1141 sample_num
```sql
SELECT MIN(age) AS youngest_age
FROM gender_age
JOIN phone_brand_device_model2 ON gender_age.device_id = phone_brand_device_model2.device_id
WHERE phone_brand = 'vivo';
```
-------------------------1142 sample_num
```sql
SELECT DISTINCT a.app_id
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
JOIN app_all a ON al.app_id = a.app_id
WHERE lc.category = 'Securities';
```
-------------------------1143 sample_num
```sql
SELECT g.gender
FROM events e
JOIN gender_age g ON e.device_id = g.device_id
WHERE e.timestamp = '2016-05-01 00:55:25';
```
-------------------------1144 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS device_count
FROM events e
JOIN gender_age g ON e.device_id = g.device_id
WHERE YEAR(e.timestamp) = 2016 AND g.group = 'M23-26';
```
-------------------------1145 sample_num
```sql
SELECT pb.phone_brand, COUNT(DISTINCT ga.device_id) AS user_count
FROM gender_age ga
JOIN phone_brand_device_model2 pb ON ga.device_id = pb.device_id
WHERE ga.group = 'M23-26'
GROUP BY pb.phone_brand
ORDER BY user_count DESC
LIMIT 1;
```
-------------------------1146 sample_num
```sql
SELECT e.longitude, e.latitude
FROM events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
WHERE p.device_model = 'Galaxy Note 2';
```
-------------------------1147 sample_num
```sql
SELECT DISTINCT pd.device_model
FROM gender_age ga
JOIN phone_brand_device_model2 pd ON ga.device_id = pd.device_id
WHERE ga.gender = 'F';
```
-------------------------1148 sample_num
```sql
SELECT lc.category
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE al.app_id = '7324884708820020000';
```
-------------------------1149 sample_num
```sql
SELECT COUNT(DISTINCT ga.device_id) AS user_count
FROM gender_age ga
JOIN app_events ae ON ga.device_id = ae.device_id
JOIN app_labels al ON ae.app_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE ae.is_active = 0
AND ae.event_id = 2
AND lc.category = 'Property Industry 1.0';
```
-------------------------1150 sample_num
```sql
SELECT COUNT(DISTINCT lc.category) AS total_categories
FROM app_events ae
JOIN app_labels al ON ae.app_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE ae.is_active = 0 AND ae.event_id = 2;
```
-------------------------1151 sample_num
```sql
SELECT pd.device_model, COUNT(ga.device_id) AS female_count
FROM gender_age ga
JOIN phone_brand_device_model2 pd ON ga.device_id = pd.device_id
WHERE ga.gender = 'F' AND ga.age > 30
GROUP BY pd.device_model
ORDER BY female_count DESC
LIMIT 1;
```
-------------------------1152 sample_num
```sql
SELECT DISTINCT pd.device_model
FROM events e
JOIN phone_brand_device_model2 pd ON e.device_id = pd.device_id
WHERE e.longitude = 121 AND e.latitude = 31;
```
-------------------------1153 sample_num
```sql
SELECT lc.category, COUNT(al.app_id) AS user_count
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
GROUP BY lc.category
ORDER BY user_count DESC
LIMIT 3;
```
-------------------------1154 sample_num
```sql
SELECT e.event_id
FROM events e
JOIN gender_age g ON e.device_id = g.device_id
WHERE g.age = (SELECT MAX(age) FROM gender_age);
```
-------------------------1155 sample_num
```sql
SELECT COUNT(e.event_id) AS event_count
FROM events e
JOIN gender_age ga ON e.device_id = ga.device_id
WHERE ga.gender = 'F' AND ga.age = (SELECT MIN(age) FROM gender_age WHERE gender = 'F');
```
-------------------------1156 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS male_device_count
FROM events e
JOIN gender_age g ON e.device_id = g.device_id
WHERE e.timestamp::date = '2016-05-01' AND g.gender = 'M';
```
-------------------------1157 sample_num
```sql
SELECT
    SUBTRACT(IF(SUM(label_categories.category = 'Securities') > SUM(label_categories.category = 'Finance'), 'Securities', 'Finance')) AS more
FROM
    app_labels
JOIN
    label_categories ON app_labels.label_id = label_categories.label_id
GROUP BY
    label_categories.category;
```
-------------------------1158 sample_num
```sql
SELECT DISTINCT p.device_model
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.group = 'M23-26';
```
-------------------------1159 sample_num
```sql
SELECT AVG(gender_age.age) AS average_age
FROM gender_age
JOIN phone_brand_device_model2 ON gender_age.device_id = phone_brand_device_model2.device_id
WHERE gender_age.gender = 'F' AND phone_brand_device_model2.phone_brand = 'vivo';
```
-------------------------1160 sample_num
```sql
SELECT
    DIVIDE(SUM(CASE WHEN g.gender = 'M' THEN 1 ELSE 0 END),
           SUM(CASE WHEN g.gender = 'F' THEN 1 ELSE 0 END)) AS gender_ratio
FROM
    gender_age g
JOIN
    phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE
    p.phone_brand = 'vivo';
```
-------------------------1161 sample_num
```sql
SELECT
    DIVIDE(
        COUNT(DISTINCT al1.app_id),
        COUNT(DISTINCT al2.app_id)
    ) AS ratio
FROM
    app_labels al1
JOIN
    label_categories lc1 ON al1.label_id = lc1.label_id
JOIN
    app_labels al2 ON al1.app_id = al2.app_id
JOIN
    label_categories lc2 ON al2.label_id = lc2.label_id
WHERE
    lc1.category = 'Securities' AND
    lc2.category = 'Finance';
```
-------------------------1162 sample_num
```sql
SELECT label_id FROM label_categories WHERE category = 'Third-party card management';
```
-------------------------1163 sample_num
```sql
SELECT
    DIVIDE(SUM(CASE WHEN is_active = 1 THEN 1 ELSE 0 END),
           SUM(CASE WHEN is_active = 0 THEN 1 ELSE 0 END)) AS active_inactive_ratio
FROM
    app_events
WHERE
    event_id = 58;
```
-------------------------1164 sample_num
```sql
SELECT COUNT(*) AS event_count
FROM events
WHERE device_id = '3915082290673130000';
```
-------------------------1165 sample_num
```sql
SELECT
    (SUM(CASE WHEN gender = 'M' THEN 1 ELSE 0 END) * 100.0 / COUNT(device_id)) AS male_percentage
FROM
    gender_age;
```
-------------------------1166 sample_num
```sql
SELECT COUNT(*) AS event_count
FROM events
WHERE longitude = -156;
```
-------------------------1167 sample_num
```sql
SELECT COUNT(DISTINCT a.app_id) AS user_count
FROM app_labels al
JOIN app_all a ON al.app_id = a.app_id
WHERE al.label_id = '48';
```
-------------------------1168 sample_num
```sql
SELECT COUNT(*)
FROM label_categories
WHERE category LIKE 'game%';
```
-------------------------1169 sample_num
```sql
SELECT COUNT(*) AS number_of_events
FROM events
WHERE longitude = 80 AND latitude = 37;
```
-------------------------1170 sample_num
```sql
SELECT l.label_id, lc.category
FROM app_labels l
JOIN label_categories lc ON l.label_id = lc.label_id
WHERE l.app_id = '5758400314709850000';
```
-------------------------1171 sample_num
```sql
SELECT DISTINCT a.app_id
FROM app_all a
JOIN app_labels al ON a.app_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'game-Rowing';
```
-------------------------1172 sample_num
```sql
SELECT al.label_id, al.app_id
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'Chinese Classical Mythology';
```
-------------------------1173 sample_num
```sql
SELECT COUNT(DISTINCT a.app_id) AS app_id_count, e.longitude, e.latitude
FROM app_events AS a
JOIN events AS e ON a.event_id = e.event_id
WHERE a.event_id = '79641';
```
-------------------------1174 sample_num
```sql
SELECT longitude, latitude, timestamp
FROM events
WHERE event_id IN (
    SELECT event_id
    FROM app_events
    WHERE app_id = '8715964299802120000'
);
```
-------------------------1175 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS oppo_user_count
FROM events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
JOIN gender_age g ON e.device_id = g.device_id
WHERE p.phone_brand = 'OPPO'
AND DATE(e.timestamp) = '2016-05-01';
```
-------------------------1176 sample_num
```sql
SELECT
    DIVIDE(SUM(CASE WHEN g.gender = 'M' THEN 1 ELSE 0 END),
           SUM(CASE WHEN g.gender = 'F' THEN 1 ELSE 0 END)) AS male_female_ratio
FROM
    gender_age g
JOIN
    phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE
    p.phone_brand = 'vivo' AND p.device_model = 'X5Pro';
```
-------------------------1177 sample_num
```sql
SELECT COUNT(*)
FROM gender_age
JOIN phone_brand_device_model2 ON gender_age.device_id = phone_brand_device_model2.device_id
WHERE gender = 'F' AND phone_brand = 'ZUK' AND device_model = 'Z1' AND `group` = 'F23-';
```
-------------------------1178 sample_num
```sql
SELECT DISTINCT p.phone_brand, p.device_model
FROM phone_brand_device_model2 p
JOIN gender_age g ON p.device_id = g.device_id
WHERE g.age < 10;
```
-------------------------1179 sample_num
```sql
SELECT
    (SUM(CASE WHEN g.gender = 'F' AND g.age > 80 THEN 1 ELSE 0 END) * 100.0 / COUNT(g.device_id)) AS female_percentage_over_80
FROM
    gender_age g
JOIN
    phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE
    p.phone_brand = 'HTC';
```
-------------------------1180 sample_num
```sql
SELECT p.phone_brand, p.device_model
FROM events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
WHERE e.event_id = 6701;
```
-------------------------1181 sample_num
```sql
SELECT g.gender, g.age
FROM gender_age g
JOIN events e ON g.device_id = e.device_id
WHERE g.device_id BETWEEN '-9215352913819630000' AND '-9222956879900150000'
GROUP BY g.device_id, g.gender, g.age
ORDER BY COUNT(e.event_id) DESC
LIMIT 1;
```
-------------------------1182 sample_num
```sql
SELECT timestamp FROM events WHERE event_id = 12;
```
-------------------------1183 sample_num
```sql
SELECT COUNT(DISTINCT device_id) AS active_users
FROM events
JOIN app_events ON events.event_id = app_events.event_id
WHERE app_events.is_active = 1;
```
-------------------------1184 sample_num
```sql
SELECT COUNT(*)
FROM phone_brand_device_model2
WHERE device_model = 'A51';
```
-------------------------1185 sample_num
```sql
SELECT gender
FROM gender_age
WHERE device_id = '-9222956879900150000';
```
-------------------------1186 sample_num
```sql
SELECT COUNT(*)
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'game-card';
```
-------------------------1187 sample_num
```sql
SELECT DISTINCT g.age, g.group
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE p.phone_brand = 'vivo';
```
-------------------------1188 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.age < 30 AND p.device_model = 'Galaxy Note 2';
```
-------------------------1189 sample_num
```sql
SELECT
    (SUM(CASE WHEN age < 50 THEN 1 ELSE 0 END) * 100.0 / COUNT(device_id)) AS percentage_under_50
FROM
    phone_brand_device_model2 p
JOIN
    gender_age g ON p.device_id = g.device_id
WHERE
    p.phone_brand = 'OPPO';
```
-------------------------1190 sample_num
```sql
SELECT AVG(age) AS average_age
FROM gender_age_train
WHERE device_id IN (
    SELECT device_id
    FROM phone_brand_device_model2
    WHERE device_model = 'R7'
);
```
-------------------------1191 sample_num
```sql
SELECT lc.category
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE al.app_id = 5902120154267990000;
```
-------------------------1192 sample_num
```sql
SELECT DISTINCT g.group
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE p.phone_brand = 'LG';
```
-------------------------1193 sample_num
```sql
SELECT lc.category
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE al.app_id = 4955831798976240000;
```
-------------------------1194 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS female_users
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.gender = 'F' AND p.device_model = 'MI 3';
```
-------------------------1195 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS male_users_using_desire_820
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.gender = 'M' AND p.device_model = 'Desire 820';
```
-------------------------1196 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.age > 20 AND p.device_model = 'ELIFE E7 Mini';
```
-------------------------1197 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.age BETWEEN 20 AND 50 AND p.device_model = 'Galaxy Premier';
```
-------------------------1198 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS male_users
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.gender = 'M' AND p.phone_brand = 'HTC';
```
-------------------------1199 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE p.phone_brand = 'TCL' AND g.age BETWEEN 20 AND 60;
```
-------------------------1200 sample_num
```sql
SELECT
    (SUM(CASE WHEN ga.age > 20 THEN 1 ELSE 0 END) * 1.0 / COUNT(ga.device_id)) * 100 AS percentage_above_20
FROM
    gender_age ga
JOIN
    phone_brand_device_model2 pb ON ga.device_id = pb.device_id
WHERE
    pb.phone_brand = 'SUGAR';
```
-------------------------1201 sample_num
```sql
SELECT longitude, latitude
FROM events
WHERE timestamp BETWEEN '2016-04-30 00:00:00' AND '2016-04-30 23:59:59';
```
-------------------------1202 sample_num
```sql
SELECT COUNT(DISTINCT device_model) AS different_models
FROM phone_brand_device_model2
WHERE phone_brand = 'HTC';
```
-------------------------1203 sample_num
```sql
SELECT app_id
FROM app_events
WHERE is_installed = 1 AND is_active = 1;
```
-------------------------1204 sample_num
```sql
SELECT COUNT(DISTINCT app_id) AS app_count
FROM app_labels
WHERE label_id = 7;
```
-------------------------1205 sample_num
```sql
SELECT device_id
FROM gender_age
WHERE gender = 'F' AND age BETWEEN 29 AND 31;
```
-------------------------1206 sample_num
```sql
SELECT a.app_id
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
JOIN app_all a ON al.app_id = a.app_id
WHERE lc.category = 'game-stress reliever';
```
-------------------------1207 sample_num
```sql
SELECT DATE(FROM_UNIXTIME(e.timestamp)) AS event_date, COUNT(e.event_id) AS event_count
FROM events e
JOIN gender_age ga ON e.device_id = ga.device_id
WHERE ga.gender = 'M' AND ga.age = 40
GROUP BY event_date
ORDER BY event_count DESC
LIMIT 1;
```
-------------------------1208 sample_num
```sql
SELECT p.phone_brand, COUNT(a.app_id) AS installed_apps
FROM phone_brand_device_model2 p
JOIN app_events a ON p.device_id = a.device_id
WHERE a.is_installed = 1
GROUP BY p.phone_brand
ORDER BY installed_apps DESC
LIMIT 1;
```
-------------------------1209 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS men_under_23_inactive
FROM gender_age g
JOIN app_events a ON g.device_id = a.device_id
WHERE g.gender = 'M' AND g.age < 23 AND a.is_installed = 1 AND a.is_active = 0;
```
-------------------------1210 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS women_with_apps
FROM gender_age g
JOIN app_labels al ON g.device_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
JOIN app_events ae ON al.app_id = ae.app_id
WHERE g.gender = 'F' AND ae.is_installed = 1 AND lc.category = 'game-Finding fault';
```
-------------------------1211 sample_num
```sql
SELECT g.gender, COUNT(g.gender) AS gender_count
FROM events e
JOIN gender_age g ON e.device_id = g.device_id
WHERE e.timestamp BETWEEN '2016-05-01 00:00:00' AND '2016-05-10 23:59:59'
GROUP BY g.gender
ORDER BY gender_count DESC
LIMIT 1;
```
-------------------------1212 sample_num
```sql
SELECT group, COUNT(*) AS count
FROM gender_age
JOIN phone_brand_device_model2 ON gender_age.device_id = phone_brand_device_model2.device_id
WHERE device_model = 'SM-T2558'
GROUP BY group
ORDER BY count DESC
LIMIT 1;
```
-------------------------1213 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id)
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.age > 50 AND (p.phone_brand != 'HTC' OR p.device_model != 'One M8 Eye');
```
-------------------------1214 sample_num
```sql
SELECT e.longitude, e.latitude
FROM events e
JOIN gender_age ga ON e.device_id = ga.device_id
WHERE ga.gender = 'F' AND ga.age < 30;
```
-------------------------1215 sample_num
```sql
SELECT
    (SUM(CASE WHEN g.gender = 'F' AND ae.is_installed = 0 THEN 1 ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN g.gender = 'M' THEN 1 ELSE 0 END), 0)) * 100 AS percentage
FROM
    gender_age g
LEFT JOIN
    app_events ae ON g.device_id = ae.device_id;
```
-------------------------1216 sample_num
```sql
SELECT AVG(g.age) AS average_age
FROM gender_age g
JOIN app_events a ON g.device_id = a.device_id
WHERE a.is_installed = 1 AND a.is_active = 0;
```
-------------------------1217 sample_num
```sql
SELECT *
FROM events
WHERE timestamp LIKE '2016-05-01%' AND latitude = 31
LIMIT 3;
```
-------------------------1218 sample_num
```sql
SELECT event_id
FROM events
WHERE longitude = 0 AND latitude = 0
LIMIT 3;
```
-------------------------1219 sample_num
```sql
SELECT
    SUM(CASE WHEN latitude != 0 AND longitude != 0 THEN 1 ELSE 0 END) -
    SUM(CASE WHEN latitude = 0 AND longitude = 0 THEN 1 ELSE 0 END) AS difference
FROM
    events
WHERE
    device_id = -9222956879900150000;
```
-------------------------1220 sample_num
```sql
SELECT DISTINCT g.device_id
FROM gender_age g
WHERE g.gender = 'F'
LIMIT 3;
```
-------------------------1221 sample_num
```sql
SELECT label_id, category
FROM label_categories
WHERE category LIKE '%game%'
LIMIT 5;
```
-------------------------1222 sample_num
```sql
SELECT DISTINCT device_model
FROM phone_brand_device_model2
WHERE phone_brand = 'OPPO'
LIMIT 3;
```
-------------------------1223 sample_num
```sql
SELECT
    (SUM(CASE WHEN ae.is_installed = 1 AND ae.is_active = 0 THEN 1 ELSE 0 END) * 1.0 / COUNT(DISTINCT ae.app_id)) * 100 AS percentage
FROM
    app_events ae
JOIN
    events e ON ae.event_id = e.event_id
WHERE
    e.event_id = 6;
```
-------------------------1224 sample_num
```sql
SELECT
    CASE
        WHEN SUM(CASE WHEN g.gender = 'M' THEN 1 ELSE 0 END) > SUM(CASE WHEN g.gender = 'F' THEN 1 ELSE 0 END) THEN 'M'
        ELSE 'F'
    END AS more_owned_gender
FROM
    gender_age g
JOIN
    phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE
    p.device_model = 'Galaxy Note 2';
```
-------------------------1225 sample_num
```sql
SELECT timestamp, COUNT(DISTINCT device_id) AS active_users
FROM events
WHERE event_id = 2 AND is_active = 1;
```
-------------------------1226 sample_num
```sql
SELECT lc.category
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE al.app_id = 5902120154267990000;
```
-------------------------1227 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS user_count
FROM gender_age g
JOIN app_labels al ON g.device_id = al.app_id
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'comics';
```
-------------------------1228 sample_num
```sql
SELECT g.gender, g.age
FROM gender_age g
JOIN events e ON g.device_id = e.device_id
WHERE g.device_id = '29182687948017100' AND e.event_id = 1;
```
-------------------------1229 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS male_user_count
FROM gender_age g
JOIN events e ON g.device_id = e.device_id
WHERE g.gender = 'M' AND e.longitude = 114;
```
-------------------------1230 sample_num
```sql
SELECT timestamp
FROM events
WHERE event_id = 7 AND device_id = -8022267440849930000;
```
-------------------------1231 sample_num
```sql
SELECT lc.category
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE al.app_id = -9222198347540750000;
```
-------------------------1232 sample_num
```sql
SELECT g.group
FROM phone_brand_device_model2 p
JOIN gender_age g ON p.device_id = g.device_id
WHERE p.phone_brand = 'LG' AND p.device_model = 'Nexus 4';
```
-------------------------1233 sample_num
```sql
SELECT g.gender
FROM phone_brand_device_model2 p
JOIN gender_age g ON p.device_id = g.device_id
WHERE p.phone_brand = 'HTC' AND p.device_model = 'Desire 826'
LIMIT 1;
```
-------------------------1234 sample_num
```sql
SELECT
    (SUM(CASE WHEN lc.category = 'Academic Information' THEN 1 ELSE 0 END) * 100.0) / COUNT(DISTINCT al.app_id) AS percentage
FROM
    app_labels al
JOIN
    label_categories lc ON al.label_id = lc.label_id;
```
-------------------------1235 sample_num
```sql
SELECT
    (SUM(CASE WHEN ga.age = 'F27-28' THEN 1 ELSE 0 END) * 1.0 / COUNT(DISTINCT ga.device_id)) * 100 AS percentage
FROM
    events e
JOIN
    gender_age ga ON e.device_id = ga.device_id
WHERE
    e.timestamp LIKE '2016-05-03%';
```
-------------------------1236 sample_num
```sql
SELECT COUNT(*) AS oppo_device_count
FROM phone_brand_device_model2
WHERE phone_brand = 'OPPO';
```
-------------------------1237 sample_num
```sql
SELECT `group`, COUNT(*) as count
FROM gender_age
GROUP BY `group`
ORDER BY count DESC
LIMIT 1;
```
-------------------------1238 sample_num
```sql
SELECT COUNT(*) AS event_count
FROM events
WHERE device_id = '4069764298338760000';
```
-------------------------1239 sample_num
```sql
SELECT COUNT(DISTINCT a.app_id) AS equity_fund_count
FROM app_labels al
JOIN label_categories lc ON al.label_id = lc.label_id
WHERE lc.category = 'Equity Fund';
```
-------------------------1240 sample_num
```sql
SELECT e.longitude, e.latitude
FROM events e
JOIN gender_age ga ON e.device_id = ga.device_id
WHERE ga.gender = 'F' AND ga.group = 'F24-26';
```
-------------------------1241 sample_num
```sql
SELECT COUNT(DISTINCT g.device_id) AS male_users_count
FROM gender_age g
JOIN phone_brand_device_model2 p ON g.device_id = p.device_id
WHERE g.gender = 'M' AND p.device_model = 'Galaxy Note 3';
```
-------------------------1242 sample_num
```sql
SELECT p.phone_brand, p.device_model
FROM events e
JOIN phone_brand_device_model2 p ON e.device_id = p.device_id
WHERE e.timestamp = '2016-05-07 06:03:22';
```
-------------------------1243 sample_num
```sql
SELECT phone_brand, COUNT(*) AS brand_count
FROM phone_brand_device_model2 p
JOIN gender_age g ON p.device_id = g.device_id
WHERE g.age BETWEEN 20 AND 30
GROUP BY phone_brand
ORDER BY brand_count DESC
LIMIT 1;
```
-------------------------1244 sample_num
```sql
SELECT
    (SUM(CASE WHEN g.gender IS NULL AND g.age IS NULL AND g.group IS NULL THEN 1 ELSE 0 END) * 1.0 / COUNT(g.device_id)) * 100 AS percentage
FROM
    phone_brand_device_model2 p
LEFT JOIN
    gender_age g ON p.device_id = g.device_id
WHERE
    p.phone_brand = 'vivo';
```
-------------------------1245 sample_num
```sql
SELECT k.keyword
FROM Keyword k
JOIN Episode e ON k.episode_id = e.episode_id
WHERE e.title = 'Refuge: Part 1';
```
-------------------------1246 sample_num
```sql
SELECT COUNT(*)
FROM Keyword
WHERE episode_id IN (
    SELECT episode_id
    FROM Episode
    WHERE series = 'law_and_order' AND season = 9 AND episode = 23
);
```
-------------------------1247 sample_num
```sql
SELECT E.title
FROM Episode E
JOIN Keyword K ON E.episode_id = K.episode_id
WHERE K.keyword = 'laundering money';
```
-------------------------1248 sample_num
```sql
SELECT k.keyword
FROM Keyword k
JOIN Episode e ON k.episode_id = e.episode_id
WHERE e.rating > 8;
```
-------------------------1249 sample_num
```sql
SELECT SUM(votes) AS total_10_star_votes
FROM Vote
WHERE stars = 10 AND episode_id IN (
    SELECT episode_id
    FROM Episode
    WHERE title = 'Cherished'
);
```
-------------------------1250 sample_num
```sql
SELECT SUM(votes) AS total_votes
FROM Vote
WHERE episode_id IN (SELECT episode_id FROM Episode WHERE title = 'Cherished');
```
-------------------------1251 sample_num
```sql
SELECT e.title
FROM Episode e
JOIN Vote v ON e.episode_id = v.episode_id
WHERE v.stars = 10
ORDER BY v.votes DESC
LIMIT 1;
```
-------------------------1252 sample_num
```sql
SELECT role
FROM Credit
JOIN Episode ON Credit.episode_id = Episode.episode_id
WHERE Credit.person_id = (SELECT person_id FROM Person WHERE name = 'Park Dietz')
AND Episode.title = 'Cherished'
AND Credit.credited = 'true';
```
-------------------------1253 sample_num
```sql
SELECT COUNT(DISTINCT a.person_id)
FROM Award a
JOIN Episode e ON a.episode_id = e.episode_id
WHERE e.title = 'Cherished' AND a.credited = '';
```
-------------------------1254 sample_num
```sql
SELECT p.name
FROM Credit c
JOIN Person p ON c.person_id = p.person_id
JOIN Episode e ON c.episode_id = e.episode_id
WHERE c.credited = 'true'
AND c.role = 'technical advisor'
AND e.title = 'Cherished';
```
-------------------------1255 sample_num
```sql
SELECT COUNT(*)
FROM Credit
WHERE person_id = (SELECT person_id FROM Person WHERE name = 'Park Dietz')
AND credited = 'true';
```
-------------------------1256 sample_num
```sql
SELECT e.title
FROM Episode e
JOIN Credit c ON e.episode_id = c.episode_id
JOIN Person p ON c.person_id = p.person_id
WHERE p.name = 'Park Dietz' AND c.credited = 'true';
```
-------------------------1257 sample_num
```sql
SELECT COUNT(*) > 0 AS is_credited
FROM Credit
WHERE episode_id = 'tt0629204' AND person_id = (SELECT person_id FROM Person WHERE name = 'Anthony Azzara') AND credited = 'true';
```
-------------------------1258 sample_num
```sql
SELECT COUNT(*)
FROM Keyword
WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'Disciple');
```
-------------------------1259 sample_num
```sql
SELECT e.title
FROM Vote v
JOIN Episode e ON v.episode_id = e.episode_id
WHERE v.stars = '1'
ORDER BY v.votes DESC
LIMIT 1;
```
-------------------------1260 sample_num
```sql
SELECT COUNT(*)
FROM Award
WHERE series = 'Law and Order' AND episode_id = (SELECT episode_id FROM Episode WHERE series = 'Law and Order' AND season = 9 AND episode = 20);
```
-------------------------1261 sample_num
```sql
SELECT COUNT(DISTINCT role)
FROM Credit
WHERE episode_id IN (
    SELECT episode_id
    FROM Episode
    WHERE series = 'Law and Order' AND season = 9 AND episode = 17
) AND credited = 'true';
```
-------------------------1262 sample_num
```sql
SELECT E.summary
FROM Award A
JOIN Episode E ON A.episode_id = E.episode_id
WHERE A.award_id = '296';
```
-------------------------1263 sample_num
```sql
SELECT role
FROM Credit
WHERE person_id = (SELECT person_id FROM Person WHERE name = 'Joseph Blair');
```
-------------------------1264 sample_num
```sql
SELECT COUNT(*)
FROM Award
WHERE person_id = (SELECT person_id FROM Person WHERE name = 'Rene Balcer')
AND result = 'Nominated';
```
-------------------------1265 sample_num
```sql
SELECT air_date
FROM Episode
WHERE votes = (SELECT MAX(votes) FROM Episode);
```
-------------------------1266 sample_num
```sql
SELECT p.name
FROM Award a
JOIN Person p ON a.person_id = p.person_id
WHERE a.award_id = '313';
```
-------------------------1267 sample_num
```sql
SELECT COUNT(DISTINCT c.episode_id) AS episode_count
FROM Credit c
JOIN Person p ON c.person_id = p.person_id
WHERE p.name = 'J.K. Simmons';
```
-------------------------1268 sample_num
```sql
SELECT SUM(votes) AS nine_star_votes
FROM Vote
WHERE stars = '9' AND episode_id = (SELECT episode_id FROM Episode WHERE title = 'Sideshow');
```
-------------------------1269 sample_num
```sql
SELECT
    (SELECT COUNT(keyword) FROM Keyword k JOIN Episode e ON k.episode_id = e.episode_id WHERE e.title = 'Refuge: Part 1') /
    (SELECT COUNT(keyword) FROM Keyword k JOIN Episode e ON k.episode_id = e.episode_id WHERE e.title = 'Shield') AS times;
```
-------------------------1270 sample_num
```sql
SELECT AVG(cast_count) AS average_cast_members
FROM (
    SELECT COUNT(person_id) AS cast_count
    FROM Credit
    WHERE credited = 'TRUE' AND episode_id IN (
        SELECT episode_id
        FROM Episode
        WHERE number_in_series BETWEEN 185 AND 193
    ) AND category = 'Cast'
    GROUP BY episode_id
) AS cast_counts;
```
-------------------------1271 sample_num
```sql
SELECT p.name
FROM Person p
WHERE p.person_id NOT IN (
    SELECT c.person_id
    FROM Credit c
    WHERE c.episode_id = 'tt0629391' AND c.credited = ''
);
```
-------------------------1272 sample_num
```sql
SELECT COUNT(DISTINCT person_id) AS number_of_people
FROM Award
WHERE result = 'Winner'
GROUP BY person_id
HAVING COUNT(result) >= 3;
```
-------------------------1273 sample_num
```sql
SELECT p.name
FROM Credit c
JOIN Person p ON c.person_id = p.person_id
WHERE c.episode_id = 'tt0629204' AND c.role = 'script supervisor';
```
-------------------------1274 sample_num
```sql
SELECT COUNT(*)
FROM Award
WHERE person_id = (SELECT person_id FROM Person WHERE name = 'Julia Roberts')
AND result = 'Nominee';
```
-------------------------1275 sample_num
```sql
SELECT name
FROM Person
WHERE person_id IN (
    SELECT person_id
    FROM Credit
    WHERE role = 'camera operator'
)
ORDER BY height_meters DESC
LIMIT 1;
```
-------------------------1276 sample_num
```sql
SELECT COUNT(DISTINCT a.person_id)
FROM Award a
JOIN Person p ON a.person_id = p.person_id
WHERE p.birth_country = 'Canada' AND a.year = 1999;
```
-------------------------1277 sample_num
```sql
SELECT COUNT(DISTINCT v.person_id) AS num_people
FROM Vote v
JOIN Episode e ON v.episode_id = e.episode_id
WHERE e.rating = (SELECT MAX(rating) FROM Episode) AND v.stars = 10;
```
-------------------------1278 sample_num
```sql
SELECT k.keyword
FROM Keyword k
JOIN Episode e ON k.episode_id = e.episode_id
WHERE e.title = 'Shield';
```
-------------------------1279 sample_num
```sql
SELECT (COUNT(CASE WHEN v.stars = 1 THEN 1 END) * 100.0 / COUNT(v.episode_id)) AS percentage
FROM Vote v
JOIN Episode e ON v.episode_id = e.episode_id
WHERE e.title = 'True North';
```
-------------------------1280 sample_num
```sql
SELECT e.title
FROM Episode e
JOIN Keyword k ON e.episode_id = k.episode_id
GROUP BY e.episode_id, e.title
ORDER BY COUNT(k.keyword) DESC
LIMIT 1;
```
-------------------------1281 sample_num
```sql
SELECT COUNT(DISTINCT a.episode_id) AS winner_count
FROM Award a
JOIN Episode e ON a.episode_id = e.episode_id
WHERE e.air_date LIKE '1998%'
  AND a.result = 'Winner'
  AND a.organization = 'International Monitor Awards';
```
-------------------------1282 sample_num
```sql
SELECT COUNT(*)
FROM Award
WHERE episode_id IN (SELECT episode_id FROM Episode WHERE title = 'Agony')
AND result = 'Winner';
```
-------------------------1283 sample_num
```sql
SELECT
    (SELECT COUNT(*) FROM Episode WHERE series = 'Law and Order' AND season = 9) AS episode_count,
    (SELECT AVG(cast_count) FROM (
        SELECT COUNT(CASE WHEN category = 'Cast' THEN person_id END) AS cast_count
        FROM Credit
        JOIN Episode ON Credit.episode_id = Episode.episode_id
        WHERE Episode.series = 'Law and Order'
        GROUP BY Episode.season
    ) AS season_casts) AS average_casts_per_season;
```
-------------------------1284 sample_num
```sql
SELECT k.keyword
FROM Keyword k
JOIN Vote v ON k.episode_id = v.episode_id
WHERE v.votes = (
    SELECT DISTINCT v2.votes
    FROM Vote v2
    ORDER BY v2.votes DESC
    LIMIT 1 OFFSET 1
);
```
-------------------------1285 sample_num
```sql
SELECT COUNT(*)
FROM Award
WHERE series = 'Agony' AND result = 'Winner';
```
-------------------------1286 sample_num
```sql
SELECT p.name
FROM Person p
JOIN Credit c ON p.person_id = c.person_id
JOIN Episode e ON c.episode_id = e.episode_id
WHERE c.role = 'Narrator' AND e.title = 'Flight';
```
-------------------------1287 sample_num
```sql
SELECT organization, COUNT(award_id) AS award_count
FROM Award
WHERE person_id = (SELECT person_id FROM Person WHERE name = 'Constantine Makris')
AND result = 'Winner'
GROUP BY organization
ORDER BY award_count DESC
LIMIT 1;
```
-------------------------1288 sample_num
```sql
SELECT p.name
FROM Person p
JOIN Credit c ON p.person_id = c.person_id
WHERE c.episode_id = 3 AND c.role = 'stunt coordinator';
```
-------------------------1289 sample_num
```sql
SELECT COUNT(DISTINCT p.person_id) AS not_credited_count
FROM Person p
WHERE p.person_id NOT IN (
    SELECT c.person_id
    FROM Credit c
    JOIN Episode e ON c.episode_id = e.episode_id
    WHERE e.title = 'Admissions' AND c.credited = ''
);
```
-------------------------1290 sample_num
```sql
SELECT e.title
FROM Episode e
JOIN Credit c ON e.episode_id = c.episode_id
WHERE c.category = 'Art Department'
GROUP BY e.episode_id, e.title
ORDER BY COUNT(c.person_id) DESC
LIMIT 1;
```
-------------------------1291 sample_num
```sql
SELECT COUNT(DISTINCT role)
FROM Credit
WHERE person_id = (SELECT person_id FROM Person WHERE name = 'Julia Roberts');
```
-------------------------1292 sample_num
```sql
SELECT title
FROM Episode
WHERE episode_id IN (
    SELECT episode_id
    FROM Vote
    WHERE votes >= 30 AND stars = 10
)
LIMIT 3;
```
-------------------------1293 sample_num
```sql
SELECT name
FROM Person
WHERE person_id IN (
    SELECT person_id
    FROM Credit
    WHERE role = 'Clerk'
)
ORDER BY birthdate DESC
LIMIT 1;
```
-------------------------1294 sample_num
```sql
SELECT COUNT(*) AS people_did_not_enjoy
FROM Vote
WHERE episode_id = (SELECT episode_id FROM Episode WHERE episode = 24)
AND stars = 1;
```
-------------------------1295 sample_num
```sql
SELECT DISTINCT p.name
FROM Credit c
JOIN Person p ON c.person_id = p.person_id
WHERE c.category = 'Cast';
```
-------------------------1296 sample_num
```sql
WITH PersonAppearances AS (
    SELECT p.name, COUNT(c.person_id) AS appearance_count
    FROM Person p
    JOIN Credit c ON p.person_id = c.person_id
    GROUP BY p.name
),
MaxAppearance AS (
    SELECT MAX(appearance_count) AS max_count
    FROM PersonAppearances
),
TotalAppearances AS (
    SELECT SUM(appearance_count) AS total_count
    FROM PersonAppearances
)
SELECT pa.name,
       (pa.appearance_count * 100.0 / ta.total_count) AS percentage
FROM PersonAppearances pa
JOIN MaxAppearance ma ON pa.appearance_count = ma.max_count
JOIN TotalAppearances ta ON 1=1;
```
-------------------------1297 sample_num
```sql
SELECT e.title, e.season, e.episode, e.air_date
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
WHERE a.award_category = 'Primetime Emmy' AND e.series = 'Law & Order';
```
-------------------------1298 sample_num
```sql
SELECT COUNT(DISTINCT e.episode_id) AS episodes_without_awards
FROM Episode e
LEFT JOIN Award a ON e.episode_id = a.episode_id AND a.result != 'Nominee'
WHERE a.award_id IS NULL;
```
-------------------------1299 sample_num
```sql
SELECT DISTINCT role
FROM Credit
WHERE credited = '';
```
-------------------------1300 sample_num
```sql
SELECT title
FROM Episode
ORDER BY rating ASC
LIMIT 3;
```
-------------------------1301 sample_num
```sql
SELECT CONCAT(birth_place, ', ', birth_region) AS full_place_of_birth
FROM Person
WHERE birth_name = 'Rene Chenevert Balcer';
```
-------------------------1302 sample_num
```sql
SELECT name FROM Person WHERE birth_country = 'USA';
```
-------------------------1303 sample_num
```sql
SELECT E.title
FROM Episode E
JOIN Vote V ON E.episode_id = V.episode_id
WHERE V.stars = 1;
```
-------------------------1304 sample_num
```sql
SELECT DISTINCT p.name
FROM Award a
JOIN Person p ON a.person_id = p.person_id
WHERE a.result = 'Winner' AND a.role = 'director';
```
-------------------------1305 sample_num
```sql
SELECT votes FROM Episode WHERE title = 'Juvenile';
```
-------------------------1306 sample_num
```sql
SELECT e.title
FROM Episode e
LEFT JOIN Credit c ON e.episode_id = c.episode_id AND c.person_id = (SELECT person_id FROM Person WHERE name = 'Anthony Azzara')
WHERE c.credited = '' OR c.credited IS NULL;
```
-------------------------1307 sample_num
```sql
SELECT DISTINCT A.year
FROM Award A
JOIN Episode E ON A.episode_id = E.episode_id
WHERE E.title = 'DWB' AND A.result = 'Winner';
```
-------------------------1308 sample_num
```sql
SELECT DISTINCT birth_region
FROM Person
JOIN Credit ON Person.person_id = Credit.person_id
WHERE Credit.role = 'assistant location manager';
```
-------------------------1309 sample_num
```sql
SELECT SUM(v.stars) AS total_stars
FROM Vote v
JOIN Credit c ON v.episode_id = c.episode_id
JOIN Person p ON c.person_id = p.person_id
WHERE p.name = 'Donna Villella';
```
-------------------------1310 sample_num
```sql
SELECT role
FROM Award
WHERE person_id = (SELECT person_id FROM Person WHERE name = 'Julia Roberts')
AND result = 'Nominee';
```
-------------------------1311 sample_num
```sql
SELECT role
FROM Person
JOIN Credit ON Person.person_id = Credit.person_id
WHERE height_meters = (SELECT MAX(height_meters) FROM Person);
```
-------------------------1312 sample_num
```sql
SELECT title
FROM Episode
WHERE episode_id = (
    SELECT episode_id
    FROM Award
    WHERE result = 'Nominee'
    GROUP BY episode_id
    ORDER BY COUNT(*) DESC
    LIMIT 1
);
```
-------------------------1313 sample_num
```sql
SELECT E.rating
FROM Episode E
JOIN Credit C ON E.episode_id = C.episode_id
JOIN Person P ON C.person_id = P.person_id
WHERE P.name = 'Jace Alexander';
```
-------------------------1314 sample_num
```sql
SELECT DISTINCT p.name
FROM Person p
JOIN Credit c ON p.person_id = c.person_id
WHERE c.episode_id = (
    SELECT episode_id
    FROM Episode
    WHERE season = 9 AND episode = 19
);
```
-------------------------1315 sample_num
```sql
SELECT AVG(v.stars) AS average_star_rating
FROM Vote v
JOIN Credit c ON v.episode_id = c.episode_id
JOIN Person p ON c.person_id = p.person_id
WHERE p.name = 'Jim Bracchitta';
```
-------------------------1316 sample_num
```sql
SELECT
    (COUNT(CASE WHEN role = 'Additional Crew' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM
    Credit
WHERE
    episode_id IN (SELECT episode_id FROM Episode WHERE title = 'True North');
```
-------------------------1317 sample_num
```sql
SELECT title, summary, air_date
FROM Episode
WHERE episode_id IN (
    SELECT episode_id
    FROM Vote
    WHERE stars = 10 AND votes = 72
);
```
-------------------------1318 sample_num
```sql
SELECT e.air_date, e.rating, COUNT(v.stars) AS six_star_votes
FROM Episode e
JOIN Vote v ON e.episode_id = v.episode_id
WHERE e.episode_id = 12 AND v.stars = 6
GROUP BY e.air_date, e.rating;
```
-------------------------1319 sample_num
```sql
SELECT p.name, a.role
FROM Award a
JOIN Person p ON a.person_id = p.person_id
WHERE a.award = 'Best Television Episode'
  AND a.award_category = 'Edgar'
  AND a.year = 2000;
```
-------------------------1320 sample_num
```sql
SELECT organization, year, award, award_category
FROM Award
WHERE person_id = (SELECT person_id FROM Person WHERE name = 'Rene Balcer')
AND result = 'Winner';
```
-------------------------1321 sample_num
```sql
SELECT a1.year, a1.episode_id
FROM Award a1
JOIN Person p ON a1.person_id = p.person_id
WHERE p.name = 'Constantine Makris'
  AND a1.result = 'Winner'
  AND a1.award = 'Television'
  AND a1.award_category = 'Silver Gavel Award'
  AND a1.organization = 'American Bar Association Silver Gavel Awards for Media and the Arts'
  AND EXISTS (
      SELECT 1
      FROM Award a2
      WHERE a2.person_id = a1.person_id
        AND a2.result = 'Winner'
        AND a2.award = 'Television'
        AND a2.award_category = 'Silver Gavel Award'
        AND a2.organization = 'American Bar Association Silver Gavel Awards for Media and the Arts'
        AND a2.year = a1.year + 1
        AND a2.episode_id = a1.episode_id
  );
```
-------------------------1322 sample_num
```sql
SELECT p.name
FROM Person p
JOIN Award a ON p.person_id = a.person_id
WHERE a.series = 'Law and Order'
  AND a.role = 'writer'
  AND a.result = 'Winner'
  AND a.award_category = 'Silver Gavel Award'
  AND a.organization = 'American Bar Association Silver Gavel Awards for Media and the Arts'
GROUP BY p.name
HAVING COUNT(DISTINCT a.year) = 2;
```
-------------------------1323 sample_num
```sql
SELECT COUNT(*)
FROM Award
WHERE episode_id = 20
  AND series = 'Law and Order'
  AND organization = 'Primetime Emmy Awards'
  AND year = 1999
  AND result = 'nominee';
```
-------------------------1324 sample_num
```sql
SELECT e.title, a.role
FROM Award a
JOIN Episode e ON a.episode_id = e.episode_id
WHERE a.person_id = (SELECT person_id FROM Person WHERE name = 'Julia Roberts')
  AND a.result = 'Winner'
  AND a.award = 'Outstanding Guest Actress in a Drama Series'
  AND a.year = 1999
  AND a.organization = 'Primetime Emmy Awards';
```
-------------------------1325 sample_num
```sql
SELECT e.title, e.air_date
FROM Episode e
JOIN Credit c ON e.episode_id = c.episode_id
JOIN Person p ON c.person_id = p.person_id
WHERE p.name = 'Billy Fox' AND c.role = 'producer';
```
-------------------------1326 sample_num
```sql
SELECT COUNT(*)
FROM Credit
JOIN Person ON Credit.person_id = Person.person_id
WHERE Credit.episode_id = 'tt0629228'
AND Person.birth_country = 'USA'
AND Credit.category = 'Cast'
AND Credit.credited = '';
```
-------------------------1327 sample_num
```sql
SELECT role
FROM Credit
WHERE person_id = (SELECT person_id FROM Person WHERE name = 'Jason Kuschner')
AND episode_id = 9;
```
-------------------------1328 sample_num
```sql
SELECT p.name
FROM Credit c
JOIN Person p ON c.person_id = p.person_id
WHERE c.role = 'president of NBC West Coast'
AND c.episode_id = (SELECT episode_id FROM Episode WHERE season = 1 AND episode = 1);
```
-------------------------1329 sample_num
```sql
SELECT e.title
FROM Episode e
JOIN Vote v ON e.episode_id = v.episode_id
GROUP BY e.episode_id, e.title
ORDER BY SUM(v.stars * v.percent / 100) DESC
LIMIT 3;
```
-------------------------1330 sample_num
```sql
SELECT
    COUNT(CASE WHEN p.birth_country = 'USA' THEN 1 END) * 1.0 / COUNT(c.person_id) AS ratio,
    c.role
FROM
    Credit c
JOIN
    Person p ON c.person_id = p.person_id
WHERE
    c.episode_id = 2 AND c.category = 'Cast'
GROUP BY
    c.role;
```
-------------------------1331 sample_num
```sql
SELECT COUNT(DISTINCT p.person_id)
FROM Person p
JOIN Award a ON p.person_id = a.person_id
WHERE p.birth_country = 'Canada' AND a.award IS NOT NULL;
```
-------------------------1332 sample_num
```sql
SELECT COUNT(DISTINCT c.episode_id) AS episode_count
FROM Credit c
JOIN Person p ON c.person_id = p.person_id
WHERE p.name = 'Jerry Orbach';
```
-------------------------1333 sample_num
```sql
SELECT p.name
FROM Credit c
JOIN Person p ON c.person_id = p.person_id
WHERE c.episode_id = 9;
```
-------------------------1334 sample_num
```sql
SELECT DISTINCT a.award
FROM Award a
WHERE a.episode_id = 20 AND (a.result = 'Winner' OR a.result = 'Nominee');
```
-------------------------1335 sample_num
```sql
SELECT role, name
FROM Award
JOIN Person ON Award.person_id = Person.person_id
GROUP BY role, name
HAVING COUNT(award_id) > 1;
```
-------------------------1336 sample_num
```sql
SELECT p.name, e.episode
FROM Award a
JOIN Person p ON a.person_id = p.person_id
JOIN Episode e ON a.episode_id = e.episode_id
WHERE a.role = 'director' AND a.result = 'Winner';
```
-------------------------1337 sample_num
```sql
SELECT DISTINCT e.episode_id, e.title
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
WHERE a.result = 'Nominee';
```
-------------------------1338 sample_num
```sql
SELECT episode_id, AVG(rating) AS average_rating
FROM Episode
WHERE season = 9
GROUP BY episode_id;
```
-------------------------1339 sample_num
```sql
SELECT
    (SELECT votes FROM Vote WHERE episode_id = (SELECT episode_id FROM Episode WHERE episode = 1) AND stars = 10) -
    (SELECT votes FROM Vote WHERE episode_id = (SELECT episode_id FROM Episode WHERE episode = 24) AND stars = 10) AS difference
```
-------------------------1340 sample_num
```sql
SELECT e.rating
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
WHERE a.result = 'Winner'
GROUP BY e.episode_id
ORDER BY COUNT(a.award_id) DESC
LIMIT 1;
```
-------------------------1341 sample_num
```sql
SELECT COUNT(*)
FROM Credit
WHERE episode_id IN (SELECT episode_id FROM Episode WHERE episode >= 1 AND episode <= 10)
AND credited = 'true';
```
-------------------------1342 sample_num
```sql
SELECT e.*
FROM Episode e
JOIN Keyword k ON e.episode_id = k.episode_id
WHERE k.keyword = 'mafia';
```
-------------------------1343 sample_num
```sql
SELECT AVG(v.stars) AS average_star
FROM Vote v
JOIN Award a ON v.episode_id = a.episode_id
WHERE a.result = 'Winner'
AND v.percent = (SELECT MAX(percent) FROM Vote WHERE episode_id IN (SELECT episode_id FROM Award WHERE result = 'Winner'));
```
-------------------------1344 sample_num
```sql
SELECT AVG(rating) AS average_ranking
FROM Episode
WHERE episode_id IN (
    SELECT episode_id
    FROM Award
    WHERE result = 'Nominated'
);
```
-------------------------1345 sample_num
```sql
SELECT COUNT(DISTINCT person_id)
FROM Award
WHERE result = 'Winner'
  AND award = 'Television'
  AND organization = 'American Bar Association Silver Gavel Awards for Media and the Arts';
```
-------------------------1346 sample_num
```sql
SELECT birth_country FROM Person WHERE name = 'Michael Preston';
```
-------------------------1347 sample_num
```sql
SELECT p.name
FROM Award a
JOIN Person p ON a.person_id = p.person_id
WHERE a.result = 'Nominee'
AND a.role = 'Katrina Ludlow'
AND a.series = 'Law & Order';
```
-------------------------1348 sample_num
```sql
SELECT p.name
FROM Award a
JOIN Credit c ON a.episode_id = c.episode_id AND a.person_id = c.person_id
JOIN Person p ON c.person_id = p.person_id
WHERE a.award = 'Best Television Episode' AND a.result = 'Winner' AND c.role = 'teleplay';
```
-------------------------1349 sample_num
```sql
SELECT p.birthdate
FROM Person p
JOIN Credit c ON p.person_id = c.person_id
WHERE c.role = 'writer';
```
-------------------------1350 sample_num
```sql
SELECT e.title
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
WHERE a.award = 'Outstanding Costume Design for a Series';
```
-------------------------1351 sample_num
```sql
SELECT title
FROM Episode
WHERE episode_id = (
    SELECT episode_id
    FROM Vote
    GROUP BY episode_id
    ORDER BY SUM(votes) DESC
    LIMIT 1
);
```
-------------------------1352 sample_num
```sql
SELECT p.name
FROM Person p
JOIN Credit c ON p.person_id = c.person_id
WHERE c.role = 'Alex Brown' AND c.credited = 'true';
```
-------------------------1353 sample_num
```sql
SELECT birth_place
FROM Person
WHERE person_id = 'nm007064'
AND person_id NOT IN (
    SELECT person_id
    FROM Credit
    WHERE role = 'narrator'
    AND credited = ''
);
```
-------------------------1354 sample_num
```sql
SELECT k.keyword
FROM Keyword k
JOIN Episode e ON k.episode_id = e.episode_id
WHERE e.title = 'Shield';
```
-------------------------1355 sample_num
```sql
SELECT DISTINCT p.name
FROM Person p
JOIN Credit c ON p.person_id = c.person_id
JOIN Award a ON c.episode_id = a.episode_id
WHERE p.height_meters > 1.80 AND a.result = 'Winner';
```
-------------------------1356 sample_num
```sql
SELECT e.title
FROM Episode e
JOIN Keyword k ON e.episode_id = k.episode_id
WHERE k.keyword IN ('nun', 'priest')
GROUP BY e.episode_id
HAVING COUNT(DISTINCT k.keyword) = 2;
```
-------------------------1357 sample_num
```sql
SELECT episode_id
FROM Episode
WHERE rating = 8.5
AND episode_id IN (
    SELECT episode_id
    FROM Award
    WHERE award = 'Best Television Episode'
    AND result = 'Winner'
)
ORDER BY episode_id
LIMIT 1 OFFSET 1;
```
-------------------------1358 sample_num
```sql
SELECT title
FROM Episode
JOIN Vote ON Episode.episode_id = Vote.episode_id
WHERE Vote.stars = 10
LIMIT 3;
```
-------------------------1359 sample_num
```sql
SELECT VALUE, UNITS
FROM observations
WHERE DATE = '2008-03-11'
AND PATIENT = (SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss')
AND DESCRIPTION = 'Body Height';
```
-------------------------1360 sample_num
```sql
SELECT
    (SELECT VALUE FROM observations WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss') AND DATE LIKE '2009%' AND DESCRIPTION = 'Body Weight') -
    (SELECT VALUE FROM observations WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss') AND DATE LIKE '2008%' AND DESCRIPTION = 'Body Weight') AS weight_increase;
```
-------------------------1361 sample_num
```sql
SELECT MAX(VALUE) AS Highest_Systolic_Blood_Pressure
FROM observations
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss')
AND DESCRIPTION = 'Systolic Blood Pressure';
```
-------------------------1362 sample_num
```sql
SELECT COUNT(*)
FROM observations
WHERE PATIENT IN (
    SELECT patient
    FROM patients
    WHERE first = 'Elly' AND last = 'Koss'
) AND DESCRIPTION = 'Systolic Blood Pressure';
```
-------------------------1363 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM observations o
JOIN patients p ON o.PATIENT = p.patient
WHERE o.DESCRIPTION = 'Systolic Blood Pressure'
ORDER BY o.VALUE DESC
LIMIT 1;
```
-------------------------1364 sample_num
```sql
SELECT SUM(
    (365 * (strftime('%Y', STOP) - strftime('%Y', START))) +
    (30 * (strftime('%m', STOP) - strftime('%m', START))) +
    (strftime('%d', STOP) - strftime('%d', START))
) AS duration
FROM medications
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss')
AND DESCRIPTION LIKE 'Acetaminophen%';
```
-------------------------1365 sample_num
```sql
SELECT DESCRIPTION
FROM medications
WHERE PATIENT IN (
    SELECT patient
    FROM patients
    WHERE first = 'Elly' AND last = 'Koss'
);
```
-------------------------1366 sample_num
```sql
SELECT m.REASONDESCRIPTION
FROM medications m
JOIN patients p ON m.PATIENT = p.patient
WHERE p.first = 'Elly' AND p.last = 'Koss' AND m.DESCRIPTION LIKE 'Acetaminophen%';
```
-------------------------1367 sample_num
```sql
SELECT m.DESCRIPTION
FROM medications m
JOIN encounters e ON m.ENCOUNTER = e.ID
JOIN patients p ON e.PATIENT = p.patient
WHERE p.first = 'Elly' AND p.last = 'Koss' AND e.REASONDESCRIPTION LIKE 'Streptococcal sore throat%';
```
-------------------------1368 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN medications m ON p.patient = m.PATIENT
WHERE m.DESCRIPTION LIKE 'Acetaminophen%';
```
-------------------------1369 sample_num
```sql
SELECT DESCRIPTION
FROM conditions
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss')
AND START = '2009-01-08';
```
-------------------------1370 sample_num
```sql
SELECT SUM(
    (strftime('%Y', STOP) - strftime('%Y', START)) * 365 +
    (strftime('%m', STOP) - strftime('%m', START)) * 30 +
    (strftime('%d', STOP) - strftime('%d', START))
) AS duration
FROM conditions
WHERE DESCRIPTION = 'Cystitis' AND PATIENT = (
    SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss'
);
```
-------------------------1371 sample_num
```sql
SELECT DIVIDE(SUM(VALUE), COUNT(VALUE)) AS average_weight
FROM observations
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss')
  AND DESCRIPTION = 'Body Weight';
```
-------------------------1372 sample_num
```sql
SELECT
    (COUNT(CASE WHEN p.marital = 'M' THEN 1 END) * 100.0 / COUNT(p.patient)) AS percentage
FROM
    patients p
JOIN
    conditions c ON p.patient = c.PATIENT
WHERE
    c.DESCRIPTION = 'Cystitis';
```
-------------------------1373 sample_num
```sql
SELECT VALUE, UNITS
FROM observations
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Vincent' AND last = 'Wyman')
AND DESCRIPTION = 'Body Height'
AND DATE = '2010-08-02';
```
-------------------------1374 sample_num
```sql
SELECT COUNT(*) AS care_plan_count
FROM careplans cp
JOIN patients p ON cp.PATIENT = p.patient
WHERE p.first = 'Norman' AND p.last = 'Berge';
```
-------------------------1375 sample_num
```sql
SELECT REASONDESCRIPTION
FROM medications
WHERE DESCRIPTION = 'Leucovorin 100 MG Injection'
AND START = '1970-12-19'
AND PATIENT = (SELECT patient FROM patients WHERE first = 'Annabelle' AND last = 'Pouros');
```
-------------------------1376 sample_num
```sql
SELECT PREVALENCE PERCENTAGE
FROM all_prevalences
WHERE ITEM = '64859006';
```
-------------------------1377 sample_num
```sql
SELECT PREVALENCE RATE
FROM all_prevalences
WHERE ITEM = '368581000119106';
```
-------------------------1378 sample_num
```sql
SELECT DESCRIPTION
FROM procedures
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Jacquelyn' AND last = 'Shanahan')
AND DATE = '2009-08-09';
```
-------------------------1379 sample_num
```sql
SELECT COUNT(*)
FROM claims
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Abbie' AND last = 'Cole')
AND BILLABLEPERIOD BETWEEN '2010-12-31' AND '2012-01-01';
```
-------------------------1380 sample_num
```sql
SELECT COUNT(*) AS allergy_count
FROM allergies a
JOIN patients p ON a.PATIENT = p.patient
WHERE p.first = 'Saundra' AND p.last = 'Monahan';
```
-------------------------1381 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS patient_name
FROM claims c
JOIN patients p ON c.PATIENT = p.patient
WHERE c.BILLABLEPERIOD = '1947-09-11';
```
-------------------------1382 sample_num
```sql
SELECT DESCRIPTION
FROM encounters
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Hubert' AND last = 'Baumbach')
AND DATE = '2008-10-25';
```
-------------------------1383 sample_num
```sql
SELECT DESCRIPTION
FROM conditions
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Keven' AND last = 'Kuhn')
AND START >= '2016-09-24'
AND STOP <= '2016-10-10';
```
-------------------------1384 sample_num
```sql
SELECT DATE
FROM procedures
WHERE DESCRIPTION = 'Standard pregnancy test'
AND PATIENT IN (SELECT patient FROM patients WHERE first = 'Ira' AND last = 'Deckow');
```
-------------------------1385 sample_num
```sql
SELECT AVG(DATEDIFF(STOP, START)) AS average_careplan_period
FROM careplans
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Wesley' AND last = 'Lemke');
```
-------------------------1386 sample_num
```sql
SELECT AVG(DATEDIFF(stop, start)) AS average_pregnancy_period
FROM careplans
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Angelena' AND last = 'Kertzmann')
AND DESCRIPTION = 'Normal pregnancy';
```
-------------------------1387 sample_num
```sql
SELECT PATIENT
FROM allergies
WHERE STOP IS NOT NULL
ORDER BY (CAST(SUBSTR(STOP, -2, 1) AS INTEGER) + 2000 - (CASE WHEN SUBSTR(STOP, -2, 1) = '9' THEN 0 ELSE 1 END)) - (CAST(SUBSTR(START, -2, 1) AS INTEGER) + 1900 - (CASE WHEN SUBSTR(START, -2, 1) = '9' THEN 0 ELSE 1 END))
DESC
LIMIT 1;
```
-------------------------1388 sample_num
```sql
SELECT COUNT(DISTINCT PATIENT) AS patient_count
FROM conditions
WHERE DESCRIPTION = 'Diabetes' AND START LIKE '1988%';
```
-------------------------1389 sample_num
```sql
SELECT COUNT(DISTINCT PATIENT) AS allergic_to_eggs
FROM allergies
WHERE DESCRIPTION = 'Allergy to eggs';
```
-------------------------1390 sample_num
```sql
SELECT PATIENT
FROM conditions
WHERE DESCRIPTION = 'Hypertension'
ORDER BY START DESC
LIMIT 1;
```
-------------------------1391 sample_num
```sql
SELECT DESCRIPTION, COUNT(*) AS allergy_count
FROM allergies
GROUP BY DESCRIPTION
ORDER BY allergy_count DESC
LIMIT 1;
```
-------------------------1392 sample_num
```sql
SELECT PATIENT
FROM observations
WHERE CODE = 'Body Height'
AND VALUE = (SELECT MAX(VALUE) FROM observations WHERE CODE = 'Body Height');
```
-------------------------1393 sample_num
```sql
SELECT DESCRIPTION, COUNT(*) AS condition_count
FROM conditions
JOIN patients ON conditions.PATIENT = patients.patient
WHERE patients.gender = 'F' AND patients.ethnicity = 'american'
GROUP BY DESCRIPTION
ORDER BY condition_count DESC
LIMIT 1;
```
-------------------------1394 sample_num
```sql
SELECT COUNT(DISTINCT PATIENT) AS Dominican_Patients_Stopped
FROM medications
JOIN patients ON medications.PATIENT = patients.patient
WHERE DESCRIPTION = 'Ibuprofen 200 MG Oral Tablet'
  AND START LIKE '2016%'
  AND ethnicity = 'dominican'
  AND (strftime('%m', STOP) - strftime('%m', START)) = 1
  AND (strftime('%Y', STOP) = strftime('%Y', START));
```
-------------------------1395 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS patient_count
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE p.birthdate LIKE '192%' AND c.DESCRIPTION = 'Pneumonia';
```
-------------------------1396 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN medications m ON p.patient = m.PATIENT
WHERE m.DESCRIPTION = 'Yaz 28 Day Pack' AND m.START LIKE '2011%';
```
-------------------------1397 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS black_immunized_count
FROM patients p
JOIN immunizations i ON p.patient = i.patient
WHERE p.race = 'black'
AND i.DESCRIPTION = 'DTaP'
AND i.DATE LIKE '2013%';
```
-------------------------1398 sample_num
```sql
SELECT COUNT(i.CODE) AS immunization_count
FROM immunizations i
JOIN conditions c ON i.PATIENT = c.PATIENT
WHERE c.START = (
    SELECT MAX(START)
    FROM conditions
    WHERE PATIENT = (
        SELECT PATIENT
        FROM conditions
        ORDER BY (SELECT MAX(PREVALENCE_RATE) FROM all_prevalences) DESC
        LIMIT 1
    )
);
```
-------------------------1399 sample_num
```sql
SELECT COUNT(DISTINCT c.PATIENT) AS patient_count
FROM conditions c
JOIN all_prevalences ap ON c.CODE = ap.ITEM
WHERE ap.PREVALENCE_RATE = (SELECT MAX(PREVALENCE_RATE) FROM all_prevalences);
```
-------------------------1400 sample_num
```sql
SELECT DESCRIPTION
FROM conditions
WHERE PATIENT IN (
    SELECT PATIENT
    FROM immunizations
    WHERE DESCRIPTION = 'Influenza seasonal injectable preservative free'
)
GROUP BY DESCRIPTION
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------1401 sample_num
```sql
SELECT DISTINCT c.PATIENT
FROM conditions c
JOIN all_prevalences ap ON c.CODE = ap.ITEM
WHERE ap.PREVALENCE_PERCENTAGE = 18.8;
```
-------------------------1402 sample_num
```sql
SELECT COUNT(*) AS condition_count
FROM conditions
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Tyree' AND last = 'Eichmann');
```
-------------------------1403 sample_num
```sql
SELECT COUNT(DISTINCT i.PATIENT) AS patient_count
FROM immunizations i
JOIN conditions c ON i.PATIENT = c.PATIENT
WHERE i.DESCRIPTION = 'meningococcal MCV4P'
AND c.DESCRIPTION = 'Viral sinusitis (disorder)'
AND i.DATE < c.START;
```
-------------------------1404 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS female_prediabetes_count
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE c.DESCRIPTION = 'Prediabetes' AND p.gender = 'F';
```
-------------------------1405 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN observations o ON p.patient = o.PATIENT
WHERE o.DESCRIPTION = 'Body Mass Index' AND o.UNITS = 'kg/m2'
ORDER BY o.VALUE ASC
LIMIT 1;
```
-------------------------1406 sample_num
```sql
SELECT SUBTRACT(strftime('%Y', COALESCE(deathdate, 'now')), strftime('%Y', birthdate)) AS age
FROM patients
JOIN conditions ON patients.patient = conditions.PATIENT
WHERE patients.first = 'Giovanni' AND patients.last = 'Russel' AND conditions.DESCRIPTION = 'Hypertension';
```
-------------------------1407 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS asian_female_patients_taking_oxaliplatin
FROM patients p
JOIN medications m ON p.patient = m.PATIENT
WHERE p.gender = 'F'
  AND p.race = 'Asian'
  AND m.DESCRIPTION = 'oxaliplatin 5 MG/ML [Eloxatin]';
```
-------------------------1408 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS living_patients_with_stroke
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE p.deathdate IS NULL AND c.DESCRIPTION = 'Stroke';
```
-------------------------1409 sample_num
```sql
SELECT COUNT(*) AS total_asian_allergic_patients
FROM patients p
JOIN allergies a ON p.patient = a.PATIENT
WHERE p.race LIKE 'asian%' AND a.DESCRIPTION = 'Allergy to peanuts';
```
-------------------------1410 sample_num
```sql
SELECT AVG(o.VALUE) AS average_diastolic_blood_pressure
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
JOIN observations o ON p.patient = o.PATIENT
WHERE c.DESCRIPTION = 'Hypertension' AND o.DESCRIPTION = 'Diastolic Blood Pressure';
```
-------------------------1411 sample_num
```sql
SELECT m.DESCRIPTION
FROM medications m
JOIN patients p ON m.PATIENT = p.patient
WHERE p.ssn = '999-94-3751';
```
-------------------------1412 sample_num
```sql
SELECT p.ssn
FROM patients p
JOIN allergies a ON p.patient = a.PATIENT
WHERE p.gender = 'F'
  AND p.ethnicity = 'irish'
  AND a.DESCRIPTION = 'Allergy to grass pollen';
```
-------------------------1413 sample_num
```sql
SELECT PATIENT FROM careplans WHERE CODE = '311791003';
```
-------------------------1414 sample_num
```sql
SELECT c.DESCRIPTION
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE p.deathdate IS NOT NULL
AND (strftime('%Y', p.deathdate) - strftime('%Y', p.birthdate)) = (
    SELECT MAX(strftime('%Y', deathdate) - strftime('%Y', birthdate))
    FROM patients
    WHERE deathdate IS NOT NULL
)
```
-------------------------1415 sample_num
```sql
SELECT CODE
FROM all_prevalences
ORDER BY OCCURRENCES DESC
LIMIT 1;
```
-------------------------1416 sample_num
```sql
SELECT VALUE, UNITS
FROM observations
WHERE DESCRIPTION = 'Glucose'
AND PATIENT IN (
    SELECT patient
    FROM patients
    WHERE address = '365 Della Crossroad Suite 202 Deerfield MA 01342 US'
);
```
-------------------------1417 sample_num
```sql
SELECT DISTINCT p.ssn
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
JOIN all_prevalences ap ON c.CODE = ap.ITEM
WHERE ap.PREVALENCE PERCENTAGE < (0.3 * (SELECT AVG(PREVALENCE PERCENTAGE) FROM all_prevalences))
LIMIT 5;
```
-------------------------1418 sample_num
```sql
SELECT
    (COUNT(p.patient) FILTER (WHERE p.gender = 'F' AND p.race = 'Asian') * 100.0 / COUNT(p.patient)) AS percentage
FROM
    patients p
JOIN
    conditions c ON p.patient = c.PATIENT
WHERE
    c.DESCRIPTION = 'Acute bronchitis (disorder)';
```
-------------------------1419 sample_num
```sql
SELECT COUNT(*) AS encounter_count
FROM encounters
WHERE PATIENT IN (
    SELECT patient
    FROM patients
    WHERE first = 'Major' AND last = 'D\'Amore'
);
```
-------------------------1420 sample_num
```sql
SELECT p.DESCRIPTION
FROM procedures p
JOIN patients pt ON p.PATIENT = pt.patient
WHERE pt.first = 'Emmy' AND pt.last = 'Waelchi';
```
-------------------------1421 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN procedures pr ON p.patient = pr.PATIENT
WHERE pr.DESCRIPTION = 'Extraction of wisdom tooth';
```
-------------------------1422 sample_num
```sql
SELECT VALUE, UNITS
FROM observations
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss')
AND DESCRIPTION = 'Body Weight';
```
-------------------------1423 sample_num
```sql
SELECT DISTINCT p.first, p.last
FROM patients p
JOIN allergies a ON p.patient = a.PATIENT
WHERE a.DESCRIPTION = 'Allergy to soya';
```
-------------------------1424 sample_num
```sql
SELECT COUNT(*)
FROM immunizations
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Keven' AND last = 'Kuhn')
AND DESCRIPTION = 'DTaP';
```
-------------------------1425 sample_num
```sql
SELECT p.first, p.last
FROM medications m
JOIN patients p ON m.PATIENT = p.patient
WHERE m.DESCRIPTION = 'Clopidogrel 75 MG Oral Tablet'
AND (strftime('%Y', m.STOP) - strftime('%Y', m.START)) > 10;
```
-------------------------1426 sample_num
```sql
SELECT p.DESCRIPTION AS Procedure_Description
FROM procedures p
JOIN conditions c ON p.PATIENT = c.PATIENT
WHERE c.DESCRIPTION = 'Third degree burn'

UNION

SELECT m.DESCRIPTION AS Medication_Description
FROM medications m
JOIN conditions c ON m.PATIENT = c.PATIENT
WHERE c.DESCRIPTION = 'Third degree burn';
```
-------------------------1427 sample_num
```sql
SELECT m.DESCRIPTION
FROM medications m
JOIN allergies a ON m.PATIENT = a.PATIENT
WHERE a.DESCRIPTION = 'Allergy to mould' AND a.START <= '2016-06-06' AND (a.STOP IS NULL OR a.STOP >= '2016-06-06');
```
-------------------------1428 sample_num
```sql
SELECT cp.DESCRIPTION
FROM careplans cp
JOIN conditions c ON cp.PATIENT = c.PATIENT
WHERE c.DESCRIPTION = 'Secondary malignant neoplasm of colon';
```
-------------------------1429 sample_num
```sql
SELECT PREVALENCE_RATE
FROM all_prevalences
WHERE ITEM IN (
    SELECT DISTINCT DESCRIPTION
    FROM conditions
    WHERE START = '2014-05-09'
);
```
-------------------------1430 sample_num
```sql
SELECT
    CONCAT(p.first, ' ', p.last) AS name,
    CASE
        WHEN p.deathdate IS NULL THEN strftime('%Y', 'now') - strftime('%Y', p.birthdate)
        ELSE strftime('%Y', p.deathdate) - strftime('%Y', p.birthdate)
    END AS age
FROM
    patients p
JOIN
    observations o ON p.patient = o.PATIENT
WHERE
    o.DESCRIPTION = 'Systolic Blood Pressure'
    AND o.VALUE = 200
    AND o.UNITS = 'mmHg'
    AND o.DATE LIKE '2011%';
```
-------------------------1431 sample_num
```sql
SELECT
    (COUNT(CASE WHEN DESCRIPTION = 'Influenza seasonal injectable preservative free' THEN PATIENT END) * 100.0 / COUNT(PATIENT)) AS percentage,
    COUNT(CASE WHEN DESCRIPTION = 'Influenza seasonal injectable preservative free' AND PATIENT IN (SELECT patient FROM patients WHERE ethnicity = 'english') THEN PATIENT END) AS english_patients
FROM
    immunizations
WHERE
    strftime('%Y', DATE) = '2017';
```
-------------------------1432 sample_num
```sql
SELECT DISTINCT p.first
FROM patients p
JOIN encounters e ON p.patient = e.PATIENT
WHERE e.REASONDESCRIPTION = 'Normal pregnancy';
```
-------------------------1433 sample_num
```sql
SELECT p.birthdate
FROM patients p
JOIN careplans c ON p.patient = c.PATIENT
WHERE c.DESCRIPTION = 'Outpatient Encounter';
```
-------------------------1434 sample_num
```sql
SELECT DISTINCT p.first
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE c.DESCRIPTION = 'Cystitis';
```
-------------------------1435 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS stroke_married_count
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE c.DESCRIPTION = 'Stroke' AND p.marital = 'M';
```
-------------------------1436 sample_num
```sql
SELECT DISTINCT p.address
FROM patients p
JOIN claims c ON p.patient = c.PATIENT
WHERE c.BILLABLEPERIOD LIKE '2010%';
```
-------------------------1437 sample_num
```sql
SELECT DISTINCT p.last
FROM patients p
JOIN allergies a ON p.patient = a.PATIENT
WHERE a.DESCRIPTION = 'Allergy to dairy product';
```
-------------------------1438 sample_num
```sql
SELECT START
FROM allergies
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Angelo' AND last = 'Buckridge');
```
-------------------------1439 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS male_allergic_patients
FROM patients p
JOIN allergies a ON p.patient = a.patient
WHERE p.gender = 'M' AND a.description = 'House dust mite allergy';
```
-------------------------1440 sample_num
```sql
SELECT DESCRIPTION, COUNT(*) AS allergy_count
FROM allergies a
JOIN patients p ON a.PATIENT = p.patient
WHERE p.race = 'white'
GROUP BY DESCRIPTION
ORDER BY allergy_count DESC
LIMIT 1;
```
-------------------------1441 sample_num
```sql
SELECT DISTINCT p.first
FROM patients p
JOIN immunizations i ON p.patient = i.PATIENT
WHERE i.DESCRIPTION = 'Influenza seasonal injectable preservative free';
```
-------------------------1442 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS female_patients
FROM patients p
JOIN immunizations i ON p.patient = i.patient
WHERE p.gender = 'F' AND i.description = 'HPV quadrivalent';
```
-------------------------1443 sample_num
```sql
SELECT e.DESCRIPTION
FROM encounters e
JOIN patients p ON e.PATIENT = p.patient
WHERE p.birthplace = 'Pittsfield MA US';
```
-------------------------1444 sample_num
```sql
SELECT COUNT(DISTINCT DESCRIPTION)
FROM allergies
WHERE PATIENT IN (SELECT patient FROM patients WHERE ethnicity = 'german');
```
-------------------------1445 sample_num
```sql
SELECT AVG(YEAR(CURDATE()) - YEAR(birthdate)) AS average_age
FROM patients
WHERE patient IN (
    SELECT PATIENT
    FROM careplans
    WHERE REASONDESCRIPTION = 'Prediabetes'
);
```
-------------------------1446 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS alive_patients
FROM patients p
JOIN medications m ON p.patient = m.PATIENT
WHERE m.REASONDESCRIPTION = 'Coronary Heart Disease' AND m.STOP IS NOT NULL AND p.deathdate IS NULL;
```
-------------------------1447 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS patient_count
FROM patients p
JOIN procedures pr ON p.patient = pr.PATIENT
WHERE pr.DESCRIPTION = 'Bone immobilization' AND p.drivers IS NOT NULL;
```
-------------------------1448 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN allergies a ON p.patient = a.PATIENT
GROUP BY p.patient
HAVING COUNT(DISTINCT a.DESCRIPTION) >= 3;
```
-------------------------1449 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS patient_count
FROM patients p
JOIN allergies a ON p.patient = a.PATIENT
JOIN immunizations i ON p.patient = i.PATIENT
WHERE a.DESCRIPTION = 'Allergy to eggs' 
  AND i.DESCRIPTION = 'Td (adult) preservative free';
```
-------------------------1450 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS patient_count
FROM patients p
JOIN observations o ON p.patient = o.PATIENT
JOIN careplans c ON p.patient = c.PATIENT
WHERE o.DESCRIPTION = 'Body Weight' 
  AND o.VALUE > 100 
  AND o.UNITS = 'kg'
  AND c.DESCRIPTION = 'Diabetes self management plan';
```
-------------------------1451 sample_num
```sql
SELECT gender, COUNT(*) AS allergy_count
FROM patients
JOIN allergies ON patients.patient = allergies.PATIENT
WHERE allergies.DESCRIPTION = 'Dander (animal) allergy'
GROUP BY gender
ORDER BY allergy_count DESC
LIMIT 1;
```
-------------------------1452 sample_num
```sql
SELECT DISTINCT BILLABLEPERIOD
FROM claims
JOIN patients ON claims.PATIENT = patients.patient
WHERE patients.last = 'Dickinson';
```
-------------------------1453 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE c.DESCRIPTION = 'Otitis media';
```
-------------------------1454 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS patient_count
FROM patients p
JOIN medications m ON p.patient = m.PATIENT
WHERE p.ethnicity = 'Irish' AND m.REASONDESCRIPTION = 'Myocardial Infarction';
```
-------------------------1455 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS married_patients_with_careplan
FROM patients p
JOIN careplans c ON p.patient = c.PATIENT
WHERE c.DESCRIPTION = 'Concussion with loss of consciousness' AND p.marital = 'M';
```
-------------------------1456 sample_num
```sql
SELECT COUNT(DISTINCT cp.PATIENT) AS patient_count
FROM careplans cp
JOIN immunizations im ON cp.PATIENT = im.PATIENT
WHERE im.DESCRIPTION = 'rotavirus monovalent' AND cp.STOP = '2013-11-23';
```
-------------------------1457 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS women_needing_nitroglycerin
FROM patients p
JOIN medications m ON p.patient = m.PATIENT
WHERE p.gender = 'F' AND m.DESCRIPTION = 'Nitroglycerin 0.4 MG/ACTUAT [Nitrolingual]';
```
-------------------------1458 sample_num
```sql
SELECT 
    (COUNT(DISTINCT p.patient) FILTER (WHERE a.DESCRIPTION = 'Allergy to grass pollen') * 100.0 / COUNT(DISTINCT p.patient)) AS percentage
FROM 
    patients p
LEFT JOIN 
    allergies a ON p.patient = a.PATIENT
WHERE 
    p.birthplace = 'Pembroke MA US';
```
-------------------------1459 sample_num
```sql
SELECT AVG(observations.VALUE) AS average_body_weight
FROM observations
JOIN patients ON observations.PATIENT = patients.patient
WHERE observations.DESCRIPTION = 'Body Weight' 
  AND observations.UNITS = 'kg' 
  AND patients.race = 'asian';
```
-------------------------1460 sample_num
```sql
SELECT DISTINCT patients.ssn
FROM patients
JOIN allergies ON patients.patient = allergies.PATIENT
WHERE allergies.DESCRIPTION = 'Latex allergy';
```
-------------------------1461 sample_num
```sql
SELECT 
    SUBTRACT(allergies.STOP, allergies.START) AS allergy_duration, 
    allergies.DESCRIPTION AS allergy_type 
FROM 
    allergies 
JOIN 
    patients ON allergies.PATIENT = patients.patient 
WHERE 
    patients.first = 'Isadora' AND patients.last = 'Moen';
```
-------------------------1462 sample_num
```sql
SELECT COUNT(*) 
FROM careplans 
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss') 
AND START BETWEEN '2009-01-11' AND '2010-10-23';
```
-------------------------1463 sample_num
```sql
SELECT DISTINCT p.patient, p.first, p.last
FROM patients p
JOIN careplans c ON p.patient = c.PATIENT
WHERE YEAR(c.START) = 2009
  AND p.marital = 'M'
  AND DATEDIFF(c.STOP, c.START) > 60;
```
-------------------------1464 sample_num
```sql
SELECT DATE 
FROM immunizations 
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Elly' AND last = 'Koss') 
AND DESCRIPTION = 'Influenza seasonal injectable preservative free';
```
-------------------------1465 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS black_immunized_count
FROM patients p
JOIN immunizations i ON p.patient = i.PATIENT
WHERE p.race = 'black'
  AND i.DESCRIPTION = 'meningococcal MCV4P'
  AND i.DATE BETWEEN '2010-07-09' AND '2013-10-29';
```
-------------------------1466 sample_num
```sql
SELECT immunizations.CODE, immunizations.DATE
FROM immunizations
JOIN patients ON immunizations.PATIENT = patients.patient
WHERE patients.first = 'Jacquelyn' AND patients.last = 'Shanahan'
AND immunizations.DESCRIPTION = 'Influenza seasonal injectable preservative free'
AND YEAR(immunizations.DATE) IN (YEAR(CURDATE()) - 3, YEAR(CURDATE()) - 2, YEAR(CURDATE()) - 1, YEAR(CURDATE()));
```
-------------------------1467 sample_num
```sql
SELECT 
    SUBTRACT(medications.STOP, medications.START) AS duration
FROM 
    medications
JOIN 
    patients ON medications.PATIENT = patients.patient
WHERE 
    patients.first = 'Berry' AND 
    patients.last = 'Keebler' AND 
    medications.DESCRIPTION = 'Acetaminophen 160 MG' AND 
    medications.REASONDESCRIPTION = 'Acute bronchitis (disorder)';
```
-------------------------1468 sample_num
```sql
SELECT COUNT(DISTINCT PATIENT) AS single_patients
FROM medications
WHERE substr(START, 1, 4) = '2010' 
  AND substr(STOP, 1, 4) = '2010' 
  AND DESCRIPTION = 'Nitrofurantoin 5 MG/ML [Furadantin]' 
  AND REASONDESCRIPTION = 'Cystitis';
```
-------------------------1469 sample_num
```sql
SELECT REASONDESCRIPTION 
FROM encounters 
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Lavelle' AND last = 'Vandervort') 
AND DATE = '2013-11-20';
```
-------------------------1470 sample_num
```sql
SELECT COUNT(DISTINCT encounters.PATIENT) AS german_outpatient_patients
FROM encounters
JOIN patients ON encounters.PATIENT = patients.patient
WHERE encounters.DATE BETWEEN '2011-09-01' AND '2012-08-29'
AND patients.ethnicity = 'german'
AND encounters.DESCRIPTION = 'Outpatient Encounter';
```
-------------------------1471 sample_num
```sql
SELECT patients.ssn, patients.address
FROM patients
JOIN encounters ON patients.patient = encounters.PATIENT
WHERE encounters.REASONDESCRIPTION = 'Viral sinusitis (disorder)' 
AND encounters.DATE = '2008-06-13';
```
-------------------------1472 sample_num
```sql
SELECT 
    m.REASONDESCRIPTION AS reason, 
    m.DESCRIPTION AS drug_name, 
    (julianday(m.STOP) - julianday(m.START)) AS duration,
    CASE 
        WHEN p.deathdate IS NULL THEN 'Alive' 
        ELSE 'Not Alive' 
    END AS patient_status
FROM 
    medications m
JOIN 
    encounters e ON m.ENCOUNTER = e.ID
JOIN 
    patients p ON e.PATIENT = p.patient
WHERE 
    e.ID = '23c293ec-dbae-4a22-896e-f12cf3c8bac3';
```
-------------------------1473 sample_num
```sql
SELECT CONCAT(patients.first, ' ', patients.last) AS full_name
FROM patients
JOIN allergies ON patients.patient = allergies.PATIENT
WHERE allergies.DESCRIPTION = 'Shellfish allergy'
AND (julianday(patients.deathdate) - julianday(patients.birthdate)) / 365 < 12;
```
-------------------------1474 sample_num
```sql
SELECT 
    julianday(medications.STOP) - julianday(medications.START) AS duration
FROM 
    medications
JOIN 
    patients ON medications.PATIENT = patients.patient
WHERE 
    patients.first = 'Major' AND 
    patients.last = 'D\'Amore' AND 
    medications.DESCRIPTION = 'Amoxicillin 250 MG / Clavulanate 125 MG [Augmentin]';
```
-------------------------1475 sample_num
```sql
SELECT COUNT(DISTINCT m.DESCRIPTION) AS medication_types
FROM medications m
JOIN patients p ON m.PATIENT = p.patient
WHERE p.first = 'Major' AND p.last = 'D\'Amore' AND m.START >= (SELECT MIN(e.DATE) FROM encounters e WHERE e.PATIENT = p.patient);
```
-------------------------1476 sample_num
```sql
SELECT DESCRIPTION, VALUE, UNITS
FROM observations
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Bella' AND last = 'Rolfson');
```
-------------------------1477 sample_num
```sql
SELECT DISTINCT p.first, p.last
FROM patients p
JOIN observations o ON p.patient = o.PATIENT
WHERE o.DESCRIPTION = 'Calcium' AND o.VALUE < 8.6;
```
-------------------------1478 sample_num
```sql
SELECT c.DESCRIPTION, COUNT(c.DESCRIPTION) AS condition_count
FROM conditions c
JOIN observations o ON c.PATIENT = o.PATIENT
WHERE o.DESCRIPTION = 'Body Mass Index' AND o.VALUE < 18.5
GROUP BY c.DESCRIPTION
ORDER BY condition_count DESC
LIMIT 5;
```
-------------------------1479 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS mother_count
FROM patients p
JOIN encounters e ON p.patient = e.patient
JOIN immunizations i ON e.id = i.encounter
WHERE e.reasondescription = 'Normal pregnancy';
```
-------------------------1480 sample_num
```sql
SELECT *
FROM careplans
WHERE PATIENT IN (
    SELECT patient
    FROM patients
    WHERE first = 'Elly' AND last = 'Koss'
)
AND substr(START, 1, 4) = '1970'
AND substr(STOP, 1, 4) = '1970';
```
-------------------------1481 sample_num
```sql
SELECT 
    CONCAT(p.first, ' ', p.last) AS full_name,
    cp.DESCRIPTION AS care_plan,
    pr.DESCRIPTION AS procedure,
    m.DESCRIPTION AS medication
FROM 
    patients p
JOIN 
    encounters e ON p.patient = e.PATIENT
LEFT JOIN 
    careplans cp ON e.ID = cp.ENCOUNTER
LEFT JOIN 
    procedures pr ON e.ID = pr.ENCOUNTER
LEFT JOIN 
    medications m ON e.ID = m.ENCOUNTER
WHERE 
    e.ID = '6f2e3935-b203-493e-a9c0-f23e847b9798';
```
-------------------------1482 sample_num
```sql
SELECT 
    SUM(CASE WHEN p.gender = 'M' THEN 1 ELSE 0 END) AS male_hypertension_count,
    SUM(CASE WHEN p.gender = 'F' THEN 1 ELSE 0 END) AS female_hypertension_count
FROM 
    patients p
JOIN 
    conditions c ON p.patient = c.PATIENT
WHERE 
    c.DESCRIPTION = 'Hypertension';
```
-------------------------1483 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS unmarried_women_checked_for_normal_pregnancy
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE p.marital = 'S' 
  AND p.gender = 'F' 
  AND c.DESCRIPTION = 'normal pregnancy';
```
-------------------------1484 sample_num
```sql
SELECT 
    procedures.DESCRIPTION AS Procedure_Description, 
    medications.DESCRIPTION AS Medication_Description
FROM 
    encounters
JOIN 
    procedures ON encounters.ID = procedures.ENCOUNTER
JOIN 
    medications ON encounters.ID = medications.ENCOUNTER
WHERE 
    encounters.REASONDESCRIPTION = 'Drug overdose';
```
-------------------------1485 sample_num
```sql
SELECT AVG(observations.VALUE) AS average_bmi
FROM observations
WHERE observations.DESCRIPTION = 'Body Mass Index'
AND observations.PATIENT IN (
    SELECT DISTINCT observations.PATIENT
    FROM observations
    WHERE observations.DESCRIPTION = 'Total Cholesterol'
    AND observations.VALUE >= 200
);
```
-------------------------1486 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.birthdate BETWEEN DATEADD(YEAR, -29, GETDATE()) AND DATEADD(YEAR, -20, GETDATE()) THEN o.VALUE ELSE 0 END) / 
    NULLIF(COUNT(CASE WHEN p.birthdate BETWEEN DATEADD(YEAR, -29, GETDATE()) AND DATEADD(YEAR, -20, GETDATE()) THEN o.PATIENT END), 0)) -
    
    (SUM(CASE WHEN p.birthdate BETWEEN DATEADD(YEAR, -59, GETDATE()) AND DATEADD(YEAR, -50, GETDATE()) THEN o.VALUE ELSE 0 END) / 
    NULLIF(COUNT(CASE WHEN p.birthdate BETWEEN DATEADD(YEAR, -59, GETDATE()) AND DATEADD(YEAR, -50, GETDATE()) THEN o.PATIENT END), 0))
) AS glucose_difference
FROM patients p
JOIN observations o ON p.patient = o.PATIENT;
```
-------------------------1487 sample_num
```sql
SELECT 
    (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM patients WHERE (YEAR(conditions.START) - YEAR(patients.birthdate)) >= 60)) AS percentage
FROM 
    conditions
JOIN 
    patients ON conditions.PATIENT = patients.patient
WHERE 
    (YEAR(conditions.START) - YEAR(patients.birthdate)) >= 60
GROUP BY 
    conditions.DESCRIPTION
ORDER BY 
    COUNT(*) DESC
LIMIT 1;
```
-------------------------1488 sample_num
```sql
SELECT encounters.REASONDESCRIPTION 
FROM encounters 
JOIN patients ON encounters.PATIENT = patients.patient 
WHERE patients.first = 'Walter' AND patients.last = 'Bahringer' 
AND substr(encounters.DATE, 1, 7) = '2009-07';
```
-------------------------1489 sample_num
```sql
SELECT 
    EXTRACT(YEAR FROM MIN(encounters.DATE) - patients.birthdate) AS age
FROM 
    patients
JOIN 
    encounters ON patients.patient = encounters.PATIENT
WHERE 
    patients.first = 'Stacy' AND 
    patients.last = 'Morar' AND 
    encounters.REASONDESCRIPTION = 'Drug overdose';
```
-------------------------1490 sample_num
```sql
SELECT DESCRIPTION, COUNT(*) AS ADMINISTRATION_COUNT
FROM medications
WHERE REASONDESCRIPTION = 'Child attention deficit disorder'
GROUP BY DESCRIPTION
ORDER BY ADMINISTRATION_COUNT DESC
LIMIT 1;
```
-------------------------1491 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN procedures pr ON p.patient = pr.PATIENT
WHERE pr.DESCRIPTION = 'Transplant of lung (procedure)';
```
-------------------------1492 sample_num
```sql
SELECT AVG(patient_count) AS average_patients
FROM (
    SELECT COUNT(DISTINCT procedures.PATIENT) AS patient_count, 
           COUNT(DISTINCT SUBSTR(procedures.DATE, 1, 4)) AS year_count
    FROM procedures
    WHERE procedures.DESCRIPTION = 'Combined chemotherapy and radiation therapy (procedure)'
    GROUP BY SUBSTR(procedures.DATE, 1, 4)
) AS yearly_counts;
```
-------------------------1493 sample_num
```sql
SELECT 
    careplans.START, 
    careplans.STOP, 
    careplans.DESCRIPTION, 
    JULIANDAY(careplans.STOP) - JULIANDAY(careplans.START) AS time_frame
FROM 
    careplans
JOIN 
    patients ON careplans.PATIENT = patients.patient
WHERE 
    patients.first = 'Jacquelyn' AND 
    patients.last = 'Shanahan'
ORDER BY 
    careplans.START DESC
LIMIT 1;
```
-------------------------1494 sample_num
```sql
SELECT 
    allergies.START, 
    allergies.STOP, 
    allergies.DESCRIPTION 
FROM 
    allergies 
JOIN 
    patients ON allergies.PATIENT = patients.patient 
WHERE 
    patients.first = 'Isadora' AND 
    patients.last = 'Moen';
```
-------------------------1495 sample_num
```sql
SELECT 
    EXTRACT(YEAR FROM AGE(MIN(encounters.DATE), patients.birthdate)) AS age
FROM 
    patients
JOIN 
    encounters ON patients.patient = encounters.PATIENT
WHERE 
    patients.first = 'Laronda' AND patients.last = 'Bernier'
GROUP BY 
    patients.birthdate;
```
-------------------------1496 sample_num
```sql
SELECT conditions.DESCRIPTION
FROM patients
JOIN encounters ON patients.patient = encounters.PATIENT
JOIN conditions ON encounters.ID = conditions.ENCOUNTER
WHERE patients.first = 'Joye' AND patients.last = 'Homenick' 
AND substr(conditions.START, 1, 4) = '2017';
```
-------------------------1497 sample_num
```sql
SELECT MAX(immunizations.DATE) AS Most_Recent_Vaccine_Date
FROM immunizations
JOIN patients ON immunizations.PATIENT = patients.patient
WHERE patients.first = 'Joye' AND patients.last = 'Homenick' 
AND immunizations.DESCRIPTION = 'Influenza seasonal injectable preservative free';
```
-------------------------1498 sample_num
```sql
SELECT 
    SUM(julianday(medications.stop) - julianday(medications.START)) AS duration
FROM 
    medications
JOIN 
    patients ON medications.PATIENT = patients.patient
WHERE 
    patients.first = 'Elly' AND 
    patients.last = 'Koss' AND 
    medications.DESCRIPTION = 'Acetaminophen 160 MG';
```
-------------------------1499 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS patient_count, cp.DESCRIPTION AS care_plan
FROM encounters e
JOIN patients p ON e.PATIENT = p.patient
JOIN careplans cp ON e.ID = cp.ENCOUNTER
WHERE e.REASONDESCRIPTION = 'Second degree burn'
GROUP BY cp.DESCRIPTION;
```
-------------------------1500 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN patients.gender = 'F' THEN 1 END) * 1.0 / COUNT(encounters.PATIENT)) * 100 AS female_percentage
FROM 
    encounters
JOIN 
    patients ON encounters.PATIENT = patients.patient
WHERE 
    substr(encounters.DATE, 1, 4) = '2010' 
    AND encounters.REASONDESCRIPTION = 'Contact dermatitis';
```
-------------------------1501 sample_num
```sql
SELECT 
    COUNT(encounters.ID) AS total_interactions,
    (COUNT(CASE WHEN encounters.DESCRIPTION = 'Prenatal visit' THEN 1 END) * 100.0 / COUNT(encounters.ID)) AS prenatal_visit_percentage
FROM 
    encounters
JOIN 
    patients ON encounters.PATIENT = patients.patient
WHERE 
    patients.first = 'Lorri' AND 
    patients.last = 'Simons' AND 
    SUBSTR(encounters.DATE, 1, 4) BETWEEN '2010' AND '2017';
```
-------------------------1502 sample_num
```sql
SELECT medications.DESCRIPTION 
FROM medications 
JOIN patients ON medications.PATIENT = patients.patient 
WHERE patients.first = 'Joe' AND patients.last = 'Homenick';
```
-------------------------1503 sample_num
```sql
SELECT careplans.START 
FROM careplans 
JOIN patients ON careplans.PATIENT = patients.patient 
WHERE patients.maiden = 'Adams';
```
-------------------------1504 sample_num
```sql
SELECT MIN(careplans.START) AS Earliest_Careplan_Start
FROM patients
JOIN careplans ON patients.patient = careplans.PATIENT
WHERE patients.gender = 'M';
```
-------------------------1505 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.ethnicity = 'hispanic' AND SUBSTR(cp.STOP, 1, 4) = '2011' THEN 1 END) * 100.0) / 
    COUNT(CASE WHEN c.ethnicity = 'hispanic' THEN 1 END) AS percentage_hispanic_stopped_careplan_2011
FROM 
    careplans cp
JOIN 
    patients c ON cp.PATIENT = c.patient;
```
-------------------------1506 sample_num
```sql
SELECT REASONDESCRIPTION 
FROM careplans 
WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Angelo' AND last = 'Buckridge');
```
-------------------------1507 sample_num
```sql
SELECT careplans.DESCRIPTION 
FROM careplans 
JOIN patients ON careplans.PATIENT = patients.patient 
WHERE patients.ethnicity = 'american';
```
-------------------------1508 sample_num
```sql
SELECT encounters.ID 
FROM encounters 
JOIN patients ON encounters.PATIENT = patients.patient 
WHERE patients.birthplace = 'Pembroke MA US';
```
-------------------------1509 sample_num
```sql
SELECT careplans.START
FROM careplans
JOIN patients ON careplans.PATIENT = patients.patient
WHERE patients.deathdate IS NULL;
```
-------------------------1510 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS white_patient_count
FROM patients p
JOIN careplans c ON p.patient = c.PATIENT
WHERE p.race = 'white' AND c.REASONCODE = '10509002';
```
-------------------------1511 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN careplans c ON p.patient = c.PATIENT
WHERE c.DESCRIPTION = 'Diabetic diet';
```
-------------------------1512 sample_num
```sql
SELECT careplans.STOP
FROM careplans
JOIN patients ON careplans.PATIENT = patients.patient
WHERE patients.deathdate IS NOT NULL;
```
-------------------------1513 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS italian_patient_count
FROM patients p
JOIN careplans c ON p.patient = c.PATIENT
WHERE p.ethnicity = 'italian' AND c.CODE = '304510005';
```
-------------------------1514 sample_num
```sql
SELECT 
    (COUNT(patients.patient) * 100.0 / NULLIF(COUNT(careplans.ID), 0)) AS percentage
FROM 
    patients
JOIN 
    careplans ON patients.patient = careplans.PATIENT
WHERE 
    patients.gender = 'F' AND 
    substr(careplans.START, 1, 4) = '2010';
```
-------------------------1515 sample_num
```sql
SELECT COUNT(DISTINCT cp.PATIENT) AS black_patients_stopped_careplan
FROM careplans cp
JOIN patients p ON cp.PATIENT = p.patient
WHERE p.race = 'black' AND SUBSTR(cp.STOP, 1, 4) = '2017';
```
-------------------------1516 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS male_prediabetes_count
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE p.gender = 'M' AND c.DESCRIPTION = 'Prediabetes';
```
-------------------------1517 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN allergies a ON p.patient = a.PATIENT
WHERE a.DESCRIPTION = 'Allergy to nut';
```
-------------------------1518 sample_num
```sql
SELECT c.START, c.STOP, c.CODE, c.DESCRIPTION
FROM conditions c
JOIN patients p ON c.PATIENT = p.patient
WHERE p.first = 'Wilmer' AND p.last = 'Koepp';
```
-------------------------1519 sample_num
```sql
SELECT gender, COUNT(gender) AS count
FROM patients
JOIN conditions ON patients.patient = conditions.PATIENT
WHERE conditions.DESCRIPTION = 'Viral sinusitis (disorder)'
GROUP BY gender
ORDER BY count DESC
LIMIT 1;
```
-------------------------1520 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN medications m ON p.patient = m.PATIENT
WHERE m.DESCRIPTION = 'Penicillin V Potassium 250 MG' 
AND SUBSTR(m.START, 1, 4) >= '1948';
```
-------------------------1521 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS white_patients_with_stroke
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE p.race = 'white' 
  AND SUBSTR(p.birthdate, 1, 4) = '1935' 
  AND c.DESCRIPTION = 'Stroke';
```
-------------------------1522 sample_num
```sql
SELECT c.DESCRIPTION
FROM conditions c
JOIN immunizations i ON c.PATIENT = i.PATIENT AND c.ENCOUNTER = i.ENCOUNTER
WHERE i.DESCRIPTION = 'IPV';
```
-------------------------1523 sample_num
```sql
SELECT DISTINCT e.PATIENT
FROM encounters e
JOIN all_prevalences a ON e.CODE = a.ITEM
WHERE a.OCCURRENCES = (SELECT MAX(OCCURRENCES) FROM all_prevalences);
```
-------------------------1524 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE c.DESCRIPTION = 'Cystitis';
```
-------------------------1525 sample_num
```sql
SELECT COUNT(DISTINCT p.patient) AS male_patients_immune_to_hpv
FROM patients p
JOIN immunizations i ON p.patient = i.PATIENT
WHERE p.gender = 'M' AND i.DESCRIPTION = 'HPV quadrivalent';
```
-------------------------1526 sample_num
```sql
SELECT START FROM careplans WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Walter' AND last = 'Bahringer');
```
-------------------------1527 sample_num
```sql
SELECT * FROM careplans WHERE PATIENT = (SELECT patient FROM patients WHERE first = 'Major' AND last = 'D\'Amore');
```
-------------------------1528 sample_num
```sql
SELECT 
    (COUNT(patients.patient) * 100.0 / NULLIF((SELECT COUNT(*) FROM patients), 0)) AS percentage
FROM 
    patients
JOIN 
    conditions ON patients.patient = conditions.PATIENT
WHERE 
    patients.gender = 'M' AND conditions.DESCRIPTION = 'Viral sinusitis (disorder)';
```
-------------------------1529 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.gender = 'F' THEN 1 END) * 100.0 / COUNT(*)) AS female_percentage
FROM 
    patients p
JOIN 
    medications m ON p.patient = m.PATIENT
WHERE 
    m.DESCRIPTION = 'Penicillin V Potassium 250 MG';
```
-------------------------1530 sample_num
```sql
SELECT AVG(observations.VALUE) AS average_body_height
FROM patients
JOIN observations ON patients.patient = observations.PATIENT
WHERE patients.race = 'white' AND observations.DESCRIPTION = 'Body Height';
```
-------------------------1531 sample_num
```sql
SELECT * 
FROM careplans 
WHERE PATIENT IN (
    SELECT patient 
    FROM patients 
    WHERE address = '179 Sydni Roads Taunton MA 02780 US'
);
```
-------------------------1532 sample_num
```sql
SELECT a.DESCRIPTION 
FROM allergies a 
JOIN patients p ON a.PATIENT = p.patient 
WHERE p.first = 'Dirk' AND p.last = 'Languish' AND p.ethnicity = 'Dominican';
```
-------------------------1533 sample_num
```sql
SELECT COUNT(DISTINCT a.PATIENT) AS patient_count
FROM allergies a
JOIN conditions c ON a.PATIENT = c.PATIENT
WHERE a.DESCRIPTION = 'Allergy to peanuts' AND c.DESCRIPTION = 'Asthma';
```
-------------------------1534 sample_num
```sql
SELECT p.*
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE c.DESCRIPTION LIKE '%drug overdose%'
AND CAST((julianday(c.START) - julianday(p.birthdate)) / 365 AS INTEGER) = 44;
```
-------------------------1535 sample_num
```sql
SELECT p.ssn
FROM patients p
JOIN observations o ON p.patient = o.PATIENT
WHERE o.DESCRIPTION = 'Systolic Blood Pressure'
AND o.VALUE = (SELECT MAX(VALUE) FROM observations WHERE DESCRIPTION = 'Systolic Blood Pressure');
```
-------------------------1536 sample_num
```sql
SELECT cp.DESCRIPTION
FROM careplans cp
JOIN all_prevalences ap ON cp.CODE = ap.ITEM
WHERE ap.PREVALENCE_PERCENTAGE = (SELECT MAX(PREVALENCE_PERCENTAGE) FROM all_prevalences);
```
-------------------------1537 sample_num
```sql
SELECT * 
FROM careplans 
WHERE PATIENT IN (SELECT patient FROM patients WHERE ssn = '999-15-3685');
```
-------------------------1538 sample_num
```sql
SELECT AVG((julianday(COALESCE(patients.deathdate, datetime('now'))) - julianday(patients.birthdate)) / 365) AS average_age
FROM patients
JOIN conditions ON patients.patient = conditions.PATIENT
WHERE patients.gender = 'M' AND conditions.DESCRIPTION = 'Hypertension';
```
-------------------------1539 sample_num
```sql
SELECT DISTINCT p.first, p.last
FROM patients p
JOIN medications m ON p.patient = m.PATIENT
WHERE m.REASONDESCRIPTION = 'Streptococcal sore throat (disorder)'
LIMIT 5;
```
-------------------------1540 sample_num
```sql
SELECT DISTINCT p.*
FROM patients p
JOIN observations o ON p.patient = o.PATIENT
WHERE o.DESCRIPTION = 'Body Weight' AND o.VALUE = 61.97 AND o.UNITS = 'kg';
```
-------------------------1541 sample_num
```sql
SELECT DISTINCT p.birthdate
FROM patients p
JOIN medications m ON p.patient = m.PATIENT
WHERE p.gender = 'M' AND m.DESCRIPTION = 'Penicillin V Potassium 250 MG'
LIMIT 5;
```
-------------------------1542 sample_num
```sql
SELECT CONCAT(p.first, ' ', p.last) AS full_name
FROM patients p
JOIN conditions c ON p.patient = c.PATIENT
WHERE p.ethnicity = 'irish'
AND c.CODE IN (
    SELECT CODE
    FROM all_prevalences
    WHERE OCCURRENCES > (SELECT AVG(OCCURRENCES) * 0.96 FROM all_prevalences)
);
```
-------------------------1543 sample_num
```sql
SELECT 
    (SELECT COUNT(patients.patient) 
     FROM patients 
     JOIN conditions ON patients.patient = conditions.PATIENT 
     WHERE patients.marital = 'M' AND conditions.DESCRIPTION = 'Diabetes') -
    (SELECT COUNT(patients.patient) 
     FROM patients 
     JOIN conditions ON patients.patient = conditions.PATIENT 
     WHERE patients.marital = 'S' AND conditions.DESCRIPTION = 'Diabetes') AS difference;
```
-------------------------1544 sample_num
```sql
SELECT country, COUNT(*) AS customerCount
FROM customers
GROUP BY country;
```
-------------------------1545 sample_num
```sql
SELECT p.productVendor, 
       SUM(od.quantityOrdered) AS totalOrders, 
       SUM((p.MSRP - p.buyPrice) * od.quantityOrdered) AS totalEstimatedEarnings
FROM orderdetails od
JOIN products p ON od.productCode = p.productCode
GROUP BY p.productVendor
ORDER BY totalOrders DESC
LIMIT 1;
```
-------------------------1546 sample_num
```sql
SELECT c.salesRepEmployeeNumber
FROM customers c
JOIN payments p ON c.customerNumber = p.customerNumber
WHERE YEAR(p.paymentDate) = 2004
GROUP BY c.customerNumber
ORDER BY SUM(p.amount) DESC
LIMIT 1;
```
-------------------------1547 sample_num
```sql
SELECT SUM(od.quantityOrdered * od.priceEach) AS totalPrice
FROM orders o
JOIN customers c ON o.customerNumber = c.customerNumber
JOIN orderdetails od ON o.orderNumber = od.orderNumber
WHERE c.customerName = 'Rovelli Gifts Distributors Ltd.'
AND o.shippedDate BETWEEN '2003-01-01' AND '2003-12-31';
```
-------------------------1548 sample_num
```sql
SELECT COUNT(*) 
FROM employees 
WHERE officeCode IN (SELECT officeCode FROM offices WHERE city = 'Sydney');
```
-------------------------1549 sample_num
```sql
SELECT employeeNumber 
FROM employees 
WHERE officeCode IN (SELECT officeCode FROM offices WHERE city = 'New York') 
AND reportsTo = 1143;
```
-------------------------1550 sample_num
```sql
SELECT 
    AVG(total_amount) AS average_annual_payment,
    MAX(total_amount) AS highest_annual_payment,
    MIN(total_amount) AS lowest_annual_payment
FROM (
    SELECT 
        YEAR(paymentDate) AS payment_year,
        SUM(amount) AS total_amount
    FROM payments
    WHERE paymentDate BETWEEN '2003-01-01' AND '2005-12-31'
    GROUP BY payment_year
) AS annual_payments;
```
-------------------------1551 sample_num
```sql
SELECT DISTINCT c.country, 
       CONCAT(c.addressLine1, ' ', c.addressLine2) AS fullAddress
FROM payments p
JOIN customers c ON p.customerNumber = c.customerNumber
WHERE p.amount IN (
    SELECT DISTINCT amount
    FROM payments
    ORDER BY amount DESC
    LIMIT 5
);
```
-------------------------1552 sample_num
```sql
SELECT COUNT(*) AS checksIssued
FROM payments p
JOIN customers c ON p.customerNumber = c.customerNumber
WHERE c.customerName = 'Euro+ Shopping Channel' AND YEAR(p.paymentDate) = 2004;
```
-------------------------1553 sample_num
```sql
SELECT p.productName, SUM(od.quantityOrdered) AS totalOrdered
FROM products p
JOIN orderdetails od ON p.productCode = od.productCode
WHERE p.productLine = 'Classic Cars' AND p.productScale = '1:18'
GROUP BY p.productName
ORDER BY totalOrdered DESC
LIMIT 1;
```
-------------------------1554 sample_num
```sql
SELECT COUNT(*) AS customerCount
FROM customers
WHERE creditLimit <= 100000;

SELECT customerNumber, SUM(amount) AS totalPayment
FROM payments
WHERE YEAR(paymentDate) = 2004
GROUP BY customerNumber
ORDER BY totalPayment DESC
LIMIT 1;
```
-------------------------1555 sample_num
```sql
SELECT c.customerName, CONCAT(c.contactFirstName, ' ', c.contactLastName) AS contactPerson, SUM(p.amount) AS totalPayments
FROM customers c
JOIN employees e ON c.salesRepEmployeeNumber = e.employeeNumber
JOIN payments p ON c.customerNumber = p.customerNumber
WHERE e.officeCode IN (SELECT officeCode FROM offices WHERE city = 'Tokyo')
AND e.reportsTo = 1056
GROUP BY c.customerNumber
ORDER BY totalPayments DESC
LIMIT 1;
```
-------------------------1556 sample_num
```sql
SELECT 
    p.productCode, 
    p.productName, 
    (p.MSRP - p.buyPrice) AS expected_profit, 
    MAX(od.quantityOrdered * od.priceEach) AS total_price
FROM 
    products p
JOIN 
    orderdetails od ON p.productCode = od.productCode
GROUP BY 
    p.productCode, p.productName
ORDER BY 
    expected_profit DESC
LIMIT 1

UNION ALL

SELECT 
    p.productCode, 
    p.productName, 
    (p.MSRP - p.buyPrice) AS expected_profit, 
    MAX(od.quantityOrdered * od.priceEach) AS total_price
FROM 
    products p
JOIN 
    orderdetails od ON p.productCode = od.productCode
GROUP BY 
    p.productCode, p.productName
ORDER BY 
    expected_profit ASC
LIMIT 1;
```
-------------------------1557 sample_num
```sql
SELECT COUNT(DISTINCT o.orderNumber) AS cancelled_orders
FROM orders o
JOIN orderdetails od ON o.orderNumber = od.orderNumber
WHERE o.status = 'Cancelled'
GROUP BY o.orderNumber
HAVING SUM(od.quantityOrdered * od.priceEach) > 4000;
```
-------------------------1558 sample_num
```sql
SELECT COUNT(DISTINCT orderNumber) 
FROM orders 
JOIN orderdetails ON orders.orderNumber = orderdetails.orderNumber 
WHERE YEAR(orderDate) = '2003' AND quantityOrdered < 30;
```
-------------------------1559 sample_num
```sql
SELECT SUM(od.quantityOrdered * od.priceEach) AS total_value
FROM orders o
JOIN orderdetails od ON o.orderNumber = od.orderNumber
WHERE o.status = 'Cancelled';
```
-------------------------1560 sample_num
```sql
SELECT SUM(od.quantityOrdered * od.priceEach) AS totalValue
FROM orderdetails od
JOIN products p ON od.productCode = p.productCode
WHERE p.productLine = 'Motorcycles';
```
-------------------------1561 sample_num
```sql
SELECT COUNT(*) AS PlaneOrdersCount
FROM orders o
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE p.productLine = 'Planes';
```
-------------------------1562 sample_num
```sql
SELECT COUNT(DISTINCT o.orderNumber) AS numberOfOrders
FROM orders o
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE (p.MSRP - p.buyPrice) > 100;
```
-------------------------1563 sample_num
```sql
SELECT AVG(totalPrice) AS averageTotalPrice
FROM (
    SELECT o.orderNumber, SUM(od.quantityOrdered * od.priceEach) AS totalPrice
    FROM orders o
    JOIN orderdetails od ON o.orderNumber = od.orderNumber
    JOIN products p ON od.productCode = p.productCode
    WHERE YEAR(o.orderDate) = 2005 AND p.productVendor = 'Exoto Designs'
    GROUP BY o.orderNumber
) AS orderTotals;
```
-------------------------1564 sample_num
```sql
SELECT COUNT(*) 
FROM employees 
WHERE officeCode = 1 AND jobTitle = 'Sales Rep';
```
-------------------------1565 sample_num
```sql
SELECT DISTINCT c.customerName, p.amount
FROM customers c
JOIN payments p ON c.customerNumber = p.customerNumber
WHERE p.amount > 50000;
```
-------------------------1566 sample_num
```sql
SELECT SUM(p.amount) AS totalPayment
FROM payments p
JOIN customers c ON p.customerNumber = c.customerNumber
WHERE c.country = 'USA';
```
-------------------------1567 sample_num
```sql
SELECT SUM(p.amount) AS total_payments
FROM payments p
JOIN customers c ON p.customerNumber = c.customerNumber
WHERE c.creditLimit = 0 AND YEAR(p.paymentDate) = 2003;
```
-------------------------1568 sample_num
```sql
SELECT c.customerName, c.phone
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
WHERE o.status = 'Cancelled';
```
-------------------------1569 sample_num
```sql
SELECT COUNT(DISTINCT c.customerNumber) AS FrenchCustomers
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
WHERE c.country = 'France' AND o.status = 'Cancelled'
GROUP BY c.customerNumber
HAVING COUNT(o.orderNumber) = 2;
```
-------------------------1570 sample_num
```sql
SELECT AVG(totalPrice) AS averageTotalPrice
FROM (
    SELECT o.orderNumber, SUM(od.quantityOrdered * od.priceEach) AS totalPrice
    FROM orders o
    JOIN customers c ON o.customerNumber = c.customerNumber
    JOIN orderdetails od ON o.orderNumber = od.orderNumber
    WHERE c.country = 'Germany' AND o.status = 'Shipped'
    GROUP BY o.orderNumber
) AS shippedOrders;
```
-------------------------1571 sample_num
```sql
SELECT CONCAT(firstName, ' ', lastName) AS fullName
FROM employees
WHERE officeCode IN (
    SELECT officeCode
    FROM offices
    WHERE city = 'Tokyo'
);
```
-------------------------1572 sample_num
```sql
SELECT CONCAT(firstName, ' ', lastName) AS fullName, email
FROM employees
WHERE jobTitle = 'Sales Rep' AND officeCode IN (
    SELECT officeCode FROM offices WHERE city = 'Tokyo'
);
```
-------------------------1573 sample_num
```sql
SELECT e.email 
FROM employees e 
WHERE e.reportsTo = 1002 AND e.officeCode IN (
    SELECT o.officeCode 
    FROM offices o 
    WHERE o.city = 'San Francisco'
);
```
-------------------------1574 sample_num
```sql
SELECT email, employeeNumber 
FROM employees 
WHERE officeCode IN (
    SELECT officeCode 
    FROM offices 
    WHERE country = 'USA' AND state = 'MA'
);
```
-------------------------1575 sample_num
```sql
SELECT email 
FROM employees 
WHERE jobTitle = 'Sales Manager' 
AND officeCode IN (SELECT officeCode FROM offices WHERE city = 'Sydney');
```
-------------------------1576 sample_num
```sql
SELECT e.email, o.country
FROM employees e
JOIN offices o ON e.officeCode = o.officeCode
JOIN customers c ON e.employeeNumber = c.salesRepEmployeeNumber
WHERE o.country = 'Australia' AND c.creditLimit < 200000;
```
-------------------------1577 sample_num
```sql
SELECT e.email
FROM employees e
JOIN customers c ON e.employeeNumber = c.salesRepEmployeeNumber
WHERE c.country = 'UK' AND e.jobTitle = 'Sales Rep'
ORDER BY c.creditLimit ASC
LIMIT 10;
```
-------------------------1578 sample_num
```sql
SELECT COUNT(*) 
FROM customers 
WHERE country = 'Australia' AND creditLimit < 220000;
```
-------------------------1579 sample_num
```sql
SELECT customerNumber
FROM payments
GROUP BY customerNumber
ORDER BY SUM(amount) DESC
LIMIT 3;
```
-------------------------1580 sample_num
```sql
SELECT email, employeeNumber 
FROM employees 
WHERE officeCode IN (SELECT officeCode FROM offices WHERE country = 'USA' AND state = 'CA');
```
-------------------------1581 sample_num
```sql
SELECT CONCAT(firstName, ' ', lastName) AS fullName
FROM employees
WHERE officeCode IN (
    SELECT officeCode
    FROM offices
    WHERE city = 'Boston'
);
```
-------------------------1582 sample_num
```sql
SELECT e.email
FROM employees e
JOIN customers c ON e.employeeNumber = c.salesRepEmployeeNumber
WHERE c.country = 'UK' AND e.jobTitle = 'Sales Rep'
ORDER BY c.creditLimit DESC
LIMIT 3;
```
-------------------------1583 sample_num
```sql
SELECT COUNT(*) 
FROM customers 
WHERE country = 'Norway' AND creditLimit < 220000;
```
-------------------------1584 sample_num
```sql
SELECT CONCAT(firstName, ' ', lastName) AS fullName, email 
FROM employees 
WHERE officeCode IN (SELECT officeCode FROM offices WHERE city = 'Paris');
```
-------------------------1585 sample_num
```sql
SELECT productCode 
FROM products 
WHERE productLine = 'motorcycles' 
ORDER BY quantityInStock DESC 
LIMIT 5;
```
-------------------------1586 sample_num
```sql
SELECT COUNT(*) 
FROM customers 
WHERE country = 'Germany' AND creditLimit = 0;
```
-------------------------1587 sample_num
```sql
SELECT COUNT(DISTINCT customerNumber) AS customerCount
FROM payments
WHERE paymentDate BETWEEN '2003-01-01' AND '2004-12-31'
GROUP BY customerNumber
HAVING COUNT(customerNumber) > 3;
```
-------------------------1588 sample_num
```sql
SELECT AVG(od.priceEach - p.buyPrice) AS average_actual_profit
FROM orderdetails od
JOIN products p ON od.productCode = p.productCode
WHERE p.productName = '1937 Lincoln Berline';
```
-------------------------1589 sample_num
```sql
SELECT p.productCode, p.productName, SUM(od.quantityOrdered) AS totalOrdered
FROM products p
JOIN productlines pl ON p.productLine = pl.productLine
JOIN orderdetails od ON p.productCode = od.productCode
JOIN orders o ON od.orderNumber = o.orderNumber
JOIN customers c ON o.customerNumber = c.customerNumber
WHERE pl.productLine = 'Motorcycles' 
  AND p.productScale = '1:10' 
  AND c.country = 'USA'
GROUP BY p.productCode, p.productName
ORDER BY totalOrdered DESC
LIMIT 1;
```
-------------------------1590 sample_num
```sql
SELECT p.checkNumber
FROM payments p
JOIN customers c ON p.customerNumber = c.customerNumber
WHERE c.customerName = 'Mini Gifts Distributors Ltd.'
AND p.paymentDate BETWEEN '2003-08-01' AND '2004-08-30';
```
-------------------------1591 sample_num
```sql
SELECT 
    MAX(total_price) - AVG(total_price) AS price_exceed
FROM (
    SELECT 
        SUM(quantityOrdered * priceEach) AS total_price
    FROM 
        orderdetails od
    JOIN 
        products p ON od.productCode = p.productCode
    WHERE 
        p.productLine = 'Planes'
    GROUP BY 
        od.orderNumber
) AS total_prices;
```
-------------------------1592 sample_num
```sql
SELECT SUM(od.quantityOrdered * od.priceEach) AS total_value
FROM orders o
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE o.status = 'Shipped'
  AND p.productLine = 'Vintage Cars'
  AND YEAR(o.orderDate) BETWEEN 2003 AND 2004;
```
-------------------------1593 sample_num
```sql
SELECT 
    CONCAT(e.firstName, ' ', e.lastName) AS salesAgent,
    CONCAT(s.firstName, ' ', s.lastName) AS supervisor
FROM 
    payments p
JOIN 
    customers c ON p.customerNumber = c.customerNumber
JOIN 
    employees e ON c.salesRepEmployeeNumber = e.employeeNumber
JOIN 
    employees s ON e.reportsTo = s.employeeNumber
WHERE 
    p.amount = (SELECT MAX(amount) FROM payments);
```
-------------------------1594 sample_num
```sql
SELECT p.productName, MAX(od.quantityOrdered * od.priceEach) AS highestAmount
FROM offices o
JOIN employees e ON o.officeCode = e.officeCode
JOIN customers c ON e.employeeNumber = c.salesRepEmployeeNumber
JOIN orders o2 ON c.customerNumber = o2.customerNumber
JOIN orderdetails od ON o2.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE o.city = 'Boston'
GROUP BY p.productName
ORDER BY highestAmount DESC
LIMIT 1;
```
-------------------------1595 sample_num
```sql
SELECT SUM(od.priceEach - p.buyPrice) AS total_actual_profit
FROM orders o
JOIN customers c ON o.customerNumber = c.customerNumber
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE c.country = 'USA' 
AND o.orderDate BETWEEN '2003-01-06' AND '2005-05-09';
```
-------------------------1596 sample_num
```sql
SELECT o.addressLine1 + ' ' + o.addressLine2 AS fullAddress, o.phone
FROM employees e
JOIN customers c ON e.employeeNumber = c.salesRepEmployeeNumber
JOIN orders o ON c.customerNumber = o.customerNumber
JOIN offices o ON e.officeCode = o.officeCode
WHERE o.orderDate BETWEEN '2005-01-01' AND '2005-12-31'
GROUP BY e.employeeNumber, o.officeCode, o.addressLine1, o.addressLine2, o.phone
ORDER BY COUNT(o.orderNumber) DESC
LIMIT 1;
```
-------------------------1597 sample_num
```sql
SELECT phone 
FROM customers 
WHERE contactLastName LIKE 'M%' AND country <> 'Germany';
```
-------------------------1598 sample_num
```sql
SELECT AVG(amount) AS average_payment
FROM payments
WHERE paymentDate >= '2004-01-01' AND paymentDate < '2004-07-01';
```
-------------------------1599 sample_num
```sql
SELECT 
    (SUM(CASE WHEN customerNumber = 186 THEN 1 ELSE 0 END) / COUNT(orderNumber)) * 100 AS percentage
FROM 
    orders
WHERE 
    status = 'shipped' 
    AND YEAR(shippedDate) = 2005;
```
-------------------------1600 sample_num
```sql
SELECT COUNT(DISTINCT c.customerNumber) 
FROM customers c 
JOIN orders o ON c.customerNumber = o.customerNumber 
WHERE o.status = 'cancelled' AND c.creditLimit > 115000;
```
-------------------------1601 sample_num
```sql
SELECT p.paymentDate
FROM payments p
JOIN customers c ON p.customerNumber = c.customerNumber
WHERE c.creditLimit = (
    SELECT MIN(creditLimit)
    FROM customers
    WHERE salesRepEmployeeNumber = (
        SELECT employeeNumber
        FROM employees
        WHERE CONCAT(firstName, ' ', lastName) = 'Barry Jones'
    )
);
```
-------------------------1602 sample_num
```sql
SELECT e2.firstName, e2.lastName 
FROM customers c 
JOIN employees e ON c.salesRepEmployeeNumber = e.employeeNumber 
JOIN employees e2 ON e.reportsTo = e2.employeeNumber 
WHERE c.country = 'France';
```
-------------------------1603 sample_num
```sql
SELECT CONCAT(c.addressLine1, ' ', c.addressLine2) AS fullAddress
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
WHERE o.comments LIKE '%DHL%' AND o.shippedDate = '2005-04-04';
```
-------------------------1604 sample_num
```sql
SELECT CONCAT(o.addressLine1, ', ', o.addressLine2) AS fullAddress
FROM offices o
JOIN employees e ON o.officeCode = e.officeCode
JOIN customers c ON e.employeeNumber = c.salesRepEmployeeNumber
WHERE c.city = 'New York';
```
-------------------------1605 sample_num
```sql
SELECT CONCAT(o.addressLine1, ' ', o.addressLine2) AS fullAddress
FROM offices o
JOIN employees e ON o.officeCode = e.officeCode
WHERE e.jobTitle = 'Sales Rep'
GROUP BY o.officeCode
HAVING COUNT(e.employeeNumber) = 4;
```
-------------------------1606 sample_num
```sql
SELECT SUM(MSRP - buyPrice) AS profit
FROM products
WHERE productVendor = 'Carousel DieCast Legends' AND productDescription = 'The perfect holiday or anniversary gift for executives';
```
-------------------------1607 sample_num
```sql
SELECT c.customerNumber, AVG(p.amount) AS averagePayment
FROM customers c
JOIN payments p ON c.customerNumber = p.customerNumber
WHERE c.city = 'Boston'
GROUP BY c.customerNumber
ORDER BY averagePayment DESC;
```
-------------------------1608 sample_num
```sql
SELECT SUM(od.quantityOrdered) AS total_quantity_ordered, AVG(od.priceEach) AS average_price
FROM orderdetails od
JOIN products p ON od.productCode = p.productCode
WHERE p.productName = '18th Century Vintage Horse Carriage';
```
-------------------------1609 sample_num
```sql
SELECT COUNT(DISTINCT productCode) AS productCount
FROM orderdetails
WHERE orderNumber = 10252;
```
-------------------------1610 sample_num
```sql
SELECT e.firstName, e.lastName
FROM orders o
JOIN customers c ON o.customerNumber = c.customerNumber
JOIN employees e ON c.salesRepEmployeeNumber = e.employeeNumber
WHERE o.orderNumber IN (
    SELECT orderNumber
    FROM orders
    WHERE orderNumber IN (
        SELECT orderNumber
        FROM orderdetails od
        JOIN products p ON od.productCode = p.productCode
        WHERE p.productDescription LIKE '%25 Maiden Lane, Floor No. 4%'
    )
);
```
-------------------------1611 sample_num
```sql
SELECT o.addressLine1, o.addressLine2, o.city, o.state, o.country, o.postalCode
FROM employees e
JOIN offices o ON e.officeCode = o.officeCode
WHERE e.firstName = 'Foon' AND e.lastName = 'Tseng';
```
-------------------------1612 sample_num
```sql
SELECT 
    orderDate, 
    SUM(quantityOrdered * priceEach) AS totalValue
FROM 
    orders 
JOIN 
    orderdetails ON orders.orderNumber = orderdetails.orderNumber
WHERE 
    orderDate IN ('2005-04-08', '2005-04-10')
GROUP BY 
    orderDate
ORDER BY 
    totalValue DESC
LIMIT 1;
```
-------------------------1613 sample_num
```sql
SELECT SUM(od.quantityOrdered) AS total_products_sold
FROM orderdetails od
JOIN products p ON od.productCode = p.productCode
WHERE (p.MSRP - p.buyPrice) = (
    SELECT MAX(MSRP - buyPrice) FROM products
);
```
-------------------------1614 sample_num
```sql
SELECT amount 
FROM payments 
WHERE customerNumber = (SELECT customerNumber FROM customers WHERE customerName = 'Petit Auto') 
AND paymentDate = '2004-08-09';
```
-------------------------1615 sample_num
```sql
SELECT customers.contactFirstName, customers.contactLastName 
FROM payments 
JOIN customers ON payments.customerNumber = customers.customerNumber 
WHERE payments.checkNumber = 'NR157385';
```
-------------------------1616 sample_num
```sql
SELECT CONCAT(c.contactFirstName, ' ', c.contactLastName) AS contactName
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
WHERE o.orderNumber = 10160;
```
-------------------------1617 sample_num
```sql
SELECT CONCAT(c.addressLine1, ' ', c.addressLine2) AS address
FROM orders o
JOIN customers c ON o.customerNumber = c.customerNumber
WHERE o.orderNumber = 10383;
```
-------------------------1618 sample_num
```sql
SELECT pl.textDescription 
FROM productlines pl 
JOIN products p ON pl.productLine = p.productLine 
WHERE p.productCode = 'S18_2949';
```
-------------------------1619 sample_num
```sql
SELECT e.email 
FROM customers c 
JOIN employees e ON c.salesRepEmployeeNumber = e.employeeNumber 
WHERE c.customerName = 'Dragon Souveniers, Ltd.';
```
-------------------------1620 sample_num
```sql
SELECT COUNT(*) 
FROM customers 
WHERE country = 'France' 
AND salesRepEmployeeNumber = (SELECT employeeNumber FROM employees WHERE firstName = 'Gerard' AND lastName = 'Hernandez');
```
-------------------------1621 sample_num
```sql
SELECT p.productName
FROM orders o
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE o.customerNumber = 114
ORDER BY o.orderDate DESC
LIMIT 1;
```
-------------------------1622 sample_num
```sql
SELECT (MSRP - priceEach) / MSRP AS discount
FROM products
JOIN orderdetails ON products.productCode = orderdetails.productCode
WHERE products.productCode = 'S18_3482' AND orderdetails.orderNumber = 10108;
```
-------------------------1623 sample_num
```sql
SELECT CONCAT(e.firstName, ' ', e.lastName) AS fullName
FROM employees AS emp
JOIN employees AS e ON emp.reportsTo = e.employeeNumber
WHERE emp.firstName = 'Steve' AND emp.lastName = 'Patterson';
```
-------------------------1624 sample_num
```sql
SELECT email, phone 
FROM employees 
WHERE jobTitle = 'President';
```
-------------------------1625 sample_num
```sql
SELECT CONCAT(e.firstName, ' ', e.lastName) AS fullName
FROM customers c
JOIN employees e ON c.salesRepEmployeeNumber = e.employeeNumber
WHERE c.customerName = 'Muscle Machine Inc';
```
-------------------------1626 sample_num
```sql
SELECT e.email 
FROM employees e 
JOIN customers c ON e.employeeNumber = c.salesRepEmployeeNumber 
WHERE c.customerName = 'Muscle Machine Inc' 
AND e.employeeNumber = (SELECT reportsTo FROM employees WHERE employeeNumber = c.salesRepEmployeeNumber);
```
-------------------------1627 sample_num
```sql
SELECT c.*
FROM customers c
JOIN employees e ON c.salesRepEmployeeNumber = e.employeeNumber
WHERE e.firstName = 'Steve' AND e.lastName = 'Patterson';
```
-------------------------1628 sample_num
```sql
SELECT COUNT(DISTINCT c.customerNumber) AS customerCount
FROM customers c
JOIN employees e ON c.salesRepEmployeeNumber = e.employeeNumber
WHERE e.reportsTo = (SELECT employeeNumber FROM employees WHERE CONCAT(firstName, ' ', lastName) = 'William Patterson');
```
-------------------------1629 sample_num
```sql
SELECT phone 
FROM customers 
WHERE salesRepEmployeeNumber = (SELECT employeeNumber FROM employees WHERE firstName = 'Leslie' AND lastName = 'Jennings') 
ORDER BY creditLimit DESC 
LIMIT 3;
```
-------------------------1630 sample_num
```sql
SELECT COUNT(*) 
FROM employees 
WHERE jobTitle = 'Sales Rep' AND officeCode IN (
    SELECT officeCode 
    FROM offices 
    WHERE country = 'USA'
);
```
-------------------------1631 sample_num
```sql
SELECT o.addressLine1, o.addressLine2 
FROM offices o 
JOIN employees e ON o.officeCode = e.officeCode 
WHERE e.jobTitle = 'President';
```
-------------------------1632 sample_num
```sql
SELECT o.postalCode 
FROM offices o 
JOIN employees e ON o.officeCode = e.officeCode 
WHERE e.jobTitle = 'VP Sales';
```
-------------------------1633 sample_num
```sql
SELECT SUM(od.quantityOrdered * od.priceEach) AS totalPrice
FROM orders o
JOIN customers c ON o.customerNumber = c.customerNumber
JOIN orderdetails od ON o.orderNumber = od.orderNumber
WHERE o.orderDate = '2003-03-03' AND c.customerName = 'Cruz & Sons Co.';
```
-------------------------1634 sample_num
```sql
SELECT p.productName 
FROM customers c 
JOIN orders o ON c.customerNumber = o.customerNumber 
JOIN orderdetails od ON o.orderNumber = od.orderNumber 
JOIN products p ON od.productCode = p.productCode 
WHERE c.customerName = 'Cruz & Sons Co.' AND o.orderDate = '2003-03-03';
```
-------------------------1635 sample_num
```sql
SELECT p.productName
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE c.customerName = 'Cruz & Sons Co.'
ORDER BY od.quantityOrdered DESC
LIMIT 1;
```
-------------------------1636 sample_num
```sql
SELECT o.shippedDate
FROM orders o
JOIN customers c ON o.customerNumber = c.customerNumber
WHERE c.customerName = 'Cruz & Sons Co.' AND o.orderDate = '2003-03-03';
```
-------------------------1637 sample_num
```sql
SELECT COUNT(DISTINCT c.customerNumber) AS customerCount
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE p.productName = '1957 Chevy Pickup' 
AND MONTH(o.orderDate) = :month 
AND YEAR(o.orderDate) = :year;
```
-------------------------1638 sample_num
```sql
SELECT productName 
FROM products 
WHERE productLine = 'Classic Cars' 
ORDER BY (MSRP - buyPrice) DESC 
LIMIT 1;
```
-------------------------1639 sample_num
```sql
SELECT DISTINCT c.customerName
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
WHERE o.status = 'In Process';
```
-------------------------1640 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN DATEDIFF(shippedDate, requiredDate) < -3 THEN orderNumber END) * 100.0 / COUNT(orderNumber)) AS percentage
FROM 
    orders
WHERE 
    status = 'Shipped';
```
-------------------------1641 sample_num
```sql
SELECT customerNumber
FROM payments
WHERE YEAR(paymentDate) = 2005
ORDER BY amount DESC
LIMIT 1;
```
-------------------------1642 sample_num
```sql
SELECT p.productName, 
       (p.MSRP - p.buyPrice) AS expectedProfitMargin
FROM products p
JOIN orderdetails od ON p.productCode = od.productCode
GROUP BY p.productName
ORDER BY SUM(od.quantityOrdered) DESC
LIMIT 1;
```
-------------------------1643 sample_num
```sql
SELECT c.customerName
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
JOIN orderdetails od ON o.orderNumber = od.orderNumber
GROUP BY o.orderNumber, c.customerName
ORDER BY SUM(od.quantityOrdered * od.priceEach) DESC
LIMIT 1;
```
-------------------------1644 sample_num
```sql
SELECT DISTINCT c.customerName
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
WHERE o.status = 'Disputed';
```
-------------------------1645 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN o.city = 'Paris' THEN e.employeeNumber END) * 100.0 / COUNT(e.employeeNumber)) AS percentage
FROM 
    employees e
JOIN 
    offices o ON e.officeCode = o.officeCode;
```
-------------------------1646 sample_num
```sql
SELECT e.firstName, e.lastName, o.city
FROM employees e
JOIN offices o ON e.officeCode = o.officeCode
WHERE e.jobTitle = 'Sales Manager' AND o.territory = 'EMEA';
```
-------------------------1647 sample_num
```sql
SELECT e.firstName, e.lastName, e.reportsTo
FROM employees e
JOIN offices o ON e.officeCode = o.officeCode
WHERE o.country = 'Japan';
```
-------------------------1648 sample_num
```sql
SELECT c.customerName
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE p.productName = '1939 Chevrolet Deluxe Coupe'
ORDER BY od.priceEach DESC
LIMIT 1;
```
-------------------------1649 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.customerName = 'Atelier graphique' THEN p.amount ELSE 0 END) / SUM(p.amount)) * 100 AS percentage
FROM 
    payments p
JOIN 
    customers c ON p.customerNumber = c.customerNumber
WHERE 
    YEAR(p.paymentDate) = 2004;
```
-------------------------1650 sample_num
```sql
SELECT SUM(od.quantityOrdered * (od.priceEach - p.buyPrice)) AS actual_profit
FROM orderdetails od
JOIN products p ON od.productCode = p.productCode
WHERE od.orderNumber = 10100;
```
-------------------------1651 sample_num
```sql
SELECT SUM(amount) AS totalPaid
FROM payments
WHERE customerNumber = 103;
```
-------------------------1652 sample_num
```sql
SELECT SUM(quantityOrdered * priceEach) AS totalPrice
FROM orderdetails
WHERE orderNumber = 10100;
```
-------------------------1653 sample_num
```sql
SELECT productName 
FROM products 
ORDER BY buyPrice DESC 
LIMIT 3;
```
-------------------------1654 sample_num
```sql
SELECT CONCAT(c.contactFirstName, ' ', c.contactLastName) AS contactFullName
FROM customers c
WHERE c.salesRepEmployeeNumber = 1370
ORDER BY c.creditLimit DESC
LIMIT 1;
```
-------------------------1655 sample_num
```sql
SELECT SUM(od.quantityOrdered) AS totalOrdered
FROM orderdetails od
JOIN products p ON od.productCode = p.productCode
WHERE p.productName = '2003 Harley-Davidson Eagle Drag Bike';
```
-------------------------1656 sample_num
```sql
SELECT shippedDate 
FROM orders 
JOIN orderdetails ON orders.orderNumber = orderdetails.orderNumber 
WHERE priceEach = (SELECT MAX(priceEach) FROM orderdetails);
```
-------------------------1657 sample_num
```sql
SELECT SUM(od.quantityOrdered) AS totalMotorcyclesOrdered
FROM orders o
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE p.productLine = 'motorcycles' AND YEAR(o.orderDate) = 2004;
```
-------------------------1658 sample_num
```sql
SELECT o.orderNumber 
FROM orders o 
JOIN customers c ON o.customerNumber = c.customerNumber 
WHERE c.creditLimit = 45300;
```
-------------------------1659 sample_num
```sql
SELECT c.customerName, MAX(od.quantityOrdered * (od.priceEach - p.buyPrice)) AS profit
FROM orderdetails od
JOIN orders o ON od.orderNumber = o.orderNumber
JOIN customers c ON o.customerNumber = c.customerNumber
JOIN products p ON od.productCode = p.productCode
GROUP BY c.customerName
ORDER BY profit DESC
LIMIT 1;
```
-------------------------1660 sample_num
```sql
SELECT YEAR(paymentDate) AS year, COUNT(*) AS transactionCount
FROM payments
WHERE amount < 10000
GROUP BY YEAR(paymentDate);
```
-------------------------1661 sample_num
```sql
SELECT p.productName, SUM(od.quantityOrdered) AS totalQuantitySold
FROM orders o
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE YEAR(o.orderDate) = 2003
GROUP BY p.productName
ORDER BY totalQuantitySold DESC
LIMIT 3;
```
-------------------------1662 sample_num
```sql
SELECT e.firstName, e.lastName, SUM(od.quantityOrdered) AS quantitySold
FROM employees e
JOIN customers c ON e.employeeNumber = c.salesRepEmployeeNumber
JOIN orders o ON c.customerNumber = o.customerNumber
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE p.productName = '1969 Harley Davidson Ultimate Chopper' 
AND YEAR(o.orderDate) = 2003
GROUP BY e.employeeNumber, e.firstName, e.lastName;
```
-------------------------1663 sample_num
```sql
SELECT CONCAT(e.firstName, ' ', e.lastName) AS fullName
FROM employees e
JOIN offices o ON e.officeCode = o.officeCode
WHERE o.city = 'NYC' AND e.jobTitle = 'Sales Rep';
```
-------------------------1664 sample_num
```sql
SELECT c.customerName, c.country
FROM customers c
JOIN payments p ON c.customerNumber = p.customerNumber
WHERE p.checkNumber = 'GG31455';
```
-------------------------1665 sample_num
```sql
SELECT SUM(od.quantityOrdered) AS totalOrdered
FROM orderdetails od
JOIN products p ON od.productCode = p.productCode
WHERE p.productName = '2001 Ferrari Enzo';
```
-------------------------1666 sample_num
```sql
SELECT p.productName
FROM products p
JOIN orderdetails od ON p.productCode = od.productCode
GROUP BY p.productName
ORDER BY SUM(od.quantityOrdered) ASC
LIMIT 5;
```
-------------------------1667 sample_num
```sql
SELECT DISTINCT c.customerName
FROM customers c
JOIN orders o ON c.customerNumber = o.customerNumber
WHERE o.status = 'disputed';
```
-------------------------1668 sample_num
```sql
SELECT COUNT(DISTINCT c.country) 
FROM customers c 
JOIN orders o ON c.customerNumber = o.customerNumber 
WHERE c.country = 'USA' AND o.status = 'In Process';
```
-------------------------1669 sample_num
```sql
SELECT SUM(od.quantityOrdered * od.priceEach) AS totalPrice
FROM orders o
JOIN customers c ON o.customerNumber = c.customerNumber
JOIN orderdetails od ON o.orderNumber = od.orderNumber
JOIN products p ON od.productCode = p.productCode
WHERE c.customerName = 'Land of Toys Inc.'
  AND p.productLine = 'Classic Cars'
  AND o.status = 'Shipped';
```
-------------------------1670 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo 
WHERE review < 3;
```
-------------------------1671 sample_num
```sql
SELECT DISTINCT food_type 
FROM generalinfo 
WHERE review = 4 
ORDER BY id_restaurant 
LIMIT 4;
```
-------------------------1672 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo 
WHERE city = 'Richmond' AND food_type = 'mediterranean';
```
-------------------------1673 sample_num
```sql
SELECT DISTINCT city FROM geographic WHERE county = 'Sonoma County';
```
-------------------------1674 sample_num
```sql
SELECT DISTINCT county FROM geographic WHERE region != 'bay area';
```
-------------------------1675 sample_num
```sql
SELECT DISTINCT city 
FROM geographic 
WHERE region = 'Northern California';
```
-------------------------1676 sample_num
```sql
SELECT id_restaurant 
FROM location 
WHERE street_name = '11th Street' AND city = 'Oakland';
```
-------------------------1677 sample_num
```sql
SELECT COUNT(*) 
FROM location 
WHERE street_num = 871;
```
-------------------------1678 sample_num
```sql
SELECT street_num 
FROM location 
WHERE street_name = '9th Avenue' AND city = 'San Francisco';
```
-------------------------1679 sample_num
```sql
SELECT DISTINCT gi.food_type 
FROM generalinfo gi 
JOIN location l ON gi.id_restaurant = l.id_restaurant 
WHERE l.street_name = 'adeline st' AND l.city = 'berkeley';
```
-------------------------1680 sample_num
```sql
SELECT DISTINCT g.region
FROM geographic g
LEFT JOIN generalinfo gi ON g.city = gi.city AND gi.food_type = 'african'
WHERE gi.id_restaurant IS NULL;
```
-------------------------1681 sample_num
```sql
SELECT DISTINCT g.county
FROM geographic g
JOIN generalinfo gi ON g.city = gi.city
WHERE gi.label = 'a & w root beer';
```
-------------------------1682 sample_num
```sql
SELECT street_num, street_name 
FROM location 
JOIN generalinfo ON location.id_restaurant = generalinfo.id_restaurant 
WHERE generalinfo.label = 'adelitas taqueria';
```
-------------------------1683 sample_num
```sql
SELECT g.food_type 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
JOIN geographic geo ON l.city = geo.city 
WHERE l.street_num = 3140 
AND l.street_name = 'Alpine Road' 
AND geo.county = 'San Mateo County';
```
-------------------------1684 sample_num
```sql
SELECT DISTINCT l.street_name
FROM location l
JOIN generalinfo g ON l.id_restaurant = g.id_restaurant
WHERE l.city = 'San Francisco' AND g.food_type = 'seafood';
```
-------------------------1685 sample_num
```sql
SELECT DISTINCT g.county
FROM geographic g
WHERE NOT EXISTS (
    SELECT 1
    FROM generalinfo gi
    WHERE gi.city = g.city AND gi.label = 'bakers square restaurant & pie shop'
);
```
-------------------------1686 sample_num
```sql
SELECT COUNT(DISTINCT county) 
FROM geographic 
WHERE city IN (SELECT city FROM location WHERE street_name = 'Appian Way');
```
-------------------------1687 sample_num
```sql
SELECT g.label, g.review
FROM generalinfo g
JOIN location l ON g.id_restaurant = l.id_restaurant
WHERE l.street_name = 'atlantic ave';
```
-------------------------1688 sample_num
```sql
SELECT gi.id_restaurant 
FROM generalinfo gi 
JOIN geographic g ON gi.city = g.city 
WHERE g.county = 'Contra Costa County';
```
-------------------------1689 sample_num
```sql
SELECT g.label 
FROM generalinfo g 
JOIN geographic geo ON g.city = geo.city 
WHERE geo.county = 'Yolo County';
```
-------------------------1690 sample_num
```sql
SELECT g.label 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE l.street_name = 'Drive' AND l.city = 'San Rafael' AND g.food_type <> 'american';
```
-------------------------1691 sample_num
```sql
SELECT l.street_name
FROM location l
JOIN generalinfo g ON l.id_restaurant = g.id_restaurant
WHERE l.city = 'San Francisco' AND g.review = 1.7;
```
-------------------------1692 sample_num
```sql
SELECT g.label, MIN(g.review) AS worst_rating
FROM generalinfo g
JOIN location l ON g.id_restaurant = l.id_restaurant
WHERE l.street_name = 'Alameda de las Pulgas' AND l.city = 'Menlo Park'
GROUP BY g.label
ORDER BY worst_rating ASC
LIMIT 1;
```
-------------------------1693 sample_num
```sql
SELECT l.street_name 
FROM location l 
JOIN generalinfo g ON l.id_restaurant = g.id_restaurant 
JOIN geographic geo ON g.city = geo.city 
WHERE g.label = 'Good Heavens' AND geo.county = 'Tuolumne County';
```
-------------------------1694 sample_num
```sql
SELECT street_num 
FROM location 
JOIN generalinfo ON location.id_restaurant = generalinfo.id_restaurant 
WHERE generalinfo.label = 'aux delices vietnamese restaurant';
```
-------------------------1695 sample_num
```sql
SELECT gi.id_restaurant 
FROM generalinfo gi 
JOIN geographic g ON gi.city = g.city 
WHERE g.county = 'Marin County';
```
-------------------------1696 sample_num
```sql
SELECT DISTINCT g.region
FROM geographic g
WHERE NOT EXISTS (
    SELECT 1
    FROM generalinfo gi
    WHERE gi.city = g.city AND gi.food_type = 'pizza'
);
```
-------------------------1697 sample_num
```sql
SELECT AVG(CAST(g.review AS FLOAT)) AS average_rating
FROM generalinfo g
JOIN geographic geo ON g.city = geo.city
WHERE geo.county = 'Santa Cruz County';
```
-------------------------1698 sample_num
```sql
SELECT (COUNT(CASE WHEN g.food_type = 'mexican' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM generalinfo g
JOIN geographic geo ON g.city = geo.city
WHERE geo.county = 'monterey county';
```
-------------------------1699 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN l.street_name = '11th Street' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    location l
JOIN 
    geographic g ON l.city = g.city
WHERE 
    g.county = 'Alameda County';
```
-------------------------1700 sample_num
```sql
SELECT label 
FROM generalinfo 
WHERE food_type = 'european';
```
-------------------------1701 sample_num
```sql
SELECT DISTINCT g.city 
FROM geographic g 
WHERE g.region = 'northern california';
```
-------------------------1702 sample_num
```sql
SELECT label FROM generalinfo WHERE food_type = '24 hour diner';
```
-------------------------1703 sample_num
```sql
SELECT DISTINCT city 
FROM geographic 
WHERE county = 'unknown' AND region = 'unknown' 
LIMIT 5;
```
-------------------------1704 sample_num
```sql
SELECT county, region FROM geographic WHERE city = 'Davis City';
```
-------------------------1705 sample_num
```sql
SELECT street_name FROM location WHERE city = 'Clayton';
```
-------------------------1706 sample_num
```sql
SELECT label 
FROM generalinfo 
WHERE city = 'San Francisco' 
ORDER BY review DESC 
LIMIT 1;
```
-------------------------1707 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo 
WHERE food_type = 'american' AND city = 'Carmel' AND review = (SELECT MIN(review) FROM generalinfo WHERE food_type = 'american' AND city = 'Carmel');
```
-------------------------1708 sample_num
```sql
SELECT (COUNT(g.id_restaurant) * 100.0 / 
        (SELECT COUNT(*) FROM generalinfo WHERE food_type = 'american food' AND city = 'dublin')) AS percentage
FROM generalinfo g
WHERE g.city = 'dublin';
```
-------------------------1709 sample_num
```sql
SELECT CONCAT(l.street_num, ' ', l.street_name, ', ', l.city) AS full_address
FROM generalinfo g
JOIN location l ON g.id_restaurant = l.id_restaurant
WHERE g.label = 'Albert''s Café';
```
-------------------------1710 sample_num
```sql
SELECT g.label 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE l.street_name = '19th St' AND l.city = 'Oakland';
```
-------------------------1711 sample_num
```sql
SELECT DISTINCT gi.food_type 
FROM generalinfo gi 
JOIN location l ON gi.id_restaurant = l.id_restaurant 
WHERE l.street_name = 'E 25th Ave' AND l.street_num = '106';
```
-------------------------1712 sample_num
```sql
SELECT g.label 
FROM generalinfo g 
JOIN geographic geo ON g.city = geo.city 
WHERE geo.region = 'unknown' 
LIMIT 3;
```
-------------------------1713 sample_num
```sql
SELECT g.label 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE g.food_type = 'chinese' 
AND l.street_num = 104 
AND l.street_name = 'san tomas aquino road' 
AND l.city = 'campbell';
```
-------------------------1714 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo T1 
JOIN location T2 ON T1.id_restaurant = T2.id_restaurant 
WHERE T1.food_type = 'thai' 
AND T2.street_name = 'san pablo ave' 
AND T2.city = 'albany';
```
-------------------------1715 sample_num
```sql
SELECT g.county, g.region 
FROM geographic g 
JOIN generalinfo gi ON g.city = gi.city 
WHERE gi.label = 'plearn-thai cuisine';
```
-------------------------1716 sample_num
```sql
SELECT g.label 
FROM generalinfo g 
JOIN geographic geo ON g.city = geo.city 
WHERE geo.county = 'El Dorado County' AND geo.region = 'Lake Tahoe';
```
-------------------------1717 sample_num
```sql
SELECT g.county, g.region
FROM geographic g
JOIN location l ON g.city = l.city
WHERE l.street_name = 'E. El Camino Real';
```
-------------------------1718 sample_num
```sql
SELECT g.label 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE g.food_type = 'Indian restaurant' 
AND l.street_name = 'Shattuck Avenue' 
AND l.city = 'Berkeley' 
ORDER BY g.review ASC 
LIMIT 1;
```
-------------------------1719 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN g.review > 4 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    geographic geo
JOIN 
    generalinfo g ON geo.city = g.city
WHERE 
    geo.region = 'Bay Area';
```
-------------------------1720 sample_num
```sql
SELECT DISTINCT city FROM geographic WHERE county = 'San Mateo County';
```
-------------------------1721 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo 
WHERE review > 4;
```
-------------------------1722 sample_num
```sql
SELECT street_name
FROM location
GROUP BY street_name
ORDER BY COUNT(id_restaurant) DESC
LIMIT 1;
```
-------------------------1723 sample_num
```sql
SELECT g.id_restaurant, g.label, MAX(g.review) AS highest_review
FROM generalinfo g
WHERE g.food_type = 'chicken'
GROUP BY g.id_restaurant, g.label
ORDER BY highest_review DESC
LIMIT 1;
```
-------------------------1724 sample_num
```sql
SELECT county FROM geographic WHERE city = 'el cerrito';
```
-------------------------1725 sample_num
```sql
SELECT COUNT(*) 
FROM location 
WHERE street_name = 'irving';
```
-------------------------1726 sample_num
```sql
SELECT gi.label 
FROM generalinfo gi 
JOIN geographic g ON gi.city = g.city 
WHERE g.county = 'Marin';
```
-------------------------1727 sample_num
```sql
SELECT l.street_num, l.street_name 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE g.label = 'peking duck restaurant';
```
-------------------------1728 sample_num
```sql
SELECT l.street_name
FROM location l
JOIN geographic g ON l.city = g.city
GROUP BY l.street_name
HAVING g.county = 'Alameda' AND COUNT(l.id_restaurant) > 10;
```
-------------------------1729 sample_num
```sql
SELECT DISTINCT g.region
FROM geographic g
JOIN generalinfo gi ON g.city = gi.city
WHERE gi.food_type = 'greek';
```
-------------------------1730 sample_num
```sql
SELECT l.street_num, l.street_name
FROM location l
JOIN geographic g ON l.city = g.city
WHERE g.region = 'unknown';
```
-------------------------1731 sample_num
```sql
SELECT g.review 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE l.street_num = 8440 AND l.street_name = 'murray ave';
```
-------------------------1732 sample_num
```sql
SELECT food_type
FROM generalinfo
WHERE city IN (SELECT city FROM geographic WHERE county = 'Monterey')
GROUP BY food_type
ORDER BY COUNT(food_type) DESC
LIMIT 1;
```
-------------------------1733 sample_num
```sql
SELECT street_name
FROM location l
JOIN generalinfo g ON l.id_restaurant = g.id_restaurant
WHERE g.city = 'san francisco' AND g.food_type = 'burgers'
GROUP BY street_name
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------1734 sample_num
```sql
SELECT g.region 
FROM geographic g 
JOIN location l ON g.city = l.city 
WHERE l.street_num = 1149 AND l.street_name = 'El Camino Real';
```
-------------------------1735 sample_num
```sql
SELECT g.county 
FROM geographic g 
JOIN generalinfo gi ON g.city = gi.city 
WHERE gi.label = 'sankee';
```
-------------------------1736 sample_num
```sql
SELECT COUNT(DISTINCT l.street_name) AS street_count
FROM location l
JOIN geographic g ON l.city = g.city
WHERE g.region = 'Northern California';
```
-------------------------1737 sample_num
```sql
SELECT g.label 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE l.street_name = 'Park St';
```
-------------------------1738 sample_num
```sql
SELECT (COUNT(g.id_restaurant) * 100.0 / (SELECT COUNT(*) FROM generalinfo)) AS percentage
FROM geographic geo
JOIN generalinfo g ON geo.city = g.city
WHERE geo.region = 'bay area';
```
-------------------------1739 sample_num
```sql
SELECT g.county, AVG(gi.review) AS average_review
FROM generalinfo gi
JOIN geographic g ON gi.city = g.city
WHERE gi.food_type = 'chinese'
GROUP BY g.county
ORDER BY average_review DESC;
```
-------------------------1740 sample_num
```sql
SELECT street_name FROM location WHERE city = 'San Francisco';
```
-------------------------1741 sample_num
```sql
SELECT id_restaurant FROM location WHERE city = 'Danville';
```
-------------------------1742 sample_num
```sql
SELECT COUNT(DISTINCT city) 
FROM geographic 
WHERE region = 'bay area';
```
-------------------------1743 sample_num
```sql
SELECT COUNT(DISTINCT g.label) AS unknown_count
FROM generalinfo g
JOIN geographic geo ON g.city = geo.city
WHERE geo.county = 'unknown';
```
-------------------------1744 sample_num
```sql
SELECT l.street_name 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE g.food_type = 'American';
```
-------------------------1745 sample_num
```sql
SELECT DISTINCT gi.label 
FROM generalinfo gi 
JOIN geographic g ON gi.city = g.city 
WHERE g.county = 'Santa Cruz county';
```
-------------------------1746 sample_num
```sql
SELECT g.review 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE l.street_num = 430 AND l.street_name = 'Broadway';
```
-------------------------1747 sample_num
```sql
SELECT l.street_num, l.street_name
FROM generalinfo g
JOIN location l ON g.id_restaurant = l.id_restaurant
WHERE g.review = (SELECT MAX(review) FROM generalinfo);
```
-------------------------1748 sample_num
```sql
SELECT g.region AS country, COUNT(gi.id_restaurant) AS restaurant_count
FROM generalinfo gi
JOIN geographic g ON gi.city = g.city
WHERE gi.food_type = 'Italian'
GROUP BY g.region
ORDER BY restaurant_count DESC
LIMIT 1;
```
-------------------------1749 sample_num
```sql
SELECT (COUNT(DISTINCT gi.id_restaurant) * 100.0 / (SELECT COUNT(DISTINCT id_restaurant) FROM generalinfo)) AS percentage
FROM geographic g
JOIN generalinfo gi ON g.city = gi.city
WHERE g.region = 'Napa Valley';
```
-------------------------1750 sample_num
```sql
SELECT COUNT(DISTINCT g.city) 
FROM geographic g 
WHERE g.region = 'bay area';
```
-------------------------1751 sample_num
```sql
SELECT DISTINCT g.city 
FROM geographic g 
WHERE g.county = 'unknown';
```
-------------------------1752 sample_num
```sql
SELECT DISTINCT g.city 
FROM geographic g 
WHERE g.region = 'bay area' AND g.county = 'santa clara county';
```
-------------------------1753 sample_num
```sql
SELECT id_restaurant FROM location WHERE city = 'sunnyvale';
```
-------------------------1754 sample_num
```sql
SELECT COUNT(*) 
FROM location 
WHERE street_num < 1000 AND street_name = 'railroad';
```
-------------------------1755 sample_num
```sql
SELECT label 
FROM generalinfo 
WHERE food_type = '24 hour diner' AND city = 'san francisco';
```
-------------------------1756 sample_num
```sql
SELECT g.review 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE l.street_name = 'ocean st' AND l.city = 'santa cruz';
```
-------------------------1757 sample_num
```sql
SELECT l.street_num 
FROM location l 
JOIN generalinfo g ON l.id_restaurant = g.id_restaurant 
WHERE g.food_type = 'bar' AND g.city = 'oakland' AND g.review = 2.7;
```
-------------------------1758 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE g.food_type = 'bakery' 
AND l.street_name = 'University Avenue' 
AND l.city = 'Palo Alto';
```
-------------------------1759 sample_num
```sql
SELECT l.street_num 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE g.label = 'Tulocay Winery' AND g.food_type = 'winery';
```
-------------------------1760 sample_num
```sql
SELECT g.review, g.label 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE l.street_name = 'mission blvd' AND l.city = 'hayward';
```
-------------------------1761 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE g.food_type = 'indian' 
AND l.street_name = 'castro st' 
AND l.city = 'mountainview' 
AND g.label LIKE '%cookhouse%';
```
-------------------------1762 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE g.review = 2 AND l.street_num < 500;
```
-------------------------1763 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE g.food_type = 'asian' 
AND l.street_name = 'n milpitas blvd' 
AND l.city = 'milpitas' 
AND g.id_restaurant > 385;
```
-------------------------1764 sample_num
```sql
SELECT gi.label, gi.id_restaurant 
FROM generalinfo gi 
JOIN location l ON gi.id_restaurant = l.id_restaurant 
WHERE l.street_name = 'Ocean Avenue' AND l.city = 'San Francisco';
```
-------------------------1765 sample_num
```sql
SELECT CONCAT(l.street_num, ' ', l.street_name, ', ', l.city) AS full_address
FROM generalinfo g
JOIN location l ON g.id_restaurant = l.id_restaurant
WHERE g.label = 'Sanuki Restaurant';
```
-------------------------1766 sample_num
```sql
SELECT gi.food_type 
FROM generalinfo gi 
JOIN location l ON gi.id_restaurant = l.id_restaurant 
WHERE l.street_num = 22779 AND l.street_name = '6th St.' AND l.city = 'Hayward City';
```
-------------------------1767 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE g.food_type = 'american' 
AND l.street_name = 'front' 
AND l.city = 'san francisco';
```
-------------------------1768 sample_num
```sql
SELECT gi.id_restaurant
FROM generalinfo gi
JOIN location l ON gi.id_restaurant = l.id_restaurant
WHERE gi.food_type = 'american'
  AND l.street_num > 2000
  AND gi.review > (SELECT AVG(review) * 0.7 FROM generalinfo WHERE food_type = 'american');
```
-------------------------1769 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN gi.food_type = 'afghani' THEN 1 END) * 100.0 / COUNT(*)) AS afghani_percentage
FROM 
    location l
JOIN 
    generalinfo gi ON l.id_restaurant = gi.id_restaurant
WHERE 
    l.street_num BETWEEN 1000 AND 2000;
```
-------------------------1770 sample_num
```sql
SELECT label 
FROM generalinfo 
WHERE food_type = 'asian' AND city = 'san francisco' 
ORDER BY review DESC 
LIMIT 1;
```
-------------------------1771 sample_num
```sql
SELECT COUNT(DISTINCT city) 
FROM geographic 
WHERE region = 'monterey';
```
-------------------------1772 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo 
WHERE food_type = 'deli' AND city = 'belmont' AND review > 2;
```
-------------------------1773 sample_num
```sql
SELECT county
FROM geographic
WHERE region = 'northern california'
GROUP BY county
ORDER BY COUNT(DISTINCT city) DESC
LIMIT 1;
```
-------------------------1774 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo 
WHERE city = 'concord';
```
-------------------------1775 sample_num
```sql
SELECT g.region
FROM generalinfo gi
JOIN geographic g ON gi.city = g.city
ORDER BY gi.review DESC
LIMIT 4;
```
-------------------------1776 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo gi 
JOIN location l ON gi.id_restaurant = l.id_restaurant 
WHERE gi.food_type = 'chinese' 
AND l.street_name = '1st st' 
AND l.city = 'livermore';
```
-------------------------1777 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo g 
JOIN geographic geo ON g.city = geo.city 
WHERE g.food_type = 'indian' AND geo.region = 'los angeles area';
```
-------------------------1778 sample_num
```sql
SELECT food_type
FROM generalinfo g
JOIN geographic geo ON g.city = geo.city
WHERE geo.region = 'bay area'
GROUP BY food_type
ORDER BY COUNT(food_type) DESC
LIMIT 1;
```
-------------------------1779 sample_num
```sql
SELECT COUNT(*) 
FROM generalinfo g 
JOIN location l ON g.id_restaurant = l.id_restaurant 
WHERE l.street_name = 'broadway' AND l.city = 'oakland' AND g.review < 3;
```
-------------------------1780 sample_num
```sql
SELECT g.region
FROM geographic g
JOIN generalinfo gi ON g.city = gi.city
WHERE gi.label = 'baskin robbins'
GROUP BY g.region
ORDER BY COUNT(gi.city) DESC
LIMIT 1;
```
-------------------------1781 sample_num
```sql
SELECT DISTINCT l.street_name
FROM location l
JOIN generalinfo g ON l.id_restaurant = g.id_restaurant
WHERE g.food_type = 'pizza' AND l.city = 'san jose';
```
-------------------------1782 sample_num
```sql
SELECT COUNT(DISTINCT gi.food_type) AS restaurant_types
FROM generalinfo gi
JOIN geographic g ON gi.city = g.city
WHERE g.region IN ('Yosemite', 'Mono Lake');
```
-------------------------1783 sample_num
```sql
SELECT CONCAT(l.street_num, ' ', l.street_name, ', ', l.city) AS full_address
FROM generalinfo g
JOIN location l ON g.id_restaurant = l.id_restaurant
WHERE g.review = (SELECT MAX(review) FROM generalinfo);
```
-------------------------1784 sample_num
```sql
SELECT g.county
FROM geographic g
JOIN location l ON g.city = l.city
JOIN generalinfo gi ON l.id_restaurant = gi.id_restaurant
WHERE gi.label = (
    SELECT gi2.label
    FROM generalinfo gi2
    GROUP BY gi2.label
    ORDER BY COUNT(gi2.city) DESC
    LIMIT 1
);
```
-------------------------1785 sample_num
```sql
SELECT g.region
FROM geographic g
JOIN generalinfo gi ON g.city = gi.city
GROUP BY g.region
ORDER BY COUNT(gi.id_restaurant) DESC
LIMIT 1;
```
-------------------------1786 sample_num
```sql
SELECT l.street_num, l.street_name, l.city
FROM generalinfo g
JOIN location l ON g.id_restaurant = l.id_restaurant
WHERE g.food_type = 'american' AND g.review >= 4;
```
-------------------------1787 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE SUBSTR(DOB, 1, 4) > '1985';
```
-------------------------1788 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE SUBSTR(Match_Date, 1, 4) = '2008' AND SUBSTR(Match_Date, 6, 2) = '05';
```
-------------------------1789 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Man_of_the_Match = 41;
```
-------------------------1790 sample_num
```sql
SELECT Match_Id 
FROM Match 
WHERE SUBSTR(Match_Date, 1, 4) = '2008';
```
-------------------------1791 sample_num
```sql
SELECT COUNT(*) FROM Player WHERE Country_Name = 'Australia';
```
-------------------------1792 sample_num
```sql
SELECT Country_Name 
FROM Player 
WHERE DOB = (SELECT MIN(DOB) FROM Player);
```
-------------------------1793 sample_num
```sql
SELECT Bowling_skill 
FROM Player 
WHERE Player_Name = 'SC Ganguly';
```
-------------------------1794 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE Batting_hand = 'Right-hand bat' AND SUBSTR(DOB, 1, 4) > 1985;
```
-------------------------1795 sample_num
```sql
SELECT Player_Name 
FROM Player 
WHERE Batting_hand = 'Right-hand bat' AND Country_Name = 'Australia';
```
-------------------------1796 sample_num
```sql
SELECT Bowling_skill 
FROM Player 
WHERE Country_Name = 'Australia';
```
-------------------------1797 sample_num
```sql
SELECT MIN(DOB) AS Oldest_Bowler_Birthdate
FROM Player
WHERE Bowling_skill = 'Legbreak';
```
-------------------------1798 sample_num
```sql
SELECT Bowling_skill
FROM Player
GROUP BY Bowling_skill
ORDER BY COUNT(Bowling_skill) DESC
LIMIT 1;
```
-------------------------1799 sample_num
```sql
SELECT Player_Name 
FROM Player 
JOIN Match ON Player_Match.Match_Id = Match.Match_Id 
JOIN Player_Match ON Match.Match_Id = Player_Match.Match_Id 
WHERE Match_Date = '2008-04-18' AND Player_Match.Role_Id = (SELECT Role_Id FROM Rolee WHERE Role_Desc = 'Man of the Match');
```
-------------------------1800 sample_num
```sql
SELECT COUNT(*) 
FROM Player_Match pm 
JOIN Player p ON pm.Player_Id = p.Player_Id 
JOIN Rolee r ON pm.Role_Id = r.Role_Id 
WHERE p.Player_Name = 'SC Ganguly' AND r.Role_Desc = 'Captain';
```
-------------------------1801 sample_num
```sql
SELECT r.Role_Desc 
FROM Player_Match pm 
JOIN Player p ON pm.Player_Id = p.Player_Id 
JOIN Rolee r ON pm.Role_Id = r.Role_Id 
JOIN Match m ON pm.Match_Id = m.Match_Id 
WHERE p.Player_Name = 'SC Ganguly' AND m.Match_Date = '2008-04-18';
```
-------------------------1802 sample_num
```sql
SELECT MAX(M.Win_Margin) AS Highest_Winning_Margin
FROM Match M
JOIN Player_Match PM ON M.Match_Id = PM.Match_Id
JOIN Player P ON PM.Player_Id = P.Player_Id
WHERE P.Player_Name = 'SC Ganguly';
```
-------------------------1803 sample_num
```sql
SELECT AVG(Win_Margin) AS Average_Winning_Margin
FROM Match
WHERE Match_Id IN (
    SELECT Match_Id
    FROM Player_Match
    WHERE Player_Id = (
        SELECT Player_Id
        FROM Player
        WHERE Player_Name = 'SC Ganguly'
    )
);
```
-------------------------1804 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Batting_hand = 'Right-hand bat' THEN 1 END) * 100.0 / COUNT(Player_Id)) AS Right_Hand_Batting_Percentage
FROM 
    Player
WHERE 
    SUBSTR(DOB, 1, 4) > 1985;
```
-------------------------1805 sample_num
```sql
SELECT Player_Name 
FROM Player 
WHERE DOB = (SELECT MAX(DOB) FROM Player);
```
-------------------------1806 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Toss_Winner = (SELECT Team_Id FROM Team WHERE Team_Name = 'Sunrisers Hyderabad');
```
-------------------------1807 sample_num
```sql
SELECT Striker 
FROM Ball_by_Ball 
WHERE Match_Id = 419169 AND Over_Id = 3 AND Ball_Id = 2 AND Innings_No = 2;
```
-------------------------1808 sample_num
```sql
SELECT Venue_Name 
FROM Venue 
JOIN Match ON Venue.Venue_Id = Match.Venue_Id 
WHERE Match.Win_Margin = 138;
```
-------------------------1809 sample_num
```sql
SELECT Player_Name 
FROM Player 
JOIN Match ON Player_Match.Match_Id = Match.Match_Id 
JOIN Player_Match ON Player.Player_Id = Player_Match.Player_Id 
WHERE Match.Match_Date = '2008-05-12' AND Match.Man_of_the_Match = Player.Player_Id;
```
-------------------------1810 sample_num
```sql
SELECT p.Player_Name 
FROM Player p 
JOIN Player_Match pm ON p.Player_Id = pm.Player_Id 
JOIN Rolee r ON pm.Role_Id = r.Role_Id 
WHERE pm.Match_Id = '419117' AND r.Role_Desc = 'CaptainKeeper';
```
-------------------------1811 sample_num
```sql
SELECT Man_of_the_Series 
FROM Season 
WHERE Season_Year = 2013;
```
-------------------------1812 sample_num
```sql
SELECT DOB 
FROM Player 
WHERE Player_Id = (SELECT Orange_Cap 
                   FROM Season 
                   WHERE Season_Year = 2014 AND Orange_Cap IS NOT NULL);
```
-------------------------1813 sample_num
```sql
SELECT Country_Name 
FROM Player 
WHERE Player_Id = (SELECT Purple_Cap 
                   FROM Season 
                   WHERE Season_Id = 7);
```
-------------------------1814 sample_num
```sql
SELECT Country_Name 
FROM Country 
JOIN City ON Country.Country_Id = City.Country_id 
WHERE City_Name = 'Ranchi';
```
-------------------------1815 sample_num
```sql
SELECT COUNT(*) 
FROM City 
WHERE Country_id = (SELECT Country_Id FROM Country WHERE Country_Name = 'India');
```
-------------------------1816 sample_num
```sql
SELECT City_Name 
FROM City 
JOIN Venue ON City.City_Id = Venue.City_Id 
GROUP BY City_Name 
ORDER BY COUNT(Venue.Venue_Id) DESC 
LIMIT 1;
```
-------------------------1817 sample_num
```sql
SELECT Batting_hand 
FROM Player 
WHERE Player_Name = 'MK Pandey';
```
-------------------------1818 sample_num
```sql
SELECT 
    (SELECT COUNT(City_Id) FROM City WHERE Country_id = (SELECT Country_Id FROM Country WHERE Country_Name = 'India')) /
    (SELECT COUNT(City_Id) FROM City WHERE Country_id = (SELECT Country_Id FROM Country WHERE Country_Name = 'South Africa')) AS Ratio;
```
-------------------------1819 sample_num
```sql
SELECT 
    (SELECT COUNT(Match_Id) FROM Match WHERE Venue_Id = (SELECT Venue_Id FROM Venue WHERE Venue_Name = 'M Chinnaswamy Stadium')) / 
    (SELECT COUNT(Match_Id) FROM Match WHERE Venue_Id = (SELECT Venue_Id FROM Venue WHERE Venue_Name = 'Maharashtra Cricket Association Stadium')) AS Times_Hosted;
```
-------------------------1820 sample_num
```sql
SELECT Player_Name 
FROM Player 
ORDER BY DOB ASC 
LIMIT 1;
```
-------------------------1821 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE SUBSTR(Match_Date, 1, 4) = '2008' AND SUBSTR(Match_Date, 6, 2) = '05';
```
-------------------------1822 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE DOB >= '1990-01-01' AND DOB <= '1999-12-31';
```
-------------------------1823 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE (Team_1 = 10 OR Team_2 = 10) 
AND SUBSTR(Match_Date, 1, 4) = '2012';
```
-------------------------1824 sample_num
```sql
SELECT Player_Id
FROM Season
JOIN Player ON Player.Player_Name = Season.Orange_Cap
GROUP BY Player_Id
HAVING COUNT(Season_Year) > 1;
```
-------------------------1825 sample_num
```sql
SELECT COUNT(*) AS Matches_Played
FROM Match
WHERE Season_Id = 7;
```
-------------------------1826 sample_num
```sql
SELECT COUNT(*) 
FROM Umpire 
WHERE Umpire_Country = 'South Africa';
```
-------------------------1827 sample_num
```sql
SELECT Player_Name
FROM Player
WHERE Player_Id = (
    SELECT Player_Id
    FROM Player_Match
    GROUP BY Player_Id
    ORDER BY COUNT(Role_Id) DESC
    LIMIT 1
);
```
-------------------------1828 sample_num
```sql
SELECT Country_Name
FROM Player
GROUP BY Country_Name
ORDER BY COUNT(Country_Name) DESC
LIMIT 1;
```
-------------------------1829 sample_num
```sql
SELECT COUNT(*) 
FROM Season 
WHERE Man_of_the_Series = 'CH Gayle';
```
-------------------------1830 sample_num
```sql
SELECT Season_Id
FROM Match
WHERE Venue_Id = (SELECT Venue_Id FROM Venue WHERE Venue_Name = 'M Chinnaswamy Stadium')
GROUP BY Season_Id
ORDER BY COUNT(Match_Id) DESC
LIMIT 1;
```
-------------------------1831 sample_num
```sql
SELECT Team_Name
FROM Match
JOIN Team ON Match.Match_Winner = Team.Team_Id
WHERE Season_Id = 1
GROUP BY Team_Name
ORDER BY COUNT(Match_Winner) DESC
LIMIT 1;
```
-------------------------1832 sample_num
```sql
SELECT v.Venue_Name
FROM Match m
JOIN Venue v ON m.Venue_Id = v.Venue_Id
WHERE m.Team_1 = 'Kolkata Knight Riders'
GROUP BY v.Venue_Name
ORDER BY COUNT(m.Match_Id) DESC
LIMIT 1;
```
-------------------------1833 sample_num
```sql
SELECT Team_Name, COUNT(*) AS Losses
FROM Match
JOIN Team ON Team.Team_Id IN (Team_1, Team_2)
WHERE (Team_1 = Match_Winner AND Team_2 <> Match_Winner) OR (Team_2 = Match_Winner AND Team_1 <> Match_Winner)
GROUP BY Team_Name
ORDER BY Losses DESC
LIMIT 1;
```
-------------------------1834 sample_num
```sql
SELECT Player_Name 
FROM Player 
JOIN Match ON Player.Player_Id = Match.Man_of_the_Match 
WHERE Match.Match_Date = (SELECT MIN(Match_Date) FROM Match);
```
-------------------------1835 sample_num
```sql
SELECT MIN(Match_Date) AS First_Match_Date
FROM Match
WHERE Team_1 = 'Chennai Super Kings' OR Team_2 = 'Chennai Super Kings';
```
-------------------------1836 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE Batting_hand = 'Left-hand bat' AND Country_Name = 'India';
```
-------------------------1837 sample_num
```sql
SELECT Player_Name
FROM Player p
JOIN Player_Match pm ON p.Player_Id = pm.Player_Id
JOIN Rolee r ON pm.Role_Id = r.Role_Id
JOIN Team t ON pm.Team_Id = t.Team_Id
WHERE r.Role_Desc = 'Captain' AND t.Team_Name = 'Deccan Chargers'
GROUP BY Player_Name
ORDER BY COUNT(pm.Role_Id) DESC
LIMIT 1;
```
-------------------------1838 sample_num
```sql
SELECT (COUNT(CASE WHEN Batting_hand = 'Right-hand bat' THEN Player_Id END) * 100.0 / COUNT(Player_Id)) AS Right_Handed_Percentage
FROM Player;
```
-------------------------1839 sample_num
```sql
SELECT Player_Name FROM Player WHERE DOB = '1981-07-07';
```
-------------------------1840 sample_num
```sql
SELECT COUNT(*) AS Matches_Played
FROM Player_Match
WHERE Player_Id = 2;
```
-------------------------1841 sample_num
```sql
SELECT T1.Team_Name
FROM Match M
JOIN Team T1 ON M.Team_1 = T1.Team_Id
WHERE M.Win_Margin = (SELECT MAX(Win_Margin) FROM Match);
```
-------------------------1842 sample_num
```sql
SELECT Country_Name 
FROM Country 
JOIN City ON Country.Country_Id = City.Country_id 
JOIN Venue ON City.City_Id = Venue.City_Id 
WHERE Venue.Venue_Name = 'St George''s Park';
```
-------------------------1843 sample_num
```sql
SELECT P.Player_Name 
FROM Player P
JOIN Player_Match PM ON P.Player_Id = PM.Player_Id
WHERE PM.Team_Id = (SELECT Team_Id FROM Team WHERE Team_Name = 'Mumbai Indians')
AND PM.Match_Id = 335990;
```
-------------------------1844 sample_num
```sql
SELECT Team_Name 
FROM Team 
WHERE Team_Id = (
    SELECT Match_Winner 
    FROM Match 
    WHERE Win_Margin = 7 AND Match_Date = '2009-05-07'
);
```
-------------------------1845 sample_num
```sql
SELECT COUNT(*) AS Superover_Match_Count
FROM Match
WHERE Outcome_type = 'Superover';
```
-------------------------1846 sample_num
```sql
SELECT City_Name 
FROM City 
WHERE Country_id = (SELECT Country_Id FROM Country WHERE Country_Name = 'U.A.E');
```
-------------------------1847 sample_num
```sql
SELECT COUNT(*) AS Total_Won_Matches
FROM Match
WHERE Match_Winner = (SELECT Team_Id FROM Team WHERE Team_Name = 'Pune Warriors');
```
-------------------------1848 sample_num
```sql
SELECT Match_Winner 
FROM Match 
WHERE Match_Id = 829768 AND Match_Date LIKE '2015%';
```
-------------------------1849 sample_num
```sql
SELECT r.Role_Desc 
FROM Player_Match pm 
JOIN Rolee r ON pm.Role_Id = r.Role_Id 
JOIN Player p ON pm.Player_Id = p.Player_Id 
WHERE p.Player_Name = 'K Goel' AND pm.Match_Id = 335992;
```
-------------------------1850 sample_num
```sql
SELECT COUNT(*) 
FROM City 
WHERE Country_id = (SELECT Country_Id FROM Country WHERE Country_Name = 'South Africa');
```
-------------------------1851 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Venue_Id IN (SELECT Venue_Id FROM Venue WHERE Venue_Name = 'Newlands');
```
-------------------------1852 sample_num
```sql
SELECT Win_Margin 
FROM Match 
WHERE (Team_1 = 'Mumbai Indians' AND Team_2 = 'Royal Challengers Bangalore' OR Team_1 = 'Royal Challengers Bangalore' AND Team_2 = 'Mumbai Indians') 
AND Match_Date = '2008-05-28';
```
-------------------------1853 sample_num
```sql
SELECT Team_1, Team_2
FROM Match
WHERE Match_Date LIKE '2011%'
AND Win_Margin < (SELECT AVG(Win_Margin) * 0.3 FROM Match WHERE Match_Date LIKE '2011%');
```
-------------------------1854 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN r.Role_Desc = 'Captain' THEN 1 END) * 100.0 / COUNT(*)) AS Captain_Percentage
FROM 
    Player p
JOIN 
    Player_Match pm ON p.Player_Id = pm.Player_Id
JOIN 
    Rolee r ON pm.Role_Id = r.Role_Id
WHERE 
    p.DOB LIKE '1977%';
```
-------------------------1855 sample_num
```sql
SELECT COUNT(DISTINCT Over_Id) AS Total_Overs
FROM Ball_by_Ball
WHERE Match_Id = 335996 AND Innings_No = 1;
```
-------------------------1856 sample_num
```sql
SELECT Over_Id, Ball_Id, Innings_No
FROM Batsman_Scored
WHERE Match_Id = 336004 AND Runs_Scored = (
    SELECT MAX(Runs_Scored)
    FROM Batsman_Scored
    WHERE Match_Id = 336004
);
```
-------------------------1857 sample_num
```sql
SELECT Match_Id 
FROM Ball_by_Ball 
WHERE Over_Id > 20 
LIMIT 5;
```
-------------------------1858 sample_num
```sql
SELECT COUNT(*) 
FROM Wicket_Taken 
WHERE Match_Id = 548335 AND Innings_No = 1;
```
-------------------------1859 sample_num
```sql
SELECT Player_Name FROM Player WHERE DOB LIKE '1971%';
```
-------------------------1860 sample_num
```sql
SELECT Match_Id FROM Match WHERE DATE(Match_Date) = '2015-04-18';
```
-------------------------1861 sample_num
```sql
SELECT DISTINCT Match_Id 
FROM Wicket_Taken 
WHERE Kind_Out = (SELECT Out_Id FROM Out_Type WHERE Out_Name = 'hit wicket');
```
-------------------------1862 sample_num
```sql
SELECT COUNT(*) 
FROM Wicket_Taken 
WHERE Kind_Out = (SELECT Out_Id FROM Out_Type WHERE Out_Name = 'stumped') 
AND Innings_No = 2;
```
-------------------------1863 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Man_of_the_Match = (SELECT Player_Id FROM Player WHERE Player_Name = 'Yuvraj Singh');
```
-------------------------1864 sample_num
```sql
SELECT Player_Name, DOB 
FROM Player 
WHERE DOB LIKE '1977%' AND Country_Name = 'England';
```
-------------------------1865 sample_num
```sql
SELECT Man_of_the_Series 
FROM Season 
WHERE Season_Year = 2010;
```
-------------------------1866 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Match_Winner = (SELECT Team_Id FROM Team WHERE Team_Name = 'Chennai Super Kings') THEN 1 END) * 100.0 / COUNT(Match_Id)) AS Win_Rate
FROM 
    Match;
```
-------------------------1867 sample_num
```sql
SELECT p.Player_Name, p.Country_Name
FROM Player p
JOIN Player_Match pm ON p.Player_Id = pm.Player_Id
JOIN Match m ON pm.Match_Id = m.Match_Id
JOIN Team t ON pm.Team_Id = t.Team_Id
WHERE t.Team_Name = 'Gujarat Lions' AND m.Match_Date = '2016-04-11';
```
-------------------------1868 sample_num
```sql
SELECT Player_Name, DOB 
FROM Player 
WHERE Bowling_skill = 'Left-arm fast';
```
-------------------------1869 sample_num
```sql
SELECT Umpire_Country 
FROM Umpire 
WHERE Umpire_Name = 'BR Doctrove';
```
-------------------------1870 sample_num
```sql
SELECT p.Player_Name 
FROM Player p
JOIN Player_Match pm ON p.Player_Id = pm.Player_Id
JOIN Match m ON pm.Match_Id = m.Match_Id
JOIN Rolee r ON pm.Role_Id = r.Role_Id
WHERE m.Match_Date = '2008-06-01' 
AND m.Match_Winner = pm.Team_Id 
AND r.Role_Desc = 'Captain';
```
-------------------------1871 sample_num
```sql
SELECT T.Team_Name, COUNT(PM.Match_Id) AS Matches_Played
FROM Player P
JOIN Player_Match PM ON P.Player_Id = PM.Player_Id
JOIN Team T ON PM.Team_Id = T.Team_Id
WHERE P.Player_Name = 'CK Kapugedera'
GROUP BY T.Team_Name;
```
-------------------------1872 sample_num
```sql
SELECT (COUNT(CASE WHEN v.Venue_Name = 'Wankhede Stadium' THEN m.Match_Id END) * 100.0 / COUNT(m.Match_Id)) AS Percentage
FROM Match m
JOIN Venue v ON m.Venue_Id = v.Venue_Id
JOIN City c ON v.City_Id = c.City_Id
WHERE c.City_Name = 'Mumbai';
```
-------------------------1873 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN o.Out_Name = 'bowled' THEN 1 END) * 100.0 / COUNT(w.Player_Out)) AS Percentage_Out_By_Bowl
FROM 
    Wicket_Taken w
JOIN 
    Out_Type o ON w.Kind_Out = o.Out_Id
WHERE 
    w.Match_Id = 392187;
```
-------------------------1874 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Toss_Name = 'field' THEN 1 END) * 100.0 / COUNT(*)) AS Percent_Bowl_First
FROM 
    Match 
JOIN 
    Toss_Decision ON Match.Toss_Decide = Toss_Decision.Toss_Id
WHERE 
    Match_Date BETWEEN '2010-01-01' AND '2016-12-31';
```
-------------------------1875 sample_num
```sql
SELECT Toss_Winner 
FROM Match 
WHERE Toss_Decide = 2;
```
-------------------------1876 sample_num
```sql
SELECT Match_Id 
FROM Match 
WHERE Man_of_the_Match = 'BB McCullum';
```
-------------------------1877 sample_num
```sql
SELECT p.DOB
FROM Player p
JOIN Match m ON p.Player_Id = m.Man_of_the_Match;
```
-------------------------1878 sample_num
```sql
SELECT Team_Name 
FROM Match 
JOIN Team ON Match.Toss_Winner = Team.Team_Id 
WHERE Match.Match_Id BETWEEN 336010 AND 336020;
```
-------------------------1879 sample_num
```sql
SELECT COUNT(*) AS Matches_Won
FROM Match
WHERE Match_Winner = 'Mumbai Indians';
```
-------------------------1880 sample_num
```sql
SELECT DISTINCT Team_2 
FROM Match 
WHERE Team_1 = 'Pune Warriors' OR Team_2 = 'Pune Warriors';
```
-------------------------1881 sample_num
```sql
SELECT Team_Name 
FROM Team 
WHERE Team_Id = (SELECT Match_Winner FROM Match WHERE Match_Id = 336000);
```
-------------------------1882 sample_num
```sql
SELECT Match_Id 
FROM Match 
WHERE Venue_Id IN (SELECT Venue_Id FROM Venue WHERE Venue_Name = 'Brabourne Stadium');
```
-------------------------1883 sample_num
```sql
SELECT Venue_Name 
FROM Venue 
WHERE Venue_Id IN (
    SELECT Venue_Id 
    FROM Match 
    WHERE Season_Id = 2
);
```
-------------------------1884 sample_num
```sql
SELECT City_Name 
FROM City 
JOIN Venue ON City.City_Id = Venue.City_Id 
WHERE Venue.Venue_Name = 'M Chinnaswamy Stadium';
```
-------------------------1885 sample_num
```sql
SELECT Venue_Name 
FROM Venue 
WHERE City_Id = (SELECT City_Id FROM City WHERE City_Name = 'Mumbai');
```
-------------------------1886 sample_num
```sql
SELECT DISTINCT Match_Winner 
FROM Match 
JOIN Venue ON Match.Venue_Id = Venue.Venue_Id 
WHERE Venue.Venue_Name LIKE 'St George%';
```
-------------------------1887 sample_num
```sql
SELECT COUNT(*) > 0 AS IsSuperSportParkInCenturion
FROM Venue v
JOIN City c ON v.City_Id = c.City_Id
WHERE v.Venue_Name = 'SuperSport Park' AND c.City_Name = 'Centurion';
```
-------------------------1888 sample_num
```sql
SELECT COUNT(*) AS Total_Winning_Matches
FROM Match
WHERE Match_Winner = 'Deccan Chargers';
```
-------------------------1889 sample_num
```sql
SELECT COUNT(*) 
FROM Venue 
WHERE City_Id = (SELECT City_Id FROM City WHERE City_Name = 'Pune');
```
-------------------------1890 sample_num
```sql
SELECT Non_Striker, COUNT(*) AS Balls_Played
FROM Ball_by_Ball
WHERE Match_Id = 501219
GROUP BY Non_Striker
ORDER BY Balls_Played DESC
LIMIT 1;
```
-------------------------1891 sample_num
```sql
SELECT 
    (SUM(Over_Id) / SUM(Runs_Scored)) * 100 AS average_percentage
FROM 
    Batsman_Scored
WHERE 
    Innings_No = 1 AND Over_Id > 1 AND Over_Id < 25;
```
-------------------------1892 sample_num
```sql
SELECT AVG(Extra_Runs) AS Average_Extra_Runs
FROM Extra_Runs
WHERE Innings_No = 2
GROUP BY Match_Id;
```
-------------------------1893 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Win_Margin > 100 THEN Match_Id END) * 100.0 / COUNT(Match_Id)) AS percentage
FROM 
    Match;
```
-------------------------1894 sample_num
```sql
SELECT Player_Name 
FROM Player 
WHERE DOB BETWEEN '1970-01-01' AND '1990-12-31' 
ORDER BY DOB ASC;
```
-------------------------1895 sample_num
```sql
SELECT COUNT(*) AS Wickets_Without_Fielders
FROM Wicket_Taken
WHERE Over_Id = 3 AND Fielders = '';
```
-------------------------1896 sample_num
```sql
SELECT Umpire_Country, COUNT(Umpire_Id) AS Umpire_Count
FROM Umpire
GROUP BY Umpire_Country
ORDER BY Umpire_Count DESC
LIMIT 1;
```
-------------------------1897 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Role_Desc = 'CaptainKeeper' THEN Player_Id END) * 100.0 / COUNT(Player_Id)) AS percentage
FROM 
    Player_Match 
JOIN 
    Rolee ON Player_Match.Role_Id = Rolee.Role_Id;
```
-------------------------1898 sample_num
```sql
SELECT COUNT(*) 
FROM Wicket_Taken 
WHERE Kind_Out = (SELECT Out_Id FROM Out_Type WHERE Out_Name = 'hit wicket');
```
-------------------------1899 sample_num
```sql
SELECT Country_Name, AVG(Right_Hand_Batsmen) AS Average_Right_Hand_Batsmen
FROM (
    SELECT Country_Name, COUNT(Player_Id) AS Right_Hand_Batsmen
    FROM Player
    WHERE Batting_hand = 'Right-hand bat'
    GROUP BY Country_Name
) AS RightHandCounts
JOIN (
    SELECT Country_Name, COUNT(DISTINCT Player_Id) AS Total_Players
    FROM Player
    GROUP BY Country_Name
) AS TotalCounts ON RightHandCounts.Country_Name = TotalCounts.Country_Name
GROUP BY RightHandCounts.Country_Name;
```
-------------------------1900 sample_num
```sql
SELECT 
    (SUM(CASE WHEN Bowling_skill = 'Legbreak' THEN 1 ELSE 0 END) * 100.0 / COUNT(Player_Id)) AS percentage
FROM 
    Player;
```
-------------------------1901 sample_num
```sql
SELECT COUNT(*) AS Teams_Won_By_Wicket
FROM Match
WHERE Win_Margin < 50 AND Win_Type = 'wickets';
```
-------------------------1902 sample_num
```sql
SELECT COUNT(DISTINCT Venue_Id) 
FROM Match 
WHERE Toss_Winner = 'Team_2' AND Match_Winner = 'Team_1';
```
-------------------------1903 sample_num
```sql
SELECT Player_Name, Country_Name 
FROM Player 
WHERE Player_Id = (SELECT Man_of_the_Series 
                   FROM Season 
                   WHERE Season_Year = 2012);
```
-------------------------1904 sample_num
```sql
SELECT Venue_Name 
FROM Venue 
JOIN Match ON Venue.Venue_Id = Match.Venue_Id 
GROUP BY Venue_Name 
ORDER BY COUNT(Match.Match_Id) DESC 
LIMIT 1;
```
-------------------------1905 sample_num
```sql
SELECT c.City_Name
FROM City c
JOIN Venue v ON c.City_Id = v.City_Id
JOIN Match m ON v.Venue_Id = m.Venue_Id
WHERE m.Win_Type = 'NoResult'
GROUP BY c.City_Name
ORDER BY COUNT(m.Win_Type) ASC
LIMIT 1;
```
-------------------------1906 sample_num
```sql
SELECT Player_Name
FROM Season s
JOIN Player p ON s.Man_of_the_Series = p.Player_Id
GROUP BY p.Player_Name
HAVING COUNT(s.Man_of_the_Series) > 1;
```
-------------------------1907 sample_num
```sql
SELECT Player_Name, Country_Name
FROM Player
JOIN Wicket_Taken ON Player.Player_Id = Wicket_Taken.Player_Out
JOIN Out_Type ON Wicket_Taken.Kind_Out = Out_Type.Out_Id
WHERE Out_Type.Out_Name = 'caught'
GROUP BY Player.Player_Id, Player_Name, Country_Name
HAVING COUNT(Wicket_Taken.Player_Out) > (SELECT AVG(Catch_Count) FROM (SELECT COUNT(Player_Out) AS Catch_Count FROM Wicket_Taken JOIN Out_Type ON Wicket_Taken.Kind_Out = Out_Type.Out_Id WHERE Out_Type.Out_Name = 'caught' GROUP BY Player_Out) AS AvgCatches)
ORDER BY COUNT(Wicket_Taken.Player_Out) ASC;
```
-------------------------1908 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN M.Match_Winner = M.Team_1 AND M.Toss_Winner = M.Team_1 AND T.Toss_Name = 'field' THEN 1 END) * 100.0) / 
    COUNT(CASE WHEN M.Win_Type = 'runs' AND M.Match_Winner = M.Team_1 THEN 1 END) AS percentage
FROM 
    Match M
JOIN 
    Toss_Decision T ON M.Toss_Decide = T.Toss_Id
WHERE 
    M.Win_Type = 'runs';
```
-------------------------1909 sample_num
```sql
SELECT 
    AVG(CASE WHEN Out_Id = 4 THEN Player_Out END) - 
    AVG(CASE WHEN Out_Id = 3 THEN Player_Out END) AS Difference_Average_Outs
FROM 
    Wicket_Taken;
```
-------------------------1910 sample_num
```sql
SELECT DISTINCT Over_Id 
FROM Ball_by_Ball 
WHERE Striker = 7;
```
-------------------------1911 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Toss_Winner = Team_1 AND Toss_Decide = 2;
```
-------------------------1912 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Match_Date LIKE '2010-03%';
```
-------------------------1913 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE DOB < (SELECT DOB FROM Player WHERE Player_Name = 'Gurkeerat Singh');
```
-------------------------1914 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Man_of_the_Match = 'SR Watson';
```
-------------------------1915 sample_num
```sql
SELECT Player_Name
FROM Player p
JOIN Player_Match pm ON p.Player_Id = pm.Player_Id
JOIN Team t ON pm.Team_Id = t.Team_Id
WHERE t.Team_Name = 'Delhi Daredevils'
GROUP BY p.Player_Id, p.Player_Name
HAVING COUNT(pm.Role_Id) = (
    SELECT MAX(role_count)
    FROM (
        SELECT COUNT(Role_Id) AS role_count
        FROM Player_Match
        WHERE Team_Id = (SELECT Team_Id FROM Team WHERE Team_Name = 'Delhi Daredevils')
        GROUP BY Player_Id
    ) AS role_counts
);
```
-------------------------1916 sample_num
```sql
SELECT Player_Name
FROM Player
JOIN Player_Match ON Player.Player_Id = Player_Match.Player_Id
JOIN Season ON Player_Match.Match_Id = Season.Season_Id
WHERE Season.Man_of_the_Series IS NOT NULL
GROUP BY Player_Name
ORDER BY COUNT(Season.Man_of_the_Series) DESC
LIMIT 1;
```
-------------------------1917 sample_num
```sql
SELECT Season_Year 
FROM Season 
WHERE Orange_Cap = 'SP Narine';
```
-------------------------1918 sample_num
```sql
SELECT DISTINCT t.Team_Name
FROM Team t
JOIN Player_Match pm1 ON t.Team_Id = pm1.Team_Id
JOIN Season s1 ON pm1.Season_Id = s1.Season_Id
JOIN Player p1 ON pm1.Player_Id = p1.Player_Id
JOIN Season s2 ON s1.Season_Id = s2.Season_Id
JOIN Player_Match pm2 ON t.Team_Id = pm2.Team_Id
JOIN Player p2 ON pm2.Player_Id = p2.Player_Id
WHERE s1.Purple_Cap = p1.Player_Name AND s2.Orange_Cap = p2.Player_Name;
```
-------------------------1919 sample_num
```sql
SELECT Player_Name FROM Player WHERE Country_Name = 'Zimbabwea';
```
-------------------------1920 sample_num
```sql
SELECT COUNT(*) AS Left_Hand_Batsmen
FROM Player
WHERE Batting_hand = 'Left-hand bat';
```
-------------------------1921 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Win_Type != 'runs';
```
-------------------------1922 sample_num
```sql
SELECT Umpire_Name 
FROM Umpire 
WHERE Umpire_Country = 'New Zealand';
```
-------------------------1923 sample_num
```sql
SELECT Country_Name
FROM Player
WHERE Bowling_skill = 'Slow left-arm chinaman'
GROUP BY Country_Name
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------1924 sample_num
```sql
SELECT Venue_Id, COUNT(*) AS Match_Count
FROM Match
WHERE Team_1 = 'Kochi Tuskers Kerala' OR Team_2 = 'Kochi Tuskers Kerala'
GROUP BY Venue_Id
ORDER BY Match_Count DESC
LIMIT 1;
```
-------------------------1925 sample_num
```sql
SELECT COUNT(DISTINCT b.Match_Id) AS No_Runs_Scored_Games
FROM Match m
JOIN Ball_by_Ball b ON m.Match_Id = b.Match_Id
JOIN Team t ON (m.Team_1 = t.Team_Id OR m.Team_2 = t.Team_Id)
WHERE t.Team_Name = 'Delhi Daredevils' AND b.Runs_Scored = 0;
```
-------------------------1926 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Win_Margin < 10 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Match
WHERE 
    Venue_Id = (SELECT Venue_Id FROM Venue WHERE Venue_Name = 'Dr DY Patil Sports Academy');
```
-------------------------1927 sample_num
```sql
SELECT AVG(Extra_Runs) AS Average_Noball_Runs
FROM Extra_Runs
WHERE Extra_Type_Id = (SELECT Extra_Id FROM Extra_Type WHERE Extra_Name = 'noballs');
```
-------------------------1928 sample_num
```sql
SELECT Player_Id 
FROM Player 
ORDER BY Bowling_skill DESC 
LIMIT 5;
```
-------------------------1929 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE DOB < '1975-10-16' AND Bowling_skill < 3;
```
-------------------------1930 sample_num
```sql
SELECT Player_Name 
FROM Player 
WHERE DOB = (SELECT MAX(DOB) FROM Player);
```
-------------------------1931 sample_num
```sql
SELECT Player_Id 
FROM Season 
JOIN Player ON Season.Man_of_the_Series = Player.Player_Name 
WHERE Season_Year > 2011 AND Season_Year < 2015;
```
-------------------------1932 sample_num
```sql
SELECT SUM(Runs_Scored) AS Total_Runs
FROM Batsman_Scored
WHERE Match_Id = 335988 AND Innings_No = 2;
```
-------------------------1933 sample_num
```sql
SELECT COUNT(*) 
FROM Batsman_Scored 
WHERE Match_Id > 335989 AND Match_Id < 337000 
AND Runs_Scored > 3 
AND Over_Id = 1 
AND Ball_Id = 1 
AND Innings_No = 1;
```
-------------------------1934 sample_num
```sql
SELECT Match_Id, Match_Date 
FROM Match 
WHERE Venue_Id = (SELECT Venue_Id FROM Venue WHERE Venue_Name = 'Kingsmead') 
AND Match_Date IN (
    SELECT Match_Date 
    FROM Match 
    WHERE Venue_Id = (SELECT Venue_Id FROM Venue WHERE Venue_Name = 'Kingsmead') 
    GROUP BY Match_Date 
    HAVING COUNT(*) >= 3
);
```
-------------------------1935 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Venue_Id = (SELECT Venue_Id FROM Venue WHERE Venue_Name = 'MA Chidambaram Stadium') 
AND Match_Date BETWEEN '2009-05-09' AND '2011-08-08';
```
-------------------------1936 sample_num
```sql
SELECT v.Venue_Name, c.City_Name
FROM Match m
JOIN Venue v ON m.Venue_Id = v.Venue_Id
JOIN City c ON v.City_Id = c.City_Id
WHERE m.Match_Id = '336005';
```
-------------------------1937 sample_num
```sql
SELECT Toss_Winner, Toss_Decide 
FROM Match 
WHERE Match_Id = 336011;
```
-------------------------1938 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE Country_Name = 'South Africa' AND DOB < '1980-04-11';
```
-------------------------1939 sample_num
```sql
SELECT Player_Name 
FROM Player 
WHERE Bowling_skill = 'Legbreak';
```
-------------------------1940 sample_num
```sql
SELECT pm.Match_Id, m.Match_Date, pm.Role_Id
FROM Player_Match pm
JOIN Match m ON pm.Match_Id = m.Match_Id
JOIN Player p ON pm.Player_Id = p.Player_Id
WHERE p.DOB = (SELECT MAX(DOB) FROM Player)
GROUP BY pm.Match_Id, m.Match_Date, pm.Role_Id
ORDER BY m.Match_Date
LIMIT 1;
```
-------------------------1941 sample_num
```sql
SELECT Match_Id 
FROM Match 
WHERE Man_of_the_Match = 'V Kohli';
```
-------------------------1942 sample_num
```sql
SELECT COUNT(DISTINCT Player_Id) AS Australian_Man_of_the_Match
FROM Player_Match pm
JOIN Match m ON pm.Match_Id = m.Match_Id
WHERE m.Match_Date BETWEEN '2011-01-01' AND '2012-12-31'
AND pm.Role_Id = (SELECT Role_Id FROM Rolee WHERE Role_Desc = 'Man of the Match')
AND pm.Team_Id IN (SELECT Team_Id FROM Team WHERE Team_Name = 'Australia');
```
-------------------------1943 sample_num
```sql
SELECT DISTINCT p.Player_Name
FROM Player p
JOIN Player_Match pm ON p.Player_Id = pm.Player_Id
JOIN Season s ON pm.Season_Id = s.Season_Id
WHERE s.Man_of_the_Series = p.Player_Name AND s.Orange_Cap = p.Player_Name;
```
-------------------------1944 sample_num
```sql
SELECT MIN(Match_Date) AS First_Win_Date
FROM Match
WHERE Match_Winner = 'Sunrisers Hyderabad';
```
-------------------------1945 sample_num
```sql
SELECT Player_Name, Player_Id 
FROM Player 
WHERE Country_Name = 'England';
```
-------------------------1946 sample_num
```sql
SELECT 
    SUM(BS.Runs_Scored) / 17.0 AS Run_Rate
FROM 
    Batsman_Scored BS
JOIN 
    Match M ON BS.Match_Id = M.Match_Id
WHERE 
    M.Match_Id = 335987 
    AND M.Match_Date = '2008-04-18';
```
-------------------------1947 sample_num
```sql
SELECT 
    (SUM(b.Runs_Scored) * 6.0 / 16) AS Run_Rate,
    m.Man_of_the_Match
FROM 
    Batsman_Scored b
JOIN 
    Match m ON b.Match_Id = m.Match_Id
WHERE 
    b.Match_Id = 335999 
    AND b.Innings_No = 1
GROUP BY 
    m.Man_of_the_Match;
```
-------------------------1948 sample_num
```sql
SELECT Match_Winner AS Team_Id
FROM Match
GROUP BY Match_Winner
ORDER BY COUNT(Match_Winner) DESC
LIMIT 1;
```
-------------------------1949 sample_num
```sql
SELECT YEAR(DOB) AS Birth_Year, COUNT(Player_Id) AS Player_Count
FROM Player
GROUP BY YEAR(DOB)
ORDER BY Player_Count DESC
LIMIT 1;
```
-------------------------1950 sample_num
```sql
SELECT Match_Date 
FROM Match 
WHERE Win_Margin = (SELECT MAX(Win_Margin) FROM Match);
```
-------------------------1951 sample_num
```sql
SELECT Season_Id
FROM Match
GROUP BY Season_Id
ORDER BY COUNT(Match_Id) ASC
LIMIT 1;
```
-------------------------1952 sample_num
```sql
SELECT Player_Id, COUNT(Match_Id) AS Man_of_the_Match_Count
FROM Player_Match
WHERE Role_Id = (SELECT Role_Id FROM Rolee WHERE Role_Desc = 'Man of the Match')
GROUP BY Player_Id
HAVING COUNT(Match_Id) >= 5;
```
-------------------------1953 sample_num
```sql
SELECT Player_Name 
FROM Player 
JOIN Match ON Player_Match.Match_Id = Match.Match_Id 
JOIN Player_Match ON Match.Match_Id = Player_Match.Match_Id 
WHERE Match.Season_Id = 9 
AND Match.Man_of_the_Match = Player.Player_Id 
AND Match.Match_Date = (SELECT MAX(Match_Date) FROM Match WHERE Season_Id = 9);
```
-------------------------1954 sample_num
```sql
SELECT Match_Winner 
FROM Match 
WHERE Match_Date = (SELECT MIN(Match_Date) FROM Match);
```
-------------------------1955 sample_num
```sql
SELECT COUNT(*) 
FROM City 
WHERE Country_id = (SELECT Country_Id FROM Country WHERE Country_Name = 'U.A.E');
```
-------------------------1956 sample_num
```sql
SELECT Umpire_Name 
FROM Umpire 
WHERE Umpire_Country = 'England';
```
-------------------------1957 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE Bowling_skill = 'Legbreak';
```
-------------------------1958 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE (Team_1 = 'Rajasthan Royals' OR Team_2 = 'Rajasthan Royals') 
AND Season_Id = 8;
```
-------------------------1959 sample_num
```sql
SELECT Umpire_Country FROM Umpire WHERE Umpire_Name = 'TH Wijewardene';
```
-------------------------1960 sample_num
```sql
SELECT Venue_Name 
FROM Venue 
WHERE City_Id IN (SELECT City_Id FROM City WHERE City_Name = 'Abu Dhabi');
```
-------------------------1961 sample_num
```sql
SELECT Country_Name 
FROM Player 
WHERE DOB = (SELECT MAX(DOB) FROM Player);
```
-------------------------1962 sample_num
```sql
SELECT p.Player_Name
FROM Player p
JOIN Player_Match pm ON p.Player_Id = pm.Player_Id
JOIN Match m ON pm.Match_Id = m.Match_Id
WHERE m.Season_Id = 1
  AND m.Match_Date = (SELECT MIN(Match_Date) FROM Match WHERE Season_Id = 1)
  AND m.Match_Winner = pm.Team_Id;
```
-------------------------1963 sample_num
```sql
SELECT Player_Name 
FROM Player 
WHERE Player_Id IN (
    SELECT Player_Id 
    FROM Player_Match 
    WHERE Match_Id IN (
        SELECT Match_Id 
        FROM Season 
        WHERE Purple_Cap IS NOT NULL
    )
) 
ORDER BY DOB DESC 
LIMIT 1;
```
-------------------------1964 sample_num
```sql
SELECT v.Venue_Name, c.City_Name, co.Country_Name
FROM Match m
JOIN Venue v ON m.Venue_Id = v.Venue_Id
JOIN City c ON v.City_Id = c.City_Id
JOIN Country co ON c.Country_id = co.Country_Id
WHERE m.Match_Date = (SELECT MAX(Match_Date) FROM Match);
```
-------------------------1965 sample_num
```sql
SELECT Innings_No, COUNT(DISTINCT Over_Id) AS Total_Overs
FROM Ball_by_Ball
WHERE Match_Id = '336011'
GROUP BY Innings_No;
```
-------------------------1966 sample_num
```sql
SELECT Ball_Id, Runs_Scored, Innings_No 
FROM Batsman_Scored 
WHERE Match_Id = '335988' AND Over_Id = 20;
```
-------------------------1967 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Match_Date LIKE '2011%';
```
-------------------------1968 sample_num
```sql
SELECT SUBTRACT(2022, SUBSTR(DOB, 1, 4)) AS Age
FROM Player
WHERE Player_Name = 'Ishan Kishan';
```
-------------------------1969 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Toss_Winner = Match_Winner THEN 1 END) * 1.0 / COUNT(*)) AS Win_Rate
FROM 
    Match
WHERE 
    Match_Date LIKE '2012%';
```
-------------------------1970 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Match_Date LIKE '2009%' AND Win_Margin < 10;
```
-------------------------1971 sample_num
```sql
SELECT P.Player_Name
FROM Player P
JOIN Player_Match PM ON P.Player_Id = PM.Player_Id
JOIN Match M ON PM.Match_Id = M.Match_Id
WHERE (M.Team_1 = PM.Team_Id OR M.Team_2 = PM.Team_Id)
AND SUBSTR(M.Match_Date, 7, 1) = '6'
AND SUBSTR(M.Match_Date, 1, 4) = '2014';
```
-------------------------1972 sample_num
```sql
SELECT COUNT(*) 
FROM Player_Match 
WHERE Player_Id = (SELECT Player_Id FROM Player WHERE Player_Name = 'Mohammad Hafeez');
```
-------------------------1973 sample_num
```sql
SELECT Player_Name 
FROM Player 
WHERE Country_Name = 'South Africa' AND DOB LIKE '1984%';
```
-------------------------1974 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Match_Winner = Team_Id THEN 1 END) * 100.0 / COUNT(Match_Id)) AS Win_Percentage
FROM 
    Match m
JOIN 
    Team t ON m.Team_1 = t.Team_Id OR m.Team_2 = t.Team_Id
WHERE 
    m.Match_Date LIKE '2009%' AND t.Team_Name = 'Mumbai Indians';
```
-------------------------1975 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM Player WHERE Batting_hand = 'Right-hand bat') * 1.0 / 
    (SELECT COUNT(*) FROM Player WHERE Batting_hand = 'Left-hand bat') AS Batting_Hand_Ratio;
```
-------------------------1976 sample_num
```sql
SELECT Player_Name, Country_Name 
FROM Player 
WHERE DOB = (SELECT MIN(DOB) FROM Player);
```
-------------------------1977 sample_num
```sql
SELECT DISTINCT Bowling_skill 
FROM Player 
WHERE Country_Name = 'Zimbabwea';
```
-------------------------1978 sample_num
```sql
SELECT Umpire_Id, Umpire_Name 
FROM Umpire 
WHERE Umpire_Country = 'New Zealand';
```
-------------------------1979 sample_num
```sql
SELECT P.Player_Name 
FROM Player P
JOIN Player_Match PM ON P.Player_Id = PM.Player_Id
JOIN Rolee R ON PM.Role_Id = R.Role_Id
JOIN Team T ON PM.Team_Id = T.Team_Id
WHERE R.Role_Desc = 'CaptainKeeper' AND T.Team_Name = 'Rising Pune Supergiants';
```
-------------------------1980 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Match_Winner = (SELECT Team_Id FROM Team WHERE Team_Name = 'Sunrisers Hyderabad') 
AND Match_Date LIKE '2013%';
```
-------------------------1981 sample_num
```sql
SELECT DISTINCT Extra_Runs.Match_Id
FROM Extra_Runs
JOIN Extra_Type ON Extra_Runs.Extra_Type_Id = Extra_Type.Extra_Id
WHERE Extra_Type.Extra_Name = 'penalty';
```
-------------------------1982 sample_num
```sql
SELECT Team_1, Team_2 
FROM Match 
WHERE Win_Type = 'Tie' AND SUBSTR(Match_Date, 1, 4) = '2015';
```
-------------------------1983 sample_num
```sql
SELECT 
    AVG(total_outs) AS average_players_out,
    SUM(CASE WHEN Out_Name = 'lbw' THEN 1 ELSE 0 END) AS lbw_outs
FROM (
    SELECT 
        Match_Id, 
        COUNT(*) AS total_outs
    FROM 
        Wicket_Taken
    WHERE 
        Innings_No = 1
    GROUP BY 
        Match_Id
) AS first_innings_outs
JOIN Out_Type ON Wicket_Taken.Kind_Out = Out_Type.Out_Id;
```
-------------------------1984 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Match_Date LIKE '2008%';
```
-------------------------1985 sample_num
```sql
SELECT COUNT(DISTINCT Match_Id) AS Total_Matches
FROM Ball_by_Ball
WHERE Innings_No = 2;
```
-------------------------1986 sample_num
```sql
SELECT Country_Name 
FROM Country 
WHERE Country_Id = (SELECT Country_id FROM City WHERE City_Name = 'Rajkot');
```
-------------------------1987 sample_num
```sql
SELECT COUNT(*) AS Superover_Matches
FROM Match
WHERE Win_Type = 'wickets';
```
-------------------------1988 sample_num
```sql
SELECT Team_1, Team_2 
FROM Match 
WHERE Win_Margin = 38 AND Match_Date = '2009-04-30';
```
-------------------------1989 sample_num
```sql
SELECT T.Team_Name 
FROM Player P 
JOIN Player_Match PM ON P.Player_Id = PM.Player_Id 
JOIN Team T ON PM.Team_Id = T.Team_Id 
WHERE P.Player_Name = 'T Kohli' AND PM.Match_Id = 335989;
```
-------------------------1990 sample_num
```sql
SELECT COUNT(*) 
FROM Venue v 
JOIN City c ON v.City_Id = c.City_Id 
JOIN Country co ON c.Country_Id = co.Country_Id 
WHERE c.City_Name = 'Centurion' AND co.Country_Name = 'South Africa';
```
-------------------------1991 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE (Team_1 = 'Delhi Daredevils' OR Team_2 = 'Delhi Daredevils') 
AND Match_Date LIKE '2014%' 
AND Match_Winner = 'Delhi Daredevils';
```
-------------------------1992 sample_num
```sql
SELECT Match_Id 
FROM Match 
WHERE (Team_1 = 'Royal Challengers Bangalore' OR Team_2 = 'Royal Challengers Bangalore') 
ORDER BY Win_Margin DESC 
LIMIT 1;
```
-------------------------1993 sample_num
```sql
SELECT COUNT(*) 
FROM Player_Match pm
JOIN Player p ON pm.Player_Id = p.Player_Id
WHERE p.Player_Name = 'K Goel' AND pm.Role_Id = 3;
```
-------------------------1994 sample_num
```sql
SELECT AVG(Win_Margin) AS Average_Winning_Margin
FROM Match
JOIN Venue ON Match.Venue_Id = Venue.Venue_Id
WHERE Venue.Venue_Name = 'Newlands';
```
-------------------------1995 sample_num
```sql
SELECT Team_Name 
FROM Team 
WHERE Team_Id NOT IN (
    SELECT Match_Winner 
    FROM Match 
    WHERE Match_Id = 336039
);
```
-------------------------1996 sample_num
```sql
SELECT Venue_Name 
FROM Venue 
WHERE Venue_Id = (SELECT Venue_Id FROM Match WHERE Match_Id = 829768);
```
-------------------------1997 sample_num
```sql
SELECT Team_2 
FROM Match 
WHERE Win_Margin = (SELECT MIN(Win_Margin) FROM Match);
```
-------------------------1998 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Match_Winner = 'Mumbai Indians' THEN 1 END) * 100.0 / COUNT(*)) AS Winning_Percentage
FROM 
    Match
WHERE 
    Match_Date LIKE '2013%';
```
-------------------------1999 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Role_Id = 1 THEN 1 END) - COUNT(CASE WHEN Role_Id > 1 THEN 1 END)) AS Match_Difference
FROM 
    Player_Match 
WHERE 
    Player_Id = (SELECT Player_Id FROM Player WHERE Player_Name = 'SC Ganguly');
```
-------------------------2000 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE Bowling_skill > 2;
```
-------------------------2001 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE DOB LIKE '1970%';
```
-------------------------2002 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE DOB LIKE '198%' AND Bowling_skill = 2;
```
-------------------------2003 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Match_Date LIKE '2008-04%';
```
-------------------------2004 sample_num
```sql
SELECT City_Name FROM City WHERE Country_id = 3;
```
-------------------------2005 sample_num
```sql
SELECT COUNT(*) AS Victory_Matches
FROM Match
WHERE Match_Date LIKE '2008%' AND Outcome_type = 'Victory';
```
-------------------------2006 sample_num
```sql
SELECT Country_id FROM City WHERE City_Name = 'East London';
```
-------------------------2007 sample_num
```sql
SELECT SUBTRACT(2008, strftime('%Y', DOB)) AS Age
FROM Player
WHERE Player_Name = 'SC Ganguly';
```
-------------------------2008 sample_num
```sql
SELECT Player_Name 
FROM Player 
WHERE Batting_hand = 'Left-hand bat';
```
-------------------------2009 sample_num
```sql
SELECT COUNT(*) FROM Player WHERE Country_Name = 'India';
```
-------------------------2010 sample_num
```sql
SELECT Player_Name FROM Player WHERE Country_Name = 'England';
```
-------------------------2011 sample_num
```sql
SELECT Venue_Name 
FROM Venue 
WHERE City_Id = (SELECT City_Id FROM City WHERE City_Name = 'Bangalore');
```
-------------------------2012 sample_num
```sql
SELECT DISTINCT Player_Name 
FROM Player 
JOIN Player_Match ON Player.Player_Id = Player_Match.Player_Id 
JOIN Match ON Player_Match.Match_Id = Match.Match_Id 
WHERE Match.Season_Id IN (SELECT Season_Id FROM Season WHERE Season_Year = 2008);
```
-------------------------2013 sample_num
```sql
SELECT DISTINCT p.Player_Name
FROM Player p
JOIN Batsman_Scored bs ON p.Player_Id = bs.Striker
WHERE bs.Runs_Scored < 3;
```
-------------------------2014 sample_num
```sql
SELECT r.Role_Desc 
FROM Player p 
JOIN Player_Match pm ON p.Player_Id = pm.Player_Id 
JOIN Rolee r ON pm.Role_Id = r.Role_Id 
WHERE p.Player_Name = 'SC Ganguly';
```
-------------------------2015 sample_num
```sql
SELECT Player_Name 
FROM Player 
JOIN Player_Match ON Player.Player_Id = Player_Match.Player_Id 
JOIN Rolee ON Player_Match.Role_Id = Rolee.Role_Id 
WHERE Rolee.Role_Desc = 'Keeper';
```
-------------------------2016 sample_num
```sql
SELECT Player_Name 
FROM Player_Match 
JOIN Player ON Player_Match.Player_Id = Player.Player_Id 
WHERE Player_Match.Team_Id = 1;
```
-------------------------2017 sample_num
```sql
SELECT COUNT(DISTINCT pm.Player_Id) AS Captain_Count
FROM Player_Match pm
JOIN Match m ON pm.Match_Id = m.Match_Id
JOIN Rolee r ON pm.Role_Id = r.Role_Id
WHERE r.Role_Desc = 'Captain' AND m.Match_Date LIKE '2008%';
```
-------------------------2018 sample_num
```sql
SELECT T.Team_Name
FROM Player P
JOIN Player_Match PM ON P.Player_Id = PM.Player_Id
JOIN Match M ON PM.Match_Id = M.Match_Id
JOIN Season S ON M.Season_Id = S.Season_Id
JOIN Team T ON PM.Team_Id = T.Team_Id
WHERE P.Player_Name = 'SC Ganguly' AND S.Season_Year = 2008;
```
-------------------------2019 sample_num
```sql
SELECT Win_Type 
FROM Match 
WHERE Match_Id = 336000;
```
-------------------------2020 sample_num
```sql
SELECT Country_Name 
FROM Player 
WHERE Player_Name = 'SB Joshi';
```
-------------------------2021 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE Bowling_skill = 'Left-arm fast';
```
-------------------------2022 sample_num
```sql
SELECT Outcome_Type 
FROM Match 
JOIN Outcome ON Match.Outcome_type = Outcome.Outcome_Id 
WHERE Match_Id = 392195;
```
-------------------------2023 sample_num
```sql
SELECT P.Player_Name, C.City_Name
FROM Player P
JOIN Country Co ON P.Country_Name = Co.Country_Name
JOIN City C ON Co.Country_Id = C.Country_id
WHERE P.DOB = (SELECT MIN(DOB) FROM Player);
```
-------------------------2024 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Match_Winner = (SELECT Team_Id FROM Team WHERE Team_Name = 'Kings XI Punjab') 
AND Season_Id = (SELECT Season_Id FROM Season WHERE Season_Year = 2008);
```
-------------------------2025 sample_num
```sql
SELECT COUNT(DISTINCT Season_Id) AS Seasons_Participated
FROM Match
WHERE Team_1 = 'Pune Warriors' OR Team_2 = 'Pune Warriors';
```
-------------------------2026 sample_num
```sql
SELECT P.DOB, R.Role_Desc
FROM Player P
JOIN Player_Match PM ON P.Player_Id = PM.Player_Id
JOIN Rolee R ON PM.Role_Id = R.Role_Id
WHERE P.Player_Name = 'R Dravid';
```
-------------------------2027 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Man_of_the_Match = 'SC Ganguly';
```
-------------------------2028 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE Match_Winner = (SELECT Team_Id FROM Team WHERE Team_Name = 'Mumbai Indians') 
AND Match_Date LIKE '2008%';
```
-------------------------2029 sample_num
```sql
SELECT Match_Winner 
FROM Match 
WHERE Match_Id = 335993 AND Win_Type = 'wickets';
```
-------------------------2030 sample_num
```sql
SELECT COUNT(*) AS Matches_Won_By_Wickets
FROM Match
WHERE Win_Type = 'wickets';
```
-------------------------2031 sample_num
```sql
SELECT r.Role_Desc 
FROM Player p 
JOIN Player_Match pm ON p.Player_Id = pm.Player_Id 
JOIN Rolee r ON pm.Role_Id = r.Role_Id 
JOIN Match m ON pm.Match_Id = m.Match_Id 
JOIN Season s ON m.Season_Id = s.Season_Id 
WHERE p.Player_Name = 'W Jaffer' AND s.Season_Year = 2012;
```
-------------------------2032 sample_num
```sql
SELECT Player_Name
FROM Player_Match pm
JOIN Match m ON pm.Match_Id = m.Match_Id
WHERE m.Season_Id IN (SELECT Season_Id FROM Season WHERE Season_Year = 2008)
AND pm.Role_Id = (SELECT Role_Id FROM Rolee WHERE Role_Desc = 'Man of the Match')
GROUP BY Player_Name
HAVING COUNT(pm.Player_Id) > 5;
```
-------------------------2033 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Country_Name = 'India' AND strftime('%Y', DOB) BETWEEN '1975' AND '1985' THEN 1 END) * 1.0) / COUNT(Player_Id) AS Average_Indian_Players
FROM 
    Player;
```
-------------------------2034 sample_num
```sql
SELECT (COUNT(CASE WHEN Batting_hand = 'Left-hand bat' THEN 1 END) * 100.0) / COUNT(Player_Id) AS Left_Hand_Batting_Percentage
FROM Player;
```
-------------------------2035 sample_num
```sql
SELECT (COUNT(CASE WHEN Win_Type = 1 THEN 1 END) * 100.0 / COUNT(Win_Type)) AS Percentage_Won_By_Runs
FROM Match;
```
-------------------------2036 sample_num
```sql
SELECT COUNT(*) AS Matches_With_7_Points_Winning_Margin
FROM Match
WHERE Win_Margin = 7;
```
-------------------------2037 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE strftime('%Y', DOB) BETWEEN '1970' AND '1975';
```
-------------------------2038 sample_num
```sql
SELECT Match_Winner 
FROM Match 
WHERE Match_Date = '2009-04-26' AND Win_Margin = 6;
```
-------------------------2039 sample_num
```sql
SELECT Match_Winner 
FROM Match 
WHERE Match_Id = 419135 AND Win_Type = 'Runs';
```
-------------------------2040 sample_num
```sql
SELECT Match_Id 
FROM Match 
WHERE Venue_Id = (SELECT Venue_Id FROM Venue WHERE Venue_Name = 'St George''s Park') 
ORDER BY Win_Margin DESC 
LIMIT 1;
```
-------------------------2041 sample_num
```sql
SELECT COUNT(*) FROM Player WHERE Country_Name = 'Sri Lanka';
```
-------------------------2042 sample_num
```sql
SELECT Player_Name 
FROM Player 
JOIN Player_Match ON Player.Player_Id = Player_Match.Player_Id 
JOIN Rolee ON Player_Match.Role_Id = Rolee.Role_Id 
WHERE Rolee.Role_Desc = 'captain';
```
-------------------------2043 sample_num
```sql
SELECT v.Venue_Name, m.Match_Winner
FROM Match m
JOIN Venue v ON m.Venue_Id = v.Venue_Id
WHERE m.Match_Id = 392194;
```
-------------------------2044 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Win_Type = 'wickets' THEN 1 END) * 100.0 / COUNT(*)) AS Percentage_Won_By_Wickets
FROM 
    Match
WHERE 
    (Team_1 = 'Delhi Daredevils' OR Team_2 = 'Delhi Daredevils') 
    AND Match_Date LIKE '2009%';
```
-------------------------2045 sample_num
```sql
SELECT groupName 
FROM torrents 
WHERE artist = 'Ron Hunt' 
  AND groupYear = 1979 
  AND releaseType = 'single' 
  AND totalSnatched = 239;
```
-------------------------2046 sample_num
```sql
SELECT totalSnatched 
FROM torrents 
WHERE artist = 'blowfly' AND groupYear = 1980;
```
-------------------------2047 sample_num
```sql
SELECT t.tag 
FROM tags t 
JOIN torrents tor ON t.id = tor.id 
WHERE tor.releaseType = 'album' 
AND tor.totalSnatched = (SELECT MAX(totalSnatched) FROM torrents WHERE releaseType = 'album');
```
-------------------------2048 sample_num
```sql
SELECT t.tag, SUM(to.totalSnatched) AS totalDownloads
FROM tags t
JOIN torrents to ON t.id = to.id
GROUP BY t.tag
ORDER BY totalDownloads DESC
LIMIT 5;
```
-------------------------2049 sample_num
```sql
SELECT groupName 
FROM torrents 
WHERE releaseType = 'single' 
AND groupId IN (SELECT id FROM tags WHERE tag = 'funk') 
ORDER BY groupYear ASC 
LIMIT 1;
```
-------------------------2050 sample_num
```sql
SELECT t.groupName 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE t.releaseType = 'ep' AND tg.tag = 'alternative';
```
-------------------------2051 sample_num
```sql
SELECT t.id, tg.tag
FROM torrents t
JOIN tags tg ON t.id = tg.id
WHERE t.releaseType = 'live'
ORDER BY t.totalSnatched ASC
LIMIT 5;
```
-------------------------2052 sample_num
```sql
SELECT t.artist, tg.tag
FROM torrents t
JOIN tags tg ON t.id = tg.id
WHERE t.releaseType = 'single' AND t.totalSnatched = (SELECT MAX(totalSnatched) FROM torrents WHERE releaseType = 'single');
```
-------------------------2053 sample_num
```sql
SELECT COUNT(DISTINCT t.id) 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE tg.tag = '1980s';
```
-------------------------2054 sample_num
```sql
SELECT totalSnatched FROM torrents WHERE groupName = 'city funk';
```
-------------------------2055 sample_num
```sql
SELECT groupName 
FROM torrents 
WHERE totalSnatched > 20000;
```
-------------------------2056 sample_num
```sql
SELECT t.tag 
FROM tags t 
JOIN torrents r ON t.id = r.id 
WHERE r.groupName = 'sugarhill gang';
```
-------------------------2057 sample_num
```sql
SELECT COUNT(*) 
FROM tags 
WHERE id IN (SELECT id FROM torrents WHERE groupName = 'city funk');
```
-------------------------2058 sample_num
```sql
SELECT t.groupName 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE tg.tag = '1980s';
```
-------------------------2059 sample_num
```sql
SELECT t.groupName 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE tg.tag = '1980s' 
ORDER BY t.totalSnatched DESC 
LIMIT 1;
```
-------------------------2060 sample_num
```sql
SELECT COUNT(*) 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE t.artist = 'michael jackson' AND tg.tag = 'pop';
```
-------------------------2061 sample_num
```sql
SELECT COUNT(*) 
FROM torrents t
JOIN tags tg ON t.id = tg.id
WHERE t.groupYear = 2000 AND t.releaseType = 'album' AND tg.tag = 'pop';
```
-------------------------2062 sample_num
```sql
SELECT AVG(t.totalSnatched) 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE tg.tag = '1980s';
```
-------------------------2063 sample_num
```sql
SELECT groupName 
FROM torrents 
ORDER BY totalSnatched DESC 
LIMIT 3;
```
-------------------------2064 sample_num
```sql
SELECT artist, groupName 
FROM torrents 
WHERE groupYear = 2012 AND releaseType = 'single' 
ORDER BY totalSnatched DESC 
LIMIT 1;
```
-------------------------2065 sample_num
```sql
SELECT releaseType, COUNT(*) AS count
FROM torrents
WHERE artist = '50 cent' AND groupYear BETWEEN 2010 AND 2015 AND (releaseType = 'album' OR releaseType = 'single')
GROUP BY releaseType;
```
-------------------------2066 sample_num
```sql
SELECT MIN(groupYear) - 1991 AS years_passed
FROM torrents
WHERE artist = '2Pac' AND releaseType = 'album' AND groupYear > 1991;
```
-------------------------2067 sample_num
```sql
SELECT AVG(totalSnatched) AS average_downloads
FROM torrents
WHERE artist = '2Pac' AND releaseType = 'single' AND groupYear BETWEEN 2001 AND 2013;
```
-------------------------2068 sample_num
```sql
SELECT t.groupName AS title, t.groupYear AS release_year, tg.tag
FROM torrents t
JOIN tags tg ON t.id = tg.id
WHERE t.releaseType = 'live album' AND t.totalSnatched = (
    SELECT MAX(totalSnatched)
    FROM torrents
    WHERE releaseType = 'live album'
);
```
-------------------------2069 sample_num
```sql
SELECT artist 
FROM torrents 
WHERE releaseType = 'bootleg' AND groupYear = 2016 
GROUP BY artist 
HAVING COUNT(*) >= 2;
```
-------------------------2070 sample_num
```sql
SELECT DISTINCT artist 
FROM torrents 
WHERE releaseType = 'single' AND groupYear BETWEEN 1980 AND 1982;
```
-------------------------2071 sample_num
```sql
SELECT groupName 
FROM torrents 
WHERE id BETWEEN 10 AND 20 AND releaseType = 'single' AND totalSnatched >= 20;
```
-------------------------2072 sample_num
```sql
SELECT DISTINCT artist 
FROM torrents 
JOIN tags ON torrents.id = tags.id 
WHERE groupYear BETWEEN 1980 AND 1982 AND tag = 'disco';
```
-------------------------2073 sample_num
```sql
SELECT DISTINCT t.artist 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE t.totalSnatched <= 100 
  AND t.groupYear = 1980 
  AND tg.tag = 'funk';
```
-------------------------2074 sample_num
```sql
SELECT artist
FROM torrents t
JOIN tags tg ON t.id = tg.id
WHERE tg.tag = 'soul' AND t.releaseType = 'single'
GROUP BY artist
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------2075 sample_num
```sql
SELECT DISTINCT artist 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE tg.tag = 'funk' AND t.groupYear = 1980 AND t.id BETWEEN 10 AND 30;
```
-------------------------2076 sample_num
```sql
SELECT groupName 
FROM torrents 
WHERE groupId IN (
    SELECT id 
    FROM tags 
    WHERE tag = 'jazz'
) AND groupYear >= 1982 
ORDER BY totalSnatched DESC 
LIMIT 1;
```
-------------------------2077 sample_num
```sql
SELECT t.artist, tg.tag 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE t.id = 16;
```
-------------------------2078 sample_num
```sql
SELECT artist, MAX(totalSnatched) AS max_downloads
FROM torrents
WHERE id BETWEEN 10 AND 50
AND id IN (SELECT id FROM tags WHERE tag = 'new.york')
GROUP BY artist
ORDER BY max_downloads DESC
LIMIT 1;
```
-------------------------2079 sample_num
```sql
SELECT DISTINCT t.artist
FROM torrents t
JOIN tags tg ON t.id = tg.id
WHERE t.releaseType IN ('album', 'mixtape')
  AND t.groupYear BETWEEN 1980 AND 1985
  AND tg.tag = 'dance';
```
-------------------------2080 sample_num
```sql
SELECT COUNT(*) 
FROM torrents t
JOIN tags tg ON t.id = tg.id
WHERE t.releaseType = 'single' 
  AND t.groupYear BETWEEN 1979 AND 1981 
  AND tg.tag = 'soul';
```
-------------------------2081 sample_num
```sql
SELECT COUNT(*) FROM torrents WHERE releaseType = 'single' AND groupYear = 1979;
```
-------------------------2082 sample_num
```sql
SELECT COUNT(*) 
FROM torrents 
WHERE artist = 'sugar daddy' AND releaseType = 'single' AND groupYear = 1980;
```
-------------------------2083 sample_num
```sql
SELECT COUNT(*) 
FROM torrents t
JOIN tags tg ON t.id = tg.id
WHERE t.releaseType = 'album' AND t.groupYear = 2004 AND tg.tag = 'christmas';
```
-------------------------2084 sample_num
```sql
SELECT t.tag 
FROM tags t 
JOIN torrents tor ON t.id = tor.id 
WHERE tor.artist = 'kurtis blow' AND tor.groupYear BETWEEN 2000 AND 2010;
```
-------------------------2085 sample_num
```sql
SELECT t.groupName, tg.tag 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE t.artist = 'millie jackson' AND t.groupYear = 1980 AND t.releaseType = 'album';
```
-------------------------2086 sample_num
```sql
SELECT t.groupName 
FROM torrents t 
JOIN tags tg ON t.id = tg.id 
WHERE tg.tag = 'jazz' AND t.groupYear = 2005;
```
-------------------------2087 sample_num
```sql
SELECT artist, COUNT(t.id) AS disco_releases
FROM torrents t
JOIN tags tg ON t.id = tg.id
WHERE t.groupYear BETWEEN 1980 AND 2000 AND tg.tag = 'disco'
GROUP BY artist
ORDER BY disco_releases DESC
LIMIT 1;
```
-------------------------2088 sample_num
```sql
SELECT DISTINCT artist 
FROM torrents 
JOIN tags ON torrents.id = tags.id 
WHERE tags.tag = '1970s' AND torrents.releaseType = 'single';
```
-------------------------2089 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN t.releaseType = 'album' AND t.groupId IN (SELECT id FROM tags WHERE tag = 'united.states') THEN 1 END) * 100.0 / 
    COUNT(CASE WHEN t.releaseType = 'album' AND t.groupYear BETWEEN 1979 AND 1982 THEN 1 END)) AS percentage
FROM 
    torrents t
WHERE 
    t.groupYear BETWEEN 1979 AND 1982;
```
-------------------------2090 sample_num
```sql
SELECT COUNT(*) 
FROM Country 
WHERE OtherGroups = 'HIPC' AND LendingCategory = 'IDA';
```
-------------------------2091 sample_num
```sql
SELECT ShortName 
FROM Country 
WHERE LendingCategory = 'IDA' 
AND ExternalDebtReportingStatus = 'Estimate';
```
-------------------------2092 sample_num
```sql
SELECT s.ShortDefinition 
FROM Series s 
JOIN Country c ON c.CountryCode = 'ABW' 
WHERE s.SeriesCode = 'SM.POP.TOTL' AND c.ShortName = 'Aruba';
```
-------------------------2093 sample_num
```sql
SELECT c.ShortName, cn.Description
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
WHERE c.Region = 'Latin America & Caribbean' AND cn.Seriescode = 'SM.POP.TOTL';
```
-------------------------2094 sample_num
```sql
SELECT COUNT(DISTINCT c.CountryCode) 
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
WHERE c.IncomeGroup = 'Low income' 
AND cn.Seriescode = 'SM.POP.TOTL' 
AND cn.Description IS NOT NULL;
```
-------------------------2095 sample_num
```sql
SELECT s.Description
FROM SeriesNotes s
JOIN Indicators i ON s.Seriescode = i.IndicatorCode
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE s.Seriescode = 'SM.POP.TOTL' AND c.LendingCategory = 'IDA';
```
-------------------------2096 sample_num
```sql
SELECT COUNT(DISTINCT c.CountryCode) AS LowIncomeCountryCount
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
WHERE c.IncomeGroup = 'Low income' 
  AND c.LendingCategory = 'International Development Association'
  AND cn.Seriescode = 'SM.POP.TOTL';
```
-------------------------2097 sample_num
```sql
SELECT COUNT(DISTINCT c.CountryCode) AS CountryCount
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
WHERE c.IncomeGroup = 'High'
  AND c.CurrencyUnit = 'Euro'
  AND cn.Seriescode = 'SP.DYN.AMRT.FE'
  AND cn.Description IS NOT NULL;
```
-------------------------2098 sample_num
```sql
SELECT c.LongName 
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
WHERE cn.Description = 'Estimates are derived from data on foreign-born population.' 
AND cn.Seriescode = 'SM.POP.TOTL';
```
-------------------------2099 sample_num
```sql
SELECT f.Description 
FROM Footnotes f 
JOIN Country c ON f.Countrycode = c.CountryCode 
WHERE f.Seriescode = 'AG.LND.FRST.K2' 
AND f.Year = 1990 
AND c.ShortName = 'Aruba';
```
-------------------------2100 sample_num
```sql
SELECT F.Year
FROM Footnotes F
JOIN Country C ON F.Countrycode = C.CountryCode
WHERE C.ShortName = 'Aruba' AND F.Seriescode = 'AG.LND.FRST.K2';
```
-------------------------2101 sample_num
```sql
SELECT DISTINCT c.ShortName
FROM Country c
JOIN Footnotes f ON c.CountryCode = f.Countrycode
WHERE f.Seriescode = 'DC.DAC.AUSL.CD' 
  AND f.Year = 2002 
  AND f.Description = 'Data are classified as official aid.';
```
-------------------------2102 sample_num
```sql
SELECT COUNT(*) 
FROM Footnotes 
WHERE Countrycode = (SELECT CountryCode FROM Country WHERE ShortName = 'Aruba') 
AND Year = 2002;
```
-------------------------2103 sample_num
```sql
SELECT COUNT(DISTINCT Year) AS ConsecutiveYears
FROM Footnotes
WHERE Countrycode = (SELECT CountryCode FROM Country WHERE ShortName = 'Aruba')
  AND Seriescode = 'BX.KLT.DINV.CD.WD'
ORDER BY Year;
```
-------------------------2104 sample_num
```sql
SELECT AVG(Value) AS AverageAdolescentFertilityRate
FROM Indicators
WHERE CountryCode = (SELECT CountryCode FROM Country WHERE Alpha2Code = '1A')
AND IndicatorName LIKE 'adolescent fertility rate%'
```
-------------------------2105 sample_num
```sql
SELECT c.SpecialNotes
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE i.IndicatorName LIKE 'adolescent fertility rate%'
GROUP BY c.CountryCode, c.SpecialNotes
ORDER BY AVG(i.Value) DESC
LIMIT 1;
```
-------------------------2106 sample_num
```sql
SELECT Alpha2Code 
FROM Country 
WHERE Region = 'East Asia & Pacific' 
AND IncomeGroup = 'High income: nonOECD';
```
-------------------------2107 sample_num
```sql
SELECT c.LongName, c.Alpha2Code
FROM Country c
WHERE c.LatestTradeData = 2013 AND c.LatestWaterWithdrawalData = 2013;
```
-------------------------2108 sample_num
```sql
SELECT AVG(Value) AS AverageValue
FROM Indicators
WHERE CountryName = 'Algeria'
  AND IndicatorName = 'Adjusted net enrolment rate, primary, both sexes (%)'
  AND Year BETWEEN 1975 AND 1980;
```
-------------------------2109 sample_num
```sql
SELECT IndicatorName, AggregationMethod
FROM Series
WHERE Topic = 'Economic Policy & Debt: Balance of payments: Capital & financial account';
```
-------------------------2110 sample_num
```sql
SELECT s.SeriesCode, c.Alpha2Code
FROM Series s
JOIN Indicators i ON s.SeriesCode = i.IndicatorCode
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE s.Topic = 'Environment: Emissions' AND s.LicenseType = 'restricted';
```
-------------------------2111 sample_num
```sql
SELECT COUNT(DISTINCT CountryCode) 
FROM Indicators 
WHERE Year = 1970 
  AND CountryCode IN (SELECT CountryCode FROM Country WHERE Region = 'Middle East & North Africa') 
  AND IndicatorName = 'CO2 emissions from gaseous fuel consumption (kt)' 
  AND Value > 600;
```
-------------------------2112 sample_num
```sql
SELECT 
    c.ShortName, 
    AVG(i.Value) AS AverageValue, 
    MAX(i.Value) AS HighestValue, 
    MAX(i.Year) AS YearOfHighestValue
FROM 
    Country c
JOIN 
    Indicators i ON c.CountryCode = i.CountryCode
WHERE 
    c.Region IN ('Latin America', 'Caribbean') 
    AND i.IndicatorName = 'CO2 emissions from gaseous fuel consumption (kt)' 
    AND i.Year > 1965
GROUP BY 
    c.ShortName
ORDER BY 
    AverageValue DESC
LIMIT 3;
```
-------------------------2113 sample_num
```sql
SELECT sn.Description
FROM SeriesNotes sn
JOIN Series s ON sn.Seriescode = s.SeriesCode
WHERE s.SeriesCode = 'SP.DYN.TO65.MA.ZS' 
  AND s.Topic = 'Health: Mortality' 
  AND sn.Year = 'YR1967';
```
-------------------------2114 sample_num
```sql
SELECT f.Description
FROM Footnotes f
JOIN Country c ON f.Countrycode = c.CountryCode
WHERE c.ShortName = 'Albania' AND f.Year = 1981;
```
-------------------------2115 sample_num
```sql
SELECT Description 
FROM Footnotes 
WHERE Countrycode = (SELECT CountryCode FROM Country WHERE ShortName = 'The Bahamas') 
AND Seriescode = 'SH.DTH.IMRT' 
AND Year = 1984;
```
-------------------------2116 sample_num
```sql
SELECT c.ShortName
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE i.IndicatorName = 'Net bilateral aid flows from DAC donors, Sweden (current US$)'
  AND i.Year = 1970
  AND i.Value = 570000;
```
-------------------------2117 sample_num
```sql
SELECT c.Wb2Code, c.LendingCategory
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
WHERE cn.Description = 'Data source : Human Mortality Database by University of California, Berkeley, and Max Planck Institute for Demographic Research.';
```
-------------------------2118 sample_num
```sql
SELECT s.Topic, s.SeriesCode, s.LicenseType
FROM Indicators i
JOIN Series s ON i.IndicatorCode = s.SeriesCode
WHERE i.CountryName = 'Haiti' 
  AND i.IndicatorName = 'Total reserves minus gold (current US$)' 
  AND i.Year = 1961 
  AND i.Value = 3000000;
```
-------------------------2119 sample_num
```sql
SELECT COUNT(DISTINCT c.CountryCode) AS CountryCount
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE i.IndicatorName = 'Adjusted net national income per capita (constant 2005 US$)'
  AND i.Value > 1000
  AND c.ExternalDebtReportingStatus = 'Preliminary';
```
-------------------------2120 sample_num
```sql
SELECT CountryName 
FROM Indicators 
WHERE Year = 1979 
AND IndicatorName = 'Fertility rate, total (births per woman)' 
AND Value BETWEEN 4 AND 5;
```
-------------------------2121 sample_num
```sql
SELECT ShortName, SourceOfMostRecentIncomeAndExpenditureData
FROM Country
WHERE Region = 'South Asia' AND IncomeGroup = 'Low income';
```
-------------------------2122 sample_num
```sql
SELECT DISTINCT s.Source
FROM Indicators i
JOIN Series s ON i.IndicatorName = s.IndicatorName
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE c.Region = 'Latin America & Caribbean'
AND s.IndicatorName = 'Out-of-school children of primary school age, both sexes (number)';
```
-------------------------2123 sample_num
```sql
SELECT DISTINCT f.Description
FROM Footnotes f
JOIN Indicators i ON f.Countrycode = i.CountryCode AND f.Seriescode = i.IndicatorCode
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE c.Region = 'South America' AND i.Year = 2002 AND i.IndicatorName = 'Net migration';
```
-------------------------2124 sample_num
```sql
SELECT DISTINCT s.Source
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
JOIN Series s ON i.IndicatorName = s.IndicatorName
WHERE c.Region = 'North America' 
AND i.IndicatorName = 'Out-of-school children of primary school age, both sexes (number)';
```
-------------------------2125 sample_num
```sql
SELECT i.CountryName, i.Value AS GDP_Growth
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE c.LatestTradeData = 2013
  AND i.IndicatorName = 'GDP growth (annual %)'
  AND i.Year = 2014
ORDER BY i.Value ASC;
```
-------------------------2126 sample_num
```sql
SELECT c.ShortName, i.Value, s.Source
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
JOIN Series s ON i.IndicatorName = s.IndicatorName
WHERE i.Year = 2005 
  AND s.IndicatorName = 'Out-of-pocket health expenditure (% of private expenditure on health)'
  AND c.Region = 'Europe'
ORDER BY i.Value DESC
LIMIT 10;
```
-------------------------2127 sample_num
```sql
SELECT COUNT(*) 
FROM Country 
WHERE Region = 'South Asia' AND IncomeGroup = 'Low income';
```
-------------------------2128 sample_num
```sql
SELECT ShortName 
FROM Country 
WHERE LatestTradeData > 2010;
```
-------------------------2129 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN SystemOfTrade = 'Special trade system' THEN CountryCode END) * 100.0 / COUNT(CountryCode)) AS percentage
FROM 
    Country
WHERE 
    Region = 'Sub-Saharan Africa';
```
-------------------------2130 sample_num
```sql
SELECT AVG(Value) AS AverageArmsImports
FROM Indicators
WHERE CountryCode IN (
    SELECT CountryCode
    FROM Country
    WHERE Region = 'European & Central Asian'
) AND IndicatorName = 'Arms imports (SIPRI trend indicator values)';
```
-------------------------2131 sample_num
```sql
SELECT Country.ShortName, MIN(Indicators.Value) AS LowestCO2Emissions
FROM Indicators
JOIN Country ON Indicators.CountryCode = Country.CountryCode
WHERE Country.IncomeGroup = 'Upper middle income' 
AND Indicators.IndicatorName = 'CO2 emissions (kt)'
GROUP BY Country.ShortName
ORDER BY LowestCO2Emissions ASC
LIMIT 1;
```
-------------------------2132 sample_num
```sql
SELECT MIN(Value) 
FROM Indicators 
WHERE IndicatorName = 'International migrant stock, total' 
AND CountryCode IN (SELECT CountryCode FROM Country WHERE OtherGroups LIKE '%HIPC%');
```
-------------------------2133 sample_num
```sql
SELECT IndicatorName 
FROM Series 
WHERE Topic = 'Education: Inputs' 
AND SeriesCode IN (
    SELECT SeriesCode 
    FROM Indicators 
    WHERE Year = 'YR2000'
);
```
-------------------------2134 sample_num
```sql
SELECT COUNT(*) 
FROM Series 
WHERE AggregationMethod = 'Sum' 
AND Periodicity = 'Annual' 
AND SeriesCode IN (
    SELECT SeriesCode 
    FROM Indicators 
    WHERE Year IN ('YR2001', 'YR2002', 'YR2003')
);
```
-------------------------2135 sample_num
```sql
SELECT DISTINCT SeriesCode 
FROM Series 
WHERE Source LIKE '%International Monetary Fund%' 
AND SeriesCode IN (
    SELECT SeriesCode 
    FROM Footnotes 
    WHERE Year = 2005
);
```
-------------------------2136 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Value > 50 THEN CountryCode END) * 100.0 / COUNT(CountryCode)) AS percentage
FROM 
    Indicators
WHERE 
    IndicatorName = 'Life expectancy at birth, female (years)' 
    AND CountryCode IN (SELECT CountryCode FROM Country WHERE Region = 'South Asia');
```
-------------------------2137 sample_num
```sql
SELECT CountryName, MAX(Value) AS MaxDeathRate
FROM Indicators
WHERE IndicatorName = 'Death rate, crude (per 1,000 people)' 
AND Year BETWEEN '1960' AND '1965'
GROUP BY CountryName
ORDER BY MaxDeathRate DESC
LIMIT 1;
```
-------------------------2138 sample_num
```sql
SELECT DISTINCT IndicatorName 
FROM Indicators 
WHERE CountryName = 'Arab World' AND Year = '1960' AND Value > 50;
```
-------------------------2139 sample_num
```sql
SELECT CountryName, MAX(Value) AS HighestValue
FROM Indicators
WHERE IndicatorName = 'Merchandise imports by the reporting economy (current US$)'
GROUP BY CountryName
ORDER BY HighestValue DESC
LIMIT 1;
```
-------------------------2140 sample_num
```sql
SELECT DISTINCT i.IndicatorName
FROM Indicators i
JOIN Series s ON i.IndicatorCode = s.SeriesCode
WHERE s.Periodicity = 'Annual' AND i.Year = '1965' AND i.Value > 100;
```
-------------------------2141 sample_num
```sql
SELECT DISTINCT IndicatorName 
FROM Indicators 
WHERE Year BETWEEN '1968' AND '1970' 
AND Value < 100 
AND IndicatorCode IN (SELECT SeriesCode FROM Series WHERE LicenseType = 'open');
```
-------------------------2142 sample_num
```sql
SELECT i.CountryName, s.IndicatorName
FROM Indicators i
JOIN Series s ON i.IndicatorCode = s.SeriesCode
WHERE s.Topic = 'Private Sector & Trade: Exports'
ORDER BY i.Value DESC
LIMIT 1;
```
-------------------------2143 sample_num
```sql
SELECT IndicatorName, MIN(Value) AS LowestValue
FROM Indicators
JOIN Series ON Indicators.IndicatorCode = Series.SeriesCode
WHERE Series.AggregationMethod = 'Weighted average'
GROUP BY IndicatorName
ORDER BY LowestValue ASC
LIMIT 1;
```
-------------------------2144 sample_num
```sql
SELECT i.IndicatorName 
FROM Indicators i 
JOIN Country c ON i.CountryCode = c.CountryCode 
JOIN Series s ON i.IndicatorCode = s.SeriesCode 
WHERE c.ShortName = 'Sudan' 
AND s.Periodicity = 'Annual' 
AND i.Year = 1961;
```
-------------------------2145 sample_num
```sql
SELECT CountryName, MIN(Value) AS LowestValue
FROM Indicators
WHERE IndicatorName = 'Health: Population: Structure'
  AND Year BETWEEN 1960 AND 1965
GROUP BY CountryName
ORDER BY LowestValue ASC
LIMIT 1;
```
-------------------------2146 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN i.Value < 80 THEN i.CountryCode END) * 100.0 / COUNT(i.CountryCode)) AS Percentage
FROM 
    Indicators i
JOIN 
    Country c ON i.CountryCode = c.CountryCode
WHERE 
    c.IncomeGroup = 'Upper middle income' 
    AND i.IndicatorName = 'CO2 emissions from liquid fuel consumption (% of total)';
```
-------------------------2147 sample_num
```sql
SELECT IndicatorCode 
FROM Indicators 
WHERE IndicatorName = 'Rural population';
```
-------------------------2148 sample_num
```sql
SELECT COUNT(*) AS CountryCount, TableName
FROM Country
WHERE SystemOfNationalAccounts = '2008'
GROUP BY TableName;
```
-------------------------2149 sample_num
```sql
SELECT SeriesCode 
FROM Country 
WHERE CurrencyUnit = 'Euro';
```
-------------------------2150 sample_num
```sql
SELECT c.LongName
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE i.IndicatorCode = 'DT.DOD.DSTC.CD';
```
-------------------------2151 sample_num
```sql
SELECT DISTINCT s.SeriesCode
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
JOIN Series s ON i.IndicatorName = s.IndicatorName
WHERE c.CurrencyUnit = 'Hong Kong dollar';
```
-------------------------2152 sample_num
```sql
SELECT DISTINCT c.TableName
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE i.IndicatorCode = 'SP.DYN.TO65.MA.ZS';
```
-------------------------2153 sample_num
```sql
SELECT ShortName 
FROM Country 
WHERE IncomeGroup = 'Low income';
```
-------------------------2154 sample_num
```sql
SELECT s.SeriesCode, c.CountryCode
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
JOIN Series s ON i.IndicatorName = s.IndicatorName
WHERE c.Region = 'Latin America & Caribbean' AND c.IncomeGroup = 'Low income';
```
-------------------------2155 sample_num
```sql
SELECT s.SeriesCode
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
JOIN Series s ON i.IndicatorName = s.IndicatorName
WHERE c.CurrencyUnit = 'Australian dollar' 
AND c.IncomeGroup = 'Low middle income';
```
-------------------------2156 sample_num
```sql
SELECT ShortName, Region 
FROM Country 
WHERE IncomeGroup = 'Upper middle income' 
AND NationalAccountsBaseYear = (SELECT MIN(NationalAccountsBaseYear) FROM Country);
```
-------------------------2157 sample_num
```sql
SELECT CountryCode, ShortName 
FROM Country 
WHERE IncomeGroup = 'High income' AND CurrencyUnit = 'Euro';
```
-------------------------2158 sample_num
```sql
SELECT c.TableName, c.CurrencyUnit
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE i.IndicatorCode = 'FP.CPI.TOTL';
```
-------------------------2159 sample_num
```sql
SELECT c.LongName, i.IndicatorCode
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE c.IncomeGroup = 'High income: nonOECD';
```
-------------------------2160 sample_num
```sql
SELECT s.SeriesCode
FROM Country c
JOIN Series s ON c.CountryCode = s.SeriesCode
WHERE c.CurrencyUnit = 'Pound Sterling' AND c.IncomeGroup = 'High income';
```
-------------------------2161 sample_num
```sql
SELECT CountryCode, ShortName
FROM Country
LIMIT 10;
```
-------------------------2162 sample_num
```sql
SELECT Alpha2Code 
FROM Country 
WHERE ShortName LIKE 'A%';
```
-------------------------2163 sample_num
```sql
SELECT ShortName, TableName 
FROM Country 
WHERE CurrencyUnit = 'Euro';
```
-------------------------2164 sample_num
```sql
SELECT LongName 
FROM Country 
WHERE SpecialNotes IS NULL;
```
-------------------------2165 sample_num
```sql
SELECT ShortName 
FROM Country 
WHERE IncomeGroup = 'High income' AND Region = 'Asia';
```
-------------------------2166 sample_num
```sql
SELECT LongName 
FROM Country 
WHERE NationalAccountsBaseYear < 1980;
```
-------------------------2167 sample_num
```sql
SELECT c.CountryCode 
FROM Country c 
JOIN Indicators i ON c.CountryCode = i.CountryCode 
WHERE c.IncomeGroup = 'Low income' AND i.SeriesCode = 'DT.DOD.DECT.CD';
```
-------------------------2168 sample_num
```sql
SELECT TableName 
FROM Country 
WHERE CountryCode IN (
    SELECT Countrycode 
    FROM CountryNotes 
    WHERE Description = 'Covers mainland Tanzania only'
);
```
-------------------------2169 sample_num
```sql
SELECT cn.Description, s.SeriesCode
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
JOIN Series s ON cn.Seriescode = s.SeriesCode
WHERE c.ShortName = 'Benin' AND cn.Year = 'YR2005';
```
-------------------------2170 sample_num
```sql
SELECT f.Description 
FROM Footnotes f 
JOIN Country c ON f.Countrycode = c.CountryCode 
WHERE c.ShortName = 'Finland' AND f.Year = 'YR2000';
```
-------------------------2171 sample_num
```sql
SELECT DISTINCT c.TableName, i.Year
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE i.IndicatorName = 'Air transport, passengers carried';
```
-------------------------2172 sample_num
```sql
SELECT c.LongName
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE i.Year = '1980' AND i.IndicatorName IS NOT NULL;
```
-------------------------2173 sample_num
```sql
SELECT c.CurrencyUnit, i.IndicatorCode 
FROM Country c 
JOIN Indicators i ON c.CountryCode = i.CountryCode 
WHERE c.ShortName = 'Malaysia' AND i.Year = '1970';
```
-------------------------2174 sample_num
```sql
SELECT DISTINCT c.CountryCode, c.Region
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE i.Value = (SELECT MAX(Value) FROM Indicators)
LIMIT 5;
```
-------------------------2175 sample_num
```sql
SELECT COUNT(DISTINCT c.CountryCode) AS CountryCount, c.CurrencyUnit
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
WHERE cn.Description = 'Sources: UN Energy Statistics (2014)'
GROUP BY c.CurrencyUnit;
```
-------------------------2176 sample_num
```sql
SELECT COUNT(*) AS FootnoteCount, c.TableName
FROM Footnotes f
JOIN Country c ON f.Countrycode = c.CountryCode
WHERE f.Year = 'YR1980'
GROUP BY c.TableName;
```
-------------------------2177 sample_num
```sql
SELECT s.SeriesCode, c.Wb2Code
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
JOIN Series s ON cn.Seriescode = s.SeriesCode
WHERE cn.Description = 'Data sources : Eurostat';
```
-------------------------2178 sample_num
```sql
SELECT CountryName, MIN(Value) AS LowestFertilityRate
FROM Indicators
WHERE IndicatorName = 'Adolescent fertility rate (births per 1,000 women ages 15-19)'
AND CountryCode IN (
    SELECT CountryCode
    FROM Country
    WHERE IncomeGroup = 'Low income'
)
GROUP BY CountryName
ORDER BY LowestFertilityRate
LIMIT 1;
```
-------------------------2179 sample_num
```sql
SELECT SUM(Value) AS TotalUrbanPopulation
FROM Indicators
WHERE IndicatorName = 'Urban population'
  AND IncomeGroup = 'Middle income'
  AND Year = 1960;
```
-------------------------2180 sample_num
```sql
SELECT c.ShortName, c.CurrencyUnit
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE i.IndicatorName = 'Adjusted net national income (annual % growth)' 
  AND i.Year = '1980'
ORDER BY i.Value DESC
LIMIT 1;
```
-------------------------2181 sample_num
```sql
SELECT COUNT(*) 
FROM Country 
WHERE SystemOfNationalAccounts = '1993 System of National Accounts methodology.';
```
-------------------------2182 sample_num
```sql
SELECT ShortName 
FROM Country 
WHERE VitalRegistrationComplete = 'Yes';
```
-------------------------2183 sample_num
```sql
SELECT CountryName 
FROM Country 
WHERE LatestPopulationCensus BETWEEN '2010' AND '2012' 
AND VitalRegistrationComplete = 'Yes';
```
-------------------------2184 sample_num
```sql
SELECT CountryName 
FROM Indicators 
WHERE IndicatorName = 'CO2 emissions (metric tons per capita)' 
  AND Year = 1960 
ORDER BY Value DESC 
LIMIT 1;
```
-------------------------2185 sample_num
```sql
WITH InfantDeaths AS (
    SELECT CountryName, Value
    FROM Indicators
    WHERE IndicatorName = 'Number of infant deaths' AND Year = '1971'
),
MaxInfantDeaths AS (
    SELECT CountryName, Value AS MaxValue
    FROM InfantDeaths
    WHERE Value = (SELECT MAX(Value) FROM InfantDeaths)
),
MinInfantDeaths AS (
    SELECT CountryName, Value AS MinValue
    FROM InfantDeaths
    WHERE Value = (SELECT MIN(Value) FROM InfantDeaths)
)
SELECT 
    MaxInfantDeaths.CountryName AS CountryWithMaxDeaths,
    MaxInfantDeaths.MaxValue,
    MinInfantDeaths.CountryName AS CountryWithMinDeaths,
    MinInfantDeaths.MinValue,
    (MaxInfantDeaths.MaxValue * 1.0 / MinInfantDeaths.MinValue) AS Ratio
FROM 
    MaxInfantDeaths, MinInfantDeaths;
```
-------------------------2186 sample_num
```sql
SELECT ShortName 
FROM Country 
WHERE CountryCode IN (
    SELECT Countrycode 
    FROM Series 
    WHERE SeriesCode = 'SP.DYN.CBRT.IN'
);
```
-------------------------2187 sample_num
```sql
SELECT DISTINCT c.ShortName
FROM Country c
JOIN Footnotes f ON c.CountryCode = f.Countrycode
WHERE f.Description = 'Data are classified as official aid.';
```
-------------------------2188 sample_num
```sql
SELECT c.LongName 
FROM Country c 
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode 
WHERE cn.Description = 'Estimates are based on regression.';
```
-------------------------2189 sample_num
```sql
SELECT c.LongName
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE c.Region = 'East Asia & Pacific'
  AND i.IndicatorName = 'Urban population'
  AND i.Year = '1970'
  AND i.Value > 2000000;
```
-------------------------2190 sample_num
```sql
SELECT CountryName, MAX(Value) AS LargestPopulation
FROM Indicators
WHERE Year = '1960' 
  AND IndicatorName = 'Population, total'
  AND CountryCode IN (
      SELECT CountryCode 
      FROM Country 
      WHERE IncomeGroup = 'Upper middle income'
  )
GROUP BY CountryName
ORDER BY LargestPopulation DESC
LIMIT 1;
```
-------------------------2191 sample_num
```sql
SELECT COUNT(*) 
FROM Country 
WHERE SystemOfNationalAccounts = '1968 System of National Accounts methodology';
```
-------------------------2192 sample_num
```sql
SELECT c.ShortName
FROM Country c
JOIN Series s ON s.SeriesCode = 'Migration'
WHERE c.IncomeGroup = 'Upper middle income' 
AND c.Region = 'East Asia & Pacific';
```
-------------------------2193 sample_num
```sql
SELECT c.LongName
FROM Country c
JOIN Series s ON s.SeriesCode = c.CountryCode
WHERE s.Topic = 'Poverty: Shared Prosperity';
```
-------------------------2194 sample_num
```sql
SELECT c.TableName
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE i.IndicatorCode = 'SP.DYN.CDRT.IN' 
AND c.LatestTradeData = '2013'
ORDER BY i.Year DESC
LIMIT 1;
```
-------------------------2195 sample_num
```sql
SELECT c.LongName 
FROM Country c 
JOIN Indicators i ON c.CountryCode = i.CountryCode 
WHERE c.Region = 'Sub-Saharan Africa' AND i.SeriesCode = 'SP.DYN.AMRT.FE';
```
-------------------------2196 sample_num
```sql
SELECT CurrencyUnit, COUNT(ShortName) AS CountryCount
FROM Country
GROUP BY CurrencyUnit
HAVING COUNT(ShortName) > 3;

SELECT ShortName
FROM Country
LIMIT 3;
```
-------------------------2197 sample_num
```sql
SELECT LongName 
FROM Country 
WHERE Region = 'South Asia' AND IncomeGroup = 'Low income';
```
-------------------------2198 sample_num
```sql
SELECT LongName 
FROM Country 
WHERE SystemOfTrade = 'Special trade system' 
LIMIT 2;
```
-------------------------2199 sample_num
```sql
SELECT CountryName, MAX(Value) AS MaxCO2EmissionsFromTransport
FROM Indicators
WHERE IndicatorName = 'CO2 emissions from transport (% of total fuel combustion)'
GROUP BY CountryName
ORDER BY MaxCO2EmissionsFromTransport DESC
LIMIT 1;
```
-------------------------2200 sample_num
```sql
SELECT CountryName 
FROM Indicators 
WHERE IndicatorName = 'Arable land (% of land area)' 
ORDER BY Value ASC 
LIMIT 1;
```
-------------------------2201 sample_num
```sql
SELECT DISTINCT Topic 
FROM Series 
WHERE LicenseType = 'Restricted';
```
-------------------------2202 sample_num
```sql
SELECT CountryCode 
FROM Country 
WHERE IncomeGroup = 'Upper middle income' 
AND ExternalDebtReportingStatus = 'Preliminary';
```
-------------------------2203 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN ExternalDebtReportingStatus = 'Actual' THEN CountryCode END) * 100.0 / COUNT(CountryCode)) AS Percentage
FROM 
    Country
WHERE 
    Region = 'Middle East & North Africa';
```
-------------------------2204 sample_num
```sql
SELECT GovernmentAccountingConcept, COUNT(*) AS CountryCount
FROM Country
WHERE ExternalDebtReportingStatus = 'Actual'
AND GovernmentAccountingConcept IN ('Budgetary Central Government', 'Consolidated Central Government')
GROUP BY GovernmentAccountingConcept
ORDER BY CountryCount DESC;
```
-------------------------2205 sample_num
```sql
SELECT COUNT(*) 
FROM Country 
WHERE Region = 'East Asia & Pacific' 
AND ExternalDebtReportingStatus = 'Estimate';
```
-------------------------2206 sample_num
```sql
SELECT (COUNT(CASE WHEN IncomeGroup = 'Lower middle income' THEN CountryCode END) * 100.0) / COUNT(CountryCode) AS Proportion
FROM Country
WHERE Region = 'Sub-Saharan Africa';
```
-------------------------2207 sample_num
```sql
SELECT MAX(Value) AS MaxAgriculturalLandPercentage
FROM Indicators
WHERE CountryCode = (SELECT CountryCode FROM Country WHERE LongName = 'Republic of Benin')
  AND IndicatorName = 'Agricultural land (% of land area)'
  AND Year BETWEEN 1961 AND 1980;
```
-------------------------2208 sample_num
```sql
SELECT DISTINCT c.LongName
FROM Country c
JOIN Series s ON s.SeriesCode = (SELECT SeriesCode FROM Series WHERE ShortDefinition = 'UN Energy Statistics')
JOIN Footnotes f ON f.Seriescode = s.SeriesCode
WHERE f.Year = 2014 AND f.Description IS NOT NULL
LIMIT 3;
```
-------------------------2209 sample_num
```sql
SELECT Value 
FROM Indicators 
WHERE CountryName = 'Commonwealth of Australia' 
  AND IndicatorName = 'Deposit interest rate (%)' 
  AND Year = '1979';
```
-------------------------2210 sample_num
```sql
SELECT s.SeriesCode, cn.Description
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
JOIN Series s ON cn.Seriescode = s.SeriesCode
WHERE c.ShortName = 'Germany';
```
-------------------------2211 sample_num
```sql
SELECT s.Topic 
FROM Series s 
JOIN Indicators i ON s.SeriesCode = i.IndicatorCode 
JOIN Country c ON i.CountryCode = c.CountryCode 
WHERE c.ShortName = 'Austria';
```
-------------------------2212 sample_num
```sql
SELECT s.Topic, sn.Description
FROM Series s
JOIN SeriesNotes sn ON s.SeriesCode = sn.Seriescode
WHERE s.SeriesCode = 'SP.DYN.AMRT.MA';
```
-------------------------2213 sample_num
```sql
SELECT COUNT(DISTINCT c.LongName) AS CountryCount, 
       c.LongName 
FROM Country c
JOIN Footnotes f ON c.CountryCode = f.Countrycode
WHERE f.Description = 'Not specified'
LIMIT 3;
```
-------------------------2214 sample_num
```sql
SELECT c.ShortName
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE c.ExternalDebtReportingStatus = 'Actual'
  AND i.Year = 1980
  AND i.IndicatorName = 'Land under cereal production'
  AND i.Value = 3018500;
```
-------------------------2215 sample_num
```sql
SELECT (COUNT(CASE WHEN Value > 50 THEN CountryName END) * 100.0 / COUNT(CountryName)) AS Portion
FROM Indicators
WHERE Year = '1961' 
AND CountryCode IN (SELECT CountryCode FROM Country WHERE Region = 'Latin America & Caribbean')
AND IndicatorName = 'Agricultural land (% of land area)';
```
-------------------------2216 sample_num
```sql
SELECT LongName 
FROM Country 
WHERE Region = 'South Asia' AND IncomeGroup = 'Low income';
```
-------------------------2217 sample_num
```sql
SELECT IndicatorCode 
FROM Indicators 
WHERE CountryName = 'Brazil' AND IndicatorName = 'Mobile cellular subscriptions';
```
-------------------------2218 sample_num
```sql
SELECT LongName 
FROM Country 
WHERE Region = 'Europe & Central Asia' AND CurrencyUnit = 'Danish krone';
```
-------------------------2219 sample_num
```sql
SELECT CountryName, Value AS RuralPopulationPercentage
FROM Indicators
WHERE IndicatorName = 'Rural population (% of total population)'
ORDER BY Value DESC
LIMIT 1;
```
-------------------------2220 sample_num
```sql
SELECT LongName 
FROM Country 
WHERE LatestPopulationCensus = '2011';
```
-------------------------2221 sample_num
```sql
SELECT Value 
FROM Indicators 
WHERE CountryName = 'Italy' 
  AND IndicatorName = 'Agricultural land (sq. km)' 
  AND Year = '1968';
```
-------------------------2222 sample_num
```sql
SELECT CountryName, Year, Value
FROM Indicators
WHERE IndicatorName = 'Out-of-school children of primary school age, female (number)'
AND CountryCode IN (SELECT CountryCode FROM Country WHERE Region = 'Sub-Saharan Africa')
ORDER BY Value DESC
LIMIT 1;
```
-------------------------2223 sample_num
```sql
SELECT s.SeriesCode
FROM Series s
JOIN Indicators i ON s.IndicatorName = i.IndicatorName
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE c.LongName = 'Islamic State of Afghanistan' 
  AND i.Year = '1965' 
  AND i.IndicatorName = 'Number of infant deaths';
```
-------------------------2224 sample_num
```sql
SELECT 
    C.ShortName, 
    COUNT(*) AS CountryCount
FROM 
    Country C
JOIN 
    Indicators I ON C.CountryCode = I.CountryCode
WHERE 
    C.SystemOfNationalAccounts = '1968 System of National Accounts methodology' 
    AND C.Region = 'Middle East & North Africa'
    AND I.IndicatorName = 'CO2 emissions from solid fuel consumption (kt)'
GROUP BY 
    C.ShortName
ORDER BY 
    MAX(I.Value) DESC
LIMIT 1;
```
-------------------------2225 sample_num
```sql
SELECT IndicatorCode 
FROM Indicators 
WHERE CountryName = 'Republic of Albania' AND Year = '1960';
```
-------------------------2226 sample_num
```sql
SELECT c.LendingCategory
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE i.IndicatorName = 'Cereal production (metric tons)' 
  AND i.Value = 6140000 
  AND i.Year = 1966;
```
-------------------------2227 sample_num
```sql
SELECT c.ShortName, c.Region
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE i.IndicatorName = 'Population in largest city'
  AND i.Year BETWEEN 1960 AND 1979
GROUP BY c.CountryCode, c.ShortName, c.Region
HAVING COUNT(DISTINCT i.Year) = 19
ORDER BY MAX(i.Value) DESC
LIMIT 1;
```
-------------------------2228 sample_num
```sql
SELECT 
    SUM(Value) AS Total_CO2_Emissions,
    YEAR,
    MAX(Value) AS Highest_CO2_Emissions
FROM 
    Indicators
WHERE 
    Year BETWEEN 1975 AND 1980 
    AND IndicatorName LIKE 'CO2%'
GROUP BY 
    Year
ORDER BY 
    Total_CO2_Emissions DESC
LIMIT 1;
```
-------------------------2229 sample_num
```sql
SELECT c.ShortName, c.IncomeGroup, MIN(i.Value) AS SmallestLandArea
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE i.IndicatorName LIKE 'Land area (sq. km)'
AND i.Year BETWEEN 1961 AND 1979
GROUP BY c.CountryCode
HAVING COUNT(DISTINCT i.Year) = 19
ORDER BY SmallestLandArea ASC
LIMIT 1;
```
-------------------------2230 sample_num
```sql
SELECT AVG(i.Value) AS AveragePassengers, c.SystemOfTrade
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE c.CountryName = 'Bulgaria'
  AND i.IndicatorName = 'Air transport, passengers carried'
  AND i.Year BETWEEN 1970 AND 1980;
```
-------------------------2231 sample_num
```sql
SELECT PppSurveyYear 
FROM Country 
WHERE ShortName = 'Angola';
```
-------------------------2232 sample_num
```sql
SELECT COUNT(*) 
FROM Country 
WHERE Region = 'North America' AND VitalRegistrationComplete = 'Yes';
```
-------------------------2233 sample_num
```sql
SELECT DISTINCT Indicators.Year
FROM Indicators
JOIN Country ON Indicators.CountryCode = Country.CountryCode
WHERE Country.Alpha2Code = '1A' 
AND Indicators.IndicatorName = 'Adolescent fertility rate (births per 1,000 women ages 15-19)';
```
-------------------------2234 sample_num
```sql
SELECT c.LongName 
FROM Country c 
JOIN Indicators i ON c.CountryCode = i.CountryCode 
WHERE i.IndicatorName = 'Arms exports (SIPRI trend indicator values)' 
  AND i.Value = 3000000 
  AND i.Year = 1960;
```
-------------------------2235 sample_num
```sql
SELECT DISTINCT c.Alpha2Code
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
WHERE i.IndicatorName = 'Rural population' AND i.Year = '1960';
```
-------------------------2236 sample_num
```sql
SELECT c.SpecialNotes
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE i.IndicatorName = 'Adolescent fertility rate (births per 1,000 women ages 15-19)' 
  AND i.Year = '1960'
  AND i.Value = (SELECT MAX(Value) 
                 FROM Indicators 
                 WHERE IndicatorName = 'Adolescent fertility rate (births per 1,000 women ages 15-19)' 
                   AND Year = '1960');
```
-------------------------2237 sample_num
```sql
SELECT 
    (SUM(CASE WHEN Year = 1961 THEN Value END) - SUM(CASE WHEN Year = 1960 THEN Value END)) AS Increase
FROM 
    Indicators
WHERE 
    CountryCode = '1A' AND 
    IndicatorName = 'Adolescent fertility rate (births per 1,000 women ages 15-19)%';
```
-------------------------2238 sample_num
```sql
SELECT cn.Description
FROM CountryNotes cn
JOIN Country c ON cn.Countrycode = c.CountryCode
WHERE c.ShortName = 'Australia' AND cn.Seriescode = 'SP.ADO.TFRT';
```
-------------------------2239 sample_num
```sql
SELECT 
    COALESCE(CN.Description, FN.Description, SN.Description) AS Note
FROM 
    Country C
LEFT JOIN 
    Indicators I ON C.CountryCode = I.CountryCode
LEFT JOIN 
    Series S ON I.IndicatorName = S.IndicatorName
LEFT JOIN 
    CountryNotes CN ON C.CountryCode = CN.Countrycode AND S.SeriesCode = CN.Seriescode
LEFT JOIN 
    Footnotes FN ON C.CountryCode = FN.Countrycode AND S.SeriesCode = FN.Seriescode AND I.Year = FN.Year
LEFT JOIN 
    SeriesNotes SN ON S.SeriesCode = SN.Seriescode AND I.Year = SN.Year
WHERE 
    C.ShortName = 'Aruba' 
    AND S.Topic = 'Environment: Energy production & use';
```
-------------------------2240 sample_num
```sql
SELECT DISTINCT c.ShortName
FROM Country c
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode
WHERE cn.Seriescode = 'BX.KLT.DINV.CD.WD';
```
-------------------------2241 sample_num
```sql
SELECT c.Region
FROM Country c
JOIN Indicators i ON c.CountryCode = i.CountryCode
JOIN Series s ON i.IndicatorName = s.IndicatorName
JOIN CountryNotes cn ON c.CountryCode = cn.Countrycode AND s.SeriesCode = cn.Seriescode
WHERE s.IndicatorName = 'Inflation, consumer prices (annual %)';
```
-------------------------2242 sample_num
```sql
SELECT COUNT(DISTINCT cn.CountryCode) AS CountryCount
FROM CountryNotes cn
JOIN Indicators i ON cn.CountryCode = i.CountryCode AND cn.Seriescode = i.IndicatorCode
WHERE i.IndicatorName = 'Stocks traded, turnover ratio of domestic shares (%)';
```
-------------------------2243 sample_num
```sql
SELECT s.AggregationMethod
FROM Indicators i
JOIN Series s ON i.IndicatorCode = s.SeriesCode
WHERE i.Value = 133 AND i.Year = 1960 AND i.CountryName = 'Arab World';
```
-------------------------2244 sample_num
```sql
SELECT i.Value
FROM Indicators i
JOIN Series s ON i.IndicatorCode = s.SeriesCode
WHERE s.LongDefinition = 'Adolescent fertility rate is the number of births per 1,000 women ages 15-19.'
AND i.CountryName = 'Arab World'
AND i.Year = 1960;
```
-------------------------2245 sample_num
```sql
SELECT 
    (SUM(CASE WHEN Year = 1961 THEN Value END) - SUM(CASE WHEN Year = 1960 THEN Value END)) / 
    NULLIF(SUM(CASE WHEN Year = 1960 THEN Value END), 0) * 100 AS PercentageIncrease
FROM 
    Indicators
WHERE 
    CountryCode = '1A' AND 
    IndicatorName = 'Adolescent fertility rate (births per 1,000 women ages 15-19)';
```
-------------------------2246 sample_num
```sql
SELECT AVG(i.Value) AS AverageAdolescentFertilityRate
FROM Indicators i
JOIN Country c ON i.CountryCode = c.CountryCode
WHERE c.Alpha2Code = '1A' 
AND i.IndicatorName = 'Adolescent fertility rate (births per 1,000 women ages 15-19)';
```
-------------------------2247 sample_num
```sql
SELECT DISTINCT d.directorid
FROM directors d
JOIN movies2directors md ON d.directorid = md.directorid
JOIN u2base u ON md.movieid = u.movieid
WHERE u.rating > 4;
```
-------------------------2248 sample_num
```sql
SELECT COUNT(DISTINCT userid) 
FROM u2base 
JOIN users ON u2base.userid = users.userid 
WHERE u2base.rating = 5 AND users.u_gender = 'M';
```
-------------------------2249 sample_num
```sql
SELECT DISTINCT md.genre
FROM movies2actors ma
JOIN movies2directors md ON ma.movieid = md.movieid
WHERE ma.actorid = 851;
```
-------------------------2250 sample_num
```sql
SELECT COUNT(*) 
FROM movies m 
JOIN u2base u ON m.movieid = u.movieid 
WHERE m.country = 'USA' AND u.rating < 3;
```
-------------------------2251 sample_num
```sql
SELECT COUNT(*) 
FROM movies 
WHERE country = 'France' AND movieid IN (
    SELECT movieid 
    FROM movies2directors 
    WHERE genre = 'Drama'
);
```
-------------------------2252 sample_num
```sql
SELECT AVG(occupation) AS average_occupation
FROM users
WHERE userid IN (
    SELECT userid
    FROM u2base
    WHERE rating <= 2
);
```
-------------------------2253 sample_num
```sql
SELECT m.movieid, AVG(u.rating) AS avg_rating
FROM movies m
JOIN u2base u ON m.movieid = u.movieid
WHERE m.country = 'USA'
GROUP BY m.movieid
ORDER BY avg_rating DESC
LIMIT 10;
```
-------------------------2254 sample_num
```sql
SELECT AVG(cast_count) AS average_casts
FROM (
    SELECT m.movieid, COUNT(ma.actorid) AS cast_count
    FROM movies m
    JOIN movies2actors ma ON m.movieid = ma.movieid
    WHERE m.country = 'USA'
    GROUP BY m.movieid
) AS movie_casts;
```
-------------------------2255 sample_num
```sql
SELECT movieid 
FROM movies 
WHERE isEnglish = 'F' 
ORDER BY year DESC 
LIMIT 5;
```
-------------------------2256 sample_num
```sql
SELECT COUNT(DISTINCT a.actorid) AS best_actors_with_rating_5
FROM actors a
JOIN movies2actors ma ON a.actorid = ma.actorid
JOIN u2base u ON ma.movieid = u.movieid
WHERE a.a_quality = 'best' AND u.rating = 5;
```
-------------------------2257 sample_num
```sql
SELECT AVG(u2base.rating) AS average_rating
FROM movies
JOIN u2base ON movies.movieid = u2base.movieid
WHERE movies.country = 'France' AND movies.year = (SELECT MAX(year) FROM movies WHERE country = 'France');
```
-------------------------2258 sample_num
```sql
SELECT COUNT(*) 
FROM movies m 
JOIN u2base u ON m.movieid = u.movieid 
WHERE m.country = 'UK' 
AND m.runningtime < 120;
```
-------------------------2259 sample_num
```sql
SELECT DISTINCT u.userid
FROM users u
JOIN u2base ub ON u.userid = ub.userid
JOIN movies m ON ub.movieid = m.movieid
WHERE u.u_gender = 'M' AND ub.rating < 3 AND m.country = 'France' AND m.runningtime = 2;
```
-------------------------2260 sample_num
```sql
SELECT COUNT(DISTINCT a.actorid) AS worst_actresses_with_high_ratings
FROM actors a
JOIN movies2actors ma ON a.actorid = ma.actorid
JOIN u2base u ON ma.movieid = u.movieid
WHERE a.a_quality = (SELECT MIN(a_quality) FROM actors)
AND u.rating > 3;
```
-------------------------2261 sample_num
```sql
SELECT userid
FROM u2base
WHERE rating = 5
GROUP BY userid
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------2262 sample_num
```sql
SELECT DISTINCT a.actorid, md.genre
FROM movies2directors md
JOIN movies2actors ma ON md.movieid = ma.movieid
JOIN actors a ON ma.actorid = a.actorid
WHERE md.directorid = 22397;
```
-------------------------2263 sample_num
```sql
SELECT DISTINCT a.actorid
FROM actors a
JOIN movies2actors ma ON a.actorid = ma.actorid
JOIN movies m ON ma.movieid = m.movieid
JOIN movies2directors md ON m.movieid = md.movieid
WHERE md.genre = 'Action'

UNION

SELECT DISTINCT d.directorid
FROM directors d
JOIN movies2directors md ON d.directorid = md.directorid
JOIN movies m ON md.movieid = m.movieid
WHERE md.genre = 'Action';
```
-------------------------2264 sample_num
```sql
SELECT COUNT(DISTINCT a.actorid) 
FROM actors a 
JOIN movies2actors ma ON a.actorid = ma.actorid 
JOIN movies m ON ma.movieid = m.movieid 
WHERE a.a_gender = 'F' AND m.year = 4;
```
-------------------------2265 sample_num
```sql
SELECT DISTINCT a.actorid
FROM actors a
JOIN movies2actors ma ON a.actorid = ma.actorid
JOIN movies m ON ma.movieid = m.movieid
WHERE a.a_quality = 3 AND m.isEnglish = 'T' AND m.country = 'USA';
```
-------------------------2266 sample_num
```sql
SELECT m.movieid 
FROM movies m 
JOIN directors d ON m.movieid = d.directorid 
WHERE m.runningtime = 3 AND d.avg_revenue = 1;
```
-------------------------2267 sample_num
```sql
SELECT DISTINCT genre 
FROM movies2directors 
JOIN movies ON movies2directors.movieid = movies.movieid 
WHERE movies.country = 'UK';
```
-------------------------2268 sample_num
```sql
SELECT genre, COUNT(*) AS genre_count
FROM u2base ub
JOIN movies m ON ub.movieid = m.movieid
JOIN movies2directors md ON m.movieid = md.movieid
JOIN users u ON ub.userid = u.userid
WHERE u.age = 18
GROUP BY genre
ORDER BY genre_count DESC
LIMIT 1;
```
-------------------------2269 sample_num
```sql
SELECT DISTINCT ma.actorid
FROM u2base AS ub
JOIN movies AS m ON ub.movieid = m.movieid
JOIN movies2actors AS ma ON m.movieid = ma.movieid
JOIN users AS u ON ub.userid = u.userid
WHERE u.occupation = 5
ORDER BY ub.rating DESC
LIMIT 1;
```
-------------------------2270 sample_num
```sql
SELECT DISTINCT age FROM users 
JOIN u2base ON users.userid = u2base.userid 
WHERE u2base.rating = 3;
```
-------------------------2271 sample_num
```sql
SELECT directors.country, COUNT(*) AS action_movie_count
FROM movies
JOIN movies2directors ON movies.movieid = movies2directors.movieid
JOIN directors ON movies2directors.directorid = directors.directorid
WHERE movies2directors.genre = 'Action'
GROUP BY directors.country
ORDER BY action_movie_count DESC
LIMIT 1;
```
-------------------------2272 sample_num
```sql
SELECT DISTINCT m.movieid
FROM movies m
JOIN movies2actors ma ON m.movieid = ma.movieid
JOIN actors a ON ma.actorid = a.actorid
JOIN (
    SELECT a.actorid
    FROM actors a
    JOIN u2base u ON a.actorid = u.movieid
    GROUP BY a.actorid
    ORDER BY AVG(u.rating) DESC
    LIMIT 5
) top_actors ON a.actorid = top_actors.actorid;
```
-------------------------2273 sample_num
```sql
SELECT m.movieid, m.year, m.runningtime
FROM movies m
WHERE m.isEnglish = 'F' AND m.country = 'UK' AND m.movieid IN (
    SELECT movieid
    FROM movies2directors
    WHERE genre = 'Adventure'
)
LIMIT 5;
```
-------------------------2274 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN u.u_gender = 'F' THEN 1 END) * 100.0 / COUNT(u.userid)) AS female_percentage
FROM 
    users u
JOIN 
    u2base ub ON u.userid = ub.userid
WHERE 
    ub.rating = 2;
```
-------------------------2275 sample_num
```sql
SELECT 
    (SELECT COUNT(DISTINCT u.userid) FROM users u 
     JOIN u2base ub ON u.userid = ub.userid 
     JOIN movies m ON ub.movieid = m.movieid 
     JOIN movies2directors md ON m.movieid = md.movieid 
     WHERE u.u_gender = 'F' AND md.genre = 'Horror') -
    (SELECT COUNT(DISTINCT u.userid) FROM users u 
     JOIN u2base ub ON u.userid = ub.userid 
     JOIN movies m ON ub.movieid = m.movieid 
     JOIN movies2directors md ON m.movieid = md.movieid 
     WHERE u.u_gender = 'M' AND md.genre = 'Horror') AS gender_difference;
```
-------------------------2276 sample_num
```sql
SELECT DISTINCT genre 
FROM movies2directors 
WHERE movieid IN (
    SELECT movieid 
    FROM movies 
    WHERE year = 4 AND isEnglish = 'T'
);
```
-------------------------2277 sample_num
```sql
SELECT COUNT(*) 
FROM movies 
WHERE country = 'USA' AND isEnglish = 'F' AND movieid IN (SELECT movieid FROM movies2directors WHERE genre = 'Action');
```
-------------------------2278 sample_num
```sql
SELECT COUNT(*) AS highest_rating_count
FROM u2base
WHERE userid IN (
    SELECT userid
    FROM users
    WHERE u_gender = 'M' AND age <= 18
) AND rating = 5;  -- Assuming the highest rating is 5
```
-------------------------2279 sample_num
```sql
SELECT movieid
FROM u2base
JOIN users ON u2base.userid = users.userid
WHERE users.u_gender = 'F'
GROUP BY movieid
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------2280 sample_num
```sql
SELECT COUNT(*) 
FROM movies m 
JOIN u2base u ON m.movieid = u.movieid 
WHERE m.country = 'UK' 
AND u.rating = (SELECT MAX(rating) FROM u2base WHERE movieid IN (SELECT movieid FROM movies WHERE isEnglish = 'Yes'));
```
-------------------------2281 sample_num
```sql
SELECT DISTINCT movieid 
FROM movies 
WHERE year = 4 AND movieid IN (SELECT movieid FROM u2base WHERE rating = 1);
```
-------------------------2282 sample_num
```sql
SELECT COUNT(*) 
FROM movies m 
JOIN u2base u ON m.movieid = u.movieid 
WHERE m.isEnglish = 'T' AND m.year = 1 AND u.rating = 1;
```
-------------------------2283 sample_num
```sql
SELECT COUNT(DISTINCT u.userid) 
FROM users u 
JOIN u2base ub ON u.userid = ub.userid 
JOIN movies m ON ub.movieid = m.movieid 
WHERE u.u_gender = 'F' AND m.country = 'France';
```
-------------------------2284 sample_num
```sql
SELECT COUNT(DISTINCT d.directorid) AS well_directors_count
FROM directors d
JOIN movies2directors md ON d.directorid = md.directorid
WHERE d.d_quality = 4 AND md.genre = 'Action';
```
-------------------------2285 sample_num
```sql
SELECT DISTINCT md.genre
FROM movies2directors md
JOIN directors d ON md.directorid = d.directorid
WHERE d.avg_revenue = (SELECT MAX(avg_revenue) FROM directors);
```
-------------------------2286 sample_num
```sql
SELECT COUNT(DISTINCT m.movieid)
FROM movies m
JOIN movies2actors ma ON m.movieid = ma.movieid
JOIN actors a ON ma.actorid = a.actorid
WHERE m.isEnglish = 'T' AND a.a_gender = 'M' AND a.a_quality = (SELECT MAX(a_quality) FROM actors WHERE a_gender = 'M');
```
-------------------------2287 sample_num
```sql
SELECT DISTINCT m.country
FROM movies m
JOIN movies2actors ma ON m.movieid = ma.movieid
JOIN actors a ON ma.actorid = a.actorid
WHERE a.a_quality = (SELECT MIN(a_quality) FROM actors WHERE a_gender = 'F');
```
-------------------------2288 sample_num
```sql
SELECT MAX(avg_rating) AS highest_avg_rating
FROM (
    SELECT AVG(u2base.rating) AS avg_rating
    FROM movies
    JOIN movies2directors ON movies.movieid = movies2directors.movieid
    JOIN u2base ON movies.movieid = u2base.movieid
    WHERE movies2directors.genre = 'Action' AND movies.country = 'USA'
    GROUP BY movies.movieid
) AS avg_ratings;
```
-------------------------2289 sample_num
```sql
SELECT COUNT(DISTINCT m.movieid) AS count_best_directed_movies
FROM movies m
JOIN movies2directors md ON m.movieid = md.movieid
JOIN directors d ON md.directorid = d.directorid
JOIN u2base u ON m.movieid = u.movieid
WHERE d.d_quality = 5
GROUP BY m.movieid
HAVING AVG(u.rating) > 3.5;
```
-------------------------2290 sample_num
```sql
SELECT m.movieid, AVG(u.rating) AS avg_rating
FROM movies m
JOIN movies2directors md ON m.movieid = md.movieid
JOIN u2base u ON m.movieid = u.movieid
WHERE md.genre = 'Adventure'
GROUP BY m.movieid
ORDER BY avg_rating DESC
LIMIT 1;
```
-------------------------2291 sample_num
```sql
SELECT COUNT(*) 
FROM users 
JOIN u2base ON users.userid = u2base.userid 
WHERE u2base.movieid = 2462959 AND users.u_gender = 'F';
```
-------------------------2292 sample_num
```sql
SELECT DISTINCT m.movieid 
FROM movies m 
WHERE m.runningtime = 0 
ORDER BY m.movieid 
LIMIT 1;
```
-------------------------2293 sample_num
```sql
SELECT a.actorid, u2.rating
FROM movies2actors ma
JOIN actors a ON ma.actorid = a.actorid
JOIN u2base u2 ON ma.movieid = u2.movieid
WHERE ma.movieid = 1722327;
```
-------------------------2294 sample_num
```sql
SELECT d.directorid, COUNT(m.movieid) AS film_count
FROM directors d
JOIN movies2directors md ON d.directorid = md.directorid
WHERE d.d_quality = 5
GROUP BY d.directorid
ORDER BY film_count DESC;
```
-------------------------2295 sample_num
```sql
SELECT COUNT(*) 
FROM movies m 
JOIN movies2directors md ON m.movieid = md.movieid 
JOIN u2base u ON m.movieid = u.movieid 
WHERE md.genre = 'Drama' AND u.rating = 3;
```
-------------------------2296 sample_num
```sql
SELECT COUNT(*) 
FROM u2base 
WHERE rating = 5 
AND userid IN (SELECT userid FROM users WHERE age BETWEEN 25 AND 35);
```
-------------------------2297 sample_num
```sql
SELECT m.movieid, m.year, m.isEnglish, m.country, m.runningtime
FROM movies m
JOIN movies2directors md ON m.movieid = md.movieid
JOIN u2base u ON m.movieid = u.movieid
WHERE md.genre = 'horror' AND u.rating = 1;
```
-------------------------2298 sample_num
```sql
SELECT DISTINCT d.directorid
FROM directors d
JOIN movies2directors md ON d.directorid = md.directorid
JOIN movies m ON md.movieid = m.movieid
WHERE m.country = 'France';
```
-------------------------2299 sample_num
```sql
SELECT userid, age FROM u2base JOIN users ON u2base.userid = users.userid WHERE movieid = 1695219;
```
-------------------------2300 sample_num
```sql
SELECT genre, COUNT(*) AS non_english_count
FROM movies2directors md
JOIN movies m ON md.movieid = m.movieid
WHERE m.isEnglish = 'F'
GROUP BY genre
ORDER BY non_english_count DESC
LIMIT 1;
```
-------------------------2301 sample_num
```sql
SELECT a.actorid, d.directorid
FROM movies2actors ma
JOIN actors a ON ma.actorid = a.actorid
JOIN movies2directors md ON ma.movieid = md.movieid
JOIN directors d ON md.directorid = d.directorid
WHERE ma.movieid = 1949144;
```
-------------------------2302 sample_num
```sql
SELECT 
    (COUNT(DISTINCT a.actorid) FILTER (WHERE u.rating >= 3) * 100.0 / COUNT(DISTINCT a.actorid)) AS percentage
FROM 
    actors a
JOIN 
    movies2actors ma ON a.actorid = ma.actorid
JOIN 
    movies m ON ma.movieid = m.movieid
JOIN 
    u2base u ON m.movieid = u.movieid
WHERE 
    m.country = 'UK';
```
-------------------------2303 sample_num
```sql
SELECT 
    (SUM(CASE WHEN avg_revenue > d_quality THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS proportion
FROM 
    directors d
JOIN 
    movies2directors md ON d.directorid = md.directorid
JOIN 
    movies m ON md.movieid = m.movieid
WHERE 
    md.genre = 'action' AND d.directorid = 'box office success paradox';
```
-------------------------2304 sample_num
```sql
SELECT DISTINCT ma.actorid
FROM movies2actors ma
JOIN movies m ON ma.movieid = m.movieid
WHERE m.year = (SELECT MAX(year) FROM movies);
```
-------------------------2305 sample_num
```sql
SELECT DISTINCT ma.actorid
FROM movies m
JOIN movies2actors ma ON m.movieid = ma.movieid
WHERE m.isEnglish = 'T' AND m.runningtime = 2;
```
-------------------------2306 sample_num
```sql
SELECT ma.actorid
FROM movies m
JOIN movies2actors ma ON m.movieid = ma.movieid
WHERE m.country = 'France'
GROUP BY ma.actorid
HAVING COUNT(m.movieid) >= 2;
```
-------------------------2307 sample_num
```sql
SELECT COUNT(*) 
FROM movies 
WHERE country = 'USA' AND movieid IN (
    SELECT movieid 
    FROM movies2actors 
    GROUP BY movieid 
    HAVING COUNT(actorid) > 1
);
```
-------------------------2308 sample_num
```sql
SELECT movieid 
FROM movies 
WHERE year = 1 
AND movieid NOT IN (SELECT movieid FROM movies2actors WHERE cast_num > 0);
```
-------------------------2309 sample_num
```sql
SELECT COUNT(DISTINCT ma.actorid) AS actor_count
FROM movies m
JOIN movies2actors ma ON m.movieid = ma.movieid
WHERE m.country IN ('US', 'UK');
```
-------------------------2310 sample_num
```sql
SELECT COUNT(DISTINCT d.directorid) 
FROM directors d 
JOIN movies2directors md ON d.directorid = md.directorid 
WHERE d.avg_revenue = 4 AND (md.genre = 'action' OR md.genre = 'adventure');
```
-------------------------2311 sample_num
```sql
SELECT directorid
FROM directors
WHERE d_quality >= 3
AND directorid IN (
    SELECT directorid
    FROM movies2directors
    GROUP BY directorid
    HAVING COUNT(DISTINCT genre) >= 2
);
```
-------------------------2312 sample_num
```sql
SELECT COUNT(*) 
FROM movies 
WHERE country = 'USA' AND movieid IN (
    SELECT movieid 
    FROM movies2directors 
    WHERE genre = 'Comedy'
);
```
-------------------------2313 sample_num
```sql
SELECT COUNT(*) AS latest_drama_action_count
FROM movies m
JOIN movies2directors md ON m.movieid = md.movieid
WHERE m.year = (SELECT MAX(year) FROM movies)
AND (md.genre = 'Drama' OR md.genre = 'Action');
```
-------------------------2314 sample_num
```sql
SELECT m.movieid 
FROM movies m 
JOIN movies2directors md ON m.movieid = md.movieid 
WHERE md.genre = 'Horror' AND m.runningtime >= 120;
```
-------------------------2315 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN u.rating = 1 THEN 1 END) * 100.0 / COUNT(*)) AS negative_critical_reception
FROM 
    movies m
JOIN 
    u2base u ON m.movieid = u.movieid
WHERE 
    m.isEnglish = 1 AND m.country = 'USA';
```
-------------------------2316 sample_num
```sql
SELECT COUNT(DISTINCT m.movieid) AS disparate_comedy_count
FROM movies m
JOIN movies2directors md ON m.movieid = md.movieid
JOIN u2base u ON m.movieid = u.movieid
WHERE md.genre = 'Comedy' AND u.rating = 1;
```
-------------------------2317 sample_num
```sql
SELECT d.avg_revenue
FROM directors d
JOIN movies2directors md ON d.directorid = md.directorid
JOIN u2base u ON md.movieid = u.movieid
WHERE u.rating = 1
GROUP BY d.directorid
ORDER BY COUNT(u.rating) DESC
LIMIT 1;
```
-------------------------2318 sample_num
```sql
SELECT COUNT(*) 
FROM movies m 
JOIN u2base u ON m.movieid = u.movieid 
WHERE m.country = 'France' 
AND u.rating = (SELECT MAX(rating) FROM u2base);
```
-------------------------2319 sample_num
```sql
SELECT m.movieid
FROM u2base u
JOIN users us ON u.userid = us.userid
JOIN movies m ON u.movieid = m.movieid
WHERE us.age = 25
GROUP BY m.movieid
ORDER BY COUNT(u.rating) DESC
LIMIT 1;
```
-------------------------2320 sample_num
```sql
SELECT COUNT(DISTINCT u.userid) 
FROM users u 
JOIN u2base ub ON u.userid = ub.userid 
JOIN movies m ON ub.movieid = m.movieid 
WHERE u.age = 35 AND m.country = 'UK';
```
-------------------------2321 sample_num
```sql
SELECT userid, age 
FROM u2base 
JOIN users ON u2base.userid = users.userid 
WHERE movieid = 2409051 AND rating = 2;
```
-------------------------2322 sample_num
```sql
SELECT movieid
FROM u2base
WHERE movieid IN (
    SELECT movieid
    FROM movies
    WHERE year = 1
)
GROUP BY movieid
ORDER BY COUNT(rating) DESC
LIMIT 1;
```
-------------------------2323 sample_num
```sql
SELECT m.movieid, AVG(u.rating) AS avg_rating
FROM movies m
JOIN u2base u ON m.movieid = u.movieid
WHERE m.country = 'France'
GROUP BY m.movieid
ORDER BY avg_rating ASC
LIMIT 1;
```
-------------------------2324 sample_num
```sql
SELECT COUNT(DISTINCT a.actorid) AS female_actor_count
FROM actors a
JOIN movies2actors ma ON a.actorid = ma.actorid
JOIN movies m ON ma.movieid = m.movieid
WHERE a.a_gender = 'F' AND (m.country = 'France' OR m.country = 'USA');
```
-------------------------2325 sample_num
```sql
SELECT COUNT(DISTINCT ma.actorid) AS different_actors
FROM movies m
JOIN u2base u ON m.movieid = u.movieid
JOIN movies2actors ma ON m.movieid = ma.movieid
WHERE u.rating = 5;
```
-------------------------2326 sample_num
```sql
SELECT m.movieid, AVG(u.rating) AS avg_rating
FROM movies m
JOIN movies2directors md ON m.movieid = md.movieid
JOIN u2base u ON m.movieid = u.movieid
WHERE md.genre = 'Crime'
GROUP BY m.movieid
ORDER BY avg_rating ASC
LIMIT 1;
```
-------------------------2327 sample_num
```sql
SELECT 
    SUM(CASE WHEN a.a_gender = 'M' THEN 1 ELSE 0 END) * 1.0 / 
    NULLIF(SUM(CASE WHEN a.a_gender = 'F' THEN 1 ELSE 0 END), 0) AS gender_ratio
FROM 
    movies m
JOIN 
    movies2actors ma ON m.movieid = ma.movieid
JOIN 
    actors a ON ma.actorid = a.actorid
WHERE 
    m.country = 'UK';
```
-------------------------2328 sample_num
```sql
SELECT COUNT(*) 
FROM users 
WHERE age = 35 AND u_gender = 'F' AND userid IN (SELECT userid FROM u2base WHERE movieid = 1711133 AND rating = 3);
```
-------------------------2329 sample_num
```sql
SELECT COUNT(DISTINCT u.userid) 
FROM u2base u 
JOIN movies m ON u.movieid = m.movieid 
WHERE u.rating = 1 AND m.year = 2 AND m.country = 'UK' AND m.runningtime = 2;
```
-------------------------2330 sample_num
```sql
SELECT DISTINCT d.directorid
FROM directors d
LEFT JOIN movies2directors md ON d.directorid = md.directorid
WHERE d.avg_revenue = 2 AND d.d_quality = 3 AND md.genre <> 'Comedy';
```
-------------------------2331 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN a.a_quality = 2 AND ma.cast_num = 2 THEN 1 END) * 100.0 / COUNT(*)) AS female_percentage
FROM 
    actors a
JOIN 
    movies2actors ma ON a.actorid = ma.actorid
WHERE 
    a.a_gender = 'F' AND ma.movieid = 1672580;
```
-------------------------2332 sample_num
```sql
SELECT 
    SUM(CASE WHEN a_gender = 'M' THEN 1 ELSE 0 END) AS male_actors,
    SUM(CASE WHEN a_gender = 'F' THEN 1 ELSE 0 END) AS female_actors,
    CONCAT(SUM(CASE WHEN a_gender = 'M' THEN 1 ELSE 0 END), ':', SUM(CASE WHEN a_gender = 'F' THEN 1 ELSE 0 END)) AS ratio
FROM 
    actors 
WHERE 
    a_quality = 0;
```
-------------------------2333 sample_num
```sql
SELECT a.actorid, COUNT(m2a.movieid) AS film_count
FROM actors a
JOIN movies2actors m2a ON a.actorid = m2a.actorid
GROUP BY a.actorid
ORDER BY film_count DESC
LIMIT 1;
```
-------------------------2334 sample_num
```sql
SELECT genre, COUNT(*) AS movie_count
FROM movies2directors
GROUP BY genre
ORDER BY movie_count DESC
LIMIT 1;
```
-------------------------2335 sample_num
```sql
SELECT genre, COUNT(*) AS genre_count
FROM movies2directors
JOIN directors ON movies2directors.directorid = directors.directorid
WHERE directors.d_quality = 0
GROUP BY genre
ORDER BY genre_count DESC;
```
-------------------------2336 sample_num
```sql
SELECT m.movieid
FROM movies m
JOIN u2base u ON m.movieid = u.movieid
WHERE m.isEnglish = 'F' AND m.country = 'USA'
ORDER BY u.rating ASC
LIMIT 1;
```
-------------------------2337 sample_num
```sql
SELECT AVG(u2base.rating) AS average_rating
FROM u2base
JOIN movies2directors ON u2base.movieid = movies2directors.movieid
JOIN directors ON movies2directors.directorid = directors.directorid
WHERE directors.d_quality = 4 AND directors.avg_revenue = 4;
```
-------------------------2338 sample_num
```sql
SELECT m.movieid, AVG(u2.rating) AS avg_rating
FROM u2base u2
JOIN users u ON u.userid = u2.userid
JOIN movies m ON m.movieid = u2.movieid
WHERE u.u_gender = 'F' AND u.occupation = 3
GROUP BY m.movieid
ORDER BY avg_rating DESC;
```
-------------------------2339 sample_num
```sql
SELECT COUNT(DISTINCT a.actorid) AS female_actresses_count, m.country, m.runningtime
FROM movies m
JOIN movies2actors ma ON m.movieid = ma.movieid
JOIN actors a ON ma.actorid = a.actorid
WHERE m.movieid = 2312852 AND a.a_gender = 'F';
```
-------------------------2340 sample_num
```sql
SELECT COUNT(m.movieid) AS horror_movie_count
FROM movies m
JOIN movies2directors md ON m.movieid = md.movieid
JOIN directors d ON md.directorid = d.directorid
WHERE md.genre = 'Horror' AND d.d_quality = 0;
```
-------------------------2341 sample_num
```sql
SELECT DISTINCT genre
FROM movies
JOIN movies2directors ON movies.movieid = movies2directors.movieid
WHERE isEnglish = 'F' AND runningtime <= 120;
```
-------------------------2342 sample_num
```sql
SELECT m.movieid, m.year
FROM movies m
JOIN movies2directors md ON m.movieid = md.movieid
JOIN u2base u ON m.movieid = u.movieid
WHERE m.isEnglish = 1 
  AND md.genre = 'Comedy' 
  AND m.country = 'UK' 
  AND m.runningtime = 3 
  AND u.userid IN (SELECT userid FROM users WHERE age BETWEEN 45 AND 50)
ORDER BY u.rating DESC
LIMIT 1;
```
-------------------------2343 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN m.isEnglish = 'T' THEN 1 END) - COUNT(CASE WHEN m.isEnglish = 'F' THEN 1 END)) * 100.0 / COUNT(*) AS percentage_difference
FROM 
    movies m
WHERE 
    m.year = 3 AND 
    m.country <> 'USA' AND 
    m.movieid IN (SELECT movieid FROM movies2directors WHERE genre = 'Crime');
```
-------------------------2344 sample_num
```sql
SELECT 
    SUM(CASE WHEN a.a_gender = 'M' THEN 1 ELSE 0 END) AS male_actors,
    SUM(CASE WHEN a.a_gender = 'F' THEN 1 ELSE 0 END) AS female_actors,
    (SUM(CASE WHEN a.a_quality = 5 THEN 1 ELSE 0 END) * 100.0 / NULLIF(SUM(CASE WHEN a.a_quality = 0 THEN 1 ELSE 0 END), 0)) AS quality_proportion,
    d.directorid,
    md.genre
FROM 
    movies2actors ma
JOIN 
    actors a ON ma.actorid = a.actorid
JOIN 
    movies m ON ma.movieid = m.movieid
JOIN 
    movies2directors md ON m.movieid = md.movieid
JOIN 
    directors d ON md.directorid = d.directorid
WHERE 
    ma.movieid = 1684910
GROUP BY 
    d.directorid, md.genre;
```
-------------------------2345 sample_num
```sql
SELECT p.Product_Name
FROM central_superstore cs
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE cs.Order_ID = 'CA-2011-112326';
```
-------------------------2346 sample_num
```sql
SELECT MAX(JULIANDAY(Ship_Date) - JULIANDAY(Order_Date)) AS Longest_Shipment_Time
FROM (
    SELECT Ship_Date, Order_Date
    FROM central_superstore
    WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
    UNION ALL
    SELECT Ship_Date, Order_Date
    FROM east_superstore
    WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
    UNION ALL
    SELECT Ship_Date, Order_Date
    FROM south_superstore
    WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
    UNION ALL
    SELECT Ship_Date, Order_Date
    FROM west_superstore
    WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
) AS All_Orders;
```
-------------------------2347 sample_num
```sql
SELECT COUNT(*) 
FROM (
    SELECT Ship Mode 
    FROM central_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
    UNION ALL
    SELECT Ship Mode 
    FROM east_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
    UNION ALL
    SELECT Ship Mode 
    FROM south_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
    UNION ALL
    SELECT Ship Mode 
    FROM west_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
) AS all_orders
WHERE Ship Mode = 'Standard Class';
```
-------------------------2348 sample_num
```sql
SELECT COUNT(*) AS OrderCount
FROM (
    SELECT Order ID FROM central_superstore WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
    UNION ALL
    SELECT Order ID FROM east_superstore WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
    UNION ALL
    SELECT Order ID FROM south_superstore WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
    UNION ALL
    SELECT Order ID FROM west_superstore WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
) AS AllOrders;
```
-------------------------2349 sample_num
```sql
SELECT Order_ID
FROM (
    SELECT Order_ID, COUNT(DISTINCT Product_ID) AS Product_Count
    FROM (
        SELECT Order_ID, Product_ID
        FROM central_superstore
        WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
        UNION ALL
        SELECT Order_ID, Product_ID
        FROM east_superstore
        WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
        UNION ALL
        SELECT Order_ID, Product_ID
        FROM south_superstore
        WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
        UNION ALL
        SELECT Order_ID, Product_ID
        FROM west_superstore
        WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
    ) AS All_Orders
    GROUP BY Order_ID
) AS Order_Counts
WHERE Product_Count > 3;
```
-------------------------2350 sample_num
```sql
SELECT COUNT(DISTINCT o.Order_ID) AS Furniture_Orders
FROM (
    SELECT Order_ID FROM central_superstore WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
    UNION ALL
    SELECT Order_ID FROM east_superstore WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
    UNION ALL
    SELECT Order_ID FROM south_superstore WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
    UNION ALL
    SELECT Order_ID FROM west_superstore WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aimee Bixby')
) AS o
JOIN product p ON o.Product_ID = p.Product_ID
WHERE p.Category = 'Furniture';
```
-------------------------2351 sample_num
```sql
SELECT p.Product_Name
FROM central_superstore cs
JOIN people pe ON cs.Customer_ID = pe.Customer_ID
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Aimee Bixby' 
AND strftime('%Y', cs.Order_Date) = '2016'
UNION
SELECT p.Product_Name
FROM east_superstore es
JOIN people pe ON es.Customer_ID = pe.Customer_ID
JOIN product p ON es.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Aimee Bixby' 
AND strftime('%Y', es.Order_Date) = '2016'
UNION
SELECT p.Product_Name
FROM south_superstore ss
JOIN people pe ON ss.Customer_ID = pe.Customer_ID
JOIN product p ON ss.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Aimee Bixby' 
AND strftime('%Y', ss.Order_Date) = '2016'
UNION
SELECT p.Product_Name
FROM west_superstore ws
JOIN people pe ON ws.Customer_ID = pe.Customer_ID
JOIN product p ON ws.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Aimee Bixby' 
AND strftime('%Y', ws.Order_Date) = '2016';
```
-------------------------2352 sample_num
```sql
SELECT SUM(Quantity) AS Total_Quantity
FROM central_superstore
JOIN product ON central_superstore.Product_ID = product.Product_ID
WHERE product.Product_Name = 'Telescoping Adjustable Floor Lamp';
```
-------------------------2353 sample_num
```sql
SELECT DISTINCT p.Customer_Name
FROM people p
JOIN central_superstore cs ON p.Customer_ID = cs.Customer_ID
JOIN product pr ON cs.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Telescoping Adjustable Floor Lamp'
UNION
SELECT DISTINCT p.Customer_Name
FROM people p
JOIN east_superstore es ON p.Customer_ID = es.Customer_ID
JOIN product pr ON es.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Telescoping Adjustable Floor Lamp'
UNION
SELECT DISTINCT p.Customer_Name
FROM people p
JOIN south_superstore ss ON p.Customer_ID = ss.Customer_ID
JOIN product pr ON ss.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Telescoping Adjustable Floor Lamp'
UNION
SELECT DISTINCT p.Customer_Name
FROM people p
JOIN west_superstore ws ON p.Customer_ID = ws.Customer_ID
JOIN product pr ON ws.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Telescoping Adjustable Floor Lamp';
```
-------------------------2354 sample_num
```sql
SELECT COUNT(DISTINCT p."Customer ID") AS ConsumerCount
FROM people p
JOIN central_superstore cs ON p."Customer ID" = cs."Customer ID"
JOIN product pr ON cs."Product ID" = pr."Product ID"
WHERE pr."Product Name" = 'Telescoping Adjustable Floor Lamp' AND p."Segment" = 'Consumer'
UNION ALL
SELECT COUNT(DISTINCT p."Customer ID") AS ConsumerCount
FROM people p
JOIN east_superstore es ON p."Customer ID" = es."Customer ID"
JOIN product pr ON es."Product ID" = pr."Product ID"
WHERE pr."Product Name" = 'Telescoping Adjustable Floor Lamp' AND p."Segment" = 'Consumer'
UNION ALL
SELECT COUNT(DISTINCT p."Customer ID") AS ConsumerCount
FROM people p
JOIN south_superstore ss ON p."Customer ID" = ss."Customer ID"
JOIN product pr ON ss."Product ID" = pr."Product ID"
WHERE pr."Product Name" = 'Telescoping Adjustable Floor Lamp' AND p."Segment" = 'Consumer'
UNION ALL
SELECT COUNT(DISTINCT p."Customer ID") AS ConsumerCount
FROM people p
JOIN west_superstore ws ON p."Customer ID" = ws."Customer ID"
JOIN product pr ON ws."Product ID" = pr."Product ID"
WHERE pr."Product Name" = 'Telescoping Adjustable Floor Lamp' AND p."Segment" = 'Consumer';
```
-------------------------2355 sample_num
```sql
SELECT SUM(c.Quantity) AS Quantity
FROM central_superstore c
JOIN people p ON c.Customer_ID = p.Customer_ID
JOIN product pr ON c.Product_ID = pr.Product_ID
WHERE p.Customer_Name = 'Aimee Bixby' 
  AND pr.Product_Name = 'Xerox 1952' 
  AND c.Order_Date = DATE('2014-09-10')
UNION ALL
SELECT SUM(e.Quantity) AS Quantity
FROM east_superstore e
JOIN people p ON e.Customer_ID = p.Customer_ID
JOIN product pr ON e.Product_ID = pr.Product_ID
WHERE p.Customer_Name = 'Aimee Bixby' 
  AND pr.Product_Name = 'Xerox 1952' 
  AND e.Order_Date = DATE('2014-09-10')
UNION ALL
SELECT SUM(s.Quantity) AS Quantity
FROM south_superstore s
JOIN people p ON s.Customer_ID = p.Customer_ID
JOIN product pr ON s.Product_ID = pr.Product_ID
WHERE p.Customer_Name = 'Aimee Bixby' 
  AND pr.Product_Name = 'Xerox 1952' 
  AND s.Order_Date = DATE('2014-09-10')
UNION ALL
SELECT SUM(w.Quantity) AS Quantity
FROM west_superstore w
JOIN people p ON w.Customer_ID = p.Customer_ID
JOIN product pr ON w.Product_ID = pr.Product_ID
WHERE p.Customer_Name = 'Aimee Bixby' 
  AND pr.Product_Name = 'Xerox 1952' 
  AND w.Order_Date = DATE('2014-09-10');
```
-------------------------2356 sample_num
```sql
SELECT COUNT(*) 
FROM (
    SELECT Customer ID, Product ID 
    FROM central_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
      AND Product ID = (SELECT Product ID FROM product WHERE Product Name = 'Xerox 1952')
    UNION ALL
    SELECT Customer ID, Product ID 
    FROM east_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
      AND Product ID = (SELECT Product ID FROM product WHERE Product Name = 'Xerox 1952')
    UNION ALL
    SELECT Customer ID, Product ID 
    FROM south_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
      AND Product ID = (SELECT Product ID FROM product WHERE Product Name = 'Xerox 1952')
    UNION ALL
    SELECT Customer ID, Product ID 
    FROM west_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Aimee Bixby')
      AND Product ID = (SELECT Product ID FROM product WHERE Product Name = 'Xerox 1952')
) AS orders;
```
-------------------------2357 sample_num
```sql
SELECT Sales / (1 - Discount) AS Original_Price
FROM (
    SELECT c.Sales, c.Discount
    FROM central_superstore c
    JOIN people p ON c.Customer_ID = p.Customer_ID
    JOIN product pr ON c.Product_ID = pr.Product_ID
    WHERE p.Customer_Name = 'Aimee Bixby'
      AND c.Order_Date = DATE('2014-09-10')
      AND pr.Product_Name = 'Xerox 1952'
    
    UNION ALL
    
    SELECT e.Sales, e.Discount
    FROM east_superstore e
    JOIN people p ON e.Customer_ID = p.Customer_ID
    JOIN product pr ON e.Product_ID = pr.Product_ID
    WHERE p.Customer_Name = 'Aimee Bixby'
      AND e.Order_Date = DATE('2014-09-10')
      AND pr.Product_Name = 'Xerox 1952'
    
    UNION ALL
    
    SELECT s.Sales, s.Discount
    FROM south_superstore s
    JOIN people p ON s.Customer_ID = p.Customer_ID
    JOIN product pr ON s.Product_ID = pr.Product_ID
    WHERE p.Customer_Name = 'Aimee Bixby'
      AND s.Order_Date = DATE('2014-09-10')
      AND pr.Product_Name = 'Xerox 1952'
    
    UNION ALL
    
    SELECT w.Sales, w.Discount
    FROM west_superstore w
    JOIN people p ON w.Customer_ID = p.Customer_ID
    JOIN product pr ON w.Product_ID = pr.Product_ID
    WHERE p.Customer_Name = 'Aimee Bixby'
      AND w.Order_Date = DATE('2014-09-10')
      AND pr.Product_Name = 'Xerox 1952'
) AS combined
```
-------------------------2358 sample_num
```sql
SELECT 
    SUM((Sales / (1 - Discount)) * Quantity - Profit) AS Total_Cost
FROM 
    (SELECT * FROM central_superstore
     UNION ALL
     SELECT * FROM east_superstore
     UNION ALL
     SELECT * FROM south_superstore
     UNION ALL
     SELECT * FROM west_superstore) AS all_superstores
JOIN 
    product ON all_superstores.Product_ID = product.Product_ID
JOIN 
    people ON all_superstores.Customer_ID = people.Customer_ID
WHERE 
    product.Product_Name = 'Xerox 1952' 
    AND people.Customer_Name = 'Aimee Bixby' 
    AND all_superstores.Order_Date = DATE('2014-09-10');
```
-------------------------2359 sample_num
```sql
SELECT SUM(Quantity) AS Total_Art_Products_Ordered
FROM east_superstore
JOIN product ON east_superstore.Product_ID = product.Product_ID
WHERE strftime('%Y', "Order Date") = '2013' AND product."Sub-Category" = 'Art';
```
-------------------------2360 sample_num
```sql
SELECT p.Customer_Name, MAX(total_cost) AS Largest_Total_Cost
FROM (
    SELECT Customer_ID, 
           SUM((Sales / (1 - Discount)) * Quantity) AS total_cost
    FROM (
        SELECT Customer_ID, Sales, Quantity, Discount FROM central_superstore
        UNION ALL
        SELECT Customer_ID, Sales, Quantity, Discount FROM east_superstore
        UNION ALL
        SELECT Customer_ID, Sales, Quantity, Discount FROM south_superstore
        UNION ALL
        SELECT Customer_ID, Sales, Quantity, Discount FROM west_superstore
    ) AS all_orders
    GROUP BY Customer_ID
) AS customer_totals
JOIN people p ON customer_totals.Customer_ID = p.Customer_ID
GROUP BY p.Customer_Name
ORDER BY Largest_Total_Cost DESC
LIMIT 1;
```
-------------------------2361 sample_num
```sql
SELECT p.Product_Name
FROM product p
JOIN (
    SELECT Product_ID, MAX(Sales / (1 - Discount)) AS Max_Original_Price
    FROM (
        SELECT Product_ID, Sales, Discount FROM central_superstore
        UNION ALL
        SELECT Product_ID, Sales, Discount FROM east_superstore
        UNION ALL
        SELECT Product_ID, Sales, Discount FROM south_superstore
        UNION ALL
        SELECT Product_ID, Sales, Discount FROM west_superstore
    ) AS all_superstores
    GROUP BY Product_ID
) AS max_prices ON p.Product_ID = max_prices.Product_ID
WHERE max_prices.Max_Original_Price = (
    SELECT MAX(Sales / (1 - Discount))
    FROM (
        SELECT Sales, Discount FROM central_superstore
        UNION ALL
        SELECT Sales, Discount FROM east_superstore
        UNION ALL
        SELECT Sales, Discount FROM south_superstore
        UNION ALL
        SELECT Sales, Discount FROM west_superstore
    ) AS all_superstores
);
```
-------------------------2362 sample_num
```sql
SELECT p.Product_Name
FROM central_superstore cs
JOIN product p ON cs.Product_ID = p.Product_ID
JOIN people pe ON cs.Customer_ID = pe.Customer_ID
WHERE pe.Customer_Name = 'Darren Powers'
AND cs.Order_Date = (SELECT MAX(Order_Date) FROM central_superstore WHERE Customer_ID = pe.Customer_ID)
```
-------------------------2363 sample_num
```sql
SELECT SUM(Quantity) AS Total_Quantity
FROM (
    SELECT Quantity FROM central_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Advantus plastic paper clips')
    UNION ALL
    SELECT Quantity FROM east_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Advantus plastic paper clips')
    UNION ALL
    SELECT Quantity FROM south_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Advantus plastic paper clips')
    UNION ALL
    SELECT Quantity FROM west_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Advantus plastic paper clips')
) AS All_Quantities;
```
-------------------------2364 sample_num
```sql
SELECT Order_ID
FROM (
    SELECT Order_ID, 
           (Sales / (1 - Discount)) * Quantity - Profit AS Total_Cost
    FROM (
        SELECT Order_ID, Sales, Quantity, Discount
        FROM central_superstore
        WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Logitech G600 MMO Gaming Mouse')
        UNION ALL
        SELECT Order_ID, Sales, Quantity, Discount
        FROM east_superstore
        WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Logitech G600 MMO Gaming Mouse')
        UNION ALL
        SELECT Order_ID, Sales, Quantity, Discount
        FROM south_superstore
        WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Logitech G600 MMO Gaming Mouse')
        UNION ALL
        SELECT Order_ID, Sales, Quantity, Discount
        FROM west_superstore
        WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Logitech G600 MMO Gaming Mouse')
    ) AS All_Orders
) AS Cost_Calculations
ORDER BY Total_Cost DESC
LIMIT 1;
```
-------------------------2365 sample_num
```sql
SELECT p.Product_Name
FROM central_superstore cs
JOIN people pe ON cs.Customer_ID = pe.Customer_ID
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Alejandro Grove'
UNION
SELECT p.Product_Name
FROM east_superstore es
JOIN people pe ON es.Customer_ID = pe.Customer_ID
JOIN product p ON es.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Alejandro Grove'
UNION
SELECT p.Product_Name
FROM south_superstore ss
JOIN people pe ON ss.Customer_ID = pe.Customer_ID
JOIN product p ON ss.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Alejandro Grove'
UNION
SELECT p.Product_Name
FROM west_superstore ws
JOIN people pe ON ws.Customer_ID = pe.Customer_ID
JOIN product p ON ws.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Alejandro Grove';
```
-------------------------2366 sample_num
```sql
SELECT COUNT(DISTINCT p.CustomerID)
FROM people p
JOIN central_superstore cs ON p.CustomerID = cs.CustomerID
JOIN product pr ON cs.ProductID = pr.ProductID
WHERE p.City = 'Chicago' 
  AND pr.ProductName = 'Cardinal EasyOpen D-Ring Binders' 
  AND cs.Quantity >= 14;
```
-------------------------2367 sample_num
```sql
SELECT DISTINCT p.Product_Name
FROM product p
JOIN central_superstore cs ON p.Product_ID = cs.Product_ID
WHERE cs.Profit >= 1000
UNION
SELECT DISTINCT p.Product_Name
FROM product p
JOIN east_superstore es ON p.Product_ID = es.Product_ID
WHERE es.Profit >= 1000
UNION
SELECT DISTINCT p.Product_Name
FROM product p
JOIN south_superstore ss ON p.Product_ID = ss.Product_ID
WHERE ss.Profit >= 1000
UNION
SELECT DISTINCT p.Product_Name
FROM product p
JOIN west_superstore ws ON p.Product_ID = ws.Product_ID
WHERE ws.Profit >= 1000;
```
-------------------------2368 sample_num
```sql
SELECT DISTINCT p.Product Name
FROM east_superstore es
JOIN product p ON es.Product ID = p.Product ID
WHERE es.Ship Mode = 'First Class' AND es.Region = 'East'
LIMIT 10;
```
-------------------------2369 sample_num
```sql
SELECT p.Product_Name
FROM central_superstore cs
JOIN people pe ON cs.Customer_ID = pe.Customer_ID
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Becky Martin' AND cs.Region = 'Central';
```
-------------------------2370 sample_num
```sql
SELECT DISTINCT p.Customer_Name
FROM west_superstore ws
JOIN people p ON ws.Customer_ID = p.Customer_ID
WHERE ws.Ship_Mode = 'Second Class'
LIMIT 5;
```
-------------------------2371 sample_num
```sql
SELECT SUM(Profit) AS Total_Profit
FROM central_superstore
WHERE Customer_ID IN (
    SELECT Customer_ID
    FROM people
    WHERE Customer_Name = 'Patrick Gardner' AND Region = 'Central'
);
```
-------------------------2372 sample_num
```sql
SELECT p.Product_Name
FROM south_superstore s
JOIN product p ON s.Product_ID = p.Product_ID
WHERE s.Order_Date = '2013-03-04' AND s.Ship_Mode = 'Same Day';
```
-------------------------2373 sample_num
```sql
SELECT SUM(Sales) AS Total_Sales
FROM central_superstore
WHERE Product_ID IN (
    SELECT Product_ID
    FROM product
    WHERE Product_Name = 'Avery Hi-Liter EverBold Pen Style Fluorescent Highlighters, 4/Pack'
);
```
-------------------------2374 sample_num
```sql
SELECT p.Product_Name
FROM east_superstore es
JOIN product p ON es.Product_ID = p.Product_ID
JOIN people pe ON es.Customer_ID = pe.Customer_ID
WHERE pe.Customer_Name = 'Jonathan Doherty'
ORDER BY es.Quantity DESC
LIMIT 1;
```
-------------------------2375 sample_num
```sql
SELECT p.Product_Name, SUM(e.Quantity) AS Total_Quantity
FROM east_superstore e
JOIN product p ON e.Product_ID = p.Product_ID
WHERE e.Ship_Date = '2015-03-25'
GROUP BY p.Product_Name;
```
-------------------------2376 sample_num
```sql
SELECT p.Customer_Name 
FROM east_superstore es
JOIN people p ON es.Customer_ID = p.Customer_ID
JOIN product pr ON es.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Global High-Back Leather Tilter, Burgundy' 
AND es.Order_Date = DATE('2013-10-13') 
AND es.Region = 'East';
```
-------------------------2377 sample_num
```sql
SELECT p.Category
FROM south_superstore s
JOIN product p ON s.Product_ID = p.Product_ID
JOIN people pe ON s.Customer_ID = pe.Customer_ID
WHERE pe.Customer_Name = 'Katherine Murray' AND s.Order_Date = '2018-11-04';
```
-------------------------2378 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.Category = 'Furniture' THEN cs.Quantity ELSE 0 END) * 1.0 / SUM(cs.Quantity)) * 100 AS Furniture_Percentage
FROM 
    west_superstore cs
JOIN 
    product p ON cs.Product_ID = p.Product_ID
WHERE 
    cs.Ship_Mode = 'Standard Class' AND cs.Region = 'West';
```
-------------------------2379 sample_num
```sql
SELECT cs.Ship_Date 
FROM central_superstore cs
JOIN people p ON cs.Customer_ID = p.Customer_ID
WHERE p.Customer_Name = 'Ann Chong' AND p.Region = 'Central';
```
-------------------------2380 sample_num
```sql
SELECT p.Segment 
FROM people p 
JOIN west_superstore w ON p.Customer_ID = w.Customer_ID 
WHERE w.Order_ID = 'CA-2011-108189';
```
-------------------------2381 sample_num
```sql
SELECT SUM(Sales) AS Total_Sales
FROM west_superstore
WHERE Product_ID IN (
    SELECT Product_ID
    FROM product
    WHERE Product_Name = 'Hon Valutask Swivel Chairs'
);
```
-------------------------2382 sample_num
```sql
SELECT cs.Order_ID 
FROM south_superstore AS ss
JOIN people AS p ON ss.Customer_ID = p.Customer_ID
WHERE p.Customer_Name = 'Frank Olsen' AND p.Region = 'South';
```
-------------------------2383 sample_num
```sql
SELECT p.Product_Name 
FROM central_superstore cs
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE cs.Order_Date = '2018-04-26' 
AND cs.Ship_Date <= '2018-04-27';
```
-------------------------2384 sample_num
```sql
SELECT p.City, p.State
FROM central_superstore cs
JOIN people p ON cs.Customer_ID = p.Customer_ID
WHERE cs.Sales = (SELECT MAX(Sales) FROM central_superstore)
UNION
SELECT p.City, p.State
FROM east_superstore es
JOIN people p ON es.Customer_ID = p.Customer_ID
WHERE es.Sales = (SELECT MAX(Sales) FROM east_superstore)
UNION
SELECT p.City, p.State
FROM south_superstore ss
JOIN people p ON ss.Customer_ID = p.Customer_ID
WHERE ss.Sales = (SELECT MAX(Sales) FROM south_superstore)
UNION
SELECT p.City, p.State
FROM west_superstore ws
JOIN people p ON ws.Customer_ID = p.Customer_ID
WHERE ws.Sales = (SELECT MAX(Sales) FROM west_superstore);
```
-------------------------2385 sample_num
```sql
SELECT p.Customer Name
FROM east_superstore e
JOIN people p ON e.Customer ID = p.Customer ID
WHERE e.Profit = (SELECT MAX(Profit) FROM east_superstore);
```
-------------------------2386 sample_num
```sql
SELECT MAX(Quantity) AS Highest_Quantity
FROM (
    SELECT Quantity
    FROM central_superstore
    JOIN people ON central_superstore.Customer_ID = people.Customer_ID
    WHERE people.City = 'Chicago' AND people.State = 'Illinois'
    
    UNION ALL
    
    SELECT Quantity
    FROM east_superstore
    JOIN people ON east_superstore.Customer_ID = people.Customer_ID
    WHERE people.City = 'Chicago' AND people.State = 'Illinois'
    
    UNION ALL
    
    SELECT Quantity
    FROM south_superstore
    JOIN people ON south_superstore.Customer_ID = people.Customer_ID
    WHERE people.City = 'Chicago' AND people.State = 'Illinois'
    
    UNION ALL
    
    SELECT Quantity
    FROM west_superstore
    JOIN people ON west_superstore.Customer_ID = people.Customer_ID
    WHERE people.City = 'Chicago' AND people.State = 'Illinois'
) AS All_Orders;
```
-------------------------2387 sample_num
```sql
SELECT cs.Order_Date, p.Product_Name
FROM central_superstore cs
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE cs.Order_ID = 'CA-2011-137274' AND cs.Region = 'Central';
```
-------------------------2388 sample_num
```sql
SELECT p.Customer_Name
FROM people p
JOIN south_superstore s ON p.Customer_ID = s.Customer_ID
JOIN product pr ON s.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Xerox 23' AND s.Region = 'South';
```
-------------------------2389 sample_num
```sql
SELECT p.Product_Name
FROM product p
JOIN central_superstore cs ON p.Product_ID = cs.Product_ID
WHERE p.Category = 'Office Supplies'
ORDER BY cs.Sales DESC
LIMIT 1;
```
-------------------------2390 sample_num
```sql
SELECT p.Customer Name
FROM west_superstore w
JOIN people p ON w.Customer ID = p.Customer ID
ORDER BY w.Discount DESC
LIMIT 1;
```
-------------------------2391 sample_num
```sql
SELECT p.Product_Name
FROM product p
JOIN east_superstore e ON p.Product_ID = e.Product_ID
WHERE e.Profit > (SELECT AVG(Profit) * 0.98 FROM east_superstore);
```
-------------------------2392 sample_num
```sql
SELECT DISTINCT p.Customer_Name
FROM people p
JOIN east_superstore e ON p.Customer_ID = e.Customer_ID
WHERE (Sales / (1 - Discount)) * Quantity - Profit > 80000;
```
-------------------------2393 sample_num
```sql
SELECT COUNT(*) 
FROM (
    SELECT Order ID, Order Date 
    FROM central_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Maxwell Schwartz') 
    AND strftime('%Y', "Order Date") = '2015'
    UNION ALL
    SELECT Order ID, Order Date 
    FROM east_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Maxwell Schwartz') 
    AND strftime('%Y', "Order Date") = '2015'
    UNION ALL
    SELECT Order ID, Order Date 
    FROM south_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Maxwell Schwartz') 
    AND strftime('%Y', "Order Date") = '2015'
    UNION ALL
    SELECT Order ID, Order Date 
    FROM west_superstore 
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Maxwell Schwartz') 
    AND strftime('%Y', "Order Date") = '2015'
) AS all_orders;
```
-------------------------2394 sample_num
```sql
SELECT p.Customer_Name
FROM central_superstore cs
JOIN product pr ON cs.Product_ID = pr.Product_ID
JOIN people p ON cs.Customer_ID = p.Customer_ID
WHERE pr.Product_Name = 'Bush Mission Pointe Library' AND cs.Region = 'Central';
```
-------------------------2395 sample_num
```sql
SELECT SUM(Profit) AS Total_Profit
FROM (
    SELECT Profit FROM central_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Cisco SPA301')
    UNION ALL
    SELECT Profit FROM east_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Cisco SPA301')
    UNION ALL
    SELECT Profit FROM south_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Cisco SPA301')
    UNION ALL
    SELECT Profit FROM west_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Cisco SPA301')
) AS All_Profits;
```
-------------------------2396 sample_num
```sql
SELECT p.Product_Name
FROM west_superstore ws
JOIN people pe ON ws.Customer_ID = pe.Customer_ID
JOIN product p ON ws.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Anne McFarland';
```
-------------------------2397 sample_num
```sql
SELECT p.Product_Name
FROM people pe
JOIN central_superstore cs ON pe.Customer_ID = cs.Customer_ID
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE pe.City = 'Coachella'
UNION
SELECT p.Product_Name
FROM people pe
JOIN east_superstore es ON pe.Customer_ID = es.Customer_ID
JOIN product p ON es.Product_ID = p.Product_ID
WHERE pe.City = 'Coachella'
UNION
SELECT p.Product_Name
FROM people pe
JOIN south_superstore ss ON pe.Customer_ID = ss.Customer_ID
JOIN product p ON ss.Product_ID = p.Product_ID
WHERE pe.City = 'Coachella'
UNION
SELECT p.Product_Name
FROM people pe
JOIN west_superstore ws ON pe.Customer_ID = ws.Customer_ID
JOIN product p ON ws.Product_ID = p.Product_ID
WHERE pe.City = 'Coachella';
```
-------------------------2398 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM east_superstore WHERE strftime('%Y', "Order Date") = '2015') AS Eastern_Orders,
    (SELECT COUNT(*) FROM west_superstore WHERE strftime('%Y', "Order Date") = '2015') AS Western_Orders;
```
-------------------------2399 sample_num
```sql
SELECT p.Product_Name
FROM west_superstore ws
JOIN people pe ON ws.Customer_ID = pe.Customer_ID
JOIN product p ON ws.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Matt Abelman' AND ws.Order_Date LIKE '2013%';
```
-------------------------2400 sample_num
```sql
SELECT SUM((Sales / (1 - Discount)) * Quantity) AS Total_Cost
FROM (
    SELECT Sales, Quantity, Discount
    FROM central_superstore
    WHERE Customer_ID = (SELECT Customer_ID FROM people WHERE Customer_Name = 'Brad Thomas')
      AND strftime('%Y', Order_Date) = '2016'
    UNION ALL
    SELECT Sales, Quantity, Discount
    FROM east_superstore
    WHERE Customer_ID = (SELECT Customer_ID FROM people WHERE Customer_Name = 'Brad Thomas')
      AND strftime('%Y', Order_Date) = '2016'
    UNION ALL
    SELECT Sales, Quantity, Discount
    FROM south_superstore
    WHERE Customer_ID = (SELECT Customer_ID FROM people WHERE Customer_Name = 'Brad Thomas')
      AND strftime('%Y', Order_Date) = '2016'
    UNION ALL
    SELECT Sales, Quantity, Discount
    FROM west_superstore
    WHERE Customer_ID = (SELECT Customer_ID FROM people WHERE Customer_Name = 'Brad Thomas')
      AND strftime('%Y', Order_Date) = '2016'
) AS Orders;
```
-------------------------2401 sample_num
```sql
SELECT p.Customer_Name, p.City, p.Country
FROM people p
JOIN central_superstore cs ON p.Customer_ID = cs.Customer_ID
JOIN product pr ON cs.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Plantronics Single Ear Headset'
UNION
SELECT p.Customer_Name, p.City, p.Country
FROM people p
JOIN east_superstore es ON p.Customer_ID = es.Customer_ID
JOIN product pr ON es.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Plantronics Single Ear Headset'
UNION
SELECT p.Customer_Name, p.City, p.Country
FROM people p
JOIN south_superstore ss ON p.Customer_ID = ss.Customer_ID
JOIN product pr ON ss.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Plantronics Single Ear Headset'
UNION
SELECT p.Customer_Name, p.City, p.Country
FROM people p
JOIN west_superstore ws ON p.Customer_ID = ws.Customer_ID
JOIN product pr ON ws.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Plantronics Single Ear Headset';
```
-------------------------2402 sample_num
```sql
SELECT cs.Ship_Date, p.Product_Name
FROM central_superstore cs
JOIN people pe ON cs.Customer_ID = pe.Customer_ID
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Gene Hale'
UNION
SELECT es.Ship_Date, p.Product_Name
FROM east_superstore es
JOIN people pe ON es.Customer_ID = pe.Customer_ID
JOIN product p ON es.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Gene Hale'
UNION
SELECT ss.Ship_Date, p.Product_Name
FROM south_superstore ss
JOIN people pe ON ss.Customer_ID = pe.Customer_ID
JOIN product p ON ss.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Gene Hale'
UNION
SELECT ws.Ship_Date, p.Product_Name
FROM west_superstore ws
JOIN people pe ON ws.Customer_ID = pe.Customer_ID
JOIN product p ON ws.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Gene Hale';
```
-------------------------2403 sample_num
```sql
SELECT COUNT(*) 
FROM south_superstore 
WHERE Ship Mode = 'First Class' 
AND Product ID IN (SELECT Product ID FROM product WHERE Category = 'Furniture');
```
-------------------------2404 sample_num
```sql
SELECT COUNT(*) 
FROM south_superstore ss
JOIN people p ON ss.Customer_ID = p.Customer_ID
JOIN product pr ON ss.Product_ID = pr.Product_ID
WHERE p.Customer_Name = 'Cindy Stewart' 
AND pr.Category = 'Office Supplies';
```
-------------------------2405 sample_num
```sql
SELECT Category
FROM product p
JOIN south_superstore s ON p.Product ID = s.Product ID
GROUP BY Category
ORDER BY SUM(s.Profit) DESC
LIMIT 1;
```
-------------------------2406 sample_num
```sql
SELECT p.Product_Name
FROM east_superstore es
JOIN product p ON es.Product_ID = p.Product_ID
JOIN people pe ON es.Customer_ID = pe.Customer_ID
WHERE pe.Customer_Name = 'Cindy Stewart';
```
-------------------------2407 sample_num
```sql
SELECT DISTINCT p.Product_Name
FROM west_superstore ws
JOIN product p ON ws.Product_ID = p.Product_ID
WHERE ws.Ship_Mode = 'Same Day' 
AND ws.Ship_Date BETWEEN '2013-01-01' AND '2013-12-31';
```
-------------------------2408 sample_num
```sql
SELECT DISTINCT p.Category
FROM central_superstore cs
JOIN product p ON cs.Product_ID = p.Product_ID
JOIN people pe ON cs.Customer_ID = pe.Customer_ID
WHERE pe.Customer_Name = 'Sam Craven'
UNION
SELECT DISTINCT p.Category
FROM east_superstore es
JOIN product p ON es.Product_ID = p.Product_ID
JOIN people pe ON es.Customer_ID = pe.Customer_ID
WHERE pe.Customer_Name = 'Sam Craven';
```
-------------------------2409 sample_num
```sql
SELECT SUM(Quantity) AS Total_Quantity
FROM south_superstore
WHERE Customer_ID = (SELECT Customer_ID FROM people WHERE Customer_Name = 'Cindy Stewart')
AND Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Lexmark X 9575 Professional All-in-One Color Printer');
```
-------------------------2410 sample_num
```sql
SELECT p.Product_Name
FROM central_superstore cs
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE cs.Ship_Mode = 'Standard Class'
GROUP BY p.Product_Name
HAVING SUM(cs.Quantity) >= 10;
```
-------------------------2411 sample_num
```sql
SELECT p.Category
FROM west_superstore ws
JOIN product p ON ws.Product_ID = p.Product_ID
GROUP BY p.Category
ORDER BY SUM(ws.Sales) ASC
LIMIT 1;
```
-------------------------2412 sample_num
```sql
SELECT SUM(Profit) AS Total_Profit
FROM south_superstore
WHERE Product_ID IN (
    SELECT Product_ID
    FROM product
    WHERE Product_Name = 'Memorex Froggy Flash Drive 8 GB'
);
```
-------------------------2413 sample_num
```sql
SELECT SUM(Sales) AS Total_Sales
FROM east_superstore
WHERE Product_ID IN (
    SELECT Product_ID
    FROM product
    WHERE Category = 'Furnitures'
)
AND Order_Date BETWEEN '2016-01-01' AND '2016-12-31';
```
-------------------------2414 sample_num
```sql
SELECT AVG(Sales) AS Average_Sales
FROM (
    SELECT Sales
    FROM east_superstore
    WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Sharp AL-1530CS Digital Copier')
    UNION ALL
    SELECT Sales
    FROM west_superstore
    WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Sharp AL-1530CS Digital Copier')
) AS combined_sales;
```
-------------------------2415 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.Category = 'Office Supplies' AND cs.Region = 'Central' THEN 1 ELSE 0 END) * 100.0 / COUNT(cs.Product_ID)) AS Central_Office_Supplies_Percentage,
    (SUM(CASE WHEN p.Category = 'Office Supplies' AND ss.Region = 'South' THEN 1 ELSE 0 END) * 100.0 / COUNT(ss.Product_ID)) AS South_Office_Supplies_Percentage
FROM 
    central_superstore cs
JOIN 
    product p ON cs.Product_ID = p.Product_ID
JOIN 
    south_superstore ss ON ss.Product_ID = p.Product_ID
WHERE 
    cs.Region = 'Central' OR ss.Region = 'South';
```
-------------------------2416 sample_num
```sql
SELECT 
    SUM(CASE WHEN State = 'Texas' THEN 1 ELSE 0 END) / 
    NULLIF(SUM(CASE WHEN State = 'Indiana' THEN 1 ELSE 0 END), 0) AS Texas_Indiana_Ratio
FROM 
    people;
```
-------------------------2417 sample_num
```sql
SELECT ProductID, COUNT(OrderID) AS order_number
FROM central_superstore
WHERE ProductID IN (SELECT ProductID FROM product WHERE Sub_Category = 'Art')
GROUP BY ProductID
ORDER BY order_number DESC
LIMIT 1;
```
-------------------------2418 sample_num
```sql
SELECT p.Customer_Name
FROM south_superstore s
JOIN people p ON s.Customer_ID = p.Customer_ID
WHERE s.Order_Date BETWEEN '2015-01-01' AND '2015-12-31'
GROUP BY p.Customer_Name
HAVING COUNT(s.Order_ID) > 3;
```
-------------------------2419 sample_num
```sql
SELECT MAX(Profit) AS Highest_Profit
FROM central_superstore
WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Anna Chung');
```
-------------------------2420 sample_num
```sql
SELECT COUNT(*) AS OrderCount
FROM (
    SELECT Order ID, Order Date
    FROM central_superstore
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Corey Roper')
      AND YEAR(Order Date) = 2015
    UNION ALL
    SELECT Order ID, Order Date
    FROM east_superstore
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Corey Roper')
      AND YEAR(Order Date) = 2015
    UNION ALL
    SELECT Order ID, Order Date
    FROM south_superstore
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Corey Roper')
      AND YEAR(Order Date) = 2015
    UNION ALL
    SELECT Order ID, Order Date
    FROM west_superstore
    WHERE Customer ID = (SELECT Customer ID FROM people WHERE Customer Name = 'Corey Roper')
      AND YEAR(Order Date) = 2015
) AS AllOrders;
```
-------------------------2421 sample_num
```sql
SELECT 
    (SUM(CASE WHEN Region = 'East' THEN Sales ELSE 0 END) - 
     SUM(CASE WHEN Region = 'West' THEN Sales ELSE 0 END)) AS Sales_Difference
FROM 
    east_superstore
UNION ALL
SELECT 
    (SUM(CASE WHEN Region = 'East' THEN Sales ELSE 0 END) - 
     SUM(CASE WHEN Region = 'West' THEN Sales ELSE 0 END)) AS Sales_Difference
FROM 
    west_superstore;
```
-------------------------2422 sample_num
```sql
SELECT DISTINCT p.Product_Name
FROM central_superstore cs
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE cs.Profit < 0;
```
-------------------------2423 sample_num
```sql
SELECT p.Product_Name, ws.Ship_Mode
FROM west_superstore ws
JOIN product p ON ws.Product_ID = p.Product_ID
WHERE DATEDIFF(ws.Ship_Date, ws.Order_Date) = (
    SELECT MIN(DATEDIFF(Ship_Date, Order_Date))
    FROM west_superstore
);
```
-------------------------2424 sample_num
```sql
SELECT COUNT(*) AS OrderCount
FROM central_superstore
WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'O''Sullivan Plantations 2-Door Library')
AND Customer_ID = (SELECT Customer_ID FROM people WHERE City = 'Landvery Oak')
AND Ship_Mode = 'First Class';
```
-------------------------2425 sample_num
```sql
SELECT p.Customer_Name
FROM east_superstore es
JOIN people p ON es.Customer_ID = p.Customer_ID
WHERE p.Segment = 'Corporate' AND p.State = 'Rhode Island' AND es.Order_Date BETWEEN '2016-01-01' AND '2016-12-31'
GROUP BY p.Customer_Name
ORDER BY COUNT(es.Order_ID) DESC
LIMIT 1;
```
-------------------------2426 sample_num
```sql
SELECT COUNT(*) 
FROM west_superstore 
WHERE Sales >= 5000 
AND Customer_ID IN (SELECT Customer_ID FROM people WHERE State = 'California');
```
-------------------------2427 sample_num
```sql
SELECT p.Segment
FROM east_superstore e
JOIN people p ON e.Customer_ID = p.Customer_ID
WHERE e.Sales / (1 - e.Discount) = (
    SELECT MAX(Sales / (1 - Discount))
    FROM east_superstore
);
```
-------------------------2428 sample_num
```sql
SELECT DATEDIFF(Ship_Date, Order_Date) AS Shipment_Duration
FROM (
    SELECT Ship_Date, Order_Date
    FROM central_superstore
    WHERE Order_ID = 'CA-2011-134103'
    UNION ALL
    SELECT Ship_Date, Order_Date
    FROM east_superstore
    WHERE Order_ID = 'CA-2011-134103'
    UNION ALL
    SELECT Ship_Date, Order_Date
    FROM south_superstore
    WHERE Order_ID = 'CA-2011-134103'
    UNION ALL
    SELECT Ship_Date, Order_Date
    FROM west_superstore
    WHERE Order_ID = 'CA-2011-134103'
) AS all_orders;
```
-------------------------2429 sample_num
```sql
SELECT COUNT(*) 
FROM (
    SELECT * FROM central_superstore 
    WHERE Quantity > 5 AND Ship Mode = 'First Class'
    UNION ALL
    SELECT * FROM east_superstore 
    WHERE Quantity > 5 AND Ship Mode = 'First Class'
    UNION ALL
    SELECT * FROM south_superstore 
    WHERE Quantity > 5 AND Ship Mode = 'First Class'
    UNION ALL
    SELECT * FROM west_superstore 
    WHERE Quantity > 5 AND Ship Mode = 'First Class'
) AS all_orders;
```
-------------------------2430 sample_num
```sql
SELECT Order ID, Order Date, Ship Date, Sales, Profit
FROM central_superstore
WHERE Profit < 0
LIMIT 3
UNION ALL
SELECT Order ID, Order Date, Ship Date, Sales, Profit
FROM east_superstore
WHERE Profit < 0
LIMIT 3
UNION ALL
SELECT Order ID, Order Date, Ship Date, Sales, Profit
FROM south_superstore
WHERE Profit < 0
LIMIT 3
UNION ALL
SELECT Order ID, Order Date, Ship Date, Sales, Profit
FROM west_superstore
WHERE Profit < 0
LIMIT 3;
```
-------------------------2431 sample_num
```sql
SELECT p.Product_Name
FROM central_superstore cs
JOIN people pe ON cs.Customer_ID = pe.Customer_ID
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Phillina Ober';
```
-------------------------2432 sample_num
```sql
SELECT p.Customer_Name
FROM south_superstore s
JOIN people p ON s.Customer_ID = p.Customer_ID
JOIN product pr ON s.Product_ID = pr.Product_ID
WHERE pr.Product_Name = 'Hon Multipurpose Stacking Arm Chairs'
ORDER BY s.Sales DESC
LIMIT 1;
```
-------------------------2433 sample_num
```sql
SELECT SUM(Profit) AS Total_Profit
FROM (
    SELECT Profit FROM central_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = "O'Sullivan Living Dimensions 2-Shelf Bookcases")
    UNION ALL
    SELECT Profit FROM east_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = "O'Sullivan Living Dimensions 2-Shelf Bookcases")
    UNION ALL
    SELECT Profit FROM south_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = "O'Sullivan Living Dimensions 2-Shelf Bookcases")
    UNION ALL
    SELECT Profit FROM west_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = "O'Sullivan Living Dimensions 2-Shelf Bookcases")
) AS All_Profits;
```
-------------------------2434 sample_num
```sql
SELECT SUM(Quantity) AS Total_Sold
FROM west_superstore
WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Hon Pagoda Stacking Chairs');
```
-------------------------2435 sample_num
```sql
SELECT COUNT(*) AS NumberOfOrders
FROM (
    SELECT * FROM central_superstore
    UNION ALL
    SELECT * FROM east_superstore
    UNION ALL
    SELECT * FROM south_superstore
    UNION ALL
    SELECT * FROM west_superstore
) AS all_superstores
WHERE Customer_ID = (SELECT Customer_ID FROM people WHERE Customer_Name = 'Aaron Bergman')
AND Ship_Mode = 'Standard Class';
```
-------------------------2436 sample_num
```sql
SELECT Sales / (1 - Discount) AS Original_Price
FROM (
    SELECT Sales, Discount
    FROM central_superstore
    WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Black Avery Flip-Chart Easel Binder')
    UNION ALL
    SELECT Sales, Discount
    FROM east_superstore
    WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Black Avery Flip-Chart Easel Binder')
    UNION ALL
    SELECT Sales, Discount
    FROM south_superstore
    WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Black Avery Flip-Chart Easel Binder')
    UNION ALL
    SELECT Sales, Discount
    FROM west_superstore
    WHERE Product_ID = (SELECT Product_ID FROM product WHERE Product_Name = 'Black Avery Flip-Chart Easel Binder')
) AS combined_sales
WHERE Discount < 1;
```
-------------------------2437 sample_num
```sql
SELECT p.Product_Name
FROM people AS pe
JOIN central_superstore AS cs ON pe.Customer_ID = cs.Customer_ID
JOIN product AS p ON cs.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Aimee Bixby'
UNION
SELECT p.Product_Name
FROM people AS pe
JOIN east_superstore AS es ON pe.Customer_ID = es.Customer_ID
JOIN product AS p ON es.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Aimee Bixby'
UNION
SELECT p.Product_Name
FROM people AS pe
JOIN south_superstore AS ss ON pe.Customer_ID = ss.Customer_ID
JOIN product AS p ON ss.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Aimee Bixby'
UNION
SELECT p.Product_Name
FROM people AS pe
JOIN west_superstore AS ws ON pe.Customer_ID = ws.Customer_ID
JOIN product AS p ON ws.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Aimee Bixby';
```
-------------------------2438 sample_num
```sql
SELECT SUM(Profit) AS Total_Profit
FROM (
    SELECT Profit FROM central_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Sauder Camden County Barrister Bookcase, Planked Cherry Finish')
    UNION ALL
    SELECT Profit FROM east_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Sauder Camden County Barrister Bookcase, Planked Cherry Finish')
    UNION ALL
    SELECT Profit FROM south_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Sauder Camden County Barrister Bookcase, Planked Cherry Finish')
    UNION ALL
    SELECT Profit FROM west_superstore WHERE Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Sauder Camden County Barrister Bookcase, Planked Cherry Finish')
) AS All_Profits;
```
-------------------------2439 sample_num
```sql
SELECT COUNT(*) 
FROM east_superstore 
JOIN product ON east_superstore.Product_ID = product.Product_ID 
WHERE product.Category = 'Furniture' 
AND east_superstore.Ship_Mode = 'Standard Class';
```
-------------------------2440 sample_num
```sql
SELECT MAX(Profit) AS Highest_Profit
FROM east_superstore
WHERE Customer_ID IN (
    SELECT Customer_ID
    FROM people
    WHERE City = 'Houston' AND State = 'Texas'
);
```
-------------------------2441 sample_num
```sql
SELECT COUNT(*) 
FROM central_superstore cs
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE p.Category = 'Furniture';
```
-------------------------2442 sample_num
```sql
SELECT DISTINCT p.Product_Name
FROM central_superstore cs
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE cs.Ship_Date LIKE '2013-03%';
```
-------------------------2443 sample_num
```sql
SELECT COUNT(*) AS OrderCount
FROM central_superstore cs
JOIN people p ON cs.Customer_ID = p.Customer_ID
WHERE p.State = 'Texas';
```
-------------------------2444 sample_num
```sql
SELECT COUNT(*) 
FROM central_superstore 
WHERE Customer_ID IN (SELECT Customer_ID FROM people WHERE Customer_Name = 'Alan Barnes') 
AND Order_Date LIKE '2015%';
```
-------------------------2445 sample_num
```sql
SELECT p.Product_Name 
FROM east_superstore es 
JOIN product p ON es.Product_ID = p.Product_ID 
WHERE es.Order_ID = 'CA-2011-115791';
```
-------------------------2446 sample_num
```sql
SELECT 
    (SUM(CASE WHEN Discount = 0.2 AND Customer ID IN (SELECT Customer ID FROM people WHERE State = 'Texas') THEN 1 ELSE 0 END) * 100.0) / 
    NULLIF(COUNT(Order ID), 0) AS percentage
FROM 
    central_superstore;
```
-------------------------2447 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.Category = 'Furniture' AND cs.Ship_Mode = 'First Class' AND cs.Ship_Date LIKE '2013%' THEN 1 ELSE 0 END) * 100.0) / 
    NULLIF(SUM(CASE WHEN p.Category = 'Furniture' AND cs.Ship_Date LIKE '2013%' THEN 1 ELSE 0 END), 0) AS percentage
FROM 
    central_superstore cs
JOIN 
    product p ON cs.Product_ID = p.Product_ID;
```
-------------------------2448 sample_num
```sql
SELECT p.Customer_Name 
FROM west_superstore w 
JOIN people p ON w.Customer_ID = p.Customer_ID 
WHERE w.Order_Date = '2013-08-12' AND w.Discount = 0.2;
```
-------------------------2449 sample_num
```sql
SELECT Order_ID 
FROM central_superstore 
WHERE Order_Date = '2013-06-03' 
AND Product_ID IN (SELECT Product_ID FROM product WHERE Product_Name = 'Security-Tint Envelopes');
```
-------------------------2450 sample_num
```sql
SELECT p.Product_Name
FROM central_superstore cs
JOIN people pe ON cs.Customer_ID = pe.Customer_ID
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE pe.Customer_Name = 'Bill Shonely' AND pe.Region = 'Central';
```
-------------------------2451 sample_num
```sql
SELECT p.Customer_Name
FROM west_superstore ws
JOIN people p ON ws.Customer_ID = p.Customer_ID
WHERE ws.Quantity = 8;
```
-------------------------2452 sample_num
```sql
SELECT SUM(cs.Profit) AS Total_Profit
FROM central_superstore cs
JOIN people p ON cs.Customer_ID = p.Customer_ID
WHERE p.State = 'Texas' AND p.City = 'Houston';
```
-------------------------2453 sample_num
```sql
SELECT p.Customer_Name 
FROM east_superstore es 
JOIN people p ON es.Customer_ID = p.Customer_ID 
WHERE es.Ship_Date = '2013-03-05';
```
-------------------------2454 sample_num
```sql
SELECT p.Product_Name
FROM central_superstore cs
JOIN product p ON cs.Product_ID = p.Product_ID
WHERE cs.Order_Date LIKE '2016%'
ORDER BY cs.Profit ASC
LIMIT 1;
```
-------------------------2455 sample_num
```sql
SELECT p.Customer Name
FROM east_superstore es
JOIN people p ON es.Customer ID = p.Customer ID
WHERE es.Order ID = 'CA-2011-118976';
```
-------------------------2456 sample_num
```sql
SELECT p.Product_Name
FROM south_superstore s
JOIN product p ON s.Product_ID = p.Product_ID
WHERE s.Sales = (SELECT MAX(Sales) FROM south_superstore);
```
-------------------------2457 sample_num
```sql
SELECT p.Sub_Category, 
       e.Sales, 
       e.Profit 
FROM east_superstore e
JOIN product p ON e.Product_ID = p.Product_ID
WHERE e.Order_ID = 'US-2011-126571';
```
-------------------------2458 sample_num
```sql
SELECT p.Product_Name
FROM (
    SELECT Product_ID, MAX(Quantity) AS Max_Quantity
    FROM (
        SELECT Product_ID, Quantity FROM central_superstore
        UNION ALL
        SELECT Product_ID, Quantity FROM east_superstore
        UNION ALL
        SELECT Product_ID, Quantity FROM south_superstore
        UNION ALL
        SELECT Product_ID, Quantity FROM west_superstore
    ) AS All_Stores
    GROUP BY Product_ID
) AS Max_Quantities
JOIN product p ON Max_Quantities.Product_ID = p.Product_ID
WHERE Max_Quantities.Max_Quantity = (
    SELECT MAX(Quantity)
    FROM (
        SELECT Quantity FROM central_superstore
        UNION ALL
        SELECT Quantity FROM east_superstore
        UNION ALL
        SELECT Quantity FROM south_superstore
        UNION ALL
        SELECT Quantity FROM west_superstore
    ) AS All_Quantities
);
```
-------------------------2459 sample_num
```sql
SELECT p.Customer_Name
FROM south_superstore s
JOIN people p ON s.Customer_ID = p.Customer_ID
WHERE s.Ship_Mode = 'Standard Class' 
AND s.Sales > (SELECT AVG(Sales) * 0.88 FROM (
    SELECT Sales FROM central_superstore
    UNION ALL
    SELECT Sales FROM east_superstore
    UNION ALL
    SELECT Sales FROM south_superstore
    UNION ALL
    SELECT Sales FROM west_superstore
) AS all_sales);
```
-------------------------2460 sample_num
```sql
SELECT 
    (SUM(CASE WHEN cs.Discount = 0 THEN 1 ELSE 0 END) * 100.0 / COUNT(cs.Discount)) AS percentage
FROM 
    central_superstore cs
JOIN 
    people p ON cs.Customer_ID = p.Customer_ID
WHERE 
    p.State = 'Indiana';
```
-------------------------2461 sample_num
```sql
SELECT (COUNT(CASE WHEN race = 'W' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_white_male_officers
FROM officers
WHERE gender = 'M';
```
-------------------------2462 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN subject_count > 3 THEN case_number END) * 100.0 / COUNT(case_number)) AS percentage
FROM 
    incidents
WHERE 
    date BETWEEN '2010-01-01' AND '2015-12-31';
```
-------------------------2463 sample_num
```sql
SELECT YEAR(date) AS year, COUNT(case_number) AS case_count
FROM incidents
WHERE subject_weapon = 'Handgun'
GROUP BY YEAR(date)
ORDER BY case_count DESC
LIMIT 1;
```
-------------------------2464 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN subject_statuses = 'injured' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_injured
FROM 
    incidents
WHERE 
    grand_jury_disposition = 'No Bill';
```
-------------------------2465 sample_num
```sql
SELECT 
    (SELECT COUNT(case_number) FROM incidents WHERE subject_weapon = 'Vehicle' AND date BETWEEN '2007-01-01' AND '2007-12-31') AS cases_2007,
    (SELECT COUNT(case_number) FROM incidents WHERE subject_weapon = 'Vehicle' AND date BETWEEN '2008-01-01' AND '2008-12-31') AS cases_2008,
    (SELECT COUNT(case_number) FROM incidents WHERE subject_weapon = 'Vehicle' AND date BETWEEN '2008-01-01' AND '2008-12-31') - 
    (SELECT COUNT(case_number) FROM incidents WHERE subject_weapon = 'Vehicle' AND date BETWEEN '2007-01-01' AND '2007-12-31') AS difference
```
-------------------------2466 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN subject_statuses = 'Shoot and Miss' THEN 1 END) * 100.0 / COUNT(*)) AS percent_shoot_and_miss
FROM 
    incidents
WHERE 
    subject_weapon = 'Handgun';
```
-------------------------2467 sample_num
```sql
SELECT o.last_name, o.gender
FROM officers o
JOIN incidents i ON o.case_number = i.case_number
WHERE i.grand_jury_disposition = 'No Bill';
```
-------------------------2468 sample_num
```sql
SELECT i.case_number, i.subject_statuses, i.subject_weapon
FROM incidents i
JOIN subjects s ON i.case_number = s.case_number
WHERE s.gender = 'F';
```
-------------------------2469 sample_num
```sql
SELECT i.case_number, i.location, i.subject_statuses
FROM incidents i
JOIN subjects s ON i.case_number = s.case_number
WHERE s.gender = 'M';
```
-------------------------2470 sample_num
```sql
SELECT i.case_number, i.grand_jury_disposition
FROM incidents i
JOIN officers o ON i.case_number = o.case_number
WHERE o.full_name = 'Evenden, George';
```
-------------------------2471 sample_num
```sql
SELECT o.last_name, i.subject_statuses
FROM incidents i
JOIN officers o ON i.case_number = o.case_number
WHERE i.case_number = '134472-2015';
```
-------------------------2472 sample_num
```sql
SELECT subjects.last_name, subjects.gender, subjects.race, incidents.case_number
FROM incidents
JOIN subjects ON incidents.case_number = subjects.case_number
WHERE incidents.subject_statuses = 'Deceased';
```
-------------------------2473 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN subject_weapon = 'Vehicle' THEN case_number END) * 100.0 / COUNT(case_number)) AS female_vehicle_percentage
FROM 
    subjects
WHERE 
    gender = 'F';
```
-------------------------2474 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN subject_weapon = 'knife' THEN case_number END) * 1.0) / 
    (COUNT(CASE WHEN subject_weapon = 'toy handgun' THEN case_number END) * 1.0) AS weapon_ratio
FROM 
    incidents
WHERE 
    subject_statuses = 'Injured';
```
-------------------------2475 sample_num
```sql
SELECT * 
FROM incidents 
WHERE date BETWEEN '2012-01-01' AND '2012-12-31' 
AND subject_statuses = 'Deceased';
```
-------------------------2476 sample_num
```sql
SELECT (COUNT(CASE WHEN race = 'B' THEN 1 END) * 100.0 / COUNT(*)) AS black_officer_percentage
FROM officers
WHERE gender = 'M';
```
-------------------------2477 sample_num
```sql
SELECT COUNT(*) 
FROM incidents i
JOIN officers o ON i.case_number = o.case_number
WHERE i.subject_weapon = 'Vehicle' AND o.gender = 'F';
```
-------------------------2478 sample_num
```sql
SELECT COUNT(*) 
FROM incidents 
WHERE subject_statuses = 'Deceased' 
AND subjects IN (SELECT full_name FROM subjects WHERE gender = 'F');
```
-------------------------2479 sample_num
```sql
SELECT COUNT(*) 
FROM officers 
JOIN incidents ON officers.case_number = incidents.case_number 
WHERE officers.race = 'B' 
AND incidents.date BETWEEN '2010-01-01' AND '2015-12-31';
```
-------------------------2480 sample_num
```sql
SELECT COUNT(case_number) 
FROM incidents 
WHERE date BETWEEN '2015-06-01' AND '2015-06-30';
```
-------------------------2481 sample_num
```sql
SELECT COUNT(*) 
FROM incidents 
WHERE subject_statuses = 'injured' 
  AND date BETWEEN '2006-01-01' AND '2013-12-31' 
  AND subject_weapon = 'handgun';
```
-------------------------2482 sample_num
```sql
SELECT subject_weapon
FROM incidents
WHERE subject_statuses = 'Deceased'
GROUP BY subject_weapon
ORDER BY COUNT(subject_weapon) DESC
LIMIT 1;
```
-------------------------2483 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN race = 'W' AND gender = 'M' THEN 1 END) * 100.0 / COUNT(*)) AS proportion_white_males,
    (COUNT(CASE WHEN race = 'W' AND gender = 'F' THEN 1 END) * 100.0 / COUNT(*)) AS proportion_white_females
FROM officers;
```
-------------------------2484 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM subjects WHERE race = 'B' AND gender = 'F') - 
    (SELECT COUNT(*) FROM subjects WHERE race = 'W' AND gender = 'F') AS difference
```
-------------------------2485 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN subject_weapon = 'rifles' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_of_deaths_by_rifles
FROM 
    incidents
WHERE 
    subject_statuses = 'Deceased';
```
-------------------------2486 sample_num
```sql
SELECT i.subject_weapon, s.race, s.gender
FROM incidents i
JOIN subjects s ON i.case_number = s.case_number
WHERE i.case_number = '031347-2015';
```
-------------------------2487 sample_num
```sql
SELECT s.race, s.gender
FROM incidents i
JOIN officers o ON i.case_number = o.case_number
JOIN subjects s ON i.case_number = s.case_number
WHERE i.subject_statuses = 'Deceased Injured' AND o.full_name = 'Ruben Fredirick';
```
-------------------------2488 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN o.gender = 'M' THEN o.case_number END) * 100.0 / COUNT(o.case_number)) AS male_officer_proportion
FROM 
    incidents i
JOIN 
    officers o ON i.case_number = o.case_number
WHERE 
    i.subject_statuses = 'Injured';
```
-------------------------2489 sample_num
```sql
SELECT COUNT(DISTINCT Chromosome) AS NumberOfChromosomes
FROM Genes
WHERE Localization = 'plasma membrane';
```
-------------------------2490 sample_num
```sql
SELECT COUNT(*) 
FROM Genes 
WHERE Essential = 'No' AND Localization = 'Nucleus';
```
-------------------------2491 sample_num
```sql
SELECT COUNT(DISTINCT g.GeneID)
FROM Genes g
JOIN Classification c ON g.GeneID = c.GeneID
WHERE g.Phenotype LIKE '%nucleic acid metabolism%' AND c.Localization = 'vacuole';
```
-------------------------2492 sample_num
```sql
SELECT Localization
FROM Genes
WHERE Chromosome IN (
    SELECT Chromosome
    FROM Genes
    GROUP BY Chromosome
    ORDER BY COUNT(DISTINCT GeneID) DESC
    LIMIT 1
);
```
-------------------------2493 sample_num
```sql
SELECT MAX(i.Expression_Corr) AS Highest_Expression_Corr
FROM Interactions i
JOIN Classification c1 ON i.GeneID1 = c1.GeneID
JOIN Classification c2 ON i.GeneID2 = c2.GeneID
WHERE c1.Localization = 'nucleus' AND c2.Localization = 'nucleus';
```
-------------------------2494 sample_num
```sql
SELECT g1.Function AS Function_Gene1, g2.Function AS Function_Gene2
FROM Interactions i
JOIN Genes g1 ON i.GeneID1 = g1.GeneID
JOIN Genes g2 ON i.GeneID2 = g2.GeneID
ORDER BY i.Expression_Corr ASC
LIMIT 1;
```
-------------------------2495 sample_num
```sql
SELECT COUNT(*) 
FROM Interactions i
JOIN Genes g1 ON i.GeneID1 = g1.GeneID
JOIN Genes g2 ON i.GeneID2 = g2.GeneID
WHERE g1.Class != 'motorproteins' AND g2.Class != 'motorproteins' 
AND i.Expression_Corr < 0;
```
-------------------------2496 sample_num
```sql
SELECT MAX(i.Expression_Corr) AS Highest_Expression_Corr
FROM Interactions i
JOIN Genes g1 ON i.GeneID1 = g1.GeneID
JOIN Genes g2 ON i.GeneID2 = g2.GeneID
WHERE g1.Chromosome = 8 AND g2.Chromosome = 6;
```
-------------------------2497 sample_num
```sql
SELECT g.Motif 
FROM Genes g 
WHERE g.Localization = 'cytoplasm' AND g.Chromosome = 7;
```
-------------------------2498 sample_num
```sql
SELECT COUNT(*) 
FROM Genes 
WHERE Essential = 'No' 
AND Function = 'transcription' 
AND Localization <> 'cytoplasm';
```
-------------------------2499 sample_num
```sql
SELECT COUNT(*) 
FROM Interactions i
JOIN Genes g1 ON i.GeneID1 = g1.GeneID
JOIN Genes g2 ON i.GeneID2 = g2.GeneID
WHERE i.Expression_Corr > 0 AND g1.Essential = 'No' AND g2.Essential = 'No';
```
-------------------------2500 sample_num
```sql
SELECT 
    COUNT(CASE WHEN g1.Chromosome > 20 AND g2.Chromosome > 20 THEN 1 END) * 1.0 / COUNT(*) AS Possibility
FROM 
    Interactions i
JOIN 
    Genes g1 ON i.GeneID1 = g1.GeneID
JOIN 
    Genes g2 ON i.GeneID2 = g2.GeneID
WHERE 
    i.Expression_Corr > 0;
```
-------------------------2501 sample_num
```sql
SELECT AVG(i.Expression_Corr) AS Average_Expression_Corr
FROM Interactions i
JOIN Genes g1 ON i.GeneID1 = g1.GeneID
JOIN Genes g2 ON i.GeneID2 = g2.GeneID
WHERE g1.Class = 'ATPases' AND g2.Class = 'ATPases';
```
-------------------------2502 sample_num
```sql
SELECT GeneID 
FROM Genes 
WHERE Localization = 'cytoplasm' AND Function = 'metabolism' 
ORDER BY GeneID;
```
-------------------------2503 sample_num
```sql
SELECT COUNT(DISTINCT GeneID) AS TotalGenes
FROM Genes
WHERE Localization IN ('plasma', 'nucleus');
```
-------------------------2504 sample_num
```sql
SELECT 
    COUNT(CASE WHEN i.Expression_Corr < 0 THEN 1 END) * 100.0 / COUNT(*) AS Negative_Correlation_Percentage
FROM 
    Interactions i
WHERE 
    i.Type = 'physical';
```
-------------------------2505 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN g.Class = 'unknown' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_unknown_class,
    COUNT(CASE WHEN g.Class = 'unknown' AND g.Phenotype != 'conditional' THEN 1 END) AS not_conditional_count
FROM 
    Genes g
JOIN 
    Classification c ON g.GeneID = c.GeneID
WHERE 
    c.Localization = 'cytoskeleton';
```
-------------------------2506 sample_num
```sql
SELECT i.Type
FROM Genes g
JOIN Interactions i ON g.GeneID = i.GeneID1 OR g.GeneID = i.GeneID2
WHERE g.Function IN ('cellular transport', 'transport medicine') 
AND g.Essential = 'non-essential';
```
-------------------------2507 sample_num
```sql
SELECT DISTINCT g.GeneID
FROM Genes g
JOIN Interactions i ON g.GeneID = i.GeneID1
JOIN Classification c ON i.GeneID2 = c.GeneID
WHERE c.Localization = 'nucleus' AND i.Expression_Corr > 0;
```
-------------------------2508 sample_num
```sql
SELECT g.GeneID
FROM Genes g
JOIN Interactions i ON g.GeneID = i.GeneID1
WHERE g.Essential = 'Yes'
  AND g.Class = 'Transcription Factor'
  AND g.Localization = 'Nucleus'
  AND i.Type = 'Genetic';
```
-------------------------2509 sample_num
```sql
SELECT COUNT(*) 
FROM Genes g 
LEFT JOIN Interactions i ON g.GeneID = i.GeneID1 
WHERE g.Essential = 'No' 
  AND g.Class != 'motorprotein' 
  AND g.Phenotype = 'cell cycle defects' 
  AND (i.Type IS NULL OR i.Type != 'physical');
```
-------------------------2510 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN i.Type = 'positive' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_positive_interaction
FROM 
    Genes g
LEFT JOIN 
    Interactions i ON g.GeneID = i.GeneID1 OR g.GeneID = i.GeneID2
WHERE 
    g.Phenotype = 'nucleic acid metabolism defects' AND 
    g.Motif = 'PS00107';
```
-------------------------2511 sample_num
```sql
WITH Negatively_Correlated AS (
    SELECT g1.GeneID AS GeneID1, g2.GeneID AS GeneID2, g1.Essential
    FROM Interactions i
    JOIN Genes g1 ON i.GeneID1 = g1.GeneID
    JOIN Genes g2 ON i.GeneID2 = g2.GeneID
    WHERE i.Expression_Corr < 0
),
Counts AS (
    SELECT 
        SUM(CASE WHEN Essential = 'No' THEN 1 ELSE 0 END) AS Non_Essential_Count,
        SUM(CASE WHEN Essential = 'Yes' THEN 1 ELSE 0 END) AS Essential_Count
    FROM Negatively_Correlated
)
SELECT 
    Non_Essential_Count,
    Essential_Count,
    (Non_Essential_Count * 100.0 / NULLIF(Non_Essential_Count + Essential_Count, 0)) AS Percentage_Non_Essential
FROM Counts;
```
-------------------------2512 sample_num
```sql
SELECT p.App, ur.Translated_Review
FROM playstore p
LEFT JOIN user_reviews ur ON p.App = ur.App
WHERE p.Last_Updated BETWEEN '2018-01-01' AND '2018-01-31' 
AND ur.Sentiment = 'positive';
```
-------------------------2513 sample_num
```sql
SELECT COUNT(*) AS Mild_Likes, p.Last_Updated
FROM user_reviews ur
JOIN playstore p ON ur.App = p.App
WHERE ur.App = '7 Minute Workout' AND ur.Sentiment_Polarity >= 0 AND ur.Sentiment_Polarity < 0.5;
```
-------------------------2514 sample_num
```sql
SELECT COUNT(*) AS Neutral_User_Count, p.Rating
FROM user_reviews u
JOIN playstore p ON u.App = p.App
WHERE u.App = 'HTC Weather' AND u.Sentiment = 'Neutral';
```
-------------------------2515 sample_num
```sql
SELECT p.App, p.Category
FROM playstore p
JOIN (
    SELECT App, COUNT(*) AS negative_count
    FROM user_reviews
    WHERE Sentiment_Polarity = -1
    GROUP BY App
) ur ON p.App = ur.App
ORDER BY ur.negative_count DESC
LIMIT 1;
```
-------------------------2516 sample_num
```sql
SELECT AVG(ur.Sentiment_Polarity) AS Average_Sentiment_Polarity, p.Content_Rating
FROM user_reviews ur
JOIN playstore p ON ur.App = p.App
WHERE p.App = 'Cooking Fever';
```
-------------------------2517 sample_num
```sql
SELECT MIN(ur.Sentiment_Polarity) AS Lowest_Polarity, p.Installs
FROM user_reviews ur
JOIN playstore p ON ur.App = p.App
WHERE p.App = 'Basketball Stars' AND ur.Sentiment_Polarity < -0.5;
```
-------------------------2518 sample_num
```sql
SELECT COUNT(*) AS Review_Count, Current_Ver 
FROM playstore 
JOIN user_reviews ON playstore.App = user_reviews.App 
WHERE playstore.App = 'Akinator' AND user_reviews.Sentiment_Subjectivity <= 0.5;
```
-------------------------2519 sample_num
```sql
SELECT COUNT(*) FROM playstore WHERE Rating = 5;
```
-------------------------2520 sample_num
```sql
SELECT App, Installs 
FROM playstore 
WHERE Price = 0 
ORDER BY Installs DESC 
LIMIT 5;
```
-------------------------2521 sample_num
```sql
SELECT App, Reviews
FROM playstore
ORDER BY Reviews DESC
LIMIT 10;
```
-------------------------2522 sample_num
```sql
SELECT COUNT(*) AS Neutral_User_Count, p.Category
FROM user_reviews ur
JOIN playstore p ON ur.App = p.App
WHERE ur.App = '10 Best Foods for You' AND ur.Sentiment = 'Neutral';
```
-------------------------2523 sample_num
```sql
SELECT p.App, p.Installs
FROM playstore p
JOIN user_reviews r ON p.App = r.App
WHERE r.Sentiment_Polarity = 'Positive';
```
-------------------------2524 sample_num
```sql
SELECT p.App, u.Translated_Review
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p.Rating = 3.9;
```
-------------------------2525 sample_num
```sql
SELECT COUNT(DISTINCT p.App) AS Compatible_Apps_Count, u.Translated_Review, u.Sentiment
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p.Type = 'Free' AND p.Content_Rating = 'Everyone' AND p.App LIKE '%Android Ver 8.0 and up%'
GROUP BY u.Translated_Review, u.Sentiment;
```
-------------------------2526 sample_num
```sql
SELECT p.App, SUM(u.Sentiment_Subjectivity) AS Total_Sentiment_Subjectivity
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE LENGTH(p.Genres) - LENGTH(REPLACE(p.Genres, ',', '')) > 0
GROUP BY p.App
HAVING COUNT(DISTINCT p.Genres) > 1;
```
-------------------------2527 sample_num
```sql
SELECT p.App, u.Sentiment
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p."Last Updated" < '2015-01-01';
```
-------------------------2528 sample_num
```sql
SELECT SUM(p.Installs) AS total_installs, u.Translated_Review
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p.Content_Rating = 'Adults only 18+'
GROUP BY u.Translated_Review;
```
-------------------------2529 sample_num
```sql
SELECT p.App, AVG(u.Sentiment_Polarity) AS Sentiment_Polarity
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE (p.Price * p.Installs) = (SELECT MAX(Price * Installs) FROM playstore)
GROUP BY p.App;
```
-------------------------2530 sample_num
```sql
SELECT AVG(p.Rating) AS average_rating, SUM(CASE WHEN u.Sentiment = 'Positive' THEN 1 ELSE 0 END) AS positive_users
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p.Category = 'COMICS';
```
-------------------------2531 sample_num
```sql
SELECT Rating FROM playstore WHERE App = 'Draw A Stickman';
```
-------------------------2532 sample_num
```sql
SELECT COUNT(*) 
FROM user_reviews 
WHERE App = 'Brit + Co' AND Translated_Review IS NOT NULL;
```
-------------------------2533 sample_num
```sql
SELECT App, Reviews 
FROM playstore 
WHERE Genres = 'Shopping' 
ORDER BY Reviews DESC 
LIMIT 5;
```
-------------------------2534 sample_num
```sql
SELECT COUNT(*) 
FROM user_reviews 
WHERE App = 'Dino War: Rise of Beasts' AND Sentiment = 'Neutral';
```
-------------------------2535 sample_num
```sql
SELECT App FROM playstore WHERE Installs = '5,000+';
```
-------------------------2536 sample_num
```sql
SELECT Translated_Review 
FROM user_reviews 
WHERE App = 'Dog Run - Pet Dog Simulator' AND Sentiment = 'Negative';
```
-------------------------2537 sample_num
```sql
SELECT p.App, COUNT(u.Sentiment) AS Negative_Comments
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p.Type = 'Free' AND u.Sentiment = 'Negative'
GROUP BY p.App
ORDER BY Negative_Comments DESC
LIMIT 1;
```
-------------------------2538 sample_num
```sql
SELECT COUNT(*) 
FROM user_reviews 
WHERE Sentiment = 'Negative' 
AND App IN (
    SELECT App 
    FROM playstore 
    WHERE Installs >= '100000000'
);
```
-------------------------2539 sample_num
```sql
SELECT p.Content_Rating
FROM playstore p
JOIN user_reviews r ON p.App = r.App
WHERE r.Translated_Review LIKE '%gr8%';
```
-------------------------2540 sample_num
```sql
SELECT SUM(ur.Sentiment_Polarity) AS Total_Sentiment_Polarity
FROM user_reviews ur
JOIN playstore p ON ur.App = p.App
WHERE p.Price = (SELECT MAX(Price) FROM playstore);
```
-------------------------2541 sample_num
```sql
SELECT p.Rating, r.Translated_Review 
FROM playstore p 
JOIN user_reviews r ON p.App = r.App 
WHERE p.App = 'Garden Coloring Book';
```
-------------------------2542 sample_num
```sql
SELECT ur.App
FROM user_reviews ur
JOIN playstore p ON ur.App = p.App
WHERE p.Genres = 'Photography'
GROUP BY ur.App
ORDER BY SUM(ur.Sentiment_Subjectivity) DESC
LIMIT 1;
```
-------------------------2543 sample_num
```sql
SELECT ur.Translated_Review 
FROM user_reviews ur 
JOIN playstore p ON ur.App = p.App 
WHERE p.Rating = 1 AND p.Content_Rating = 'Mature 17+';
```
-------------------------2544 sample_num
```sql
SELECT p.Installs
FROM playstore p
JOIN (
    SELECT App, SUM(Sentiment_Polarity) AS total_polarity
    FROM user_reviews
    GROUP BY App
) r ON p.App = r.App
WHERE r.total_polarity = (
    SELECT MAX(total_polarity)
    FROM (
        SELECT SUM(Sentiment_Polarity) AS total_polarity
        FROM user_reviews
        GROUP BY App
    ) AS subquery
);
```
-------------------------2545 sample_num
```sql
SELECT COUNT(*) 
FROM user_reviews 
WHERE Sentiment = 'Neutral' 
AND App IN (SELECT App FROM playstore WHERE Genres LIKE '%Weather%');
```
-------------------------2546 sample_num
```sql
SELECT p.App, COUNT(u.Translated_Review) AS No_Comment_Reviews
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p.Installs > 1000000000 AND u.Translated_Review = 'nan'
GROUP BY p.App
ORDER BY No_Comment_Reviews DESC
LIMIT 1;
```
-------------------------2547 sample_num
```sql
SELECT p.Rating, SUM(u.Sentiment_Subjectivity) AS Total_Sentiment_Subjectivity
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p.App = 'Onefootball - Soccer Scores'
GROUP BY p.Rating;
```
-------------------------2548 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p."Content Rating" = 'Teen' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    playstore p
JOIN 
    user_reviews r ON p.App = r.App
WHERE 
    r.Translated_Review = 'nan';
```
-------------------------2549 sample_num
```sql
SELECT App FROM playstore WHERE Rating = 5;
```
-------------------------2550 sample_num
```sql
SELECT App 
FROM playstore 
WHERE Reviews > 75000000 AND Content_Rating = 'Teen';
```
-------------------------2551 sample_num
```sql
SELECT DISTINCT Genres 
FROM playstore 
WHERE Installs = '1,000,000,000+';
```
-------------------------2552 sample_num
```sql
SELECT AVG(Price) AS average_price 
FROM playstore 
WHERE Genres = 'Dating';
```
-------------------------2553 sample_num
```sql
SELECT AVG(Installs) AS Average_Downloads
FROM playstore
WHERE Category = 'ENTERTAINMENT' AND Size <= '1.0M';
```
-------------------------2554 sample_num
```sql
SELECT AVG(Reviews) AS average_review
FROM playstore
WHERE Rating = 5;
```
-------------------------2555 sample_num
```sql
SELECT Genres, COUNT(*) AS Review_Count
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE u.Sentiment_Polarity > 0.5
GROUP BY Genres
ORDER BY Review_Count DESC
LIMIT 3;
```
-------------------------2556 sample_num
```sql
SELECT 
    (COUNT(DISTINCT p.App) * 100.0 / COUNT(DISTINCT p.App)) AS percentage
FROM 
    playstore p
JOIN 
    user_reviews r ON p.App = r.App
WHERE 
    p.Rating = 4.7
GROUP BY 
    p.App
HAVING 
    SUM(CASE WHEN r.Sentiment = 'Positive' THEN 1 ELSE 0 END) > 
    SUM(CASE WHEN r.Sentiment = 'Negative' THEN 1 ELSE 0 END);
```
-------------------------2557 sample_num
```sql
SELECT p.App, AVG(u.Sentiment_Polarity) AS Average_Rating
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE u.Sentiment != 'Negative'
GROUP BY p.App;
```
-------------------------2558 sample_num
```sql
SELECT 
    p.App,
    (SUM(CASE WHEN u.Sentiment = 'Negative' THEN 1 ELSE 0 END) * 100.0 / NULLIF(SUM(CASE WHEN u.Sentiment IN ('Positive', 'Negative') THEN 1 ELSE 0 END), 0)) AS negative_sentiment_percentage
FROM 
    playstore p
LEFT JOIN 
    user_reviews u ON p.App = u.App
WHERE 
    p.Last_Updated < '2015-01-01'
GROUP BY 
    p.App;
```
-------------------------2559 sample_num
```sql
SELECT 
    (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM playstore WHERE Type = 'Free')) AS percentage
FROM 
    playstore
WHERE 
    Type = 'Free' AND 
    Rating >= 4.5 AND 
    Last_Updated < '2019-01-01';
```
-------------------------2560 sample_num
```sql
SELECT Genres FROM playstore WHERE App = 'Honkai Impact 3rd';
```
-------------------------2561 sample_num
```sql
SELECT Rating FROM playstore WHERE App = 'Learn C++';
```
-------------------------2562 sample_num
```sql
SELECT AVG(Price) AS average_price
FROM playstore
WHERE Genres LIKE '%Arcade%'
AND "Content Rating" = 'Everyone 10+';
```
-------------------------2563 sample_num
```sql
SELECT p.Size, COUNT(u.App) AS Positive_Users
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p.App = 'Browser 4G' AND u.Sentiment_Polarity = 0.5
GROUP BY p.Size;
```
-------------------------2564 sample_num
```sql
SELECT p.App, p.Installs 
FROM playstore p 
JOIN user_reviews r ON p.App = r.App 
WHERE r.Sentiment_Subjectivity = 0.3;
```
-------------------------2565 sample_num
```sql
SELECT AVG(ur.Sentiment_Polarity) AS Average_Sentiment_Polarity, p.Rating
FROM user_reviews ur
JOIN playstore p ON ur.App = p.App
WHERE ur.App = 'Golf GPS Rangefinder: Golf Pad';
```
-------------------------2566 sample_num
```sql
SELECT p.App, p.Rating, COUNT(u.Sentiment) AS Negative_Sentiment_Count
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p.Genres LIKE '%Puzzle%'
AND u.Sentiment = 'negative'
GROUP BY p.App, p.Rating
ORDER BY p.Rating ASC
LIMIT 5;
```
-------------------------2567 sample_num
```sql
SELECT 
    (SUM(CASE WHEN Sentiment = 'Positive' THEN 1 ELSE 0 END) * 100.0 / NULLIF(SUM(CASE WHEN Sentiment = 'Negative' THEN 1 ELSE 0 END), 0)) AS percentage_ratio,
    (SELECT MAX(Version) FROM playstore WHERE App = 'Fate/Grand Order') AS current_version
FROM 
    user_reviews
WHERE 
    App = 'Fate/Grand Order';
```
-------------------------2568 sample_num
```sql
SELECT 
    p.Installs, 
    (SUM(CASE WHEN u.Sentiment = 'Positive' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS Positive_Percentage
FROM 
    playstore p
JOIN 
    user_reviews u ON p.App = u.App
WHERE 
    p.App = 'FREEDOME VPN Unlimited anonymous Wifi Security';
```
-------------------------2569 sample_num
```sql
SELECT MAX(ur.Sentiment_Polarity) AS Highest_Sentiment_Polarity, p.Genres
FROM user_reviews ur
JOIN playstore p ON ur.App = p.App
WHERE ur.App = 'Honkai Impact 3rd';
```
-------------------------2570 sample_num
```sql
SELECT p.Rating, COUNT(u.App) AS Dislike_Count
FROM playstore p
LEFT JOIN user_reviews u ON p.App = u.App
WHERE p.App = 'Dragon Ball Legends' AND u.Sentiment_Polarity < -0.5
GROUP BY p.Rating;
```
-------------------------2571 sample_num
```sql
SELECT p.App, r.Translated_Review
FROM playstore p
LEFT JOIN user_reviews r ON p.App = r.App
WHERE p.Category = 'EDUCATION' AND p.Rating = 1;
```
-------------------------2572 sample_num
```sql
SELECT p.App, r.Translated_Review
FROM playstore p
JOIN user_reviews r ON p.App = r.App
WHERE p.Type = 'Free' AND p.Category = 'SPORTS';
```
-------------------------2573 sample_num
```sql
SELECT COUNT(p.App) AS Teen_RPG_Count, AVG(u.Sentiment_Polarity) AS Average_Sentiment_Polarity
FROM playstore p
JOIN user_reviews u ON p.App = u.App
WHERE p.Genres LIKE '%Role Playing%' AND p.Content_Rating = 'Teen';
```
-------------------------2574 sample_num
```sql
SELECT 
    AVG(p.Rating) AS average_rating,
    (SUM(CASE WHEN u.Sentiment = 'Positive' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS positive_sentiment_percentage
FROM 
    playstore p
JOIN 
    user_reviews u ON p.App = u.App
WHERE 
    p.Genres LIKE '%Racing%'
```
-------------------------2575 sample_num
```sql
SELECT Region, COUNT(SalesTeamID) AS SalesTeamCount
FROM "Sales Team"
JOIN Regions ON "Sales Team".Region = Regions.Region
GROUP BY Region
ORDER BY SalesTeamCount DESC
LIMIT 1;
```
-------------------------2576 sample_num
```sql
SELECT * FROM Customers WHERE CustomerNames LIKE '%Group%';
```
-------------------------2577 sample_num
```sql
SELECT AVG(MedianIncome) AS AverageMedianIncome
FROM StoreLocations
WHERE Type = 'City';
```
-------------------------2578 sample_num
```sql
SELECT st.Sales Team, r.Region
FROM Sales Orders so
JOIN Sales Team st ON so._SalesTeamID = st.SalesTeamID
JOIN Regions r ON st.Region = r.Region
WHERE so.OrderNumber = 'SO - 000137';
```
-------------------------2579 sample_num
```sql
SELECT so.OrderNumber, p.ProductName
FROM SalesOrders so
JOIN SalesTeam st ON so._SalesTeamID = st.SalesTeamID
JOIN Products p ON so._ProductID = p.ProductID
WHERE st.SalesTeam = 'Douglas Tucker';
```
-------------------------2580 sample_num
```sql
SELECT c.CustomerNames
FROM SalesOrders so
JOIN Customers c ON so._CustomerID = c.CustomerID
JOIN Products p ON so._ProductID = p.ProductID
WHERE so.OrderDate BETWEEN '2020-01-01' AND '2020-12-31'
  AND p.ProductName = 'Cocktail Glasses'
  AND so.DiscountApplied = (
      SELECT MAX(DiscountApplied)
      FROM SalesOrders
      WHERE OrderDate BETWEEN '2020-01-01' AND '2020-12-31'
        AND _ProductID IN (SELECT ProductID FROM Products WHERE ProductName = 'Cocktail Glasses')
  );
```
-------------------------2581 sample_num
```sql
SELECT so.OrderNumber, sl.CityName
FROM SalesOrders so
JOIN StoreLocations sl ON so._StoreID = sl.StoreID
WHERE so.SalesChannel = 'In-Store';
```
-------------------------2582 sample_num
```sql
SELECT c.CustomerNames, so.OrderDate, MAX(so.UnitCost) AS MostExpensive
FROM SalesOrders so
JOIN Customers c ON so._CustomerID = c.CustomerID
GROUP BY c.CustomerNames, so.OrderDate
ORDER BY MostExpensive DESC
LIMIT 1;
```
-------------------------2583 sample_num
```sql
SELECT so.OrderNumber 
FROM Sales Orders so
JOIN Customers c ON so._CustomerID = c.CustomerID
WHERE c.Customer Names = 'Rochester Ltd' 
AND SUBSTR(so.OrderDate, -2) = '18';
```
-------------------------2584 sample_num
```sql
SELECT so.OrderNumber, p.ProductName, st.SalesTeam
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
JOIN SalesTeam st ON so._SalesTeamID = st.SalesTeamID
WHERE so.WarehouseCode = 'WARE-NMK1003';
```
-------------------------2585 sample_num
```sql
SELECT DISTINCT c.CustomerNames
FROM Customers c
JOIN SalesOrders so ON c.CustomerID = so._CustomerID
WHERE so.SalesChannel = 'Online';
```
-------------------------2586 sample_num
```sql
SELECT AVG(Unit_Price - Unit_Cost) AS Average_Net_Profit
FROM Sales_Orders
JOIN Products ON Sales_Orders._ProductID = Products.ProductID
WHERE Products.Product_Name = 'Bakeware';
```
-------------------------2587 sample_num
```sql
SELECT st.Sales Team
FROM Sales Orders so
JOIN Sales Team st ON so._SalesTeamID = st.SalesTeamID
WHERE YEAR(so.OrderDate) = 2020
GROUP BY st.Sales Team
ORDER BY SUM((so.Unit Price - so.Unit Cost) * so.Order Quantity) DESC
LIMIT 1;
```
-------------------------2588 sample_num
```sql
SELECT so.OrderNumber, 
       (so.UnitPrice - so.UnitCost) AS NetProfit
FROM SalesOrders so
JOIN SalesTeam st ON so._SalesTeamID = st.SalesTeamID
WHERE st.Sales Team = 'Joshua Bennett';
```
-------------------------2589 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.ProductName = 'Home Fragrances' THEN so.OrderNumber END) * 100.0 / COUNT(so.OrderNumber)) AS percentage
FROM 
    SalesOrders so
JOIN 
    Products p ON so._ProductID = p.ProductID
WHERE 
    so.ShipDate BETWEEN '2018-07-01' AND '2018-07-31';
```
-------------------------2590 sample_num
```sql
SELECT CustomerID, CustomerNames 
FROM Customers 
WHERE CustomerNames LIKE 'W%';
```
-------------------------2591 sample_num
```sql
SELECT ProductID, ProductName 
FROM Products 
WHERE ProductName LIKE '%Outdoor%';
```
-------------------------2592 sample_num
```sql
SELECT COUNT(DISTINCT _ProductID) AS ProductCount
FROM Sales Orders
WHERE Discount Applied = 0.4
  AND Sales Channel = 'In-Store'
  AND WarehouseCode = 'WARE-NMK1003';
```
-------------------------2593 sample_num
```sql
SELECT "City Name", "Median Income"
FROM "Store Locations"
WHERE "State" = 'Florida'
ORDER BY Population DESC
LIMIT 1;
```
-------------------------2594 sample_num
```sql
SELECT StoreID, CityName, Region
FROM StoreLocations
JOIN Regions ON StoreLocations.StateCode = Regions.StateCode
WHERE County = 'Allen';
```
-------------------------2595 sample_num
```sql
SELECT StoreID, CityName, State, Region
FROM StoreLocations
WHERE Type = (
    SELECT Type
    FROM StoreLocations
    GROUP BY Type
    ORDER BY COUNT(StoreID) ASC
    LIMIT 1
);
```
-------------------------2596 sample_num
```sql
SELECT r.Region, st.Sales Team, 
       COUNT(CASE WHEN so.Sales Channel = 'In-Store' THEN so.OrderNumber END) AS InStoreOrders,
       COUNT(CASE WHEN so.Sales Channel = 'Online' THEN so.OrderNumber END) AS OnlineOrders
FROM Sales Orders so
JOIN Sales Team st ON so._SalesTeamID = st.SalesTeamID
JOIN Regions r ON st.Region = r.Region
WHERE st.SalesTeamID = 18
GROUP BY r.Region, st.Sales Team
HAVING COUNT(CASE WHEN so.Sales Channel = 'In-Store' THEN so.OrderNumber END) > 
       COUNT(CASE WHEN so.Sales Channel = 'Online' THEN so.OrderNumber END);
```
-------------------------2597 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN so.SalesChannel = 'In-Store' THEN so.OrderNumber END) * 100.0 / COUNT(so.OrderNumber)) AS percentage
FROM 
    SalesOrders so
JOIN 
    Customers c ON so._CustomerID = c.CustomerID
WHERE 
    c.CustomerNames = 'Medline';
```
-------------------------2598 sample_num
```sql
SELECT c.CustomerNames, 
       DATEDIFF(so.DeliveryDate, so.OrderDate) AS LastingDeliveryPeriod
FROM Customers c
JOIN SalesOrders so ON c.CustomerID = so._CustomerID
JOIN Products p ON so._ProductID = p.ProductID
WHERE p.ProductName = 'Bedroom Furniture' 
  AND so.SalesChannel = 'Wholesale' 
  AND SUBSTR(so.OrderDate, -2) = '19';
```
-------------------------2599 sample_num
```sql
SELECT c.CustomerNames, p.ProductName
FROM SalesOrders so
JOIN Customers c ON so._CustomerID = c.CustomerID
JOIN Products p ON so._ProductID = p.ProductID
WHERE (so.UnitPrice - so.UnitCost) > 3800;
```
-------------------------2600 sample_num
```sql
SELECT DISTINCT sl."City Name"
FROM "Store Locations" sl
JOIN "Regions" r ON sl."StateCode" = r."StateCode"
WHERE r."State" = 'California' AND sl."Water Area" = 0;
```
-------------------------2601 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN st.Sales Team = 'Carlos Miller' THEN so.OrderNumber END) * 100.0 / COUNT(so.OrderNumber)) AS percentage
FROM 
    Sales Orders so
JOIN 
    Sales Team st ON so._SalesTeamID = st.SalesTeamID;
```
-------------------------2602 sample_num
```sql
SELECT 
    SUM(CASE WHEN p.ProductName = 'Platters' THEN 1 ELSE 0 END) AS Platters_Orders,
    SUM(CASE WHEN p.ProductName = 'Serveware' THEN 1 ELSE 0 END) AS Serveware_Orders
FROM 
    SalesOrders so
JOIN 
    Products p ON so._ProductID = p.ProductID;
```
-------------------------2603 sample_num
```sql
SELECT SUM((Unit_Price - Unit_Cost) * Order_Quantity) AS Total_Net_Profit
FROM Sales_Orders
WHERE _StoreID = (
    SELECT StoreID
    FROM Store_Locations
    WHERE Median_Income = (
        SELECT MAX(Median_Income)
        FROM Store_Locations
    )
);
```
-------------------------2604 sample_num
```sql
SELECT COUNT(OrderNumber) AS NumberOfOrders
FROM Sales Orders
WHERE _SalesTeamID BETWEEN 1 AND 9
AND _SalesTeamID IN (SELECT SalesTeamID FROM Sales Team WHERE Region = 'South');
```
-------------------------2605 sample_num
```sql
SELECT COUNT(OrderNumber) AS TotalOrders
FROM SalesOrders
WHERE OrderDate = '2018-05-31';
```
-------------------------2606 sample_num
```sql
SELECT so.OrderNumber
FROM Sales Orders so
WHERE so.DeliveryDate = '2018-06-13';
```
-------------------------2607 sample_num
```sql
SELECT COUNT(*) AS OrdersWithMoreThan5ProductQuantities
FROM SalesOrders
WHERE OrderQuantity > 5;
```
-------------------------2608 sample_num
```sql
SELECT State FROM Regions WHERE StateCode = 'GA';
```
-------------------------2609 sample_num
```sql
SELECT COUNT(DISTINCT State) 
FROM Regions 
WHERE Region = 'Midwest';
```
-------------------------2610 sample_num
```sql
SELECT p.ProductName 
FROM SalesOrders so 
JOIN Products p ON so._ProductID = p.ProductID 
WHERE so.UnitCost = 781.22;
```
-------------------------2611 sample_num
```sql
SELECT so.DeliveryDate 
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
WHERE p.ProductName = 'Cookware';
```
-------------------------2612 sample_num
```sql
SELECT COUNT(*) 
FROM Sales Orders 
JOIN Products ON Sales Orders._ProductID = Products.ProductID 
WHERE Products.ProductName = 'Furniture Cushions' 
AND SUBSTR(OrderDate, -2) = '18';
```
-------------------------2613 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN SalesOrders so ON p.ProductID = so._ProductID
WHERE so.DiscountApplied = 0.1;
```
-------------------------2614 sample_num
```sql
SELECT AVG(Unit_Price - Unit_Cost) AS Average_Net_Profit
FROM Sales_Orders
JOIN Products ON Sales_Orders._ProductID = Products.ProductID
WHERE Products.Product_Name = 'Phones' AND Sales_Orders.Sales_Channel = 'Distributor';
```
-------------------------2615 sample_num
```sql
SELECT AVG(UnitPrice - UnitCost) AS AverageNetProfit
FROM SalesOrders
JOIN Products ON SalesOrders._ProductID = Products.ProductID
WHERE Products.ProductName = 'Bar Tools' AND SalesOrders.OrderQuantity > 5;
```
-------------------------2616 sample_num
```sql
SELECT DISTINCT sl."City Name"
FROM "Store Locations" sl
JOIN "Regions" r ON sl."StateCode" = r."StateCode"
WHERE r."Region" = 'South';
```
-------------------------2617 sample_num
```sql
SELECT DISTINCT r.Region
FROM Store_Locations sl
JOIN Regions r ON sl.StateCode = r.StateCode
WHERE sl.Type = 'Town';
```
-------------------------2618 sample_num
```sql
SELECT COUNT(OrderNumber) AS TotalOrders
FROM Sales Orders
WHERE _CustomerID = (SELECT CustomerID FROM Customers WHERE Customer Names = 'Medsep Group');
```
-------------------------2619 sample_num
```sql
SELECT DISTINCT "Discount Applied"
FROM "Sales Orders"
WHERE "_CustomerID" IN (
    SELECT "CustomerID"
    FROM "Customers"
    WHERE "Customer Names" = 'Ole Group'
) AND "Discount Applied" IS NOT NULL;
```
-------------------------2620 sample_num
```sql
SELECT c.CustomerNames
FROM SalesOrders so
JOIN Customers c ON so._CustomerID = c.CustomerID
WHERE so.ShipDate = '2018-07-08';
```
-------------------------2621 sample_num
```sql
SELECT COUNT(OrderNumber) 
FROM Sales Orders 
WHERE _CustomerID = (SELECT CustomerID FROM Customers WHERE Customer Names = 'Ei') 
AND Order Quantity > 4;
```
-------------------------2622 sample_num
```sql
SELECT COUNT(*) 
FROM Sales Orders 
WHERE _CustomerID = (SELECT CustomerID FROM Customers WHERE Customer Names = 'Pacific Ltd') 
AND Discount Applied = 0.05;
```
-------------------------2623 sample_num
```sql
SELECT DISTINCT c.CustomerNames
FROM SalesOrders so
JOIN Customers c ON so._CustomerID = c.CustomerID
WHERE so.UnitCost > 4000;
```
-------------------------2624 sample_num
```sql
SELECT StoreID, Latitude, Longitude 
FROM Store_Locations 
WHERE City_Name = 'Birmingham';
```
-------------------------2625 sample_num
```sql
SELECT "City Name" 
FROM "Store Locations" 
ORDER BY Population DESC 
LIMIT 1;
```
-------------------------2626 sample_num
```sql
SELECT COUNT(*) 
FROM Store_Locations 
WHERE State = 'California' AND Type = 'CDP';
```
-------------------------2627 sample_num
```sql
SELECT so.OrderNumber, p.ProductName
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
WHERE so.UnitPrice = (SELECT MIN(UnitPrice) FROM SalesOrders);
```
-------------------------2628 sample_num
```sql
SELECT p.ProductName, MAX((so.UnitPrice - so.UnitCost) * so.OrderQuantity) AS HighestNetProfit
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
WHERE so.OrderDate LIKE '%/19'
GROUP BY p.ProductName
ORDER BY HighestNetProfit DESC
LIMIT 1;
```
-------------------------2629 sample_num
```sql
SELECT AVG(UnitPrice) AS AverageUnitPrice
FROM SalesOrders
JOIN Products ON SalesOrders._ProductID = Products.ProductID
WHERE Products.ProductName = 'Cookware';
```
-------------------------2630 sample_num
```sql
SELECT DISTINCT st.Sales Team
FROM Sales Orders so
JOIN Sales Team st ON so._SalesTeamID = st.SalesTeamID
WHERE so.OrderDate = '2018-05-31';
```
-------------------------2631 sample_num
```sql
SELECT st.Sales Team, COUNT(so.OrderNumber) AS OrderCount
FROM Sales Orders so
JOIN Sales Team st ON so._SalesTeamID = st.SalesTeamID
WHERE YEAR(so.OrderDate) = 2019
GROUP BY st.Sales Team
ORDER BY OrderCount ASC
LIMIT 1;
```
-------------------------2632 sample_num
```sql
SELECT SUBSTR(OrderDate, -2) AS Year, COUNT(OrderNumber) AS TotalOrders
FROM Sales Orders
WHERE _SalesTeamID = (SELECT SalesTeamID FROM Sales Team WHERE Sales Team = 'George Lewis')
AND SUBSTR(OrderDate, -2) IN ('18', '19', '20')
GROUP BY SUBSTR(OrderDate, -2)
ORDER BY TotalOrders DESC
LIMIT 1;
```
-------------------------2633 sample_num
```sql
SELECT 
    DIVIDE(
        COUNT(CASE WHEN sl.County = 'Orange County' AND SUBSTR(so.OrderDate, -2) = '18' THEN so.OrderNumber END), 
        COUNT(CASE WHEN SUBSTR(so.OrderDate, -2) = '18' THEN so.OrderNumber END)
    ) AS percentage
FROM 
    Sales Orders so
JOIN 
    Store Locations sl ON so._StoreID = sl.StoreID
WHERE 
    SUBSTR(so.OrderDate, -2) = '18';
```
-------------------------2634 sample_num
```sql
SELECT OrderNumber 
FROM SalesOrders 
WHERE UnitPrice = (SELECT MAX(UnitPrice) FROM SalesOrders);
```
-------------------------2635 sample_num
```sql
SELECT _SalesTeamID, COUNT(OrderNumber) AS OrderCount
FROM Sales Orders
WHERE SUBSTR(OrderDate, -2) = '18'
GROUP BY _SalesTeamID
ORDER BY OrderCount DESC
LIMIT 1;
```
-------------------------2636 sample_num
```sql
SELECT UnitCost 
FROM SalesOrders 
WHERE OrderNumber = 'SO - 000103';
```
-------------------------2637 sample_num
```sql
SELECT COUNT(OrderNumber) AS TotalOrders
FROM Sales Orders
JOIN Store Locations ON Sales Orders._StoreID = Store Locations.StoreID
WHERE Store Locations.County = 'Maricopa' AND SUBSTR(OrderDate, -2) = '20';
```
-------------------------2638 sample_num
```sql
SELECT sl.*
FROM Store_Locations sl
JOIN Sales_Orders so ON sl.StoreID = so._StoreID
WHERE so.OrderNumber = 'SO - 000115';
```
-------------------------2639 sample_num
```sql
SELECT sl."City Name", COUNT(so."OrderNumber") AS total_orders
FROM "Sales Orders" so
JOIN "Store Locations" sl ON so."_StoreID" = sl."StoreID"
WHERE so."OrderDate" BETWEEN '2019-01-01' AND '2019-12-31'
GROUP BY sl."City Name";
```
-------------------------2640 sample_num
```sql
SELECT c.CustomerNames
FROM Customers c
JOIN SalesOrders so ON c.CustomerID = so._CustomerID
WHERE SUBSTR(so.OrderDate, -2) = '18'
GROUP BY c.CustomerNames
HAVING COUNT(so.OrderNumber) > 3;
```
-------------------------2641 sample_num
```sql
SELECT COUNT(OrderNumber) AS TotalOrders
FROM Sales Orders
WHERE _CustomerID = (SELECT CustomerID FROM Customers WHERE Customer Names = 'Medsep Group')
AND SUBSTR(OrderDate, -2) IN ('18', '19', '20');
```
-------------------------2642 sample_num
```sql
SELECT DISTINCT c.CustomerNames
FROM Customers c
JOIN SalesOrders so ON c.CustomerID = so._CustomerID
WHERE so.OrderQuantity > 5 AND so.OrderDate = '2018-06-01';
```
-------------------------2643 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN (UnitPrice - UnitCost) > 1000 THEN OrderNumber END) * 100.0 / COUNT(OrderNumber)) AS Percentage
FROM 
    SalesOrders
WHERE 
    _SalesTeamID IN (SELECT SalesTeamID FROM SalesTeam WHERE SalesTeam = 'Stephen Payne');
```
-------------------------2644 sample_num
```sql
SELECT COUNT(*) AS SalesTeamCount
FROM "Sales Team"
WHERE Region = 'Northeast';
```
-------------------------2645 sample_num
```sql
SELECT "City Name", Latitude, Longitude 
FROM "Store Locations" 
WHERE County = 'Maricopa';
```
-------------------------2646 sample_num
```sql
SELECT OrderNumber 
FROM SalesOrders 
WHERE UnitCost = (SELECT MAX(UnitCost) FROM SalesOrders);
```
-------------------------2647 sample_num
```sql
SELECT ProductName FROM Products WHERE ProductID BETWEEN 30 AND 40;
```
-------------------------2648 sample_num
```sql
SELECT DIVIDE(MAX(Unit_Cost), MIN(Unit_Cost)) AS Cost_Ratio
FROM Sales_Orders;
```
-------------------------2649 sample_num
```sql
SELECT p.ProductName, COUNT(so.OrderNumber) AS OrderCount
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
WHERE SUBSTR(so.OrderDate, -2) = '18'
GROUP BY p.ProductName
ORDER BY OrderCount DESC
LIMIT 1;
```
-------------------------2650 sample_num
```sql
SELECT SUM(so.[Order Quantity]) AS TotalProductsSold
FROM [Sales Orders] so
JOIN [Sales Team] st ON so._SalesTeamID = st.SalesTeamID
WHERE st.[Sales Team] = 'Adam Hernandez';
```
-------------------------2651 sample_num
```sql
SELECT so.OrderNumber
FROM Sales Orders so
JOIN Store Locations sl ON so._StoreID = sl.StoreID
WHERE sl.City Name = 'Daly City';
```
-------------------------2652 sample_num
```sql
SELECT COUNT(OrderNumber) AS TotalOrders
FROM SalesOrders
WHERE _CustomerID = (SELECT CustomerID FROM Customers WHERE CustomerNames = 'Rochester Ltd');
```
-------------------------2653 sample_num
```sql
SELECT OrderNumber 
FROM Sales Orders 
WHERE _CustomerID = (SELECT CustomerID FROM Customers WHERE CustomerNames = 'Qualitest') 
ORDER BY Order Quantity DESC 
LIMIT 1;
```
-------------------------2654 sample_num
```sql
SELECT so.OrderNumber, p.ProductName
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
WHERE so.SalesChannel = 'In-Store';
```
-------------------------2655 sample_num
```sql
SELECT COUNT(*) 
FROM Sales Orders so
JOIN Store Locations sl ON so._StoreID = sl.StoreID
WHERE so.Sales Channel = 'Online' 
AND so.OrderDate LIKE '5/%/18' 
AND sl.City Name = 'Norman';
```
-------------------------2656 sample_num
```sql
SELECT p.ProductName
FROM SalesOrders so
JOIN StoreLocations sl ON so._StoreID = sl.StoreID
JOIN Products p ON so._ProductID = p.ProductID
WHERE sl.County = 'Maricopa'
GROUP BY p.ProductName
ORDER BY SUM(so.OrderQuantity) ASC
LIMIT 1;
```
-------------------------2657 sample_num
```sql
SELECT so.OrderNumber
FROM Sales Orders so
JOIN Sales Team st ON so._SalesTeamID = st.SalesTeamID
WHERE st.Sales Team = 'Samuel Fowler';
```
-------------------------2658 sample_num
```sql
SELECT SUM(OrderQuantity) AS TotalBaseballs
FROM SalesOrders
WHERE _ProductID IN (SELECT ProductID FROM Products WHERE ProductName = 'Baseball')
AND OrderDate LIKE '12/%/17';
```
-------------------------2659 sample_num
```sql
SELECT DIVIDE(SUM(OrderQuantity), 12) AS AverageOrnamentsSold
FROM SalesOrders
JOIN Products ON SalesOrders._ProductID = Products.ProductID
WHERE Products.ProductName = 'Ornaments' 
AND OrderDate BETWEEN '2018-01-01' AND '2018-12-31';
```
-------------------------2660 sample_num
```sql
SELECT 
    DIVIDE(SUM(CASE WHEN sl."City Name" = 'Burbank' AND SUBSTR(so.OrderDate, -2) = '18' THEN so."Order Quantity" ELSE 0 END), 
           SUM(CASE WHEN SUBSTR(so.OrderDate, -2) = '18' THEN so."Order Quantity" ELSE 0 END)) AS percentage
FROM 
    "Sales Orders" so
JOIN 
    "Store Locations" sl ON so."_StoreID" = sl."StoreID"
WHERE 
    SUBSTR(so.OrderDate, -2) = '18';
```
-------------------------2661 sample_num
```sql
SELECT 
    (SELECT COUNT(OrderNumber) FROM Sales Orders WHERE WarehouseCode = 'WARE-MKL1006') - 
    (SELECT COUNT(OrderNumber) FROM Sales Orders WHERE WarehouseCode = 'WARE-NBV1002') AS OrderNumberDifference;
```
-------------------------2662 sample_num
```sql
SELECT p.ProductName
FROM SalesOrders so
JOIN Customers c ON so._CustomerID = c.CustomerID
JOIN Products p ON so._ProductID = p.ProductID
WHERE c.CustomerNames = 'Sundial' AND so.DeliveryDate LIKE '%/21';
```
-------------------------2663 sample_num
```sql
SELECT StoreID, Region 
FROM Store Locations 
WHERE State = 'Michigan';
```
-------------------------2664 sample_num
```sql
SELECT 
    c.CustomerNames, 
    COUNT(so.OrderNumber) AS TotalOrders
FROM 
    Customers c
JOIN 
    SalesOrders so ON c.CustomerID = so._CustomerID
WHERE 
    c.CustomerNames IN ('Apollo Ltd', 'Pacific Ltd')
GROUP BY 
    c.CustomerNames;
```
-------------------------2665 sample_num
```sql
SELECT _StoreID
FROM Sales Orders
WHERE _StoreID IN (
    SELECT StoreID
    FROM Store Locations
    WHERE City Name IN ('Aurora (Township)', 'Babylon (Town)')
)
GROUP BY _StoreID
ORDER BY COUNT(OrderNumber) DESC
LIMIT 1;
```
-------------------------2666 sample_num
```sql
SELECT c.CustomerNames, p.ProductName
FROM SalesOrders so
JOIN Customers c ON so._CustomerID = c.CustomerID
JOIN Products p ON so._ProductID = p.ProductID
JOIN SalesTeam st ON so._SalesTeamID = st.SalesTeamID
WHERE st.SalesTeam = 'Anthony Torres' AND so.SalesChannel = 'Distributor';
```
-------------------------2667 sample_num
```sql
SELECT c.CustomerID, c.CustomerNames
FROM Customers c
JOIN SalesOrders so ON c.CustomerID = so._CustomerID
WHERE so.SalesChannel = 'Online'
GROUP BY c.CustomerID, c.CustomerNames
HAVING SUM(so.UnitPrice - so.UnitCost) > 5000;
```
-------------------------2668 sample_num
```sql
SELECT SUM(Unit Price - Unit Cost) AS NetProfit
FROM Sales Orders
WHERE _ProductID IN (SELECT ProductID FROM Products WHERE Product Name = 'Floral')
AND DeliveryDate LIKE '%/21';
```
-------------------------2669 sample_num
```sql
SELECT COUNT(OrderNumber) 
FROM Sales Orders 
WHERE _StoreID IN (
    SELECT StoreID 
    FROM Store Locations 
    WHERE Population BETWEEN 3000000 AND 4000000
);
```
-------------------------2670 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN SalesOrders so ON p.ProductID = so._ProductID
JOIN StoreLocations sl ON so._StoreID = sl.StoreID
WHERE so.SalesChannel = 'Wholesale' AND sl.TimeZone = 'Pacific/Honolulu';
```
-------------------------2671 sample_num
```sql
SELECT so.OrderNumber, p.ProductName
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
WHERE so.OrderDate = '2018-06-06';
```
-------------------------2672 sample_num
```sql
SELECT AVG(OrderCount) AS AverageYearlyOrder
FROM (
    SELECT COUNT(OrderNumber) AS OrderCount
    FROM Sales Orders
    JOIN Customers ON Sales Orders._CustomerID = Customers.CustomerID
    WHERE Customers.CustomerNames = 'Weimei Corp'
    AND SUBSTR(OrderDate, -2) IN ('18', '19', '20')
    GROUP BY SUBSTR(OrderDate, -2)
) AS YearlyOrders;
```
-------------------------2673 sample_num
```sql
WITH MonthlyOrders AS (
    SELECT 
        COUNT(OrderNumber) AS TotalOrders,
        COUNT(CASE WHEN WarehouseCode = 'WARE-NMK1003' THEN OrderNumber END) AS WARE_NMK1003_Orders,
        COUNT(CASE WHEN Products.ProductName = 'Floor Lamps' THEN OrderNumber END) AS FloorLampsOrders
    FROM 
        SalesOrders
    JOIN 
        Products ON SalesOrders._ProductID = Products.ProductID
    WHERE 
        SUBSTR(OrderDate, -2) = '19'
)

SELECT 
    TotalOrders / 12.0 AS AverageMonthlyOrders,
    (WARE_NMK1003_Orders * 100.0 / TotalOrders) AS PercentageOfWARE_NMK1003,
    FloorLampsOrders AS NumberOfFloorLampsOrders
FROM 
    MonthlyOrders;
```
-------------------------2674 sample_num
```sql
SELECT ProcuredDate 
FROM Sales Orders 
WHERE _CustomerID = 11;
```
-------------------------2675 sample_num
```sql
SELECT COUNT(*) 
FROM SalesOrders 
WHERE SalesChannel = 'Distributor' 
AND OrderQuantity = (SELECT MIN(OrderQuantity) FROM SalesOrders);
```
-------------------------2676 sample_num
```sql
SELECT DISTINCT _SalesTeamID 
FROM Sales Orders 
WHERE Discount Applied = 0.1 AND Sales Channel = 'In-Store';
```
-------------------------2677 sample_num
```sql
SELECT COUNT(*) 
FROM Store_Locations 
WHERE Type = 'Borough' 
AND "City Name" = 'Brooklyn' 
AND Population < 3000000;
```
-------------------------2678 sample_num
```sql
SELECT COUNT(DISTINCT StateCode) 
FROM Regions 
WHERE Region = 'Midwest';
```
-------------------------2679 sample_num
```sql
SELECT p.ProductName, SUM((so.UnitPrice - so.UnitCost) * so.OrderQuantity) AS NetProfit
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
GROUP BY p.ProductName
ORDER BY NetProfit DESC
LIMIT 10;
```
-------------------------2680 sample_num
```sql
SELECT DISTINCT c.CustomerNames
FROM Customers c
JOIN SalesOrders so ON c.CustomerID = so._CustomerID
WHERE so.OrderQuantity = 3 AND so.OrderDate LIKE '2/%/18';
```
-------------------------2681 sample_num
```sql
SELECT st.Sales Team
FROM Sales Orders so
JOIN Customers c ON so._CustomerID = c.CustomerID
JOIN Sales Team st ON so._SalesTeamID = st.SalesTeamID
WHERE c.Customer Names = 'Apotheca, Ltd';
```
-------------------------2682 sample_num
```sql
SELECT DISTINCT r.Region
FROM Store_Locations sl
JOIN Sales_Orders so ON sl.StoreID = so._StoreID
JOIN Regions r ON sl.StateCode = r.StateCode
WHERE so.WarehouseCode = 'WARE-UHY1004';
```
-------------------------2683 sample_num
```sql
SELECT DISTINCT sl."City Name"
FROM "Sales Orders" so
JOIN "Sales Team" st ON so."_SalesTeamID" = st."SalesTeamID"
JOIN "Products" p ON so."_ProductID" = p."ProductID"
JOIN "Store Locations" sl ON so."_StoreID" = sl."StoreID"
WHERE st."Sales Team" = 'Shawn Torres' AND p."Product Name" = 'Audio';
```
-------------------------2684 sample_num
```sql
SELECT p.ProductName, c.CustomerNames
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
JOIN Customers c ON so._CustomerID = c.CustomerID
WHERE so.OrderDate = '2018-10-21' AND so.DeliveryDate = '2019-11-21';
```
-------------------------2685 sample_num
```sql
SELECT COUNT(DISTINCT sl.StoreID) AS StoreCount
FROM Store_Locations sl
JOIN Sales_Orders so ON sl.StoreID = so._StoreID
WHERE so.ProcuredDate = '2018-10-27' AND sl.State = 'Oregon';
```
-------------------------2686 sample_num
```sql
SELECT so.SalesChannel, COUNT(*) AS SalesCount
FROM Sales Orders so
JOIN Store Locations sl ON so._StoreID = sl.StoreID
WHERE sl.MedianIncome IN (
    SELECT DISTINCT MedianIncome
    FROM Store Locations
    ORDER BY MedianIncome DESC
    LIMIT 3
)
GROUP BY so.SalesChannel
ORDER BY SalesCount DESC;
```
-------------------------2687 sample_num
```sql
SELECT TOP 5 st.SalesTeam, SUM((so.UnitPrice - so.UnitCost) * so.OrderQuantity) AS NetProfit
FROM SalesOrders so
JOIN SalesTeam st ON so._SalesTeamID = st.SalesTeamID
GROUP BY st.SalesTeam
ORDER BY NetProfit DESC;
```
-------------------------2688 sample_num
```sql
SELECT MAX(Discount Applied) 
FROM Sales Orders 
JOIN Store Locations ON Sales Orders._StoreID = Store Locations.StoreID 
WHERE Store Locations.State = 'Colorado' 
AND Store Locations.Land Area = 111039036;
```
-------------------------2689 sample_num
```sql
SELECT COUNT(DISTINCT TimeZone) AS DifferentTimeZones
FROM "Store Locations" SL
JOIN "Regions" R ON SL.StateCode = R.StateCode
WHERE R.Region = 'Northeast';
```
-------------------------2690 sample_num
```sql
SELECT Type
FROM Store_Locations
WHERE StateCode IN (SELECT StateCode FROM Regions WHERE Region = 'South')
GROUP BY Type
ORDER BY COUNT(Type) DESC
LIMIT 1;
```
-------------------------2691 sample_num
```sql
SELECT r.Region
FROM Sales Orders so
JOIN Sales Team st ON so._SalesTeamID = st.SalesTeamID
JOIN Regions r ON st.Region = r.StateCode
WHERE so.WarehouseCode = 'WARE-MKL1006'
GROUP BY r.Region
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------2692 sample_num
```sql
SELECT sl."City Name"
FROM "Sales Orders" so
JOIN "Store Locations" sl ON so."_StoreID" = sl."StoreID"
WHERE so."Unit Price" = (SELECT MAX("Unit Price") FROM "Sales Orders");
```
-------------------------2693 sample_num
```sql
SELECT COUNT(*) 
FROM Sales Orders 
WHERE _CustomerID = (SELECT CustomerID FROM Customers WHERE Customer Names = 'Ole Group') 
AND Sales Channel = 'Online' 
AND OrderDate LIKE '5/%/19';
```
-------------------------2694 sample_num
```sql
SELECT COUNT(*) 
FROM Store_Locations sl
JOIN Sales_Orders so ON sl.StoreID = so._StoreID
WHERE sl.County = 'Washtenaw County' 
AND so.Order_Quantity = 1 
AND so.Sales_Channel = 'Distributor';
```
-------------------------2695 sample_num
```sql
SELECT p.ProductName
FROM SalesOrders so
JOIN StoreLocations sl ON so._StoreID = sl.StoreID
JOIN Products p ON so._ProductID = p.ProductID
WHERE sl.CityName = 'Santa Clarita'
GROUP BY p.ProductName
ORDER BY COUNT(so.OrderQuantity) ASC
LIMIT 1;
```
-------------------------2696 sample_num
```sql
SELECT sl.Latitude, sl.Longitude
FROM Store_Locations sl
JOIN Sales_Orders so ON sl.StoreID = so._StoreID
WHERE so.WarehouseCode = 'WARE-PUJ1005'
GROUP BY sl.StoreID, sl.Latitude, sl.Longitude
ORDER BY COUNT(so.WarehouseCode) ASC
LIMIT 1;
```
-------------------------2697 sample_num
```sql
SELECT 
    (SUM(CASE WHEN sl."City Name" = 'New York' THEN 1 ELSE 0 END) * 100.0 / COUNT(so."OrderNumber")) AS Percentage
FROM 
    "Sales Orders" so
JOIN 
    "Store Locations" sl ON so."_StoreID" = sl."StoreID"
WHERE 
    so."OrderDate" = '4/4/20';
```
-------------------------2698 sample_num
```sql
SELECT AVG(LandArea) AS AverageLandArea
FROM StoreLocations
WHERE StoreID IN (
    SELECT _StoreID
    FROM SalesOrders
    WHERE UnitPrice = 998.30
);
```
-------------------------2699 sample_num
```sql
SELECT AVG([Household Income]) AS AverageHouseholdIncome
FROM [Store Locations]
WHERE [State] = 'New Hampshire' AND [Type] = 'city';
```
-------------------------2700 sample_num
```sql
SELECT COUNT(*) AS NumberOfSalesTeams
FROM "Sales Team"
WHERE Region = 'Midwest';
```
-------------------------2701 sample_num
```sql
SELECT OrderNumber 
FROM SalesOrders 
WHERE OrderDate > '2018-01-01';
```
-------------------------2702 sample_num
```sql
SELECT COUNT(DISTINCT Sales Channel) AS SalesChannelCount
FROM Sales Orders
JOIN Sales Team ON Sales Orders._SalesTeamID = Sales Team.SalesTeamID
WHERE Sales Team.Region = 'Midwest';
```
-------------------------2703 sample_num
```sql
SELECT st.SalesTeam, MAX(so.UnitPrice) AS HighestUnitPrice
FROM SalesOrders so
JOIN SalesTeam st ON so._SalesTeamID = st.SalesTeamID
GROUP BY st.SalesTeam
ORDER BY HighestUnitPrice DESC
LIMIT 1;
```
-------------------------2704 sample_num
```sql
SELECT r.Region, MAX(so.Discount Applied) AS MaxDiscount
FROM Sales Orders so
JOIN Sales Team st ON so._SalesTeamID = st.SalesTeamID
JOIN Regions r ON st.Region = r.Region
WHERE so.Sales Channel = 'Online'
GROUP BY r.Region
ORDER BY MaxDiscount DESC;
```
-------------------------2705 sample_num
```sql
SELECT so.OrderNumber, so.OrderDate
FROM Sales Orders so
JOIN Customers c ON so._CustomerID = c.CustomerID
WHERE c.Customer Names = 'Apollo Ltd'
ORDER BY so.Unit Price DESC
LIMIT 1;
```
-------------------------2706 sample_num
```sql
SELECT OrderNumber, WarehouseCode 
FROM Sales Orders 
WHERE _CustomerID = (SELECT CustomerID FROM Customers WHERE Customer Names = 'Elorac, Corp');
```
-------------------------2707 sample_num
```sql
SELECT DISTINCT c.CustomerNames
FROM Customers c
JOIN SalesOrders so ON c.CustomerID = so._CustomerID
JOIN Products p ON so._ProductID = p.ProductID
WHERE p.ProductName = 'Cocktail Glasses' AND so.SalesChannel = 'Online';
```
-------------------------2708 sample_num
```sql
SELECT StoreLocations.StoreID, StoreLocations.CityName, 
       MAX(SalesOrders.OrderQuantity * (SalesOrders.UnitPrice - SalesOrders.UnitCost)) AS NetProfit
FROM SalesOrders
JOIN StoreLocations ON SalesOrders._StoreID = StoreLocations.StoreID
WHERE StoreLocations.State = 'Arizona'
GROUP BY StoreLocations.StoreID, StoreLocations.CityName
ORDER BY NetProfit DESC
LIMIT 1;
```
-------------------------2709 sample_num
```sql
SELECT 
    (SELECT UnitPrice 
     FROM SalesOrders SO 
     JOIN StoreLocations SL ON SO._StoreID = SL.StoreID 
     JOIN Products P ON SO._ProductID = P.ProductID 
     WHERE SL.State = 'Florida' AND P.ProductName = 'Computers') - 
    (SELECT UnitPrice 
     FROM SalesOrders SO 
     JOIN StoreLocations SL ON SO._StoreID = SL.StoreID 
     JOIN Products P ON SO._ProductID = P.ProductID 
     WHERE SL.State = 'Texas' AND P.ProductName = 'Computers') AS PriceDifference;
```
-------------------------2710 sample_num
```sql
SELECT DISTINCT st.SalesTeam
FROM "Sales Team" st
JOIN "Sales Orders" so ON st.SalesTeamID = so._SalesTeamID
JOIN "Regions" r ON st.Region = r.Region
WHERE r.Region = 'Midwest' AND so."Order Quantity" > 5;
```
-------------------------2711 sample_num
```sql
SELECT DISTINCT s.StoreID
FROM Sales Orders so
JOIN Store Locations sl ON so._StoreID = sl.StoreID
WHERE sl.State = 'California' 
AND so.Sales Channel = 'In-Store' 
AND so.Discount Applied = 0.2;
```
-------------------------2712 sample_num
```sql
SELECT c.CustomerNames
FROM Customers c
JOIN SalesOrders so ON c.CustomerID = so._CustomerID
WHERE so.OrderDate BETWEEN '2018-01-01' AND '2020-12-31'
GROUP BY c.CustomerNames
ORDER BY SUM(so.OrderQuantity) DESC
LIMIT 1;
```
-------------------------2713 sample_num
```sql
SELECT 
    SUM(CASE WHEN p.ProductName = 'Candles' THEN so.OrderQuantity ELSE 0 END) AS TotalCandlesQuantity,
    (SUM(CASE WHEN p.ProductName = 'Candles' THEN so.OrderQuantity ELSE 0 END) / NULLIF(SUM(so.OrderQuantity), 0)) * 100 AS CandlesPercentage
FROM 
    SalesOrders so
JOIN 
    Products p ON so._ProductID = p.ProductID;
```
-------------------------2714 sample_num
```sql
SELECT r.Region
FROM Sales_Team st
JOIN Regions r ON st.Region = r.State
WHERE st.Sales_Team = 'Joshua Bennett';
```
-------------------------2715 sample_num
```sql
SELECT StoreID 
FROM Store_Locations 
WHERE Population = (SELECT MAX(Population) FROM Store_Locations);
```
-------------------------2716 sample_num
```sql
SELECT COUNT(*) AS NumberOfSalesTeams
FROM "Sales Team"
WHERE Region = 'Midwest';
```
-------------------------2717 sample_num
```sql
SELECT Type 
FROM Store_Locations 
WHERE City_Name = (
    SELECT City_Name 
    FROM Store_Locations 
    ORDER BY Water_Area DESC 
    LIMIT 1
) AND Type = 'City';
```
-------------------------2718 sample_num
```sql
SELECT COUNT(*) 
FROM SalesOrders 
WHERE SalesChannel = 'Online' 
AND SUBSTR(ShipDate, 1, 2) = '06' 
AND SUBSTR(ShipDate, -2) = '18';
```
-------------------------2719 sample_num
```sql
SELECT DiscountApplied 
FROM SalesOrders 
WHERE UnitPrice = (SELECT MAX(UnitPrice) FROM SalesOrders);
```
-------------------------2720 sample_num
```sql
SELECT p.ProductName
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
ORDER BY (so.UnitPrice - so.UnitCost) DESC
LIMIT 1;
```
-------------------------2721 sample_num
```sql
SELECT 
    sl."City Name", 
    AVG(sl."Household Income") AS "Average Household Income"
FROM 
    "Store Locations" sl
JOIN 
    "Regions" r ON sl."StateCode" = r."StateCode"
WHERE 
    r."Region" = 'Northeast'
GROUP BY 
    sl."City Name"
HAVING 
    sl."StateCode" = (
        SELECT 
            "StateCode"
        FROM 
            "Store Locations"
        GROUP BY 
            "StateCode"
        ORDER BY 
            COUNT("StoreID") DESC
        LIMIT 1
    )
```
-------------------------2722 sample_num
```sql
SELECT DISTINCT r.Region
FROM Store_Locations sl
JOIN Regions r ON sl.StateCode = r.StateCode
WHERE sl.Median_Income < 30000;
```
-------------------------2723 sample_num
```sql
SELECT COUNT(*) 
FROM Store_Locations 
WHERE StateCode IN (SELECT StateCode FROM Regions WHERE Region = 'West') 
AND Land_Area < 20000000;
```
-------------------------2724 sample_num
```sql
SELECT c.CustomerNames
FROM SalesOrders so
JOIN Customers c ON so._CustomerID = c.CustomerID
WHERE (so.UnitPrice - so.UnitCost) = (
    SELECT MAX(UnitPrice - UnitCost)
    FROM SalesOrders
);
```
-------------------------2725 sample_num
```sql
WITH OrderCounts AS (
    SELECT 
        st.SalesTeam,
        COUNT(so.OrderNumber) AS OrderCount
    FROM 
        Sales Orders so
    JOIN 
        Sales Team st ON so._SalesTeamID = st.SalesTeamID
    WHERE 
        SUBSTR(so.ShipDate, -2) = '19'
    GROUP BY 
        st.SalesTeam
),
MaxOrderCount AS (
    SELECT 
        MAX(OrderCount) AS MaxCount
    FROM 
        OrderCounts
)
SELECT 
    oc.SalesTeam,
    COUNT(so.OrderNumber) AS TotalShippedOrders
FROM 
    OrderCounts oc
JOIN 
    MaxOrderCount moc ON oc.OrderCount = moc.MaxCount
JOIN 
    Sales Orders so ON so._SalesTeamID = (SELECT SalesTeamID FROM Sales Team WHERE Sales Team = oc.SalesTeam)
WHERE 
    SUBSTR(so.ShipDate, -2) = '19'
GROUP BY 
    oc.SalesTeam;
```
-------------------------2726 sample_num
```sql
SELECT p.ProductName
FROM SalesOrders so
JOIN Products p ON so._ProductID = p.ProductID
WHERE so.OrderQuantity > 5 
  AND so.ShipDate BETWEEN '2019-05-01' AND '2019-05-31'
ORDER BY (so.UnitPrice - so.UnitCost) ASC
LIMIT 1;
```
-------------------------2727 sample_num
```sql
SELECT sl.Latitude, sl.Longitude
FROM Sales Orders so
JOIN Store Locations sl ON so._StoreID = sl.StoreID
WHERE so._ProductID = (
    SELECT so2._ProductID
    FROM Sales Orders so2
    GROUP BY so2._ProductID
    ORDER BY SUM(so2.Order Quantity * (so2.Unit Price - so2.Unit Cost)) DESC
    LIMIT 1 OFFSET 3
)
```
-------------------------2728 sample_num
```sql
SELECT SalesTeam."Sales Team", COUNT(SalesOrders.OrderNumber) AS ShippedOrders
FROM SalesOrders
JOIN SalesTeam ON SalesOrders._SalesTeamID = SalesTeam.SalesTeamID
WHERE SUBSTR(SalesOrders.ShipDate, -2) = '20'
GROUP BY SalesTeam."Sales Team"
ORDER BY ShippedOrders DESC
LIMIT 1;
```
-------------------------2729 sample_num
```sql
SELECT AVG(OrderCount) AS AverageShippedOrdersPerYear
FROM (
    SELECT COUNT(OrderNumber) AS OrderCount
    FROM Sales Orders
    JOIN Sales Team ON Sales Orders._SalesTeamID = Sales Team.SalesTeamID
    WHERE Sales Team.Sales Team = 'Carl Nguyen'
    AND SUBSTR(ShipDate, -2) IN ('18', '19', '20')
    GROUP BY SUBSTR(ShipDate, 1, 4)
) AS YearlyCounts;
```
-------------------------2730 sample_num
```sql
SELECT 
    p.ProductName, 
    SUM(so.DiscountApplied) AS TotalDiscount
FROM 
    SalesOrders so
JOIN 
    Products p ON so._ProductID = p.ProductID
GROUP BY 
    p.ProductName
ORDER BY 
    SUM(so.UnitPrice - so.UnitCost) DESC
LIMIT 1;
```
-------------------------2731 sample_num
```sql
SELECT c.CustomerNames
FROM SalesOrders so
JOIN Customers c ON so._CustomerID = c.CustomerID
GROUP BY c.CustomerNames
ORDER BY MAX((so.UnitPrice * so.OrderQuantity) - so.DiscountApplied) DESC
LIMIT 3;
```
-------------------------2732 sample_num
```sql
SELECT "Sales Channel", COUNT(OrderNumber) AS OrderCount
FROM "Sales Orders"
WHERE SUBSTR(OrderDate, 1, 1) = '1' AND SUBSTR(OrderDate, -2) = '20'
GROUP BY "Sales Channel"
ORDER BY OrderCount DESC
LIMIT 1;
```
-------------------------2733 sample_num
```sql
SELECT p.ProductName 
FROM SalesOrders so 
JOIN Products p ON so._ProductID = p.ProductID 
WHERE so.OrderNumber = 'SO - 0005951';
```
-------------------------2734 sample_num
```sql
SELECT sl."City Name", st."Sales Team"
FROM "Sales Orders" so
JOIN "Store Locations" sl ON so."_StoreID" = sl."StoreID"
JOIN "Sales Team" st ON so."_SalesTeamID" = st."SalesTeamID"
WHERE so."OrderNumber" = 'SO - 0001004';
```
-------------------------2735 sample_num
```sql
SELECT c.CustomerID, c.CustomerNames, SUM((so.UnitPrice - so.UnitCost) * so.OrderQuantity) AS NetProfit
FROM SalesOrders so
JOIN StoreLocations sl ON so._StoreID = sl.StoreID
JOIN Customers c ON so._CustomerID = c.CustomerID
WHERE sl.CityName = 'Gilbert' AND sl.State = 'Arizona' AND so.ProcuredDate LIKE '%/19'
GROUP BY c.CustomerID, c.CustomerNames
ORDER BY NetProfit DESC
LIMIT 1;
```
-------------------------2736 sample_num
```sql
SELECT COUNT(*) 
FROM Sales Orders 
WHERE _StoreID IN (
    SELECT StoreID 
    FROM Store Locations 
    WHERE "City Name" = 'Chandler'
) AND SUBSTR(OrderDate, -2) = '20';
```
-------------------------2737 sample_num
```sql
SELECT AVG(Household_Income) AS Average_Household_Income
FROM Store_Locations
WHERE "City Name" = 'Glendale';
```
-------------------------2738 sample_num
```sql
SELECT MAX(DiscountApplied) AS BestDiscount
FROM SalesOrders
WHERE SUBSTR(OrderDate, -2) = '20';
```
-------------------------2739 sample_num
```sql
SELECT MAX(consecutive) AS max_consecutive_ties
FROM (
    SELECT COUNT(*) AS consecutive
    FROM (
        SELECT *,
               ROW_NUMBER() OVER (ORDER BY Date) - 
               ROW_NUMBER() OVER (PARTITION BY (CASE WHEN FTR = 'D' THEN 1 ELSE 0 END) ORDER BY Date) AS grp
        FROM matchs
        WHERE AwayTeam = 'Ebbsfleet' AND season = '2008' AND FTR = 'D'
    ) AS subquery
    GROUP BY grp
) AS final_query;
```
-------------------------2740 sample_num
```sql
SELECT 
    DIVIDE(COUNT(CASE WHEN country = 'England' THEN division END), COUNT(division)) AS percentage
FROM 
    divisions;
```
-------------------------2741 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN FTR = 'H' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_won,
    (COUNT(CASE WHEN FTR = 'A' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_lost,
    (COUNT(CASE WHEN FTR = 'D' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_drawn
FROM matchs
WHERE HomeTeam = 'Cittadella';
```
-------------------------2742 sample_num
```sql
SELECT AwayTeam, 
       COUNT(CASE WHEN FTR = 'A' THEN 1 END) * 1.0 / COUNT(*) AS winning_percentage
FROM matchs
WHERE HomeTeam = 'Caen' AND season = '2010'
GROUP BY AwayTeam
ORDER BY winning_percentage DESC
LIMIT 1;
```
-------------------------2743 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Div = 'F1' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    matchs
WHERE 
    Date = '2005-07-30';
```
-------------------------2744 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN FTR = 'D' AND (HomeTeam = 'Sassuolo' OR AwayTeam = 'Sassuolo') THEN 1 END) * 100.0) / 
    COUNT(CASE WHEN HomeTeam = 'Sassuolo' OR AwayTeam = 'Sassuolo' THEN 1 END) AS percentage
FROM matchs;
```
-------------------------2745 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN FTAG = 2 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    matchs
WHERE 
    season = 2017;
```
-------------------------2746 sample_num
```sql
SELECT DISTINCT HomeTeam AS Team FROM matchs WHERE Div = 'E2'
UNION
SELECT DISTINCT AwayTeam AS Team FROM matchs WHERE Div = 'E2';
```
-------------------------2747 sample_num
```sql
SELECT COUNT(DISTINCT HomeTeam) + COUNT(DISTINCT AwayTeam) AS TotalTeams
FROM matchs
JOIN divisions ON matchs.Div = divisions.division
WHERE divisions.country = 'Greece' AND (FTHG >= 4 OR FTAG >= 4);
```
-------------------------2748 sample_num
```sql
SELECT COUNT(*) 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE d.name = 'Scottish Championship' 
AND m.season = '2019' 
AND m.FTHG = 2 
AND m.FTAG = 2;
```
-------------------------2749 sample_num
```sql
SELECT HomeTeam, season
FROM matchs m
JOIN divisions d ON m.Div = d.division
WHERE d.country = 'Scotland' AND m.FTHG = 10
GROUP BY HomeTeam, season
HAVING COUNT(*) > 0;
```
-------------------------2750 sample_num
```sql
SELECT HomeTeam, 
       COUNT(*) AS HomeWins, 
       (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM matchs m 
                              JOIN divisions d ON m.Div = d.division 
                              WHERE d.name = 'LaLiga' AND d.country = 'Spain' AND m.season = 2017)) AS percentage
FROM matchs m
JOIN divisions d ON m.Div = d.division
WHERE d.name = 'LaLiga' AND d.country = 'Spain' AND m.season = 2017 AND m.FTR = 'H'
GROUP BY HomeTeam
ORDER BY HomeWins DESC
LIMIT 1;
```
-------------------------2751 sample_num
```sql
SELECT 
    d.division, 
    COUNT(m.HomeTeam) AS team_count, 
    (COUNT(m.HomeTeam) * 100.0 / (SELECT COUNT(DISTINCT HomeTeam) FROM matchs WHERE season = '2012' AND Div IN (SELECT division FROM divisions WHERE country = 'England'))) AS percentage
FROM 
    matchs m
JOIN 
    divisions d ON m.Div = d.division
WHERE 
    m.season = '2012' AND d.country = 'England'
GROUP BY 
    d.division;
```
-------------------------2752 sample_num
```sql
SELECT HomeTeam, FTHG AS Score
FROM matchs
WHERE season = 2021
ORDER BY FTHG DESC
LIMIT 1
UNION
SELECT AwayTeam, FTAG AS Score
FROM matchs
WHERE season = 2021
ORDER BY FTAG DESC
LIMIT 1
ORDER BY Score DESC
LIMIT 1;
```
-------------------------2753 sample_num
```sql
SELECT HomeTeam 
FROM matchs 
WHERE Div = 'P1' 
ORDER BY FTHG DESC 
LIMIT 1;
```
-------------------------2754 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN FTR = 'H' AND season = 2010 THEN 1 END) * 1.0 / COUNT(CASE WHEN season = 2010 THEN 1 END)) - 
    (COUNT(CASE WHEN FTR = 'A' AND season = 2010 THEN 1 END) * 1.0 / COUNT(CASE WHEN season = 2010 THEN 1 END)) AS win_percentage_difference
FROM 
    matchs
WHERE 
    season = 2010;
```
-------------------------2755 sample_num
```sql
SELECT d.division
FROM divisions d
JOIN matchs m ON d.division = m.Div
WHERE m.season = '2008' AND m.FTR = 'D'
GROUP BY d.division
ORDER BY COUNT(m.Div) DESC
LIMIT 1;
```
-------------------------2756 sample_num
```sql
SELECT HomeTeam 
FROM matchs 
WHERE Div = 'EC' AND Date = '2008-01-20' AND FTR = 'H';
```
-------------------------2757 sample_num
```sql
SELECT d.name 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE m.Date = '2009-09-13' AND m.HomeTeam = 'Club Brugge' AND m.AwayTeam = 'Genk';
```
-------------------------2758 sample_num
```sql
SELECT COUNT(*) 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE d.name = 'Scottish Premiership' 
AND m.season BETWEEN '2006' AND '2008';
```
-------------------------2759 sample_num
```sql
SELECT d.division, d.country 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE m.HomeTeam = 'Hearts' AND m.AwayTeam = 'Hibernian';
```
-------------------------2760 sample_num
```sql
SELECT AwayTeam 
FROM matchs 
JOIN divisions ON matchs.Div = divisions.division 
WHERE divisions.name = 'Bundesliga' 
GROUP BY AwayTeam 
ORDER BY MAX(FTAG) DESC 
LIMIT 1;
```
-------------------------2761 sample_num
```sql
SELECT DISTINCT m.AwayTeam 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE d.country = 'Italy' 
LIMIT 3;
```
-------------------------2762 sample_num
```sql
SELECT d.name
FROM divisions d
JOIN matchs m ON d.division = m.Div
WHERE m.season = '2019'
GROUP BY d.name
HAVING COUNT(CASE WHEN m.FTR = 'D' THEN 1 END) = (
    SELECT MIN(draft_count)
    FROM (
        SELECT COUNT(CASE WHEN FTR = 'D' THEN 1 END) AS draft_count
        FROM matchs
        WHERE season = '2019'
        GROUP BY Div
    ) AS subquery
);
```
-------------------------2763 sample_num
```sql
SELECT COUNT(*) 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE d.name = 'LaLiga' AND m.HomeTeam = 'Valencia' AND m.FTR = 'H';
```
-------------------------2764 sample_num
```sql
SELECT COUNT(*) 
FROM matchs 
WHERE Div = 'Seria A' AND FTR = 'D';
```
-------------------------2765 sample_num
```sql
SELECT COUNT(*) FROM divisions WHERE country = 'England';
```
-------------------------2766 sample_num
```sql
SELECT name FROM divisions WHERE country = 'Netherlands';
```
-------------------------2767 sample_num
```sql
SELECT FTR 
FROM matchs 
WHERE Date = '2009-10-10' AND HomeTeam = 'East Fife' AND AwayTeam = 'Dumbarton';
```
-------------------------2768 sample_num
```sql
SELECT FTHG, FTAG FROM matchs WHERE HomeTeam = 'Bursaspor' AND AwayTeam = 'Denizlispor' AND Date = '2009-04-26';
```
-------------------------2769 sample_num
```sql
SELECT MIN(Date) 
FROM matchs 
WHERE (FTHG + FTAG) > 10;
```
-------------------------2770 sample_num
```sql
SELECT HomeTeam, AwayTeam, FTR
FROM matchs
WHERE Div = (SELECT division FROM divisions WHERE name = 'Ligue 2')
GROUP BY HomeTeam, AwayTeam
ORDER BY SUM(FTHG + FTAG) DESC
LIMIT 1;
```
-------------------------2771 sample_num
```sql
SELECT COUNT(*) 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE d.name = 'LaLiga 2' 
AND m.Date = '2016-03-27' 
AND m.FTR = 'A';
```
-------------------------2772 sample_num
```sql
SELECT COUNT(*) 
FROM matchs 
WHERE Div = (SELECT division FROM divisions WHERE name = 'National League') 
AND Date = '2018-08-07' 
AND FTR = 'D';
```
-------------------------2773 sample_num
```sql
SELECT d.country
FROM matchs m
JOIN divisions d ON m.Div = d.division
WHERE m.FTAG = (SELECT MAX(FTAG) FROM matchs)
```
-------------------------2774 sample_num
```sql
SELECT d.name 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE m.FTHG = 1 AND m.FTAG = 8 AND m.season = '2011';
```
-------------------------2775 sample_num
```sql
SELECT d.name
FROM divisions d
JOIN matchs m ON d.division = m.Div
WHERE m.Date = '2020-02-22' AND (m.FTHG + m.FTAG) > 5
GROUP BY d.name
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------2776 sample_num
```sql
SELECT d.name 
FROM divisions d
JOIN matchs m ON d.division = m.Div
WHERE m.FTHG = 0 AND m.FTAG = 0
GROUP BY d.name
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------2777 sample_num
```sql
SELECT COUNT(*) 
FROM matchs 
WHERE Div = (SELECT division FROM divisions WHERE name = 'Scottish League One') 
AND Date = (SELECT Date FROM matchs WHERE HomeTeam = 'Pro Vercelli' AND AwayTeam = 'Pescara' AND FTHG = 5 AND FTAG = 2);
```
-------------------------2778 sample_num
```sql
SELECT COUNT(*) 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE m.FTHG = '5' AND m.FTAG = '0' AND d.country = 'Greece';
```
-------------------------2779 sample_num
```sql
SELECT DISTINCT d.country 
FROM divisions d 
JOIN matchs m ON d.division = m.Div 
WHERE m.HomeTeam = 'Bradford' OR m.AwayTeam = 'Bradford';
```
-------------------------2780 sample_num
```sql
SELECT COUNT(DISTINCT HomeTeam) 
FROM matchs 
WHERE Div = 'Eredivisie' AND season = '2008';
```
-------------------------2781 sample_num
```sql
SELECT 
    DIVIDE(COUNT(m.Div) FILTER (WHERE m.FTR = 'H'), COUNT(m.Div)) AS home_win_ratio
FROM 
    matchs m
JOIN 
    divisions d ON m.Div = d.division
WHERE 
    d.name = 'Bundesliga' AND m.season = '2021';
```
-------------------------2782 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN d.name = 'Liga NOS' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    matchs m
JOIN 
    divisions d ON m.Div = d.division
WHERE 
    m.FTHG = '1' AND m.FTAG = '1';
```
-------------------------2783 sample_num
```sql
SELECT COUNT(*) 
FROM matchs 
WHERE Div = 'Premier League' AND season = '2021';
```
-------------------------2784 sample_num
```sql
SELECT HomeTeam 
FROM matchs 
JOIN divisions ON matchs.Div = divisions.division 
WHERE divisions.name = 'Bundesliga' AND matchs.Date = '2020/10/2';
```
-------------------------2785 sample_num
```sql
SELECT HomeTeam 
FROM matchs 
JOIN divisions ON matchs.Div = divisions.division 
WHERE divisions.name = 'Bundesliga' AND matchs.Date = '2020/10/2' AND matchs.FTR = 'H';
```
-------------------------2786 sample_num
```sql
SELECT HomeTeam, COUNT(*) AS HomeWins
FROM matchs
WHERE Div = 'Bundesliga' AND FTR = 'H'
GROUP BY HomeTeam
ORDER BY HomeWins DESC
LIMIT 1;
```
-------------------------2787 sample_num
```sql
SELECT COUNT(*) 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE d.name = 'Bundesliga' AND m.AwayTeam = 'Werder Bremen' AND m.FTR = 'A';
```
-------------------------2788 sample_num
```sql
SELECT COUNT(*) 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE d.name = 'Bundesliga' AND m.season = '2021' AND m.FTR = 'A';
```
-------------------------2789 sample_num
```sql
SELECT COUNT(*) 
FROM matchs 
WHERE Div = (SELECT division FROM divisions WHERE name = 'Bundesliga') 
AND FTR = 'D';
```
-------------------------2790 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM matchs m JOIN divisions d ON m.Div = d.division WHERE m.FTR = 'H' AND m.season = 2021 AND d.name = 'Bundesliga') -
    (SELECT COUNT(*) FROM matchs m JOIN divisions d ON m.Div = d.division WHERE m.FTR = 'H' AND m.season = 2021 AND d.name = 'Premier League') AS home_victory_difference;
```
-------------------------2791 sample_num
```sql
SELECT m.HomeTeam 
FROM matchs m 
JOIN divisions d ON m.Div = d.division 
WHERE d.name = 'Bundesliga' AND m.FTR = 'H' AND m.season = '2021';
```
-------------------------2792 sample_num
```sql
SELECT HomeTeam, COUNT(*) AS HomeVictories
FROM matchs
WHERE season = '2021' AND Div = 'Bundesliga' AND FTR = 'H' AND HomeTeam IN ('Augsburg', 'Mainz')
GROUP BY HomeTeam
ORDER BY HomeVictories DESC
LIMIT 1;
```
-------------------------2793 sample_num
```sql
SELECT HomeTeam, SUM(FTHG) AS TotalHomeGoals
FROM matchs
WHERE Div = 'Bundesliga' AND season = '2021'
GROUP BY HomeTeam
ORDER BY TotalHomeGoals DESC
LIMIT 1;
```
-------------------------2794 sample_num
```sql
SELECT SUM(FTHG) AS total_home_goals
FROM matchs
WHERE Div = 'Bundesliga' AND season = '2021';
```
-------------------------2795 sample_num
```sql
SELECT 
    (SUM(CASE WHEN HomeTeam = 'Club Brugge' AND FTR = 'H' THEN 1 
              WHEN AwayTeam = 'Club Brugge' AND FTR = 'A' THEN 1 
              ELSE 0 END) * 1.0) / 
    COUNT(*) AS winning_rate
FROM 
    matchs m
JOIN 
    divisions d ON m.Div = d.division
WHERE 
    d.name = 'Premier League' AND 
    m.season = 2021;
```
-------------------------2796 sample_num
```sql
SELECT (SUM(homeWon) / SUM(won)) * 100 AS home_win_percentage
FROM teams
WHERE won > 0;
```
-------------------------2797 sample_num
```sql
SELECT tmID
FROM teams
WHERE (lost / games) > 0.75;
```
-------------------------2798 sample_num
```sql
SELECT t1.name, t1.won
FROM teams t1
JOIN teams t2 ON t1.tmID = t2.tmID
WHERE t1.year = 2005 AND t2.year = 2004 AND t1.won > t2.won;
```
-------------------------2799 sample_num
```sql
SELECT name, o_pts
FROM teams
WHERE (homeWon - homeLost) / games > 0.8;
```
-------------------------2800 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN rank = 1 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    teams
WHERE 
    playoff IS NOT NULL;
```
-------------------------2801 sample_num
```sql
SELECT coachID, won, lost 
FROM coaches 
WHERE tmID = 'BOS' AND year = 1950;
```
-------------------------2802 sample_num
```sql
SELECT coachID, GROUP_CONCAT(DISTINCT tmID) AS teams
FROM coaches
WHERE year BETWEEN 1970 AND 1980
GROUP BY coachID
HAVING COUNT(*) = (
    SELECT MAX(coach_count)
    FROM (
        SELECT COUNT(*) AS coach_count
        FROM coaches
        WHERE year BETWEEN 1970 AND 1980
        GROUP BY coachID
    ) AS counts
)
```
-------------------------2803 sample_num
```sql
SELECT c.coachID, t.name AS team_name, c.won
FROM coaches c
JOIN teams t ON c.tmID = t.tmID AND c.year = t.year
WHERE c.year = 2000 AND c.won > 50;
```
-------------------------2804 sample_num
```sql
SELECT coachID, tmID, year
FROM coaches
WHERE year BETWEEN 2000 AND 2010 AND lost > won;
```
-------------------------2805 sample_num
```sql
SELECT t.name, c.year, t.o_pts
FROM coaches c
JOIN teams t ON c.tmID = t.tmID AND c.year = t.year
WHERE c.coachID = 'adelmri01' AND c.year BETWEEN 1990 AND 1995;
```
-------------------------2806 sample_num
```sql
SELECT DISTINCT c.coachID, t.year
FROM teams t
JOIN coaches c ON t.tmID = c.tmID AND t.year = c.year
WHERE (t.won / t.games) > 0.9;
```
-------------------------2807 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.birthState = 'NY' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    awards_players ap
JOIN 
    players p ON ap.playerID = p.playerID
WHERE 
    ap.award = 'All-Defensive First Team' 
    AND ap.year BETWEEN 1980 AND 2000;
```
-------------------------2808 sample_num
```sql
SELECT t.divID
FROM awards_coaches ac
JOIN coaches c ON ac.coachID = c.coachID AND ac.year = c.year
JOIN teams t ON c.tmID = t.tmID AND c.year = t.year
WHERE ac.award = 'NBA Coach of the Year' AND ac.year = 1977 AND t.year = 1976;
```
-------------------------2809 sample_num
```sql
SELECT c.coachID
FROM coaches c
JOIN awards_coaches a ON c.coachID = a.coachID
WHERE c.tmID = (SELECT tmID FROM teams WHERE name = 'Chicago Bulls' AND year = 1981)
  AND a.award = 'NBA Coach of the Year'
  AND a.year BETWEEN 1970 AND 1979;
```
-------------------------2810 sample_num
```sql
SELECT p.nameNick 
FROM players p 
JOIN players_teams pt ON p.playerID = pt.playerID 
WHERE pt.year = 2006 AND pt.blocks = 2 AND pt.lgID = 'NBA' 
AND pt.tmID IN (SELECT tmID FROM teams WHERE year = 2006 AND confID = 'West');
```
-------------------------2811 sample_num
```sql
SELECT year 
FROM series_post 
WHERE tmIDLoser = 'HSM' AND round = 'DSF' 
AND year IN (SELECT year FROM teams WHERE rank = (SELECT MIN(rank) FROM teams WHERE year = series_post.year));
```
-------------------------2812 sample_num
```sql
SELECT p.birthDate
FROM player_allstar AS pa
JOIN players AS p ON pa.playerID = p.playerID
WHERE pa.season_id = 1985
AND pa.assists = (
    SELECT MAX(assists)
    FROM player_allstar
    WHERE season_id = 1985
);
```
-------------------------2813 sample_num
```sql
SELECT DISTINCT p.playerID, p.firstName, p.lastName
FROM players p
JOIN player_allstar pa ON p.playerID = pa.playerID
WHERE p.birthCity = 'Winter Haven'
  AND pa.season_id BETWEEN 1980 AND 1989
  AND pa.minutes = 12;
```
-------------------------2814 sample_num
```sql
SELECT COUNT(DISTINCT p.playerID) AS num_players
FROM player_allstar pas
JOIN players p ON pas.playerID = p.playerID
WHERE pas.conference = 'East' AND pas.minutes < 5 AND p.college = 'Illinois College';
```
-------------------------2815 sample_num
```sql
SELECT playerID, SUM(rebounds) AS total_rebounds
FROM players_teams
WHERE year BETWEEN 1990 AND 2007
GROUP BY playerID
HAVING SUM(dRebounds) / SUM(rebounds) * 100 > 75;
```
-------------------------2816 sample_num
```sql
SELECT year, MAX(won * 1.0 / (won + lost)) AS best_balance
FROM coaches
WHERE coachID = 'costela01'
GROUP BY year
ORDER BY best_balance DESC
LIMIT 1;
```
-------------------------2817 sample_num
```sql
SELECT SUM(pa.minutes) AS total_minutes
FROM player_allstar pa
JOIN players p ON pa.playerID = p.playerID
WHERE p.birthCity = 'Brooklyn' AND p.nameNick LIKE '%Superman%';
```
-------------------------2818 sample_num
```sql
SELECT tmID, homeLost
FROM teams
WHERE year IN (
    SELECT year
    FROM awards_coaches
    WHERE award = 'NBA Coach of the Year' AND year = 1994
) AND tmID IN (
    SELECT tmID
    FROM coaches
    WHERE coachID IN (
        SELECT coachID
        FROM awards_coaches
        WHERE award = 'NBA Coach of the Year' AND year = 1994
    )
)
ORDER BY homeLost DESC
LIMIT 1;
```
-------------------------2819 sample_num
```sql
SELECT DISTINCT s.tmIDWinner
FROM series_post s
JOIN teams t ON s.tmIDWinner = t.tmID AND s.year = t.year
WHERE s.round = 'CSF' 
  AND s.tmIDLoser = 'LAL' 
  AND t.lgID = 'NBA' 
  AND t.won > 60 
  AND s.year = 1996;
```
-------------------------2820 sample_num
```sql
SELECT DISTINCT p.lgID
FROM players p
WHERE p.weight = (SELECT MAX(weight) * 0.6 FROM players WHERE height = 80);
```
-------------------------2821 sample_num
```sql
SELECT c.coachID, p.firstName, p.lastName
FROM coaches c
JOIN players p ON c.coachID = p.playerID
WHERE c.lgID = 'NBA'
GROUP BY c.coachID, p.firstName, p.lastName
HAVING COUNT(DISTINCT c.tmID) > 2;
```
-------------------------2822 sample_num
```sql
SELECT c.coachID
FROM coaches c
WHERE c.post_wins = (
    SELECT MAX(post_wins)
    FROM coaches
)
```
-------------------------2823 sample_num
```sql
SELECT c.coachID, MIN(c.post_losses) AS least_post_losses
FROM coaches c
JOIN (
    SELECT coachID
    FROM coaches
    GROUP BY coachID
    HAVING COUNT(DISTINCT tmID) > 2
) AS served_coaches ON c.coachID = served_coaches.coachID
GROUP BY c.coachID
ORDER BY least_post_losses ASC
LIMIT 1;
```
-------------------------2824 sample_num
```sql
SELECT COUNT(*) 
FROM players 
WHERE lgID = 'ABA' AND (pos = 'C' OR pos = 'F-C');
```
-------------------------2825 sample_num
```sql
SELECT firstName 
FROM players 
WHERE lgID = 'NBA' AND (pos = 'F' OR pos = 'F-C');
```
-------------------------2826 sample_num
```sql
SELECT COUNT(DISTINCT p.playerID) 
FROM players p 
JOIN players_teams pt ON p.playerID = pt.playerID 
JOIN teams t ON pt.tmID = t.tmID 
WHERE p.hsCity = 'Chicago' AND t.divID = 'WE';
```
-------------------------2827 sample_num
```sql
SELECT DISTINCT p.college
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
JOIN teams t ON pt.tmID = t.tmID AND pt.year = t.year
WHERE t.divID = 'EA';
```
-------------------------2828 sample_num
```sql
SELECT COUNT(*) 
FROM players 
WHERE lgID = 'NBL' AND birthCity = 'Spencer';
```
-------------------------2829 sample_num
```sql
SELECT p.birthDate
FROM players p
JOIN awards_players ap ON p.playerID = ap.playerID
WHERE ap.award = 'Most Valuable Player'
GROUP BY p.playerID
ORDER BY COUNT(ap.award) DESC
LIMIT 1;
```
-------------------------2830 sample_num
```sql
SELECT COUNT(DISTINCT ap.playerID) AS MVP_Winners
FROM awards_players ap
JOIN players p ON ap.playerID = p.playerID
WHERE p.birthCity = 'Whitestone' AND ap.award = 'Most Valuable Player';
```
-------------------------2831 sample_num
```sql
SELECT MAX(p.height) AS tallest_height
FROM players p
JOIN awards_players ap ON p.playerID = ap.playerID
WHERE ap.award = 'Rookie of the Year';
```
-------------------------2832 sample_num
```sql
SELECT AVG(p.weight) AS average_weight
FROM players p
JOIN awards_players ap ON p.playerID = ap.playerID
WHERE ap.award = 'Rookie of the Year';
```
-------------------------2833 sample_num
```sql
SELECT AVG(height) AS average_height
FROM players
JOIN awards_players ON players.playerID = awards_players.playerID
WHERE players.highSchool LIKE '%New York%' AND awards_players.award = 'Most Valuable Player';
```
-------------------------2834 sample_num
```sql
SELECT name, o_pts 
FROM teams 
WHERE year = 2000 
ORDER BY o_pts DESC 
LIMIT 10;
```
-------------------------2835 sample_num
```sql
SELECT name
FROM teams
WHERE (won * 1.0) / (won + lost) < 0.5;
```
-------------------------2836 sample_num
```sql
SELECT DISTINCT c.coachID
FROM coaches c
JOIN teams t ON c.tmID = t.tmID AND c.year = t.year
WHERE (c.won::float / (c.won + c.lost)) > 0.8;
```
-------------------------2837 sample_num
```sql
SELECT coachID
FROM coaches
WHERE lgID = 'NBA'
GROUP BY coachID
HAVING MAX(year) - MIN(year) > 10;
```
-------------------------2838 sample_num
```sql
SELECT COUNT(DISTINCT t.tmID) AS team_count
FROM teams t
JOIN players_teams pt ON t.tmID = pt.tmID
JOIN awards_players ap ON pt.playerID = ap.playerID
WHERE t.o_pts >= 3800 AND ap.award = 'Most Valuable Player';
```
-------------------------2839 sample_num
```sql
SELECT MAX(height) AS tallest_height, firstName, lastName 
FROM players 
WHERE playerID IN (SELECT playerID FROM players_teams WHERE tmID = 'AFS') 
GROUP BY firstName, lastName 
ORDER BY tallest_height DESC 
LIMIT 1;
```
-------------------------2840 sample_num
```sql
SELECT p.lastName 
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
WHERE pt.tmID = 'BLB';
```
-------------------------2841 sample_num
```sql
SELECT COUNT(DISTINCT coachID) 
FROM awards_coaches 
WHERE year BETWEEN 1962 AND 1975;
```
-------------------------2842 sample_num
```sql
SELECT coachID
FROM awards_coaches
WHERE year BETWEEN 1970 AND 1990
GROUP BY coachID
HAVING COUNT(coachID) = 2;
```
-------------------------2843 sample_num
```sql
SELECT COUNT(DISTINCT coachID) 
FROM awards_coaches 
WHERE year BETWEEN 1962 AND 2011 
AND (award LIKE 'NBA%' OR award LIKE 'ABA%') 
GROUP BY coachID 
HAVING COUNT(DISTINCT CASE WHEN award LIKE 'NBA%' THEN 1 END) > 0 
AND COUNT(DISTINCT CASE WHEN award LIKE 'ABA%' THEN 1 END) > 0;
```
-------------------------2844 sample_num
```sql
SELECT AVG(points) AS average_points
FROM player_allstar
JOIN players ON player_allstar.playerID = players.playerID
WHERE player_allstar.season_id = 1975 AND players.birthCountry = 'USA';
```
-------------------------2845 sample_num
```sql
SELECT p.lastName, p.firstName
FROM players p
JOIN player_allstar pa ON p.playerID = pa.playerID
WHERE p.height > 75;
```
-------------------------2846 sample_num
```sql
SELECT MIN(p.weight) AS minimum_weight
FROM players p
JOIN player_allstar pa ON p.playerID = pa.playerID
WHERE p.college = 'UCLA';
```
-------------------------2847 sample_num
```sql
SELECT MAX(weight) AS max_weight
FROM players
WHERE birthCountry = 'USA'
AND playerID IN (SELECT playerID FROM player_allstar);
```
-------------------------2848 sample_num
```sql
SELECT SUM(pa.points) AS total_points
FROM player_allstar pa
JOIN players p ON pa.playerID = p.playerID
WHERE pa.season_id BETWEEN 1960 AND 1970
AND p.deathDate = '0000-00-00';
```
-------------------------2849 sample_num
```sql
SELECT p.lastName, p.firstName
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
WHERE p.birthDate >= '1950-01-01' AND (pt.oRebounds / pt.rebounds) > 0.3;
```
-------------------------2850 sample_num
```sql
SELECT COUNT(*) 
FROM awards_players 
WHERE award = 'Rookie of the Year' 
AND year BETWEEN 1969 AND 2010;
```
-------------------------2851 sample_num
```sql
SELECT t.name
FROM teams t
JOIN players_teams pt ON t.tmID = pt.tmID
JOIN player_allstar pa ON pt.playerID = pa.playerID
GROUP BY t.tmID, t.name
HAVING COUNT(pa.playerID) >= 3;
```
-------------------------2852 sample_num
```sql
SELECT MAX(pt.points) AS max_points
FROM players_teams pt
JOIN teams t ON pt.tmID = t.tmID AND pt.year = t.year
WHERE t.rank = 1 AND t.year BETWEEN 1950 AND 1970;
```
-------------------------2853 sample_num
```sql
SELECT DISTINCT p.lastName, p.firstName
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
JOIN teams t ON pt.tmID = t.tmID AND pt.year = t.year
WHERE t.rank = 1 AND t.year BETWEEN 1937 AND 1940
GROUP BY pt.tmID
HAVING COUNT(CASE WHEN t.rank = 1 THEN 1 END) >= 3;
```
-------------------------2854 sample_num
```sql
SELECT t.name
FROM teams t
JOIN players_teams pt ON t.tmID = pt.tmID AND t.year = pt.year
WHERE t.rank = 3 AND t.year BETWEEN 1937 AND 1940
GROUP BY t.name
ORDER BY MAX(pt.points) DESC
LIMIT 1;
```
-------------------------2855 sample_num
```sql
SELECT COUNT(DISTINCT pt.tmID) AS team_count
FROM players_teams pt
WHERE pt.year = 1937
GROUP BY pt.tmID
HAVING SUM(pt.points) >= 500;
```
-------------------------2856 sample_num
```sql
SELECT COUNT(DISTINCT pt.playerID) 
FROM players_teams pt 
JOIN teams t ON pt.tmID = t.tmID AND pt.year = t.year 
WHERE t.year = 1990 AND (t.won / t.games) > 0.75;
```
-------------------------2857 sample_num
```sql
SELECT playerID, firstName, lastName, height
FROM players
WHERE race = 'B'
ORDER BY height ASC
LIMIT 3;
```
-------------------------2858 sample_num
```sql
SELECT COUNT(*) 
FROM draft 
WHERE draftYear = 1970 AND firstName = 'Joe';
```
-------------------------2859 sample_num
```sql
SELECT SUM(fg_made) AS total_fg_made
FROM player_allstar
WHERE first_name = 'George' AND last_name = 'Mikan' AND season_id BETWEEN '1951' AND '1953';
```
-------------------------2860 sample_num
```sql
SELECT 
    MIN((weight / (height * height)) * 703) AS min_bmi,
    MAX((weight / (height * height)) * 703) AS max_bmi
FROM 
    players;
```
-------------------------2861 sample_num
```sql
SELECT name 
FROM teams 
WHERE homeLost / (homeWon + homeLost) = (
    SELECT MAX(homeLost / (homeWon + homeLost)) 
    FROM teams
);
```
-------------------------2862 sample_num
```sql
SELECT (d.draftYear - YEAR(p.birthDate)) AS age_when_drafted
FROM draft d
JOIN players p ON d.playerID = p.playerID
WHERE p.firstName = 'Alexis' AND p.lastName = 'Ajinca'
ORDER BY d.draftYear ASC
LIMIT 1;
```
-------------------------2863 sample_num
```sql
SELECT MAX(height) AS tallest_height, firstName, lastName 
FROM players 
JOIN players_teams ON players.playerID = players_teams.playerID 
JOIN teams ON players_teams.tmID = teams.tmID 
WHERE teams.name = 'Denver Nuggets' AND players_teams.year > 1980;
```
-------------------------2864 sample_num
```sql
SELECT playerID, COUNT(award) AS award_count
FROM awards_players
JOIN players ON awards_players.playerID = players.playerID
WHERE players.deathDate IS NOT NULL
GROUP BY playerID
ORDER BY award_count DESC
LIMIT 1;
```
-------------------------2865 sample_num
```sql
SELECT t.name
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
JOIN teams t ON pt.tmID = t.tmID
WHERE p.college = 'UCLA'
GROUP BY t.tmID, t.name
ORDER BY COUNT(p.playerID) DESC
LIMIT 1;
```
-------------------------2866 sample_num
```sql
SELECT AVG((weight / (height * height)) * 703) AS average_BMI
FROM player_allstar
JOIN players ON player_allstar.playerID = players.playerID;
```
-------------------------2867 sample_num
```sql
SELECT t.name
FROM teams t
WHERE t.lgID = 'ABA' AND t.year IN (1972, 1973)
GROUP BY t.tmID
ORDER BY 
    (SUM(CASE WHEN t.year = 1973 THEN t.won END) / NULLIF(SUM(CASE WHEN t.year = 1973 THEN t.won + t.lost END), 0)) -
    (SUM(CASE WHEN t.year = 1972 THEN t.won END) / NULLIF(SUM(CASE WHEN t.year = 1972 THEN t.won + t.lost END), 0))
) DESC
LIMIT 1;
```
-------------------------2868 sample_num
```sql
SELECT firstName
FROM players p
JOIN player_allstar pa ON p.playerID = pa.playerID
WHERE pa.league_id = 'NBL'
GROUP BY p.playerID, p.firstName
HAVING SUM(pa.personal_fouls) = (
    SELECT MAX(total_fouls)
    FROM (
        SELECT SUM(personal_fouls) AS total_fouls
        FROM player_allstar
        WHERE league_id = 'NBL'
        GROUP BY playerID
    ) AS subquery
);
```
-------------------------2869 sample_num
```sql
SELECT AVG(height) AS average_height
FROM players
JOIN player_allstar ON players.playerID = player_allstar.playerID
WHERE player_allstar.conference = 'East';
```
-------------------------2870 sample_num
```sql
SELECT coachID, SUM(won) AS total_won
FROM coaches
WHERE coachID IN (
    SELECT coachID
    FROM awards_coaches
    WHERE award = 'ABA Coach of the Year'
)
GROUP BY coachID
ORDER BY total_won DESC
LIMIT 1;
```
-------------------------2871 sample_num
```sql
SELECT t.name 
FROM awards_coaches ac 
JOIN coaches c ON ac.coachID = c.coachID 
JOIN teams t ON c.tmID = t.tmID AND c.year = t.year 
WHERE ac.award = 'NBA Coach of the Year' AND ac.year = 1992;
```
-------------------------2872 sample_num
```sql
SELECT p.firstName, p.lastName
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
WHERE pt.year = 1973
ORDER BY (pt.fgMade * 1.0 / pt.fgAttempted) DESC
LIMIT 1;
```
-------------------------2873 sample_num
```sql
SELECT teams.name 
FROM draft 
JOIN teams ON draft.tmID = teams.tmID 
WHERE draft.firstName = 'Mike' AND draft.lastName = 'Lynn';
```
-------------------------2874 sample_num
```sql
SELECT COUNT(DISTINCT p.playerID) 
FROM awards_players ap 
JOIN players p ON ap.playerID = p.playerID 
WHERE ap.award = 'Most Improved Player' 
AND ap.year BETWEEN 1985 AND 1990 
AND p.birthCountry = 'USA';
```
-------------------------2875 sample_num
```sql
SELECT p.firstName, p.lastName
FROM players p
JOIN player_allstar pa ON p.playerID = pa.playerID
WHERE p.college = 'California';
```
-------------------------2876 sample_num
```sql
SELECT COUNT(DISTINCT coachID) AS coach_count
FROM awards_coaches
WHERE year BETWEEN 1950 AND 1970
GROUP BY coachID
HAVING COUNT(award) > 1;
```
-------------------------2877 sample_num
```sql
SELECT COUNT(DISTINCT playerID) 
FROM awards_players 
WHERE award = 'Most Valuable Player' 
AND year BETWEEN 1969 AND 1975;
```
-------------------------2878 sample_num
```sql
SELECT t.name
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
JOIN teams t ON pt.tmID = t.tmID
GROUP BY t.name, p.birthState
HAVING COUNT(p.playerID) >= 5;
```
-------------------------2879 sample_num
```sql
SELECT COUNT(DISTINCT pt.tmID) AS team_count
FROM players_teams pt
JOIN player_allstar pa ON pt.playerID = pa.playerID
WHERE pa.league_id = 'NBA'
GROUP BY pt.tmID
HAVING COUNT(pa.playerID) >= 3;
```
-------------------------2880 sample_num
```sql
SELECT birthState, COUNT(playerID) AS player_count
FROM players
JOIN player_allstar ON players.playerID = player_allstar.playerID
GROUP BY birthState
ORDER BY player_count DESC
LIMIT 1;
```
-------------------------2881 sample_num
```sql
SELECT COUNT(DISTINCT pt.playerID) 
FROM players_teams pt 
JOIN teams t ON pt.tmID = t.tmID AND pt.year = t.year 
WHERE t.rank = 6 AND t.year = 1937;
```
-------------------------2882 sample_num
```sql
SELECT COUNT(DISTINCT pt.playerID) 
FROM players_teams pt 
JOIN teams t ON pt.tmID = t.tmID AND pt.year = t.year 
WHERE t.year = 1950 AND (t.lost / (t.won + t.lost)) < 0.2;
```
-------------------------2883 sample_num
```sql
SELECT CONCAT(firstName, ' ', middleName, ' ', lastName) AS fullName
FROM players
WHERE birthCountry != 'USA';
```
-------------------------2884 sample_num
```sql
SELECT coachID
FROM coaches
GROUP BY coachID
HAVING COUNT(DISTINCT tmID) > 2;
```
-------------------------2885 sample_num
```sql
SELECT coachID, (won - lost) AS win_difference
FROM coaches
WHERE year = 1988
ORDER BY win_difference DESC
LIMIT 1;
```
-------------------------2886 sample_num
```sql
SELECT t.name
FROM awards_coaches ac
JOIN coaches c ON ac.coachID = c.coachID AND ac.year = c.year
JOIN teams t ON c.tmID = t.tmID AND c.year = t.year
WHERE ac.award = 'NBA Coach of the Year' AND ac.year = 2010;
```
-------------------------2887 sample_num
```sql
SELECT p.firstName, p.lastName, p.height, p.weight
FROM players p
JOIN player_allstar pa ON p.playerID = pa.playerID
WHERE pa.ftAttempted > 0 AND pa.ftAttempted = pa.ftMade;
```
-------------------------2888 sample_num
```sql
SELECT p.firstName, p.lastName, t.name
FROM draft d
JOIN players p ON d.playerID = p.playerID
JOIN teams t ON d.tmID = t.tmID
WHERE d.draftFrom = 'Seattle' AND d.draftYear BETWEEN 1965 AND 1970;
```
-------------------------2889 sample_num
```sql
SELECT CONCAT(firstName, ' ', middleName, ' ', lastName) AS full_name, 
       (2003 - YEAR(birthDate)) AS age
FROM players 
JOIN awards_players ON players.playerID = awards_players.playerID
WHERE awards_players.award = 'Finals MVP' AND awards_players.year = 2003;
```
-------------------------2890 sample_num
```sql
SELECT t.name AS champion, sp.year
FROM series_post sp
JOIN teams t ON sp.tmIDWinner = t.tmID AND sp.lgIDWinner = t.lgID
WHERE sp.year BETWEEN 1950 AND 1960 AND sp.round = 'F';
```
-------------------------2891 sample_num
```sql
SELECT t.name AS team_name, c.coachID
FROM teams t
JOIN coaches c ON t.tmID = c.tmID AND t.year = c.year
JOIN series_post s ON t.tmID = s.tmIDWinner OR t.tmID = s.tmIDLoser
WHERE s.round = 'QF' AND s.year = 1946;
```
-------------------------2892 sample_num
```sql
SELECT CONCAT(p.firstName, ' ', COALESCE(p.middleName, ''), ' ', p.lastName) AS fullName
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
JOIN series_post sp ON pt.tmID = sp.tmIDWinner AND sp.year = 1970 AND sp.round = 'F';
```
-------------------------2893 sample_num
```sql
SELECT college 
FROM players 
WHERE playerID = (
    SELECT playerID 
    FROM awards_players 
    WHERE year = 1970 
    GROUP BY playerID 
    ORDER BY COUNT(award) DESC 
    LIMIT 1
);
```
-------------------------2894 sample_num
```sql
SELECT p.firstName, p.lastName, MAX(p.birthDate) AS youngest_birthDate
FROM awards_players ap
JOIN players p ON ap.playerID = p.playerID
WHERE ap.award = 'Rookie of the Year'
GROUP BY p.playerID
ORDER BY youngest_birthDate DESC
LIMIT 1;
```
-------------------------2895 sample_num
```sql
SELECT CONCAT(p.firstName, ' ', p.middleName, ' ', p.lastName) AS fullName
FROM draft d
JOIN players p ON d.playerID = p.playerID
WHERE d.draftYear = 1973 AND d.draftRound = 1 AND p.birthCountry <> 'USA';
```
-------------------------2896 sample_num
```sql
SELECT (SUM(o_rebounds) / SUM(rebounds)) * 100 AS offensive_rebound_percentage
FROM player_allstar
WHERE season_id = '2000';
```
-------------------------2897 sample_num
```sql
SELECT c.year, t.name AS team, c.coachID
FROM coaches c
JOIN teams t ON c.tmID = t.tmID AND c.year = t.year
WHERE (c.won / (c.won + c.lost)) > 0.75;
```
-------------------------2898 sample_num
```sql
SELECT DISTINCT c.*
FROM coaches c
JOIN teams t ON c.tmID = t.tmID AND c.year = t.year
WHERE t.name = 'Oklahoma City Thunder';
```
-------------------------2899 sample_num
```sql
SELECT COUNT(DISTINCT playerID) AS player_count
FROM player_allstar
WHERE season_id = 1990 AND o_rebounds <= d_rebounds * 0.5;
```
-------------------------2900 sample_num
```sql
SELECT COUNT(DISTINCT playerID) AS num_players
FROM player_allstar
WHERE season_id BETWEEN 2000 AND 2005
GROUP BY playerID
HAVING SUM(steals) <= 10;
```
-------------------------2901 sample_num
```sql
SELECT p.playerID, p.firstName, p.lastName
FROM draft d
JOIN awards_players ap ON d.playerID = ap.playerID
JOIN players p ON d.playerID = p.playerID
WHERE d.tmID = 'Portland' 
  AND d.draftRound = 2 
  AND d.draftYear = 1971 
  AND ap.award = 'Rookie of the Year';
```
-------------------------2902 sample_num
```sql
SELECT COUNT(*) 
FROM player_allstar 
JOIN players ON player_allstar.playerID = players.playerID 
WHERE player_allstar.season_id = 1973 AND players.race = 'B';
```
-------------------------2903 sample_num
```sql
SELECT name 
FROM teams 
WHERE year = 1947 AND round = 'QF' AND d_pts >= 3513;
```
-------------------------2904 sample_num
```sql
SELECT 
    (SUM(lost) * 100.0 / SUM(games)) AS percentage_lost
FROM 
    teams
WHERE 
    name = 'Houston Mavericks';
```
-------------------------2905 sample_num
```sql
SELECT playerID 
FROM awards_players 
WHERE award = 'Most Valuable Player' AND lgID = 'NBA' AND year > 1990;
```
-------------------------2906 sample_num
```sql
SELECT COUNT(*) 
FROM players_teams 
WHERE playerID = 'abdulka01' 
  AND tmID = 'LAL' 
  AND year BETWEEN 1975 AND 1980;
```
-------------------------2907 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN award = 'NBA Coach of the Year' THEN 1 END) * 100.0 / COUNT(coachID)) AS percentage
FROM 
    awards_coaches
WHERE 
    year = 1969;
```
-------------------------2908 sample_num
```sql
SELECT 
    ( 
        (COUNT(CASE WHEN year = 1947 AND tmIDWinner = 'CHS' THEN 1 END) * 1.0 / NULLIF(COUNT(CASE WHEN year = 1947 THEN 1 END), 0)) - 
        (COUNT(CASE WHEN year = 1946 AND tmIDWinner = 'CHS' THEN 1 END) * 1.0 / NULLIF(COUNT(CASE WHEN year = 1946 THEN 1 END), 0))
    ) * 100 AS winning_rate_difference_percentage
FROM 
    series_post
WHERE 
    year IN (1946, 1947);
```
-------------------------2909 sample_num
```sql
SELECT COUNT(*) 
FROM awards_players ap
JOIN players p ON ap.playerID = p.playerID
WHERE ap.year = 2010 AND p.hsCity = 'Chicago';
```
-------------------------2910 sample_num
```sql
SELECT 
    (COUNT(DISTINCT CASE WHEN a.award = 'All-Defensive Second Team' THEN a.playerID END) * 100.0 / COUNT(DISTINCT p.playerID)) AS percentage
FROM 
    players p
LEFT JOIN 
    awards_players a ON p.playerID = a.playerID
WHERE 
    p.college = 'Auburn';
```
-------------------------2911 sample_num
```sql
SELECT CONCAT(p.firstName, ' ', p.middleName, ' ', p.lastName) AS full_name, pa.steals
FROM player_allstar pa
JOIN players p ON pa.playerID = p.playerID
WHERE pa.season_id = '1997'
ORDER BY pa.steals DESC
LIMIT 5;
```
-------------------------2912 sample_num
```sql
SELECT p.college
FROM awards_players ap
JOIN players p ON ap.playerID = p.playerID
WHERE ap.award = 'Finals MVP' AND ap.year = 1990 AND ap.lgID = 'NBA';
```
-------------------------2913 sample_num
```sql
SELECT playerID 
FROM player_allstar 
WHERE season_id = 1996 
  AND lgID = 'NBA' 
  AND ft_attempted > 0 
  AND ft_made / ft_attempted > 0.7;
```
-------------------------2914 sample_num
```sql
SELECT COUNT(*) 
FROM player_allstar 
WHERE season_id BETWEEN 1980 AND 1983 
AND league_id = 'NBA' 
AND (three_made / three_attempted) > 0.6;
```
-------------------------2915 sample_num
```sql
SELECT DISTINCT coachID 
FROM coaches 
WHERE lgID = 'NBA' AND tmID = 'STL' AND won > lost;
```
-------------------------2916 sample_num
```sql
SELECT COUNT(*) 
FROM awards_coaches ac 
JOIN coaches c ON ac.coachID = c.coachID 
WHERE c.tmID = 'CHI' AND ac.award = 'Coach of the Year' AND ac.lgID = 'NBA';
```
-------------------------2917 sample_num
```sql
SELECT p.firstName, p.lastName
FROM players p
JOIN draft d ON p.playerID = d.playerID
JOIN player_allstar pa ON p.playerID = pa.playerID
WHERE d.draftYear BETWEEN 1990 AND 2000 AND d.lgID = 'NBA'
GROUP BY p.playerID
ORDER BY SUM(pa.points) DESC
LIMIT 1;
```
-------------------------2918 sample_num
```sql
SELECT CONCAT_WS(' ', p.firstName, p.middleName, p.lastName) AS fullName
FROM players p
JOIN player_allstar pa ON p.playerID = pa.playerID
WHERE p.college = 'Wake Forest college'
GROUP BY p.playerID
HAVING SUM(pa.o_rebounds) > SUM(pa.d_rebounds)
ORDER BY (SUM(pa.o_rebounds) - SUM(pa.d_rebounds)) DESC
LIMIT 1;
```
-------------------------2919 sample_num
```sql
SELECT CONCAT(p.firstName, ' ', p.middleName, ' ', p.lastName) AS full_name, pt.tmID
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
WHERE p.birthCity = 'Atlanta'
ORDER BY pt.blocks DESC
LIMIT 1;
```
-------------------------2920 sample_num
```sql
SELECT t.name
FROM teams t
WHERE t.year BETWEEN 1980 AND 2000
GROUP BY t.name
HAVING COUNT(CASE WHEN t.rank = 1 THEN 1 END) >= 5
   AND SUM(t.lost) >= 2;
```
-------------------------2921 sample_num
```sql
SELECT pt.tmID, p.firstName, p.lastName, MAX(pt.points / NULLIF(pt.minutes, 0)) AS points_per_minute
FROM players_teams pt
JOIN players p ON pt.playerID = p.playerID
WHERE pt.lgID = 'NBA' AND pt.year BETWEEN 1991 AND 2000
GROUP BY pt.tmID, p.firstName, p.lastName
ORDER BY points_per_minute DESC
LIMIT 1;
```
-------------------------2922 sample_num
```sql
SELECT 
    AVG(CASE WHEN d.lgID = 'ABA' THEN 1970 - YEAR(p.birthDate) END) - 
    AVG(CASE WHEN d.lgID = 'NBA' THEN 1970 - YEAR(p.birthDate) END) AS age_difference
FROM 
    draft d
JOIN 
    players p ON d.playerID = p.playerID
WHERE 
    d.draftYear = 1970;
```
-------------------------2923 sample_num
```sql
SELECT playerID, MAX(GP) AS max_GP
FROM players_teams
WHERE year = 2011 AND lgID = 'NBA'
GROUP BY playerID
ORDER BY max_GP DESC
LIMIT 1;
```
-------------------------2924 sample_num
```sql
SELECT COUNT(DISTINCT d.playerID) AS AllStarCount
FROM draft d
JOIN player_allstar pa ON d.playerID = pa.playerID
WHERE d.draftYear = 1996 AND d.draftRound = 1 AND d.lgID = 'NBA';
```
-------------------------2925 sample_num
```sql
SELECT pt.tmID 
FROM awards_players ap 
JOIN players_teams pt ON ap.playerID = pt.playerID 
WHERE ap.award LIKE '%MVP%' AND ap.year = 1997 AND ap.lgID = 'NBA';
```
-------------------------2926 sample_num
```sql
SELECT t.won
FROM teams t
JOIN players_teams pt ON t.tmID = pt.tmID AND t.year = pt.year
JOIN player_allstar pa ON pt.playerID = pa.playerID
WHERE pa.season_id = '2001' AND pa.league_id = 'NBA'
GROUP BY t.tmID
ORDER BY SUM(pt.points) DESC
LIMIT 1;
```
-------------------------2927 sample_num
```sql
SELECT AVG(turnovers) AS turnovers_per_game
FROM player_allstar
WHERE season_id = '2003' AND league_id = 'NBA' AND playerID = (
    SELECT playerID
    FROM player_allstar
    WHERE season_id = '2003' AND league_id = 'NBA'
    ORDER BY assists DESC
    LIMIT 1
);
```
-------------------------2928 sample_num
```sql
SELECT COUNT(*) AS nba_titles
FROM awards_players
WHERE playerID = (SELECT playerID FROM players WHERE firstName = 'Ray' AND lastName = 'Allen')
  AND award = 'NBA Championship'
  AND lgID = 'NBA';
```
-------------------------2929 sample_num
```sql
SELECT 
    (SELECT 
        SUM(won) * 1.0 / (SUM(won) + SUM(lost)) 
     FROM 
        teams 
     WHERE 
        year = 2004) - 
    (SELECT 
        SUM(won) * 1.0 / (SUM(won) + SUM(lost)) 
     FROM 
        teams 
     WHERE 
        year = 2003 AND tmID IN 
            (SELECT 
                tmID 
             FROM 
                draft 
             WHERE 
                draftYear = 2003 AND draftRound = 1)) AS win_rate_increase;
```
-------------------------2930 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) 
FROM awards_coaches ac 
JOIN coaches c ON ac.coachID = c.coachID 
WHERE ac.award = 'NBA coach of the year' 
AND c.year BETWEEN 1971 AND 1975 
AND c.tmID = 'POR';
```
-------------------------2931 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.steals > 0 THEN p.playerID END) * 100.0 / COUNT(p.playerID)) AS percent_steals
FROM 
    players_teams p
WHERE 
    p.lgID = 'NBA' AND p.tmID = 'LAL';
```
-------------------------2932 sample_num
```sql
SELECT CONCAT(p.firstName, ' ', p.middleName, ' ', p.lastName) AS player_name
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
WHERE pt.year = 1996 AND pt.playoff IS NULL
ORDER BY pt.steals DESC
LIMIT 1;
```
-------------------------2933 sample_num
```sql
SELECT playerID 
FROM players_teams 
WHERE year = 1988 AND PostGP = 0 
ORDER BY turnovers DESC 
LIMIT 1;
```
-------------------------2934 sample_num
```sql
SELECT tmID, (won * 1.0 / (won + lost)) AS winning_rate
FROM teams
WHERE lgID = 'NBA' AND year = 2000 AND playoff = 0
ORDER BY winning_rate DESC
LIMIT 1;
```
-------------------------2935 sample_num
```sql
SELECT tmID, MAX(o_pts) AS max_points
FROM teams
WHERE year = 1998 AND playoff = 'N'
GROUP BY tmID
ORDER BY max_points DESC
LIMIT 1;
```
-------------------------2936 sample_num
```sql
SELECT name 
FROM teams 
WHERE year = 2001 AND playoff = 'N' 
AND won = (SELECT MAX(won) FROM teams WHERE year = 2001 AND playoff = 'N');
```
-------------------------2937 sample_num
```sql
SELECT tmID, SUM(rebounds) AS total_rebounds
FROM players_teams
WHERE year = 1997 AND PostGP = 0
GROUP BY tmID
ORDER BY total_rebounds DESC
LIMIT 1;
```
-------------------------2938 sample_num
```sql
SELECT pt.tmID 
FROM draft d 
JOIN players_teams pt ON d.playerID = pt.playerID 
WHERE d.draftRound = 1 AND d.draftSelection = 6 AND d.draftYear = 1976 AND pt.year = 1976;
```
-------------------------2939 sample_num
```sql
SELECT homeWon 
FROM teams 
WHERE year = 1998 AND tmID = (
    SELECT tmID 
    FROM draft 
    WHERE draftYear = 1998 AND draftRound = 1 AND draftSelection = 12
);
```
-------------------------2940 sample_num
```sql
SELECT weight, height
FROM players
WHERE playerID = (
    SELECT playerID
    FROM player_allstar
    ORDER BY rebounds DESC
    LIMIT 1
);
```
-------------------------2941 sample_num
```sql
SELECT hsName
FROM players
WHERE playerID = (
    SELECT playerID
    FROM player_allstar
    ORDER BY rebounds DESC
    LIMIT 1
);
```
-------------------------2942 sample_num
```sql
SELECT DISTINCT pt.tmID
FROM player_allstar pas
JOIN players_teams pt ON pas.playerID = pt.playerID
WHERE pas.season_id = '1997' 
AND pt.rebounds = (
    SELECT MAX(rebounds)
    FROM player_allstar
    WHERE season_id = '1997'
);
```
-------------------------2943 sample_num
```sql
SELECT SUM(pt.points) AS career_points
FROM players p
JOIN player_allstar pt ON p.playerID = pt.playerID
WHERE pt.season_id = (SELECT MAX(season_id) FROM player_allstar)
AND (p.pos LIKE '%C%' OR p.pos LIKE '%F%' OR p.pos LIKE '%G%')
GROUP BY p.playerID
ORDER BY career_points DESC
LIMIT 1;
```
-------------------------2944 sample_num
```sql
SELECT pt.tmID
FROM players p
JOIN players_teams pt ON p.playerID = pt.playerID
WHERE p.pos LIKE '%F' AND p.lgID = 'NBA'
ORDER BY p.birthDate DESC
LIMIT 1;
```
-------------------------2945 sample_num
```sql
SELECT p.playerID, p.firstName, p.lastName, pa.games_played
FROM players p
JOIN player_allstar pa ON p.playerID = pa.playerID
WHERE p.college = 'Central Missouri State'
AND pa.games_played = (SELECT MAX(games_played) FROM player_allstar WHERE playerID IN (SELECT playerID FROM players WHERE college = 'Central Missouri State'));
```
-------------------------2946 sample_num
```sql
SELECT t.name
FROM players_teams pt
JOIN teams t ON pt.tmID = t.tmID AND pt.year = t.year
WHERE pt.year = 2000 AND pt.GP = 82
ORDER BY pt.minutes ASC
LIMIT 1;
```
-------------------------2947 sample_num
```sql
SELECT CONCAT(p.firstName, ' ', p.lastName) AS full_name
FROM players_teams pt
JOIN players p ON pt.playerID = p.playerID
WHERE pt.year = 1995 AND pt.GP = 82
ORDER BY pt.turnovers DESC
LIMIT 1;
```
-------------------------2948 sample_num
```sql
SELECT tmID, MAX(steals) AS max_steals
FROM players_teams
WHERE year = 2011 AND GP = GS
GROUP BY tmID
ORDER BY max_steals DESC
LIMIT 1;
```
-------------------------2949 sample_num
```sql
SELECT t.name
FROM players_teams pt
JOIN teams t ON pt.tmID = t.tmID AND pt.year = t.year
WHERE pt.GP = pt.GS
GROUP BY t.name
ORDER BY COUNT(pt.playerID) DESC
LIMIT 1;
```
-------------------------2950 sample_num
```sql
SELECT p.birthDate
FROM player_allstar AS pa
JOIN players AS p ON pa.playerID = p.playerID
WHERE pa.season_id = '2001' AND pa.rebounds = (
    SELECT MAX(rebounds)
    FROM player_allstar
    WHERE season_id = '2001'
);
```
-------------------------2951 sample_num
```sql
SELECT t.name
FROM player_allstar pa
JOIN players_teams pt ON pa.playerID = pt.playerID
JOIN teams t ON pt.tmID = t.tmID AND pt.year = t.year
WHERE pa.season_id = '1997' 
AND pa.rebounds = (SELECT MAX(rebounds) FROM player_allstar WHERE season_id = '1997');
```
-------------------------2952 sample_num
```sql
SELECT t.name
FROM players_teams pt
JOIN teams t ON pt.tmID = t.tmID AND pt.year = t.year
WHERE pt.rebounds > 600 AND pt.year = 2011
GROUP BY t.name
HAVING COUNT(pt.playerID) > 1;
```
-------------------------2953 sample_num
```sql
SELECT COUNT(*) FROM works WHERE Date < 1602;
```
-------------------------2954 sample_num
```sql
SELECT COUNT(*) 
FROM chapters 
WHERE Act = 1 AND work_id = (SELECT id FROM works WHERE Title = 'Twelfth Night');
```
-------------------------2955 sample_num
```sql
SELECT c.Description 
FROM chapters c 
JOIN works w ON c.work_id = w.id 
WHERE w.Title = 'Twelfth Night' AND c.Act = 1 AND c.Scene = 2;
```
-------------------------2956 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM chapters WHERE Act = 1 AND work_id = (SELECT id FROM works WHERE Title = 'Twelfth Night')) -
    (SELECT COUNT(*) FROM chapters WHERE Act = 5 AND work_id = (SELECT id FROM works WHERE Title = 'Twelfth Night')) AS SceneDifference;
```
-------------------------2957 sample_num
```sql
SELECT w.Title 
FROM characters c 
JOIN paragraphs p ON c.id = p.character_id 
JOIN chapters ch ON p.chapter_id = ch.id 
JOIN works w ON ch.work_id = w.id 
WHERE c.CharName = 'Lord Abergavenny';
```
-------------------------2958 sample_num
```sql
SELECT c.CharName 
FROM characters c
JOIN paragraphs p ON c.id = p.character_id
JOIN chapters ch ON p.chapter_id = ch.id
JOIN works w ON ch.work_id = w.id
WHERE w.Title = 'Twelfth Night';
```
-------------------------2959 sample_num
```sql
SELECT COUNT(p.id) 
FROM paragraphs p
JOIN chapters c ON p.chapter_id = c.id
JOIN works w ON c.work_id = w.id
WHERE w.Title = 'Twelfth Night' AND c.Act = 1 AND c.Scene = 1;
```
-------------------------2960 sample_num
```sql
SELECT p.PlainText 
FROM paragraphs p
JOIN chapters c ON p.chapter_id = c.id
JOIN works w ON c.work_id = w.id
WHERE w.Title = 'Twelfth Night' AND c.Act = 1 AND c.Scene = 1;
```
-------------------------2961 sample_num
```sql
SELECT COUNT(*) 
FROM paragraphs 
WHERE character_id = (SELECT id FROM characters WHERE CharName = 'Lord Abergavenny');
```
-------------------------2962 sample_num
```sql
SELECT p.id 
FROM paragraphs p
JOIN characters c ON p.character_id = c.id
WHERE c.Description = 'son to Tamora';
```
-------------------------2963 sample_num
```sql
SELECT COUNT(*) 
FROM chapters 
JOIN works ON chapters.work_id = works.id 
WHERE chapters.Description = 'OLIVIA’S house.' 
AND works.Title = 'Twelfth Night';
```
-------------------------2964 sample_num
```sql
SELECT COUNT(DISTINCT c.id) 
FROM characters c 
JOIN paragraphs p ON c.id = p.character_id 
JOIN chapters ch ON p.chapter_id = ch.id 
JOIN works w ON ch.work_id = w.id 
WHERE w.Title = 'Twelfth Night';
```
-------------------------2965 sample_num
```sql
SELECT w.Title
FROM works w
JOIN chapters c ON w.id = c.work_id
JOIN paragraphs p ON c.id = p.chapter_id
GROUP BY w.id
ORDER BY COUNT(p.character_id) DESC
LIMIT 1;
```
-------------------------2966 sample_num
```sql
SELECT AVG(character_count) AS average_characters
FROM (
    SELECT COUNT(DISTINCT character_id) AS character_count
    FROM paragraphs
    GROUP BY chapter_id
) AS character_counts;
```
-------------------------2967 sample_num
```sql
SELECT AVG(scene_count) AS average_scenes_per_act
FROM (
    SELECT Act, COUNT(DISTINCT Scene) AS scene_count
    FROM chapters
    JOIN works ON chapters.work_id = works.id
    WHERE works.Title = 'Twelfth Night'
    GROUP BY Act
) AS act_scenes;
```
-------------------------2968 sample_num
```sql
SELECT COUNT(*) FROM works WHERE GenreType = 'Comedy';
```
-------------------------2969 sample_num
```sql
SELECT MIN(Date) 
FROM works 
WHERE GenreType = 'Poem';
```
-------------------------2970 sample_num
```sql
SELECT Abbrev FROM characters WHERE CharName = 'Earl of Westmoreland';
```
-------------------------2971 sample_num
```sql
SELECT c.Description
FROM chapters c
JOIN paragraphs p ON c.id = p.chapter_id
GROUP BY c.id
ORDER BY COUNT(p.id) DESC
LIMIT 1;
```
-------------------------2972 sample_num
```sql
SELECT c.CharName 
FROM paragraphs p 
JOIN characters c ON p.character_id = c.id 
WHERE p.PlainText = 'Would he do so, I''ld beg your precious mistress, Which he counts but a trifle.';
```
-------------------------2973 sample_num
```sql
SELECT COUNT(*) 
FROM characters 
WHERE id IN (
    SELECT DISTINCT character_id 
    FROM paragraphs 
    WHERE chapter_id IN (
        SELECT id 
        FROM chapters 
        WHERE work_id = (
            SELECT id 
            FROM works 
            WHERE Title = 'Titus Andronicus'
        )
    )
);
```
-------------------------2974 sample_num
```sql
SELECT COUNT(DISTINCT Act) AS NumberOfActs
FROM chapters
JOIN works ON chapters.work_id = works.id
WHERE works.LongTitle = 'Two Gentlemen of Verona';
```
-------------------------2975 sample_num
```sql
SELECT c.Description 
FROM paragraphs p 
JOIN characters c ON p.character_id = c.id 
WHERE p.id = '640171';
```
-------------------------2976 sample_num
```sql
SELECT w.Title 
FROM works w 
JOIN chapters c ON w.id = c.work_id 
JOIN paragraphs p ON c.id = p.chapter_id 
JOIN characters ch ON p.character_id = ch.id 
WHERE ch.CharName = 'Shylock';
```
-------------------------2977 sample_num
```sql
SELECT COUNT(DISTINCT Scene) 
FROM chapters 
WHERE work_id = (SELECT id FROM works WHERE Title = 'King John');
```
-------------------------2978 sample_num
```sql
SELECT COUNT(DISTINCT chapters.id) AS chapter_count
FROM chapters
JOIN paragraphs ON chapters.id = paragraphs.chapter_id
JOIN characters ON paragraphs.character_id = characters.id
WHERE characters.CharName = 'Demetrius';
```
-------------------------2979 sample_num
```sql
SELECT w.Title 
FROM works w 
JOIN characters c ON c.id = 324 
WHERE c.Description = 'this friend of Caesar';
```
-------------------------2980 sample_num
```sql
SELECT c.Description 
FROM chapters c 
JOIN works w ON c.work_id = w.id 
WHERE c.Act = '2' AND c.Scene = '2' AND w.Title = 'Midsummer Night''s Dream';
```
-------------------------2981 sample_num
```sql
SELECT w.LongTitle
FROM works w
JOIN chapters c ON w.id = c.work_id
WHERE w.GenreType = 'Tragedy'
GROUP BY w.id, w.LongTitle
ORDER BY COUNT(c.Scene) DESC
LIMIT 1;
```
-------------------------2982 sample_num
```sql
SELECT COUNT(*) 
FROM paragraphs 
WHERE chapter_id = (
    SELECT id 
    FROM chapters 
    WHERE Description = 'A Sea-port in Cyprus. An open place near the quay.'
);
```
-------------------------2983 sample_num
```sql
SELECT 
    (SUM(CASE WHEN w.GenreType = 'Tragedy' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    chapters c
JOIN 
    works w ON c.work_id = w.id
WHERE 
    w.Date = '1594';
```
-------------------------2984 sample_num
```sql
SELECT AVG(chapter_count) AS average_chapters
FROM (
    SELECT COUNT(chapters.id) AS chapter_count
    FROM works
    JOIN chapters ON works.id = chapters.work_id
    WHERE works.Date = '1599'
    GROUP BY works.id
) AS chapter_counts;
```
-------------------------2985 sample_num
```sql
SELECT COUNT(*) 
FROM characters 
WHERE Description = 'servant to Timon';
```
-------------------------2986 sample_num
```sql
SELECT Title FROM works WHERE Date = (SELECT MIN(Date) FROM works);
```
-------------------------2987 sample_num
```sql
SELECT COUNT(*) FROM works WHERE GenreType = 'Poem';
```
-------------------------2988 sample_num
```sql
SELECT COUNT(*) 
FROM chapters 
WHERE work_id = 7 AND Act = 1;
```
-------------------------2989 sample_num
```sql
SELECT COUNT(*) 
FROM works 
WHERE Date BETWEEN 1500 AND 1599 AND GenreType = 'Tragedy';
```
-------------------------2990 sample_num
```sql
SELECT CharName 
FROM characters 
WHERE Description = 'Daughter to Capulet';
```
-------------------------2991 sample_num
```sql
SELECT COUNT(*) 
FROM paragraphs 
WHERE PlainText = 'Ay, surely, mere the truth: I know his lady.';
```
-------------------------2992 sample_num
```sql
SELECT w.LongTitle
FROM works w
JOIN chapters c ON w.id = c.work_id
WHERE c.Act = 1
GROUP BY w.id
ORDER BY COUNT(c.Scene) DESC
LIMIT 1;
```
-------------------------2993 sample_num
```sql
SELECT c.Description
FROM chapters c
JOIN paragraphs p ON c.id = p.chapter_id
GROUP BY c.id
ORDER BY COUNT(p.id) DESC
LIMIT 1;
```
-------------------------2994 sample_num
```sql
SELECT Description 
FROM chapters 
JOIN works ON chapters.work_id = works.id 
WHERE works.LongTitle = 'Twelfth Night, Or What You Will' 
AND chapters.Act = 2 
AND chapters.Scene = 2;
```
-------------------------2995 sample_num
```sql
SELECT c.Description 
FROM chapters c 
JOIN paragraphs p ON c.id = p.chapter_id 
WHERE p.ParagraphNum < 150;
```
-------------------------2996 sample_num
```sql
SELECT w.Title 
FROM works w 
JOIN chapters c ON w.id = c.work_id 
WHERE c.Description = 'A field near Windsor';
```
-------------------------2997 sample_num
```sql
SELECT COUNT(p.id) AS ParagraphCount
FROM paragraphs p
JOIN chapters c ON p.chapter_id = c.id
WHERE c.id = (
    SELECT c2.id
    FROM chapters c2
    WHERE c2.Act = 1
    GROUP BY c2.work_id
    ORDER BY COUNT(c2.Scene) DESC
    LIMIT 1
);
```
-------------------------2998 sample_num
```sql
SELECT CharName 
FROM characters 
JOIN paragraphs ON characters.id = paragraphs.character_id 
JOIN chapters ON paragraphs.chapter_id = chapters.id 
WHERE chapters.Description = 'The sea-coast.' 
AND characters.CharName != '(stage directions)' 
GROUP BY CharName 
HAVING COUNT(paragraphs.character_id) = 5;
```
-------------------------2999 sample_num
```sql
SELECT COUNT(*) 
FROM chapters c
JOIN works w ON c.work_id = w.id
JOIN paragraphs p ON c.id = p.chapter_id
WHERE w.Title = 'As You Like It' AND p.ParagraphNum < 50;
```
-------------------------3000 sample_num
```sql
SELECT p.character_id 
FROM paragraphs p 
JOIN chapters c ON p.chapter_id = c.id 
WHERE c.Description = 'Florence. Without the walls. A tucket afar off.' 
AND p.PlainText = 'His name, I pray you.';
```
-------------------------3001 sample_num
```sql
SELECT COUNT(*) 
FROM characters 
WHERE id IN (SELECT DISTINCT character_id FROM paragraphs WHERE chapter_id IN (SELECT id FROM chapters WHERE work_id = (SELECT id FROM works WHERE Title = 'Hamlet')));
```
-------------------------3002 sample_num
```sql
SELECT COUNT(*) 
FROM chapters 
WHERE Act = 5 AND work_id = (SELECT id FROM works WHERE LongTitle = 'History of Henry VIII');
```
-------------------------3003 sample_num
```sql
SELECT COUNT(DISTINCT w.id)
FROM works w
JOIN chapters c ON w.id = c.work_id
WHERE w.GenreType = 'History' AND c.Act = 1
GROUP BY w.id
HAVING COUNT(c.Scene) <= 2;
```
-------------------------3004 sample_num
```sql
SELECT COUNT(DISTINCT Act) AS ActCount
FROM chapters
WHERE work_id = (SELECT id FROM works WHERE Title = 'Sonnets');
```
-------------------------3005 sample_num
```sql
SELECT c.Description 
FROM chapters c 
JOIN paragraphs p ON c.id = p.chapter_id 
JOIN characters ch ON p.character_id = ch.id 
WHERE ch.Abbrev = '1Play' 
ORDER BY p.chapter_id 
LIMIT 1;
```
-------------------------3006 sample_num
```sql
SELECT w.Title, w.GenreType
FROM works w
JOIN chapters c ON w.id = c.work_id
GROUP BY w.id, w.Title, w.GenreType
HAVING COUNT(c.Act) = 1;
```
-------------------------3007 sample_num
```sql
SELECT COUNT(p.id) 
FROM paragraphs p
JOIN chapters c ON p.chapter_id = c.id
JOIN characters ch ON p.character_id = ch.id
WHERE ch.CharName = 'Sir Richard Ratcliff' 
AND c.id = (
    SELECT c2.id 
    FROM chapters c2
    JOIN paragraphs p2 ON c2.id = p2.chapter_id
    WHERE p2.character_id = (SELECT id FROM characters WHERE CharName = 'Sir Richard Ratcliff')
    GROUP BY c2.id
    ORDER BY COUNT(p2.id) DESC
    LIMIT 1
);
```
-------------------------3008 sample_num
```sql
SELECT Description 
FROM chapters 
WHERE Act = 1 AND Scene = 1 AND work_id = (SELECT id FROM works WHERE Title = 'A Lover''s Complaint');
```
-------------------------3009 sample_num
```sql
SELECT w.Date 
FROM works w 
JOIN chapters c ON w.id = c.work_id 
GROUP BY w.id 
HAVING COUNT(c.Scene) = 154;
```
-------------------------3010 sample_num
```sql
SELECT AVG(scene_count) AS average_scenes
FROM (
    SELECT COUNT(DISTINCT Scene) AS scene_count
    FROM chapters
    JOIN works ON chapters.work_id = works.id
    WHERE works.GenreType = 'Comedy'
    GROUP BY works.id
) AS comedy_scenes;
```
-------------------------3011 sample_num
```sql
WITH CharacterCounts AS (
    SELECT 
        c.CharName,
        COUNT(p.id) AS AppearanceCount
    FROM 
        paragraphs p
    JOIN 
        characters c ON p.character_id = c.id
    JOIN 
        chapters ch ON p.chapter_id = ch.id
    JOIN 
        works w ON ch.work_id = w.id
    WHERE 
        w.LongTitle = 'The Tragedy of Romeo and Juliet'
        AND c.CharName IN ('Romeo', 'Juliet')
    GROUP BY 
        c.CharName
),
TotalCount AS (
    SELECT 
        COUNT(DISTINCT p.character_id) AS TotalCharacters
    FROM 
        paragraphs p
    JOIN 
        chapters ch ON p.chapter_id = ch.id
    JOIN 
        works w ON ch.work_id = w.id
    WHERE 
        w.LongTitle = 'The Tragedy of Romeo and Juliet'
)

SELECT 
    cc.CharName,
    cc.AppearanceCount,
    (cc.AppearanceCount * 100.0 / tc.TotalCharacters) AS Percentage
FROM 
    CharacterCounts cc, TotalCount tc
ORDER BY 
    cc.AppearanceCount DESC
LIMIT 1;
```
-------------------------3012 sample_num
```sql
SELECT ParagraphNum FROM paragraphs WHERE PlainText = 'This is Illyria, lady';
```
-------------------------3013 sample_num
```sql
SELECT COUNT(*) AS NumberOfParagraphs 
FROM paragraphs 
WHERE chapter_id = 18881;
```
-------------------------3014 sample_num
```sql
SELECT Title FROM works WHERE GenreType = 'History' LIMIT 5;
```
-------------------------3015 sample_num
```sql
SELECT COUNT(*) 
FROM chapters 
WHERE Act = 5 AND work_id = 9;
```
-------------------------3016 sample_num
```sql
SELECT c.CharName, c.Description 
FROM characters c 
JOIN paragraphs p ON c.id = p.character_id 
WHERE p.chapter_id = 18710;
```
-------------------------3017 sample_num
```sql
SELECT COUNT(*) 
FROM chapters 
WHERE work_id = (SELECT id FROM works WHERE Title = 'Midsummer Night''s Dream');
```
-------------------------3018 sample_num
```sql
SELECT COUNT(*) 
FROM paragraphs p
JOIN chapters c ON p.chapter_id = c.id
JOIN works w ON c.work_id = w.id
WHERE c.Act = 5 AND c.Scene = 1 AND w.Title = 'Comedy of Errors';
```
-------------------------3019 sample_num
```sql
SELECT c.CharName, c.Description 
FROM characters c
JOIN paragraphs p ON c.id = p.character_id
JOIN chapters ch ON p.chapter_id = ch.id
JOIN works w ON ch.work_id = w.id
WHERE w.Title = 'Venus and Adonis';
```
-------------------------3020 sample_num
```sql
SELECT w.Title 
FROM works w 
JOIN chapters c ON w.id = c.work_id 
JOIN paragraphs p ON c.id = p.chapter_id 
JOIN characters ch ON p.character_id = ch.id 
WHERE ch.CharName = 'Froth';
```
-------------------------3021 sample_num
```sql
SELECT COUNT(DISTINCT chapters.id) 
FROM chapters 
JOIN paragraphs ON chapters.id = paragraphs.chapter_id 
JOIN characters ON paragraphs.character_id = characters.id 
WHERE characters.CharName = 'First Witch';
```
-------------------------3022 sample_num
```sql
SELECT Scene, Description 
FROM chapters 
WHERE Act = 1 AND work_id = (SELECT id FROM works WHERE LongTitle = 'Pericles, Prince of Tyre');
```
-------------------------3023 sample_num
```sql
SELECT w.LongTitle 
FROM works w 
JOIN chapters c ON w.id = c.work_id 
JOIN paragraphs p ON c.id = p.chapter_id 
JOIN characters ch ON p.character_id = ch.id 
WHERE ch.Description = 'Servant to Montague';
```
-------------------------3024 sample_num
```sql
SELECT c.Scene, c.Act, w.Title
FROM chapters c
JOIN works w ON c.work_id = w.id
WHERE c.Description = 'The house of ANTIPHOLUS of Ephesus';
```
-------------------------3025 sample_num
```sql
SELECT c.CharName, p.ParagraphNum, p.PlainText
FROM characters c
JOIN paragraphs p ON c.id = p.character_id
WHERE c.Description = 'cousin to the king';
```
-------------------------3026 sample_num
```sql
SELECT AVG(scene_count) AS average_scenes_per_act
FROM (
    SELECT Act, COUNT(DISTINCT Scene) AS scene_count
    FROM chapters
    JOIN works ON chapters.work_id = works.id
    WHERE works.Title = 'Antony and Cleopatra'
    GROUP BY Act
) AS act_scenes;
```
-------------------------3027 sample_num
```sql
SELECT 
    (COUNT(p.id) * 100.0 / (SELECT COUNT(*) FROM paragraphs)) AS percentage
FROM 
    paragraphs p
JOIN 
    chapters c ON p.chapter_id = c.id
JOIN 
    works w ON c.work_id = w.id
WHERE 
    w.Title = 'All''s Well That Ends Well';
```
-------------------------3028 sample_num
```sql
SELECT COUNT(CharName) 
FROM characters 
WHERE Abbrev = 'all';
```
-------------------------3029 sample_num
```sql
SELECT Title FROM works WHERE GenreType = 'comedy' LIMIT 3;
```
-------------------------3030 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM works WHERE Date > 1593 AND GenreType = 'comedy') -
    (SELECT COUNT(*) FROM works WHERE Date > 1593 AND GenreType = 'History') AS Difference
```
-------------------------3031 sample_num
```sql
SELECT LongTitle 
FROM works 
WHERE GenreType = 'History' 
ORDER BY Date DESC 
LIMIT 1;
```
-------------------------3032 sample_num
```sql
SELECT id FROM works WHERE Title LIKE '%Henry%';
```
-------------------------3033 sample_num
```sql
SELECT CharName FROM characters WHERE Description = 'a senator of Venice';
```
-------------------------3034 sample_num
```sql
SELECT c.CharName 
FROM paragraphs p 
JOIN characters c ON p.character_id = c.id 
WHERE p.ParagraphNum = 8 AND p.chapter_id = 18820;
```
-------------------------3035 sample_num
```sql
SELECT c.Description 
FROM chapters c 
JOIN paragraphs p ON c.id = p.chapter_id 
JOIN characters ch ON p.character_id = ch.id 
WHERE c.id = 18704 AND ch.CharName = 'Orsino';
```
-------------------------3036 sample_num
```sql
SELECT COUNT(DISTINCT Scene) 
FROM chapters 
JOIN works ON chapters.work_id = works.id 
WHERE works.LongTitle = 'Twelfth Night, Or What You Will';
```
-------------------------3037 sample_num
```sql
SELECT c.Description 
FROM characters c
JOIN paragraphs p ON c.id = p.character_id
WHERE p.ParagraphNum = 20;
```
-------------------------3038 sample_num
```sql
SELECT COUNT(DISTINCT c.id) 
FROM chapters c 
JOIN paragraphs p ON c.id = p.chapter_id 
JOIN characters ch ON p.character_id = ch.id 
WHERE ch.CharName = 'Gratiano' 
AND ch.Description = 'friend to Antonio and Bassiano';
```
-------------------------3039 sample_num
```sql
SELECT c.Description 
FROM chapters c 
JOIN works w ON c.work_id = w.id 
WHERE c.id = 18706 AND w.Title = 'All''s Well That Ends Well';
```
-------------------------3040 sample_num
```sql
SELECT c.CharName 
FROM paragraphs p 
JOIN characters c ON p.character_id = c.id 
WHERE p.ParagraphNum = 3;
```
-------------------------3041 sample_num
```sql
SELECT p.*
FROM paragraphs p
JOIN characters c ON p.character_id = c.id
WHERE c.CharName = 'Aedile';
```
-------------------------3042 sample_num
```sql
SELECT CharName 
FROM characters 
WHERE id IN (SELECT character_id FROM paragraphs WHERE chapter_id = 18708) 
LIMIT 2;
```
-------------------------3043 sample_num
```sql
SELECT COUNT(DISTINCT Act) 
FROM chapters 
WHERE work_id = (SELECT id FROM works WHERE Title = 'Two Gentlemen of Verona' AND GenreType = 'comedy');
```
-------------------------3044 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN w.GenreType = 'history' AND scene_count >= 5 THEN 1 END) * 100.0 / COUNT(w.id)) AS percentage
FROM 
    works w
JOIN 
    chapters c ON w.id = c.work_id
JOIN 
    (SELECT chapter_id, COUNT(Scene) AS scene_count
     FROM chapters
     WHERE DATE >= 1500 AND DATE <= 1599
     GROUP BY chapter_id) AS scene_counts ON c.id = scene_counts.chapter_id
WHERE 
    w.Date >= 1500 AND w.Date <= 1599
GROUP BY 
    w.id;
```
-------------------------3045 sample_num
```sql
SELECT (SUM(CASE WHEN Act = 5 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage
FROM chapters
JOIN works ON chapters.work_id = works.id
WHERE works.Title = 'Titus Andronicus';
```
-------------------------3046 sample_num
```sql
SELECT COUNT(*) FROM works WHERE GenreType = 'Tragedy';
```
-------------------------3047 sample_num
```sql
SELECT COUNT(*) FROM works WHERE Title LIKE '%Henry%';
```
-------------------------3048 sample_num
```sql
SELECT character_id 
FROM paragraphs 
WHERE PlainText = 'O my poor brother! and so perchance may he be.';
```
-------------------------3049 sample_num
```sql
SELECT ParagraphNum, PlainText 
FROM paragraphs 
WHERE character_id = (SELECT id FROM characters WHERE CharName = 'Sir Andrew Aguecheek');
```
-------------------------3050 sample_num
```sql
SELECT w.Title, c.CharName
FROM works w
JOIN characters c ON c.id IN (SELECT DISTINCT character_id FROM paragraphs p JOIN chapters ch ON p.chapter_id = ch.id WHERE ch.work_id = w.id)
WHERE w.Date = (SELECT MAX(Date) FROM works);
```
-------------------------3051 sample_num
```sql
SELECT p.PlainText 
FROM paragraphs p 
JOIN characters c ON p.character_id = c.id 
WHERE p.ParagraphNum >= 1900 AND p.ParagraphNum <= 1950 
AND c.Description = 'a sea captain, friend to Sebastian';
```
-------------------------3052 sample_num
```sql
SELECT w.LongTitle 
FROM works w 
JOIN chapters c ON w.id = c.work_id 
WHERE c.Act = 4 AND c.Scene = 5 AND c.Description = 'Mytilene. A street before the brothel.';
```
-------------------------3053 sample_num
```sql
SELECT c.CharName 
FROM characters c 
JOIN paragraphs p ON c.id = p.character_id 
WHERE p.PlainText = 'This is Illyria, lady.';
```
-------------------------3054 sample_num
```sql
SELECT COUNT(DISTINCT w.id) 
FROM works w 
JOIN chapters c ON w.id = c.work_id 
JOIN paragraphs p ON c.id = p.chapter_id 
JOIN characters ch ON p.character_id = ch.id 
WHERE w.Date >= 1600 AND w.Date <= 1610 
AND ch.CharName = 'Third Servingman';
```
-------------------------3055 sample_num
```sql
SELECT Description 
FROM chapters 
WHERE work_id = (SELECT id FROM works WHERE Title = 'Venus and Adonis') 
AND Scene = (SELECT MAX(Scene) FROM chapters WHERE work_id = (SELECT id FROM works WHERE Title = 'Venus and Adonis'));
```
-------------------------3056 sample_num
```sql
SELECT COUNT(p.character_id) AS total_lines
FROM paragraphs p
JOIN chapters c ON p.chapter_id = c.id
JOIN works w ON c.work_id = w.id
JOIN characters ch ON p.character_id = ch.id
WHERE w.Title = 'Twelfth Night' AND c.Act = 1 AND c.Scene = 2 AND ch.CharName = 'Viola';
```
-------------------------3057 sample_num
```sql
SELECT p.character_id, c.work_id 
FROM paragraphs p 
JOIN chapters c ON p.chapter_id = c.id 
WHERE p.PlainText = 'Fear not thou, man, thou shalt lose nothing here.';
```
-------------------------3058 sample_num
```sql
SELECT c.Description 
FROM paragraphs p 
JOIN chapters c ON p.chapter_id = c.id 
WHERE p.PlainText = 'What, wilt thou hear some music, my sweet love?';
```
-------------------------3059 sample_num
```sql
SELECT DISTINCT c.Scene
FROM chapters c
JOIN paragraphs p ON c.id = p.chapter_id
JOIN characters ch ON p.character_id = ch.id
JOIN works w ON c.work_id = w.id
WHERE ch.CharName = 'Sir Toby Belch' AND w.Title = 'Twelfth Night';
```
-------------------------3060 sample_num
```sql
SELECT w.Title 
FROM works w
JOIN chapters c ON w.id = c.work_id
JOIN paragraphs p ON c.id = p.chapter_id
JOIN characters ch ON p.character_id = ch.id
WHERE w.Date < 1600 AND w.GenreType = 'Tragedy' AND ch.CharName = 'Tybalt';
```
-------------------------3061 sample_num
```sql
SELECT DISTINCT c.id
FROM chapters c
JOIN works w ON c.work_id = w.id
WHERE w.Date > (SELECT SUM(Date) / COUNT(Date) * 0.89 FROM works);
```
-------------------------3062 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.CharName = 'antonio' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    works w
JOIN 
    chapters ch ON w.id = ch.work_id
JOIN 
    paragraphs p ON ch.id = p.chapter_id
JOIN 
    characters c ON p.character_id = c.id
WHERE 
    w.GenreType = 'Comedy';
```
-------------------------3063 sample_num
```sql
SELECT car_name 
FROM data 
JOIN price ON data.ID = price.ID 
WHERE cylinders = 8 
ORDER BY price DESC 
LIMIT 1;
```
-------------------------3064 sample_num
```sql
SELECT COUNT(*) 
FROM data d 
JOIN price p ON d.ID = p.ID 
WHERE d.weight > 3000 AND p.price < 30000;
```
-------------------------3065 sample_num
```sql
SELECT d.acceleration 
FROM data d 
JOIN price p ON d.ID = p.ID 
WHERE p.price = (SELECT MAX(price) FROM price);
```
-------------------------3066 sample_num
```sql
SELECT p.price 
FROM price p 
JOIN data d ON p.ID = d.ID 
WHERE d.car_name = 'ford torino';
```
-------------------------3067 sample_num
```sql
SELECT c.origin 
FROM country c 
JOIN production p ON c.country = p.country 
JOIN data d ON p.ID = d.ID 
WHERE d.car_name = 'ford torino' AND p.model_year = 1970;
```
-------------------------3068 sample_num
```sql
SELECT COUNT(*) 
FROM data d 
JOIN production p ON d.ID = p.ID 
JOIN country c ON p.country = c.country 
WHERE p.model_year = 1970 AND c.origin = 'USA';
```
-------------------------3069 sample_num
```sql
SELECT d.car_name 
FROM data d 
JOIN production p ON d.ID = p.ID 
JOIN country c ON p.country = c.country 
WHERE c.origin = 'USA';
```
-------------------------3070 sample_num
```sql
SELECT car_name 
FROM data 
JOIN price ON data.ID = price.ID 
ORDER BY price DESC 
LIMIT 3;
```
-------------------------3071 sample_num
```sql
SELECT model_year 
FROM production 
JOIN data ON production.ID = data.ID 
WHERE car_name = 'chevrolet impala';
```
-------------------------3072 sample_num
```sql
SELECT COUNT(*) 
FROM data d 
JOIN price p ON d.ID = p.ID 
WHERE d.acceleration > 10 AND p.price > 20000 AND p.price < 30000;
```
-------------------------3073 sample_num
```sql
SELECT d.weight 
FROM data d 
JOIN price p ON d.ID = p.ID 
WHERE p.price > 40000;
```
-------------------------3074 sample_num
```sql
SELECT MAX(d.acceleration)
FROM data d
JOIN price p ON d.ID = p.ID
WHERE p.price > 40000;
```
-------------------------3075 sample_num
```sql
SELECT AVG(p.price) AS average_price
FROM price p
JOIN data d ON p.ID = d.ID
WHERE d.cylinders = 8;
```
-------------------------3076 sample_num
```sql
SELECT MAX(displacement / cylinders) AS max_sweep_volume
FROM data
JOIN price ON data.ID = price.ID
WHERE price.price < 30000;
```
-------------------------3077 sample_num
```sql
SELECT COUNT(*) 
FROM production p 
JOIN country c ON p.country = c.country 
WHERE c.origin = 'Europe';
```
-------------------------3078 sample_num
```sql
SELECT c.origin 
FROM country c 
JOIN production p ON c.country = p.country 
JOIN data d ON p.ID = d.ID 
WHERE d.car_name = 'chevrolet malibu';
```
-------------------------3079 sample_num
```sql
SELECT mpg 
FROM data 
WHERE ID = (SELECT ID FROM price ORDER BY price DESC LIMIT 1);
```
-------------------------3080 sample_num
```sql
SELECT c.origin 
FROM country c 
JOIN production p ON c.country = p.country 
WHERE p.ID = 382;
```
-------------------------3081 sample_num
```sql
SELECT c.origin 
FROM price p 
JOIN production pr ON p.ID = pr.ID 
JOIN country c ON pr.country = c.country 
WHERE p.price = 44274.40748;
```
-------------------------3082 sample_num
```sql
SELECT p.price 
FROM price p 
JOIN data d ON p.ID = d.ID 
WHERE d.car_name = 'volkswagen dasher' AND d.acceleration = 14.1;
```
-------------------------3083 sample_num
```sql
SELECT d.displacement 
FROM price p 
JOIN data d ON p.ID = d.ID 
WHERE p.price = 37443.85589;
```
-------------------------3084 sample_num
```sql
SELECT model_year 
FROM price 
JOIN data ON price.ID = data.ID 
JOIN production ON data.ID = production.ID 
WHERE price.price = 32650.65157;
```
-------------------------3085 sample_num
```sql
SELECT p.price 
FROM price p 
JOIN data d ON p.ID = d.ID 
WHERE d.car_name = 'toyota corona hardtop';
```
-------------------------3086 sample_num
```sql
SELECT d.cylinders 
FROM data d 
JOIN price p ON d.ID = p.ID 
WHERE p.price = (SELECT MIN(price) FROM price);
```
-------------------------3087 sample_num
```sql
SELECT d.car_name, p.price
FROM data d
JOIN price p ON d.ID = p.ID
WHERE d.weight = (SELECT MAX(weight) FROM data);
```
-------------------------3088 sample_num
```sql
SELECT c.origin 
FROM country c 
JOIN data d ON c.country = d.car_name 
WHERE d.horsepower = (SELECT MAX(horsepower) FROM data);
```
-------------------------3089 sample_num
```sql
SELECT (COUNT(CASE WHEN c.country = 'Japan' THEN 1 END) * 100.0 / COUNT(d.ID)) AS percentage_japanese_cars
FROM data d
JOIN production p ON d.ID = p.ID
JOIN country c ON p.country = c.origin;
```
-------------------------3090 sample_num
```sql
SELECT displacement / cylinders AS swept_volume
FROM price p
JOIN data d ON p.ID = d.ID
WHERE p.price = 34538.97449;
```
-------------------------3091 sample_num
```sql
SELECT car_name 
FROM data 
JOIN price ON data.ID = price.ID 
ORDER BY price DESC 
LIMIT 1;
```
-------------------------3092 sample_num
```sql
SELECT COUNT(*) 
FROM production p 
JOIN country c ON p.country = c.origin 
WHERE c.country = 'USA' AND p.model_year = 1981;
```
-------------------------3093 sample_num
```sql
SELECT p.price 
FROM price p 
JOIN data d ON p.ID = d.ID 
WHERE d.displacement / d.cylinders = (SELECT MAX(displacement / cylinders) FROM data);
```
-------------------------3094 sample_num
```sql
SELECT car_name 
FROM data 
WHERE ID = (
    SELECT ID 
    FROM data 
    JOIN production ON data.ID = production.ID 
    JOIN country ON production.country = country.country 
    WHERE country.origin = 'Japan' 
    ORDER BY horsepower DESC 
    LIMIT 1
);
```
-------------------------3095 sample_num
```sql
SELECT COUNT(*) 
FROM data 
WHERE car_name = 'ford maverick';
```
-------------------------3096 sample_num
```sql
SELECT c.country
FROM data d
JOIN production p ON d.ID = p.ID
JOIN country c ON p.country = c.origin
WHERE d.mpg = (SELECT MAX(mpg) FROM data);
```
-------------------------3097 sample_num
```sql
SELECT d.car_name 
FROM data d 
JOIN price p ON d.ID = p.ID 
WHERE d.car_name LIKE 'dodge%' 
ORDER BY p.price ASC 
LIMIT 1;
```
-------------------------3098 sample_num
```sql
SELECT d.car_name 
FROM data d 
JOIN price p ON d.ID = p.ID 
JOIN production pr ON d.ID = pr.ID 
JOIN country c ON pr.country = c.country 
WHERE c.origin = 'USA' 
ORDER BY p.price DESC 
LIMIT 1;
```
-------------------------3099 sample_num
```sql
SELECT COUNT(*) 
FROM data d 
JOIN price p ON d.ID = p.ID 
WHERE d.displacement > 400 AND p.price > 30000;
```
-------------------------3100 sample_num
```sql
SELECT model_year, COUNT(*) AS car_count
FROM production
JOIN country ON production.country = country.country
WHERE country.origin = 'Europe'
GROUP BY model_year
ORDER BY car_count DESC
LIMIT 1;
```
-------------------------3101 sample_num
```sql
SELECT p.price 
FROM price p 
JOIN data d ON p.ID = d.ID 
WHERE d.car_name = 'peugeot 505s turbo diesel';
```
-------------------------3102 sample_num
```sql
SELECT d.acceleration 
FROM data d 
JOIN price p ON d.ID = p.ID 
JOIN production pr ON d.ID = pr.ID 
JOIN country c ON pr.country = c.country 
WHERE c.origin = 'USA' 
AND p.price = (SELECT MIN(price) FROM price p2 
               JOIN production pr2 ON p2.ID = pr2.ID 
               JOIN country c2 ON pr2.country = c2.country 
               WHERE c2.origin = 'USA');
```
-------------------------3103 sample_num
```sql
SELECT c.country, COUNT(p.ID) AS total_cars, 
       COUNT(p.ID) / COUNT(DISTINCT pr.model_year) AS annual_average
FROM production pr
JOIN country c ON pr.country = c.origin
JOIN data p ON pr.ID = p.ID
GROUP BY c.country
ORDER BY total_cars DESC
LIMIT 1;
```
-------------------------3104 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.country = 'Japan' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    data d
JOIN 
    production p ON d.ID = p.ID
JOIN 
    country c ON p.country = c.origin
WHERE 
    (d.displacement / d.cylinders) > 30;
```
-------------------------3105 sample_num
```sql
SELECT car_name 
FROM data 
JOIN production ON data.ID = production.ID 
WHERE model_year = 1975;
```
-------------------------3106 sample_num
```sql
SELECT AVG(p.price) AS average_price
FROM price p
JOIN production pr ON p.ID = pr.ID
JOIN country c ON pr.country = c.country
WHERE c.origin = 'Europe';
```
-------------------------3107 sample_num
```sql
SELECT price FROM price WHERE ID = 15;
```
-------------------------3108 sample_num
```sql
SELECT COUNT(*) 
FROM data d 
JOIN production p ON d.ID = p.ID 
JOIN country c ON p.country = c.country 
WHERE c.origin = 'Japan' AND d.weight < 3000;
```
-------------------------3109 sample_num
```sql
SELECT COUNT(*) 
FROM data 
JOIN production ON data.ID = production.ID 
WHERE production.model_year = 1973 AND data.horsepower < 100;
```
-------------------------3110 sample_num
```sql
SELECT d.ID 
FROM data d 
JOIN price p ON d.ID = p.ID 
JOIN production pr ON d.ID = pr.ID 
JOIN country c ON pr.country = c.origin 
WHERE c.country = 'Japan' AND p.price > 35000 AND d.acceleration = 14;
```
-------------------------3111 sample_num
```sql
SELECT p.model_year 
FROM production p 
JOIN data d ON p.ID = d.ID 
WHERE d.weight = (SELECT MAX(weight) FROM data);
```
-------------------------3112 sample_num
```sql
SELECT d.horsepower, p.model_year 
FROM data d 
JOIN production p ON d.ID = p.ID 
WHERE d.car_name = 'subaru dl';
```
-------------------------3113 sample_num
```sql
SELECT d.car_name 
FROM data d 
JOIN production p ON d.ID = p.ID 
JOIN country c ON p.country = c.country 
JOIN price pr ON d.ID = pr.ID 
WHERE c.origin = 'Japan' 
ORDER BY pr.price DESC 
LIMIT 1;
```
-------------------------3114 sample_num
```sql
SELECT d.car_name 
FROM data d 
JOIN price p ON d.ID = p.ID 
WHERE p.price = 20000;
```
-------------------------3115 sample_num
```sql
SELECT COUNT(*) 
FROM price p 
JOIN production pr ON p.ID = pr.ID 
JOIN country c ON pr.country = c.country 
WHERE p.price > 40000 AND c.origin = 'USA';
```
-------------------------3116 sample_num
```sql
SELECT p.price, c.origin 
FROM price p 
JOIN data d ON p.ID = d.ID 
JOIN production pr ON d.ID = pr.ID 
JOIN country c ON pr.country = c.country 
WHERE d.car_name = 'Ford Maverick';
```
-------------------------3117 sample_num
```sql
SELECT d.car_name 
FROM data d 
JOIN price p ON d.ID = p.ID 
WHERE p.price > (SELECT AVG(price) * 0.85 FROM price);
```
-------------------------3118 sample_num
```sql
SELECT 
    (SELECT COUNT(ID) FROM data WHERE horsepower = 130 AND ID IN (SELECT ID FROM production WHERE model_year = 1970)) -
    (SELECT COUNT(ID) FROM data WHERE horsepower = 130 AND ID IN (SELECT ID FROM production WHERE model_year = 1976)) AS difference;
```
-------------------------3119 sample_num
```sql
SELECT d.ID 
FROM data d 
JOIN production p ON d.ID = p.ID 
JOIN country c ON p.country = c.country 
WHERE c.origin = 'Asia' AND p.model_year = 1979;
```
-------------------------3120 sample_num
```sql
SELECT c.country
FROM country c
JOIN production p ON c.origin = p.country
JOIN data d ON p.ID = d.ID
WHERE d.mpg = (SELECT MIN(mpg) FROM data);
```
-------------------------3121 sample_num
```sql
SELECT car_name, model, displacement / cylinders AS sweep_volume, model_year AS introduced_year
FROM data
JOIN production ON data.ID = production.ID
WHERE weight = (SELECT MAX(weight) FROM data);
```
-------------------------3122 sample_num
```sql
SELECT d.car_name, d.horsepower
FROM data d
JOIN production p ON d.ID = p.ID
JOIN country c ON p.country = c.country
WHERE p.model_year = 1977 AND c.origin = 'Europe';
```
-------------------------3123 sample_num
```sql
SELECT d.car_name, d.model
FROM data d
JOIN price p ON d.ID = p.ID
WHERE p.price = (SELECT MAX(price) FROM price);
```
-------------------------3124 sample_num
```sql
SELECT p.price 
FROM price p 
JOIN data d ON p.ID = d.ID 
WHERE d.car_name = 'chevrolet bel air';
```
-------------------------3125 sample_num
```sql
SELECT AVG(p.price) AS average_price
FROM price p
JOIN production pr ON p.ID = pr.ID
JOIN country c ON pr.country = c.country
WHERE c.origin = 'Japan';
```
-------------------------3126 sample_num
```sql
SELECT c.country 
FROM country c
JOIN production p ON c.origin = p.country
JOIN price pr ON p.ID = pr.ID
WHERE pr.price = (SELECT MIN(price) FROM price);
```
-------------------------3127 sample_num
```sql
SELECT d.ID, d.car_name, c.country
FROM data d
JOIN production p ON d.ID = p.ID
JOIN country c ON p.country = c.origin
WHERE p.model_year = 1975 AND d.cylinders = (
    SELECT MAX(cylinders)
    FROM data d2
    JOIN production p2 ON d2.ID = p2.ID
    WHERE p2.model_year = 1975
);
```
-------------------------3128 sample_num
```sql
SELECT d.car_name, d.acceleration, d.cylinders, p.model_year
FROM price p
JOIN data d ON p.ID = d.ID
JOIN production pr ON d.ID = pr.ID
WHERE p.price = (SELECT MIN(price) FROM price);
```
-------------------------3129 sample_num
```sql
SELECT d.car_name, p.price
FROM data d
JOIN price p ON d.ID = p.ID
WHERE d.model = 82 AND d.mpg > 30;
```
-------------------------3130 sample_num
```sql
SELECT COUNT(*) 
FROM data 
WHERE car_name = 'ford maverick';
```
-------------------------3131 sample_num
```sql
SELECT (COUNT(CASE WHEN c.country = 'USA' THEN 1 END) * 100.0 / COUNT(d.ID)) AS percentage_usa
FROM data d
JOIN production p ON d.ID = p.ID
JOIN country c ON p.country = c.origin;
```
-------------------------3132 sample_num
```sql
SELECT AVG(car_count) AS average_production_rate, GROUP_CONCAT(car_name) AS cars
FROM (
    SELECT COUNT(ID) AS car_count, model_year
    FROM production
    WHERE model_year BETWEEN 1971 AND 1980
    GROUP BY model_year
) AS yearly_counts,
data
WHERE weight < 1800;
```
-------------------------3133 sample_num
```sql
SELECT AVG(p.price) AS average_price
FROM price p
JOIN data d ON p.ID = d.ID
WHERE d.model = 70;
```
-------------------------3134 sample_num
```sql
SELECT p.price 
FROM price p 
JOIN data d ON p.ID = d.ID 
WHERE d.car_name = 'chevrolet vega 2300';
```
-------------------------3135 sample_num
```sql
SELECT c.country 
FROM country c 
JOIN production p ON c.origin = p.country 
JOIN data d ON p.ID = d.ID 
WHERE d.car_name = 'chevy c20';
```
-------------------------3136 sample_num
```sql
SELECT p.price 
FROM price p 
JOIN data d ON p.ID = d.ID 
JOIN production pr ON d.ID = pr.ID 
WHERE d.car_name LIKE 'ford%' 
AND pr.model_year BETWEEN 1970 AND 1980;
```
-------------------------3137 sample_num
```sql
SELECT car_name, mpg 
FROM data 
JOIN production ON data.ID = production.ID 
WHERE model_year = 1975 
ORDER BY mpg DESC 
LIMIT 1;
```
-------------------------3138 sample_num
```sql
SELECT d.car_name, d.mpg, p.price
FROM data d
JOIN price p ON d.ID = p.ID
WHERE d.mpg = (SELECT MIN(mpg) FROM data)
AND p.price = (SELECT MAX(price) FROM price);
```
-------------------------3139 sample_num
```sql
SELECT COUNT(*) 
FROM data d 
JOIN production p ON d.ID = p.ID 
JOIN country c ON p.country = c.country 
WHERE c.origin = 'USA' AND d.acceleration < 12;
```
-------------------------3140 sample_num
```sql
SELECT COUNT(*) 
FROM data d 
JOIN production p ON d.ID = p.ID 
JOIN country c ON p.country = c.country 
WHERE c.origin = 'Japan' AND d.weight > 2000;
```
-------------------------3141 sample_num
```sql
SELECT car_name 
FROM data 
JOIN price ON data.ID = price.ID 
WHERE price.price = (SELECT MAX(price) FROM price);
```
-------------------------3142 sample_num
```sql
SELECT model_year 
FROM production 
JOIN data ON production.ID = data.ID 
WHERE car_name = 'buick skylark 320';
```
-------------------------3143 sample_num
```sql
SELECT c.country
FROM country c
JOIN production p ON c.origin = p.country
JOIN price pr ON p.ID = pr.ID
WHERE p.model_year = 1970
ORDER BY pr.price DESC
LIMIT 1;
```
-------------------------3144 sample_num
```sql
SELECT COUNT(*) 
FROM data 
JOIN production ON data.ID = production.ID 
WHERE data.horsepower > 200 AND production.model_year = 1975;
```
-------------------------3145 sample_num
```sql
SELECT (COUNT(CASE WHEN c.country = 'USA' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_american_cars
FROM data d
JOIN production p ON d.ID = p.ID
JOIN country c ON p.country = c.origin;
```
-------------------------3146 sample_num
```sql
SELECT AVG(d.weight) 
FROM data d 
JOIN production p ON d.ID = p.ID 
JOIN country c ON p.country = c.country 
WHERE c.origin = 'Japan' AND d.cylinders = 4 AND p.model_year BETWEEN 1975 AND 1980;
```
-------------------------3147 sample_num
```sql
SELECT SUM(donation_total) AS total_donations_2012
FROM donations
WHERE donation_timestamp LIKE '2012%';
```
-------------------------3148 sample_num
```sql
SELECT donation_timestamp, MAX(donation_total) AS highest_amount
FROM donations
GROUP BY donation_timestamp
ORDER BY highest_amount DESC
LIMIT 1;
```
-------------------------3149 sample_num
```sql
SELECT SUM(donation_total) AS total_donations
FROM donations
WHERE donation_timestamp LIKE '2011%'
  AND for_honoree = 't'
  AND via_giving_page = 't';
```
-------------------------3150 sample_num
```sql
SELECT donor_acctid, 
       (donation_optional_support / donation_total) * 100 AS percentage_optional_support
FROM donations
WHERE is_teacher_acct = 'f';
```
-------------------------3151 sample_num
```sql
SELECT e.title 
FROM essays e 
JOIN projects p ON e.projectid = p.projectid 
WHERE p.primary_focus_subject = 'Literacy';
```
-------------------------3152 sample_num
```sql
SELECT e.title 
FROM essays e 
JOIN projects p ON e.projectid = p.projectid 
WHERE p.poverty_level = 'highest poverty';
```
-------------------------3153 sample_num
```sql
SELECT p.primary_focus_subject, 
       (SELECT GROUP_CONCAT(p2.title) 
        FROM projects p2 
        WHERE p2.primary_focus_subject = p.primary_focus_subject 
          AND p2.projectid != p.projectid) AS similar_projects
FROM projects p
JOIN essays e ON p.projectid = e.projectid
WHERE e.title = 'Toot Your Flute!';
```
-------------------------3154 sample_num
```sql
SELECT e.title 
FROM essays e 
JOIN projects p ON e.projectid = p.projectid 
WHERE p.teacher_prefix = 'Dr.';
```
-------------------------3155 sample_num
```sql
SELECT title, total_price_excluding_optional_support 
FROM projects 
WHERE students_reached = 320;
```
-------------------------3156 sample_num
```sql
SELECT donations.donation_message, essays.title
FROM donations
JOIN essays ON donations.projectid = essays.projectid
WHERE donations.donor_city = 'Texas City';
```
-------------------------3157 sample_num
```sql
SELECT r.vendor_name, r.item_name, r.item_unit_price
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE p.projectid = (SELECT projectid FROM essays WHERE title = 'Lights, Camera, Action!');
```
-------------------------3158 sample_num
```sql
SELECT SUM(donation_to_project) AS total_donations
FROM donations
JOIN projects ON donations.projectid = projects.projectid
WHERE projects.title = 'Whistle While We Work!';
```
-------------------------3159 sample_num
```sql
SELECT p.title AS project_name, p.short_description AS describe
FROM projects p
WHERE p.teacher_ny_teaching_fellow = 't';
```
-------------------------3160 sample_num
```sql
SELECT p.title, p.total_price_excluding_optional_support
FROM projects p
WHERE p.students_reached >= 600 AND p.poverty_level = 'moderate poverty';
```
-------------------------3161 sample_num
```sql
SELECT 
    (SUM(donation_total) / NULLIF(SUM(CASE WHEN p.school_metro = 'rural' THEN donation_total END), 0)) * 100 AS rural_donation_percentage
FROM 
    donations d
JOIN 
    projects p ON d.projectid = p.projectid;
```
-------------------------3162 sample_num
```sql
SELECT 
    e.title AS project_name,
    COALESCE(SUM(d.donation_to_project), 0) AS amount_collected,
    (total_price_excluding_optional_support - COALESCE(SUM(d.donation_to_project), 0)) / total_price_excluding_optional_support * 100 AS percentage_lacking
FROM 
    projects p
JOIN 
    essays e ON p.projectid = e.projectid
LEFT JOIN 
    donations d ON p.projectid = d.projectid
WHERE 
    p.total_price_excluding_optional_support = (SELECT MAX(total_price_excluding_optional_support) FROM projects)
GROUP BY 
    e.title, p.total_price_excluding_optional_support;
```
-------------------------3163 sample_num
```sql
SELECT COUNT(DISTINCT schoolid) 
FROM projects 
WHERE school_district = 'West New York School District' 
AND poverty_level = 'highest poverty';
```
-------------------------3164 sample_num
```sql
SELECT COUNT(*) 
FROM donations 
WHERE is_teacher_acct = 't' AND donor_state = 'CO-Colorado';
```
-------------------------3165 sample_num
```sql
SELECT projectid 
FROM projects 
ORDER BY total_price_including_optional_support DESC 
LIMIT 1;
```
-------------------------3166 sample_num
```sql
SELECT donor_state
FROM donations
WHERE payment_method = 'paypal'
  AND for_honoree = 't'
  AND payment_included_campaign_gift_card = 't'
GROUP BY donor_state
ORDER BY COUNT(donor_state) DESC
LIMIT 1;
```
-------------------------3167 sample_num
```sql
SELECT donationid, donation_total 
FROM donations 
WHERE donation_total = (SELECT MAX(donation_total) FROM donations);
```
-------------------------3168 sample_num
```sql
SELECT p.projectid, r.item_name
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE (p.total_price_including_optional_support - p.total_price_excluding_optional_support) = (
    SELECT MAX(total_price_including_optional_support - total_price_excluding_optional_support)
    FROM projects
);
```
-------------------------3169 sample_num
```sql
SELECT r.item_name, r.item_quantity, 
       CASE WHEN e.teacher_prefix = 'Dr. ' THEN 'Yes' ELSE 'No' END AS has_phd
FROM resources r
JOIN projects p ON r.projectid = p.projectid
JOIN essays e ON p.projectid = e.projectid
WHERE p.projectid = 'd6ef27c07c30c81f0c16c32b6acfa2ff';
```
-------------------------3170 sample_num
```sql
SELECT SUM(p.total_price_including_optional_support) AS total_price
FROM essays e
JOIN projects p ON e.projectid = p.projectid
WHERE e.title = 'Recording Rockin'' Readers';
```
-------------------------3171 sample_num
```sql
SELECT p.school_latitude, p.school_longitude 
FROM essays e 
JOIN projects p ON e.projectid = p.projectid 
WHERE e.title = 'Smile for the Camera!!!';
```
-------------------------3172 sample_num
```sql
SELECT SUM(d.donation_total) AS total_donations, e.title
FROM donations d
JOIN essays e ON d.projectid = e.projectid
WHERE d.donation_total = (SELECT MAX(donation_total) FROM donations)
GROUP BY e.title;
```
-------------------------3173 sample_num
```sql
SELECT d.donor_acctid, r.project_resource_type, COUNT(*) AS project_count
FROM donations d
JOIN resources r ON d.projectid = r.projectid
WHERE d.donation_total IN (
    SELECT DISTINCT donation_total
    FROM donations
    ORDER BY donation_total DESC
    LIMIT 10
)
GROUP BY d.donor_acctid, r.project_resource_type
ORDER BY d.donor_acctid, project_count DESC;
```
-------------------------3174 sample_num
```sql
SELECT p.projectid, p.date_posted, r.item_name
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE p.date_posted = (SELECT MIN(date_posted) FROM projects)
ORDER BY p.projectid;
```
-------------------------3175 sample_num
```sql
SELECT DISTINCT r.vendor_name 
FROM resources r 
JOIN projects p ON r.projectid = p.projectid 
WHERE p.projectid IN (SELECT projectid FROM essays WHERE title = 'iMath');
```
-------------------------3176 sample_num
```sql
SELECT p.date_posted, p.grade_level
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE r.item_quantity = (SELECT MAX(item_quantity) FROM resources)
```
-------------------------3177 sample_num
```sql
SELECT AVG(donation_total) AS average_donation
FROM donations
WHERE projectid IN (
    SELECT projectid
    FROM essays
    WHERE title = 'Recording Rockin'' Readers'
);
```
-------------------------3178 sample_num
```sql
SELECT 
    e.title AS essay_title,
    d.donor_acctid AS biggest_donor,
    (d.donation_to_project / p.total_price_excluding_optional_support) * 100 AS donation_percentage
FROM 
    projects p
JOIN 
    essays e ON p.projectid = e.projectid
JOIN 
    donations d ON p.projectid = d.projectid
WHERE 
    p.total_price_excluding_optional_support = (SELECT MAX(total_price_excluding_optional_support) FROM projects)
ORDER BY 
    d.donation_total DESC
LIMIT 1;
```
-------------------------3179 sample_num
```sql
SELECT d.donor_acctid, p.school_state, AVG(d.donation_optional_support) AS avg_optional_support, 
       r.project_resource_type, MAX(d.donation_optional_support) AS max_optional_support
FROM donations d
JOIN projects p ON d.projectid = p.projectid
JOIN resources r ON d.projectid = r.projectid
GROUP BY d.donor_acctid, p.school_state, r.project_resource_type
ORDER BY max_optional_support DESC
LIMIT 5;
```
-------------------------3180 sample_num
```sql
SELECT p.projectid, r.item_name
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE p.school_city = 'Brooklyn'
GROUP BY p.projectid, r.item_name
HAVING COUNT(r.item_name) = (
    SELECT MAX(resource_count)
    FROM (
        SELECT COUNT(item_name) AS resource_count
        FROM resources
        JOIN projects ON resources.projectid = projects.projectid
        WHERE projects.school_city = 'Brooklyn'
        GROUP BY resources.projectid
    ) AS counts
);
```
-------------------------3181 sample_num
```sql
SELECT COUNT(DISTINCT p.schoolid) AS urban_school_count
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE p.school_metro = 'urban' AND r.project_resource_type = 'Books';
```
-------------------------3182 sample_num
```sql
SELECT schoolid
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE r.vendor_name = 'Amazon'
GROUP BY schoolid
ORDER BY COUNT(r.resourceid) DESC
LIMIT 1;
```
-------------------------3183 sample_num
```sql
SELECT COUNT(DISTINCT d.donor_acctid) AS donor_count
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE d.donor_city = 'Los Angeles' AND p.school_city != 'Los Angeles';
```
-------------------------3184 sample_num
```sql
SELECT p.teacher_prefix 
FROM projects p 
WHERE p.projectid = (SELECT e.projectid FROM essays e WHERE e.title = 'Reading About Other Cultures');
```
-------------------------3185 sample_num
```sql
SELECT students_reached 
FROM projects 
WHERE title = 'Fit Firsties!';
```
-------------------------3186 sample_num
```sql
SELECT p.title, d.donor_acctid
FROM projects p
JOIN donations d ON p.projectid = d.projectid
WHERE p.school_city = 'Chicago';
```
-------------------------3187 sample_num
```sql
SELECT e.title
FROM essays e
JOIN projects p ON e.projectid = p.projectid
WHERE p.teacher_prefix = 'Dr.' AND p.students_reached > 300;
```
-------------------------3188 sample_num
```sql
SELECT DISTINCT vendor_name 
FROM resources r 
JOIN projects p ON r.projectid = p.projectid 
WHERE p.primary_focus_subject = 'Literacy' 
AND r.project_resource_type = 'book';
```
-------------------------3189 sample_num
```sql
SELECT p.title
FROM projects p
JOIN resources r ON p.projectid = r.projectid
GROUP BY p.projectid, p.title
ORDER BY MAX(r.item_unit_price * r.item_quantity) DESC
LIMIT 1;
```
-------------------------3190 sample_num
```sql
SELECT COUNT(DISTINCT donor_acctid) 
FROM donations 
WHERE donor_city = 'New York' AND is_teacher_acct = 't';
```
-------------------------3191 sample_num
```sql
SELECT COUNT(*) 
FROM donations 
WHERE donor_state = 'NJ' AND for_honoree = 't';
```
-------------------------3192 sample_num
```sql
SELECT donation_message FROM donations WHERE donationid = 'a84dace1ff716f6f0c7af8ef9090a5d5';
```
-------------------------3193 sample_num
```sql
SELECT DISTINCT project_resource_type 
FROM resources 
WHERE vendor_name = 'Lakeshore Learning Materials';
```
-------------------------3194 sample_num
```sql
SELECT item_name 
FROM resources 
WHERE vendor_name = 'Lakeshore Learning Materials' 
ORDER BY item_quantity DESC 
LIMIT 1;
```
-------------------------3195 sample_num
```sql
SELECT COUNT(DISTINCT p.projectid) AS project_count
FROM projects p
JOIN donations d ON p.projectid = d.projectid
WHERE p.teacher_state = 'NY' 
  AND p.teacher_ny_teaching_fellow = 't' 
  AND d.donor_city = 'New York';
```
-------------------------3196 sample_num
```sql
SELECT COUNT(DISTINCT p.projectid) 
FROM projects p 
JOIN resources r ON p.projectid = r.projectid 
WHERE r.vendor_name = 'Lakeshore Learning Materials' 
AND p.teacher_prefix = 'Dr.';
```
-------------------------3197 sample_num
```sql
SELECT DISTINCT r.vendor_name
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE p.poverty_level = 'highest poverty';
```
-------------------------3198 sample_num
```sql
SELECT p.schoolid
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE r.vendor_name = 'Lakeshore Learning Materials'
GROUP BY p.schoolid
ORDER BY MAX(p.fulfillment_labor_materials) DESC
LIMIT 1;
```
-------------------------3199 sample_num
```sql
SELECT r.vendor_name
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE p.total_price_including_optional_support - p.total_price_excluding_optional_support = (
    SELECT MAX(total_price_including_optional_support - total_price_excluding_optional_support)
    FROM projects
);
```
-------------------------3200 sample_num
```sql
SELECT SUM(donation_total) AS total_donated_amount
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE p.school_city = 'Brooklyn';
```
-------------------------3201 sample_num
```sql
SELECT d.donation_message
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE p.school_city = 'Brooklyn' AND p.school_magnet = 't';
```
-------------------------3202 sample_num
```sql
SELECT COUNT(*) 
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE d.payment_included_acct_credit = 't' 
AND p.school_year_round = 't';
```
-------------------------3203 sample_num
```sql
SELECT SUM(d.dollar_amount) AS total_donation_amount
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE p.primary_focus_area = 'Literacy & Language';
```
-------------------------3204 sample_num
```sql
SELECT d.donor_acctid
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE p.primary_focus_area = 'Literacy & Language'
GROUP BY d.donor_acctid
ORDER BY SUM(d.donation_total) DESC
LIMIT 1;
```
-------------------------3205 sample_num
```sql
SELECT item_name, SUM(item_quantity) AS total_requested
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE p.primary_focus_area = 'Literacy & Language' 
  AND r.project_resource_type = 'Supplies'
GROUP BY item_name
ORDER BY total_requested DESC
LIMIT 1;
```
-------------------------3206 sample_num
```sql
SELECT item_name, MAX(item_unit_price) AS highest_unit_price
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE p.primary_focus_area = 'Literacy & Language'
GROUP BY item_name
ORDER BY highest_unit_price DESC
LIMIT 1;
```
-------------------------3207 sample_num
```sql
SELECT AVG(d.donation_total) AS average_donation
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE p.school_city = 'Brooklyn';
```
-------------------------3208 sample_num
```sql
SELECT donor_city 
FROM donations 
WHERE donor_acctid = '22cbc920c9b5fa08dfb331422f5926b5';
```
-------------------------3209 sample_num
```sql
SELECT is_teacher_acct 
FROM donations 
WHERE donor_acctid = '22cbc920c9b5fa08dfb331422f5926b5';
```
-------------------------3210 sample_num
```sql
SELECT CASE 
           WHEN EXISTS (SELECT 1 
                        FROM projects 
                        WHERE teacher_acctid = '42d43fa6f37314365d08692e08680973' 
                          AND (teacher_prefix LIKE '%Dr%' OR teacher_prefix LIKE '%Ph.D%')) 
           THEN 'Yes' 
           ELSE 'No' 
       END AS has_phd_or_doctor_degree;
```
-------------------------3211 sample_num
```sql
SELECT COUNT(*) > 0 AS is_ny_teacher
FROM projects
WHERE teacher_acctid = '42d43fa6f37314365d08692e08680973' AND school_state = 'NY';
```
-------------------------3212 sample_num
```sql
SELECT DISTINCT e.title
FROM essays e
JOIN projects p ON e.projectid = p.projectid
JOIN donations d ON p.projectid = d.projectid
WHERE p.school_city = 'Abington';
```
-------------------------3213 sample_num
```sql
SELECT r.item_name 
FROM resources r 
JOIN projects p ON r.projectid = p.projectid 
WHERE p.teacher_acctid = '822b7b8768c17456fdce78b65abcc18e';
```
-------------------------3214 sample_num
```sql
SELECT COUNT(DISTINCT p.schoolid) AS public_magnet_schools
FROM projects p
JOIN donations d ON p.projectid = d.projectid
WHERE d.payment_included_acct_credit = 'f' AND p.school_magnet = 't';
```
-------------------------3215 sample_num
```sql
SELECT r.project_resource_type 
FROM donations d 
JOIN resources r ON d.projectid = r.projectid 
WHERE d.donationid = 'b39547f29dfc25fb13c6e9e8d940dc43';
```
-------------------------3216 sample_num
```sql
SELECT 
    (COUNT(DISTINCT p.schoolid) FILTER (WHERE r.project_resource_type = 'Books') * 100.0 / COUNT(DISTINCT p.schoolid)) AS percentage
FROM 
    projects p
JOIN 
    resources r ON p.projectid = r.projectid
WHERE 
    p.school_magnet = 't';
```
-------------------------3217 sample_num
```sql
SELECT COUNT(DISTINCT p.schoolid) AS public_magnet_schools
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE r.vendor_name = 'ABC School Supply' AND p.school_magnet = 't';
```
-------------------------3218 sample_num
```sql
SELECT COUNT(DISTINCT p.schoolid) AS highest_poverty_schools
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE d.donor_acctid = '000eebf28658900e63b538cf8a73afbd' 
AND p.poverty_level = 'highest poverty';
```
-------------------------3219 sample_num
```sql
SELECT e.short_description 
FROM essays e 
JOIN projects p ON e.projectid = p.projectid 
JOIN donations d ON p.projectid = d.projectid 
WHERE p.schoolid = '301c9bf0a45d159d162b65a93fddd74e';
```
-------------------------3220 sample_num
```sql
SELECT p.school_city 
FROM projects p 
JOIN essays e ON p.projectid = e.projectid 
WHERE e.title = 'iMath';
```
-------------------------3221 sample_num
```sql
SELECT d.payment_method 
FROM donations d 
JOIN projects p ON d.projectid = p.projectid 
WHERE p.teacher_acctid = '822b7b8768c17456fdce78b65abcc18e';
```
-------------------------3222 sample_num
```sql
SELECT SUM(donation_total) AS total_donated
FROM donations
WHERE projectid IN (
    SELECT projectid
    FROM projects
    WHERE teacher_acctid = '822b7b8768c17456fdce78b65abcc18e'
);
```
-------------------------3223 sample_num
```sql
SELECT DISTINCT d.is_teacher_acct
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE p.schoolid = 'd4af834b1d3fc8061e1ee1b3f1a77b85';
```
-------------------------3224 sample_num
```sql
SELECT (COUNT(CASE WHEN p.school_city = 'Brooklyn' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_brooklyn
FROM projects p
JOIN donations d ON p.projectid = d.projectid
WHERE d.is_teacher_acct = 't';
```
-------------------------3225 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.students_reached > 30 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    projects p
JOIN 
    donations d ON p.projectid = d.projectid
WHERE 
    d.is_teacher_acct = 't';
```
-------------------------3226 sample_num
```sql
SELECT COUNT(DISTINCT schoolid) 
FROM projects 
WHERE school_city = 'Bethlehem' AND school_metro = 'suburban';
```
-------------------------3227 sample_num
```sql
SELECT COUNT(*) 
FROM projects 
WHERE school_city = 'Los Angeles' AND school_year_round = 't';
```
-------------------------3228 sample_num
```sql
SELECT COUNT(*) 
FROM projects 
WHERE school_magnet = 't' 
AND school_city = 'Manhattan' 
AND school_state = 'New York';
```
-------------------------3229 sample_num
```sql
SELECT COUNT(DISTINCT teacher_acctid) 
FROM projects 
WHERE school_city = 'Twin Falls' 
AND primary_focus_area = 'Math & Science';
```
-------------------------3230 sample_num
```sql
SELECT COUNT(DISTINCT teacher_acctid) 
FROM projects 
WHERE primary_focus_subject = 'Literature & Writing' 
AND teacher_prefix = 'Mr';
```
-------------------------3231 sample_num
```sql
SELECT COUNT(*) AS total_projects
FROM projects
WHERE grade_level = 'Grades 3-5' AND school_district = 'Boston Public School District';
```
-------------------------3232 sample_num
```sql
SELECT p.school_city 
FROM projects p 
JOIN essays e ON p.projectid = e.projectid 
WHERE e.title = 'ABC Read';
```
-------------------------3233 sample_num
```sql
SELECT teacher_prefix 
FROM projects 
WHERE projectid IN (
    SELECT projectid 
    FROM essays 
    WHERE title = 'Creating Memories and Inspiring Dreams'
);
```
-------------------------3234 sample_num
```sql
SELECT d.is_teacher_acct
FROM donations d
JOIN projects p ON d.projectid = p.projectid
JOIN essays e ON p.projectid = e.projectid
WHERE e.title = 'Calculate, Financial Security For Tomorrow Starts Today!';
```
-------------------------3235 sample_num
```sql
SELECT e.title 
FROM essays e 
JOIN donations d ON e.projectid = d.projectid 
WHERE d.donation_message = 'Donation on behalf of Matt Carpenter because I''m a strong believer in education';
```
-------------------------3236 sample_num
```sql
SELECT COUNT(*) AS number_of_donations
FROM donations
WHERE projectid IN (
    SELECT projectid
    FROM essays
    WHERE title = 'A Rug For Reaching Readers'
);
```
-------------------------3237 sample_num
```sql
SELECT SUM(donation_to_project + donation_optional_support) AS total_donation_amount
FROM donations
JOIN essays ON donations.projectid = essays.projectid
WHERE essays.title = 'Engaging Young Readers with a Leveled Classroom Library';
```
-------------------------3238 sample_num
```sql
SELECT d.donation_optional_support 
FROM donations d 
JOIN projects p ON d.projectid = p.projectid 
JOIN essays e ON p.projectid = e.projectid 
WHERE e.title = 'Armenian Genocide';
```
-------------------------3239 sample_num
```sql
SELECT e.short_description 
FROM donations d 
JOIN projects p ON d.projectid = p.projectid 
JOIN essays e ON p.projectid = e.projectid 
WHERE d.donation_timestamp = '2012/9/6 14:44:29';
```
-------------------------3240 sample_num
```sql
SELECT d.donationid, d.donation_total, d.donation_optional_support
FROM donations d
JOIN projects p ON d.projectid = p.projectid
JOIN essays e ON p.projectid = e.projectid
WHERE e.title = 'I Can''t See It...Can You Help Me???';
```
-------------------------3241 sample_num
```sql
SELECT p.teacher_acctid 
FROM donations d 
JOIN projects p ON d.projectid = p.projectid 
WHERE d.donation_timestamp = '2008/7/29 11:38:43';
```
-------------------------3242 sample_num
```sql
SELECT schoolid 
FROM projects 
WHERE projectid IN (
    SELECT projectid 
    FROM essays 
    WHERE title = 'Virtual Aquarium Needs Help!'
);
```
-------------------------3243 sample_num
```sql
SELECT e.title
FROM essays e
JOIN donations d ON e.projectid = d.projectid
WHERE d.donation_total = (SELECT MAX(donation_total) FROM donations);
```
-------------------------3244 sample_num
```sql
SELECT (donation_optional_support / donation_total) * 100 AS tip_percentage
FROM donations
JOIN essays ON donations.projectid = essays.projectid
WHERE essays.title = 'Awesome Audiobooks Make Avid Readers';
```
-------------------------3245 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN payment_method = 'creditcard' THEN 1 END) * 100.0 / COUNT(projectid)) AS percentage_credit_card
FROM 
    donations d
JOIN 
    projects p ON d.projectid = p.projectid
JOIN 
    essays e ON p.projectid = e.projectid
WHERE 
    e.title = 'Bringing Drama to Life';
```
-------------------------3246 sample_num
```sql
SELECT short_description 
FROM essays 
WHERE title = 'Future Einsteins Of America';
```
-------------------------3247 sample_num
```sql
SELECT need_statement 
FROM essays 
WHERE title = 'Family History Project';
```
-------------------------3248 sample_num
```sql
SELECT COUNT(DISTINCT school_metro) 
FROM projects 
WHERE school_district = 'Livingston Parish School District' 
AND school_metro = 'suburban';
```
-------------------------3249 sample_num
```sql
SELECT DISTINCT vendor_name 
FROM resources 
WHERE item_name = 'Classroom Keepers Management Center';
```
-------------------------3250 sample_num
```sql
SELECT DISTINCT project_resource_type 
FROM resources 
WHERE vendor_name = 'Sax Arts & Crafts';
```
-------------------------3251 sample_num
```sql
SELECT school_county, COUNT(*) AS low_poverty_count
FROM projects
WHERE school_state = 'NY' AND poverty_level = 'low poverty'
GROUP BY school_county
ORDER BY low_poverty_count DESC
LIMIT 1;
```
-------------------------3252 sample_num
```sql
SELECT school_district 
FROM projects 
WHERE projectid IN (SELECT projectid FROM essays WHERE title = 'Future Einsteins Of America');
```
-------------------------3253 sample_num
```sql
SELECT d.payment_method 
FROM donations d 
JOIN projects p ON d.projectid = p.projectid 
WHERE p.title = 'Needed Resource Materials For My Students';
```
-------------------------3254 sample_num
```sql
SELECT COUNT(*) 
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE d.payment_method = 'creditcard' 
AND p.school_district = 'Memphis City School District';
```
-------------------------3255 sample_num
```sql
SELECT DISTINCT p.school_district
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE r.vendor_name = 'Barnes and Noble';
```
-------------------------3256 sample_num
```sql
SELECT p.school_latitude, p.school_longitude
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE r.vendor_name = 'Benchmark Education' AND r.item_name = 'R & A Plant Genetics';
```
-------------------------3257 sample_num
```sql
SELECT payment_method, COUNT(*) AS payment_count
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE p.school_state = 'GA'
GROUP BY payment_method
ORDER BY payment_count DESC
LIMIT 1;
```
-------------------------3258 sample_num
```sql
SELECT p.school_latitude, p.school_longitude, p.resource_type
FROM projects p
JOIN essays e ON p.projectid = e.projectid
WHERE e.title = 'Look, Look, We Need a Nook!';
```
-------------------------3259 sample_num
```sql
SELECT d.donation_message
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE p.school_district = 'Newark School District'
AND p.school_latitude = 40.735332
AND p.school_longitude = -74.196014;
```
-------------------------3260 sample_num
```sql
SELECT date_posted 
FROM projects 
JOIN essays ON projects.projectid = essays.projectid 
WHERE essays.title = 'Lets Share Ideas';
```
-------------------------3261 sample_num
```sql
SELECT d.donation_message 
FROM donations d 
JOIN projects p ON d.projectid = p.projectid 
JOIN essays e ON p.projectid = e.projectid 
WHERE e.title = 'Lets Share Ideas' 
AND d.payment_method = 'credit card';
```
-------------------------3262 sample_num
```sql
SELECT project_resource_type, COUNT(project_resource_type) AS resource_count
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE p.school_district = 'Los Angeles Unif Sch Dist'
GROUP BY project_resource_type
ORDER BY resource_count DESC
LIMIT 1;
```
-------------------------3263 sample_num
```sql
SELECT DISTINCT p.school_city
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE p.school_district = 'Los Angeles Unified School District'
AND r.vendor_name = 'Quill.com';
```
-------------------------3264 sample_num
```sql
SELECT 
    SUM(r.item_unit_price * r.item_quantity) AS total_price,
    p.school_latitude,
    p.school_longitude,
    p.school_district
FROM 
    resources r
JOIN 
    projects p ON r.projectid = p.projectid
WHERE 
    r.vendor_name = 'ABC School Supply' 
    AND r.project_resource_type = 'Other'
GROUP BY 
    p.school_latitude, 
    p.school_longitude, 
    p.school_district;
```
-------------------------3265 sample_num
```sql
SELECT p.school_city, p.poverty_level, SUM(d.donation_total) AS total_donated
FROM essays e
JOIN projects p ON e.projectid = p.projectid
JOIN donations d ON p.projectid = d.projectid
WHERE e.title = 'Lets Share Ideas' AND d.payment_method = 'paypal'
GROUP BY p.school_city, p.poverty_level;
```
-------------------------3266 sample_num
```sql
SELECT COUNT(DISTINCT donor_acctid) 
FROM donations 
WHERE donor_city = 'Pocatello' AND is_teacher_acct = 'f';
```
-------------------------3267 sample_num
```sql
SELECT COUNT(DISTINCT schoolid) 
FROM projects 
WHERE school_county = 'Suffolk' AND teacher_prefix = 'Dr.';
```
-------------------------3268 sample_num
```sql
SELECT SUM(donation_to_project + donation_optional_support) AS total_donated_amounts
FROM donations
WHERE payment_method = 'Amazon';
```
-------------------------3269 sample_num
```sql
SELECT COUNT(*) 
FROM donations 
WHERE for_honoree = 't' AND dollar_amount = '100_and_up';
```
-------------------------3270 sample_num
```sql
SELECT vendorid, COUNT(*) AS resource_count
FROM resources
WHERE item_unit_price < 15 AND project_resource_type <> 'technology'
GROUP BY vendorid;
```
-------------------------3271 sample_num
```sql
SELECT COUNT(DISTINCT p.projectid) 
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE r.vendor_name = 'Quill.com' 
AND r.item_quantity BETWEEN 5 AND 10;
```
-------------------------3272 sample_num
```sql
SELECT projectid 
FROM projects 
WHERE school_district = 'Union Pub School District I-9' 
AND teacher_ny_teaching_fellow = 't';
```
-------------------------3273 sample_num
```sql
SELECT DISTINCT school_city 
FROM projects 
WHERE school_county = 'Los Angeles' AND school_metro = 'Suburban';
```
-------------------------3274 sample_num
```sql
SELECT DISTINCT vendor_name, projectid 
FROM resources 
WHERE project_resource_type = 'Books';
```
-------------------------3275 sample_num
```sql
SELECT 
    (COUNT(DISTINCT p.projectid) FILTER (WHERE d.payment_included_campaign_gift_card = 't') * 100.0 / COUNT(DISTINCT p.projectid)) AS percentage
FROM 
    projects p
LEFT JOIN 
    donations d ON p.projectid = d.projectid
WHERE 
    d.payment_method = 'no_cash_received' OR d.projectid IS NULL;
```
-------------------------3276 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN school_metro = 'suburban' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    projects
WHERE 
    school_city = 'Santa Barbara';
```
-------------------------3277 sample_num
```sql
SELECT 
    payment_method, 
    (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM donations WHERE substr(donation_timestamp, 1, 7) = '2013-03')) AS percentage
FROM 
    donations
WHERE 
    substr(donation_timestamp, 1, 7) = '2013-03'
GROUP BY 
    payment_method;
```
-------------------------3278 sample_num
```sql
SELECT AVG(item_unit_price) AS average_unit_price
FROM resources
WHERE vendor_name = 'AKJ Books';
```
-------------------------3279 sample_num
```sql
SELECT COUNT(DISTINCT p.schoolid) 
FROM projects p 
JOIN donations d ON p.projectid = d.projectid 
JOIN resources r ON p.projectid = r.projectid 
WHERE p.school_city = 'Brooklyn' 
  AND p.school_metro = 'urban' 
  AND d.for_honoree = 't' 
  AND r.item_name = 'TT992 - Refill Pack for Safety Name Tags';
```
-------------------------3280 sample_num
```sql
SELECT COUNT(DISTINCT p.schoolid) AS school_count
FROM projects p
JOIN donations d ON p.projectid = d.projectid
WHERE p.poverty_level = 'highest' 
AND d.payment_included_campaign_gift_card = 't';
```
-------------------------3281 sample_num
```sql
SELECT school_city, COUNT(DISTINCT schoolid) AS school_count
FROM projects p
JOIN donations d ON p.projectid = d.projectid
WHERE d.dollar_amount = 'under_10'
GROUP BY school_city
ORDER BY school_count DESC
LIMIT 1;
```
-------------------------3282 sample_num
```sql
SELECT e.title 
FROM essays e 
JOIN projects p ON e.projectid = p.projectid 
WHERE p.school_latitude = 42003718 AND p.school_longitude = -87668289;
```
-------------------------3283 sample_num
```sql
SELECT p.teacher_ny_teaching_fellow 
FROM projects p 
JOIN essays e ON p.projectid = e.projectid 
WHERE e.title = 'Team More Books!';
```
-------------------------3284 sample_num
```sql
SELECT DISTINCT r.vendor_name
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE p.primary_focus_area = 'Literature';
```
-------------------------3285 sample_num
```sql
SELECT DISTINCT r.vendor_name
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE p.grade_level = 'Grades 9-12';
```
-------------------------3286 sample_num
```sql
SELECT COUNT(DISTINCT d.donor_acctid) AS teacher_donors
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE p.school_city = 'Chicago' AND d.is_teacher_acct = 't';
```
-------------------------3287 sample_num
```sql
SELECT COUNT(DISTINCT p.projectid) 
FROM projects p 
JOIN donations d ON p.projectid = d.projectid 
WHERE p.school_city = 'Rock Hill' AND d.is_teacher_acct = 't';
```
-------------------------3288 sample_num
```sql
SELECT SUM(donation_total) AS total_donations
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE d.donation_included_optional_support = 't' AND p.students_reached > 300;
```
-------------------------3289 sample_num
```sql
SELECT SUM(r.item_quantity) AS total_items_requested
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE p.school_district = 'Onslow Co School District' AND p.school_metro = 'urban';
```
-------------------------3290 sample_num
```sql
SELECT AVG((SUM(donation_optional_support) + SUM(donation_to_project)) / SUM(donation_total)) AS average_donations
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE p.school_county = 'Fresno';
```
-------------------------3291 sample_num
```sql
SELECT 
    (COUNT(DISTINCT CASE WHEN e.title = 'ABC Read' THEN p.school_county END) * 100.0) / 
    COUNT(DISTINCT p.school_county) AS percentage_counties
FROM 
    essays e
JOIN 
    projects p ON e.projectid = p.projectid;
```
-------------------------3292 sample_num
```sql
SELECT AVG(total_resources) AS average_resources_per_honoree
FROM (
    SELECT d.for_honoree, SUM(r.item_quantity) AS total_resources, COUNT(d.donationid) AS donation_count
    FROM donations d
    JOIN resources r ON d.projectid = r.projectid
    WHERE d.for_honoree = 't'
    GROUP BY d.donationid
) AS honoree_resources;
```
-------------------------3293 sample_num
```sql
SELECT date_posted 
FROM projects 
WHERE title = 'Photojournalists Want to Exhibit Their Best Works';
```
-------------------------3294 sample_num
```sql
SELECT item_name, MAX(item_unit_price) AS max_price
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE p.primary_focus_subject = 'Mathematics'
GROUP BY item_name
ORDER BY max_price DESC
LIMIT 1;
```
-------------------------3295 sample_num
```sql
SELECT p.school_city, p.school_latitude, p.school_longitude
FROM projects p
JOIN resources r ON p.projectid = r.projectid
WHERE r.item_name = 'Viewscreen LCD from Texas Instruments, TI-84 Plus';
```
-------------------------3296 sample_num
```sql
SELECT COUNT(*) AS donation_count
FROM donations
WHERE projectid = (SELECT projectid FROM essays WHERE title = 'Look, Look, We Need a Nook!');
```
-------------------------3297 sample_num
```sql
SELECT DISTINCT p.poverty_level
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE d.donor_zip = '7079';
```
-------------------------3298 sample_num
```sql
SELECT r.vendor_name 
FROM resources r 
JOIN projects p ON r.projectid = p.projectid 
WHERE p.projectid = (SELECT projectid FROM essays WHERE title = 'Bloody Times');
```
-------------------------3299 sample_num
```sql
SELECT r.item_name, p.school_zip
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE r.vendor_name = 'Sax Arts & Crafts';
```
-------------------------3300 sample_num
```sql
SELECT school_latitude, school_longitude 
FROM projects 
WHERE projectid = (SELECT projectid FROM essays WHERE title = 'Wiping Away Bad Grades');
```
-------------------------3301 sample_num
```sql
SELECT DISTINCT p.primary_focus_subject
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE d.payment_included_campaign_gift_card = 't';
```
-------------------------3302 sample_num
```sql
SELECT p.short_description
FROM resources r
JOIN projects p ON r.projectid = p.projectid
WHERE r.project_resource_type = 'Books'
AND r.item_unit_price = (
    SELECT MAX(item_unit_price)
    FROM resources
    WHERE project_resource_type = 'Books'
);
```
-------------------------3303 sample_num
```sql
SELECT grade_level 
FROM projects 
WHERE projectid IN (SELECT projectid FROM essays WHERE title = 'Too Close for Comfort');
```
-------------------------3304 sample_num
```sql
SELECT SUM(p.students_reached) AS total_students_impacted
FROM donations d
JOIN projects p ON d.projectid = p.projectid
WHERE d.donor_zip = '22205';
```
-------------------------3305 sample_num
```sql
SELECT 
    primary_focus_area,
    (COUNT(CASE WHEN d.via_giving_page = 't' THEN d.donationid END) * 100.0 / COUNT(d.donationid)) AS percentage
FROM 
    donations d
JOIN 
    projects p ON d.projectid = p.projectid
GROUP BY 
    primary_focus_area;
```
-------------------------3306 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN r.vendor_name = 'Best Buy for Business' THEN 1 END) * 100.0 / COUNT(r.projectid)) AS percentage,
    p.date_posted
FROM 
    resources r
JOIN 
    projects p ON r.projectid = p.projectid
WHERE 
    r.project_resource_type = 'Technology'
GROUP BY 
    p.date_posted;
```
-------------------------3307 sample_num
```sql
SELECT 
    (SUM(CASE WHEN game_platform_id = 50 THEN num_sales ELSE 0 END) - 
     SUM(CASE WHEN game_platform_id = 51 THEN num_sales ELSE 0 END)) AS sales_difference
FROM 
    region_sales
WHERE 
    region_id = 1;
```
-------------------------3308 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN genre gen ON g.genre_id = gen.id
WHERE gen.id = (SELECT genre_id FROM game WHERE game_name = '3D Lemmings');
```
-------------------------3309 sample_num
```sql
SELECT COUNT(*) 
FROM game 
WHERE genre_id = (SELECT id FROM genre WHERE genre_name = 'Action');
```
-------------------------3310 sample_num
```sql
SELECT g.genre_name 
FROM game AS gm 
JOIN genre AS g ON gm.genre_id = g.id 
WHERE gm.game_name = '3D Lemmings';
```
-------------------------3311 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
WHERE g.game_name = '3D Lemmings';
```
-------------------------3312 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = '10TACLE Studios';
```
-------------------------3313 sample_num
```sql
SELECT COUNT(g.id) AS puzzle_game_count
FROM game g
JOIN genre ge ON g.genre_id = ge.id
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = '10TACLE Studios' AND ge.genre_name = 'Puzzle';
```
-------------------------3314 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN genre ge ON g.genre_id = ge.id
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = '10TACLE Studios' AND ge.genre_name = 'Puzzle';
```
-------------------------3315 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
GROUP BY p.publisher_name
ORDER BY COUNT(gp.game_id) DESC
LIMIT 1;
```
-------------------------3316 sample_num
```sql
SELECT p.platform_name 
FROM game g 
JOIN game_publisher gp ON g.id = gp.game_id 
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id 
JOIN platform p ON gpl.platform_id = p.id 
WHERE g.game_name = 'Panzer Tactics' AND gpl.release_year = 2007;
```
-------------------------3317 sample_num
```sql
SELECT gp.release_year
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE g.game_name = 'Panzer Tactics' AND p.platform_name = 'DS';
```
-------------------------3318 sample_num
```sql
SELECT DISTINCT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
JOIN genre ge ON g.genre_id = ge.id
WHERE ge.genre_name = 'Puzzle';
```
-------------------------3319 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
JOIN genre ge ON g.genre_id = ge.id
WHERE ge.genre_name = 'Puzzle'
GROUP BY p.publisher_name
ORDER BY COUNT(g.id) DESC
LIMIT 1;
```
-------------------------3320 sample_num
```sql
SELECT COUNT(DISTINCT gp.publisher_id) AS publisher_count
FROM game g
JOIN genre ge ON g.genre_id = ge.id
JOIN game_publisher gp ON g.id = gp.game_id
WHERE ge.genre_name = 'Puzzle'
GROUP BY gp.publisher_id
HAVING COUNT(g.id) > 3;
```
-------------------------3321 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN g.id IS NOT NULL THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    publisher p
JOIN 
    game_publisher gp ON p.id = gp.publisher_id
JOIN 
    game g ON gp.game_id = g.id
JOIN 
    genre ge ON g.genre_id = ge.id
WHERE 
    p.publisher_name = 'Nintendo';
```
-------------------------3322 sample_num
```sql
SELECT AVG(total_sales) AS average_sales
FROM (
    SELECT SUM(rs.num_sales * 100000) AS total_sales
    FROM region_sales rs
    JOIN game_platform gp ON rs.game_platform_id = gp.id
    JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
    JOIN game g ON gpub.game_id = g.id
    JOIN platform p ON gp.platform_id = p.id
    WHERE p.platform_name = 'DS'
    GROUP BY rs.region_id
) AS sales_per_region;
```
-------------------------3323 sample_num
```sql
SELECT COUNT(game.id) AS number_of_games
FROM game
JOIN game_publisher ON game.id = game_publisher.game_id
WHERE game_publisher.publisher_id = 352;
```
-------------------------3324 sample_num
```sql
SELECT genre_id FROM game WHERE game_name = 'Pro Evolution Soccer 2012';
```
-------------------------3325 sample_num
```sql
SELECT id FROM region WHERE region_name = 'Japan';
```
-------------------------3326 sample_num
```sql
SELECT game_platform_id 
FROM region_sales 
WHERE region_id = 2 
ORDER BY num_sales DESC 
LIMIT 1;
```
-------------------------3327 sample_num
```sql
SELECT genre_id
FROM game
GROUP BY genre_id
ORDER BY COUNT(id) DESC
LIMIT 1;
```
-------------------------3328 sample_num
```sql
SELECT id FROM game WHERE game_name = 'Resident Evil Archives: Resident Evil';
```
-------------------------3329 sample_num
```sql
SELECT COUNT(g.id) AS num_games
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE p.platform_name = 'X360' AND gpl.release_year = '2010';
```
-------------------------3330 sample_num
```sql
SELECT p.publisher_name 
FROM game g 
JOIN game_publisher gp ON g.id = gp.game_id 
JOIN publisher p ON gp.publisher_id = p.id 
WHERE g.game_name = 'ModNation Racers';
```
-------------------------3331 sample_num
```sql
SELECT game_platform_id 
FROM region_sales 
WHERE region_id = (SELECT id FROM region WHERE region_name = 'Japan') 
ORDER BY num_sales DESC 
LIMIT 1;
```
-------------------------3332 sample_num
```sql
SELECT COUNT(DISTINCT gp.platform_id) AS platform_count
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE g.game_name = 'Pro Evolution Soccer 2016';
```
-------------------------3333 sample_num
```sql
SELECT COUNT(*) 
FROM game 
WHERE genre_id = (SELECT id FROM genre WHERE genre_name = 'Sports');
```
-------------------------3334 sample_num
```sql
SELECT p.publisher_name 
FROM publisher p 
JOIN game_publisher gp ON p.id = gp.publisher_id 
WHERE gp.game_id = 10031;
```
-------------------------3335 sample_num
```sql
SELECT publisher_name
FROM publisher
JOIN game_publisher ON publisher.id = game_publisher.publisher_id
GROUP BY publisher_name
ORDER BY COUNT(game_publisher.game_id) DESC
LIMIT 1;
```
-------------------------3336 sample_num
```sql
SELECT 
    (SELECT COUNT(g.id) FROM game g 
     JOIN genre ge ON g.genre_id = ge.id 
     WHERE ge.genre_name = 'Sports') - 
    (SELECT COUNT(g.id) FROM game g 
     JOIN genre ge ON g.genre_id = ge.id 
     WHERE ge.genre_name = 'Simulation') AS difference;
```
-------------------------3337 sample_num
```sql
SELECT g.genre_name 
FROM game AS gm 
JOIN genre AS g ON gm.genre_id = g.id 
WHERE gm.game_name = 'Resident Evil: Revelations';
```
-------------------------3338 sample_num
```sql
SELECT SUM(num_sales * 100000) AS total_sales
FROM region_sales
JOIN region ON region_sales.region_id = region.id
WHERE region.region_name = 'Europe' AND region_sales.game_platform_id = 3871;
```
-------------------------3339 sample_num
```sql
SELECT COUNT(DISTINCT g.id) AS number_of_games
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = 'Ascaron Entertainment GmbH';
```
-------------------------3340 sample_num
```sql
SELECT p.platform_name
FROM platform p
JOIN game_platform gp ON p.id = gp.platform_id
WHERE gp.release_year = (SELECT MIN(release_year) FROM game_platform);
```
-------------------------3341 sample_num
```sql
SELECT 
    (SUM(CASE WHEN g.id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(g.id)) AS adventure_percentage
FROM 
    game g
JOIN 
    game_publisher gp ON g.id = gp.game_id
JOIN 
    publisher p ON gp.publisher_id = p.id
JOIN 
    genre ge ON g.genre_id = ge.id
WHERE 
    p.publisher_name = 'Namco Bandai Games';
```
-------------------------3342 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM game_publisher gp JOIN publisher p ON gp.publisher_id = p.id WHERE p.publisher_name = 'Atari') * 1.0 /
    (SELECT COUNT(*) FROM game_publisher gp JOIN publisher p ON gp.publisher_id = p.id WHERE p.publisher_name = 'Athena') AS times_more
```
-------------------------3343 sample_num
```sql
SELECT COUNT(g.id) AS num_games
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = 'Electronic Arts';
```
-------------------------3344 sample_num
```sql
SELECT g.genre_name 
FROM game AS ga 
JOIN genre AS g ON ga.genre_id = g.id 
WHERE ga.game_name = 'Advent Rising';
```
-------------------------3345 sample_num
```sql
SELECT COUNT(*) 
FROM game g
JOIN genre ge ON g.genre_id = ge.id
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE ge.genre_name = 'Role-Playing' AND p.publisher_name = 'Microsoft Game Studios';
```
-------------------------3346 sample_num
```sql
SELECT p.publisher_name, COUNT(gp.game_id) AS game_count
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
GROUP BY p.publisher_name
ORDER BY game_count DESC
LIMIT 1;
```
-------------------------3347 sample_num
```sql
SELECT DISTINCT p.platform_name
FROM publisher pu
JOIN game_publisher gp ON pu.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE pu.publisher_name = 'Codemasters' AND gpl.release_year = 2004;
```
-------------------------3348 sample_num
```sql
SELECT COUNT(DISTINCT g.id) AS num_games
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE p.platform_name = 'PS4' AND gpl.release_year = 2014;
```
-------------------------3349 sample_num
```sql
SELECT DISTINCT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE gpl.release_year = (SELECT MIN(release_year) FROM game_platform);
```
-------------------------3350 sample_num
```sql
SELECT COUNT(DISTINCT p.id) 
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform pl ON gpl.platform_id = pl.id
JOIN region_sales rs ON gpl.id = rs.game_platform_id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Japan' 
  AND pl.platform_name = 'X360' 
  AND gpl.release_year = 2011;
```
-------------------------3351 sample_num
```sql
SELECT gp.platform_id, SUM(rs.num_sales) AS total_sales
FROM region_sales rs
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Europe'
GROUP BY gp.platform_id
ORDER BY total_sales DESC
LIMIT 1;
```
-------------------------3352 sample_num
```sql
SELECT release_year
FROM game_platform gp
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN game g ON gpub.game_id = g.id
JOIN platform p ON gp.platform_id = p.id
WHERE p.platform_name = 'PC'
GROUP BY release_year
ORDER BY COUNT(g.id) DESC
LIMIT 1;
```
-------------------------3353 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
GROUP BY p.id, p.publisher_name
HAVING COUNT(gp.game_id) = 1;
```
-------------------------3354 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = '505 Games';
```
-------------------------3355 sample_num
```sql
SELECT genre_id FROM game WHERE game_name = '25 to Life';
```
-------------------------3356 sample_num
```sql
SELECT id FROM game WHERE genre_id = 2;
```
-------------------------3357 sample_num
```sql
SELECT gp.release_year 
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
WHERE g.id BETWEEN 1 AND 10;
```
-------------------------3358 sample_num
```sql
SELECT game_publisher_id FROM game_platform WHERE platform_id = 15;
```
-------------------------3359 sample_num
```sql
SELECT game.id 
FROM game 
JOIN game_platform ON game.id = game_platform.game_publisher_id 
WHERE game_platform.release_year BETWEEN 2000 AND 2003;
```
-------------------------3360 sample_num
```sql
SELECT num_sales * 100000 AS total_sales
FROM region_sales
WHERE region_id = 2 AND game_platform_id = 9615;
```
-------------------------3361 sample_num
```sql
SELECT DISTINCT p.platform_name
FROM platform p
JOIN game_platform gp ON p.id = gp.platform_id
WHERE gp.release_year = 2016;
```
-------------------------3362 sample_num
```sql
SELECT gp.release_year 
FROM game g 
JOIN game_publisher gp ON g.id = gp.game_id 
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id 
WHERE g.game_name = '3DS Classic Collection';
```
-------------------------3363 sample_num
```sql
SELECT AVG(rs.num_sales) * 100000 AS average_sales
FROM region_sales rs
JOIN region r ON rs.region_id = r.id
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN game g ON gpub.game_id = g.id
WHERE r.region_name = 'Japan';
```
-------------------------3364 sample_num
```sql
SELECT g.genre_name
FROM game_platform gp
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN game g ON gpub.game_id = g.id
JOIN genre gen ON g.genre_id = gen.id
WHERE gp.release_year BETWEEN 2000 AND 2002;
```
-------------------------3365 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = '3DO';
```
-------------------------3366 sample_num
```sql
SELECT COUNT(*) 
FROM game 
WHERE genre_id = (SELECT id FROM genre WHERE genre_name = 'Role-Playing');
```
-------------------------3367 sample_num
```sql
SELECT r.region_name
FROM region r
JOIN region_sales rs ON r.id = rs.region_id
WHERE rs.num_sales > 300000;
```
-------------------------3368 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN region_sales rs ON gpl.id = rs.game_platform_id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'North America'
GROUP BY p.publisher_name
ORDER BY SUM(rs.num_sales) DESC
LIMIT 1;
```
-------------------------3369 sample_num
```sql
SELECT gp.release_year
FROM region_sales rs
JOIN region r ON rs.region_id = r.id
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN game g ON gpub.game_id = g.id
WHERE rs.num_sales = 350000 AND r.region_name = 'North America';
```
-------------------------3370 sample_num
```sql
SELECT p.platform_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE g.game_name = '15 Days';
```
-------------------------3371 sample_num
```sql
SELECT p.publisher_name 
FROM publisher p 
JOIN game_publisher gp ON p.id = gp.publisher_id 
WHERE gp.game_id = 75;
```
-------------------------3372 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN region_sales rs ON gpl.id = rs.game_platform_id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Japan'
ORDER BY rs.num_sales DESC
LIMIT 1;
```
-------------------------3373 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN region_sales rs ON gpl.id = rs.game_platform_id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Japan' 
AND rs.num_sales > (SELECT 0.9 * AVG(num_sales) 
                     FROM region_sales 
                     JOIN game_platform gpl2 ON region_sales.game_platform_id = gpl2.id 
                     JOIN game_publisher gp2 ON gpl2.game_publisher_id = gp2.id 
                     JOIN region r2 ON region_sales.region_id = r2.id 
                     WHERE r2.region_name = 'Japan')
GROUP BY p.publisher_name;
```
-------------------------3374 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.platform_name = 'PSP' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS psp_percentage
FROM 
    game g
JOIN 
    game_publisher gp ON g.id = gp.game_id
JOIN 
    game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN 
    platform p ON gpl.platform_id = p.id
WHERE 
    gpl.release_year = 2004;
```
-------------------------3375 sample_num
```sql
SELECT COUNT(*) AS num_games
FROM game_platform
WHERE release_year = 1981;
```
-------------------------3376 sample_num
```sql
SELECT genre_id FROM game WHERE game_name = '2Xtreme';
```
-------------------------3377 sample_num
```sql
SELECT SUM(num_sales) * 100000 AS total_game_sales
FROM region_sales
WHERE game_platform_id = 9658
GROUP BY region_id;
```
-------------------------3378 sample_num
```sql
SELECT id FROM publisher WHERE publisher_name = '1C Company';
```
-------------------------3379 sample_num
```sql
SELECT genre_name FROM genre WHERE id = 3;
```
-------------------------3380 sample_num
```sql
SELECT gp.game_id 
FROM game_platform gp 
WHERE gp.release_year = 2017;
```
-------------------------3381 sample_num
```sql
SELECT gp.release_year 
FROM game g 
JOIN game_publisher gp ON g.id = gp.game_id 
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id 
WHERE g.game_name = 'Adventure Island';
```
-------------------------3382 sample_num
```sql
SELECT COUNT(*) 
FROM game 
WHERE genre_id = (SELECT id FROM genre WHERE genre_name = 'Puzzle');
```
-------------------------3383 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_platform gp ON g.id = gp.game_publisher_id
JOIN platform p ON gp.platform_id = p.id
WHERE p.platform_name = 'SCD';
```
-------------------------3384 sample_num
```sql
SELECT COUNT(g.id) AS num_games
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = 'Acclaim Entertainment';
```
-------------------------3385 sample_num
```sql
SELECT p.publisher_name 
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
WHERE g.game_name = 'Chronicles of the Sword';
```
-------------------------3386 sample_num
```sql
SELECT SUM(rs.num_sales * 100000) AS total_sales
FROM region_sales rs
JOIN region r ON rs.region_id = r.id
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN game g ON gpub.game_id = g.id
JOIN platform p ON gp.platform_id = p.id
WHERE r.region_name = 'North America' AND p.platform_name = 'PS4';
```
-------------------------3387 sample_num
```sql
SELECT game_platform_id 
FROM region_sales 
WHERE region_id = (SELECT id FROM region WHERE region_name = 'Europe') 
ORDER BY num_sales DESC 
LIMIT 1;
```
-------------------------3388 sample_num
```sql
SELECT g.game_name 
FROM game g 
JOIN game_publisher gp ON g.id = gp.game_id 
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id 
WHERE gpl.release_year = 2011;
```
-------------------------3389 sample_num
```sql
SELECT COUNT(DISTINCT gp.game_id) AS num_games
FROM game_platform gp
JOIN platform p ON gp.platform_id = p.id
WHERE p.platform_name = 'Wii';
```
-------------------------3390 sample_num
```sql
SELECT g.game_name, gp.release_year
FROM game g
JOIN genre ge ON g.genre_id = ge.id
JOIN game_publisher gp ON g.id = gp.game_id
LIMIT 5;
```
-------------------------3391 sample_num
```sql
SELECT g.genre_name 
FROM game AS ga 
JOIN genre AS g ON ga.genre_id = g.id 
WHERE ga.game_name = '2Xtreme';
```
-------------------------3392 sample_num
```sql
SELECT p.platform_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE g.game_name = 'Panzer Tactics';
```
-------------------------3393 sample_num
```sql
SELECT 
    (SELECT num_sales 
     FROM region_sales rs 
     JOIN region r ON rs.region_id = r.id 
     WHERE r.region_name = 'North America' AND rs.game_platform_id = 9577) - 
    (SELECT AVG(num_sales) 
     FROM region_sales 
     WHERE game_platform_id = 9577) AS sales_difference,
    ((SELECT num_sales 
     FROM region_sales rs 
     JOIN region r ON rs.region_id = r.id 
     WHERE r.region_name = 'North America' AND rs.game_platform_id = 9577) - 
    (SELECT AVG(num_sales) 
     FROM region_sales 
     WHERE game_platform_id = 9577)) / 
    (SELECT AVG(num_sales) 
     FROM region_sales 
     WHERE game_platform_id = 9577) * 100 AS percent_above_average
```
-------------------------3394 sample_num
```sql
SELECT game_name 
FROM game 
ORDER BY LENGTH(game_name) DESC 
LIMIT 1;
```
-------------------------3395 sample_num
```sql
SELECT COUNT(*) AS num_games
FROM game_platform
WHERE release_year = 2001;
```
-------------------------3396 sample_num
```sql
SELECT SUM(num_sales) AS total_sales FROM region_sales;
```
-------------------------3397 sample_num
```sql
SELECT AVG(game_count) AS average_games_per_publisher
FROM (
    SELECT COUNT(gp.game_id) AS game_count, gp.publisher_id
    FROM game_publisher gp
    GROUP BY gp.publisher_id
) AS publisher_game_counts;
```
-------------------------3398 sample_num
```sql
SELECT MIN(release_year) AS first_release_year
FROM game_platform;
```
-------------------------3399 sample_num
```sql
SELECT g.genre_name
FROM genre g
JOIN game ga ON g.id = ga.genre_id
GROUP BY g.id, g.genre_name
ORDER BY COUNT(ga.id) ASC
LIMIT 1;
```
-------------------------3400 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
WHERE g.game_name = 'Prism: Light the Way';
```
-------------------------3401 sample_num
```sql
SELECT gp.platform_id, YEAR(gp.release_year) AS release_year, COUNT(gp.id) AS game_count
FROM game_platform gp
GROUP BY gp.platform_id, YEAR(gp.release_year)
HAVING COUNT(gp.id) = (
    SELECT MAX(game_count)
    FROM (
        SELECT COUNT(gp_inner.id) AS game_count
        FROM game_platform gp_inner
        GROUP BY gp_inner.platform_id, YEAR(gp_inner.release_year)
    ) AS counts
    WHERE counts.release_year = YEAR(gp.release_year)
)
ORDER BY release_year, game_count DESC;
```
-------------------------3402 sample_num
```sql
SELECT COUNT(DISTINCT g.id) AS num_games_without_sales
FROM game g
LEFT JOIN game_platform gp ON g.id = gp.game_publisher_id
LEFT JOIN region_sales rs ON gp.id = rs.game_platform_id
LEFT JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Europe' AND (rs.num_sales IS NULL OR rs.num_sales = 0);
```
-------------------------3403 sample_num
```sql
SELECT g.game_name 
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE gpl.release_year = 2006;
```
-------------------------3404 sample_num
```sql
SELECT g.genre_name 
FROM game AS gm 
JOIN genre AS g ON gm.genre_id = g.id 
WHERE gm.game_name = 'Mario vs. Donkey Kong';
```
-------------------------3405 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
GROUP BY p.publisher_name
ORDER BY COUNT(gp.game_id) DESC
LIMIT 1;
```
-------------------------3406 sample_num
```sql
SELECT g.game_name 
FROM game g
JOIN genre ge ON g.genre_id = ge.id
WHERE ge.genre_name = 'Platform';
```
-------------------------3407 sample_num
```sql
SELECT DISTINCT gp.release_year
FROM game_platform gp
JOIN platform p ON gp.platform_id = p.id
WHERE p.platform_name = 'WiiU';
```
-------------------------3408 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN region_sales rs ON gpl.id = rs.game_platform_id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Japan'
ORDER BY rs.num_sales DESC
LIMIT 1;
```
-------------------------3409 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = 'Activision';
```
-------------------------3410 sample_num
```sql
SELECT COUNT(DISTINCT p.id) AS publisher_count
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
WHERE g.game_name LIKE 'Marvel%';
```
-------------------------3411 sample_num
```sql
SELECT (SUM(CASE WHEN g.genre_name = 'sport' THEN 1 ELSE 0 END) * 100.0) / COUNT(g.game_name) AS percentage_sports
FROM game g
JOIN genre gen ON g.genre_id = gen.id;
```
-------------------------3412 sample_num
```sql
SELECT 
    DIVIDE(
        SUM(CASE WHEN r.region_name = 'North America' THEN rs.num_sales ELSE 0 END),
        SUM(CASE WHEN r.region_name = 'Japan' THEN rs.num_sales ELSE 0 END)
    ) AS sales_ratio
FROM 
    region_sales rs
JOIN 
    region r ON rs.region_id = r.id
JOIN 
    game_platform gp ON rs.game_platform_id = gp.id
JOIN 
    game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN 
    game g ON gpub.game_id = g.id
JOIN 
    genre gen ON g.genre_id = gen.id;
```
-------------------------3413 sample_num
```sql
SELECT release_year, COUNT(*) AS num_releases
FROM game_platform
GROUP BY release_year
ORDER BY num_releases DESC
LIMIT 1;
```
-------------------------3414 sample_num
```sql
SELECT COUNT(*) 
FROM publisher 
WHERE publisher_name LIKE '%Interactive%';
```
-------------------------3415 sample_num
```sql
SELECT p.platform_name, SUM(rs.num_sales) AS total_sales
FROM platform p
JOIN game_platform gp ON p.id = gp.platform_id
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN region_sales rs ON gp.id = rs.game_platform_id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'North America'
GROUP BY p.platform_name
ORDER BY total_sales DESC
LIMIT 2;
```
-------------------------3416 sample_num
```sql
SELECT COUNT(g.id) AS num_games
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE p.publisher_name = 'BMG Interactive Entertainment' AND gpl.release_year = 2012;
```
-------------------------3417 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE gpl.release_year = 2007
GROUP BY p.publisher_name
ORDER BY COUNT(gp.game_id) DESC
LIMIT 1;
```
-------------------------3418 sample_num
```sql
SELECT COUNT(DISTINCT gp.publisher_id) AS publisher_count
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
WHERE g.game_name = 'Minecraft';
```
-------------------------3419 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
JOIN genre ge ON g.genre_id = ge.id
WHERE ge.genre_name = 'Action'
GROUP BY p.publisher_name
ORDER BY COUNT(g.id) DESC
LIMIT 1;
```
-------------------------3420 sample_num
```sql
SELECT COUNT(*) 
FROM game g
JOIN genre ge ON g.genre_id = ge.id
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE ge.genre_name = 'Sports' AND p.publisher_name = 'Nintendo';
```
-------------------------3421 sample_num
```sql
SELECT g.genre_id, ge.genre_name 
FROM game g 
JOIN genre ge ON g.genre_id = ge.id 
WHERE g.game_name = '2 Games in 1: Sonic Advance & ChuChu Rocket!';
```
-------------------------3422 sample_num
```sql
SELECT COUNT(*) 
FROM region_sales rs
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN platform p ON gp.platform_id = p.id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Other' AND rs.num_sales > 0 AND p.platform_name = 'DS';
```
-------------------------3423 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = 'American Softworks';
```
-------------------------3424 sample_num
```sql
SELECT COUNT(*) 
FROM game 
JOIN genre ON game.genre_id = genre.id 
WHERE genre.genre_name = 'Strategy';
```
-------------------------3425 sample_num
```sql
SELECT p.publisher_name 
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
WHERE g.game_name = 'Overwatch';
```
-------------------------3426 sample_num
```sql
SELECT g.genre_name
FROM genre g
JOIN game ga ON g.id = ga.genre_id
GROUP BY g.genre_name
ORDER BY COUNT(ga.id) DESC
LIMIT 1;
```
-------------------------3427 sample_num
```sql
SELECT SUM(num_sales * 100000) AS total_sales
FROM region_sales
JOIN region ON region_sales.region_id = region.id
WHERE region.region_name = 'Europe' AND region_sales.game_platform_id = 26;
```
-------------------------3428 sample_num
```sql
SELECT COUNT(*) AS num_games
FROM game_platform
WHERE release_year = 2001;
```
-------------------------3429 sample_num
```sql
SELECT COUNT(*) FROM game WHERE game_name LIKE '%Box%';
```
-------------------------3430 sample_num
```sql
SELECT g.game_name, SUM(rs.num_sales) AS total_sales
FROM game g
JOIN game_platform gp ON g.id = gp.game_publisher_id
JOIN region_sales rs ON gp.id = rs.game_platform_id
GROUP BY g.game_name
ORDER BY total_sales DESC
LIMIT 3;
```
-------------------------3431 sample_num
```sql
SELECT MIN(release_year) AS first_game_release_year
FROM game_platform;
```
-------------------------3432 sample_num
```sql
SELECT * FROM publisher WHERE publisher_name LIKE '%Entertainment%';
```
-------------------------3433 sample_num
```sql
SELECT g.game_name 
FROM game g 
JOIN genre ge ON g.genre_id = ge.id 
WHERE ge.genre_name = 'Adventure';
```
-------------------------3434 sample_num
```sql
SELECT g.game_name 
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = 'Pioneer LDC';
```
-------------------------3435 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE p.platform_name = 'SCD';
```
-------------------------3436 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN region_sales rs ON gpl.id = rs.game_platform_id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Japan';
```
-------------------------3437 sample_num
```sql
SELECT DISTINCT g.genre_name
FROM genre g
JOIN game ga ON g.id = ga.genre_id
JOIN game_publisher gp ON ga.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = 'Agatsuma Entertainment';
```
-------------------------3438 sample_num
```sql
SELECT COUNT(*) 
FROM game 
WHERE genre_id NOT IN (
    SELECT id 
    FROM genre 
    WHERE genre_name IN ('Role-Playing', 'Shooter', 'Simulation')
);
```
-------------------------3439 sample_num
```sql
SELECT r.region_name, gp.platform_id, SUM(rs.num_sales) AS total_sales
FROM region_sales rs
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN region r ON rs.region_id = r.id
GROUP BY r.region_name, gp.platform_id
HAVING total_sales = (
    SELECT MAX(total_sales)
    FROM (
        SELECT SUM(rs_inner.num_sales) AS total_sales
        FROM region_sales rs_inner
        JOIN game_platform gp_inner ON rs_inner.game_platform_id = gp_inner.id
        JOIN region r_inner ON rs_inner.region_id = r_inner.id
        GROUP BY r_inner.region_name, gp_inner.platform_id
    ) AS sales_totals
    WHERE sales_totals.region_name = r.region_name
)
ORDER BY r.region_name;
```
-------------------------3440 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
JOIN genre ge ON g.genre_id = ge.id
WHERE ge.genre_name = 'Puzzle'
GROUP BY p.publisher_name
ORDER BY COUNT(g.id) DESC
LIMIT 1;
```
-------------------------3441 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN region_sales rs ON gpl.id = rs.game_platform_id
GROUP BY g.game_name
ORDER BY SUM(rs.num_sales) ASC
LIMIT 1;
```
-------------------------3442 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game g ON gp.game_id = g.id
WHERE g.game_name = 'Pachi-Slot Kanzen Kouryaku 3: Universal Koushiki Gaido Volume 3';
```
-------------------------3443 sample_num
```sql
SELECT r.region_name
FROM region r
JOIN region_sales rs ON r.id = rs.region_id
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN game g ON gpub.game_id = g.id
WHERE g.game_name = 'Pengo';
```
-------------------------3444 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE gpl.release_year = 2010;
```
-------------------------3445 sample_num
```sql
SELECT AVG(num_sales * 100000) AS average_sales
FROM region_sales rs
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN platform p ON gp.platform_id = p.id
WHERE p.platform_name = 'PS2';
```
-------------------------3446 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.publisher_name = 'Brash Entertainment' THEN 1 ELSE 0 END) * 100.0) / COUNT(g.id) AS percentage
FROM 
    game g
JOIN 
    game_publisher gp ON g.id = gp.game_id
JOIN 
    publisher p ON gp.publisher_id = p.id;
```
-------------------------3447 sample_num
```sql
SELECT SUM(num_sales) * 100000 AS total_games_sold
FROM region_sales
WHERE region_id = 1;
```
-------------------------3448 sample_num
```sql
SELECT COUNT(*) 
FROM game 
WHERE game_name LIKE '%FIFA%';
```
-------------------------3449 sample_num
```sql
SELECT p.platform_name
FROM platform p
JOIN game_platform gp ON p.id = gp.platform_id
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN region_sales rs ON gp.id = rs.game_platform_id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Europe'
GROUP BY p.platform_name
ORDER BY SUM(rs.num_sales) DESC
LIMIT 1;
```
-------------------------3450 sample_num
```sql
SELECT p.publisher_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE g.game_name = '2002 FIFA World Cup';
```
-------------------------3451 sample_num
```sql
SELECT p.platform_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE g.game_name = '3Xtreme';
```
-------------------------3452 sample_num
```sql
SELECT g.genre_name 
FROM game AS g 
JOIN genre AS ge ON g.genre_id = ge.id 
WHERE g.game_name = '2010 FIFA World Cup South Africa';
```
-------------------------3453 sample_num
```sql
SELECT r.region_name
FROM region r
JOIN region_sales rs ON r.id = rs.region_id
GROUP BY r.region_name
ORDER BY SUM(rs.num_sales) DESC
LIMIT 1;
```
-------------------------3454 sample_num
```sql
SELECT SUM(rs.num_sales) * 100000 AS total_sales
FROM region_sales rs
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN platform p ON gp.platform_id = p.id
JOIN region r ON rs.region_id = r.id
WHERE p.platform_name = 'PS3' AND r.region_name = 'Japan';
```
-------------------------3455 sample_num
```sql
SELECT g.game_name 
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE gpl.release_year = 2007;
```
-------------------------3456 sample_num
```sql
SELECT COUNT(DISTINCT g.id) AS num_games
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = 'Activision';
```
-------------------------3457 sample_num
```sql
SELECT gp.release_year
FROM game_platform gp
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN game g ON gpub.game_id = g.id
JOIN region_sales rs ON gp.id = rs.game_platform_id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Japan'
GROUP BY gp.release_year
HAVING SUM(rs.num_sales) > 200000;
```
-------------------------3458 sample_num
```sql
SELECT COUNT(*) 
FROM game_platform gp
JOIN platform p ON gp.platform_id = p.id
WHERE gp.release_year = 2010 AND p.platform_name = 'PS3';
```
-------------------------3459 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
GROUP BY p.publisher_name
ORDER BY COUNT(gp.game_id) DESC
LIMIT 1;
```
-------------------------3460 sample_num
```sql
SELECT COUNT(g.id) AS shooter_game_count
FROM game g
JOIN genre gen ON g.genre_id = gen.id
WHERE gen.genre_name = 'shooter';
```
-------------------------3461 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.platform_name = 'PS4' AND gp.release_year = 2014 THEN 1 ELSE 0 END) * 100.0) / COUNT(g.id) AS percentage
FROM 
    game g
JOIN 
    game_publisher gp ON g.id = gp.game_id
JOIN 
    game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN 
    platform p ON gpl.platform_id = p.id
WHERE 
    gp.release_year = 2014;
```
-------------------------3462 sample_num
```sql
SELECT SUM(rs.num_sales) AS total_sales
FROM region_sales rs
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN game g ON gpub.game_id = g.id
WHERE rs.region_id = 4;
```
-------------------------3463 sample_num
```sql
SELECT gp.id 
FROM game_platform gp
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN region_sales rs ON gp.id = rs.game_platform_id
WHERE rs.region_id = 1;
```
-------------------------3464 sample_num
```sql
SELECT 
    (SUM(CASE WHEN rs.region_id = 2 THEN rs.num_sales ELSE 0 END) - 
     SUM(CASE WHEN rs.region_id = 3 THEN rs.num_sales ELSE 0 END)) AS sales_difference
FROM 
    region_sales rs
JOIN 
    game_platform gp ON rs.game_platform_id = gp.id;
```
-------------------------3465 sample_num
```sql
SELECT DISTINCT gp.platform_id 
FROM game_platform gp 
WHERE gp.release_year = 2007;
```
-------------------------3466 sample_num
```sql
SELECT gp.publisher_id 
FROM game_publisher gp 
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id 
WHERE gpl.platform_id = 16;
```
-------------------------3467 sample_num
```sql
SELECT COUNT(DISTINCT gp.publisher_id) AS num_publishers
FROM game_publisher gp
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE gpl.release_year = 1984;
```
-------------------------3468 sample_num
```sql
SELECT gp.platform_id
FROM game_platform gp
JOIN region_sales rs ON gp.id = rs.game_platform_id
WHERE rs.region_id = 3;
```
-------------------------3469 sample_num
```sql
SELECT SUM(rs.num_sales) AS sales
FROM region_sales rs
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Japan';
```
-------------------------3470 sample_num
```sql
SELECT COUNT(DISTINCT gp.publisher_id) 
FROM game_publisher gp
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE p.platform_name = 'X360';
```
-------------------------3471 sample_num
```sql
SELECT p.platform_name 
FROM platform p
JOIN game_platform gp ON p.id = gp.platform_id
WHERE gp.release_year = 2000;
```
-------------------------3472 sample_num
```sql
SELECT 
    (SELECT COUNT(DISTINCT gp.publisher_id) 
     FROM game_publisher gp 
     JOIN game_platform gpl ON gp.id = gpl.game_publisher_id 
     JOIN platform p ON gpl.platform_id = p.id 
     WHERE p.platform_name = 'PS3') - 
    (SELECT COUNT(DISTINCT gp.publisher_id) 
     FROM game_publisher gp 
     JOIN game_platform gpl ON gp.id = gpl.game_publisher_id 
     JOIN platform p ON gpl.platform_id = p.id 
     WHERE p.platform_name = 'X360') AS publisher_difference;
```
-------------------------3473 sample_num
```sql
SELECT g.id 
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = 'Bethesda Softworks';
```
-------------------------3474 sample_num
```sql
SELECT COUNT(DISTINCT g.id) AS total_game_ids
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name IN ('Capcom', 'Sony Computer Entertainment');
```
-------------------------3475 sample_num
```sql
SELECT g.genre_name 
FROM game AS ga 
JOIN genre AS g ON ga.genre_id = g.id 
WHERE ga.game_name = 'Grand Theft Auto V';
```
-------------------------3476 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN genre ge ON g.genre_id = ge.id
WHERE ge.genre_name = 'Racing';
```
-------------------------3477 sample_num
```sql
SELECT COUNT(*) AS num_games
FROM game g
JOIN genre ge ON g.genre_id = ge.id
WHERE ge.genre_name = 'Fighting';
```
-------------------------3478 sample_num
```sql
SELECT DISTINCT g.genre_name
FROM genre g
JOIN game ga ON g.id = ga.genre_id
JOIN game_publisher gp ON ga.id = gp.game_id
WHERE gp.publisher_id = 464;
```
-------------------------3479 sample_num
```sql
SELECT p.platform_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE g.game_name = 'Final Fantasy XIII-2';
```
-------------------------3480 sample_num
```sql
SELECT SUM(rs.num_sales) AS total_sales
FROM region_sales rs
JOIN game_platform gp ON rs.game_platform_id = gp.id
WHERE gp.release_year = 2000;
```
-------------------------3481 sample_num
```sql
SELECT 
    SUM(CASE WHEN gp.release_year = 2000 THEN rs.num_sales ELSE 0 END) - 
    SUM(CASE WHEN gp.release_year = 1990 THEN rs.num_sales ELSE 0 END) AS sales_difference
FROM 
    game_platform gp
JOIN 
    game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN 
    region_sales rs ON gp.id = rs.game_platform_id;
```
-------------------------3482 sample_num
```sql
SELECT platform_id 
FROM game_platform 
WHERE release_year = 2006;
```
-------------------------3483 sample_num
```sql
SELECT AVG(num_sales * 100000) AS average_sales
FROM region_sales
WHERE region_id = 3;
```
-------------------------3484 sample_num
```sql
SELECT release_year 
FROM game_platform 
WHERE id = 19 AND game_publisher_id = 6657;
```
-------------------------3485 sample_num
```sql
SELECT SUM(num_sales) * 100000 AS total_sales
FROM region_sales
WHERE game_platform_id = 66;
```
-------------------------3486 sample_num
```sql
SELECT game_name FROM game WHERE id = 44;
```
-------------------------3487 sample_num
```sql
SELECT g.game_name
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE p.platform_name = 'Wii';
```
-------------------------3488 sample_num
```sql
SELECT g.game_name 
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE gpl.release_year = 2015;
```
-------------------------3489 sample_num
```sql
SELECT COUNT(g.id) AS total_adventure_games
FROM game g
JOIN genre ge ON g.genre_id = ge.id
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE ge.genre_name = 'Adventure' AND gpl.release_year = 2005;
```
-------------------------3490 sample_num
```sql
SELECT p.publisher_name 
FROM game g 
JOIN game_publisher gp ON g.id = gp.game_id 
JOIN publisher p ON gp.publisher_id = p.id 
WHERE g.game_name = 'Adventure Time: Explore the Dungeon Because I Don''t Know!';
```
-------------------------3491 sample_num
```sql
SELECT gp.id AS game_platform_id, r.region_name
FROM region_sales rs
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN region r ON rs.region_id = r.id
WHERE rs.num_sales < 20000;
```
-------------------------3492 sample_num
```sql
SELECT g.game_name 
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
WHERE p.publisher_name = '505 Games' AND gpl.release_year = 2006;
```
-------------------------3493 sample_num
```sql
SELECT g.genre_name 
FROM game AS gm 
JOIN genre AS g ON gm.genre_id = g.id 
WHERE gm.id = 119;
```
-------------------------3494 sample_num
```sql
SELECT g.id 
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN publisher p ON gp.publisher_id = p.id
WHERE p.publisher_name = 'Abylight';
```
-------------------------3495 sample_num
```sql
SELECT r.region_name
FROM region r
JOIN region_sales rs ON r.id = rs.region_id
ORDER BY rs.num_sales ASC
LIMIT 1;
```
-------------------------3496 sample_num
```sql
SELECT g.game_name 
FROM game g 
JOIN genre ge ON g.genre_id = ge.id 
WHERE ge.genre_name = 'Strategy';
```
-------------------------3497 sample_num
```sql
SELECT p.platform_name 
FROM game_platform gp 
JOIN platform p ON gp.platform_id = p.id 
JOIN game_publisher gpub ON gp.game_publisher_id = gpub.id 
WHERE gpub.game_id = 178;
```
-------------------------3498 sample_num
```sql
SELECT g.genre_name 
FROM game AS ga 
JOIN genre AS g ON ga.genre_id = g.id 
WHERE ga.game_name IN ('Airlock', 'Airline Tycoon', 'Airblade');
```
-------------------------3499 sample_num
```sql
SELECT SUM(num_sales) * 100000 AS total_sales
FROM region_sales
JOIN region ON region_sales.region_id = region.id
WHERE region.region_name = 'North America';
```
-------------------------3500 sample_num
```sql
SELECT DISTINCT p.publisher_name
FROM publisher p
JOIN game_publisher gp ON p.id = gp.publisher_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN region_sales rs ON gpl.id = rs.game_platform_id
WHERE rs.num_sales < 10000
LIMIT 5;
```
-------------------------3501 sample_num
```sql
SELECT gp.platform_id 
FROM game g 
JOIN game_publisher gp ON g.id = gp.game_id 
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id 
WHERE g.game_name = 'Airborne Troops: Countdown to D-Day';
```
-------------------------3502 sample_num
```sql
SELECT COUNT(g.id) AS num_games
FROM game g
JOIN game_publisher gp ON g.id = gp.game_id
JOIN game_platform gpl ON gp.id = gpl.game_publisher_id
JOIN platform p ON gpl.platform_id = p.id
WHERE p.platform_name = 'PSP' AND gpl.release_year = 2004;
```
-------------------------3503 sample_num
```sql
SELECT g.genre_name 
FROM game AS g 
JOIN genre AS ge ON g.genre_id = ge.id 
WHERE g.game_name = '999: Nine Hours, Nine Persons, Nine Doors';
```
-------------------------3504 sample_num
```sql
SELECT release_year 
FROM game_platform 
WHERE game_publisher_id IN (SELECT id FROM game_publisher WHERE game_id = 156);
```
-------------------------3505 sample_num
```sql
SELECT 
    (SELECT COUNT(g.id) 
     FROM game g 
     JOIN game_publisher gp ON g.id = gp.game_id 
     JOIN publisher p ON gp.publisher_id = p.id 
     JOIN game_platform gpl ON gp.id = gpl.game_publisher_id 
     JOIN platform pl ON gpl.platform_id = pl.id 
     WHERE p.publisher_name = 'Culture Brain' AND pl.platform_name = 'SNES') -
    (SELECT COUNT(g.id) 
     FROM game g 
     JOIN game_publisher gp ON g.id = gp.game_id 
     JOIN publisher p ON gp.publisher_id = p.id 
     JOIN game_platform gpl ON gp.id = gpl.game_publisher_id 
     JOIN platform pl ON gpl.platform_id = pl.id 
     WHERE p.publisher_name = 'Culture Brain' AND pl.platform_name = 'DS') AS difference;
```
-------------------------3506 sample_num
```sql
SELECT 
    (SUM(CASE WHEN gp.release_year = 2007 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage_2007
FROM 
    game_platform gp
JOIN 
    game_publisher gpub ON gp.game_publisher_id = gpub.id
JOIN 
    game g ON gpub.game_id = g.id
JOIN 
    platform p ON gp.platform_id = p.id
WHERE 
    p.platform_name = 'Wii';
```
-------------------------3507 sample_num
```sql
SELECT gp.platform_id
FROM region_sales rs
JOIN game_platform gp ON rs.game_platform_id = gp.id
JOIN region r ON rs.region_id = r.id
WHERE r.region_name = 'Europe'
GROUP BY gp.platform_id
HAVING SUM(rs.num_sales) < (SELECT AVG(num_sales) * 0.3 FROM region_sales);
```
-------------------------3508 sample_num
```sql
SELECT COUNT(*) 
FROM Author 
WHERE Affiliation = 'University of California Berkeley';
```
-------------------------3509 sample_num
```sql
SELECT Keyword 
FROM Paper 
WHERE Title = 'Stitching videos streamed by mobile phones in real-time';
```
-------------------------3510 sample_num
```sql
SELECT Title 
FROM Paper 
WHERE JournalId = (SELECT Id FROM Journal WHERE FullName = 'Concepts in Magnetic Resonance Part A') 
AND Year = 2008;
```
-------------------------3511 sample_num
```sql
SELECT COUNT(*) 
FROM Paper 
WHERE JournalId = (SELECT Id FROM Journal WHERE FullName = 'Concepts in Magnetic Resonance Part A');
```
-------------------------3512 sample_num
```sql
SELECT j.HomePage 
FROM Paper p 
JOIN Journal j ON p.JournalId = j.Id 
WHERE p.Title = 'Area Effects in Cepaea';
```
-------------------------3513 sample_num
```sql
SELECT COUNT(*) 
FROM Paper 
WHERE JournalId = (SELECT Id FROM Journal WHERE FullName = 'Molecular Brain') 
AND Year = 2011;
```
-------------------------3514 sample_num
```sql
SELECT COUNT(*) 
FROM Paper 
WHERE Year = 2011 AND JournalId = (SELECT Id FROM Journal WHERE ShortName = 'Mol Brain');
```
-------------------------3515 sample_num
```sql
SELECT COUNT(*) 
FROM PaperAuthor 
WHERE PaperId = (SELECT Id FROM Paper WHERE Title = 'Equation Solving in Geometrical Theories');
```
-------------------------3516 sample_num
```sql
SELECT pa.Name
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Title = 'Area Effects in Cepaea';
```
-------------------------3517 sample_num
```sql
SELECT COUNT(DISTINCT pa.AuthorId) AS AuthorCount
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Title = 'Stitching videos streamed by mobile phones in real-time'
AND pa.Affiliation = 'Cairo Microsoft Innovation Lab';
```
-------------------------3518 sample_num
```sql
SELECT p.Title
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.Name = 'Klaus Zimmermann';
```
-------------------------3519 sample_num
```sql
SELECT pa.Name 
FROM Paper p 
JOIN PaperAuthor pa ON p.Id = pa.PaperId 
WHERE p.Title = 'Incremental Extraction of Keyterms for Classifying Multilingual Documents in the Web' 
AND pa.Affiliation = 'National Taiwan University Department of Computer Science and Information Engineering Taiwan';
```
-------------------------3520 sample_num
```sql
SELECT p.Title 
FROM Paper p 
JOIN PaperAuthor pa ON p.Id = pa.PaperId 
WHERE p.Year = 1995 AND pa.Name = 'Thomas Wiegand';
```
-------------------------3521 sample_num
```sql
SELECT COUNT(*) 
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.Name = 'Thomas Wiegand' AND p.Year = 1995;
```
-------------------------3522 sample_num
```sql
SELECT AVG(PaperCount) AS AveragePapers
FROM (
    SELECT COUNT(P.Id) AS PaperCount
    FROM Paper P
    JOIN Journal J ON P.JournalId = J.Id
    WHERE J.FullName = 'Molecular Brain' AND P.Year BETWEEN 2008 AND 2011
    GROUP BY P.Year
) AS YearlyCounts;
```
-------------------------3523 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN j.FullName = 'Cases Journal' THEN p.Id END) - 
     COUNT(CASE WHEN j.FullName = 'Molecular Brain' THEN p.Id END)) * 100.0 / 
     NULLIF(COUNT(CASE WHEN j.FullName = 'Molecular Brain' THEN p.Id END), 0) AS PercentageDifference
FROM 
    Paper p
JOIN 
    Journal j ON p.JournalId = j.Id;
```
-------------------------3524 sample_num
```sql
SELECT COUNT(*) FROM Journal WHERE FullName LIKE '%computing%';
```
-------------------------3525 sample_num
```sql
SELECT PaperId, AuthorId 
FROM PaperAuthor 
WHERE Affiliation = 'Cairo Microsoft Innovation Lab';
```
-------------------------3526 sample_num
```sql
SELECT ShortName, FullName 
FROM Conference 
WHERE HomePage = 'http://www.informatik.uni-trier.de/~ley/db/conf/ices/index.html';
```
-------------------------3527 sample_num
```sql
SELECT Id FROM Author WHERE Name = 'Peter';
```
-------------------------3528 sample_num
```sql
SELECT Paper.Title, Conference.ShortName
FROM Paper
JOIN Conference ON Paper.ConferenceId = Conference.Id
WHERE Paper.ConferenceId BETWEEN 160 AND 170;
```
-------------------------3529 sample_num
```sql
SELECT p.Title, j.HomePage
FROM Paper p
JOIN Journal j ON p.JournalId = j.Id
WHERE p.Year = (SELECT MAX(Year) FROM Paper);
```
-------------------------3530 sample_num
```sql
SELECT p.Title, c.ShortName
FROM Paper p
JOIN Conference c ON p.ConferenceId = c.Id
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Author a ON pa.AuthorId = a.Id
WHERE p.Year = 1999 AND a.Name LIKE 'Philip%';
```
-------------------------3531 sample_num
```sql
SELECT COUNT(*) AS TotalPapers, c.HomePage
FROM Paper p
JOIN Conference c ON p.ConferenceId = c.Id
WHERE p.ConferenceId = 187 AND p.Year BETWEEN 1990 AND 2000;
```
-------------------------3532 sample_num
```sql
SELECT p.Title 
FROM Paper p 
JOIN PaperAuthor pa ON p.Id = pa.PaperId 
WHERE p.Year = 2003 
AND pa.Affiliation = 'Department of Network Science, Graduate School of Information Systems, The University of Electro-Communications';
```
-------------------------3533 sample_num
```sql
SELECT pa.Name AS AuthorName, j.ShortName AS JournalShortName
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Journal j ON p.JournalId = j.Id
WHERE p.Title LIKE '%chemiluminescence%' AND p.JournalId BETWEEN 245 AND 250;
```
-------------------------3534 sample_num
```sql
SELECT DISTINCT pa.Name, pa.Affiliation
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.ConferenceId = 0 AND p.JournalId < 100;
```
-------------------------3535 sample_num
```sql
SELECT p.Title, pa.AuthorId 
FROM Paper p 
JOIN PaperAuthor pa ON p.Id = pa.PaperId 
WHERE p.ConferenceId < 100 AND p.Year = 2006;
```
-------------------------3536 sample_num
```sql
SELECT p.Id
FROM Paper p
JOIN Conference c ON p.ConferenceId = c.Id
WHERE c.HomePage LIKE 'http://www.informatik.uni-trier.de/~ley/db/conf/%';
```
-------------------------3537 sample_num
```sql
SELECT j.HomePage, pa.AuthorId
FROM Paper p
JOIN Journal j ON p.JournalId = j.Id
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Year BETWEEN 2000 AND 2005 AND p.Title LIKE '%social%';
```
-------------------------3538 sample_num
```sql
SELECT pa.AuthorId, pa.Affiliation
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.JournalId = 0 AND p.Year = 2009;
```
-------------------------3539 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN ConferenceId = 0 THEN 1 END) * 100.0 / COUNT(*)) AS Percentage
FROM 
    Paper
WHERE 
    JournalId BETWEEN 200 AND 300 
    AND JournalId IN (SELECT Id FROM Journal WHERE ShortName LIKE 'A%');
```
-------------------------3540 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Year = 2001 THEN PaperId END) * 100.0 / COUNT(PaperId)) AS PaperPublishedRate
FROM 
    Paper
WHERE 
    Year BETWEEN 2001 AND 2010;
```
-------------------------3541 sample_num
```sql
SELECT FullName, HomePage FROM Conference WHERE ShortName = 'ICWE';
```
-------------------------3542 sample_num
```sql
SELECT Affiliation, COUNT(Id) AS AuthorCount
FROM Author
WHERE Affiliation IN ('Standford University', 'Massachusetts Institute of Technolgy')
GROUP BY Affiliation
ORDER BY AuthorCount DESC
LIMIT 1;
```
-------------------------3543 sample_num
```sql
SELECT 
    COUNT(CASE WHEN Affiliation IS NOT NULL THEN 1 END) AS WithAffiliation,
    COUNT(CASE WHEN Affiliation IS NULL THEN 1 END) AS WithoutAffiliation,
    COUNT(CASE WHEN Affiliation IS NOT NULL THEN 1 END) * 1.0 / NULLIF(COUNT(CASE WHEN Affiliation IS NULL THEN 1 END), 0) AS Ratio
FROM 
    Author;
```
-------------------------3544 sample_num
```sql
SELECT Id, Name 
FROM Author 
WHERE Affiliation = 'University of Oulu';
```
-------------------------3545 sample_num
```sql
SELECT p.Title, pa.Affiliation
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.Name = 'Roger J. Marshall' AND p.ConferenceId = 0 AND p.JournalId = 0;
```
-------------------------3546 sample_num
```sql
SELECT p.Id, p.Title, p.Year, j.FullName
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Journal j ON p.JournalId = j.Id
GROUP BY p.Id, p.Title, p.Year, j.FullName
HAVING COUNT(pa.AuthorId) = (
    SELECT MAX(author_count)
    FROM (
        SELECT COUNT(PaperId) AS author_count
        FROM PaperAuthor
        GROUP BY PaperId
    ) AS counts
);
```
-------------------------3547 sample_num
```sql
SELECT p.Title, p.Year, c.ShortName, GROUP_CONCAT(pa.Name SEPARATOR ', ') AS AuthorNames
FROM Paper p
JOIN Conference c ON p.ConferenceId = c.Id
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Id = 15
GROUP BY p.Id;
```
-------------------------3548 sample_num
```sql
SELECT p.Id AS PaperId, p.Year, p.Keyword
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.AuthorId < 1000 AND pa.Affiliation = 'Zurich, ETH';
```
-------------------------3549 sample_num
```sql
SELECT pa.AuthorId, pa.Name 
FROM Paper p 
JOIN PaperAuthor pa ON p.Id = pa.PaperId 
WHERE p.Title = 'Inspection resistant memory: Architectural support for security from physical examination' 
AND pa.Affiliation = 'Microsoft Research, USA';
```
-------------------------3550 sample_num
```sql
SELECT pa.Name AS AuthorName, pa.Affiliation AS AuthorAffiliation, j.ShortName AS JournalShortName, j.FullName AS JournalFullName
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Journal j ON p.JournalId = j.Id
WHERE p.Title = 'Decreased Saliva Secretion and Down-Regulation of AQP5 in Submandibular Gland in Irradiated Rats';
```
-------------------------3551 sample_num
```sql
SELECT p.Title, p.JournalId
FROM Paper p
JOIN Conference c ON p.ConferenceId = c.Id
WHERE c.FullName = 'International Symposium of Robotics Research';
```
-------------------------3552 sample_num
```sql
SELECT p.Title, p.Year, p.Keyword
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.AuthorId = 661002 AND pa.Affiliation = 'Scientific Computing and Imaging Institute, University of Utah, UT 84112, USA';
```
-------------------------3553 sample_num
```sql
SELECT 
    (SELECT COUNT(Paper.Id) 
     FROM Paper 
     JOIN Journal ON Paper.JournalId = Journal.Id 
     WHERE Journal.ShortName = 'IWC' AND Paper.Year = 2000) - 
    (SELECT COUNT(Paper.Id) 
     FROM Paper 
     JOIN Journal ON Paper.JournalId = Journal.Id 
     WHERE Journal.ShortName = 'IWC' AND Paper.Year = 2010) AS Difference;
```
-------------------------3554 sample_num
```sql
SELECT DISTINCT j.Id AS JournalId, j.ShortName, j.FullName
FROM Paper p
JOIN Journal j ON p.JournalId = j.Id
WHERE p.Year = 2013 AND j.Id != 0 AND j.Id != -1
LIMIT 4;
```
-------------------------3555 sample_num
```sql
WITH PaperCounts AS (
    SELECT 
        COUNT(CASE WHEN Year BETWEEN 1991 AND 2000 THEN Id END) AS Count_1991_2000,
        COUNT(CASE WHEN Year BETWEEN 1971 AND 1980 THEN Id END) AS Count_1971_1980
    FROM Paper
    WHERE ConferenceId = (SELECT Id FROM Conference WHERE ShortName = 'MICRO')
),
Papers_1971_1980 AS (
    SELECT 
        p.Title, 
        pa.Name AS AuthorName
    FROM Paper p
    JOIN PaperAuthor pa ON p.Id = pa.PaperId
    WHERE p.Year BETWEEN 1971 AND 1980 
    AND p.ConferenceId = (SELECT Id FROM Conference WHERE ShortName = 'MICRO')
)
SELECT 
    (Count_1991_2000 - Count_1971_1980) / 10 AS Average_Needed_Papers,
    Title,
    AuthorName
FROM PaperCounts, Papers_1971_1980;
```
-------------------------3556 sample_num
```sql
SELECT COUNT(*) AS PreprintedOrNotPublished
FROM Paper
WHERE Year = 0;
```
-------------------------3557 sample_num
```sql
SELECT c.FullName 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE p.Title = 'The Dissimilarity Representation as a Tool for Three-Way Data Classification: A 2D Measure';
```
-------------------------3558 sample_num
```sql
SELECT COALESCE(c.HomePage, j.HomePage) AS HomePage
FROM Paper p
LEFT JOIN Conference c ON p.ConferenceId = c.Id
LEFT JOIN Journal j ON p.JournalId = j.Id
WHERE p.Title = 'Energy-efficiency bounds for noise-tolerant dynamic circuits';
```
-------------------------3559 sample_num
```sql
SELECT DISTINCT pa.Name
FROM PaperAuthor pa
WHERE pa.PaperId BETWEEN 101 AND 105;
```
-------------------------3560 sample_num
```sql
SELECT c.ShortName
FROM Paper p
JOIN Conference c ON p.ConferenceId = c.Id
WHERE p.Year = 2009
LIMIT 10;
```
-------------------------3561 sample_num
```sql
SELECT j.HomePage 
FROM Paper p 
JOIN Journal j ON p.JournalId = j.Id 
WHERE p.Title = '364: Induction of Mixed Chimerism and Transplantation Tolerance in a Non-Human Primate Lung Allograft Model: Early Results';
```
-------------------------3562 sample_num
```sql
SELECT p.Title 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE c.FullName = 'International Conference on Internet Computing';
```
-------------------------3563 sample_num
```sql
SELECT pa.Name 
FROM Paper p 
JOIN PaperAuthor pa ON p.Id = pa.PaperId 
WHERE p.Year = '2005' 
AND p.Keyword = 'LOAD; IDE; SNP; haplotype; asso- ciation studies';
```
-------------------------3564 sample_num
```sql
SELECT COUNT(DISTINCT pa.AuthorId) AS AuthorCount
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Title LIKE '%145 GROWTH HORMONE RECEPTORS AND THE ONSET OF HYPERINSULINEMIA IN THE OBESE ZUCKER RAT:%';
```
-------------------------3565 sample_num
```sql
SELECT DISTINCT pa2.Name AS CoAuthor, p.Title
FROM PaperAuthor pa1
JOIN PaperAuthor pa2 ON pa1.PaperId = pa2.PaperId AND pa1.AuthorId <> pa2.AuthorId
JOIN Paper p ON pa1.PaperId = p.Id
WHERE pa1.Name = 'Jei Keon Chae';
```
-------------------------3566 sample_num
```sql
SELECT c.FullName AS ConferenceName, j.FullName AS JournalName, pa.Name AS CoAuthorName, p.Title
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Author a ON pa.AuthorId = a.Id
LEFT JOIN Conference c ON p.ConferenceId = c.Id
LEFT JOIN Journal j ON p.JournalId = j.Id
WHERE p.Id IN (
    SELECT pa.PaperId
    FROM PaperAuthor pa
    JOIN Author a ON pa.AuthorId = a.Id
    WHERE a.Name = 'Shueh-Lin Yau'
);
```
-------------------------3567 sample_num
```sql
SELECT COUNT(Id) FROM Paper WHERE Year BETWEEN 1990 AND 2000;
```
-------------------------3568 sample_num
```sql
SELECT Name FROM Author WHERE Affiliation = 'Birkbeck University of London';
```
-------------------------3569 sample_num
```sql
SELECT ShortName FROM Conference WHERE FullName LIKE 'International Symposium%';
```
-------------------------3570 sample_num
```sql
SELECT COUNT(*) FROM Journal WHERE HomePage = '';
```
-------------------------3571 sample_num
```sql
SELECT DISTINCT pa.Name
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Year = 0;
```
-------------------------3572 sample_num
```sql
SELECT DISTINCT pa.Affiliation
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Keyword = 'Quantum Physics';
```
-------------------------3573 sample_num
```sql
SELECT c.FullName, p.Title, p.Year
FROM Paper p
JOIN Conference c ON p.ConferenceId = c.Id
WHERE p.JournalId = 0 AND p.ConferenceId != 0 AND p.Year != 0;
```
-------------------------3574 sample_num
```sql
SELECT p.Title
FROM Paper p
JOIN Conference c ON p.ConferenceId = c.Id
WHERE c.HomePage IS NULL OR c.HomePage = '';
```
-------------------------3575 sample_num
```sql
SELECT DISTINCT FullName 
FROM Journal 
WHERE ShortName IS NULL OR ShortName = '';
```
-------------------------3576 sample_num
```sql
SELECT a.Affiliation 
FROM Author a
JOIN PaperAuthor pa ON a.Id = pa.AuthorId
JOIN Paper p ON pa.PaperId = p.Id
JOIN Journal j ON p.JournalId = j.Id
WHERE p.Title = 'A combined search for the standard model Higgs boson at s = 1.96 Â TeV';
```
-------------------------3577 sample_num
```sql
SELECT DISTINCT j.FullName
FROM Journal j
JOIN Paper p ON j.Id = p.JournalId
WHERE p.Year = 2001;
```
-------------------------3578 sample_num
```sql
SELECT DISTINCT pa.Name
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Title = 'Particle identification using the time-over-threshold method in the ATLAS Transition Radiation Tracker'
AND pa.Name <> (SELECT Name FROM PaperAuthor WHERE PaperId = p.Id LIMIT 1);
```
-------------------------3579 sample_num
```sql
SELECT COUNT(P.Id) AS PaperCount, P.Year
FROM Paper P
JOIN Conference C ON P.ConferenceId = C.Id
WHERE C.FullName = 'International Conference on Database Theory' AND P.Year != 0
GROUP BY P.Year;
```
-------------------------3580 sample_num
```sql
SELECT DISTINCT Journal.FullName
FROM Journal
JOIN Paper ON Journal.Id = Paper.JournalId
WHERE Paper.Keyword = 'Sustainability';
```
-------------------------3581 sample_num
```sql
SELECT DISTINCT pa.Name
FROM Paper p
JOIN Conference c ON p.ConferenceId = c.Id
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE c.FullName LIKE '%Workshop%';
```
-------------------------3582 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN pa.Affiliation LIKE '%INFN%' THEN 1 END) * 100.0) / COUNT(pa.AuthorId) AS Percentage
FROM 
    Paper p
JOIN 
    PaperAuthor pa ON p.Id = pa.PaperId
WHERE 
    p.Title LIKE '%Charged particle multiplicity%';
```
-------------------------3583 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN j.ShortName LIKE 'ANN%' THEN 1 END) * 100.0) / COUNT(*) AS Percentage
FROM 
    Journal j
JOIN 
    Paper p ON j.Id = p.JournalId
WHERE 
    p.Year = 1989;
```
-------------------------3584 sample_num
```sql
SELECT COUNT(DISTINCT pa.AuthorId) 
FROM PaperAuthor pa 
JOIN Paper p ON pa.PaperId = p.Id 
WHERE p.Id = 1 AND pa.Affiliation LIKE '%Microsoft Research%';
```
-------------------------3585 sample_num
```sql
SELECT Keyword, Year 
FROM Paper 
WHERE Title = 'A Formal Approach to Service Component Architecture';
```
-------------------------3586 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN ConferenceId = 0 AND JournalId = 0 AND Year > 2000 THEN 1 END) * 100.0) / COUNT(Id) AS PercentagePreprintedAfter2000
FROM 
    Paper;
```
-------------------------3587 sample_num
```sql
SELECT Name 
FROM PaperAuthor 
WHERE PaperId = (SELECT Id FROM Paper WHERE Title = 'Hypermethylation of the <I>TPEF/HPP1</I> Gene in Primary and Metastatic Colorectal Cancers');
```
-------------------------3588 sample_num
```sql
SELECT j.FullName 
FROM Paper p 
JOIN Journal j ON p.JournalId = j.Id 
WHERE p.Title = 'Multiple paternity in a natural population of a salamander with long-term sperm storage';
```
-------------------------3589 sample_num
```sql
SELECT COUNT(JournalId) 
FROM Paper 
WHERE JournalId = (SELECT Id FROM Journal WHERE FullName = 'Iet Software/iee Proceedings - Software');
```
-------------------------3590 sample_num
```sql
SELECT c.FullName 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE p.Id = 5;
```
-------------------------3591 sample_num
```sql
SELECT p.Title 
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.Name LIKE '%Jun du%'
LIMIT 2;
```
-------------------------3592 sample_num
```sql
SELECT p.Title
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Author a ON pa.AuthorId = a.Id
WHERE a.Name = 'Cheng Huang' AND a.Affiliation LIKE 'Microsoft %';
```
-------------------------3593 sample_num
```sql
SELECT c.FullName
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Conference c ON p.ConferenceId = c.Id
WHERE pa.Name = 'Jean-luc Hainaut';
```
-------------------------3594 sample_num
```sql
SELECT DISTINCT j.FullName
FROM Journal j
JOIN Paper p ON j.Id = p.JournalId
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.Name = 'Andrew Cain'
LIMIT 3;
```
-------------------------3595 sample_num
```sql
SELECT DISTINCT a.Affiliation
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Author a ON pa.AuthorId = a.Id
WHERE p.Title = 'FIBER: A Generalized Framework for Auto-tuning Software';
```
-------------------------3596 sample_num
```sql
SELECT p.Title, j.FullName
FROM Paper p
JOIN Journal j ON p.JournalId = j.Id
WHERE p.Year = 0
LIMIT 2;
```
-------------------------3597 sample_num
```sql
SELECT DISTINCT j.ShortName, j.FullName
FROM Journal j
JOIN Paper p ON j.Id = p.JournalId
WHERE p.Keyword = 'Materials';
```
-------------------------3598 sample_num
```sql
SELECT DISTINCT Name 
FROM Author 
WHERE Affiliation = 'University of Oxford' 
ORDER BY Name;
```
-------------------------3599 sample_num
```sql
SELECT ShortName, HomePage 
FROM Conference 
WHERE FullName LIKE 'International Conference on Artificial Intelligence%';
```
-------------------------3600 sample_num
```sql
SELECT Title FROM Paper WHERE Year = 1996;
```
-------------------------3601 sample_num
```sql
SELECT p.Title, pa.Name
FROM Paper p
JOIN Journal j ON p.JournalId = j.Id
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Year = 2007 AND j.FullName = 'Neoplasia';
```
-------------------------3602 sample_num
```sql
SELECT a.Name, p.Title
FROM Author a
JOIN PaperAuthor pa ON a.Id = pa.AuthorId
JOIN Paper p ON pa.PaperId = p.Id
WHERE a.Affiliation = 'Soongsil University' AND p.Year = 2000;
```
-------------------------3603 sample_num
```sql
SELECT p.Title, pa.Name
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Year BETWEEN 2000 AND 2005
AND p.Keyword LIKE '%optical properties%';
```
-------------------------3604 sample_num
```sql
SELECT AVG(PaperCount) AS AveragePapers
FROM (
    SELECT YEAR(P.Year) AS Year, COUNT(P.Id) AS PaperCount
    FROM Paper P
    JOIN Conference C ON P.ConferenceId = C.Id
    WHERE C.FullName = 'World Computer Congress'
    GROUP BY YEAR(P.Year)
) AS YearlyPapers;
```
-------------------------3605 sample_num
```sql
SELECT p.Title, pa.Name
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Year = 1997 AND p.ConferenceId = 0 AND p.JournalId = 0;
```
-------------------------3606 sample_num
```sql
SELECT p.Title, j.FullName
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Journal j ON p.JournalId = j.Id
WHERE pa.Name = 'Adam Jones' AND p.Year BETWEEN 2005 AND 2010;
```
-------------------------3607 sample_num
```sql
SELECT COUNT(*) 
FROM Author 
WHERE Affiliation = 'Otterbein University';
```
-------------------------3608 sample_num
```sql
SELECT COUNT(*) 
FROM PaperAuthor 
WHERE PaperId = (SELECT Id FROM Paper WHERE Title = 'Subcellular localization of nuclease in barley aleurone');
```
-------------------------3609 sample_num
```sql
SELECT c.FullName 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE p.Title = 'Extended Fuzzy Regression Models';
```
-------------------------3610 sample_num
```sql
SELECT COUNT(*) 
FROM Paper 
WHERE ConferenceId = (SELECT Id FROM Conference WHERE FullName = 'Mathematics of Program Construction');
```
-------------------------3611 sample_num
```sql
SELECT Name 
FROM PaperAuthor 
WHERE PaperId = (SELECT Id FROM Paper WHERE Title = 'Open Sourcing Social Solutions (Building Communities of Change)');
```
-------------------------3612 sample_num
```sql
SELECT p.Title 
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.Name = 'Jianli Hua';
```
-------------------------3613 sample_num
```sql
SELECT Name FROM PaperAuthor WHERE PaperId = (SELECT Id FROM Paper WHERE Title = 'Testing timed automata');
```
-------------------------3614 sample_num
```sql
SELECT COUNT(Paper.Id) 
FROM Paper 
JOIN Conference ON Paper.ConferenceId = Conference.Id 
WHERE Paper.Year = 2000 AND Conference.ShortName = 'SSPR';
```
-------------------------3615 sample_num
```sql
SELECT p.Title 
FROM Paper p 
JOIN Journal j ON p.JournalId = j.Id 
WHERE j.FullName = 'Theoretical Computer Science' AND p.Year = 2003;
```
-------------------------3616 sample_num
```sql
SELECT c.HomePage 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE p.Title = 'Quality evaluation of long duration audiovisual content';
```
-------------------------3617 sample_num
```sql
SELECT DISTINCT Name 
FROM PaperAuthor 
WHERE PaperId = (SELECT Id FROM Paper WHERE Title = 'A Randomized Comparison of Sirolimus- Versus Paclitaxel-Eluting Stent Implantation in Patients With Diabetes Mellitus') 
AND Affiliation = 'Asan Medical Center, University of Ulsan College of Medicine, Seoul, Korea';
```
-------------------------3618 sample_num
```sql
SELECT COUNT(*) 
FROM Paper 
WHERE JournalId = (SELECT Id FROM Journal WHERE FullName = 'Software - Practice and Experience');
```
-------------------------3619 sample_num
```sql
SELECT Paper.Title
FROM Paper
JOIN Conference ON Paper.ConferenceId = Conference.Id
WHERE Conference.HomePage = 'http://www.irma-international.org/';
```
-------------------------3620 sample_num
```sql
SELECT COUNT(P.Id) / 9.0 AS AveragePapers
FROM Paper P
JOIN Conference C ON P.ConferenceId = C.Id
WHERE P.Year BETWEEN 2002 AND 2010
AND C.FullName = 'Information and Knowledge Engineering';
```
-------------------------3621 sample_num
```sql
SELECT 
    (SELECT COUNT(Paper.Id) 
     FROM Paper 
     JOIN Conference ON Paper.ConferenceId = Conference.Id 
     WHERE Conference.FullName = 'International Conference on Supercomputing' 
     AND Paper.Year BETWEEN 1991 AND 2000) - 
    (SELECT COUNT(Paper.Id) 
     FROM Paper 
     JOIN Conference ON Paper.ConferenceId = Conference.Id 
     WHERE Conference.FullName = 'Informatik & Schule' 
     AND Paper.Year BETWEEN 1991 AND 2000) AS Difference;
```
-------------------------3622 sample_num
```sql
SELECT ShortName FROM Conference WHERE FullName = 'Software - Concepts and Tools / Structured Programming';
```
-------------------------3623 sample_num
```sql
SELECT j.FullName 
FROM Paper p 
JOIN Journal j ON p.JournalId = j.Id 
WHERE p.Title = 'Education, democracy and growth';
```
-------------------------3624 sample_num
```sql
SELECT COUNT(Paper.Id) 
FROM Paper 
JOIN Journal ON Paper.JournalId = Journal.Id 
WHERE Journal.FullName = 'IEEE Transactions on Nuclear Science' AND Paper.Year = '1999';
```
-------------------------3625 sample_num
```sql
SELECT p.Title 
FROM Paper p 
JOIN Journal j ON p.JournalId = j.Id 
WHERE j.FullName = 'IEEE Transactions on Pattern Analysis and Machine Intelligence' 
AND p.Year = '2011';
```
-------------------------3626 sample_num
```sql
SELECT Keyword 
FROM Paper 
WHERE JournalId = (SELECT Id FROM Journal WHERE FullName = 'Modeling Identification and Control') 
AND Year = 1994;
```
-------------------------3627 sample_num
```sql
SELECT CASE WHEN p.Year = 0 THEN 'Yes' ELSE 'No' END AS IsPreprint
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Author a ON pa.AuthorId = a.Id
WHERE a.Name = 'Zvezdan Protić';
```
-------------------------3628 sample_num
```sql
SELECT c.FullName 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE p.Title = 'Skew-Circulant Preconditioners for Systems of LMF-Based ODE Codes';
```
-------------------------3629 sample_num
```sql
SELECT COUNT(*) 
FROM Paper 
WHERE ConferenceId = (SELECT Id FROM Conference WHERE FullName = 'International Symposium on Software Testing and Analysis');
```
-------------------------3630 sample_num
```sql
SELECT c.HomePage 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE p.Title = 'Increasing the Concurrency in Estelle';
```
-------------------------3631 sample_num
```sql
SELECT COUNT(DISTINCT AuthorId) AS NumberOfAuthors
FROM PaperAuthor
WHERE PaperId = (SELECT Id FROM Paper WHERE Title = 'An Improved Active Suspension Model for Attitude Control of Electric Vehicles');
```
-------------------------3632 sample_num
```sql
SELECT c.ShortName
FROM Paper p
JOIN Conference c ON p.ConferenceId = c.Id
WHERE p.Year = 2012
GROUP BY c.ShortName
ORDER BY COUNT(p.Id) DESC
LIMIT 1;
```
-------------------------3633 sample_num
```sql
SELECT COUNT(*) 
FROM Paper 
WHERE ConferenceId = (SELECT Id FROM Conference WHERE ShortName = 'ECSQARU') 
AND Year = '2003';
```
-------------------------3634 sample_num
```sql
SELECT p.Keyword 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE c.FullName = 'International Radar Symposium' AND p.Year = '2012';
```
-------------------------3635 sample_num
```sql
SELECT 
    (SELECT COUNT(Paper.Id) 
     FROM Paper 
     JOIN Conference ON Paper.ConferenceId = Conference.Id 
     WHERE Conference.FullName = 'International Conference on Thermoelectrics') * 1.0 /
    (SELECT COUNT(Paper.Id) 
     FROM Paper 
     JOIN Conference ON Paper.ConferenceId = Conference.Id 
     WHERE Conference.FullName = 'International Conference on Wireless Networks, Communications and Mobile Computing') AS Ratio;
```
-------------------------3636 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.Year = 0 THEN 1 END) * 100.0 / COUNT(*)) AS PreprintPercentage
FROM 
    Paper p
JOIN 
    PaperAuthor pa ON p.Id = pa.PaperId
WHERE 
    pa.Name = 'John Van Reenen';
```
-------------------------3637 sample_num
```sql
SELECT Title 
FROM Paper 
WHERE Year = (SELECT MIN(Year) FROM Paper);
```
-------------------------3638 sample_num
```sql
SELECT FullName 
FROM Conference 
ORDER BY LENGTH(FullName) DESC 
LIMIT 1;
```
-------------------------3639 sample_num
```sql
SELECT COUNT(*) 
FROM Author 
WHERE Affiliation = 'NASA Langley Research Center';
```
-------------------------3640 sample_num
```sql
SELECT COUNT(*) FROM Journal WHERE ShortName IS NULL;
```
-------------------------3641 sample_num
```sql
SELECT COUNT(*) AS PreprintCount FROM Paper WHERE Year = 0;
```
-------------------------3642 sample_num
```sql
SELECT p.Title
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
GROUP BY p.Id, p.Title
ORDER BY COUNT(pa.AuthorId) DESC
LIMIT 1;
```
-------------------------3643 sample_num
```sql
SELECT Title, Year 
FROM Paper 
WHERE JournalId = (SELECT Id FROM Journal WHERE ShortName = 'TUBERCLE LUNG DIS') 
ORDER BY Year ASC 
LIMIT 1;
```
-------------------------3644 sample_num
```sql
SELECT p.Title 
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
JOIN Author a ON pa.AuthorId = a.Id
WHERE a.Name = 'Karin Rengefors';
```
-------------------------3645 sample_num
```sql
SELECT COUNT(*) 
FROM Paper 
WHERE ConferenceId = (SELECT Id FROM Conference WHERE FullName = 'Virtual Reality, IEEE Annual International Symposium') 
AND Year = 2012;
```
-------------------------3646 sample_num
```sql
SELECT j.ShortName 
FROM Paper p 
JOIN Journal j ON p.JournalId = j.Id 
WHERE p.Title = 'A Case of Unilateral Ashy Dermatosis';
```
-------------------------3647 sample_num
```sql
SELECT DISTINCT Affiliation FROM Author WHERE Name = 'Mark A. Musen'
UNION
SELECT DISTINCT Affiliation FROM PaperAuthor WHERE Name = 'Mark A. Musen';
```
-------------------------3648 sample_num
```sql
SELECT pa.Name, pa.Affiliation
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE p.Title = 'Determination of Planetary Meteorology from Aerobot Flight Sensors';
```
-------------------------3649 sample_num
```sql
SELECT Title, j.FullName AS Journal
FROM Paper p
JOIN Journal j ON p.JournalId = j.Id
WHERE p.Year BETWEEN 1960 AND 1969;
```
-------------------------3650 sample_num
```sql
SELECT Year
FROM Paper
WHERE ConferenceId = (SELECT Id FROM Conference WHERE FullName = 'Internet, Multimedia Systems and Applications')
GROUP BY Year
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------3651 sample_num
```sql
SELECT DISTINCT Name FROM PaperAuthor WHERE AuthorId IN (SELECT Id FROM Author WHERE Name = 'Randall Davis');
```
-------------------------3652 sample_num
```sql
SELECT DISTINCT c.FullName
FROM Conference c
JOIN Paper p ON c.Id = p.ConferenceId
WHERE p.Year = 2008;
```
-------------------------3653 sample_num
```sql
SELECT j.HomePage
FROM Journal j
JOIN Paper p ON j.Id = p.JournalId
GROUP BY j.Id, j.HomePage
ORDER BY COUNT(p.Id) DESC
LIMIT 1;
```
-------------------------3654 sample_num
```sql
SELECT 
    a.Name, 
    a.Affiliation, 
    (SELECT COUNT(*) FROM Paper WHERE Keyword = 'cancer') * 1.0 / COUNT(*) AS Proportion
FROM 
    Author a
JOIN 
    PaperAuthor pa ON a.Id = pa.AuthorId
JOIN 
    Paper p ON pa.PaperId = p.Id
GROUP BY 
    a.Name, a.Affiliation;
```
-------------------------3655 sample_num
```sql
SELECT Name FROM Author WHERE Id = 1722;
```
-------------------------3656 sample_num
```sql
SELECT COUNT(*) AS PreprintOrNotPublished
FROM Paper
WHERE Year = 0;
```
-------------------------3657 sample_num
```sql
SELECT Name FROM Author WHERE Affiliation = 'University of Illinois Chicago';
```
-------------------------3658 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM Paper WHERE Year = 2005) - 
    (SELECT COUNT(*) FROM Paper WHERE Year = 2004) AS Difference
```
-------------------------3659 sample_num
```sql
SELECT p.Title 
FROM Paper p 
JOIN Journal j ON p.JournalId = j.Id 
WHERE j.FullName = 'Ibm Journal of Research and Development';
```
-------------------------3660 sample_num
```sql
SELECT pa.Name, pa.Affiliation 
FROM Paper p 
JOIN PaperAuthor pa ON p.Id = pa.PaperId 
WHERE p.Title = 'Education, democracy and growth';
```
-------------------------3661 sample_num
```sql
SELECT COUNT(DISTINCT PaperAuthor.Name) 
FROM PaperAuthor 
JOIN Paper ON PaperAuthor.PaperId = Paper.Id 
JOIN Journal ON Paper.JournalId = Journal.Id 
WHERE Journal.FullName = 'IEEE Computer';
```
-------------------------3662 sample_num
```sql
SELECT c.FullName 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE p.Title = 'A context-based navigation paradigm for accessing Web data';
```
-------------------------3663 sample_num
```sql
SELECT COUNT(*) 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE c.FullName = 'International Workshop on Inductive Logic Programming' 
AND p.Year BETWEEN 2001 AND 2009;
```
-------------------------3664 sample_num
```sql
SELECT AVG(AuthorCount) AS AverageAuthors
FROM (
    SELECT P.Id, COUNT(PA.AuthorId) AS AuthorCount
    FROM Paper P
    JOIN PaperAuthor PA ON P.Id = PA.PaperId
    WHERE P.Year BETWEEN 1990 AND 2000
    GROUP BY P.Id
) AS AuthorCounts;
```
-------------------------3665 sample_num
```sql
SELECT p.Year, j.FullName
FROM Paper p
JOIN Journal j ON p.JournalId = j.Id
WHERE p.Title = 'Area Effects in Cepaea';
```
-------------------------3666 sample_num
```sql
SELECT a.Name 
FROM Author a 
JOIN PaperAuthor pa ON a.Id = pa.AuthorId 
JOIN Paper p ON pa.PaperId = p.Id 
WHERE p.Title = 'Real-Time Automata';
```
-------------------------3667 sample_num
```sql
SELECT Name FROM Author WHERE Affiliation = 'ABB Electrical Machines';
```
-------------------------3668 sample_num
```sql
SELECT COUNT(*) 
FROM Paper 
WHERE JournalId = (SELECT Id FROM Journal WHERE FullName = 'Academic Medicine') 
AND Year BETWEEN 2005 AND 2010;
```
-------------------------3669 sample_num
```sql
SELECT p.Title 
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.Name = 'Zuliang Du'
AND p.Year = (SELECT MAX(Year) FROM Paper p2 
              JOIN PaperAuthor pa2 ON p2.Id = pa2.PaperId 
              WHERE pa2.Name = 'Zuliang Du');
```
-------------------------3670 sample_num
```sql
SELECT COUNT(*) 
FROM Paper 
WHERE ConferenceId IN (SELECT Id FROM Conference WHERE FullName = 'Adaptive Multimedia Retrieval') 
AND Year = 2007;
```
-------------------------3671 sample_num
```sql
SELECT AVG(PaperCount) AS AveragePapersPerYear
FROM (
    SELECT YEAR, COUNT(*) AS PaperCount
    FROM Paper
    WHERE JournalId = (SELECT Id FROM Journal WHERE FullName = 'Information Sciences')
    GROUP BY YEAR
) AS AnnualPapers;
```
-------------------------3672 sample_num
```sql
SELECT COUNT(*) 
FROM PaperAuthor 
WHERE Name = 'Howard F. Lipson';
```
-------------------------3673 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.Keyword = 'Turbulent Fluids' AND j.FullName = 'Physics of Fluids' THEN 1 END) * 100.0) / 
    NULLIF(COUNT(CASE WHEN p.Keyword = 'Turbulent Fluids' THEN 1 END), 0) AS percentage
FROM 
    Paper p
LEFT JOIN 
    Journal j ON p.JournalId = j.Id;
```
-------------------------3674 sample_num
```sql
SELECT COUNT(*) 
FROM Author 
WHERE Affiliation = 'Arizona State University';
```
-------------------------3675 sample_num
```sql
SELECT FullName, HomePage FROM Conference WHERE ShortName = 'ICCI';
```
-------------------------3676 sample_num
```sql
SELECT p.Title 
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.Name = 'Joe Lograsso';
```
-------------------------3677 sample_num
```sql
SELECT COUNT(DISTINCT p.Id) AS PaperCount
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.Affiliation = 'University of Hong Kong';
```
-------------------------3678 sample_num
```sql
SELECT p.Year, p.Title
FROM Paper p
JOIN PaperAuthor pa ON p.Id = pa.PaperId
WHERE pa.Name = 'Barrasa';
```
-------------------------3679 sample_num
```sql
SELECT pa.Name, p.Year 
FROM Paper p 
JOIN PaperAuthor pa ON p.Id = pa.PaperId 
WHERE p.Id = 2;
```
-------------------------3680 sample_num
```sql
SELECT pa.Name, p.Keyword 
FROM Paper p 
JOIN PaperAuthor pa ON p.Id = pa.PaperId 
WHERE p.Id = 5;
```
-------------------------3681 sample_num
```sql
SELECT c.FullName 
FROM Paper p 
JOIN Conference c ON p.ConferenceId = c.Id 
WHERE p.Title = '2004 YD5';
```
-------------------------3682 sample_num
```sql
SELECT id.chronname
FROM institution_details id
JOIN institution_grads ig ON id.unitid = ig.unitid
WHERE ig.year = '2007' AND ig.race = 'Ai'
GROUP BY id.chronname
HAVING COUNT(ig.race) = (
    SELECT MAX(american_indian_count)
    FROM (
        SELECT COUNT(ig_inner.race) AS american_indian_count
        FROM institution_grads ig_inner
        WHERE ig_inner.year = '2007' AND ig_inner.race = 'Ai'
        GROUP BY ig_inner.unitid
    ) AS counts
);
```
-------------------------3683 sample_num
```sql
SELECT id.chronname, id.site
FROM institution_details id
JOIN institution_grads ig ON id.unitid = ig.unitid
WHERE ig.grad_cohort = 209 AND ig.year = '2011';
```
-------------------------3684 sample_num
```sql
SELECT SUM(grad_cohort) AS female_graduates
FROM institution_grads
WHERE gender = 'F'
  AND year BETWEEN 2011 AND 2013
  AND unitid = (SELECT unitid FROM institution_details WHERE chronname = 'Gateway Community College');
```
-------------------------3685 sample_num
```sql
SELECT SUM(ig.grad_cohort) AS total_male_graduates
FROM institution_grads ig
JOIN institution_details id ON ig.unitid = id.unitid
WHERE ig.gender = 'M' 
  AND ig.year = 2012 
  AND id.state = (
      SELECT id2.state
      FROM institution_details id2
      WHERE id2.aid_value = (
          SELECT MAX(aid_value)
          FROM institution_details
      )
  );
```
-------------------------3686 sample_num
```sql
SELECT AVG(id.med_sat_value) AS average_median_sat
FROM institution_details id
JOIN state_sector_grads ssg ON id.unitid = ssg.stateid
WHERE ssg.year = 2013 AND ssg.gender = 'M'
GROUP BY ssg.state
ORDER BY COUNT(ssg.grad_cohort) DESC
LIMIT 1;
```
-------------------------3687 sample_num
```sql
SELECT state, chronname
FROM institution_details
WHERE control = 'Private for-profit' AND unitid IN (
    SELECT unitid
    FROM institution_grads
    WHERE year = 2012
    GROUP BY unitid
    HAVING SUM(grad_cohort) = (
        SELECT MAX(total_grad_cohort)
        FROM (
            SELECT SUM(grad_cohort) AS total_grad_cohort
            FROM institution_grads
            WHERE year = 2012 AND unitid IN (
                SELECT unitid
                FROM institution_details
                WHERE control = 'Private for-profit'
            )
            GROUP BY unitid
        ) AS cohort_totals
    )
)
ORDER BY chronname;
```
-------------------------3688 sample_num
```sql
SELECT chronname 
FROM institution_details 
WHERE control = 'Public' 
AND unitid IN (
    SELECT unitid 
    FROM institution_grads 
    WHERE year = 2013 
    GROUP BY unitid 
    ORDER BY MIN(grad_cohort) 
    LIMIT 1
);
```
-------------------------3689 sample_num
```sql
SELECT id.chronname, id.fte_value
FROM institution_details id
JOIN institution_grads ig ON id.unitid = ig.unitid
WHERE ig.year = 2013 AND ig.grad_cohort < 200 AND ig.race = 'X' AND ig.gender = 'B';
```
-------------------------3690 sample_num
```sql
SELECT SUM(grad_cohort) AS female_graduates
FROM institution_grads
WHERE unitid = (SELECT unitid FROM institution_details WHERE chronname = 'Oakwood University')
  AND year = 2013
  AND gender = 'F'
  AND race = 'X';
```
-------------------------3691 sample_num
```sql
SELECT COUNT(*) 
FROM institution_grads ig 
JOIN institution_details id ON ig.unitid = id.unitid 
WHERE ig.year = 2012 
  AND ig.gender = 'F' 
  AND ig.race = 'A' 
  AND ig.cohort = '4y other' 
  AND id.chronname = 'University of Alaska at Anchorage';
```
-------------------------3692 sample_num
```sql
SELECT year, grad_cohort
FROM institution_grads
WHERE unitid = (SELECT unitid FROM institution_details WHERE chronname = 'Auburn University')
  AND gender = 'B'
  AND race = 'X'
  AND cohort IN ('4y other', '4y bach')
  AND year IN (2011, 2012, 2013);
```
-------------------------3693 sample_num
```sql
SELECT 
    (SUM(CASE WHEN race = 'B' THEN 1 ELSE 0 END) * 100.0) / NULLIF(SUM(grad_cohort), 0) AS percentage_black_students
FROM 
    institution_grads
WHERE 
    unitid IN (SELECT unitid FROM institution_details WHERE control = 'Private for-profit');
```
-------------------------3694 sample_num
```sql
SELECT 
    (SUM(CASE WHEN race = 'A' THEN grad_cohort ELSE 0 END) * 100.0) / 
    SUM(grad_cohort) AS percentage_asian_grads
FROM 
    institution_grads ig
JOIN 
    institution_details id ON ig.unitid = id.unitid
WHERE 
    id.state = 'Alabama' 
    AND ig.year = 2013 
    AND ig.grad_100 = 1;
```
-------------------------3695 sample_num
```sql
SELECT 
    (SUM(CASE WHEN gender = 'M' AND race = 'A' THEN grad_cohort ELSE 0 END) * 1.0) / 
    NULLIF(SUM(CASE WHEN gender = 'F' AND race = 'A' THEN grad_cohort ELSE 0 END), 0) AS ratio
FROM 
    institution_grads ig
JOIN 
    institution_details id ON ig.unitid = id.unitid
WHERE 
    id.chronname = 'Harvard University' AND 
    ig.year = 2013;
```
-------------------------3696 sample_num
```sql
SELECT chronname, MIN(grad_100_value) AS min_grad_100_value
FROM institution_details
WHERE chronname IN ('Amridge University', 'Auburn University')
GROUP BY chronname;
```
-------------------------3697 sample_num
```sql
SELECT COUNT(*) 
FROM institution_details 
WHERE control = 'Private not-for-profit';
```
-------------------------3698 sample_num
```sql
SELECT SUM(grad_100) AS total_hispanic_male_grads
FROM institution_grads ig
JOIN institution_details id ON ig.unitid = id.unitid
WHERE id.chronname = 'Amridge University' AND ig.gender = 'M' AND ig.race = 'H';
```
-------------------------3699 sample_num
```sql
SELECT SUM(grad_cohort) AS total_graduates
FROM institution_grads ig
JOIN institution_details id ON ig.unitid = id.unitid
WHERE id.chronname = 'Lincoln College' 
  AND ig.year = 2011 
  AND ig.cohort = '4y bach';
```
-------------------------3700 sample_num
```sql
SELECT SUM(grad_100) AS male_hispanic_grads
FROM institution_grads ig
JOIN institution_details id ON ig.unitid = id.unitid
WHERE id.chronname = 'Central Alabama Community College'
  AND ig.year = 2011
  AND ig.gender = 'M'
  AND ig.race = 'H';
```
-------------------------3701 sample_num
```sql
SELECT SUM(grad_100) AS total_graduates
FROM institution_grads
WHERE unitid = (SELECT unitid FROM institution_details WHERE chronname = 'Central Alabama Community College')
AND year = 2011;
```
-------------------------3702 sample_num
```sql
SELECT 
    SUM(CASE WHEN gender = 'F' AND race = 'w' THEN grad_150 ELSE 0 END) AS female,
    SUM(CASE WHEN gender = 'M' AND race = 'w' THEN grad_150 ELSE 0 END) AS male
FROM 
    institution_grads
WHERE 
    unitid = (SELECT unitid FROM institution_details WHERE chronname = 'Central Alabama Community College') 
    AND year = 2011;
```
-------------------------3703 sample_num
```sql
SELECT id.chronname, MAX(ig.grad_150_rate) AS max_grad_150_rate
FROM institution_details id
JOIN institution_grads ig ON id.unitid = ig.unitid
WHERE ig.year = 2011 AND ig.gender = 'M' AND ig.race = 'w'
GROUP BY id.chronname
ORDER BY max_grad_150_rate DESC
LIMIT 1;
```
-------------------------3704 sample_num
```sql
SELECT id.chronname
FROM institution_details id
JOIN institution_grads ig ON id.unitid = ig.unitid
WHERE ig.gender = 'M' 
  AND ig.race = 'w' 
  AND ig.year = 2011 
  AND ig.grad_150 > 20;
```
-------------------------3705 sample_num
```sql
SELECT SUM(grad_cohort) AS total_graduates
FROM institution_grads
WHERE cohort = '2y all' AND state = 'Alabama' AND year = 2011;
```
-------------------------3706 sample_num
```sql
SELECT 
    (SUM(CASE WHEN year = 2012 THEN grad_cohort ELSE 0 END) - 
     SUM(CASE WHEN year = 2011 THEN grad_cohort ELSE 0 END)) AS difference
FROM 
    institution_grads
WHERE 
    unitid = (SELECT unitid FROM institution_details WHERE chronname = 'Central Alabama Community College');
```
-------------------------3707 sample_num
```sql
SELECT COUNT(DISTINCT id.unitid) 
FROM institution_details id 
JOIN institution_grads ig ON id.unitid = ig.unitid 
WHERE id.state = 'Alabama' 
  AND id.med_sat_percentile = 77 
  AND ig.year = 2011 
  AND ig.grad_cohort > 500;
```
-------------------------3708 sample_num
```sql
SELECT COUNT(*) 
FROM institution_grads ig 
JOIN institution_details id ON ig.unitid = id.unitid 
WHERE id.state = 'Alabama' 
AND id.control = 'Public' 
AND ig.year = 2011 
AND ig.grad_100 > 30;
```
-------------------------3709 sample_num
```sql
SELECT id.chronname
FROM institution_details id
JOIN institution_grads ig ON id.unitid = ig.unitid
WHERE id.state = 'Alabama' AND ig.year = 2011 AND ig.grad_cohort > 500 AND ig.race = 'X';
```
-------------------------3710 sample_num
```sql
SELECT AVG(grad_cohort) AS average_graduates
FROM institution_grads
WHERE unitid = (SELECT unitid FROM institution_details WHERE chronname = 'Central Alabama Community College')
AND year IN (2011, 2012, 2013;
```
-------------------------3711 sample_num
```sql
SELECT AVG(grad_100_rate) AS average_grad_100_rate
FROM institution_grads
WHERE unitid = (SELECT unitid FROM institution_details WHERE chronname = 'Central Alabama Community College');
```
-------------------------3712 sample_num
```sql
SELECT site FROM institution_details WHERE chronname = 'Swarthmore College';
```
-------------------------3713 sample_num
```sql
SELECT state 
FROM institution_details 
WHERE chronname = 'Mercer University';
```
-------------------------3714 sample_num
```sql
SELECT city 
FROM institution_details 
WHERE chronname = 'Rensselaer Polytechnic Institute';
```
-------------------------3715 sample_num
```sql
SELECT state_abbr FROM state_sector_details WHERE state = 'Delaware';
```
-------------------------3716 sample_num
```sql
SELECT COUNT(*) 
FROM institution_details 
WHERE level = '2-year' AND control = 'public' AND state = 'California';
```
-------------------------3717 sample_num
```sql
SELECT state_post FROM state_sector_details WHERE state = 'Idaho';
```
-------------------------3718 sample_num
```sql
SELECT chronname 
FROM institution_details 
WHERE state = 'NJ' AND level = '4-year' 
ORDER BY student_count DESC 
LIMIT 1;
```
-------------------------3719 sample_num
```sql
SELECT site 
FROM institution_details 
WHERE state = 'PA' 
ORDER BY lat_y DESC 
LIMIT 1;
```
-------------------------3720 sample_num
```sql
SELECT COUNT(*) 
FROM institution_details 
WHERE level = '4-year' 
  AND control = 'Public' 
  AND state_abbr = 'UT' 
  AND awards_per_value > (SELECT AVG(awards_per_value) FROM institution_details WHERE state_abbr = 'UT');
```
-------------------------3721 sample_num
```sql
SELECT COUNT(*) 
FROM institution_details 
WHERE level = '2-year' 
  AND control = 'Private not-for-profit' 
  AND state = 'CT' 
  AND awards_per_value < (SELECT AVG(awards_per_value) FROM institution_details WHERE state = 'CT');
```
-------------------------3722 sample_num
```sql
SELECT chronname 
FROM institution_details 
WHERE level = '4-year' AND control = 'Public' AND state = 'ID' 
ORDER BY grad_100_value ASC 
LIMIT 1;
```
-------------------------3723 sample_num
```sql
SELECT unitid 
FROM institution_details 
WHERE level = '4-year' 
  AND control = 'Private for-profit' 
  AND state = 'KY' 
ORDER BY grad_150_value DESC 
LIMIT 1;
```
-------------------------3724 sample_num
```sql
SELECT SUM(grad_100) AS female_hispanic_grads
FROM institution_grads ig
JOIN institution_details id ON ig.unitid = id.unitid
WHERE id.chronname = 'Pennsylvania State University-Altoona'
  AND ig.gender = 'F'
  AND ig.race = 'H'
  AND ig.grad_100 = 1;
```
-------------------------3725 sample_num
```sql
SELECT cohort
FROM institution_details
WHERE cohort_size = (SELECT MAX(cohort_size) FROM institution_details);
```
-------------------------3726 sample_num
```sql
SELECT COUNT(*) 
FROM institution_details 
WHERE level = '4-year' 
AND control = 'Private not-for-profit' 
AND state = (SELECT state FROM institution_details WHERE chronname = 'Brevard Community College');
```
-------------------------3727 sample_num
```sql
SELECT SUM(grad_cohort) AS total_graduated_students
FROM state_sector_grads
WHERE level = '2-year' AND control = 'Public' AND state = 'Alabama' AND year = '2011' AND race = 'X';
```
-------------------------3728 sample_num
```sql
SELECT SUM(grad_cohort) AS graduated_asian_students
FROM state_sector_grads
WHERE stateid IN (
    SELECT stateid
    FROM state_sector_details
    WHERE schools_count = 113 AND level = '2-year' AND control = 'public'
) AND race = 'A' AND cohort = '2y all' AND year = 2013;
```
-------------------------3729 sample_num
```sql
SELECT 
    (SUM(CASE WHEN level = '4-year' AND control = 'Public' THEN 1 ELSE 0 END) * 100.0) / 
    NULLIF(SUM(CASE WHEN state = 'Alabama' THEN 1 ELSE 0 END), 0) AS percentage
FROM 
    institution_details
WHERE 
    chronname = 'Madison Area Technical College';
```
-------------------------3730 sample_num
```sql
SELECT id.state, id.chronname
FROM institution_details id
JOIN institution_grads ig ON id.unitid = ig.unitid
WHERE ig.year BETWEEN 2010 AND 2012 AND ig.race = 'B';
```
-------------------------3731 sample_num
```sql
SELECT DISTINCT state 
FROM state_sector_details 
WHERE year = '2011' AND awards_per_natl_value < 20;
```
-------------------------3732 sample_num
```sql
SELECT control, level
FROM institution_details
WHERE student_count = (
    SELECT MAX(student_count)
    FROM institution_details
    WHERE unitid IN (
        SELECT unitid
        FROM institution_grads
        WHERE race = 'X'
    )
);
```
-------------------------3733 sample_num
```sql
SELECT DISTINCT race 
FROM state_sector_details 
WHERE control = 'Public' AND schools_count <= 20;
```
-------------------------3734 sample_num
```sql
SELECT id.basic
FROM institution_details id
JOIN institution_grads ig ON id.unitid = ig.unitid
WHERE ig.year = '2012' AND ig.gender = 'M' AND ig.race = 'X';
```
-------------------------3735 sample_num
```sql
SELECT SUM(grad_cohort_ct) AS white_students
FROM state_sector_grads
WHERE state = 'Alaska' 
  AND year BETWEEN '2011' AND '2013' 
  AND race = 'W'
  AND stateid IN (SELECT stateid FROM state_sector_details WHERE state = 'Alaska' AND schools_count = 1);
```
-------------------------3736 sample_num
```sql
SELECT chronname 
FROM institution_details id 
JOIN institution_grads ig ON id.unitid = ig.unitid 
WHERE ig.race = 'Ai' AND ig.grad_cohort <= 3;
```
-------------------------3737 sample_num
```sql
SELECT SUM(grad_cohort) AS total_degree_seeking_students
FROM state_sector_grads
WHERE state LIKE 'A%'
  AND awards_per_natl_value = 16.5
  AND year = '2012';
```
-------------------------3738 sample_num
```sql
SELECT site 
FROM institution_details 
WHERE student_count BETWEEN 500 AND 1000 
AND vsa_year = (SELECT MAX(vsa_year) FROM institution_details);
```
-------------------------3739 sample_num
```sql
SELECT DISTINCT id.state
FROM state_sector_grads AS id
JOIN institution_grads AS ig ON id.stateid = ig.unitid
WHERE ig.gender = 'M' 
  AND ig.year = '2011' 
  AND id.control = 'Private for-profit' 
  AND ig.race = 'B';
```
-------------------------3740 sample_num
```sql
SELECT id.site, id.chronname
FROM institution_grads ig
JOIN institution_details id ON ig.unitid = id.unitid
WHERE ig.race = 'B' 
  AND ig.year = '2011' 
  AND ig.grad_cohort BETWEEN 20 AND 30;
```
-------------------------3741 sample_num
```sql
SELECT COUNT(*) 
FROM institution_grads ig 
JOIN state_sector_details ssd ON ig.unitid = ssd.stateid 
WHERE ig.gender = 'F' 
AND ig.year = 2012 
AND ssd.schools_count BETWEEN 10 AND 20;
```
-------------------------3742 sample_num
```sql
SELECT DISTINCT race
FROM institution_details
WHERE state = 'Alabama' AND student_count > (SELECT AVG(student_count) * 0.9 FROM institution_details);
```
-------------------------3743 sample_num
```sql
SELECT 
    (SUM(CASE WHEN level = '2-year' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS percentage_associates_degree
FROM 
    institution_details
WHERE 
    state = 'Hawaii' AND 
    unitid IN (SELECT unitid FROM institution_grads WHERE year = 2010);
```
-------------------------3744 sample_num
```sql
SELECT chronname 
FROM institution_details 
WHERE state = 'Connecticut' 
ORDER BY retain_percentile DESC 
LIMIT 1;
```
-------------------------3745 sample_num
```sql
SELECT id.site
FROM institution_grads ig
JOIN institution_details id ON ig.unitid = id.unitid
WHERE ig.race = 'W' AND ig.cohort = '2y all' AND ig.year = '2008'
ORDER BY ig.grad_cohort DESC
LIMIT 1;
```
-------------------------3746 sample_num
```sql
SELECT year, MAX(grad_cohort) AS highest_grad_cohort
FROM institution_grads
WHERE unitid = (SELECT unitid FROM institution_details WHERE chronname = 'Harvard University')
GROUP BY year
ORDER BY highest_grad_cohort DESC
LIMIT 1;
```
-------------------------3747 sample_num
```sql
SELECT id.chronname
FROM institution_details id
JOIN state_sector_details sd ON id.state = sd.state
WHERE sd.state_appr_value = (
    SELECT MAX(state_appr_value)
    FROM state_sector_details
    WHERE level = '4-year' AND control = 'Public' AND year = 2011
)
AND id.student_count = (
    SELECT MIN(student_count)
    FROM institution_details
    WHERE year = 2010
);
```
-------------------------3748 sample_num
```sql
SELECT AVG(black_students) AS average_black_students
FROM (
    SELECT COUNT(*) AS black_students
    FROM institution_grads ig
    JOIN institution_details id ON ig.unitid = id.unitid
    WHERE id.chronname = 'Yale University'
      AND ig.race = 'B'
      AND ig.cohort = '4y bach'
      AND ig.year BETWEEN 2002 AND 2005
    GROUP BY ig.year
) AS yearly_counts;
```
-------------------------3749 sample_num
```sql
SELECT id.chronname, SUM(ig.grad_cohort) AS total_hispanic_grads
FROM institution_details id
JOIN institution_grads ig ON id.unitid = ig.unitid
WHERE id.chronname IN ('Brown University', 'Columbia University', 'Cornell University', 'Dartmouth College', 'Harvard University', 'Princeton University', 'University of Pennsylvania', 'Yale University')
AND ig.race = 'H'
GROUP BY id.chronname
ORDER BY total_hispanic_grads DESC
LIMIT 1;
```
-------------------------3750 sample_num
```sql
SELECT chronname 
FROM institution_details 
WHERE state = 'Florida' AND level = '4-year' AND control = 'Public';
```
-------------------------3751 sample_num
```sql
SELECT id.chronname, sd.state, sd.state_appr_value
FROM institution_details id
JOIN state_sector_details sd ON id.state = sd.state
WHERE id.chronname IN ('Brown University', 'Columbia University', 'Cornell University', 'Dartmouth College', 'Harvard University', 'Princeton University', 'University of Pennsylvania', 'Yale University')
AND sd.level = id.level
AND sd.control = id.control
AND sd.state_appr_value = (
    SELECT MIN(state_appr_value)
    FROM state_sector_details
    WHERE year = 2011
)
AND sd.year = 2011;
```
-------------------------3752 sample_num
```sql
SELECT id.chronname
FROM institution_details id
JOIN state_sector_details sd ON id.state = sd.state
WHERE sd.schools_count = (SELECT MAX(schools_count) FROM state_sector_details)
AND id.ft_pct >= 90;
```
-------------------------3753 sample_num
```sql
SELECT AVG(med_sat_value) AS average_sat_value
FROM institution_details
WHERE unitid IN (
    SELECT stateid
    FROM state_sector_details
    WHERE year = 2011
    ORDER BY state_appr_value ASC
    LIMIT 1
);
```
-------------------------3754 sample_num
```sql
SELECT chronname 
FROM institution_details 
WHERE unitid IN (
    SELECT unitid 
    FROM institution_grads 
    WHERE gender = 'F' AND cohort != '4y other'
) 
ORDER BY (SELECT COUNT(*) 
          FROM institution_grads 
          WHERE gender = 'F' AND cohort != '4y other' AND institution_grads.unitid = institution_details.unitid) DESC 
LIMIT 1;
```
-------------------------3755 sample_num
```sql
SELECT id.chronname, SUM(ig.grad_150) AS total_black_grads
FROM institution_details id
JOIN institution_grads ig ON id.unitid = ig.unitid
WHERE id.chronname IN ('Brown University', 'Columbia University', 'Cornell University', 'Dartmouth College', 'Harvard University', 'Princeton University', 'University of Pennsylvania', 'Yale University')
AND ig.year = '2013'
AND ig.race = 'B'
AND ig.cohort = '4y bach'
GROUP BY id.chronname
ORDER BY total_black_grads DESC
LIMIT 1;
```
-------------------------3756 sample_num
```sql
SELECT AVG(grad_150) AS average_grad_150
FROM institution_grads ig
JOIN institution_details id ON ig.unitid = id.unitid
WHERE id.chronname = 'United Education Institute-Huntington Park Campus'
  AND ig.year BETWEEN '2011' AND '2013'
  AND ig.gender = 'M'
  AND ig.race = 'H'
  AND id.level = '2-year';
```
-------------------------3757 sample_num
```sql
SELECT id.chronname, sd.state_appr_value
FROM institution_details id
JOIN state_sector_details sd ON id.state = sd.state
WHERE id.vsa_year = 2011
ORDER BY (id.awards_per_value - id.awards_per_natl_value) DESC
LIMIT 1;
```
-------------------------3758 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE state = 'AZ' AND stars < 3;
```
-------------------------3759 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE active = 'False' AND state = 'AZ';
```
-------------------------3760 sample_num
```sql
SELECT COUNT(*) 
FROM Reviews 
WHERE user_id = 36139 AND review_length = 'long';
```
-------------------------3761 sample_num
```sql
SELECT COUNT(*) AS user_count
FROM Users
WHERE user_fans = 'uber';
```
-------------------------3762 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS open_24_hours_count
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'Open 24 Hours' AND ba.attribute_value = 'true';
```
-------------------------3763 sample_num
```sql
SELECT ba.attribute_value 
FROM Business_Attributes ba 
JOIN Attributes a ON ba.attribute_id = a.attribute_id 
WHERE a.attribute_name = 'Wi-Fi' AND ba.business_id = 10172;
```
-------------------------3764 sample_num
```sql
SELECT COUNT(b.business_id) AS bar_count
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Bars';
```
-------------------------3765 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.category_name = 'Buffets' THEN 1 ELSE 0 END) - 
     SUM(CASE WHEN c.category_name = 'Gyms' THEN 1 ELSE 0 END)) AS difference
FROM 
    Business_Categories bc
JOIN 
    Categories c ON bc.category_id = c.category_id;
```
-------------------------3766 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Reviews r ON b.business_id = r.business_id
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE r.review_stars = 5
GROUP BY c.category_name
ORDER BY COUNT(r.review_stars) DESC
LIMIT 1;
```
-------------------------3767 sample_num
```sql
SELECT u.user_yelping_since_year
FROM Users u
JOIN (
    SELECT user_id
    FROM Reviews
    WHERE review_stars = 5
    GROUP BY user_id
    ORDER BY COUNT(*) DESC
    LIMIT 1
) AS top_user ON u.user_id = top_user.user_id;
```
-------------------------3768 sample_num
```sql
SELECT u.user_id, AVG(r.review_stars) AS average_rating
FROM Reviews r
JOIN Users u ON r.user_id = u.user_id
WHERE r.review_length = 'long'
GROUP BY u.user_id
ORDER BY COUNT(r.review_length) DESC
LIMIT 1;
```
-------------------------3769 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Reviews r ON b.business_id = r.business_id
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE r.review_length = 'long'
GROUP BY b.business_id, c.category_name
ORDER BY COUNT(r.review_length) DESC
LIMIT 1;
```
-------------------------3770 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Tips t ON b.business_id = t.business_id
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE t.tip_length = 'short'
GROUP BY b.business_id, c.category_name
ORDER BY COUNT(t.tip_length) DESC
LIMIT 1;
```
-------------------------3771 sample_num
```sql
SELECT u.user_yelping_since_year
FROM Users u
JOIN Tips t ON u.user_id = t.user_id
WHERE t.tip_length = 'Short'
GROUP BY u.user_id
ORDER BY COUNT(t.tip_length) DESC
LIMIT 1;
```
-------------------------3772 sample_num
```sql
SELECT c.category_name
FROM Tips t
JOIN Business_Categories bc ON t.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE t.user_id = 70271 AND t.tip_length = 'short';
```
-------------------------3773 sample_num
```sql
SELECT b.stars
FROM Tips t
JOIN Business b ON t.business_id = b.business_id
WHERE t.user_id = 69722
AND t.tip_length = 'short'
LIMIT 1;
```
-------------------------3774 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.category_name = 'Automotive' THEN 1 ELSE 0 END) * 100.0) / COUNT(b.business_id) AS automotive_percentage
FROM 
    Business b
LEFT JOIN 
    Business_Categories bc ON b.business_id = bc.business_id
LEFT JOIN 
    Categories c ON bc.category_id = c.category_id;
```
-------------------------3775 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.category_name = 'Women''s Clothing' THEN 1 ELSE 0 END) - 
     SUM(CASE WHEN c.category_name = 'Men''s Clothing' THEN 1 ELSE 0 END)) * 100.0 / 
    COUNT(b.business_id) AS percentage_more
FROM 
    Business b
JOIN 
    Business_Categories bc ON b.business_id = bc.business_id
JOIN 
    Categories c ON bc.category_id = c.category_id
WHERE 
    c.category_name IN ('Women''s Clothing', 'Men''s Clothing');
```
-------------------------3776 sample_num
```sql
SELECT COUNT(*) AS number_of_users
FROM Users
WHERE user_yelping_since_year >= 2004;
```
-------------------------3777 sample_num
```sql
SELECT COUNT(*) 
FROM Users 
WHERE user_yelping_since_year = 2005 AND user_fans = 0;
```
-------------------------3778 sample_num
```sql
SELECT COUNT(*) AS active_business_count
FROM Business
WHERE active = 'TRUE' AND city = 'Tolleson';
```
-------------------------3779 sample_num
```sql
SELECT COUNT(*) AS number_of_reviews 
FROM Reviews 
WHERE user_id = 21679;
```
-------------------------3780 sample_num
```sql
SELECT COUNT(*) 
FROM Reviews 
WHERE business_id = 10682 AND review_stars = 5;
```
-------------------------3781 sample_num
```sql
SELECT business_id
FROM Business
WHERE active = 'False' AND city = 'Sun City'
GROUP BY business_id
ORDER BY COUNT(review_count) DESC
LIMIT 1;
```
-------------------------3782 sample_num
```sql
SELECT COUNT(*) AS medium_review_count
FROM Reviews
WHERE business_id = (SELECT business_id FROM Business WHERE city = 'Yuma')
AND review_length = 'Medium';
```
-------------------------3783 sample_num
```sql
SELECT COUNT(*) > 0 AS has_tv
FROM Business_Attributes
JOIN Attributes ON Business_Attributes.attribute_id = Attributes.attribute_id
WHERE Business_Attributes.business_id = 4960 AND Attributes.attribute_name = 'Has TV';
```
-------------------------3784 sample_num
```sql
SELECT COUNT(DISTINCT ba.business_id) AS number_of_dogs_allowed_businesses
FROM Business_Attributes ba
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'Dogs Allowed' AND ba.attribute_value = 'true';
```
-------------------------3785 sample_num
```sql
SELECT 
    SUM(TIMESTAMPDIFF(HOUR, opening_time, closing_time)) AS total_hours
FROM 
    Business_Hours
JOIN 
    Days ON Business_Hours.day_id = Days.day_id
WHERE 
    Business_Hours.business_id = 5734 AND 
    Days.day_of_week = 'Saturday';
```
-------------------------3786 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS hair_removal_business_count
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Hair Removal';
```
-------------------------3787 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM Business_Categories bc JOIN Categories c ON bc.category_id = c.category_id WHERE c.category_name = 'Chinese') -
    (SELECT COUNT(*) FROM Business_Categories bc JOIN Categories c ON bc.category_id = c.category_id WHERE c.category_name = 'Filipino') AS difference;
```
-------------------------3788 sample_num
```sql
SELECT b.city 
FROM Tips t 
JOIN Business b ON t.business_id = b.business_id 
WHERE t.user_id = 63469 AND t.likes = 1;
```
-------------------------3789 sample_num
```sql
SELECT COUNT(*) 
FROM Business_Attributes 
JOIN Attributes ON Business_Attributes.attribute_id = Attributes.attribute_id 
WHERE Business_Attributes.business_id = 1141 
AND Attributes.attribute_name LIKE '%music%' 
AND Business_Attributes.attribute_value = 'true';
```
-------------------------3790 sample_num
```sql
SELECT SUM(number_of_compliments) AS total_cute_compliments
FROM Users_Compliments uc
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE uc.user_id = 57400 AND c.compliment_type = 'cute';
```
-------------------------3791 sample_num
```sql
SELECT user_id
FROM Users_Compliments uc
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE c.compliment_type = 'funny'
GROUP BY user_id
ORDER BY COUNT(uc.number_of_compliments) DESC
LIMIT 1;
```
-------------------------3792 sample_num
```sql
SELECT COUNT(*) 
FROM Business_Attributes ba 
JOIN Business b ON ba.business_id = b.business_id 
WHERE ba.attribute_id = (SELECT attribute_id FROM Attributes WHERE attribute_name = 'Drive-Thru') 
AND ba.attribute_value = 'true' 
AND b.city = 'Scottsdale' 
AND b.business_id < 1000;
```
-------------------------3793 sample_num
```sql
SELECT AVG(b.stars) AS average_rating
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'Open 24 Hours' AND ba.attribute_value = 'true';
```
-------------------------3794 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN b.city = 'Phoenix' THEN 1 END) * 100.0 / COUNT(b.business_id)) AS percentage
FROM 
    Business b
JOIN 
    Business_Attributes ba ON b.business_id = ba.business_id
JOIN 
    Attributes a ON ba.attribute_id = a.attribute_id
WHERE 
    a.attribute_name = 'BYOB' AND ba.attribute_value = 'TRUE';
```
-------------------------3795 sample_num
```sql
SELECT business_id 
FROM Business 
WHERE state = 'AZ' AND stars = 5;
```
-------------------------3796 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE active = 'true' AND review_count = 'Low';
```
-------------------------3797 sample_num
```sql
SELECT COUNT(user_id) 
FROM Users 
WHERE user_id BETWEEN 1 AND 20 
AND user_fans = 0 
AND user_review_count < 5;
```
-------------------------3798 sample_num
```sql
SELECT b.business_id, bh.opening_time, bh.closing_time
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE c.category_name = 'fashion';
```
-------------------------3799 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE c.category_name = 'Shopping' AND bh.opening_time < '08:00:00';
```
-------------------------3800 sample_num
```sql
SELECT b.business_id
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE c.category_name = 'pets' AND bh.closing_time > '21:00';
```
-------------------------3801 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE d.day_of_week BETWEEN 'Monday' AND 'Thursday'
GROUP BY b.business_id
HAVING COUNT(DISTINCT d.day_id) = 4;
```
-------------------------3802 sample_num
```sql
SELECT SUM(b.review_count) AS total_review_count
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Active Life' AND b.city = 'Phoenix' AND b.active = 1;
```
-------------------------3803 sample_num
```sql
SELECT b.business_id
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.stars < 5 AND c.category_name = 'men\'s clothing';
```
-------------------------3804 sample_num
```sql
SELECT b.business_id, b.city, b.state, b.stars, b.review_count
FROM Business b
JOIN Reviews r ON b.business_id = r.business_id
WHERE b.active = 'False' AND r.review_votes_useful = 'Low';
```
-------------------------3805 sample_num
```sql
SELECT business_id 
FROM Reviews 
WHERE review_length = 'Long' 
AND business_id BETWEEN 1 AND 20;
```
-------------------------3806 sample_num
```sql
SELECT ba.attribute_value
FROM Business_Attributes ba
JOIN Business_Categories bc ON ba.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business b ON ba.business_id = b.business_id
WHERE c.category_name = 'Fashion' AND b.city = 'Scottsdale';
```
-------------------------3807 sample_num
```sql
SELECT COUNT(*) AS medium_user_compliments
FROM Users_Compliments uc
JOIN Users u ON uc.user_id = u.user_id
JOIN Business b ON uc.business_id = b.business_id
WHERE uc.number_of_compliments = 'Medium' AND b.city = 'Phoenix';
```
-------------------------3808 sample_num
```sql
SELECT b.business_id
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE b.city = 'Tempe' AND bh.opening_time < '08:00:00';
```
-------------------------3809 sample_num
```sql
SELECT COUNT(*) 
FROM Business b 
JOIN Business_Hours bh ON b.business_id = bh.business_id 
WHERE b.city = 'Glendale' 
  AND b.active = 'true' 
  AND bh.opening_time = '8AM' 
  AND bh.closing_time = '6PM';
```
-------------------------3810 sample_num
```sql
SELECT 
    COUNT(business_id) AS phoenix_business_count,
    (COUNT(business_id) * 100.0 / (SELECT COUNT(business_id) FROM Business)) AS phoenix_business_percentage
FROM 
    Business
WHERE 
    city = 'Phoenix';
```
-------------------------3811 sample_num
```sql
SELECT 
    COUNT(DISTINCT b.city) AS active_life_cities,
    (SUM(CASE WHEN b.review_count < (SELECT AVG(review_count) FROM Business) THEN 1 ELSE 0 END) * 100.0 / COUNT(b.business_id)) AS low_review_percentage
FROM 
    Business b
JOIN 
    Business_Categories bc ON b.business_id = bc.business_id
JOIN 
    Categories c ON bc.category_id = c.category_id
WHERE 
    c.category_name = 'Active Life';
```
-------------------------3812 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE active = 'true' AND city = 'Phoenix';
```
-------------------------3813 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE city = 'Scottsdale' AND stars > 3;
```
-------------------------3814 sample_num
```sql
SELECT AVG(stars) AS average_rating_inactive_businesses
FROM Business
WHERE active = 'False';
```
-------------------------3815 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS business_count
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
WHERE b.state = 'AZ' AND ba.attribute_value = 'beer_and_wine';
```
-------------------------3816 sample_num
```sql
SELECT b.city
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
WHERE ba.attribute_value = 'full_bar'
GROUP BY b.city
ORDER BY COUNT(b.business_id) DESC
LIMIT 1;
```
-------------------------3817 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b 
JOIN Business_Categories bc ON b.business_id = bc.business_id 
JOIN Categories c ON bc.category_id = c.category_id 
WHERE c.category_name = 'Fashion' AND b.stars = 5;
```
-------------------------3818 sample_num
```sql
SELECT city
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Food' AND b.review_count = 'High'
GROUP BY city
ORDER BY COUNT(b.business_id) DESC
LIMIT 1;
```
-------------------------3819 sample_num
```sql
SELECT business_id FROM Business WHERE city = 'Mesa' AND stars > 3;
```
-------------------------3820 sample_num
```sql
SELECT city
FROM Business
WHERE business_id IN (
    SELECT business_id
    FROM Reviews
    WHERE review_votes_funny = 'Low'
)
GROUP BY city
ORDER BY COUNT(business_id) ASC
LIMIT 1;
```
-------------------------3821 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.category_name = 'Real Estate' AND b.stars = 5 THEN 1 END) * 100.0 / COUNT(b.business_id)) AS percentage
FROM 
    Business b
JOIN 
    Business_Categories bc ON b.business_id = bc.business_id
JOIN 
    Categories c ON bc.category_id = c.category_id
WHERE 
    b.city = 'Chandler';
```
-------------------------3822 sample_num
```sql
SELECT COUNT(*) 
FROM Users 
WHERE user_yelping_since_year = '2012' AND user_votes_funny = 'High';
```
-------------------------3823 sample_num
```sql
SELECT review_votes_useful 
FROM Reviews 
WHERE user_id = 52592 AND business_id = 2;
```
-------------------------3824 sample_num
```sql
SELECT attribute_id 
FROM Attributes 
WHERE attribute_name LIKE '%payment%';
```
-------------------------3825 sample_num
```sql
SELECT review_length 
FROM Reviews 
WHERE business_id = 2 AND user_id = 612;
```
-------------------------3826 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE active = 'true' AND city = 'Gilbert';
```
-------------------------3827 sample_num
```sql
SELECT COUNT(*) AS low_quality_businesses
FROM Business
WHERE state = 'AZ' AND review_count = 'low';
```
-------------------------3828 sample_num
```sql
SELECT DISTINCT b.business_id 
FROM Business b 
JOIN Reviews r ON b.business_id = r.business_id 
WHERE b.state = 'AZ' AND r.review_stars = 5 
LIMIT 3;
```
-------------------------3829 sample_num
```sql
SELECT a.attribute_name 
FROM Attributes a 
WHERE a.attribute_id NOT IN (
    SELECT ba.attribute_id 
    FROM Business_Attributes ba 
    WHERE ba.business_id = 2 AND ba.attribute_value != 'none'
) LIMIT 1;
```
-------------------------3830 sample_num
```sql
SELECT SUM(number_of_compliments) AS cool_compliments
FROM Users_Compliments uc
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE uc.user_id = 33 AND c.compliment_type = 'cool';
```
-------------------------3831 sample_num
```sql
SELECT opening_time, closing_time 
FROM Business_Hours 
JOIN Days ON Business_Hours.day_id = Days.day_id 
WHERE Business_Hours.business_id = 53 AND Days.day_of_week = 'Friday';
```
-------------------------3832 sample_num
```sql
SELECT a.attribute_name
FROM Attributes a
JOIN Business_Attributes ba ON a.attribute_id = ba.attribute_id
WHERE ba.business_id = 56 AND ba.attribute_value = 'true';
```
-------------------------3833 sample_num
```sql
SELECT c.category_name 
FROM Business_Categories bc 
JOIN Categories c ON bc.category_id = c.category_id 
WHERE bc.business_id = 15;
```
-------------------------3834 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.city = 'Scottsdale' AND c.category_name = 'Beauty & Spas';
```
-------------------------3835 sample_num
```sql
SELECT DISTINCT uc.user_id
FROM Users_Compliments uc
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE uc.number_of_compliments = 'Uber' AND c.compliment_type = 'cute'
LIMIT 2;
```
-------------------------3836 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS business_count
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Reviews r ON b.business_id = r.business_id
WHERE bc.category_id = (SELECT category_id FROM Categories WHERE category_name = 'Accessories')
AND r.review_stars > 3;
```
-------------------------3837 sample_num
```sql
SELECT opening_time, closing_time 
FROM Business_Hours 
WHERE business_id = 12 AND day_id = 3;
```
-------------------------3838 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
LEFT JOIN Business_Hours bh ON b.business_id = bh.business_id
LEFT JOIN Days d ON bh.day_id = d.day_id
WHERE b.state = 'AZ' AND (d.day_of_week != 'Thursday' OR bh.opening_time IS NULL OR bh.closing_time IS NULL OR bh.label_time_4 = 'None');
```
-------------------------3839 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE city = 'Scottsdale';
```
-------------------------3840 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE state = 'AZ' AND active = 'true';
```
-------------------------3841 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS Yelp_Businesses
FROM Business b
JOIN Reviews r ON b.business_id = r.business_id
JOIN Elite e ON r.user_id = e.user_id
WHERE b.city = 'Scottsdale' AND r.review_stars > 3;
```
-------------------------3842 sample_num
```sql
SELECT city, MAX(review_count) AS max_review_count
FROM Business
WHERE city IN ('Scottsdale', 'Anthem')
GROUP BY city
ORDER BY max_review_count DESC
LIMIT 1;
```
-------------------------3843 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE state = 'AZ' AND stars > 4;
```
-------------------------3844 sample_num
```sql
SELECT COUNT(*) AS total_yelp_businesses
FROM Business
WHERE state = 'AZ';
```
-------------------------3845 sample_num
```sql
SELECT DISTINCT b.city
FROM Business b
WHERE b.stars = 5;
```
-------------------------3846 sample_num
```sql
SELECT COUNT(*) AS review_count
FROM Reviews
WHERE user_id = 3;
```
-------------------------3847 sample_num
```sql
SELECT COUNT(*) 
FROM Reviews 
WHERE user_id = 3 AND review_length = 'Long';
```
-------------------------3848 sample_num
```sql
SELECT COUNT(*) 
FROM Reviews 
WHERE user_id = 3 AND review_length = 'Long' AND review_votes_useful = 'medium';
```
-------------------------3849 sample_num
```sql
SELECT COUNT(*) 
FROM Users 
WHERE user_yelping_since_year >= '2012';
```
-------------------------3850 sample_num
```sql
SELECT user_id 
FROM Users 
WHERE user_fans = 'High';
```
-------------------------3851 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS businesses_without_alcohol
FROM Business b
LEFT JOIN Business_Attributes ba ON b.business_id = ba.business_id
WHERE ba.attribute_id = (SELECT attribute_id FROM Attributes WHERE attribute_name = 'Alcohol')
AND ba.attribute_value = 'none';
```
-------------------------3852 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS businesses_without_alcohol
FROM Business b
LEFT JOIN Business_Attributes ba ON b.business_id = ba.business_id
LEFT JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.state = 'AZ' AND (a.attribute_name != 'Alcohol' OR ba.attribute_value != 'none' OR a.attribute_name IS NULL);
```
-------------------------3853 sample_num
```sql
SELECT business_id 
FROM Business_Attributes 
WHERE attribute_id = (SELECT attribute_id FROM Attributes WHERE attribute_name = 'Good for Kids') 
AND attribute_value = 'true';
```
-------------------------3854 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS number_of_shopping_businesses
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Shopping';
```
-------------------------3855 sample_num
```sql
SELECT c.category_name
FROM Business_Categories bc
JOIN Categories c ON bc.category_id = c.category_id
WHERE bc.business_id = 1;
```
-------------------------3856 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.active = 'true' AND c.category_name = 'Food';
```
-------------------------3857 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b 
JOIN Business_Categories bc ON b.business_id = bc.business_id 
JOIN Categories c ON bc.category_id = c.category_id 
WHERE b.city = 'Anthem' AND c.category_name = 'Food';
```
-------------------------3858 sample_num
```sql
SELECT b.business_id
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Elite e ON b.business_id = e.user_id
WHERE bc.category_id = (SELECT category_id FROM Categories WHERE category_name = 'Food')
ORDER BY b.stars DESC
LIMIT 1;
```
-------------------------3859 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS number_of_businesses
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE c.category_name = 'Food' AND a.attribute_name = 'Good for Kids' AND ba.attribute_value = 'true';
```
-------------------------3860 sample_num
```sql
SELECT COUNT(DISTINCT r.business_id) 
FROM Reviews r 
JOIN Business b ON r.business_id = b.business_id 
WHERE b.state = 'AZ' AND r.user_id = 3;
```
-------------------------3861 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.state = 'AZ';
```
-------------------------3862 sample_num
```sql
SELECT 
    TIMEDIFF(BH.closing_time, BH.opening_time) AS open_duration
FROM 
    Business_Hours BH
JOIN 
    Days D ON BH.day_id = D.day_id
WHERE 
    BH.business_id = 1 AND D.day_of_week = 'Tuesday';
```
-------------------------3863 sample_num
```sql
SELECT opening_time 
FROM Business_Hours 
JOIN Days ON Business_Hours.day_id = Days.day_id 
WHERE Business_Hours.business_id = 1 AND Days.day_of_week = 'Tuesday';
```
-------------------------3864 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE d.day_of_week = 'Monday' 
AND bh.closing_time IN ('9PM', '10PM', '11PM', '12PM');
```
-------------------------3865 sample_num
```sql
SELECT bh.opening_time
FROM Business_Hours bh
JOIN Business b ON bh.business_id = b.business_id
WHERE bh.day_id = (SELECT day_id FROM Days WHERE day_of_week = 'Monday')
AND b.city = 'Anthem'
AND b.active = 'true';
```
-------------------------3866 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE b.state = 'AZ' AND bh.closing_time = '12PM' AND d.day_of_week = 'Sunday';
```
-------------------------3867 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Categories c ON b.business_id = bc.business_id
JOIN Business_Categories bc ON b.business_id = bc.business_id
WHERE bh.closing_time = '12PM' AND bh.day_id = (SELECT day_id FROM Days WHERE day_of_week = 'Sunday');
```
-------------------------3868 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE a.attribute_name = 'Good for Kids' 
AND ba.attribute_value = 'true'
GROUP BY b.business_id
HAVING COUNT(DISTINCT bh.day_id) = 7;
```
-------------------------3869 sample_num
```sql
SELECT COUNT(*) AS elite_users_same_year
FROM Elite e
JOIN Users u ON e.user_id = u.user_id
WHERE u.user_yelping_since_year = e.year_id;
```
-------------------------3870 sample_num
```sql
SELECT MAX(TIMESTAMPDIFF(MINUTE, bh.opening_time, bh.closing_time)) AS longest_business_time
FROM Business_Hours bh
JOIN Business b ON bh.business_id = b.business_id
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE bh.day_id = (SELECT day_id FROM Days WHERE day_of_week = 'Monday')
AND c.category_name = 'Shopping';
```
-------------------------3871 sample_num
```sql
SELECT b.business_id
FROM Business_Hours bh
JOIN Days d ON bh.day_id = d.day_id
WHERE d.day_of_week = 'Sunday' 
AND (TIMESTAMPDIFF(HOUR, bh.opening_time, bh.closing_time) > 12);
```
-------------------------3872 sample_num
```sql
SELECT COUNT(DISTINCT r.user_id) AS elite_user_count
FROM Reviews r
JOIN Elite e ON r.user_id = e.user_id
WHERE r.business_id = 1;
```
-------------------------3873 sample_num
```sql
SELECT COUNT(DISTINCT e.user_id) AS elite_user_count
FROM Elite e
JOIN Users u ON e.user_id = u.user_id
WHERE u.user_review_count > 10;
```
-------------------------3874 sample_num
```sql
SELECT business_id
FROM Business
WHERE state = 'AZ'
GROUP BY business_id
ORDER BY COUNT(Reviews.business_id) DESC
LIMIT 1;
```
-------------------------3875 sample_num
```sql
SELECT AVG(review_stars) AS average_stars
FROM Reviews r
JOIN Business b ON r.business_id = b.business_id
WHERE b.city = 'Anthem';
```
-------------------------3876 sample_num
```sql
SELECT AVG(r.review_stars) AS average_stars
FROM Reviews r
JOIN Business b ON r.business_id = b.business_id
WHERE r.user_id = 3 AND b.state = 'AZ';
```
-------------------------3877 sample_num
```sql
SELECT AVG(DIVIDE(SUBTRACT(BH.closing_time, BH.opening_time), 2)) AS average_business_time
FROM Business_Hours BH
JOIN Days D ON BH.day_id = D.day_id
WHERE BH.business_id = 1 AND (D.day_of_week = 'Saturday' OR D.day_of_week = 'Sunday');
```
-------------------------3878 sample_num
```sql
SELECT DIVIDE(SUM(b.stars), COUNT(b.business_id)) AS average_elite_star_rating
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE bh.closing_time = '12PM' AND d.day_of_week = 'Sunday';
```
-------------------------3879 sample_num
```sql
SELECT COUNT(*) FROM Business WHERE city = 'Casa Grande';
```
-------------------------3880 sample_num
```sql
SELECT COUNT(*) AS total_active_businesses
FROM Business
WHERE active = 'true' AND state = 'AZ' AND review_count < (SELECT AVG(review_count) FROM Business);
```
-------------------------3881 sample_num
```sql
SELECT business_id 
FROM Business 
WHERE stars >= 2 AND stars < 4 AND city = 'Mesa';
```
-------------------------3882 sample_num
```sql
SELECT COUNT(*) 
FROM Users 
WHERE user_yelping_since_year >= 2011 AND user_yelping_since_year < 2014 AND user_fans > 0;
```
-------------------------3883 sample_num
```sql
SELECT review_length 
FROM Reviews 
WHERE user_id = 35026 AND business_id = 2;
```
-------------------------3884 sample_num
```sql
SELECT a.attribute_name
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.city = 'Chandler' AND b.review_count = (
    SELECT MIN(review_count)
    FROM Business
    WHERE city = 'Chandler'
);
```
-------------------------3885 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS business_count
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Mexican' AND b.stars < 4;
```
-------------------------3886 sample_num
```sql
SELECT b.business_id, b.stars
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.active = 'true' AND c.category_name = 'Fashion';
```
-------------------------3887 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.stars = (SELECT MAX(stars) FROM Business)
```
-------------------------3888 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.business_id BETWEEN 6 AND 9
AND b.stars = (
    SELECT MAX(stars)
    FROM Business
    WHERE business_id BETWEEN 6 AND 9
    AND LENGTH(b.review_length) = (
        SELECT LENGTH(review_length)
        FROM Reviews
        WHERE business_id = b.business_id
        ORDER BY LENGTH(review_length) ASC
        LIMIT 1 OFFSET (SELECT COUNT(*) FROM Reviews WHERE business_id = b.business_id) / 2
    )
);
```
-------------------------3889 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS active_business_count
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.active = 'true' 
AND a.attribute_name = 'Caters' 
AND b.review_count < (SELECT AVG(review_count) FROM Business WHERE active = 'true');
```
-------------------------3890 sample_num
```sql
SELECT bh.opening_time, bh.closing_time
FROM Business_Hours bh
JOIN Business b ON bh.business_id = b.business_id
WHERE b.city = 'Tempe' AND b.stars = (SELECT MAX(stars) FROM Business WHERE city = 'Tempe');
```
-------------------------3891 sample_num
```sql
SELECT c.category_name, a.attribute_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.active = 'true' 
  AND b.city = 'Chandler' 
  AND b.state = 'AZ' 
  AND b.review_count BETWEEN 50 AND 200; -- Assuming medium review count is between 50 and 200
```
-------------------------3892 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.active = 'true' AND b.city = 'Surprise' AND b.state = 'AZ';
```
-------------------------3893 sample_num
```sql
SELECT b.city, b.state
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE bh.opening_time = '8AM' AND bh.closing_time = '9PM' AND d.day_of_week = 'Friday';
```
-------------------------3894 sample_num
```sql
SELECT ba.attribute_value
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
WHERE b.active = 'true' 
  AND b.review_count > (SELECT AVG(review_count) FROM Business) 
  AND b.stars = 3 
  AND b.city = 'Mesa' 
  AND b.state = 'AZ';
```
-------------------------3895 sample_num
```sql
SELECT bh.opening_time
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE b.active = 'true' 
  AND b.city = 'Chandler' 
  AND b.review_count BETWEEN 50 AND 200; -- Assuming medium review count is between 50 and 200
```
-------------------------3896 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN B.stars < 4 THEN 1 END) * 100.0 / COUNT(B.business_id)) AS percentage_less_than_4_stars
FROM 
    Business B
JOIN 
    Business_Categories BC ON B.business_id = BC.business_id
JOIN 
    Categories C ON BC.category_id = C.category_id
WHERE 
    C.category_name = 'Accessories';
```
-------------------------3897 sample_num
```sql
SELECT bh.closing_time, d.day_of_week
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE b.active = 'true' 
  AND b.city = 'Tempe' 
  AND b.stars > (SELECT SUM(stars) / COUNT(business_id) * 0.7 FROM Business);
```
-------------------------3898 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE active = 'true' AND city = 'Phoenix' AND state = 'Arizona';
```
-------------------------3899 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE review_count = 'High';
```
-------------------------3900 sample_num
```sql
SELECT COUNT(DISTINCT ba.business_id) AS business_count
FROM Business_Attributes ba
WHERE ba.attribute_id = (SELECT attribute_id FROM Attributes WHERE attribute_name = 'beer_and_wine');
```
-------------------------3901 sample_num
```sql
SELECT COUNT(attribute_id) AS attribute_count
FROM Business_Attributes
WHERE business_id = 2;
```
-------------------------3902 sample_num
```sql
SELECT COUNT(DISTINCT uc.user_id) AS high_compliment_users
FROM Users_Compliments uc
WHERE uc.number_of_compliments = 'High' AND uc.compliment_id = 1;
```
-------------------------3903 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS business_count
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.city = 'Phoenix' AND b.state = 'Arizona' AND a.attribute_name = 'waiter_services';
```
-------------------------3904 sample_num
```sql
SELECT b.business_id, b.active, b.city, b.state, a.attribute_name
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE bh.opening_time = bh.closing_time
GROUP BY b.business_id, a.attribute_name
HAVING COUNT(bh.day_id) = 7;
```
-------------------------3905 sample_num
```sql
SELECT b.business_id, b.active, b.city, b.state, b.stars, b.review_count
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Reviews r ON b.business_id = r.business_id
WHERE c.category_name = 'Fashion'
GROUP BY b.business_id
ORDER BY COUNT(r.user_id) DESC
LIMIT 1;
```
-------------------------3906 sample_num
```sql
SELECT c.category_name, AVG(r.review_stars) AS average_review
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Reviews r ON b.business_id = r.business_id
WHERE b.state = 'AZ' AND b.review_count >= 3
GROUP BY c.category_name
ORDER BY average_review DESC;
```
-------------------------3907 sample_num
```sql
SELECT 
    (SELECT COUNT(user_id) FROM Users WHERE user_average_stars = 5 AND user_id IN (SELECT user_id FROM Elite WHERE year_id = 2013)) * 1.0 /
    (SELECT COUNT(user_id) FROM Users WHERE user_average_stars = 1 AND user_id IN (SELECT user_id FROM Elite WHERE year_id = 2013)) AS ratio
```
-------------------------3908 sample_num
```sql
SELECT 
    y.actual_year,
    (COUNT(CASE WHEN e.year_id < 2015 THEN e.user_id END) * 100.0 / NULLIF(COUNT(CASE WHEN e.year_id = 2015 THEN e.user_id END), 0)) AS increment_percentage
FROM 
    Elite e
JOIN 
    Years y ON e.year_id = y.year_id
WHERE 
    y.actual_year BETWEEN 2005 AND 2014
GROUP BY 
    y.actual_year
ORDER BY 
    y.actual_year;
```
-------------------------3909 sample_num
```sql
SELECT COUNT(DISTINCT r.business_id) AS reviewed_business_count,
       (YEAR(CURRENT_DATE) - u.user_yelping_since_year) AS years_with_yelp
FROM Reviews r
JOIN Users u ON r.user_id = u.user_id
WHERE u.user_id = 3;
```
-------------------------3910 sample_num
```sql
SELECT 
    COUNT(business_id) / (YEAR(CURRENT_TIMESTAMP) - u.user_yelping_since_year) AS yearly_average_review
FROM 
    Reviews r
JOIN 
    Users u ON r.user_id = u.user_id
WHERE 
    u.user_id = 3;
```
-------------------------3911 sample_num
```sql
SELECT b.business_id, AVG(r.review_count) AS average_reviews
FROM Business b
JOIN Reviews r ON b.business_id = r.business_id
JOIN Elite e ON r.user_id = e.user_id
GROUP BY b.business_id;
```
-------------------------3912 sample_num
```sql
SELECT u.user_id, u.user_average_stars, SUM(t.likes) AS total_likes
FROM Elite e
JOIN Users u ON e.user_id = u.user_id
LEFT JOIN Tips t ON u.user_id = t.user_id
GROUP BY u.user_id
HAVING COUNT(e.year_id) >= 5;
```
-------------------------3913 sample_num
```sql
WITH HotelTravelBusinesses AS (
    SELECT b.business_id, b.stars, COUNT(r.review_stars) AS review_count
    FROM Business b
    JOIN Business_Categories bc ON b.business_id = bc.business_id
    JOIN Categories c ON bc.category_id = c.category_id
    LEFT JOIN Reviews r ON b.business_id = r.business_id
    WHERE c.category_name = 'Hotel & Travel'
    GROUP BY b.business_id, b.stars
),
MaxReviewBusiness AS (
    SELECT business_id, review_count
    FROM HotelTravelBusinesses
    WHERE review_count = (SELECT MAX(review_count) FROM HotelTravelBusinesses)
)
SELECT business_id, 
       STDDEV(review_stars) AS stddev_review_stars
FROM Reviews
WHERE business_id IN (SELECT business_id FROM MaxReviewBusiness)
GROUP BY business_id;
```
-------------------------3914 sample_num
```sql
SELECT 
    AVG(r.review_stars) AS average_review_stars,
    AVG(b.stars) AS average_business_stars
FROM 
    Reviews r
JOIN 
    Business b ON r.business_id = b.business_id
GROUP BY 
    b.business_id
HAVING 
    COUNT(r.user_id) = (SELECT MAX(review_count) FROM Business);
```
-------------------------3915 sample_num
```sql
SELECT COUNT(*) AS active_business_count
FROM Business
WHERE active = 'true';
```
-------------------------3916 sample_num
```sql
SELECT business_id 
FROM Business 
WHERE city = 'Phoenix' AND review_count = 'Low';
```
-------------------------3917 sample_num
```sql
SELECT COUNT(*) AS total_active_business
FROM Business
WHERE active = 'true' AND state = 'AZ' AND review_count = 'High';
```
-------------------------3918 sample_num
```sql
SELECT business_id 
FROM Business 
WHERE stars >= 3 AND stars < 5 AND city = 'Tempe';
```
-------------------------3919 sample_num
```sql
SELECT COUNT(*) 
FROM Users 
WHERE user_yelping_since_year >= '2010' AND user_yelping_since_year < '2013' AND user_fans = 'Low';
```
-------------------------3920 sample_num
```sql
SELECT review_length 
FROM Reviews 
WHERE user_id = 60776 AND business_id = 1;
```
-------------------------3921 sample_num
```sql
SELECT a.attribute_name
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.city = 'Scottsdale' AND b.review_count = 'High';
```
-------------------------3922 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS count_below_3_stars
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Automotive' AND b.stars < 3;
```
-------------------------3923 sample_num
```sql
SELECT b.business_id, b.stars
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.active = 'true' AND c.category_name = 'Pets';
```
-------------------------3924 sample_num
```sql
SELECT a.attribute_name
FROM Business_Attributes ba
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE ba.business_id = (
    SELECT business_id
    FROM Business
    ORDER BY stars DESC
    LIMIT 1
);
```
-------------------------3925 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Reviews r ON b.business_id = r.business_id
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE r.review_length = 'Short' 
  AND b.business_id BETWEEN 5 AND 10
  AND r.review_stars = (SELECT MAX(review_stars) 
                        FROM Reviews 
                        WHERE business_id BETWEEN 5 AND 10 
                          AND review_length = 'Short')
LIMIT 1;
```
-------------------------3926 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS active_business_count
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.active = 'true' 
  AND a.attribute_name = 'Wi-Fi' 
  AND b.review_count = 'Medium';
```
-------------------------3927 sample_num
```sql
SELECT bh.opening_time, bh.closing_time
FROM Business_Hours bh
JOIN Business b ON bh.business_id = b.business_id
WHERE b.city = 'Gilbert' AND b.stars = (SELECT MAX(stars) FROM Business WHERE city = 'Gilbert');
```
-------------------------3928 sample_num
```sql
SELECT c.category_name, a.attribute_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.active = 'true' 
  AND b.city = 'Mesa' 
  AND b.state = 'AZ' 
  AND b.review_count = 'Low';
```
-------------------------3929 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.active = 'FALSE' AND b.state = 'AZ';
```
-------------------------3930 sample_num
```sql
SELECT DISTINCT b.city
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE bh.opening_time = '9AM' AND bh.closing_time = '9PM' AND d.day_of_week = 'Saturday';
```
-------------------------3931 sample_num
```sql
SELECT ba.attribute_value
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
WHERE b.active = 'FALSE'
  AND b.city = 'Phoenix'
  AND b.state = 'AZ'
  AND b.stars = 3.5
  AND b.review_count = 'Medium';
```
-------------------------3932 sample_num
```sql
SELECT bh.opening_time
FROM Business_Hours bh
JOIN Business b ON bh.business_id = b.business_id
WHERE b.active = 'true' AND b.city = 'Surprise' AND b.review_count = 'Low';
```
-------------------------3933 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN b.stars < 3 THEN 1 END) * 100.0 / COUNT(b.business_id)) AS percentage
FROM 
    Business b
JOIN 
    Business_Categories bc ON b.business_id = bc.business_id
JOIN 
    Categories c ON bc.category_id = c.category_id
WHERE 
    c.category_name = 'Local Services';
```
-------------------------3934 sample_num
```sql
SELECT bh.closing_time, d.day_of_week
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE b.active = 'true'
  AND b.city = 'Scottsdale'
  AND b.stars > (SELECT AVG(stars) * 0.6 FROM Business);
```
-------------------------3935 sample_num
```sql
SELECT COUNT(*) 
FROM Users 
WHERE user_yelping_since_year = 2014 AND user_fans = 0;
```
-------------------------3936 sample_num
```sql
SELECT u.user_id
FROM Users u
JOIN Users_Compliments uc ON u.user_id = uc.user_id
WHERE uc.number_of_compliments < 5
LIMIT 5;
```
-------------------------3937 sample_num
```sql
SELECT user_id 
FROM Users 
WHERE user_average_stars = 4 
LIMIT 10;
```
-------------------------3938 sample_num
```sql
SELECT b.city
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE bh.opening_time = '10AM' AND bh.closing_time = '12PM' AND d.day_of_week = 'Sunday';
```
-------------------------3939 sample_num
```sql
SELECT COUNT(DISTINCT ba.business_id) AS businesses_open_24_hours
FROM Business_Attributes ba
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'Open 24 Hours' AND ba.attribute_value = 'true';
```
-------------------------3940 sample_num
```sql
SELECT DISTINCT ba.business_id
FROM Business_Attributes ba
JOIN Attributes a ON ba.attribute_id = a.attribute_id
JOIN Business b ON ba.business_id = b.business_id
WHERE b.active = true 
AND a.attribute_name IN ('Good for Groups', 'Good for Dancing')
GROUP BY ba.business_id
HAVING COUNT(DISTINCT a.attribute_name) = 2
LIMIT 5;
```
-------------------------3941 sample_num
```sql
SELECT b.business_id
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE b.active = 'true' AND b.city = 'Ahwatukee' AND d.day_of_week = 'Sunday';
```
-------------------------3942 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.active = 'true' AND b.state != 'AZ';
```
-------------------------3943 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.review_count = 'High' AND b.stars = 2;
```
-------------------------3944 sample_num
```sql
SELECT COUNT(DISTINCT ba.business_id) AS romantic_business_count
FROM Business_Attributes ba
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'ambience_romantic' AND ba.attribute_value = 'true';
```
-------------------------3945 sample_num
```sql
SELECT b.city
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE bh.opening_time = '1PM' AND bh.closing_time = '6PM' AND d.day_of_week = 'Saturday';
```
-------------------------3946 sample_num
```sql
SELECT SUM(u.user_fans) AS total_fans
FROM Users u
JOIN Tips t ON u.user_id = t.user_id
WHERE t.likes = (SELECT MAX(likes) FROM Tips);
```
-------------------------3947 sample_num
```sql
SELECT DISTINCT b.city
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
JOIN Checkins c ON b.business_id = c.business_id
WHERE bh.opening_time = '12AM' 
  AND bh.closing_time = '1AM' 
  AND d.day_of_week = 'Saturday';
```
-------------------------3948 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS number_of_businesses
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Shopping Centers' AND b.review_count = 'High';
```
-------------------------3949 sample_num
```sql
SELECT COUNT(DISTINCT ba.business_id) AS businesses_accepting_insurance
FROM Business_Attributes ba
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'Accepts Insurance' AND ba.attribute_value = 'true';
```
-------------------------3950 sample_num
```sql
SELECT AVG(r.review_stars) AS average_review_stars
FROM Reviews r
JOIN Business b ON r.business_id = b.business_id
WHERE b.state IN ('South Carolina', 'California');
```
-------------------------3951 sample_num
```sql
SELECT 
    (SELECT COUNT(b.business_id) 
     FROM Business b 
     JOIN Business_Hours bh ON b.business_id = bh.business_id 
     JOIN Days d ON bh.day_id = d.day_id 
     WHERE d.day_of_week = 'Monday' 
     AND bh.opening_time = '10AM' 
     AND bh.closing_time = '9PM') -
    (SELECT COUNT(b.business_id) 
     FROM Business b 
     JOIN Business_Hours bh ON b.business_id = bh.business_id 
     JOIN Days d ON bh.day_id = d.day_id 
     WHERE d.day_of_week = 'Tuesday' 
     AND bh.opening_time = '10AM' 
     AND bh.closing_time = '9PM') AS difference;
```
-------------------------3952 sample_num
```sql
SELECT attribute_id FROM Attributes WHERE attribute_name = 'Accepts Insurance';
```
-------------------------3953 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE active = 'true' AND city = 'Phoenix';
```
-------------------------3954 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE stars = 4 AND city = 'Mesa';
```
-------------------------3955 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE city = 'Gilbert' AND review_count = 'High';
```
-------------------------3956 sample_num
```sql
SELECT business_id 
FROM Business 
WHERE active = 'true' AND city = 'Gilbert' 
ORDER BY review_count DESC 
LIMIT 1;
```
-------------------------3957 sample_num
```sql
SELECT COUNT(*) AS long_review_count
FROM Reviews r
JOIN Business b ON r.business_id = b.business_id
WHERE b.city = 'Tempe' AND b.stars = 3.5 AND b.review_count = 'Uber' AND r.review_length = 'Long';
```
-------------------------3958 sample_num
```sql
SELECT ba.attribute_value 
FROM Business_Attributes ba 
JOIN Business b ON ba.business_id = b.business_id 
WHERE b.city = 'Mesa' 
AND b.review_count = (SELECT review_count FROM Business WHERE business_id = (SELECT business_id FROM Business WHERE city = 'Mesa' LIMIT 1)) 
AND ba.attribute_id = (SELECT attribute_id FROM Attributes WHERE attribute_name = 'Noise Level');
```
-------------------------3959 sample_num
```sql
SELECT ba.attribute_value 
FROM Business_Attributes ba 
JOIN Attributes a ON ba.attribute_id = a.attribute_id 
WHERE ba.business_id = 14033 AND a.attribute_name = 'good_for_dinner';
```
-------------------------3960 sample_num
```sql
SELECT opening_time, closing_time 
FROM Business_Hours 
JOIN Days ON Business_Hours.day_id = Days.day_id 
WHERE Business_Hours.business_id = '15098' AND Days.day_of_week = 'Monday';
```
-------------------------3961 sample_num
```sql
SELECT DISTINCT b.business_id
FROM Reviews r
JOIN Business b ON r.business_id = b.business_id
WHERE r.review_stars = 5 
  AND r.review_votes_funny = 'Uber' 
  AND b.city = 'Phoenix';
```
-------------------------3962 sample_num
```sql
SELECT b.city 
FROM Tips t 
JOIN Business b ON t.business_id = b.business_id 
WHERE t.tip_length = 'Medium' AND t.likes = 3;
```
-------------------------3963 sample_num
```sql
SELECT SUM(uc.number_of_compliments) AS funny_compliments
FROM Users u
JOIN Users_Compliments uc ON u.user_id = uc.user_id
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE u.user_yelping_since_year = '2010'
  AND u.user_average_stars = '4.5'
  AND c.compliment_type = 'funny';
```
-------------------------3964 sample_num
```sql
SELECT SUM(number_of_compliments) AS cool_compliments
FROM Users_Compliments
JOIN Compliments ON Users_Compliments.compliment_id = Compliments.compliment_id
WHERE Users_Compliments.user_id = 41717 AND Compliments.compliment_type = 'cool';
```
-------------------------3965 sample_num
```sql
SELECT COUNT(*) > 0 AS has_parking_lot
FROM Business_Attributes
WHERE business_id = '12476' AND attribute_value = 'parking_lot';
```
-------------------------3966 sample_num
```sql
SELECT COUNT(*) > 0 AS is_mastercard_payment_possible
FROM Business_Attributes
WHERE business_id = '12476' AND attribute_value = 'payment_types_mastercard';
```
-------------------------3967 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.category_name = 'Pets' THEN 1 END) * 100.0 / COUNT(b.business_id)) AS percentage
FROM 
    Business b
LEFT JOIN 
    Business_Categories bc ON b.business_id = bc.business_id
LEFT JOIN 
    Categories c ON bc.category_id = c.category_id;
```
-------------------------3968 sample_num
```sql
SELECT 
    DIVIDE(
        (SELECT COUNT(DISTINCT b.business_id) 
         FROM Business b 
         JOIN Business_Categories bc ON b.business_id = bc.business_id 
         JOIN Categories c ON bc.category_id = c.category_id 
         WHERE c.category_name = 'Women''s Clothing'),
        (SELECT COUNT(DISTINCT b.business_id) 
         FROM Business b 
         JOIN Business_Categories bc ON b.business_id = bc.business_id 
         JOIN Categories c ON bc.category_id = c.category_id 
         WHERE c.category_name = 'Men''s Clothing')
    ) AS ratio;
```
-------------------------3969 sample_num
```sql
SELECT business_id, active, city 
FROM Business 
WHERE state = 'CA';
```
-------------------------3970 sample_num
```sql
SELECT (COUNT(CASE WHEN active = 'true' THEN 1 END) * 100.0 / COUNT(business_id)) AS running_business_percentage
FROM Business;
```
-------------------------3971 sample_num
```sql
SELECT attribute_id, attribute_name 
FROM Attributes 
WHERE attribute_name LIKE 'music%';
```
-------------------------3972 sample_num
```sql
SELECT year_id, COUNT(user_id) AS elite_user_count
FROM Elite
WHERE year_id BETWEEN 2006 AND 2007
GROUP BY year_id
ORDER BY elite_user_count DESC
LIMIT 1;
```
-------------------------3973 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN uc.number_of_compliments = 'Low' THEN 1 END) * 100.0) / COUNT(uc.user_id) AS low_compliments_percentage
FROM 
    Users_Compliments uc;
```
-------------------------3974 sample_num
```sql
SELECT business_id, user_id 
FROM Reviews 
WHERE review_votes_cool = 'Uber';
```
-------------------------3975 sample_num
```sql
SELECT u.user_id, t.business_id, t.tip_length
FROM Users u
JOIN Tips t ON u.user_id = t.user_id
WHERE u.user_yelping_since_year = '2004' AND u.user_fans = 'High';
```
-------------------------3976 sample_num
```sql
SELECT b.business_id, b.active, r.user_id, u.user_yelping_since_year
FROM Reviews r
JOIN Business b ON r.business_id = b.business_id
JOIN Users u ON r.user_id = u.user_id
WHERE r.review_votes_funny = 'Uber' AND r.review_votes_cool = 'Uber' AND r.review_length > 0;
```
-------------------------3977 sample_num
```sql
SELECT ba.attribute_id, ba.business_id, b.city, b.active
FROM Business_Attributes ba
JOIN Business b ON ba.business_id = b.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'music_playlist';
```
-------------------------3978 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN a.attribute_name = 'Accepts Credit Cards' THEN 1 END) * 100.0) / COUNT(b.business_id) AS percentage
FROM 
    Business b
LEFT JOIN 
    Business_Attributes ba ON b.business_id = ba.business_id
LEFT JOIN 
    Attributes a ON ba.attribute_id = a.attribute_id;
```
-------------------------3979 sample_num
```sql
SELECT r.user_id, r.review_length
FROM Reviews r
JOIN Business b ON r.business_id = b.business_id
WHERE b.active = 'false' AND b.city = 'San Tan Valley' AND r.review_stars = 5;
```
-------------------------3980 sample_num
```sql
SELECT u.user_average_stars, e.year_id, c.compliment_type
FROM Users u
JOIN Elite e ON u.user_id = e.user_id
JOIN Users_Compliments uc ON u.user_id = uc.user_id
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE u.user_id = 6027 AND uc.number_of_compliments = 'Uber';
```
-------------------------3981 sample_num
```sql
SELECT b.business_id, b.state, b.city
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Coffee & Tea'
LIMIT 5;
```
-------------------------3982 sample_num
```sql
SELECT c.category_name
FROM Categories c
JOIN Business_Categories bc ON c.category_id = bc.category_id
GROUP BY c.category_id
HAVING (COUNT(bc.business_id) * 100.0 / (SELECT COUNT(*) FROM Business)) > 10;
```
-------------------------3983 sample_num
```sql
SELECT r.user_id, u.user_fans
FROM Reviews r
JOIN Business b ON r.business_id = b.business_id
JOIN Users u ON r.user_id = u.user_id
WHERE b.city = 'Sun Lakes' AND b.stars = 5;
```
-------------------------3984 sample_num
```sql
SELECT 
    c.category_name, 
    COUNT(b.business_id) AS business_count
FROM 
    Categories c
JOIN 
    Business_Categories bc ON c.category_id = bc.category_id
JOIN 
    Business b ON bc.business_id = b.business_id
WHERE 
    c.category_name IN ('Men''s Clothing', 'Women''s Clothing')
GROUP BY 
    c.category_name;
```
-------------------------3985 sample_num
```sql
SELECT c.compliment_type, SUM(uc.number_of_compliments) AS total_compliments, u.user_fans
FROM Users_Compliments uc
JOIN Compliments c ON uc.compliment_id = c.compliment_id
JOIN Users u ON uc.user_id = u.user_id
WHERE u.user_id < 100 AND uc.number_of_compliments = 'Uber'
GROUP BY c.compliment_type, u.user_fans
ORDER BY total_compliments DESC
LIMIT 1;
```
-------------------------3986 sample_num
```sql
SELECT b.business_id, b.active, b.city, b.state, b.stars, b.review_count
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE bh.closing_time = '8PM';
```
-------------------------3987 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE stars = 2 AND city = 'Phoenix' AND state = 'AZ';
```
-------------------------3988 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE city = 'Tempe' AND stars > 3;
```
-------------------------3989 sample_num
```sql
SELECT * FROM Users WHERE user_average_stars < 3 AND user_yelping_since_year = 2012;
```
-------------------------3990 sample_num
```sql
SELECT (COUNT(CASE WHEN stars = 5 THEN 1 END) * 100.0 / COUNT(business_id)) AS percentage_of_5_stars
FROM Business;
```
-------------------------3991 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM Reviews GROUP BY business_id ORDER BY COUNT(*) DESC LIMIT 1) -
    (SELECT COUNT(*) FROM Reviews GROUP BY business_id ORDER BY COUNT(*) ASC LIMIT 1) AS review_difference;
```
-------------------------3992 sample_num
```sql
SELECT b.business_id, b.city, b.state
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Hours bh ON b.business_id = bh.business_id
GROUP BY b.business_id, b.city, b.state
HAVING c.category_name = 'Tires' AND COUNT(DISTINCT bh.opening_time) = 7;
```
-------------------------3993 sample_num
```sql
SELECT user_id 
FROM Elite 
WHERE year_id = (SELECT year_id FROM Years WHERE actual_year = 2012);
```
-------------------------3994 sample_num
```sql
SELECT b.business_id
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Shopping' AND b.stars = 4;
```
-------------------------3995 sample_num
```sql
SELECT COUNT(DISTINCT business_id) AS low_checkins_sunday_10am
FROM Checkins
JOIN Days ON Checkins.day_id = Days.day_id
WHERE Days.day_of_week = 'Sunday' AND Checkins.label_time_10 = 'Low';
```
-------------------------3996 sample_num
```sql
SELECT COUNT(DISTINCT r.business_id) 
FROM Reviews r 
JOIN Business b ON r.business_id = b.business_id 
WHERE b.city = 'Glendale' AND r.user_id = 20241;
```
-------------------------3997 sample_num
```sql
SELECT DISTINCT b.city
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Pet Services';
```
-------------------------3998 sample_num
```sql
SELECT COUNT(*) 
FROM Users_Compliments uc
JOIN Compliments c ON uc.compliment_id = c.compliment_id
JOIN Reviews r ON uc.user_id = r.user_id
WHERE c.compliment_type = 'photos' AND r.review_votes_cool = 'High';
```
-------------------------3999 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE active = 'false' 
AND business_id IN (
    SELECT business_id 
    FROM Business_Attributes 
    GROUP BY business_id 
    HAVING COUNT(attribute_id) > 10
);
```
-------------------------4000 sample_num
```sql
SELECT b.business_id, b.active, b.city, b.state, b.stars, b.review_count
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.city = 'Mesa' AND a.attribute_name = 'Alcohol';
```
-------------------------4001 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN review_votes_funny = 'Low' THEN business_id END) * 100.0 / COUNT(business_id)) AS percentage_low_funny_votes
FROM 
    Reviews r
JOIN 
    Business b ON r.business_id = b.business_id
WHERE 
    b.city = 'Phoenix';
```
-------------------------4002 sample_num
```sql
SELECT 
    (SELECT COUNT(b.business_id) 
     FROM Business b 
     JOIN Business_Categories bc ON b.business_id = bc.business_id 
     JOIN Categories c ON bc.category_id = c.category_id 
     WHERE c.category_name = 'Shopping') * 1.0 / 
    (SELECT COUNT(b.business_id) 
     FROM Business b 
     JOIN Business_Categories bc ON b.business_id = bc.business_id 
     JOIN Categories c ON bc.category_id = c.category_id 
     WHERE c.category_name = 'Pets') AS ratio;
```
-------------------------4003 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS number_of_businesses
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Banks & Credit Unions';
```
-------------------------4004 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE active = 'true' AND city = 'Casa Grande';
```
-------------------------4005 sample_num
```sql
SELECT opening_time 
FROM Business_Hours 
JOIN Days ON Business_Hours.day_id = Days.day_id 
WHERE Business_Hours.business_id = 12 AND Days.day_of_week = 'Monday';
```
-------------------------4006 sample_num
```sql
SELECT COUNT(DISTINCT ba.business_id) AS business_count
FROM Business_Attributes ba
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'Good for Kids' AND ba.attribute_value = 'true';
```
-------------------------4007 sample_num
```sql
SELECT business_id, stars, review_count
FROM Business
WHERE active = 'true' AND city = 'Gilbert' AND review_count = 'High'
ORDER BY stars DESC
LIMIT 1;
```
-------------------------4008 sample_num
```sql
SELECT b.business_id, b.stars, c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.stars = 5 AND b.city = 'Ahwatukee' AND b.state = 'AZ';
```
-------------------------4009 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN stars > 3 THEN business_id END) * 100.0 / COUNT(business_id)) AS percent_wonderful_experience
FROM 
    Business
WHERE 
    active = 'false' AND city = 'Avondale';
```
-------------------------4010 sample_num
```sql
SELECT u.user_id, 
       CASE WHEN e.user_id IS NOT NULL THEN 'Yes' ELSE 'No' END AS is_elite
FROM Users u
LEFT JOIN Elite e ON u.user_id = e.user_id
WHERE u.user_yelping_since_year = 2004;
```
-------------------------4011 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN review_length = 'Long' THEN business_id END) * 100.0 / COUNT(business_id)) AS percent_long_reviews
FROM 
    Reviews
WHERE 
    review_stars = 5;
```
-------------------------4012 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN user_fans = 0 THEN 1 END) * 100.0 / COUNT(*)) AS percent_no_fans
FROM 
    Users
WHERE 
    user_average_stars >= 4;
```
-------------------------4013 sample_num
```sql
SELECT COUNT(*) 
FROM Tips 
WHERE business_id = 2 AND tip_length = 'Short';
```
-------------------------4014 sample_num
```sql
SELECT user_id
FROM Users
WHERE user_average_stars = 5
ORDER BY user_yelping_since_year ASC
LIMIT 1;
```
-------------------------4015 sample_num
```sql
SELECT bh.business_id, bh.opening_time, bh.closing_time
FROM Business_Hours bh
JOIN Business b ON bh.business_id = b.business_id
WHERE b.city = 'Black Canyon City' 
AND b.review_count > (SELECT AVG(review_count) FROM Business);
```
-------------------------4016 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN uc.compliment_id = (SELECT compliment_id FROM Compliments WHERE compliment_type = 'cute') THEN uc.user_id END) * 100.0) / COUNT(uc.user_id) AS percent_cute_compliments
FROM 
    Users_Compliments uc
WHERE 
    uc.number_of_compliments = 'High';
```
-------------------------4017 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS businesses_with_no_attributes
FROM Business b
LEFT JOIN Business_Attributes ba ON b.business_id = ba.business_id
WHERE ba.attribute_value IN ('none', 'no', 'false') OR ba.business_id IS NULL;
```
-------------------------4018 sample_num
```sql
SELECT opening_time, closing_time 
FROM Business_Hours 
WHERE business_id = 1 AND day_id = 2;
```
-------------------------4019 sample_num
```sql
SELECT DISTINCT b.city
FROM Business b
JOIN Reviews r ON b.business_id = r.business_id
WHERE r.review_length = 'Medium';
```
-------------------------4020 sample_num
```sql
SELECT closing_time 
FROM Business_Hours 
WHERE business_id = 4 
AND day_id = (SELECT day_id FROM Days WHERE day_of_week = 'Sunday');
```
-------------------------4021 sample_num
```sql
SELECT b.business_id, b.city, b.state, r.review_length
FROM Business b
JOIN Reviews r ON b.business_id = r.business_id
WHERE r.review_length = 'Short' AND b.city = 'Phoenix';
```
-------------------------4022 sample_num
```sql
SELECT COUNT(DISTINCT uc.user_id) AS high_compliment_users
FROM Users_Compliments uc
JOIN Users u ON uc.user_id = u.user_id
WHERE u.user_fans = 'Medium' AND uc.number_of_compliments = 'High';
```
-------------------------4023 sample_num
```sql
SELECT DISTINCT u.user_id
FROM Users u
JOIN Users_Compliments uc ON u.user_id = uc.user_id
WHERE uc.number_of_compliments = 'Low' AND u.user_yelping_since_year = 2012;
```
-------------------------4024 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE business_id NOT IN (SELECT business_id FROM Business_Attributes WHERE attribute_value <> 'None') 
AND city = 'Gilbert';
```
-------------------------4025 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS business_count
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
WHERE ba.attribute_value = 'full_bar'
AND b.stars = (SELECT AVG(stars) FROM Business);
```
-------------------------4026 sample_num
```sql
SELECT DISTINCT b.state
FROM Business_Hours bh
JOIN Business b ON bh.business_id = b.business_id
WHERE bh.opening_time = '01:00:00';
```
-------------------------4027 sample_num
```sql
SELECT c.category_name 
FROM Categories c
JOIN Business_Categories bc ON c.category_id = bc.category_id
WHERE bc.business_id = 5;
```
-------------------------4028 sample_num
```sql
SELECT uc.user_id
FROM Users_Compliments uc
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE c.compliment_type = 'photos';
```
-------------------------4029 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN tip_length = 'Medium' THEN 1 END) * 100.0 / COUNT(*)) AS medium_tip_percentage,
    user_yelping_since_year
FROM 
    Tips 
JOIN 
    Users ON Tips.user_id = Users.user_id
GROUP BY 
    user_yelping_since_year;
```
-------------------------4030 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN city = 'Mesa' THEN 1 END) * 100.0 / COUNT(*)) AS percentage,
    ba.attribute_value
FROM 
    Business b
JOIN 
    Business_Attributes ba ON b.business_id = ba.business_id
GROUP BY 
    ba.attribute_value;
```
-------------------------4031 sample_num
```sql
SELECT DISTINCT b.state
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE bh.closing_time = '00:00:00';
```
-------------------------4032 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
WHERE ba.attribute_value = 'beer_and_wine' AND b.city = 'Peoria';
```
-------------------------4033 sample_num
```sql
SELECT u.user_id, MIN(u.user_yelping_since_year) AS earliest_join_year
FROM Users u
JOIN Users_Compliments uc ON u.user_id = uc.user_id
WHERE uc.number_of_compliments = 'High'
GROUP BY u.user_id
ORDER BY earliest_join_year ASC;
```
-------------------------4034 sample_num
```sql
SELECT business_id
FROM Reviews
GROUP BY business_id
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------4035 sample_num
```sql
SELECT year_id, COUNT(user_id) AS elite_user_count
FROM Elite
GROUP BY year_id
ORDER BY elite_user_count DESC
LIMIT 1;
```
-------------------------4036 sample_num
```sql
SELECT COUNT(DISTINCT business_id) 
FROM Reviews 
WHERE review_stars = 5 AND review_votes_funny = 'uber';
```
-------------------------4037 sample_num
```sql
SELECT COUNT(DISTINCT u.user_id) AS uber_funny_votes_users
FROM Users u
JOIN Reviews r ON u.user_id = r.user_id
WHERE r.review_votes_funny = 'uber' AND u.user_fans > 0;
```
-------------------------4038 sample_num
```sql
SELECT business_id
FROM Business_Hours
ORDER BY (closing_time - opening_time) ASC
LIMIT 1;
```
-------------------------4039 sample_num
```sql
SELECT business_id 
FROM Business_Hours 
WHERE day_id BETWEEN 1 AND 7 
GROUP BY business_id 
HAVING COUNT(*) = 7 AND MIN(opening_time) = MAX(closing_time);
```
-------------------------4040 sample_num
```sql
SELECT 
    AVG(tip_length) AS average_tip_length, 
    AVG(likes) AS average_likes
FROM 
    Tips t
JOIN 
    Business b ON t.business_id = b.business_id
JOIN 
    Business_Categories bc ON b.business_id = bc.business_id
JOIN 
    Categories c ON bc.category_id = c.category_id
WHERE 
    c.category_name = 'Hotels & Travel'
GROUP BY 
    tip_length
ORDER BY 
    tip_length;
```
-------------------------4041 sample_num
```sql
SELECT u.user_id, u.user_average_stars
FROM Users u
JOIN Reviews r ON u.user_id = r.user_id
WHERE r.review_votes_funny = 'uber' 
  AND r.review_votes_useful = 'uber' 
  AND r.review_votes_cool = 'uber'
GROUP BY u.user_id, u.user_average_stars
HAVING COUNT(DISTINCT r.business_id) = (SELECT COUNT(DISTINCT business_id) FROM Reviews);
```
-------------------------4042 sample_num
```sql
SELECT 
    DIVIDE(
        COUNT(CASE WHEN b.stars BETWEEN 3.5 AND 5 THEN 1 END), 
        COUNT(CASE WHEN b.stars BETWEEN 1 AND 2.5 THEN 1 END)
    ) AS good_to_bad_ratio
FROM 
    Business b
JOIN 
    Business_Hours bh ON b.business_id = bh.business_id
WHERE 
    bh.day_id BETWEEN 1 AND 7 
    AND bh.opening_time = bh.closing_time;
```
-------------------------4043 sample_num
```sql
SELECT b.business_id, COUNT(r.user_id) AS review_count
FROM Reviews r
JOIN Business b ON r.business_id = b.business_id
GROUP BY b.business_id
ORDER BY review_count DESC
LIMIT 10;

SELECT c.category_name
FROM Business_Categories bc
JOIN Categories c ON bc.category_id = c.category_id
GROUP BY c.category_name
ORDER BY COUNT(bc.business_id) DESC
LIMIT 3;
```
-------------------------4044 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b 
JOIN Reviews r ON b.business_id = r.business_id 
WHERE b.state = 'Arizona' 
GROUP BY b.business_id 
HAVING AVG(r.review_stars) < 3.0;
```
-------------------------4045 sample_num
```sql
SELECT 
    (COUNT(u.user_id) - COUNT(e.user_id)) * 100.0 / COUNT(u.user_id) AS percentage
FROM 
    Users u
LEFT JOIN 
    Elite e ON u.user_id = e.user_id;
```
-------------------------4046 sample_num
```sql
SELECT c.compliment_type, COUNT(uc.compliment_id) AS compliment_count
FROM Users u
JOIN Users_Compliments uc ON u.user_id = uc.user_id
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE u.user_fans = 'uber'
GROUP BY c.compliment_type
ORDER BY compliment_count DESC
LIMIT 1;
```
-------------------------4047 sample_num
```sql
SELECT AVG(user_yelping_since_year) 
FROM Users 
WHERE user_fans = 'uber';
```
-------------------------4048 sample_num
```sql
SELECT AVG(u.user_yelping_since_year) AS average_year_to_elite
FROM Users u
JOIN Elite e ON u.user_id = e.user_id;
```
-------------------------4049 sample_num
```sql
SELECT 
    COUNT(b.business_id) AS businesses_opened_more_than_8_hours,
    (COUNT(CASE WHEN b.active = 'true' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_active_businesses
FROM 
    Business b
JOIN 
    Business_Hours bh ON b.business_id = bh.business_id
WHERE 
    b.city = 'Mesa' 
    AND (bh.closing_time - bh.opening_time) > 8;
```
-------------------------4050 sample_num
```sql
SELECT C.category_name
FROM Business B
JOIN Business_Categories BC ON B.business_id = BC.business_id
JOIN Categories C ON BC.category_id = C.category_id
JOIN Business_Hours BH ON B.business_id = BH.business_id
WHERE B.active = 'true' 
AND BH.opening_time >= '17:00' 
AND B.city = 'Phoenix'
GROUP BY C.category_name
ORDER BY COUNT(B.business_id) DESC
LIMIT 3;
```
-------------------------4051 sample_num
```sql
SELECT user_id, COUNT(*) AS review_count
FROM Reviews
WHERE business_id IN (
    SELECT business_id
    FROM Business_Attributes
    WHERE attribute_id = (SELECT attribute_id FROM Attributes WHERE attribute_name = 'Delivery')
)
GROUP BY user_id
ORDER BY review_count DESC
LIMIT 1;
```
-------------------------4052 sample_num
```sql
SELECT AVG(review_count) AS average_reviews
FROM Business
WHERE active = 'true' AND business_id IN (
    SELECT business_id
    FROM Business_Hours
    GROUP BY business_id
    HAVING SUM(TIMESTAMPDIFF(HOUR, opening_time, closing_time)) < 30
);
```
-------------------------4053 sample_num
```sql
SELECT COUNT(DISTINCT business_id) 
FROM Business_Hours 
WHERE opening_time = '8AM' AND closing_time = '6PM';
```
-------------------------4054 sample_num
```sql
SELECT business_id 
FROM Business_Hours 
WHERE opening_time = '10AM' AND day_id = 6;
```
-------------------------4055 sample_num
```sql
SELECT business_id, day_id 
FROM Business_Hours 
WHERE opening_time = '8AM' AND closing_time = '6PM';
```
-------------------------4056 sample_num
```sql
SELECT COUNT(business_id) 
FROM Business 
WHERE stars > 4;
```
-------------------------4057 sample_num
```sql
SELECT c.category_name
FROM Business_Categories bc
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Hours bh ON bc.business_id = bh.business_id
WHERE bh.day_id = 1;
```
-------------------------4058 sample_num
```sql
SELECT bh.day_id, d.day_of_week, bh.opening_time
FROM Business_Hours bh
JOIN Business b ON bh.business_id = b.business_id
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Days d ON bh.day_id = d.day_id
WHERE c.category_name = 'Pets';
```
-------------------------4059 sample_num
```sql
SELECT bh.closing_time, bh.day_id
FROM Business_Hours bh
JOIN Business_Categories bc ON bh.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Doctors';
```
-------------------------4060 sample_num
```sql
SELECT bc.category_id, c.category_name, COUNT(DISTINCT bh.day_id) AS working_days
FROM Business_Categories bc
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Hours bh ON bc.business_id = bh.business_id
WHERE bh.day_id BETWEEN 2 AND 7
GROUP BY bc.category_id, c.category_name
HAVING COUNT(DISTINCT bh.day_id) = (
    SELECT MAX(working_days)
    FROM (
        SELECT COUNT(DISTINCT bh.day_id) AS working_days
        FROM Business_Categories bc
        JOIN Business_Hours bh ON bc.business_id = bh.business_id
        WHERE bh.day_id BETWEEN 2 AND 7
        GROUP BY bc.business_id
    ) AS subquery
);
```
-------------------------4061 sample_num
```sql
SELECT bh.business_id
FROM Business_Hours bh
JOIN Days d ON bh.day_id = d.day_id
JOIN Business_Categories bc ON bh.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE d.day_of_week = 'Sunday' 
  AND c.category_name = 'Arts & Entertainment';
```
-------------------------4062 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'DJs' AND b.stars < 5;
```
-------------------------4063 sample_num
```sql
SELECT b.business_id
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE b.active = 'true' AND bh.opening_time = '7AM' AND bh.closing_time = '8PM';
```
-------------------------4064 sample_num
```sql
SELECT COUNT(*) 
FROM Business b 
JOIN Business_Categories bc ON b.business_id = bc.business_id 
JOIN Categories c ON bc.category_id = c.category_id 
WHERE c.category_name = 'Stadiums & Arenas' 
AND b.stars = (SELECT MAX(stars) FROM Business WHERE business_id IN (SELECT business_id FROM Business_Categories WHERE category_id = (SELECT category_id FROM Categories WHERE category_name = 'Stadiums & Arenas')));
```
-------------------------4065 sample_num
```sql
SELECT COUNT(DISTINCT bc.category_id) AS low_review_count_categories
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
WHERE b.review_count < 10 AND b.stars > 2;
```
-------------------------4066 sample_num
```sql
SELECT b.business_id
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE c.category_name = 'Accessories' AND bh.opening_time < '07:00:00';
```
-------------------------4067 sample_num
```sql
SELECT COUNT(*) 
FROM Business b 
JOIN Business_Hours bh ON b.business_id = bh.business_id 
WHERE b.state = 'Arizona' AND b.active = 'true' AND bh.opening_time > '12PM';
```
-------------------------4068 sample_num
```sql
SELECT b.business_id, c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Reviews r ON b.business_id = r.business_id
WHERE r.user_id = 16328;
```
-------------------------4069 sample_num
```sql
SELECT 
    b.business_id, 
    b.active, 
    b.city, 
    b.state, 
    b.stars, 
    b.review_count,
    (COUNT(CASE WHEN b.stars < 2 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Business b
JOIN 
    Business_Categories bc ON b.business_id = bc.business_id
JOIN 
    Categories c ON bc.category_id = c.category_id
WHERE 
    c.category_name = 'Food'
GROUP BY 
    b.business_id, b.active, b.city, b.state, b.stars, b.review_count;
```
-------------------------4070 sample_num
```sql
SELECT 
    (COUNT(B.business_id) * 100.0 / NULLIF(COUNT(B2.business_id), 0)) AS percentage
FROM 
    Business B
JOIN 
    Business_Categories BC ON B.business_id = BC.business_id
JOIN 
    Business_Hours BH ON B.business_id = BH.business_id
WHERE 
    BC.category_id = (SELECT category_id FROM Categories WHERE category_name = 'Food')
    AND BH.opening_time = '7AM' 
    AND BH.closing_time = '8PM'
JOIN 
    Business_Hours B2 ON B.business_id = B2.business_id
WHERE 
    B2.opening_time = '7AM' 
    AND B2.closing_time = '8PM';
```
-------------------------4071 sample_num
```sql
SELECT 
    CASE 
        WHEN b.review_count > 100 THEN 'High'
        WHEN b.review_count BETWEEN 50 AND 100 THEN 'Medium'
        ELSE 'Low'
    END AS review_count_category,
    COUNT(b.business_id) AS number_of_running_business
FROM 
    Business b
WHERE 
    b.active = 'true' AND 
    b.city = 'Cave Creek'
GROUP BY 
    review_count_category;
```
-------------------------4072 sample_num
```sql
SELECT AVG(user_id) AS average_user_id
FROM Users
WHERE user_yelping_since_year BETWEEN 2005 AND 2014;
```
-------------------------4073 sample_num
```sql
SELECT 
    DIVIDE(
        COUNT(CASE WHEN active = 'true' AND review_count = 'Low' THEN business_id END), 
        COUNT(CASE WHEN active = 'false' AND review_count = 'Low' THEN business_id END)
    ) AS active_inactive_ratio
FROM 
    Business;
```
-------------------------4074 sample_num
```sql
SELECT user_id 
FROM Elite 
WHERE year_id = '2006' 
LIMIT 5;
```
-------------------------4075 sample_num
```sql
SELECT category_id, category_name 
FROM Categories 
WHERE category_name LIKE 'P%' 
LIMIT 5;
```
-------------------------4076 sample_num
```sql
SELECT user_id, review_stars 
FROM Reviews 
WHERE business_id = 35 AND review_length = 'medium';
```
-------------------------4077 sample_num
```sql
SELECT ba.business_id, ba.attribute_value
FROM Business_Attributes ba
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'payment_types_visa';
```
-------------------------4078 sample_num
```sql
SELECT b.business_id, b.active
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Diagnostic Imaging';
```
-------------------------4079 sample_num
```sql
SELECT u.user_id, u.user_yelping_since_year
FROM Users u
JOIN Reviews r ON u.user_id = r.user_id
WHERE r.business_id = 143 AND r.review_stars = 5;
```
-------------------------4080 sample_num
```sql
SELECT u.user_id, u.user_yelping_since_year
FROM Users u
JOIN Users_Compliments uc ON u.user_id = uc.user_id
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE c.compliment_type = 'profile' AND uc.number_of_compliments = 'Uber'
LIMIT 5;
```
-------------------------4081 sample_num
```sql
SELECT r.user_id, r.business_id, r.review_length
FROM Reviews r
JOIN Tips t ON r.business_id = t.business_id
WHERE t.likes = (SELECT MAX(likes) FROM Tips);
```
-------------------------4082 sample_num
```sql
SELECT e.user_id, uc.number_of_compliments
FROM Elite e
JOIN Years y ON e.year_id = y.year_id
JOIN Users_Compliments uc ON e.user_id = uc.user_id
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE y.actual_year BETWEEN 2005 AND 2014
AND c.compliment_type = 'photos';
```
-------------------------4083 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN bh.opening_time = '9AM' AND bh.closing_time = '9PM' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Business_Hours bh
JOIN 
    Days d ON bh.day_id = d.day_id
WHERE 
    d.day_of_week = 'Sunday';
```
-------------------------4084 sample_num
```sql
SELECT b.business_id, d.day_of_week
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE b.active = 'true' AND b.city = 'Black Canyon City';
```
-------------------------4085 sample_num
```sql
SELECT r.user_id, r.review_length
FROM Reviews r
JOIN Users u ON r.user_id = u.user_id
WHERE u.user_yelping_since_year = 2004 AND u.user_average_stars = 5;
```
-------------------------4086 sample_num
```sql
SELECT b.business_id, b.active, b.city
FROM Reviews r
JOIN Business b ON r.business_id = b.business_id
GROUP BY b.business_id, b.active, b.city
HAVING SUM(CASE WHEN r.review_stars > 4 THEN 1 ELSE 0 END) / COUNT(r.user_id) >= 0.65;
```
-------------------------4087 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM Business WHERE active = 'true' AND city = 'Glendale') AS Glendale_Business_Count,
    (SELECT COUNT(*) FROM Business WHERE active = 'true' AND city = 'Mesa') AS Mesa_Business_Count,
    (SELECT COUNT(*) FROM Business WHERE active = 'true' AND city = 'Glendale') - 
    (SELECT COUNT(*) FROM Business WHERE active = 'true' AND city = 'Mesa') AS Business_Difference
```
-------------------------4088 sample_num
```sql
SELECT SUM(t.likes) AS total_likes
FROM Tips t
JOIN Users u ON t.user_id = u.user_id
WHERE t.tip_length = 'Short' AND u.user_yelping_since_year = 2010;
```
-------------------------4089 sample_num
```sql
SELECT tip_length, COUNT(user_id) AS tip_count
FROM Tips
JOIN Users ON Tips.user_id = Users.user_id
WHERE Users.user_average_stars = 3
GROUP BY tip_length
ORDER BY tip_count DESC
LIMIT 1;
```
-------------------------4090 sample_num
```sql
SELECT SUM(likes) AS total_likes
FROM Tips t
JOIN Business b ON t.business_id = b.business_id
WHERE t.tip_length = 'Short' AND b.city = 'Goodyear';
```
-------------------------4091 sample_num
```sql
SELECT DISTINCT b.state
FROM Business b
JOIN Reviews r ON b.business_id = r.business_id
WHERE LENGTH(r.review_length) > (SELECT AVG(LENGTH(t.tip_length)) FROM Tips t WHERE t.likes > 0);
```
-------------------------4092 sample_num
```sql
SELECT 
    AVG(TIMESTAMPDIFF(MINUTE, Business_Hours.opening_time, Business_Hours.closing_time)) AS average_daily_operating_time
FROM 
    Business
JOIN 
    Business_Hours ON Business.business_id = Business_Hours.business_id
WHERE 
    Business.city = 'El Mirage' AND Business.state = 'AZ';
```
-------------------------4093 sample_num
```sql
SELECT b.business_id, d.day_of_week AS closing_day
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE b.state = 'SC';
```
-------------------------4094 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.stars = 5;
```
-------------------------4095 sample_num
```sql
SELECT DISTINCT b.state
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
WHERE ba.attribute_value = 'beer_and_wine';
```
-------------------------4096 sample_num
```sql
SELECT COUNT(*) AS medium_photo_compliments
FROM Users_Compliments uc
JOIN Compliments c ON uc.compliment_id = c.compliment_id
WHERE c.compliment_type = 'photo' AND uc.number_of_compliments = 'Medium';
```
-------------------------4097 sample_num
```sql
SELECT b.business_id 
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'Wi-Fi' AND ba.attribute_value = 'true' AND b.state = 'SC';
```
-------------------------4098 sample_num
```sql
SELECT COUNT(DISTINCT ba.business_id) AS romantic_business_count
FROM Business_Attributes ba
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'ambience_romantic' AND ba.attribute_value = 'true';
```
-------------------------4099 sample_num
```sql
SELECT 
    (SUM(CASE WHEN ba.attribute_id = (SELECT attribute_id FROM Attributes WHERE attribute_name = 'Good for Kids') AND ba.attribute_value = 'true' THEN 1 ELSE 0 END) * 100.0) / COUNT(DISTINCT ba.business_id) AS percentage_good_for_kids
FROM 
    Business_Attributes ba;
```
-------------------------4100 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE active = 'true' AND city = 'Mesa';
```
-------------------------4101 sample_num
```sql
SELECT COUNT(DISTINCT business_id) AS bad_or_terrible_experience_count
FROM Reviews
WHERE review_stars IN (1, 2);
```
-------------------------4102 sample_num
```sql
SELECT business_id 
FROM Business 
WHERE city = 'Paradise Valley' AND review_count = 'Low' AND stars > 3;
```
-------------------------4103 sample_num
```sql
SELECT COUNT(DISTINCT business_id) AS business_count
FROM Business_Attributes
GROUP BY business_id
HAVING COUNT(attribute_value) > 1;
```
-------------------------4104 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS num_businesses
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE bh.day_id BETWEEN 1 AND 7
GROUP BY b.business_id
HAVING COUNT(DISTINCT SUBTRACT(bh.closing_time, bh.opening_time)) = 1;
```
-------------------------4105 sample_num
```sql
SELECT COUNT(*) 
FROM Reviews 
JOIN Business ON Reviews.business_id = Business.business_id 
WHERE Business.active = 'true' AND Reviews.review_votes_funny = 'Uber';
```
-------------------------4106 sample_num
```sql
SELECT COUNT(DISTINCT uc.user_id) AS users_without_fans
FROM Users_Compliments uc
JOIN Users u ON uc.user_id = u.user_id
WHERE uc.number_of_compliments = 'High' AND u.user_fans = 0;
```
-------------------------4107 sample_num
```sql
SELECT c.compliment_type, COUNT(uc.number_of_compliments) AS compliment_count
FROM Users_Compliments uc
JOIN Compliments c ON uc.compliment_id = c.compliment_id
GROUP BY c.compliment_type
ORDER BY compliment_count DESC
LIMIT 1;
```
-------------------------4108 sample_num
```sql
SELECT u.user_id, u.user_average_stars
FROM Users u
JOIN Tips t ON u.user_id = t.user_id
ORDER BY t.likes DESC
LIMIT 3;
```
-------------------------4109 sample_num
```sql
SELECT c.category_name
FROM Categories c
JOIN Business_Categories bc ON c.category_id = bc.category_id
JOIN Business b ON bc.business_id = b.business_id
WHERE b.city = 'Arcadia';
```
-------------------------4110 sample_num
```sql
SELECT business_id 
FROM Business_Hours 
WHERE day_id = 1;
```
-------------------------4111 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'music_karaoke' AND ba.attribute_value = 'true' AND b.active = 'false';
```
-------------------------4112 sample_num
```sql
SELECT COUNT(DISTINCT r.business_id) AS open_businesses_with_long_reviews
FROM Business b
JOIN Reviews r ON b.business_id = r.business_id
WHERE b.active = 'true' AND b.city = 'Phoenix' AND r.review_length = 'Long';
```
-------------------------4113 sample_num
```sql
SELECT COUNT(DISTINCT u.user_id) AS low_cool_vote_users
FROM Users u
JOIN Reviews r ON u.user_id = r.user_id
WHERE u.user_votes_cool = 'Low' AND r.review_votes_cool = 'Low';
```
-------------------------4114 sample_num
```sql
SELECT COUNT(DISTINCT u.user_id) AS user_count
FROM Users u
JOIN Tips t ON u.user_id = t.user_id
WHERE t.tip_length = 'Long' AND t.likes = 2 AND u.user_fans = 'High';
```
-------------------------4115 sample_num
```sql
SELECT COUNT(DISTINCT ba.business_id) AS business_count
FROM Business_Attributes ba
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE a.attribute_name = 'ambience_trendy' AND ba.attribute_value = 'false';
```
-------------------------4116 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE b.city = 'Scottsdale' 
  AND d.day_of_week = 'Sunday' 
  AND bh.opening_time = '12PM';
```
-------------------------4117 sample_num
```sql
SELECT AVG(b.stars) AS average_stars
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE c.category_name = 'Obstetricians & Gynecologists';
```
-------------------------4118 sample_num
```sql
SELECT 
    (COUNT(DISTINCT e.user_id) * 100.0 / NULLIF((SELECT COUNT(DISTINCT u.user_id) 
    FROM Users u 
    JOIN Elite el ON u.user_id = el.user_id 
    WHERE el.year_id = (SELECT year_id FROM Years WHERE actual_year = 2011)), 0)) AS percentage_high_fans_elite
FROM 
    Users u 
JOIN 
    Elite e ON u.user_id = e.user_id 
WHERE 
    u.user_fans = 'High' 
    AND e.year_id = (SELECT year_id FROM Years WHERE actual_year = 2011);
```
-------------------------4119 sample_num
```sql
SELECT COUNT(*) 
FROM Business 
WHERE city = 'Surprise';
```
-------------------------4120 sample_num
```sql
SELECT business_id 
FROM Business 
WHERE city = 'Tempe' AND review_count = 'High';
```
-------------------------4121 sample_num
```sql
SELECT COUNT(*) AS total_active_businesses
FROM Business
WHERE active = 'true' AND state = 'AZ' AND review_count = 'Medium';
```
-------------------------4122 sample_num
```sql
SELECT business_id 
FROM Business 
WHERE stars BETWEEN 3 AND 5 AND city = 'Chandler';
```
-------------------------4123 sample_num
```sql
SELECT COUNT(*) 
FROM Users 
WHERE user_yelping_since_year BETWEEN 2009 AND 2011 
AND user_fans = 'Low';
```
-------------------------4124 sample_num
```sql
SELECT review_length 
FROM Reviews 
WHERE user_id = 11021 AND business_id = 3;
```
-------------------------4125 sample_num
```sql
SELECT ba.attribute_value
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
WHERE b.city = 'Tempe' AND b.review_count = 'Medium';
```
-------------------------4126 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM Business b 
JOIN Business_Categories bc ON b.business_id = bc.business_id 
JOIN Categories c ON bc.category_id = c.category_id 
WHERE c.category_name = 'Food' AND b.stars < 3;
```
-------------------------4127 sample_num
```sql
SELECT b.business_id, b.stars
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.active = 'true' AND c.category_name = 'Food';
```
-------------------------4128 sample_num
```sql
SELECT c.category_name, a.attribute_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.stars = (SELECT MAX(stars) FROM Business)
```
-------------------------4129 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.business_id BETWEEN 7 AND 14
AND b.stars = (SELECT MAX(stars) FROM Business WHERE review_length = 'Short' AND business_id BETWEEN 7 AND 14);
```
-------------------------4130 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS active_business_count
FROM Business b
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.active = 'true'
AND a.attribute_name = 'BYOB'
AND b.review_count = 'High';
```
-------------------------4131 sample_num
```sql
SELECT bh.opening_time, bh.closing_time
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
WHERE b.city = 'Glendale' AND b.stars = (SELECT MAX(stars) FROM Business WHERE city = 'Glendale');
```
-------------------------4132 sample_num
```sql
SELECT c.category_name, a.attribute_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
JOIN Business_Attributes ba ON b.business_id = ba.business_id
JOIN Attributes a ON ba.attribute_id = a.attribute_id
WHERE b.active = 'true' 
  AND b.city = 'Goodyear' 
  AND b.state = 'AZ' 
  AND b.review_count = 'High';
```
-------------------------4133 sample_num
```sql
SELECT c.category_name
FROM Business b
JOIN Business_Categories bc ON b.business_id = bc.business_id
JOIN Categories c ON bc.category_id = c.category_id
WHERE b.active = 'true' AND b.city = 'Glendale' AND b.state = 'AZ';
```
-------------------------4134 sample_num
```sql
SELECT DISTINCT b.city
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE bh.opening_time = '7AM' 
  AND bh.closing_time = '7PM' 
  AND d.day_of_week = 'Wednesday';
```
-------------------------4135 sample_num
```sql
SELECT ba.attribute_value 
FROM Business b 
JOIN Business_Attributes ba ON b.business_id = ba.business_id 
WHERE b.active = 'true' 
  AND b.review_count = 'Low' 
  AND b.stars = 3 
  AND b.city = 'Goodyear' 
  AND b.state = 'AZ';
```
-------------------------4136 sample_num
```sql
SELECT bh.opening_time
FROM Business_Hours bh
JOIN Business b ON bh.business_id = b.business_id
WHERE b.active = 'true' AND b.city = 'Glendale' AND b.review_count = 'Medium';
```
-------------------------4137 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN b.stars > 3 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Business b
JOIN 
    Business_Categories bc ON b.business_id = bc.business_id
JOIN 
    Categories c ON bc.category_id = c.category_id
WHERE 
    c.category_name = 'Food';
```
-------------------------4138 sample_num
```sql
SELECT bh.closing_time, d.day_of_week
FROM Business b
JOIN Business_Hours bh ON b.business_id = bh.business_id
JOIN Days d ON bh.day_id = d.day_id
WHERE b.active = 'true' 
  AND b.city = 'Goodyear' 
  AND b.stars > (SELECT AVG(stars) * 0.8 FROM Business);
```
-------------------------4139 sample_num
```sql
SELECT (COUNT(paper_id) FILTER (WHERE class_label = 'Agents') * 100.0 / COUNT(paper_id)) AS percentage
FROM paper
JOIN cites ON paper.paper_id = cites.cited_paper_id;
```
-------------------------4140 sample_num
```sql
SELECT word_cited_id, COUNT(DISTINCT c.citing_paper_id) AS citation_count
FROM content AS ct
JOIN cites AS c ON ct.paper_id = c.cited_paper_id
GROUP BY word_cited_id
ORDER BY citation_count DESC
LIMIT 1;
```
-------------------------4141 sample_num
```sql
SELECT COUNT(DISTINCT c.word_cited_id) AS total_words_cited
FROM content c
JOIN paper p ON c.paper_id = p.paper_id
WHERE p.class_label = 'AI';
```
-------------------------4142 sample_num
```sql
SELECT DISTINCT p2.paper_id, p2.class_label
FROM content c1
JOIN cites ci ON c1.paper_id = ci.citing_paper_id
JOIN content c2 ON ci.cited_paper_id = c2.paper_id
JOIN paper p2 ON c2.paper_id = p2.paper_id
WHERE c1.paper_id = 315017;
```
-------------------------4143 sample_num
```sql
SELECT c.word_cited_id, COUNT(c.word_cited_id) AS citation_count
FROM cites ci
JOIN paper p ON ci.cited_paper_id = p.paper_id
JOIN content c ON ci.cited_paper_id = c.paper_id
WHERE p.class_label = 'DB'
GROUP BY c.word_cited_id
ORDER BY citation_count DESC
LIMIT 1;
```
-------------------------4144 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.class_label = 'Agents' THEN c.word_cited_id END) * 100.0) / COUNT(c.word_cited_id) AS percentage
FROM 
    content c
JOIN 
    paper p ON c.paper_id = p.paper_id;
```
-------------------------4145 sample_num
```sql
SELECT p.paper_id, p.class_label
FROM cites c
JOIN content co ON c.citing_paper_id = co.paper_id
JOIN paper p ON c.citing_paper_id = p.paper_id
GROUP BY c.citing_paper_id, p.class_label
ORDER BY MAX(co.word_cited_id) DESC
LIMIT 1;
```
-------------------------4146 sample_num
```sql
SELECT p.paper_id, p.class_label
FROM cites c
JOIN paper p ON c.citing_paper_id = p.paper_id
JOIN content ct ON ct.paper_id = c.citing_paper_id
WHERE ct.word_cited_id = 'word1002';
```
-------------------------4147 sample_num
```sql
SELECT DISTINCT c.word_cited_id
FROM content c
JOIN paper p ON c.paper_id = p.paper_id
WHERE p.class_label = 'AI';
```
-------------------------4148 sample_num
```sql
SELECT p.class_label, COUNT(c.word_cited_id) AS cited_word_count
FROM paper p
LEFT JOIN content c ON p.paper_id = c.paper_id
WHERE p.paper_id = 'chakrabarti01integrating'
GROUP BY p.class_label;
```
-------------------------4149 sample_num
```sql
SELECT p.paper_id, p.class_label
FROM paper p
JOIN content c ON p.paper_id = c.paper_id
GROUP BY p.paper_id, p.class_label
HAVING COUNT(c.word_cited_id) > 20;
```
-------------------------4150 sample_num
```sql
SELECT DISTINCT c.word_cited_id
FROM content c
JOIN paper p1 ON c.paper_id = p1.paper_id
JOIN cites ci ON p1.paper_id = ci.cited_paper_id
JOIN paper p2 ON ci.citing_paper_id = p2.paper_id
WHERE p1.class_label = 'AI' AND p2.class_label = 'IR';
```
-------------------------4151 sample_num
```sql
WITH citation_counts AS (
    SELECT cited_paper_id, COUNT(citing_paper_id) AS citation_count
    FROM cites
    GROUP BY cited_paper_id
),
most_cited AS (
    SELECT cited_paper_id, citation_count
    FROM citation_counts
    ORDER BY citation_count DESC
    LIMIT 1
),
least_cited AS (
    SELECT cited_paper_id, citation_count
    FROM citation_counts
    ORDER BY citation_count ASC
    LIMIT 1
)
SELECT 
    (SELECT paper_id FROM most_cited) AS most_cited_paper_id,
    (SELECT citation_count FROM most_cited) AS most_cited_count,
    (SELECT paper_id FROM least_cited) AS least_cited_paper_id,
    (SELECT citation_count FROM least_cited) AS least_cited_count;
```
-------------------------4152 sample_num
```sql
SELECT AVG(CASE WHEN class_label = 'M' THEN 1 ELSE 0 END) AS average_ml_papers
FROM paper;
```
-------------------------4153 sample_num
```sql
SELECT DISTINCT c.word_cited_id
FROM cites ci
JOIN paper p ON ci.cited_paper_id = p.paper_id
JOIN content c ON p.paper_id = c.paper_id
WHERE ci.citing_paper_id = 'sima01computational';
```
-------------------------4154 sample_num
```sql
SELECT COUNT(DISTINCT cited_paper_id) 
FROM cites 
WHERE citing_paper_id = 'schmidt99advanced' 
AND cited_paper_id IN (SELECT paper_id FROM content WHERE word_cited_id = '3555');
```
-------------------------4155 sample_num
```sql
SELECT DISTINCT p.class_label
FROM cites c
JOIN content co ON c.citing_paper_id = co.paper_id
JOIN paper p ON c.citing_paper_id = p.paper_id
WHERE co.word_cited_id = 'word1163';
```
-------------------------4156 sample_num
```sql
SELECT p.paper_id, COUNT(c.word_cited_id) AS word_count
FROM paper p
JOIN content c ON p.paper_id = c.paper_id
WHERE p.class_label = 'DB'
GROUP BY p.paper_id
ORDER BY word_count DESC
LIMIT 1;
```
-------------------------4157 sample_num
```sql
SELECT COUNT(*) 
FROM cites c 
JOIN paper p ON c.citing_paper_id = p.paper_id 
WHERE p.class_label = 'ML' AND c.cited_paper_id = 'butz01algorithmic';
```
-------------------------4158 sample_num
```sql
SELECT name, birthdate 
FROM Person 
WHERE birthdate = (SELECT MIN(birthdate) FROM Person);
```
-------------------------4159 sample_num
```sql
SELECT nickname FROM Person WHERE name = 'Dan Castellaneta';
```
-------------------------4160 sample_num
```sql
SELECT COUNT(*) 
FROM Credit c 
JOIN Person p ON c.person = p.name 
WHERE c.episode_id IN (SELECT episode_id FROM Episode WHERE season = 20) 
AND p.birth_region = 'New York' 
AND YEAR(p.birthdate) > 1970;
```
-------------------------4161 sample_num
```sql
SELECT p.birth_country 
FROM Award a 
JOIN Person p ON a.person = p.name 
WHERE a.award = 'Outstanding Voice-Over Performance' 
AND a.year = 2009 
AND a.result = 'Winner';
```
-------------------------4162 sample_num
```sql
SELECT DISTINCT a.award 
FROM Award a 
JOIN Person p ON a.person = p.name 
WHERE p.nickname = 'Doofus' AND a.result = 'Winner';
```
-------------------------4163 sample_num
```sql
SELECT COUNT(DISTINCT c.person) 
FROM Award a 
JOIN Credit c ON a.episode_id = c.episode_id 
JOIN Person p ON c.person = p.name 
WHERE p.birth_country = 'USA' 
  AND a.result = 'Nominee' 
  AND a.award = 'Outstanding Animated Program (For Programming Less Than One Hour)' 
  AND a.year = 2009;
```
-------------------------4164 sample_num
```sql
SELECT character 
FROM Award 
WHERE award_category = 'Outstanding Voice-Over Performance' 
  AND year = 2009 
  AND result = 'Winner';
```
-------------------------4165 sample_num
```sql
SELECT k.keyword 
FROM Keyword k 
JOIN Episode e ON k.episode_id = e.episode_id 
WHERE e.title = 'Lost Verizon';
```
-------------------------4166 sample_num
```sql
SELECT COUNT(*) 
FROM Keyword 
WHERE episode_id = (SELECT episode_id FROM Episode WHERE air_date = '2008-10-19');
```
-------------------------4167 sample_num
```sql
SELECT e.rating 
FROM Episode e 
JOIN Award a ON e.episode_id = a.episode_id 
WHERE a.person = 'Dan Castellaneta' 
  AND a.year = 2009 
  AND a.result = 'Winner';
```
-------------------------4168 sample_num
```sql
SELECT COUNT(*) 
FROM Vote 
WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'Lost Verizon') 
AND stars = 7;
```
-------------------------4169 sample_num
```sql
SELECT stars 
FROM Vote 
WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'Lost Verizon') 
AND votes = (SELECT MAX(votes) FROM Vote WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'Lost Verizon'));
```
-------------------------4170 sample_num
```sql
SELECT e.title
FROM Episode e
JOIN Vote v ON e.episode_id = v.episode_id
WHERE v.votes > 200 AND v.stars = 10;
```
-------------------------4171 sample_num
```sql
SELECT COUNT(*) 
FROM Episode e 
JOIN Vote v ON e.episode_id = v.episode_id 
WHERE e.air_date LIKE '2009%' AND v.stars = 10 AND v.percent > 15;
```
-------------------------4172 sample_num
```sql
SELECT title 
FROM Episode 
WHERE episode_id = (
    SELECT episode_id 
    FROM Vote 
    WHERE stars = 7 
    ORDER BY votes DESC 
    LIMIT 1
);
```
-------------------------4173 sample_num
```sql
SELECT 
    SUM(v.stars * v.votes) / NULLIF(SUM(v.votes), 0) AS average_stars
FROM 
    Vote v
JOIN 
    Episode e ON v.episode_id = e.episode_id
WHERE 
    e.title = 'Lost Verizon';
```
-------------------------4174 sample_num
```sql
SELECT 
    (COUNT(DISTINCT a.episode_id) * 100.0 / COUNT(DISTINCT e.episode_id)) AS percentage
FROM 
    Episode e
LEFT JOIN 
    Award a ON e.episode_id = a.episode_id AND a.award_category = 'Primetime Emmy' AND a.result = 'Nominee'
WHERE 
    e.rating > 7;
```
-------------------------4175 sample_num
```sql
SELECT e.title 
FROM Episode e
JOIN Credit c ON e.episode_id = c.episode_id
JOIN Person p ON c.person = p.name
WHERE p.name = 'Pamela Hayden' AND c.role = 'Ruthie';
```
-------------------------4176 sample_num
```sql
SELECT C.role, E.episode, E.number_in_series
FROM Credit C
JOIN Episode E ON C.episode_id = E.episode_id
WHERE C.person = 'Matt Groening' AND E.title = 'In the Name of the Grandfather';
```
-------------------------4177 sample_num
```sql
SELECT e.title, e.summary
FROM Episode e
JOIN Keyword k ON e.episode_id = k.episode_id
WHERE k.keyword = 'eviction';
```
-------------------------4178 sample_num
```sql
SELECT AVG(stars) AS average_stars
FROM Vote
WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'Wedding for Disaster');
```
-------------------------4179 sample_num
```sql
SELECT e.title, k.keyword
FROM Episode e
JOIN Keyword k ON e.episode_id = k.episode_id
WHERE e.air_date = '2009-03-22';
```
-------------------------4180 sample_num
```sql
SELECT p.birth_name 
FROM Person p 
JOIN Credit c ON p.name = c.person 
WHERE c.role = 'Helen Lovejoy';
```
-------------------------4181 sample_num
```sql
SELECT 
    e.title,
    p.name,
    c.role,
    (SUM(CASE WHEN c.credited = '' THEN 1 ELSE 0 END) * 100.0 / NULLIF(SUM(CASE WHEN c.credited = 'true' THEN 1 ELSE 0 END), 0)) AS percentage_ratio
FROM 
    Episode e
JOIN 
    Award a ON e.episode_id = a.episode_id
JOIN 
    Credit c ON e.episode_id = c.episode_id
JOIN 
    Person p ON c.person = p.name
WHERE 
    a.year = 2017 
    AND a.award_category = 'Jupiter Award' 
    AND a.award = 'Best International TV Series'
GROUP BY 
    e.title, p.name, c.role;
```
-------------------------4182 sample_num
```sql
SELECT COUNT(*) 
FROM Episode 
WHERE votes > 1000;
```
-------------------------4183 sample_num
```sql
SELECT COUNT(*) 
FROM Person 
WHERE birth_place = 'New York' AND birth_region = 'USA';
```
-------------------------4184 sample_num
```sql
SELECT a.award, a.award_category
FROM Award a
JOIN Person p ON a.person = p.name
WHERE p.name = 'Marc Wilmore';
```
-------------------------4185 sample_num
```sql
SELECT name, nickname 
FROM Person 
WHERE nickname IS NOT NULL;
```
-------------------------4186 sample_num
```sql
SELECT AVG(height_meters) AS average_height
FROM Person;
```
-------------------------4187 sample_num
```sql
SELECT MAX(votes) - MIN(votes) AS vote_difference
FROM Episode;
```
-------------------------4188 sample_num
```sql
SELECT character 
FROM Character_Award 
JOIN Award ON Character_Award.award_id = Award.award_id 
WHERE Award.award = 'Outstanding Voice-Over Performance' AND Award.year = 2009;
```
-------------------------4189 sample_num
```sql
SELECT COUNT(DISTINCT p.name)
FROM Person p
JOIN Award a ON p.name = a.person
WHERE a.award_category = 'Comedy Series Award'
  AND a.year = 2009
  AND a.result = 'Nominee'
  AND p.birth_place = 'California';
```
-------------------------4190 sample_num
```sql
SELECT e.title 
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
WHERE a.award_category = 'Best International TV Series' 
  AND a.year = 2017 
  AND a.result = 'Winner';
```
-------------------------4191 sample_num
```sql
SELECT p.name
FROM Person p
WHERE p.name NOT IN (
    SELECT c.person
    FROM Credit c
    JOIN Episode e ON c.episode_id = e.episode_id
    WHERE e.title = 'How the Test Was Won' AND c.credited = ' '
);
```
-------------------------4192 sample_num
```sql
SELECT e.title 
FROM Episode e 
JOIN Keyword k1 ON e.episode_id = k1.episode_id 
JOIN Keyword k2 ON e.episode_id = k2.episode_id 
WHERE k1.keyword = 'riot' AND k2.keyword = 'cake';
```
-------------------------4193 sample_num
```sql
SELECT episode_id 
FROM Vote 
WHERE stars = 10 
ORDER BY votes DESC 
LIMIT 1;
```
-------------------------4194 sample_num
```sql
SELECT DISTINCT p.name
FROM Person p
JOIN Credit c ON p.name = c.person
JOIN Episode e ON c.episode_id = e.episode_id
WHERE e.season = 20 AND strftime('%m', e.air_date) BETWEEN '10' AND '11';
```
-------------------------4195 sample_num
```sql
SELECT p.name 
FROM Person p 
JOIN Credit c ON p.name = c.person 
JOIN Episode e ON c.episode_id = e.episode_id 
WHERE e.title = 'Treehouse of Horror XIX' AND c.role = 'director';
```
-------------------------4196 sample_num
```sql
SELECT COUNT(*) AS role_count
FROM Credit
WHERE episode_id = 5;
```
-------------------------4197 sample_num
```sql
SELECT k.keyword 
FROM Keyword k 
JOIN Episode e ON k.episode_id = e.episode_id 
WHERE e.title = 'Take My Life, Please';
```
-------------------------4198 sample_num
```sql
SELECT 
    COUNT(DISTINCT e.episode_id) AS nominated_count,
    (COUNT(DISTINCT e.episode_id) * 100.0 / COUNT(DISTINCT e2.episode_id)) AS percentage
FROM 
    Episode e
JOIN 
    Award a ON e.episode_id = a.episode_id
JOIN 
    Episode e2 ON e2.votes > 950
WHERE 
    a.award = 'Outstanding Voice-Over Performance' 
    AND a.result = 'Nominee' 
    AND a.year = 2009;
```
-------------------------4199 sample_num
```sql
SELECT 
    (SELECT votes FROM Vote WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'No Loan Again, Naturally') AND stars = 5) /
    (SELECT votes FROM Vote WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'Coming to Homerica') AND stars = 5) AS ratio;
```
-------------------------4200 sample_num
```sql
SELECT COUNT(*) 
FROM Award 
WHERE person = 'Ian Maxtone-Graham' 
  AND organization = 'Writers Guild of America, USA' 
  AND result = 'Nominee';
```
-------------------------4201 sample_num
```sql
SELECT person
FROM Award
WHERE result = 'Nominee'
GROUP BY person
HAVING COUNT(*) = (
    SELECT MAX(nominee_count)
    FROM (
        SELECT COUNT(*) AS nominee_count
        FROM Award
        WHERE result = 'Nominee'
        GROUP BY person
    ) AS nominee_counts
)
AND person NOT IN (
    SELECT person
    FROM Award
    WHERE result = 'Winner'
);
```
-------------------------4202 sample_num
```sql
SELECT title FROM Episode WHERE rating = (SELECT MIN(rating) FROM Episode);
```
-------------------------4203 sample_num
```sql
SELECT MIN(year) AS first_award_year
FROM Award
WHERE award = 'Favorite Animated Comedy' AND award_category = 'People\'s Choice Award' AND result = 'Winner';
```
-------------------------4204 sample_num
```sql
SELECT COUNT(*) 
FROM Episode e 
WHERE e.episode_id NOT IN (
    SELECT c.episode_id 
    FROM Credit c 
    WHERE c.person = 'Dell Hake' AND c.credited = '1'
);
```
-------------------------4205 sample_num
```sql
SELECT 
    (MIN(a.year) - SUBSTR(p.birthdate, 1, 4)) AS age_at_award
FROM 
    Award a
JOIN 
    Person p ON a.person = p.name
WHERE 
    a.award = 'Outstanding Voice-Over Performance' 
    AND a.organization = 'Primetime Emmy Awards' 
    AND a.result = 'Winner'
GROUP BY 
    a.person
ORDER BY 
    MIN(a.year)
LIMIT 1;
```
-------------------------4206 sample_num
```sql
SELECT ca.character 
FROM Award a 
JOIN Character_Award ca ON a.award_id = ca.award_id 
WHERE a.person = 'Dan Castellaneta' 
  AND a.result = 'Winner' 
  AND a.award_category = 'Outstanding Voice-Over Performance' 
  AND a.organization = 'Primetime Emmy Awards' 
  AND a.year = 2009;
```
-------------------------4207 sample_num
```sql
SELECT COUNT(DISTINCT e.episode_id) AS award_winning_episodes
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
WHERE SUBSTR(e.air_date, 6, 2) = '04' AND SUBSTR(e.air_date, 1, 4) = '2009';
```
-------------------------4208 sample_num
```sql
SELECT p.birth_place
FROM Person p
JOIN Award a ON p.name = a.person
WHERE a.result = 'Winner'
  AND a.award = 'Best Voice-Over Performance'
  AND a.organization = 'Online Film & Television Association'
  AND a.year = 2009;
```
-------------------------4209 sample_num
```sql
SELECT SUM(v.votes) AS total_10_star_votes
FROM Vote v
JOIN Episode e ON v.episode_id = e.episode_id
WHERE v.stars = 10
AND e.episode_id IN (
    SELECT e2.episode_id
    FROM Episode e2
    ORDER BY e2.rating DESC
    LIMIT 4
);
```
-------------------------4210 sample_num
```sql
SELECT SUM(v.stars) 
FROM Vote v 
JOIN Episode e ON v.episode_id = e.episode_id 
WHERE e.title = 'No Loan Again, Naturally' AND v.votes < 50;
```
-------------------------4211 sample_num
```sql
SELECT COUNT(DISTINCT a.person) 
FROM Award a 
JOIN Person p ON a.person = p.name 
WHERE a.result = 'Winner' AND p.birth_country = 'USA';
```
-------------------------4212 sample_num
```sql
SELECT COUNT(*) 
FROM Credit 
WHERE episode_id = 'S20-E11' AND person = 'Doofus' AND credited = 'true';
```
-------------------------4213 sample_num
```sql
SELECT p.name, MIN(a.year) AS first_award_year
FROM Award a
JOIN Person p ON a.person = p.name
WHERE a.result = 'Winner'
GROUP BY p.name
ORDER BY first_award_year
LIMIT 1;
```
-------------------------4214 sample_num
```sql
SELECT percent 
FROM Vote 
WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'Sex, Pies and Idiot Scrapes') 
AND stars = 9;
```
-------------------------4215 sample_num
```sql
SELECT award, person 
FROM Award 
WHERE year = 2009 AND result = 'Winner';
```
-------------------------4216 sample_num
```sql
SELECT name, birthdate 
FROM Person 
WHERE birth_place = 'Los Angeles' AND height_meters >= 1.8;
```
-------------------------4217 sample_num
```sql
SELECT episode, title, rating 
FROM Episode 
WHERE SUBSTR(air_date, 6, 2) = '10' AND SUBSTR(air_date, 1, 4) = '2008';
```
-------------------------4218 sample_num
```sql
SELECT a.award_id, a.award, a.person 
FROM Award a 
JOIN Character_Award ca ON a.award_id = ca.award_id 
WHERE ca.character = 'Homer simpson 20' AND a.result = 'Winner';
```
-------------------------4219 sample_num
```sql
SELECT 
    a.award AS award_name, 
    a.result, 
    c.category AS credit_category, 
    c.credited 
FROM 
    Award a 
JOIN 
    Credit c ON a.person = c.person 
WHERE 
    a.person = 'Billy Kimball';
```
-------------------------4220 sample_num
```sql
SELECT p.name, a.award, a.organization, a.result, c.credited
FROM Person p
JOIN Award a ON p.name = a.person
JOIN Credit c ON p.name = c.person
WHERE a.role = 'assistant director' AND c.episode_id = 'S20-E13';
```
-------------------------4221 sample_num
```sql
SELECT p.birth_country, p.height_meters, p.name
FROM Person p
WHERE p.name NOT IN (
    SELECT c.person
    FROM Credit c
    WHERE c.category = 'Casting Department' AND c.credited = ''
);
```
-------------------------4222 sample_num
```sql
SELECT a.person AS nominee, k.keyword, a.episode_id
FROM Award a
JOIN Keyword k ON a.episode_id = k.episode_id
JOIN Episode e ON a.episode_id = e.episode_id
WHERE e.title = 'The Good, the Sad and the Drugly' AND a.result = 'Nominee';
```
-------------------------4223 sample_num
```sql
SELECT v.votes, v.percent 
FROM Vote v 
JOIN Keyword k ON v.episode_id = k.episode_id 
WHERE k.keyword = 'arab stereotype' AND v.stars = 10;
```
-------------------------4224 sample_num
```sql
SELECT a.award, e.air_date, e.rating
FROM Award a
JOIN Episode e ON a.episode_id = e.episode_id
WHERE a.organization = 'Jupiter Award' AND a.result = 'Winner';
```
-------------------------4225 sample_num
```sql
SELECT e.episode_id, e.title, k1.keyword, k2.keyword, k3.keyword
FROM Episode e
JOIN Vote v ON e.episode_id = v.episode_id
JOIN Keyword k1 ON e.episode_id = k1.episode_id
JOIN Keyword k2 ON e.episode_id = k2.episode_id AND k1.keyword <> k2.keyword
JOIN Keyword k3 ON e.episode_id = k3.episode_id AND k1.keyword <> k3.keyword AND k2.keyword <> k3.keyword
WHERE v.stars = 1
AND v.votes = (SELECT MAX(votes) FROM Vote WHERE stars = 1)
LIMIT 1;
```
-------------------------4226 sample_num
```sql
SELECT e.title, e.episode_image, a.award, a.person
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
WHERE e.rating BETWEEN 7 AND 10
AND SUBSTRING(e.air_date, 1, 4) = '2008'
AND a.result = 'Nominee';
```
-------------------------4227 sample_num
```sql
SELECT a.award, p.name, ca.character 
FROM Award a 
JOIN Person p ON a.person = p.name 
JOIN Character_Award ca ON a.award_id = ca.award_id 
WHERE a.award_id = 326;
```
-------------------------4228 sample_num
```sql
SELECT 
    p.name, 
    p.birth_country, 
    c.role, 
    (2022 - SUBSTR(p.birthdate, 1, 4)) AS age_in_2022
FROM 
    Person p
JOIN 
    Credit c ON p.name = c.person
WHERE 
    c.role IS NOT NULL
ORDER BY 
    p.birthdate ASC
LIMIT 1;
```
-------------------------4229 sample_num
```sql
SELECT COUNT(c.credited) AS number_of_credits, c.category, c.role, p.birth_place
FROM Credit c
JOIN Person p ON c.person = p.name
WHERE p.birth_country = 'North Korea'
GROUP BY c.category, c.role, p.birth_place;
```
-------------------------4230 sample_num
```sql
SELECT 
    p.name AS winner_name, 
    a.award AS award_name, 
    e.title AS episode_title, 
    a.role AS winner_role,
    COUNT(CASE WHEN a.result = 'winner' THEN 1 END) * 1.0 / COUNT(*) AS winning_rate
FROM 
    Award a
JOIN 
    Episode e ON a.episode_id = e.episode_id
JOIN 
    Person p ON a.person = p.name
WHERE 
    a.year = 2010
GROUP BY 
    p.name, a.award, e.title, a.role;
```
-------------------------4231 sample_num
```sql
SELECT title 
FROM Episode 
WHERE episode_id = (
    SELECT episode_id 
    FROM Vote 
    ORDER BY stars DESC, votes DESC 
    LIMIT 1
);
```
-------------------------4232 sample_num
```sql
SELECT COUNT(award) AS total_awards
FROM Award
WHERE season = 20 AND result = 'Winner';
```
-------------------------4233 sample_num
```sql
SELECT e.title
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
WHERE a.organization = 'Primetime Emmy Awards'
  AND a.award = 'Outstanding Animated Program (For Programming Less Than One Hour)'
  AND a.result = 'Nominee'
GROUP BY e.episode_id, e.title
HAVING COUNT(a.episode_id) = 21;
```
-------------------------4234 sample_num
```sql
SELECT AVG(v.stars) AS average_stars, e.summary 
FROM Vote v 
JOIN Episode e ON v.episode_id = e.episode_id 
WHERE e.episode_id = 'S20-E12';
```
-------------------------4235 sample_num
```sql
SELECT DISTINCT p.name
FROM Person p
JOIN Award a ON p.name = a.person
JOIN Character_Award ca ON a.award_id = ca.award_id
WHERE a.organization = 'Primetime Emmy Awards'
  AND a.award = 'Outstanding Voice-Over Performance'
  AND a.result = 'Winner'
  AND ca.character = 'Homer simpson 20';
```
-------------------------4236 sample_num
```sql
SELECT p.birth_name, c.role 
FROM Person p 
JOIN Credit c ON p.name = c.person 
JOIN Episode e ON c.episode_id = e.episode_id 
WHERE p.name = 'Al Jean' AND e.season = 20;
```
-------------------------4237 sample_num
```sql
SELECT COUNT(*) 
FROM Award 
WHERE person = 'Billy Kimball' 
  AND year = 2010 
  AND result = 'Nominee' 
  AND season = 20;
```
-------------------------4238 sample_num
```sql
SELECT k.keyword 
FROM Keyword k 
JOIN Episode e ON k.episode_id = e.episode_id 
WHERE e.title = 'Take My Life, Please';
```
-------------------------4239 sample_num
```sql
SELECT a.person, a.award_category
FROM Award a
WHERE a.result = 'Winner'
ORDER BY a.year DESC
LIMIT 1;
```
-------------------------4240 sample_num
```sql
SELECT AVG(CASE WHEN result = 'winner' THEN 1 ELSE 0 END) AS average_awards_winning_rate
FROM Award
WHERE season = 20;
```
-------------------------4241 sample_num
```sql
SELECT COUNT(*) 
FROM Episode 
WHERE air_date BETWEEN '2008-10-01' AND '2008-11-30';
```
-------------------------4242 sample_num
```sql
SELECT title, rating 
FROM Episode 
WHERE YEAR(air_date) = 2009 
ORDER BY rating ASC 
LIMIT 1;
```
-------------------------4243 sample_num
```sql
SELECT DISTINCT c.category, c.role
FROM Credit c
JOIN Person p ON c.person = p.name
WHERE p.name = 'Bonita Pietila';
```
-------------------------4244 sample_num
```sql
SELECT DISTINCT p.name 
FROM Person p 
JOIN Credit c ON p.name = c.person 
JOIN Episode e ON c.episode_id = e.episode_id 
WHERE e.season = 20 AND p.birthdate = '1957-10-29' AND p.birth_place = 'Chicago' AND p.birth_region = 'Illinois';
```
-------------------------4245 sample_num
```sql
SELECT DISTINCT p.name 
FROM Credit c 
JOIN Person p ON c.person = p.name 
WHERE c.episode_id IN (
    SELECT episode_id 
    FROM Episode 
    WHERE season = 20
) AND c.role = 'producer';
```
-------------------------4246 sample_num
```sql
SELECT CONCAT(p.birth_name, ' ', p.name) AS full_name, 
       (2009 - YEAR(p.birthdate)) AS age
FROM Award a
JOIN Person p ON a.person = p.name
WHERE a.organization = 'Primetime Emmy Awards' 
  AND a.year = 2009 
  AND a.award_category = 'Outstanding Music Composition for a Series (Original Dramatic Score)' 
  AND a.result = 'Nominee' 
  AND a.role = 'composer';
```
-------------------------4247 sample_num
```sql
SELECT title
FROM Episode
WHERE season = 20
GROUP BY episode_id, title
ORDER BY COUNT(episode_id) DESC
LIMIT 1;
```
-------------------------4248 sample_num
```sql
SELECT birth_place 
FROM Person 
WHERE name = 'Dan Castellaneta';
```
-------------------------4249 sample_num
```sql
SELECT COUNT(*) 
FROM Person 
WHERE birth_country = 'USA';
```
-------------------------4250 sample_num
```sql
SELECT name 
FROM Person 
WHERE birthdate < '1970-01-01';
```
-------------------------4251 sample_num
```sql
SELECT name 
FROM Person 
WHERE birth_place = 'California' 
AND birth_country = 'USA' 
AND birthdate BETWEEN '1958-01-01' AND '1969-12-31';
```
-------------------------4252 sample_num
```sql
SELECT episode_id 
FROM Vote 
WHERE stars = 5 AND votes > 100;
```
-------------------------4253 sample_num
```sql
SELECT k.keyword 
FROM Keyword k 
JOIN Episode e ON k.episode_id = e.episode_id 
WHERE e.title = 'Double, Double, Boy in Trouble';
```
-------------------------4254 sample_num
```sql
SELECT episode_id, title 
FROM Episode 
WHERE episode BETWEEN 10 AND 20 
AND votes > 200;
```
-------------------------4255 sample_num
```sql
SELECT k.keyword
FROM Award a
JOIN Keyword k ON a.episode_id = k.episode_id
WHERE a.award_category = 'Primetime Emmy';
```
-------------------------4256 sample_num
```sql
SELECT p.name
FROM Award a
JOIN Person p ON a.person = p.name
JOIN Vote v ON a.episode_id = v.episode_id
WHERE a.award_category = 'Primetime Emmy'
ORDER BY v.votes DESC
LIMIT 1;
```
-------------------------4257 sample_num
```sql
SELECT a.episode_id 
FROM Award a 
JOIN Vote v ON a.episode_id = v.episode_id 
WHERE a.award = 'Outstanding Animated Program (For Programming Less Than One Hour)' 
AND v.stars = 10;
```
-------------------------4258 sample_num
```sql
SELECT DISTINCT p.name
FROM Person p
JOIN Award a ON p.name = a.person
JOIN Credit c ON a.episode_id = c.episode_id AND a.role = c.role
JOIN Episode e ON a.episode_id = e.episode_id
WHERE a.award = 'Outstanding Animated Program (For Programming Less Than One Hour)'
  AND e.title = 'No Loan Again, Naturally'
  AND c.role = 'director';
```
-------------------------4259 sample_num
```sql
SELECT DISTINCT c.person
FROM Credit c
JOIN Vote v ON c.episode_id = v.episode_id
JOIN Award a ON c.episode_id = a.episode_id
WHERE c.role = 'writer' AND v.stars > 5 AND a.year = 2009;
```
-------------------------4260 sample_num
```sql
SELECT COUNT(DISTINCT a.person)
FROM Award a
JOIN Person p ON a.person = p.name
WHERE a.award_category = 'WGA Award (TV)'
AND p.birth_country = 'USA'
AND a.year BETWEEN 2009 AND 2010;
```
-------------------------4261 sample_num
```sql
SELECT e.title 
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
JOIN Vote v ON e.episode_id = v.episode_id
WHERE a.role = 'composer' 
  AND a.award = 'Outstanding Music Composition for a Series (Original Dramatic Score)' 
  AND v.votes > 200;
```
-------------------------4262 sample_num
```sql
SELECT e.title 
FROM Award a 
JOIN Episode e ON a.episode_id = e.episode_id 
WHERE a.person = 'Al Jean' 
AND a.award_category = 'Primetime Emmy Award' 
AND a.year = 2009;
```
-------------------------4263 sample_num
```sql
SELECT 
    (SELECT SUM(votes) FROM Vote WHERE episode_id = 1) - 
    (SELECT SUM(votes) FROM Vote WHERE episode_id = 5) AS more_votes;
```
-------------------------4264 sample_num
```sql
SELECT a.award 
FROM Award a 
JOIN Character_Award ca ON a.award_id = ca.award_id 
WHERE ca.character = 'Homer Simpson' AND a.year = 2009;
```
-------------------------4265 sample_num
```sql
SELECT 
    COUNT(DISTINCT e.episode_id) AS episodes_won,
    (COUNT(DISTINCT CASE WHEN v.votes < 100 THEN e.episode_id END) * 100.0 / COUNT(DISTINCT e.episode_id)) AS percentage_less_than_100_votes
FROM 
    Episode e
JOIN 
    Award a ON e.episode_id = a.episode_id
JOIN 
    Vote v ON e.episode_id = v.episode_id
WHERE 
    a.award = 'Outstanding Animated Program (Programming Under One Hour)'
    AND a.result = 'Won';
```
-------------------------4266 sample_num
```sql
SELECT 
    COUNT(*) AS emmy_recipients,
    (COUNT(CASE WHEN p.birth_country = 'USA' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_americans
FROM 
    Award a
JOIN 
    Person p ON a.person = p.name
WHERE 
    a.award_category = 'Primetime Emmy Award';
```
-------------------------4267 sample_num
```sql
SELECT DISTINCT p.name
FROM Award a
JOIN Person p ON a.person = p.name
WHERE a.award_category = 'Outstanding Voice-Over Performance'
AND a.season = 20
AND a.episode_id LIKE 'S20%'
LIMIT 2;
```
-------------------------4268 sample_num
```sql
SELECT COUNT(DISTINCT person) 
FROM Award 
WHERE award_category = 'Outstanding Animated Program (For Programming Less Than One Hour)' 
AND result = 'Nominee' 
AND role = 'executive producer';
```
-------------------------4269 sample_num
```sql
SELECT name 
FROM Person 
WHERE YEAR(birthdate) = 1962 AND birth_region = 'California';
```
-------------------------4270 sample_num
```sql
SELECT COUNT(*) 
FROM Person 
WHERE height_meters > 1.70 AND birth_country = 'Canada';
```
-------------------------4271 sample_num
```sql
SELECT COUNT(DISTINCT person) 
FROM Award 
WHERE award_category = 'Animation' AND result = 'Nominee';
```
-------------------------4272 sample_num
```sql
SELECT * FROM Episode WHERE rating > 7 AND rating <= 10 LIMIT 3;
```
-------------------------4273 sample_num
```sql
SELECT title, MAX(votes) AS max_votes
FROM Episode
GROUP BY title
ORDER BY max_votes DESC
LIMIT 5;
```
-------------------------4274 sample_num
```sql
SELECT episode_id, COUNT(votes) AS total_votes
FROM Vote
WHERE stars = 1
GROUP BY episode_id
ORDER BY total_votes DESC
LIMIT 3;
```
-------------------------4275 sample_num
```sql
SELECT ca.character
FROM Award a
JOIN Character_Award ca ON a.award_id = ca.award_id
JOIN Person p ON a.person = p.name
WHERE p.name = 'Dan Castellaneta' AND a.award_category LIKE '%Voice-Over%';
```
-------------------------4276 sample_num
```sql
SELECT e.*
FROM Episode e
JOIN Vote v ON e.episode_id = v.episode_id
WHERE e.air_date LIKE '2008%' AND v.stars = 10
AND v.votes = (
    SELECT MAX(votes)
    FROM Vote
    WHERE episode_id IN (
        SELECT episode_id
        FROM Episode
        WHERE air_date LIKE '2008%'
    ) AND stars = 10
);
```
-------------------------4277 sample_num
```sql
SELECT k.keyword 
FROM Keyword k 
JOIN Episode e ON k.episode_id = e.episode_id 
WHERE e.title = 'Take My Life, Please';
```
-------------------------4278 sample_num
```sql
SELECT e1.title, e2.title
FROM Keyword k1
JOIN Episode e1 ON k1.episode_id = e1.episode_id
JOIN Keyword k2 ON k1.keyword = k2.keyword AND k1.episode_id <> k2.episode_id
JOIN Episode e2 ON k2.episode_id = e2.episode_id
WHERE k1.keyword = '1930s to 2020s'
LIMIT 2;
```
-------------------------4279 sample_num
```sql
SELECT e.title 
FROM Award a 
JOIN Episode e ON a.episode_id = e.episode_id 
WHERE a.person = 'Joel H. Cohen' AND a.year = 2010;
```
-------------------------4280 sample_num
```sql
SELECT votes FROM Vote 
WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'Lisa the Drama Queen') 
AND stars = 5;
```
-------------------------4281 sample_num
```sql
SELECT SUM(votes) AS total_votes
FROM Vote
WHERE stars = 10 AND episode_id IN (
    SELECT episode_id
    FROM Keyword
    WHERE keyword = 'reference to the fantastic four'
);
```
-------------------------4282 sample_num
```sql
SELECT 
    (SELECT votes FROM Vote WHERE stars = 1 AND episode_id = (SELECT episode_id FROM Episode WHERE title = 'The Burns and the Bees')) - 
    (SELECT votes FROM Vote WHERE stars = 10 AND episode_id = (SELECT episode_id FROM Episode WHERE title = 'The Burns and the Bees')) AS vote_difference;
```
-------------------------4283 sample_num
```sql
SELECT k.keyword
FROM Keyword k
JOIN Vote v ON k.episode_id = v.episode_id
WHERE v.votes = (SELECT MIN(votes) FROM Vote);
```
-------------------------4284 sample_num
```sql
SELECT e.*
FROM Episode e
JOIN Vote v ON e.episode_id = v.episode_id
WHERE v.stars = 2 AND v.votes > 20 AND e.rating > 5 AND e.rating <= 7;
```
-------------------------4285 sample_num
```sql
SELECT episode_id, title, votes 
FROM Episode 
ORDER BY votes DESC 
LIMIT 1;
```
-------------------------4286 sample_num
```sql
SELECT name, birthdate 
FROM Person 
ORDER BY birthdate ASC 
LIMIT 1;
```
-------------------------4287 sample_num
```sql
SELECT e.title, e.season, e.episode
FROM Episode e
JOIN Credit c ON e.episode_id = c.episode_id
WHERE c.person = 'Oscar Cervantes' AND c.credited = 'true';
```
-------------------------4288 sample_num
```sql
SELECT DISTINCT c.role
FROM Credit c
JOIN Person p ON c.person = p.name
WHERE p.birth_country != 'USA';
```
-------------------------4289 sample_num
```sql
SELECT SUM(votes) AS one_star_votes
FROM Vote
WHERE episode_id = (
    SELECT episode_id
    FROM Episode
    WHERE season = (SELECT season FROM Episode ORDER BY rating ASC LIMIT 1)
    ORDER BY rating ASC
    LIMIT 1
) AND stars = 1;
```
-------------------------4290 sample_num
```sql
SELECT ca.character
FROM Award a
JOIN Character_Award ca ON a.award_id = ca.award_id
WHERE a.award = 'Outstanding Voice-Over Performance' AND a.result = 'Winner';
```
-------------------------4291 sample_num
```sql
SELECT e.summary 
FROM Episode e 
JOIN Credit c ON e.episode_id = c.episode_id 
WHERE c.person = 'Emily Blunt';
```
-------------------------4292 sample_num
```sql
SELECT role 
FROM Person 
JOIN Credit ON Person.name = Credit.person 
WHERE Person.nickname = 'The Tiny Canadian';
```
-------------------------4293 sample_num
```sql
SELECT e.title, MAX(v.percent) AS max_percent
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
JOIN Vote v ON e.episode_id = v.episode_id
WHERE v.stars = 5
GROUP BY e.title
ORDER BY max_percent DESC
LIMIT 1;
```
-------------------------4294 sample_num
```sql
SELECT person
FROM Credit
WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'In the Name of the Grandfather')
  AND category = 'Cast'
  AND credited = 'true';
```
-------------------------4295 sample_num
```sql
SELECT DISTINCT p.birthdate
FROM Award a
JOIN Person p ON a.person = p.name
WHERE a.result = 'Winner';
```
-------------------------4296 sample_num
```sql
SELECT DISTINCT c.person
FROM Credit c
JOIN Vote v ON c.episode_id = v.episode_id
WHERE c.role = 'Writer' AND v.stars = 10
AND v.votes = (
    SELECT MAX(votes)
    FROM Vote
    WHERE stars = 10
);
```
-------------------------4297 sample_num
```sql
SELECT award 
FROM Award 
WHERE episode_id = (SELECT episode_id FROM Episode WHERE air_date = '11/30/2008') 
AND result = 'Winner';
```
-------------------------4298 sample_num
```sql
SELECT * 
FROM Credit 
WHERE category = 'Music Department';
```
-------------------------4299 sample_num
```sql
SELECT keyword FROM Keyword WHERE episode_id = 426;
```
-------------------------4300 sample_num
```sql
SELECT e.title
FROM Episode e
JOIN Vote v ON e.episode_id = v.episode_id
WHERE v.stars = 7
AND v.votes > (
    SELECT AVG(v2.votes)
    FROM Vote v2
    JOIN Episode e2 ON v2.episode_id = e2.episode_id
    WHERE e2.season = e.season
)
```
-------------------------4301 sample_num
```sql
SELECT 
    DIVIDE(SUM(CASE WHEN A.result = 'Nominee' THEN V.votes ELSE 0 END), SUM(V.votes)) AS percentage
FROM 
    Award A
JOIN 
    Vote V ON A.episode_id = V.episode_id
WHERE 
    A.result = 'Nominee';
```
-------------------------4302 sample_num
```sql
SELECT name FROM Person WHERE nickname IS NOT NULL;
```
-------------------------4303 sample_num
```sql
SELECT birth_country 
FROM Person 
WHERE height_meters = (SELECT MAX(height_meters) FROM Person);
```
-------------------------4304 sample_num
```sql
SELECT AVG(height_meters) AS average_height FROM Person WHERE birth_country = 'USA';
```
-------------------------4305 sample_num
```sql
SELECT 
    (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM Person)) AS percentage
FROM 
    Person
WHERE 
    birthdate > '1970-01-01' AND birth_region = 'California';
```
-------------------------4306 sample_num
```sql
SELECT COUNT(*) 
FROM Person 
WHERE birth_region != 'Connecticut' AND birth_country != 'USA';
```
-------------------------4307 sample_num
```sql
SELECT title 
FROM Episode 
WHERE episode_id IN ('S20-E1', 'S20-E2', 'S20-E3');
```
-------------------------4308 sample_num
```sql
SELECT episode_image FROM Episode WHERE episode_id = 5;
```
-------------------------4309 sample_num
```sql
SELECT SUM(votes) AS total_votes
FROM Vote
WHERE episode_id IN (
    SELECT episode_id
    FROM Episode
    WHERE rating > 7.0
);
```
-------------------------4310 sample_num
```sql
SELECT COUNT(DISTINCT person) 
FROM Credit 
WHERE category = 'Casting Department';
```
-------------------------4311 sample_num
```sql
SELECT COUNT(*) 
FROM Person 
JOIN Credit ON Person.name = Credit.person 
WHERE Credit.role = 'additional timer' AND Person.birth_country = 'USA';
```
-------------------------4312 sample_num
```sql
SELECT COUNT(*) 
FROM Person p 
JOIN Credit c ON p.name = c.person 
WHERE p.birthdate > '1970-01-01' AND c.role = 'animation executive producer';
```
-------------------------4313 sample_num
```sql
SELECT e.summary
FROM Episode e
JOIN Credit c ON e.episode_id = c.episode_id
WHERE c.credited = '' AND c.role IN ('crew', 'staff');
```
-------------------------4314 sample_num
```sql
SELECT e.rating
FROM Episode e
JOIN Credit c ON e.episode_id = c.episode_id
WHERE c.person = 'Jason Bikowski' AND c.role = 'Producer';
```
-------------------------4315 sample_num
```sql
SELECT AVG(p.height_meters) 
FROM Credit c 
JOIN Person p ON c.person = p.name 
WHERE c.category = 'Animation Department';
```
-------------------------4316 sample_num
```sql
SELECT character 
FROM Award 
WHERE organization = 'Primetime Emmy' AND year = 2009;
```
-------------------------4317 sample_num
```sql
SELECT DISTINCT ca.character
FROM Award a
JOIN Character_Award ca ON a.award_id = ca.award_id
WHERE a.award_category = 'Primetime Emmy'
  AND a.result = 'Nominee'
  AND a.year >= '2009'
  AND a.year <= '2010';
```
-------------------------4318 sample_num
```sql
SELECT SUM(v.votes) AS total_votes
FROM Vote v
JOIN Credit c ON v.episode_id = c.episode_id
WHERE c.person = 'Adam Kuhlman';
```
-------------------------4319 sample_num
```sql
SELECT k.keyword, c.person
FROM Keyword k
JOIN Credit c ON k.episode_id = c.episode_id
WHERE k.episode_id = 'S20-E1';
```
-------------------------4320 sample_num
```sql
SELECT k.keyword
FROM Vote v
JOIN Keyword k ON v.episode_id = k.episode_id
WHERE v.stars = 10 AND v.percent > 29;
```
-------------------------4321 sample_num
```sql
SELECT DIVIDE(SUM(CASE WHEN stars = 5 THEN 1 ELSE 0 END), COUNT(stars)) AS percentage
FROM Vote
JOIN Episode ON Vote.episode_id = Episode.episode_id
WHERE Episode.title = 'Sex, Pies and Idiot Scrapes';
```
-------------------------4322 sample_num
```sql
SELECT COUNT(*) > 0 AS is_keyword
FROM Keyword k
JOIN Episode e ON k.episode_id = e.episode_id
WHERE k.keyword = 'limbo dancing' AND e.title = 'Dangerous Curves';
```
-------------------------4323 sample_num
```sql
SELECT e.title 
FROM Award a 
JOIN Episode e ON a.episode_id = e.episode_id 
WHERE a.result = 'Winner' 
  AND a.award = 'Best International TV Series' 
  AND a.year = '2017';
```
-------------------------4324 sample_num
```sql
SELECT k.keyword
FROM Award a
JOIN Keyword k ON a.episode_id = k.episode_id
WHERE a.award_category = 'WGA Award (TV)' AND a.result = 'Winner';
```
-------------------------4325 sample_num
```sql
SELECT DISTINCT p.birth_place
FROM Person p
JOIN Award a ON p.name = a.person
WHERE a.role = 'co-executive producer'
  AND a.award = 'Outstanding Animated Program (For Programming Less Than One Hour)'
  AND a.result = 'Nominee';
```
-------------------------4326 sample_num
```sql
SELECT SUM(v.votes) AS total_votes
FROM Award a
JOIN Vote v ON a.episode_id = v.episode_id
WHERE a.award = 'Blimp Award' 
  AND a.result IN ('Winner', 'Nominee') 
  AND v.stars > 1 AND v.stars < 5;
```
-------------------------4327 sample_num
```sql
SELECT SUM(E.rating) AS total_rating
FROM Award A
JOIN Episode E ON A.episode_id = E.episode_id
WHERE A.result = 'Winner' 
AND (A.award = 'OFTA Television Award' OR A.award = 'WGA Award (TV)');
```
-------------------------4328 sample_num
```sql
SELECT SUM(percent) AS total_percent
FROM Vote
WHERE episode_id = (SELECT episode_id FROM Episode WHERE title = 'No Loan Again, Naturally')
AND stars >= 5 AND stars <= 10;
```
-------------------------4329 sample_num
```sql
SELECT COUNT(*) 
FROM Vote 
WHERE stars > 8;
```
-------------------------4330 sample_num
```sql
SELECT episode_id, title, votes 
FROM Vote 
ORDER BY votes DESC 
LIMIT 1;
```
-------------------------4331 sample_num
```sql
SELECT COUNT(*) 
FROM Keyword 
WHERE keyword = '2d animation';
```
-------------------------4332 sample_num
```sql
SELECT organization FROM Award WHERE award_id = 328;
```
-------------------------4333 sample_num
```sql
SELECT COUNT(*) FROM Award WHERE year = 2009;
```
-------------------------4334 sample_num
```sql
SELECT COUNT(*) 
FROM Award 
WHERE award_category = 'Primetime Emmy';
```
-------------------------4335 sample_num
```sql
SELECT DISTINCT p.birth_name
FROM Person p
JOIN Credit c ON p.name = c.person
WHERE c.role = 'co-executive producer' AND p.height_meters > 1.60;
```
-------------------------4336 sample_num
```sql
SELECT 
    (SUM(CASE WHEN A.result = 'Nominee' AND P.birth_country = 'USA' THEN 1 ELSE 0 END) * 100.0) / COUNT(P.name) AS percentage_nominees_born_in_usa
FROM 
    Award A
JOIN 
    Person P ON A.person = P.name
WHERE 
    A.result = 'Nominee';
```
-------------------------4337 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.height_meters > 1.75 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Award a
JOIN 
    Person p ON a.person = p.name
WHERE 
    a.result = 'Winner';
```
-------------------------4338 sample_num
```sql
SELECT e.title 
FROM Episode e 
JOIN Vote v ON e.episode_id = v.episode_id 
WHERE v.stars = 2;
```
-------------------------4339 sample_num
```sql
SELECT V.stars 
FROM Vote V 
JOIN Episode E ON V.episode_id = E.episode_id 
WHERE E.title = 'How the Test Was Won';
```
-------------------------4340 sample_num
```sql
SELECT COUNT(*) 
FROM Vote 
JOIN Episode ON Vote.episode_id = Episode.episode_id 
WHERE Vote.stars > 5 AND Episode.air_date LIKE '2008%';
```
-------------------------4341 sample_num
```sql
SELECT DISTINCT ca.character
FROM Award a
JOIN Character_Award ca ON a.award_id = ca.award_id
WHERE a.year = 2009;
```
-------------------------4342 sample_num
```sql
SELECT DISTINCT year
FROM Award
JOIN Character_Award ON Award.award_id = Character_Award.award_id
WHERE character = 'Mr. Burns';
```
-------------------------4343 sample_num
```sql
SELECT DISTINCT a.award_category 
FROM Award a 
JOIN Character_Award ca ON a.award_id = ca.award_id 
WHERE ca.character = 'Lenny';
```
-------------------------4344 sample_num
```sql
SELECT p.name 
FROM Person p 
JOIN Credit c ON p.name = c.person 
WHERE c.role = 'Smithers';
```
-------------------------4345 sample_num
```sql
SELECT k.keyword 
FROM Keyword k 
JOIN Episode e ON k.episode_id = e.episode_id 
WHERE e.title = 'Dangerous Curves';
```
-------------------------4346 sample_num
```sql
SELECT k.keyword 
FROM Keyword k 
JOIN Episode e ON k.episode_id = e.episode_id 
WHERE e.air_date LIKE '2008%';
```
-------------------------4347 sample_num
```sql
SELECT COUNT(*) 
FROM Episode e 
JOIN Vote v ON e.episode_id = v.episode_id 
WHERE v.stars < 8 AND e.air_date LIKE '2009%';
```
-------------------------4348 sample_num
```sql
SELECT DISTINCT p.birth_name 
FROM Person p 
JOIN Credit c ON p.name = c.person 
WHERE c.role = 'director' AND p.birth_country = 'South Korea';
```
-------------------------4349 sample_num
```sql
SELECT COUNT(*) 
FROM Award 
WHERE episode_id IN (SELECT episode_id FROM Episode WHERE title = 'Simpsons 20') 
AND year = 2009 
AND result = 'Winner';
```
-------------------------4350 sample_num
```sql
SELECT COUNT(*) AS total_episodes_below_7
FROM Episode
WHERE rating < 7;
```
-------------------------4351 sample_num
```sql
SELECT name FROM Person WHERE birth_region = 'California' AND birth_country = 'USA';
```
-------------------------4352 sample_num
```sql
SELECT COUNT(*) 
FROM Credit 
WHERE episode_id IN ('S02-E5', 'S02-E6', 'S02-E7', 'S02-E8', 'S02-E9', 'S02-E10') 
AND credited = 'true' 
AND role = 'casting';
```
-------------------------4353 sample_num
```sql
SELECT episode_id FROM Vote WHERE stars = 2 AND votes = 9;
```
-------------------------4354 sample_num
```sql
SELECT E.title 
FROM Award A 
JOIN Episode E ON A.episode_id = E.episode_id 
WHERE A.organization = 'Primetime Emmy Awards' 
AND A.year = 2009 
AND A.result = 'Winner';
```
-------------------------4355 sample_num
```sql
SELECT episode_id 
FROM Episode 
WHERE air_date LIKE '2008%' 
AND episode_id IN (SELECT episode_id FROM Vote WHERE stars < 5);
```
-------------------------4356 sample_num
```sql
SELECT c.category 
FROM Credit c 
JOIN Vote v ON c.episode_id = v.episode_id 
WHERE v.votes = (SELECT MAX(votes) FROM Vote) 
AND c.person = 'Carlton Batten';
```
-------------------------4357 sample_num
```sql
SELECT percent 
FROM Vote 
WHERE episode_id IN (
    SELECT episode_id 
    FROM Episode 
    WHERE air_date LIKE '2008%' 
) 
AND votes BETWEEN 920 AND 950;
```
-------------------------4358 sample_num
```sql
SELECT e.episode_id, e.title
FROM Episode e
JOIN Credit c ON e.episode_id = c.episode_id
WHERE c.credited = 'true' AND c.person = 'Bonita Pietila';
```
-------------------------4359 sample_num
```sql
SELECT COUNT(DISTINCT e.episode_id) 
FROM Episode e
JOIN Award a ON e.episode_id = a.episode_id
WHERE a.organization = 'Annie Awards' 
AND a.result = 'Nominee' 
AND e.episode_id IN (SELECT episode_id FROM Vote WHERE percent > 6);
```
-------------------------4360 sample_num
```sql
SELECT E.title 
FROM Episode E 
JOIN Award A ON E.episode_id = A.episode_id 
WHERE A.result = 'Nominee' 
AND A.award_category = 'WGA Award (TV)' 
AND E.votes > 1000;
```
-------------------------4361 sample_num
```sql
SELECT DISTINCT p.name
FROM Credit c
JOIN Episode e ON c.episode_id = e.episode_id
JOIN Person p ON c.person = p.name
WHERE e.title = 'How the Test Was Won'
  AND c.category = 'Animation Department'
  AND c.credited = 'true'
  AND c.role = 'additional timer';
```
-------------------------4362 sample_num
```sql
SELECT v.stars 
FROM Vote v 
JOIN Episode e ON v.episode_id = e.episode_id 
WHERE e.air_date LIKE '2008-11%';
```
-------------------------4363 sample_num
```sql
SELECT e.title 
FROM Episode e 
JOIN Award a ON e.episode_id = a.episode_id 
JOIN Vote v ON e.episode_id = v.episode_id 
WHERE v.stars = 5 
  AND a.result = 'Nominee' 
  AND a.award_category = 'Prism Award' 
  AND e.air_date = '2009-04-19';
```
-------------------------4364 sample_num
```sql
SELECT DISTINCT a.award_category
FROM Award a
JOIN Vote v ON a.episode_id = v.episode_id
WHERE v.votes = (SELECT MAX(votes) FROM Vote)
AND a.result = 'Nominee';
```
-------------------------4365 sample_num
```sql
SELECT COUNT(*) 
FROM Credit 
JOIN Episode ON Credit.episode_id = Episode.episode_id 
WHERE Episode.air_date LIKE '2009%' 
AND Credit.credited = 'true' 
AND Credit.person = 'Sam Im' 
AND Credit.role = 'additional timer';
```
-------------------------4366 sample_num
```sql
SELECT title 
FROM Episode 
WHERE episode_id IN (
    SELECT episode_id 
    FROM Vote 
    WHERE stars > (SELECT AVG(stars) * 0.7 FROM Vote)
);
```
-------------------------4367 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN result = 'Nominee' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Award
WHERE 
    episode_id IN (SELECT episode_id FROM Episode WHERE title = 'Gone Maggie Gone' AND YEAR(air_date) = 2009);
```
-------------------------4368 sample_num
```sql
SELECT COUNT(DISTINCT name) 
FROM person 
WHERE name NOT IN (SELECT name FROM longest_absense_from_school);
```
-------------------------4369 sample_num
```sql
SELECT MAX(month) AS longest_absence
FROM longest_absense_from_school;
```
-------------------------4370 sample_num
```sql
SELECT COUNT(*) FROM enlist WHERE organ = 'navy';
```
-------------------------4371 sample_num
```sql
SELECT COUNT(*) 
FROM longest_absense_from_school las 
JOIN male m ON las.name = m.name 
WHERE las.month > 5;
```
-------------------------4372 sample_num
```sql
SELECT p.name 
FROM person p 
JOIN male m ON p.name = m.name 
JOIN enlist e ON p.name = e.name 
WHERE e.organ = 'navy';
```
-------------------------4373 sample_num
```sql
SELECT COUNT(*) 
FROM filed_for_bankrupcy f 
JOIN longest_absense_from_school l ON f.name = l.name 
WHERE l.month > 5;
```
-------------------------4374 sample_num
```sql
SELECT COUNT(*) 
FROM enlist e 
JOIN no_payment_due n ON e.name = n.name 
WHERE e.organ = 'navy' AND n.bool = 'pos';
```
-------------------------4375 sample_num
```sql
SELECT m.name 
FROM male m 
JOIN disabled d ON m.name = d.name 
JOIN filed_for_bankrupcy f ON m.name = f.name;
```
-------------------------4376 sample_num
```sql
SELECT COUNT(*) 
FROM disabled 
WHERE name NOT IN (SELECT name FROM male);
```
-------------------------4377 sample_num
```sql
SELECT COUNT(*) 
FROM unemployed u 
JOIN no_payment_due n ON u.name = n.name 
WHERE n.bool = 1;
```
-------------------------4378 sample_num
```sql
SELECT MAX(l.month) AS longest_absence
FROM enlist e
JOIN longest_absense_from_school l ON e.name = l.name
WHERE e.organ = 'navy';
```
-------------------------4379 sample_num
```sql
SELECT COUNT(DISTINCT d.name) 
FROM disabled d 
LEFT JOIN longest_absense_from_school l ON d.name = l.name 
WHERE l.month = 0 OR l.month IS NULL;
```
-------------------------4380 sample_num
```sql
SELECT school FROM enrolled WHERE name IN (SELECT name FROM longest_absense_from_school WHERE month = 9);
```
-------------------------4381 sample_num
```sql
SELECT organ, COUNT(disabled.name) AS disabled_count
FROM disabled
JOIN enlist ON disabled.name = enlist.name
GROUP BY organ
ORDER BY disabled_count DESC
LIMIT 1;
```
-------------------------4382 sample_num
```sql
SELECT f.name 
FROM filed_for_bankrupcy f 
LEFT JOIN male m ON f.name = m.name 
WHERE m.name IS NULL;
```
-------------------------4383 sample_num
```sql
SELECT (COUNT(CASE WHEN m.name IS NOT NULL THEN 1 END) * 100.0 / COUNT(e.name)) AS male_percentage
FROM enlist e
LEFT JOIN male m ON e.name = m.name
WHERE e.organ = 'navy';
```
-------------------------4384 sample_num
```sql
SELECT DIVIDE(SUM(l.month), COUNT(d.name)) AS average_absence_time
FROM disabled d
JOIN longest_absense_from_school l ON d.name = l.name;
```
-------------------------4385 sample_num
```sql
SELECT name FROM enlist WHERE organ = 'foreign_legion';
```
-------------------------4386 sample_num
```sql
SELECT bool FROM no_payment_due WHERE name = 'student348';
```
-------------------------4387 sample_num
```sql
SELECT school FROM enrolled WHERE name = 'student829';
```
-------------------------4388 sample_num
```sql
SELECT COUNT(month) AS months_absent FROM longest_absense_from_school WHERE name = 'student217';
```
-------------------------4389 sample_num
```sql
SELECT name FROM longest_absense_from_school WHERE month = 6;
```
-------------------------4390 sample_num
```sql
SELECT organ FROM enlist WHERE name = 'student285';
```
-------------------------4391 sample_num
```sql
SELECT d.name AS is_disabled, e.school 
FROM disabled d 
JOIN enrolled e ON d.name = e.name 
WHERE d.name = 'student281';
```
-------------------------4392 sample_num
```sql
SELECT e.name, e.school 
FROM enlist AS en 
JOIN enrolled AS e ON en.name = e.name 
WHERE en.organ = 'air_force';
```
-------------------------4393 sample_num
```sql
SELECT n.name 
FROM no_payment_due n 
LEFT JOIN male m ON n.name = m.name 
WHERE n.bool = 'neg' AND m.name IS NULL 
LIMIT 10;
```
-------------------------4394 sample_num
```sql
SELECT e.name, e.organ
FROM enlist e
JOIN no_payment_due n ON e.name = n.name
WHERE n.bool = 'pos'
LIMIT 5;
```
-------------------------4395 sample_num
```sql
SELECT d.name 
FROM disabled d 
JOIN enrolled e ON d.name = e.name 
WHERE e.school = 'smc';
```
-------------------------4396 sample_num
```sql
SELECT f.name 
FROM filed_for_bankrupcy f 
JOIN enlist e ON f.name = e.name 
WHERE e.organ = 'foreign_legion';
```
-------------------------4397 sample_num
```sql
SELECT COUNT(DISTINCT m.name) 
FROM male m 
JOIN no_payment_due n ON m.name = n.name 
WHERE n.bool = 'neg';
```
-------------------------4398 sample_num
```sql
SELECT e.name 
FROM enlist e 
JOIN longest_absense_from_school l ON e.name = l.name 
WHERE e.organ = 'marines' AND l.month = 6;
```
-------------------------4399 sample_num
```sql
SELECT COUNT(*) 
FROM enrolled e 
JOIN unemployed u ON e.name = u.name 
WHERE e.school = 'smc';
```
-------------------------4400 sample_num
```sql
SELECT COUNT(*) 
FROM unemployed 
JOIN longest_absense_from_school ON unemployed.name = longest_absense_from_school.name 
WHERE longest_absense_from_school.month = 6;
```
-------------------------4401 sample_num
```sql
SELECT COUNT(*) 
FROM enlist 
JOIN enrolled ON enlist.name = enrolled.name 
WHERE enlist.organ = 'peace_corps' AND enrolled.school = 'ucsd';
```
-------------------------4402 sample_num
```sql
SELECT e.organ, la.month 
FROM enlist e 
LEFT JOIN longest_absense_from_school la ON e.name = la.name 
WHERE e.name = 'Student21';
```
-------------------------4403 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN n.bool = 'pos' THEN 1 END) * 100.0 / COUNT(CASE WHEN n.bool = 'neg' THEN 1 END)) AS percentage_ratio
FROM 
    no_payment_due n
JOIN 
    enlist e ON n.name = e.name
WHERE 
    e.organ = 'foreign_legion';
```
-------------------------4404 sample_num
```sql
SELECT 
    (COUNT(DISTINCT e.name) * 100.0 / NULLIF((SELECT COUNT(DISTINCT e2.name) FROM enrolled e2 WHERE e2.school = 'occ'), 0)) AS percentage
FROM 
    enlist en
JOIN 
    enrolled e ON en.name = e.name
WHERE 
    en.organ = 'navy' AND e.school = 'occ';
```
-------------------------4405 sample_num
```sql
SELECT name FROM longest_absense_from_school WHERE month = (SELECT MAX(month) FROM longest_absense_from_school);
```
-------------------------4406 sample_num
```sql
SELECT COUNT(DISTINCT name) AS total_students FROM enrolled;
```
-------------------------4407 sample_num
```sql
SELECT MAX(month) AS longest_absence_duration FROM longest_absense_from_school;
```
-------------------------4408 sample_num
```sql
SELECT COUNT(*) FROM longest_absense_from_school WHERE month = 4;
```
-------------------------4409 sample_num
```sql
SELECT COUNT(DISTINCT u.name) AS unemployed_bankrupt_count
FROM unemployed u
JOIN filed_for_bankrupcy b ON u.name = b.name;
```
-------------------------4410 sample_num
```sql
SELECT e.name, e.organ 
FROM disabled d 
JOIN enlist e ON d.name = e.name;
```
-------------------------4411 sample_num
```sql
SELECT COUNT(*) 
FROM unemployed u 
JOIN filed_for_bankrupcy b ON u.name = b.name 
JOIN no_payment_due n ON u.name = n.name 
WHERE n.bool = 'pos';
```
-------------------------4412 sample_num
```sql
SELECT 
    CASE 
        WHEN d.name IS NOT NULL THEN 'Yes' 
        ELSE 'No' 
    END AS is_disabled,
    CASE 
        WHEN m.name IS NOT NULL THEN 'Yes' 
        ELSE 'No' 
    END AS is_male
FROM 
    disabled d 
FULL OUTER JOIN 
    male m ON d.name = m.name
WHERE 
    d.name = '124' OR m.name = '124';
```
-------------------------4413 sample_num
```sql
SELECT 
    p.name,
    CASE WHEN d.name IS NOT NULL THEN 'Disabled' ELSE 'Not Disabled' END AS disability,
    CASE WHEN m.name IS NOT NULL THEN 'Male' ELSE 'Female' END AS gender,
    CASE WHEN n.name IS NOT NULL AND n.bool = 'pos' THEN 'Has Payment Due'
         WHEN n.name IS NOT NULL AND n.bool = 'neg' THEN 'No Payment Due'
         ELSE 'Unknown' END AS school_debt_status,
    CASE WHEN u.name IS NOT NULL THEN 'Unemployed' ELSE 'Employed' END AS employment
FROM 
    person p
LEFT JOIN 
    disabled d ON p.name = d.name
LEFT JOIN 
    male m ON p.name = m.name
LEFT JOIN 
    no_payment_due n ON p.name = n.name
LEFT JOIN 
    unemployed u ON p.name = u.name
WHERE 
    p.name IN ('student180', 'student117');
```
-------------------------4414 sample_num
```sql
SELECT COUNT(DISTINCT e.name) AS female_students_joined
FROM enlist e
JOIN person p ON e.name = p.name
LEFT JOIN male m ON p.name = m.name
WHERE e.organ IN ('marines', 'air_force') AND m.name IS NULL;
```
-------------------------4415 sample_num
```sql
SELECT e.school, en.organ
FROM enrolled e
JOIN enlist en ON e.name = en.name
WHERE e.name IN ('student27', 'student17', 'student101');
```
-------------------------4416 sample_num
```sql
SELECT 
    COUNT(DISTINCT d.name) / NULLIF(COUNT(DISTINCT m.name), 0) AS ratio
FROM 
    disabled d
LEFT JOIN 
    male m ON d.name = m.name;
```
-------------------------4417 sample_num
```sql
SELECT COUNT(DISTINCT e.name) AS female_students_not_joining
FROM enlist e
WHERE e.name NOT IN (SELECT m.name FROM male m);
```
-------------------------4418 sample_num
```sql
SELECT f.name 
FROM filed_for_bankrupcy f 
JOIN no_payment_due n ON f.name = n.name 
WHERE n.bool = 'neg';
```
-------------------------4419 sample_num
```sql
SELECT DIVIDE(SUM(month), COUNT(name)) AS average_absence_period
FROM longest_absense_from_school;
```
-------------------------4420 sample_num
```sql
SELECT DIVIDE(SUM(las.month), COUNT(e.name)) AS average_absence
FROM longest_absense_from_school las
JOIN enrolled e ON las.name = e.name
JOIN no_payment_due npd ON e.name = npd.name
WHERE npd.bool = 0;
```
-------------------------4421 sample_num
```sql
SELECT DIVIDE(SUM(las.month), COUNT(DISTINCT las.name)) AS average_absence_period
FROM longest_absense_from_school las
JOIN disabled d ON las.name = d.name;
```
-------------------------4422 sample_num
```sql
SELECT organ FROM enlist WHERE name = '313';
```
-------------------------4423 sample_num
```sql
SELECT COUNT(*) FROM enlist WHERE organ = 'fire_department';
```
-------------------------4424 sample_num
```sql
SELECT COUNT(DISTINCT p.name) 
FROM person p 
LEFT JOIN longest_absense_from_school l ON p.name = l.name 
WHERE l.month = 0 OR l.month IS NULL;
```
-------------------------4425 sample_num
```sql
SELECT COUNT(*) 
FROM longest_absense_from_school 
WHERE month > 2;
```
-------------------------4426 sample_num
```sql
SELECT COUNT(*) 
FROM no_payment_due 
WHERE bool = 'neg';
```
-------------------------4427 sample_num
```sql
SELECT COUNT(*) 
FROM no_payment_due 
WHERE bool = 'pos';
```
-------------------------4428 sample_num
```sql
SELECT d.name 
FROM disabled d 
LEFT JOIN longest_absense_from_school l ON d.name = l.name 
WHERE l.month IS NULL OR l.month = 0;
```
-------------------------4429 sample_num
```sql
SELECT COUNT(*) 
FROM unemployed 
JOIN enlist ON unemployed.name = enlist.name 
WHERE enlist.organ = 'navy';
```
-------------------------4430 sample_num
```sql
SELECT COUNT(*) 
FROM male 
JOIN enlist ON male.name = enlist.name 
WHERE enlist.organ = 'foreign_legion';
```
-------------------------4431 sample_num
```sql
SELECT COUNT(DISTINCT p.name) AS female_students
FROM person p
JOIN enlist e ON p.name = e.name
LEFT JOIN male m ON p.name = m.name
WHERE e.organ = 'air_force' AND m.name IS NULL;
```
-------------------------4432 sample_num
```sql
SELECT d.name 
FROM disabled d 
JOIN longest_absense_from_school l ON d.name = l.name 
WHERE l.month = (SELECT MAX(month) FROM longest_absense_from_school);
```
-------------------------4433 sample_num
```sql
SELECT u.name 
FROM unemployed u 
JOIN enlist e ON u.name = e.name 
WHERE e.organ = 'marines';
```
-------------------------4434 sample_num
```sql
SELECT DIVIDE(SUM(las.month), COUNT(las.name)) AS average_absence_duration
FROM longest_absense_from_school las
JOIN disabled d ON las.name = d.name;
```
-------------------------4435 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN la.month > 5 THEN 1 END) * 100.0 / COUNT(la.month)) AS percentage
FROM 
    unemployed u
JOIN 
    longest_absense_from_school la ON u.name = la.name;
```
-------------------------4436 sample_num
```sql
SELECT COUNT(DISTINCT u.name) 
FROM unemployed u 
JOIN disabled d ON u.name = d.name 
JOIN longest_absense_from_school l ON u.name = l.name 
WHERE l.month = 8;
```
-------------------------4437 sample_num
```sql
SELECT u.name 
FROM unemployed u 
JOIN longest_absense_from_school l ON u.name = l.name 
WHERE l.month = (SELECT MAX(month) FROM longest_absense_from_school);
```
-------------------------4438 sample_num
```sql
SELECT u.name 
FROM unemployed u 
LEFT JOIN longest_absense_from_school l ON u.name = l.name 
WHERE l.month = 0 OR l.month IS NULL;
```
-------------------------4439 sample_num
```sql
SELECT COUNT(DISTINCT d.name) 
FROM disabled d 
JOIN longest_absense_from_school l ON d.name = l.name 
WHERE l.month = 3;
```
-------------------------4440 sample_num
```sql
SELECT f.name 
FROM filed_for_bankrupcy f 
LEFT JOIN longest_absense_from_school l ON f.name = l.name 
WHERE l.month = 0 OR l.month IS NULL;
```
-------------------------4441 sample_num
```sql
SELECT f.name
FROM filed_for_bankrupcy f
JOIN longest_absense_from_school l ON f.name = l.name
WHERE l.month = (SELECT MAX(month) FROM longest_absense_from_school);
```
-------------------------4442 sample_num
```sql
SELECT CASE 
           WHEN EXISTS (SELECT 1 FROM male WHERE name = 'student1000') THEN 'Male' 
           ELSE 'Female' 
       END AS gender;
```
-------------------------4443 sample_num
```sql
SELECT COUNT(*) FROM disabled;
```
-------------------------4444 sample_num
```sql
SELECT COUNT(*) 
FROM longest_absense_from_school 
WHERE month > 6;
```
-------------------------4445 sample_num
```sql
SELECT name, MAX(month) AS max_absent
FROM longest_absense_from_school
GROUP BY name
ORDER BY max_absent DESC;
```
-------------------------4446 sample_num
```sql
SELECT COUNT(*) FROM enlist WHERE organ = 'army';
```
-------------------------4447 sample_num
```sql
SELECT name, DIVIDE(SUM(month), COUNT(name)) AS average_absences
FROM longest_absense_from_school
GROUP BY name;
```
-------------------------4448 sample_num
```sql
SELECT COUNT(*) AS total_enlisted
FROM enlist
WHERE organ IN ('foreign_legion', 'peace_corps', 'army');
```
-------------------------4449 sample_num
```sql
SELECT COUNT(DISTINCT e.name) 
FROM enlist e 
JOIN disabled d ON e.name = d.name 
WHERE e.organ = 'marines';
```
-------------------------4450 sample_num
```sql
SELECT COUNT(*) 
FROM unemployed u 
JOIN no_payment_due n ON u.name = n.name 
WHERE n.bool = 'pos';
```
-------------------------4451 sample_num
```sql
SELECT p.name 
FROM person p 
LEFT JOIN longest_absense_from_school l ON p.name = l.name 
WHERE l.month = 0 OR l.month IS NULL 
AND p.name NOT IN (SELECT name FROM male);
```
-------------------------4452 sample_num
```sql
SELECT school, COUNT(disabled.name) AS disabled_count
FROM disabled
JOIN enrolled ON disabled.name = enrolled.name
GROUP BY school
ORDER BY disabled_count DESC
LIMIT 1;
```
-------------------------4453 sample_num
```sql
SELECT e.organ 
FROM filed_for_bankrupcy f 
JOIN enlist e ON f.name = e.name;
```
-------------------------4454 sample_num
```sql
SELECT COUNT(DISTINCT e.name) AS male_students
FROM enlist e
JOIN male m ON e.name = m.name
GROUP BY e.name
HAVING COUNT(e.organ) > 1;
```
-------------------------4455 sample_num
```sql
SELECT e.name 
FROM enlist e 
JOIN disabled d ON e.name = d.name 
WHERE e.organ = 'navy';
```
-------------------------4456 sample_num
```sql
SELECT COUNT(*) 
FROM longest_absense_from_school 
WHERE month = 7 AND name IN (SELECT name FROM enrolled WHERE school = 'smc');
```
-------------------------4457 sample_num
```sql
SELECT p.name 
FROM person p 
JOIN disabled d ON p.name = d.name 
JOIN female f ON p.name = f.name;
```
-------------------------4458 sample_num
```sql
SELECT 
    COUNT(u.name) * 1.0 / COUNT(d.name) AS ratio
FROM 
    unemployed u, 
    disabled d;
```
-------------------------4459 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN e.organ = 'fire_department' THEN 1 END) * 100.0) / COUNT(m.name) AS percentage
FROM 
    male m
JOIN 
    enlist e ON m.name = e.name;
```
-------------------------4460 sample_num
```sql
SELECT COUNT(*) 
FROM longest_absense_from_school 
WHERE month = 5;
```
-------------------------4461 sample_num
```sql
SELECT COUNT(*) FROM enlist WHERE organ = 'army';
```
-------------------------4462 sample_num
```sql
SELECT COUNT(*) FROM enrolled WHERE school = 'ucla';
```
-------------------------4463 sample_num
```sql
SELECT name, MAX(month) AS longest_absence
FROM longest_absense_from_school
GROUP BY name
ORDER BY longest_absence DESC
LIMIT 5;
```
-------------------------4464 sample_num
```sql
SELECT COUNT(name) 
FROM enlist 
GROUP BY name 
HAVING COUNT(organ) >= 2;
```
-------------------------4465 sample_num
```sql
SELECT COUNT(*) FROM enlist WHERE organ = 'navy';
```
-------------------------4466 sample_num
```sql
SELECT COUNT(m.name) 
FROM male m 
LEFT JOIN no_payment_due npd ON m.name = npd.name AND npd.bool = 'neg' 
WHERE npd.name IS NOT NULL;
```
-------------------------4467 sample_num
```sql
SELECT COUNT(DISTINCT e.name) 
FROM enlist e 
JOIN enrolled en ON e.name = en.name 
WHERE e.organ = 'peace_corps' AND en.school = 'ucsd';
```
-------------------------4468 sample_num
```sql
SELECT COUNT(*) 
FROM unemployed 
WHERE name IN (SELECT name FROM no_payment_due WHERE bool = 'neg');
```
-------------------------4469 sample_num
```sql
SELECT COUNT(DISTINCT p.name) 
FROM person p 
LEFT JOIN male m ON p.name = m.name 
JOIN no_payment_due n ON p.name = n.name 
WHERE m.name IS NULL AND n.bool = 'neg';
```
-------------------------4470 sample_num
```sql
SELECT COUNT(DISTINCT u.name) 
FROM unemployed u 
LEFT JOIN longest_absense_from_school l ON u.name = l.name 
WHERE l.month = 0 OR l.month IS NULL;
```
-------------------------4471 sample_num
```sql
SELECT DISTINCT n.name
FROM no_payment_due n
JOIN enlist e ON n.name = e.name
WHERE n.bool = 'neg' AND e.organ = 'fire_department'
LIMIT 10;
```
-------------------------4472 sample_num
```sql
SELECT COUNT(DISTINCT e.name) 
FROM enlist e 
WHERE e.organ = 'navy' 
AND e.name NOT IN (SELECT m.name FROM male m);
```
-------------------------4473 sample_num
```sql
SELECT COUNT(DISTINCT u.name) 
FROM unemployed u 
JOIN enlist e ON u.name = e.name 
WHERE e.organ = 'army';
```
-------------------------4474 sample_num
```sql
SELECT COUNT(*) 
FROM unemployed u 
JOIN no_payment_due n ON u.name = n.name 
WHERE n.bool = 'pos';
```
-------------------------4475 sample_num
```sql
SELECT DISTINCT e.name
FROM enrolled e
JOIN no_payment_due np ON e.name = np.name
JOIN enlist en ON e.name = en.name
WHERE np.bool = 'pos' AND en.organ = 'Peace Corps'
LIMIT 5;
```
-------------------------4476 sample_num
```sql
SELECT COUNT(DISTINCT d.name) 
FROM disabled d 
WHERE d.name NOT IN (SELECT m.name FROM male m);
```
-------------------------4477 sample_num
```sql
SELECT COUNT(DISTINCT d.name) 
FROM disabled d 
JOIN no_payment_due npd ON d.name = npd.name 
WHERE npd.bool = 'pos';
```
-------------------------4478 sample_num
```sql
SELECT AVG(female_count) AS average_female_disabled
FROM (
    SELECT COUNT(disabled.name) AS female_count
    FROM disabled
    WHERE disabled.name NOT IN (SELECT name FROM male)
    AND disabled.name IN (SELECT name FROM enlist WHERE organ = 'Foreign Legion')
) AS subquery;
```
-------------------------4479 sample_num
```sql
SELECT 
    CONCAT(MULTIPLY(DIVIDE(COUNT(enlist.name) FILTER (WHERE enlist.name NOT IN (SELECT name FROM male)) , COUNT(enlist.name)), 100), '%') AS FEMALE,
    CONCAT(MULTIPLY(DIVIDE(COUNT(enlist.name) FILTER (WHERE enlist.name IN (SELECT name FROM male)), COUNT(enlist.name)), 100), '%') AS MALE
FROM 
    enlist
WHERE 
    organ = 'fire_department';
```
-------------------------4480 sample_num
```sql
SELECT COUNT(*) FROM enlist WHERE organ = 'navy';
```
-------------------------4481 sample_num
```sql
SELECT CONCAT(DIVIDE(MULTIPLY(COUNT(name WHERE month = 0), 100), COUNT(name)),'%') AS percentage_never_absent
FROM longest_absense_from_school;
```
-------------------------4482 sample_num
```sql
SELECT 
    DIVIDE(COUNT(CASE WHEN bool = 'pos' THEN name END), 
           COUNT(CASE WHEN bool = 'neg' THEN name END)) AS payment_due_ratio
FROM 
    no_payment_due;
```
-------------------------4483 sample_num
```sql
SELECT name, school FROM enrolled WHERE month = 15;
```
-------------------------4484 sample_num
```sql
SELECT AVG(enlisted_count) AS average_enlisted_students
FROM (
    SELECT organ, COUNT(name) AS enlisted_count
    FROM enlist
    GROUP BY organ
) AS org_counts;
```
-------------------------4485 sample_num
```sql
SELECT school, month FROM enrolled WHERE name = 'student214';
```
-------------------------4486 sample_num
```sql
SELECT CONCAT(DIVIDE(MULTIPLY(COUNT(disabled.name), 100), COUNT(person.name) - COUNT(disabled.name)), '%') AS disabled_percentage
FROM person
LEFT JOIN disabled ON person.name = disabled.name;
```
-------------------------4487 sample_num
```sql
SELECT COUNT(*) 
FROM disabled 
WHERE name IN (
    SELECT name 
    FROM longest_absense_from_school 
    WHERE month = 9
);
```
-------------------------4488 sample_num
```sql
SELECT person.name 
FROM person 
WHERE person.name NOT IN (SELECT filed_for_bankrupcy.name FROM filed_for_bankrupcy);
```
-------------------------4489 sample_num
```sql
SELECT e.name 
FROM enlist e 
WHERE e.organ = 'air_force' 
AND e.name NOT IN (SELECT m.name FROM male m) 
LIMIT 5;
```
-------------------------4490 sample_num
```sql
SELECT COUNT(*) 
FROM person 
WHERE name NOT IN (SELECT name FROM disabled);
```
-------------------------4491 sample_num
```sql
SELECT 
    CASE 
        WHEN male.name = 'student995' THEN 'male' 
        ELSE 'female' 
    END AS gender,
    enrolled.school 
FROM 
    enrolled 
LEFT JOIN 
    male ON enrolled.name = male.name 
WHERE 
    enrolled.name = 'student995';
```
-------------------------4492 sample_num
```sql
SELECT d.name 
FROM disabled d 
JOIN unemployed u ON d.name = u.name 
LIMIT 5;
```
-------------------------4493 sample_num
```sql
SELECT COUNT(*) 
FROM unemployed 
WHERE name IN (SELECT name FROM filed_for_bankrupcy);
```
-------------------------4494 sample_num
```sql
SELECT p.name, e.organ
FROM longest_absense_from_school las
JOIN person p ON las.name = p.name
JOIN enlist e ON p.name = e.name
WHERE las.month = 4
LIMIT 5;
```
-------------------------4495 sample_num
```sql
SELECT COUNT(*) 
FROM no_payment_due 
WHERE name IN (SELECT name FROM bool WHERE bool = 'pos') 
AND name IN (SELECT name FROM unemployed);
```
-------------------------4496 sample_num
```sql
SELECT e.organ, np.bool 
FROM enlist e 
JOIN no_payment_due np ON e.name = np.name 
WHERE e.name = 'student160';
```
-------------------------4497 sample_num
```sql
SELECT DISTINCT m.name 
FROM male m 
JOIN enlist e ON m.name = e.name 
WHERE e.organ = 'foreign_legion' 
LIMIT 10;
```
-------------------------4498 sample_num
```sql
SELECT CONCAT(DIVIDE(COUNT(person.name) - COUNT(male.name), COUNT(person.name)) * 100, '%') AS female_percentage
FROM person
LEFT JOIN male ON person.name = male.name;
```
-------------------------4499 sample_num
```sql
SELECT COUNT(*) FROM filed_for_bankrupcy;
```
-------------------------4500 sample_num
```sql
SELECT COUNT(*) FROM enrolled WHERE school = 'smc' AND month = 1;
```
-------------------------4501 sample_num
```sql
SELECT COUNT(*) 
FROM enlist 
WHERE organ = 'air_force';
```
-------------------------4502 sample_num
```sql
SELECT organ FROM enlist WHERE name = 'student168';
```
-------------------------4503 sample_num
```sql
SELECT COUNT(DISTINCT e.name) 
FROM disabled d 
JOIN male m ON d.name = m.name 
JOIN enlist e ON d.name = e.name;
```
-------------------------4504 sample_num
```sql
SELECT e.school, COUNT(d.name) AS disabled_count
FROM enrolled e
LEFT JOIN disabled d ON e.name = d.name
GROUP BY e.school;
```
-------------------------4505 sample_num
```sql
SELECT e.organ, 
       COUNT(m.name) AS male_count, 
       COUNT(e.name) - COUNT(m.name) AS female_count
FROM enlist e
LEFT JOIN male m ON e.name = m.name
GROUP BY e.organ;
```
-------------------------4506 sample_num
```sql
SELECT name
FROM (
    SELECT name, COUNT(DISTINCT school) AS school_count, COUNT(DISTINCT organ) AS organ_count
    FROM enrolled
    LEFT JOIN enlist ON enrolled.name = enlist.name
    GROUP BY name
) AS counts
WHERE school_count = 2 AND organ_count = 2;
```
-------------------------4507 sample_num
```sql
SELECT CONCAT(DIVIDE(MULTIPLY(SUBTRACT(COUNT(CASE WHEN month = 0 THEN name END), COUNT(CASE WHEN month = 9 THEN name END)), 100), COUNT(CASE WHEN month = 0 THEN name END)),'%') AS percentage_difference
FROM longest_absense_from_school;
```
-------------------------4508 sample_num
```sql
SELECT school, COUNT(*) AS enrollment_count, 
       (SELECT COUNT(*) FROM filed_for_bankrupcy WHERE name IN (SELECT name FROM enrolled WHERE school = e.school)) AS bankruptcy_count
FROM enrolled e
GROUP BY school
HAVING COUNT(*) = (SELECT MAX(enrollment_count) FROM (SELECT COUNT(*) AS enrollment_count FROM enrolled GROUP BY school) AS subquery);
```
-------------------------4509 sample_num
```sql
SELECT COUNT(*) 
FROM disabled 
JOIN unemployed ON disabled.name = unemployed.name;
```
-------------------------4510 sample_num
```sql
SELECT e.name 
FROM enrolled e 
JOIN enlist en ON e.name = en.name 
WHERE e.school = 'occ' AND en.organ = 'fire_department';
```
-------------------------4511 sample_num
```sql
SELECT m.name 
FROM male m 
JOIN unemployed u ON m.name = u.name 
JOIN disabled d ON u.name = d.name 
JOIN longest_absense_from_school a ON d.name = a.name 
WHERE a.month = 5;
```
-------------------------4512 sample_num
```sql
SELECT e.name 
FROM enrolled e 
WHERE e.school IN ('occ', 'ulca') 
AND e.name NOT IN (SELECT m.name FROM male m);
```
-------------------------4513 sample_num
```sql
SELECT e.school, en.organ 
FROM enrolled e 
JOIN enlist en ON e.name = en.name 
WHERE e.name = 'student211';
```
-------------------------4514 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM filed_for_bankrupcy WHERE name IN (SELECT name FROM male)) AS male_bankruptcies,
    (SELECT COUNT(*) FROM filed_for_bankrupcy WHERE name NOT IN (SELECT name FROM male)) AS female_bankruptcies;
```
-------------------------4515 sample_num
```sql
SELECT AVG(las.month) AS average_absent_month
FROM longest_absense_from_school las
JOIN unemployed u ON las.name = u.name
JOIN male m ON u.name = m.name;
```
-------------------------4516 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN d.name IS NOT NULL THEN l.name END) * 100.0 / NULLIF(COUNT(l.name), 0)) AS disabled_attendance_percentage,
    (COUNT(CASE WHEN d.name IS NULL THEN l.name END) * 100.0 / NULLIF(COUNT(l.name), 0)) AS non_disabled_attendance_percentage,
    (COUNT(CASE WHEN d.name IS NOT NULL THEN l.name END) - COUNT(CASE WHEN d.name IS NULL THEN l.name END)) AS attendance_difference,
    CASE 
        WHEN COUNT(CASE WHEN d.name IS NOT NULL THEN l.name END) < COUNT(CASE WHEN d.name IS NULL THEN l.name END) THEN 'Disabled students have better attendance'
        ELSE 'Disabled students do not have better attendance'
    END AS attendance_comparison
FROM 
    longest_absense_from_school l
LEFT JOIN 
    disabled d ON l.name = d.name;
```
-------------------------4517 sample_num
```sql
SELECT DIVIDE(SUM(l.month), COUNT(l.month)) AS average_duration
FROM longest_absense_from_school l
JOIN disabled d ON l.name = d.name
JOIN male m ON d.name = m.name;
```
-------------------------4518 sample_num
```sql
SELECT CONCAT(DIVIDE(MULTIPLY(COUNT(u.name WHERE la.month = 0), 100), COUNT(la.month)), '%') AS ratio
FROM unemployed u
LEFT JOIN longest_absense_from_school la ON u.name = la.name;
```
-------------------------4519 sample_num
```sql
SELECT COUNT(*) 
FROM male 
WHERE name NOT IN (SELECT name FROM no_payment_due WHERE bool = 'pos');
```
-------------------------4520 sample_num
```sql
SELECT COUNT(*) 
FROM filed_for_bankrupcy f 
JOIN no_payment_due n ON f.name = n.name 
WHERE n.bool = 'pos';
```
-------------------------4521 sample_num
```sql
SELECT bool FROM no_payment_due WHERE name = 'student124';
```
-------------------------4522 sample_num
```sql
SELECT COUNT(DISTINCT d.name) AS disabled_students_with_payment_due
FROM disabled d
JOIN no_payment_due np ON d.name = np.name
WHERE np.bool = 'pos';
```
-------------------------4523 sample_num
```sql
SELECT la.name
FROM longest_absense_from_school la
JOIN no_payment_due np ON la.name = np.name
WHERE la.month = (SELECT MAX(month) FROM longest_absense_from_school)
AND np.bool = 'neg';
```
-------------------------4524 sample_num
```sql
SELECT l.name 
FROM longest_absense_from_school l 
JOIN no_payment_due n ON l.name = n.name 
WHERE l.month = 5 AND n.bool = 'neg';
```
-------------------------4525 sample_num
```sql
SELECT COUNT(DISTINCT d.name) AS disabled_students_count
FROM disabled d
JOIN enlist e ON d.name = e.name
WHERE e.organ = 'marines';
```
-------------------------4526 sample_num
```sql
SELECT COUNT(*) 
FROM longest_absense_from_school las 
JOIN enlist e ON las.name = e.name 
WHERE las.month = (SELECT MAX(month) FROM longest_absense_from_school) 
AND e.organ = 'peace_corps';
```
-------------------------4527 sample_num
```sql
SELECT COUNT(DISTINCT f.name) AS number_of_students
FROM filed_for_bankrupcy f
JOIN enlist e ON f.name = e.name
WHERE e.organ = 'navy';
```
-------------------------4528 sample_num
```sql
SELECT COUNT(*) 
FROM enlist e 
JOIN no_payment_due np ON e.name = np.name 
WHERE e.organ = 'marines' AND np.bool = 'pos';
```
-------------------------4529 sample_num
```sql
SELECT 
    (SUM(CASE WHEN la.month = 0 THEN 1 ELSE 0 END) * 100.0 / COUNT(d.name)) AS ratio
FROM 
    disabled d
LEFT JOIN 
    longest_absense_from_school la ON d.name = la.name;
```
-------------------------4530 sample_num
```sql
SELECT COUNT(*) FROM enlist WHERE organ = 'air_force';
```
-------------------------4531 sample_num
```sql
SELECT COUNT(*) 
FROM longest_absense_from_school 
WHERE month < 4;
```
-------------------------4532 sample_num
```sql
SELECT COUNT(DISTINCT e.name) 
FROM enlist e 
WHERE e.organ = 'marines' 
AND e.name NOT IN (SELECT m.name FROM male m);
```
-------------------------4533 sample_num
```sql
SELECT DIVIDE(SUM(las.month), COUNT(las.name)) AS average_duration
FROM longest_absense_from_school las
WHERE las.name NOT IN (SELECT m.name FROM male m);
```
-------------------------4534 sample_num
```sql
SELECT f.name 
FROM filed_for_bankrupcy f 
WHERE f.name NOT IN (SELECT m.name FROM male m);
```
-------------------------4535 sample_num
```sql
SELECT bool FROM no_payment_due WHERE name = 'student299';
```
-------------------------4536 sample_num
```sql
SELECT COUNT(*) FROM enlist WHERE organ = 'air_force';
```
-------------------------4537 sample_num
```sql
SELECT COUNT(*) 
FROM longest_absense_from_school 
WHERE month > 1;
```
-------------------------4538 sample_num
```sql
SELECT name FROM enlist WHERE organ = 'fire_department';
```
-------------------------4539 sample_num
```sql
SELECT COUNT(DISTINCT d.name) 
FROM disabled d 
JOIN no_payment_due npd ON d.name = npd.name 
WHERE npd.bool = 'pos';
```
-------------------------4540 sample_num
```sql
SELECT COUNT(DISTINCT f.name) 
FROM filed_for_bankrupcy f 
JOIN enrolled e ON f.name = e.name 
WHERE e.school = 'occ';
```
-------------------------4541 sample_num
```sql
SELECT COUNT(DISTINCT d.name) AS disabled_male_count
FROM disabled d
JOIN male m ON d.name = m.name;
```
-------------------------4542 sample_num
```sql
SELECT d.name 
FROM disabled d 
JOIN enlist e ON d.name = e.name 
WHERE e.organ = 'navy';
```
-------------------------4543 sample_num
```sql
SELECT m.name
FROM male m
JOIN no_payment_due npd ON m.name = npd.name
WHERE npd.bool = 'pos';
```
-------------------------4544 sample_num
```sql
SELECT 
    CASE 
        WHEN u.name IS NOT NULL THEN 'unemployed' 
        ELSE 'employed' 
    END AS employment_status,
    CASE 
        WHEN n.bool = 'pos' THEN 'payment due' 
        ELSE 'no payment due' 
    END AS payment_status
FROM 
    unemployed u
FULL OUTER JOIN 
    no_payment_due n ON u.name = n.name
WHERE 
    COALESCE(u.name, n.name) = 'student110';
```
-------------------------4545 sample_num
```sql
SELECT (COUNT(male.name) * 100.0 / COUNT(person.name)) AS percentage_of_male_students
FROM person
LEFT JOIN male ON person.name = male.name;
```
-------------------------4546 sample_num
```sql
SELECT e.school, 
       CASE WHEN m.name IS NOT NULL THEN 'male' ELSE 'female' END AS gender
FROM enrolled e
LEFT JOIN male m ON e.name = m.name
WHERE e.name = 'student34';
```
-------------------------4547 sample_num
```sql
SELECT MAX(l.month) AS longest_absence
FROM longest_absense_from_school l
JOIN enlist e ON l.name = e.name
WHERE e.organ = 'fire_department';
```
-------------------------4548 sample_num
```sql
SELECT COUNT(DISTINCT e.name) 
FROM longest_absense_from_school las 
JOIN enlist e ON las.name = e.name 
WHERE las.month = 1 AND e.organ = 'air_force';
```
-------------------------4549 sample_num
```sql
SELECT disabled.name 
FROM disabled 
JOIN male ON disabled.name = male.name 
JOIN unemployed ON disabled.name = unemployed.name;
```
-------------------------4550 sample_num
```sql
SELECT COUNT(*) 
FROM enrolled e 
JOIN male m ON e.name = m.name 
WHERE e.school = 'occ';
```
-------------------------4551 sample_num
```sql
SELECT 
    (COUNT(male.name) * 100.0 / COUNT(person.name)) AS percentage
FROM 
    enrolled 
JOIN 
    person ON enrolled.name = person.name 
JOIN 
    male ON person.name = male.name 
JOIN 
    enlist ON person.name = enlist.name 
WHERE 
    enrolled.school = 'ucla' AND enlist.organ = 'air_force';
```
-------------------------4552 sample_num
```sql
SELECT AVG(disabled_count) AS average_disabled_female_students
FROM (
    SELECT COUNT(*) AS disabled_count
    FROM disabled
    WHERE name NOT IN (SELECT name FROM male)
    AND name IN (SELECT name FROM enrolled WHERE school = 'uci')
) AS subquery;
```
-------------------------4553 sample_num
```sql
SELECT COUNT(DISTINCT e.name) AS students_never_absent
FROM enrolled e
LEFT JOIN longest_absense_from_school l ON e.name = l.name
WHERE l.month IS NULL OR l.month = 0;
```
-------------------------4554 sample_num
```sql
SELECT name FROM enlist WHERE organ = 'marines';
```
-------------------------4555 sample_num
```sql
SELECT COUNT(*) FROM enlist WHERE organ = 'navy';
```
-------------------------4556 sample_num
```sql
SELECT name FROM longest_absense_from_school WHERE month = (SELECT MAX(month) FROM longest_absense_from_school);
```
-------------------------4557 sample_num
```sql
SELECT organ
FROM enlist
GROUP BY organ
ORDER BY COUNT(name) DESC
LIMIT 1;
```
-------------------------4558 sample_num
```sql
SELECT COUNT(*) 
FROM longest_absense_from_school 
WHERE month < 3;
```
-------------------------4559 sample_num
```sql
SELECT COUNT(DISTINCT u.name) AS unemployed_count
FROM no_payment_due npd
JOIN unemployed u ON npd.name = u.name
WHERE npd.bool = 'pos';
```
-------------------------4560 sample_num
```sql
SELECT COUNT(DISTINCT e.name) 
FROM enlist e 
WHERE e.organ = 'army' 
AND e.name NOT IN (SELECT m.name FROM male m);
```
-------------------------4561 sample_num
```sql
SELECT organ, COUNT(male.name) AS male_count
FROM enlist
JOIN male ON enlist.name = male.name
GROUP BY organ
ORDER BY male_count ASC
LIMIT 1;
```
-------------------------4562 sample_num
```sql
SELECT COUNT(DISTINCT d.name) 
FROM disabled d 
LEFT JOIN longest_absense_from_school l ON d.name = l.name 
WHERE l.month = 0 OR l.month IS NULL;
```
-------------------------4563 sample_num
```sql
SELECT COUNT(*) 
FROM unemployed 
WHERE name IN (SELECT name FROM disabled);
```
-------------------------4564 sample_num
```sql
SELECT d.name 
FROM disabled d 
JOIN longest_absense_from_school l ON d.name = l.name 
WHERE l.month > 5;
```
-------------------------4565 sample_num
```sql
SELECT COUNT(DISTINCT f.name) 
FROM filed_for_bankrupcy f 
JOIN enlist e ON f.name = e.name 
WHERE e.organ = 'marines';
```
-------------------------4566 sample_num
```sql
SELECT COUNT(DISTINCT d.name) AS disabled_students_count
FROM filed_for_bankrupcy f
JOIN disabled d ON f.name = d.name;
```
-------------------------4567 sample_num
```sql
SELECT MAX(month_count) 
FROM (
    SELECT COUNT(l.month) AS month_count
    FROM enlist e
    JOIN longest_absense_from_school l ON e.name = l.name
    WHERE e.organ = 'air_force'
    GROUP BY e.name
) AS subquery;
```
-------------------------4568 sample_num
```sql
SELECT COUNT(DISTINCT e.name) 
FROM filed_for_bankrupcy f 
JOIN longest_absense_from_school l ON f.name = l.name 
JOIN enlist e ON f.name = e.name 
WHERE l.month < 6 AND e.organ = 'fire_department';
```
-------------------------4569 sample_num
```sql
SELECT COUNT(DISTINCT d.name) 
FROM disabled d 
LEFT JOIN unemployed u ON d.name = u.name 
LEFT JOIN longest_absense_from_school a ON d.name = a.name 
WHERE u.name IS NULL AND (a.month IS NULL OR a.month = 0);
```
-------------------------4570 sample_num
```sql
SELECT e.organ, 
       COUNT(m.name) AS male_count, 
       (COUNT(m.name) * 1.0 / COUNT(p.name)) * 100 AS male_percentage
FROM enlist e
JOIN male m ON e.name = m.name
JOIN person p ON e.name = p.name
GROUP BY e.organ
ORDER BY male_count DESC
LIMIT 1;
```
-------------------------4571 sample_num
```sql
SELECT COUNT(DISTINCT UserID) 
FROM Answer 
WHERE QuestionID = 19 AND AnswerText = 'No';
```
-------------------------4572 sample_num
```sql
SELECT YEAR(SurveyID) AS Year, COUNT(DISTINCT UserID) AS UserCount
FROM Answer
WHERE QuestionID = 13 AND SurveyID BETWEEN 2016 AND 2019
GROUP BY YEAR(SurveyID);
```
-------------------------4573 sample_num
```sql
SELECT COUNT(DISTINCT UserID) 
FROM Answer 
WHERE AnswerText BETWEEN '27' AND '35' 
AND SurveyID IN (SELECT SurveyID FROM Survey WHERE YEAR(Description) = 2018);
```
-------------------------4574 sample_num
```sql
SELECT COUNT(DISTINCT a.UserID) 
FROM Answer a 
JOIN Survey s ON a.SurveyID = s.SurveyID 
WHERE s.SurveyID = 2019 
AND a.QuestionID = 3 AND a.AnswerText = 'United States' 
AND a.QuestionID = 6 AND a.AnswerText = 'Yes';
```
-------------------------4575 sample_num
```sql
SELECT YEAR(SurveyID) AS Year, COUNT(DISTINCT UserID) AS NumberOfPeople
FROM Answer
WHERE SurveyID BETWEEN 2016 AND 2019 AND AnswerText = 'Yes' AND QuestionID = 34
GROUP BY YEAR(SurveyID)
ORDER BY NumberOfPeople DESC
LIMIT 1;
```
-------------------------4576 sample_num
```sql
SELECT COUNT(DISTINCT a.UserID) 
FROM Answer a
JOIN Question q ON a.QuestionID = q.questionid
JOIN Survey s ON a.SurveyID = s.SurveyID
WHERE (q.questiontext = 'Gender' AND a.AnswerText = 'Female')
  AND (q.questiontext = 'State' AND a.AnswerText = 'Nebraska')
  AND s.Description LIKE '%2017%';
```
-------------------------4577 sample_num
```sql
SELECT COUNT(DISTINCT UserID) 
FROM Answer 
WHERE AnswerText = 'Yes' AND QuestionID = 54;
```
-------------------------4578 sample_num
```sql
SELECT 
    MAX(CASE WHEN AnswerText = (SELECT MAX(AnswerText) FROM Answer WHERE QuestionID = 1) THEN UserID END) AS OldestUserID,
    MAX(CASE WHEN AnswerText = (SELECT MIN(AnswerText) FROM Answer WHERE QuestionID = 1) THEN UserID END) AS YoungestUserID
FROM Answer
WHERE QuestionID = 1;
```
-------------------------4579 sample_num
```sql
SELECT Country
FROM Answer
JOIN Survey ON Answer.SurveyID = Survey.SurveyID
WHERE QuestionID = 3
GROUP BY Country
HAVING COUNT(UserID) = (
    SELECT MIN(UserCount)
    FROM (
        SELECT COUNT(UserID) AS UserCount
        FROM Answer
        JOIN Survey ON Answer.SurveyID = Survey.SurveyID
        WHERE QuestionID = 3
        GROUP BY Country
    ) AS CountryCounts
);
```
-------------------------4580 sample_num
```sql
SELECT AVG(CAST(a.AnswerText AS INT)) AS AverageAge
FROM Answer a
JOIN Question q1 ON a.QuestionID = q1.questionid
JOIN Answer a2 ON a.UserID = a2.UserID
JOIN Question q2 ON a2.QuestionID = q2.questionid
WHERE q1.questionid = 1 AND q2.questionid = 3 AND a2.AnswerText = 'United States';
```
-------------------------4581 sample_num
```sql
SELECT 
    (SUM(CASE WHEN a.AnswerText IN ('Yes', 'Maybe') THEN 1 ELSE 0 END) * 100.0) / COUNT(a.QuestionID) AS Percentage
FROM 
    Answer a
WHERE 
    a.QuestionID = 12;
```
-------------------------4582 sample_num
```sql
SELECT COUNT(DISTINCT QuestionID) 
FROM Answer 
WHERE SurveyID = 2014 
GROUP BY QuestionID 
HAVING COUNT(AnswerText) > 200;
```
-------------------------4583 sample_num
```sql
SELECT MAX(CAST(A.AnswerText AS INT)) AS OldestAge
FROM Answer A
JOIN Question Q ON A.QuestionID = Q.questionid
WHERE Q.questiontext = 'What is your age?' AND A.SurveyID = 2014;
```
-------------------------4584 sample_num
```sql
SELECT COUNT(DISTINCT a.UserID) 
FROM Answer a
JOIN Question q ON a.QuestionID = q.questionid
WHERE a.SurveyID = 2014 
  AND a.AnswerText = 'No' 
  AND q.questiontext = 'Would you bring up a mental health issue with a potential employer in an interview?';
```
-------------------------4585 sample_num
```sql
SELECT DISTINCT a.UserID
FROM Answer a
JOIN Survey s ON a.SurveyID = s.SurveyID
JOIN Question q ON a.QuestionID = q.questionid
WHERE a.AnswerText = 'Yes'
  AND q.questiontext = 'Do you think that discussing a physical health issue with your employer would have negative consequences?'
  AND s.SurveyID = 2014;
```
-------------------------4586 sample_num
```sql
SELECT COUNT(DISTINCT UserID) AS NumberOfUsers
FROM Answer
WHERE SurveyID = 2014;
```
-------------------------4587 sample_num
```sql
SELECT a.AnswerText
FROM Answer a
JOIN Question q ON a.QuestionID = q.questionid
JOIN Survey s ON a.SurveyID = s.SurveyID
WHERE q.questiontext = 'Any additional notes or comments'
AND a.AnswerText IS NOT NULL
AND s.Description LIKE '%2014%';
```
-------------------------4588 sample_num
```sql
SELECT q.questiontext
FROM Question q
JOIN Answer a1 ON q.questionid = a1.QuestionID
JOIN Survey s1 ON a1.SurveyID = s1.SurveyID
JOIN Answer a2 ON q.questionid = a2.QuestionID
JOIN Survey s2 ON a2.SurveyID = s2.SurveyID
WHERE s1.Description = '2014' AND s2.Description = '2016'
GROUP BY q.questiontext;
```
-------------------------4589 sample_num
```sql
SELECT COUNT(DISTINCT UserID) 
FROM Answer 
WHERE AnswerText = 'Canada' 
  AND QuestionID = 3 
  AND SurveyID = (SELECT SurveyID FROM Survey WHERE Description = '2018');
```
-------------------------4590 sample_num
```sql
SELECT q.questiontext 
FROM Question q
JOIN Answer a ON q.questionid = a.QuestionID
WHERE a.SurveyID = 2014;
```
-------------------------4591 sample_num
```sql
SELECT COUNT(DISTINCT UserID) 
FROM Answer 
WHERE QuestionID = 32 AND AnswerText = 'Yes' 
AND SurveyID = (SELECT SurveyID FROM Survey WHERE Description = '2016');
```
-------------------------4592 sample_num
```sql
SELECT COUNT(DISTINCT a.UserID) AS UserCount
FROM Answer a
JOIN Question q ON a.QuestionID = q.questionid
WHERE q.questiontext = 'Have you had a mental health disorder in the past?'
  AND a.AnswerText = 'Yes'
  AND a.SurveyID IN (2016, 2017, 2018);
```
-------------------------4593 sample_num
```sql
SELECT AVG(CAST(A.AnswerText AS INT)) AS AverageAge
FROM Answer A
JOIN Question Q ON A.QuestionID = Q.questionid
WHERE Q.questiontext = 'What is your age?' AND A.SurveyID = 2014;
```
-------------------------4594 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN SurveyID = 2019 AND QuestionID = 33 AND AnswerText = 'Yes' THEN 1 END) * 1.0 / COUNT(CASE WHEN SurveyID = 2019 AND QuestionID = 33 THEN 1 END)) - 
    (COUNT(CASE WHEN SurveyID = 2016 AND QuestionID = 33 AND AnswerText = 'Yes' THEN 1 END) * 1.0 / COUNT(CASE WHEN SurveyID = 2016 AND QuestionID = 33 THEN 1 END)) AS rate_of_increase
FROM Answer;
```
-------------------------4595 sample_num
```sql
SELECT questionid FROM Question WHERE questiontext = 'Would you bring up a physical health issue with a potential employer in an interview?';
```
-------------------------4596 sample_num
```sql
SELECT COUNT(DISTINCT UserID) AS NumberOfUsers
FROM Answer
WHERE QuestionID = 20;
```
-------------------------4597 sample_num
```sql
SELECT COUNT(*) 
FROM Answer 
WHERE UserID = 5;
```
-------------------------4598 sample_num
```sql
SELECT COUNT(DISTINCT UserID) AS NumberOfUsers
FROM Answer
WHERE SurveyID = 2016;
```
-------------------------4599 sample_num
```sql
SELECT COUNT(*) 
FROM Question 
WHERE questionid IN (SELECT QuestionID FROM Answer WHERE SurveyID = 2018);
```
-------------------------4600 sample_num
```sql
SELECT COUNT(DISTINCT SurveyID) 
FROM Answer 
WHERE QuestionID = (SELECT questionid FROM Question WHERE questiontext = 'What country do you work in?');
```
-------------------------4601 sample_num
```sql
SELECT a.AnswerText 
FROM Answer a 
JOIN Question q ON a.QuestionID = q.questionid 
WHERE a.UserID = 2681 AND q.questiontext = 'Do you currently have a mental health disorder?';
```
-------------------------4602 sample_num
```sql
SELECT COUNT(DISTINCT UserID) AS NumberOfUsers
FROM Answer
WHERE SurveyID = 2016;
```
-------------------------4603 sample_num
```sql
SELECT AnswerText
FROM Answer
WHERE QuestionID = (SELECT questionid FROM Question WHERE questiontext = 'What country do you work in?')
GROUP BY AnswerText
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------4604 sample_num
```sql
SELECT COUNT(DISTINCT AnswerText) AS DifferentAnswers
FROM Answer
WHERE QuestionID = (SELECT questionid FROM Question WHERE questiontext = 'Describe the conversation you had with your previous employer about your mental health, including their reactions and actions taken to address your mental health issue/questions.');
```
-------------------------4605 sample_num
```sql
SELECT COUNT(DISTINCT UserID) 
FROM Answer 
WHERE QuestionID = (SELECT questionid FROM Question WHERE questiontext = 'What US state or territory do you work in?') 
AND AnswerText = 'Kansas';
```
-------------------------4606 sample_num
```sql
SELECT COUNT(DISTINCT UserID) 
FROM Answer 
WHERE QuestionID = 103 AND AnswerText != '-1';
```
-------------------------4607 sample_num
```sql
SELECT COUNT(DISTINCT a.UserID) AS YesCount
FROM Answer a
JOIN Question q ON a.QuestionID = q.questionid
WHERE q.questiontext = 'Have you ever been diagnosed with a mental health disorder?'
AND a.AnswerText = 'Yes';
```
-------------------------4608 sample_num
```sql
SELECT COUNT(DISTINCT UserID) AS NumberOfUsers
FROM Answer
WHERE SurveyID = 2018;
```
-------------------------4609 sample_num
```sql
SELECT COUNT(DISTINCT UserID) AS UserCount
FROM Answer
WHERE QuestionID = (SELECT questionid FROM Question WHERE questiontext = 'Overall, how much importance does your employer place on physical health?');
```
-------------------------4610 sample_num
```sql
SELECT q.questiontext 
FROM Question q 
JOIN Answer a ON q.questionid = a.QuestionID 
WHERE a.UserID = 2183 AND a.AnswerText = 'Mood Disorder (Depression, Bipolar Disorder, etc)';
```
-------------------------4611 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN AnswerText = 'Yes' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Answer
WHERE 
    QuestionID = (SELECT questionid FROM Question WHERE questiontext = 'Has your employer ever formally discussed mental health (for example, as part of a wellness campaign or other official communication)?');
```
-------------------------4612 sample_num
```sql
SELECT 
    (SELECT COUNT(DISTINCT UserID) FROM Answer WHERE SurveyID = 2017) - 
    (SELECT COUNT(DISTINCT UserID) FROM Answer WHERE SurveyID = 2018) AS Difference
```
-------------------------4613 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN AnswerText = 'Yes' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Answer
WHERE 
    SurveyID = 2016 AND 
    QuestionID = 32;
```
-------------------------4614 sample_num
```sql
SELECT COUNT(DISTINCT UserID) 
FROM Answer 
WHERE SurveyID = 2016 AND QuestionID = 1 AND CAST(AnswerText AS INT) < 25;
```
-------------------------4615 sample_num
```sql
SELECT AVG(respondent_count) AS average_respondents
FROM (
    SELECT SurveyID, COUNT(DISTINCT UserID) AS respondent_count
    FROM Answer
    WHERE SurveyID IN (SELECT SurveyID FROM Survey WHERE SurveyID BETWEEN 2014 AND 2019)
    GROUP BY SurveyID
) AS survey_counts;
```
-------------------------4616 sample_num
```sql
SELECT COUNT(DISTINCT UserID) 
FROM Answer 
WHERE SurveyID = 2019 AND QuestionID = 7 AND AnswerText = '1';
```
-------------------------4617 sample_num
```sql
SELECT COUNT(DISTINCT UserID) 
FROM Answer 
WHERE SurveyID = 2014 AND QuestionID = 93 AND AnswerText = 'Yes';
```
-------------------------4618 sample_num
```sql
SELECT COUNT(*) AS NumberOfQuestions FROM Question;
```
-------------------------4619 sample_num
```sql
SELECT COUNT(DISTINCT UserID) AS RespondentCount
FROM Answer
WHERE AnswerText = 'Substance Use Disorder';
```
-------------------------4620 sample_num
```sql
SELECT AnswerText, COUNT(*) AS response_count
FROM Answer
WHERE SurveyID = 2017 AND QuestionID = 85
GROUP BY AnswerText
ORDER BY response_count DESC
LIMIT 3;
```
-------------------------4621 sample_num
```sql
SELECT 
    (SUM(CASE WHEN Year = 1998 THEN Studio_Entertainment_NI_1 ELSE 0 END) - 
     SUM(CASE WHEN Year = 1997 THEN Studio_Entertainment_NI_1 ELSE 0 END)) AS revenue_difference
FROM revenue;
```
-------------------------4622 sample_num
```sql
SELECT 
    CASE 
        WHEN "Studio Entertainment[NI 1]" > "Disney Media Networks" THEN 'Studio Entertainment' 
        ELSE 'Disney Media Networks' 
    END AS Higher_Revenue_Segment
FROM revenue
WHERE Year = 1998;
```
-------------------------4623 sample_num
```sql
SELECT director FROM director WHERE name = 'Pinocchio';
```
-------------------------4624 sample_num
```sql
SELECT DISTINCT c.villian
FROM characters c
JOIN director d ON c.movie_title = d.movie
WHERE d.director = 'Wolfgang Reitherman';
```
-------------------------4625 sample_num
```sql
SELECT COUNT(*) 
FROM movies_total_gross 
WHERE movie_title IN (
    SELECT movie_title 
    FROM director 
    WHERE director = 'Wolfgang Reitherman'
) 
AND SUBSTR(release_date, INSTR(release_date, '-') + 1, 3) = 'Dec';
```
-------------------------4626 sample_num
```sql
SELECT d.name 
FROM characters c 
JOIN director d ON c.movie_title = d.director 
WHERE c.song = 'Once Upon a Dream';
```
-------------------------4627 sample_num
```sql
SELECT va.voice_actor 
FROM characters AS c 
JOIN voice_actors AS va ON c.villian LIKE '%' || va.character || '%' 
WHERE c.movie_title = 'Alice in Wonderland';
```
-------------------------4628 sample_num
```sql
SELECT m.release_date
FROM voice-actors v
JOIN characters m ON v.movie = m.movie_title
WHERE v.voice-actor = 'Alan Tudyk';
```
-------------------------4629 sample_num
```sql
SELECT COUNT(*) 
FROM voice-actors va 
JOIN characters c ON va.movie = c.movie_title 
WHERE va.voice-actor = 'Alan Tudyk' 
AND (SUBSTR(c.release_date, INSTR(c.release_date, '-') + 1) > '2012');
```
-------------------------4630 sample_num
```sql
SELECT COUNT(m.movie_title) 
FROM movies_total_gross m 
JOIN director d ON m.movie_title = d.movie 
WHERE d.director = 'Wolfgang Reitherman' AND m.genre = 'Comedy';
```
-------------------------4631 sample_num
```sql
SELECT mt.movie_title, mt.total_gross
FROM movies_total_gross mt
JOIN director d ON mt.movie_title = d.movie
WHERE d.director = 'Wolfgang Reitherman'
ORDER BY mt.total_gross DESC
LIMIT 1;
```
-------------------------4632 sample_num
```sql
SELECT mt.movie_title 
FROM director d 
JOIN movies_total_gross mt ON d.movie_title = mt.movie_title 
WHERE d.director = 'Wolfgang Reitherman' AND mt.MPAA_rating = 'G';
```
-------------------------4633 sample_num
```sql
SELECT c.villian
FROM characters c
JOIN movies_total_gross m ON c.movie_title = m.movie_title
WHERE m.total_gross = (SELECT MAX(total_gross) FROM movies_total_gross);
```
-------------------------4634 sample_num
```sql
SELECT mt.genre 
FROM characters c 
JOIN movies_total_gross mt ON c.movie_title = mt.movie_title 
WHERE c.villian = 'Commander Rourke';
```
-------------------------4635 sample_num
```sql
SELECT villian FROM characters WHERE movie_title = 'Beauty and the Beast';
```
-------------------------4636 sample_num
```sql
SELECT movie_title 
FROM characters 
WHERE hero = 'Robin Hood';
```
-------------------------4637 sample_num
```sql
SELECT movie_title 
FROM characters 
WHERE song = 'I Thought I Lost You';
```
-------------------------4638 sample_num
```sql
SELECT voice-actor FROM voice-actors WHERE character = 'Binkie Muddlefoot';
```
-------------------------4639 sample_num
```sql
SELECT hero 
FROM characters 
WHERE movie_title = (SELECT movie_title 
                     FROM movies_total_gross 
                     WHERE total_gross = 222527828);
```
-------------------------4640 sample_num
```sql
SELECT c.song
FROM characters c
JOIN movies_total_gross m ON c.movie_title = m.movie_title
WHERE CAST(SUBSTR(m.release_date, INSTR(m.release_date, ', ') + 1) AS INT) BETWEEN 1970 AND 1979
AND m.total_gross = (SELECT MAX(total_gross)
                     FROM movies_total_gross
                     WHERE CAST(SUBSTR(release_date, INSTR(release_date, ', ') + 1) AS INT) BETWEEN 1970 AND 1979);
```
-------------------------4641 sample_num
```sql
SELECT c.hero 
FROM characters c 
JOIN movies_total_gross m ON c.movie_title = m.movie_title 
JOIN director d ON m.movie_title = d.director 
WHERE d.name = 'Will Finn';
```
-------------------------4642 sample_num
```sql
SELECT va.voice-actor 
FROM voice-actors va 
JOIN characters c ON va.character = c.hero 
WHERE c.movie_title = 'The Little Mermaid';
```
-------------------------4643 sample_num
```sql
SELECT d.name 
FROM director d 
JOIN voice-actors va ON d.director = va.movie 
WHERE va.character = 'Aunt Sarah' AND va.voice-actor = 'Verna Felton';
```
-------------------------4644 sample_num
```sql
SELECT m.release_date 
FROM voice-actors v 
JOIN characters c ON v.movie = c.movie_title 
JOIN movies_total_gross m ON c.movie_title = m.movie_title 
WHERE v.voice-actor = 'Tress MacNeille' AND v.character = 'Hyacinth Hippo';
```
-------------------------4645 sample_num
```sql
SELECT d.name 
FROM director d 
JOIN movies_total_gross m ON d.director = m.movie_title 
WHERE m.release_date = 'Mar 30, 2007' AND m.genre = 'Adventure';
```
-------------------------4646 sample_num
```sql
SELECT mt.movie_title, mt.inflation_adjusted_gross
FROM director d
JOIN movies_total_gross mt ON d.director = mt.director
WHERE d.name = 'Wolfgang Reitherman'
ORDER BY mt.inflation_adjusted_gross DESC
LIMIT 1;
```
-------------------------4647 sample_num
```sql
SELECT c.hero 
FROM characters c 
JOIN movies_total_gross m ON c.movie_title = m.movie_title 
WHERE m.release_date = '4-Mar-16' AND m.genre = 'Adventure';
```
-------------------------4648 sample_num
```sql
SELECT movie_title, total_gross
FROM movies_total_gross
WHERE movie_title IN (
    SELECT movie_title
    FROM characters
    WHERE hero = 'Donald Duck'
)
ORDER BY total_gross DESC
LIMIT 1;
```
-------------------------4649 sample_num
```sql
SELECT COUNT(*) 
FROM director 
WHERE director = 'Wolfgang Reitherman';
```
-------------------------4650 sample_num
```sql
SELECT director, COUNT(name) AS num_movies
FROM director
GROUP BY director
ORDER BY num_movies DESC
LIMIT 1;
```
-------------------------4651 sample_num
```sql
SELECT COUNT(*) 
FROM movies_total_gross 
WHERE MPAA_rating = 'R' 
AND genre = 'Horror' 
AND CAST(SUBSTR(release_date, INSTR(release_date, ', ') + 1) AS INT) BETWEEN 1990 AND 2015;
```
-------------------------4652 sample_num
```sql
SELECT character 
FROM voice-actors 
WHERE voice-actor = 'Frank Welker';
```
-------------------------4653 sample_num
```sql
SELECT total_gross 
FROM movies_total_gross 
WHERE movie_title IN (
    SELECT movie_title 
    FROM characters 
    WHERE song = 'Little Wonders'
);
```
-------------------------4654 sample_num
```sql
SELECT mtg.MPAA_rating
FROM characters c
JOIN movies_total_gross mtg ON c.movie_title = mtg.movie_title
WHERE c.villian = 'Turbo';
```
-------------------------4655 sample_num
```sql
SELECT COUNT(DISTINCT m.movie_title) 
FROM voice_actors v 
JOIN movies_total_gross m ON v.movie = m.movie_title 
WHERE v.voice_actor = 'Bill Thompson' AND m.MPAA_rating IN ('PG', 'M');
```
-------------------------4656 sample_num
```sql
SELECT COUNT(m.movie_title) 
FROM director d 
JOIN movies_total_gross m ON d.director = m.director 
WHERE d.name = 'Gary Trousdale' AND m.genre = 'Adventure';
```
-------------------------4657 sample_num
```sql
SELECT d.name, COUNT(*) AS count
FROM voice_actors va
JOIN director d ON va.movie = d.director
WHERE va.voice_actor = 'Bill Thompson'
GROUP BY d.name
ORDER BY count DESC
LIMIT 1;
```
-------------------------4658 sample_num
```sql
SELECT mtg.movie_title
FROM movies_total_gross mtg
JOIN director d ON mtg.movie_title = d.movie_title
WHERE d.director = 'Ron Clements'
ORDER BY mtg.total_gross DESC
LIMIT 1;
```
-------------------------4659 sample_num
```sql
SELECT va.voice-actor 
FROM voice-actors va 
JOIN movies_total_gross mtg ON va.movie = mtg.movie_title 
JOIN director d ON mtg.movie_title = d.director 
WHERE d.name = 'Ben Sharpsteen' AND mtg.release_date = 'Feb 9, 1940';
```
-------------------------4660 sample_num
```sql
SELECT COUNT(*) 
FROM movies_total_gross 
WHERE director = 'Ron Clements' 
  AND MPAA_rating = 'PG' 
  AND genre = 'Adventure';
```
-------------------------4661 sample_num
```sql
SELECT COUNT(*) FROM movies_total_gross WHERE genre = 'Horror';
```
-------------------------4662 sample_num
```sql
SELECT villian FROM characters WHERE movie_title = 'The Great Mouse Detective';
```
-------------------------4663 sample_num
```sql
SELECT voice-actor FROM voice-actors WHERE movie = 'Meet the Robinsons';
```
-------------------------4664 sample_num
```sql
SELECT director, COUNT(*) AS movie_count
FROM director
GROUP BY director
ORDER BY movie_count DESC
LIMIT 1;
```
-------------------------4665 sample_num
```sql
SELECT Year, "Studio Entertainment[NI 1]"
FROM revenue
WHERE Year BETWEEN 2000 AND 2010
ORDER BY "Studio Entertainment[NI 1]" DESC
LIMIT 1;
```
-------------------------4666 sample_num
```sql
SELECT c.song
FROM characters c
JOIN movies_total_gross m ON c.movie_title = m.movie_title
WHERE m.genre = 'Drama';
```
-------------------------4667 sample_num
```sql
SELECT va.voice_actor 
FROM voice_actors va 
JOIN characters c ON va.character = c.hero;
```
-------------------------4668 sample_num
```sql
SELECT DISTINCT name 
FROM director 
WHERE release_date BETWEEN '1990-01-01' AND '1999-12-31';
```
-------------------------4669 sample_num
```sql
SELECT voice_actor 
FROM voice_actors 
WHERE character IN (SELECT villian FROM characters WHERE movie_title = 'The Rescuers');
```
-------------------------4670 sample_num
```sql
SELECT m.movie_title, va.voice_actor
FROM director d
JOIN movies_total_gross m ON d.director = m.director
JOIN voice_actors va ON m.movie_title = va.movie
WHERE d.name = 'Wolfgang Reitherman';
```
-------------------------4671 sample_num
```sql
SELECT c.hero, c.villian 
FROM characters c 
JOIN movies_total_gross m ON c.movie_title = m.movie_title 
WHERE m.MPAA_rating = 'PG';
```
-------------------------4672 sample_num
```sql
SELECT movie_title 
FROM movies_total_gross 
WHERE total_gross = (SELECT MAX(total_gross) FROM movies_total_gross 
                     JOIN characters ON movies_total_gross.movie_title = characters.movie_title 
                     WHERE characters.song IS NULL);
```
-------------------------4673 sample_num
```sql
SELECT d.name
FROM director d
JOIN voice_actors va ON d.director = va.movie
GROUP BY d.name
ORDER BY COUNT(va.voice_actor) DESC
LIMIT 1;
```
-------------------------4674 sample_num
```sql
SELECT voice-actor 
FROM voice-actors 
WHERE movie IN (SELECT movie_title FROM characters WHERE release_date = '2010-11-24');
```
-------------------------4675 sample_num
```sql
SELECT DISTINCT d.name
FROM director d
JOIN characters c ON d.director = c.movie_title
WHERE c.song IS NOT NULL;
```
-------------------------4676 sample_num
```sql
SELECT mtg.total_gross
FROM movies_total_gross mtg
JOIN voice_actors va ON mtg.movie_title = va.movie
WHERE va.voice_actor = 'Jim Cummings';
```
-------------------------4677 sample_num
```sql
SELECT m.movie_title, MAX(mt.total_gross) AS highest_total_gross
FROM director d
JOIN movies_total_gross mt ON d.director = mt.movie_title
WHERE d.name = 'Ron Clements'
GROUP BY m.movie_title
ORDER BY highest_total_gross DESC
LIMIT 1;
```
-------------------------4678 sample_num
```sql
SELECT AVG(mt.total_gross) AS average_total_gross
FROM movies_total_gross mt
JOIN voice_actors va ON mt.movie_title = va.movie
WHERE va.voice_actor = 'Sterling Holloway';
```
-------------------------4679 sample_num
```sql
SELECT 
    DIVIDE(SUM(mtg.total_gross) WHERE c.song IS NOT NULL, SUM(mtg.total_gross)) AS percentage
FROM 
    movies_total_gross mtg
JOIN 
    characters c ON mtg.movie_title = c.movie_title;
```
-------------------------4680 sample_num
```sql
SELECT movie_title, genre 
FROM movies_total_gross 
WHERE substr(release_date, length(release_date) - 3, length(release_date)) = '2016';
```
-------------------------4681 sample_num
```sql
SELECT villian FROM characters WHERE movie_title = 'Little Mermaid';
```
-------------------------4682 sample_num
```sql
SELECT movie_title 
FROM director 
WHERE director = 'Jack Kinney';
```
-------------------------4683 sample_num
```sql
SELECT mt.movie_title, 
       (mt.inflation_adjusted_gross / mt.total_gross) * 100 AS estimated_inflation_rate
FROM movies_total_gross mt
WHERE mt.total_gross = (SELECT MAX(total_gross) FROM movies_total_gross);
```
-------------------------4684 sample_num
```sql
SELECT movie_title, release_date 
FROM movies_total_gross 
WHERE MPAA_rating = 'PG-13' AND genre = 'Romantic Comedy';
```
-------------------------4685 sample_num
```sql
SELECT m.movie_title, v.character
FROM voice-actors v
JOIN characters m ON v.movie = m.movie_title
WHERE v.voice-actor = 'Bill Thompson';
```
-------------------------4686 sample_num
```sql
SELECT c.movie_title, c.song
FROM characters c
JOIN director d ON c.movie_title = d.movie_title
WHERE d.director = 'Ron Clements';
```
-------------------------4687 sample_num
```sql
SELECT c.movie_title, c.hero, c.song
FROM characters c
JOIN director d ON c.movie_title = d.movie_title
WHERE d.director = 'Wolfgang Reitherman' AND SUBSTR(c.release_date, LENGTH(c.release_date) - 3, LENGTH(c.release_date)) = '1977';
```
-------------------------4688 sample_num
```sql
SELECT m.movie_title, d.name AS director
FROM characters c
JOIN movies_total_gross m ON c.movie_title = m.movie_title
JOIN director d ON m.movie_title = d.director
WHERE c.hero = 'Donald Duck';
```
-------------------------4689 sample_num
```sql
SELECT c.hero, d.name AS director, c.release_date
FROM characters c
JOIN director d ON c.movie_title = 'Mulan' AND d.director = 'Mulan';
```
-------------------------4690 sample_num
```sql
SELECT mtg.movie_title, mtg.total_gross, mtg.MPAA_rating
FROM characters c
JOIN movies_total_gross mtg ON c.movie_title = mtg.movie_title
WHERE c.hero = 'Elsa';
```
-------------------------4691 sample_num
```sql
SELECT m.movie_title, d.director, m.release_date
FROM voice_actors v
JOIN movies_total_gross m ON v.movie = m.movie_title
JOIN director d ON m.movie_title = d.name
WHERE v.voice_actor = 'Freddie Jones';
```
-------------------------4692 sample_num
```sql
SELECT m.movie_title, m.total_gross
FROM voice-actors v
JOIN movies_total_gross m ON v.movie = m.movie_title
WHERE v.voice-actor = 'Frank Welker' 
AND (m.inflation_adjusted_gross / m.total_gross) < 2;
```
-------------------------4693 sample_num
```sql
SELECT d.name
FROM director d
JOIN movies_total_gross m ON d.director = m.movie_title
WHERE m.total_gross = (SELECT MAX(total_gross) FROM movies_total_gross);
```
-------------------------4694 sample_num
```sql
SELECT va.voice_actor, c.villian 
FROM voice_actors va 
JOIN characters c ON va.movie = c.movie_title 
WHERE c.movie_title = 'Cinderella';
```
-------------------------4695 sample_num
```sql
SELECT va.voice-actor 
FROM voice-actors va 
JOIN characters c ON va.character = c.hero 
WHERE c.movie_title = 'Lion King';
```
-------------------------4696 sample_num
```sql
SELECT d.name, mt.MPAA_rating
FROM director d
JOIN movies_total_gross mt ON d.director = mt.movie_title
WHERE mt.genre = 'Musical' AND substr(mt.release_date, length(mt.release_date) - 3, length(mt.release_date)) = '1993';
```
-------------------------4697 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN mt.genre = 'Comedy' THEN 1 END) * 100.0 / COUNT(mt.movie_title)) AS percentage,
    mt.movie_title,
    d.name AS director
FROM 
    movies_total_gross mt
JOIN 
    director d ON mt.movie_title = d.director
WHERE 
    SUBSTR(mt.release_date, LENGTH(mt.release_date) - 3, 4) BETWEEN '1991' AND '2000'
GROUP BY 
    mt.movie_title, d.name
LIMIT 5;
```
-------------------------4698 sample_num
```sql
SELECT mtg.movie_title, d.name AS director
FROM movies_total_gross mtg
JOIN director d ON mtg.movie_title = d.director
WHERE substr(mtg.release_date, length(mtg.release_date) - 3, length(mtg.release_date)) BETWEEN '2001' AND '2005'
AND mtg.total_gross > (SELECT AVG(total_gross) * 1.0 * 2 FROM movies_total_gross WHERE substr(release_date, length(release_date) - 3, length(release_date)) BETWEEN '2001' AND '2005');
```
-------------------------4699 sample_num
```sql
SELECT voice-actor FROM voice-actors WHERE character = 'Calliope' AND movie = 'Hercules';
```
-------------------------4700 sample_num
```sql
SELECT COUNT(*) 
FROM voice_actors 
WHERE movie = 'Aladdin';
```
-------------------------4701 sample_num
```sql
SELECT movie 
FROM voice-actors 
WHERE voice-actor = 'Jeff Bennett';
```
-------------------------4702 sample_num
```sql
SELECT name FROM director WHERE director = 'Wreck-It Ralph';
```
-------------------------4703 sample_num
```sql
SELECT movie_title 
FROM director 
WHERE director = 'Jack Kinney';
```
-------------------------4704 sample_num
```sql
SELECT COUNT(*) 
FROM movies_total_gross 
WHERE SUBSTR(release_date, LENGTH(release_date) - 1, LENGTH(release_date)) BETWEEN '37' AND '50';
```
-------------------------4705 sample_num
```sql
SELECT c.song 
FROM characters c 
JOIN director d ON c.movie_title = d.movie 
WHERE d.director = 'Ben Sharpsteen';
```
-------------------------4706 sample_num
```sql
SELECT c.release_date 
FROM characters c 
JOIN director d ON c.movie_title = d.director 
WHERE c.movie_title = 'The Lion King' AND d.director = 'Roger Allers';
```
-------------------------4707 sample_num
```sql
SELECT c.villian 
FROM characters c 
JOIN voice_actors va ON c.movie_title = va.movie 
WHERE va.voice_actor IN ('Scott Weinger', 'Brad Kane') 
GROUP BY c.villian 
HAVING COUNT(DISTINCT va.voice_actor) = 2;
```
-------------------------4708 sample_num
```sql
SELECT m.movie_title 
FROM movies_total_gross m
JOIN director d ON m.movie_title = d.director
JOIN characters c ON m.movie_title = c.movie_title
WHERE d.name = 'Wolfgang Reitherman' AND c.villian IS NULL;
```
-------------------------4709 sample_num
```sql
SELECT m.movie_title 
FROM director d 
JOIN movies_total_gross m ON d.director = m.director 
WHERE d.name = 'Jack Kinney' AND substr(m.release_date, length(m.release_date) - 1, length(m.release_date)) < '47';
```
-------------------------4710 sample_num
```sql
SELECT DISTINCT d.name
FROM director d
JOIN movies_total_gross m ON d.director = m.movie_title
WHERE m.total_gross > 100000000;
```
-------------------------4711 sample_num
```sql
SELECT c.movie_title, c.song, mtg.total_gross
FROM characters c
JOIN movies_total_gross mtg ON c.movie_title = mtg.movie_title
WHERE mtg.total_gross = (SELECT MAX(total_gross) FROM movies_total_gross);
```
-------------------------4712 sample_num
```sql
SELECT d.name
FROM director d
JOIN movies_total_gross m ON d.director = m.movie_title
WHERE SUBSTR(m.release_date, LENGTH(m.release_date) - 3, 4) BETWEEN '1937' AND '1990'
ORDER BY m.total_gross DESC
LIMIT 1;
```
-------------------------4713 sample_num
```sql
SELECT c.hero 
FROM characters c 
JOIN movies_total_gross m ON c.movie_title = m.movie_title 
WHERE m.genre = 'Comedy';
```
-------------------------4714 sample_num
```sql
SELECT va.voice-actor 
FROM voice-actors va 
JOIN characters c ON va.character = c.hero OR va.character = c.villian 
JOIN director d ON c.movie_title = d.movie 
WHERE d.director = 'Wolfgang Reitherman';
```
-------------------------4715 sample_num
```sql
SELECT mt.genre 
FROM characters c 
JOIN movies_total_gross mt ON c.movie_title = mt.movie_title 
WHERE c.hero = 'Taran';
```
-------------------------4716 sample_num
```sql
SELECT va.voice-actor, d.director
FROM characters c
JOIN voice-actors va ON c.hero = 'Elsa' AND c.movie_title = va.movie
JOIN director d ON c.movie_title = d.name
WHERE c.hero = 'Elsa';
```
-------------------------4717 sample_num
```sql
SELECT 
    (COUNT(DISTINCT CASE WHEN mtg.total_gross > 100000000 THEN d.director END) * 100.0 / COUNT(DISTINCT d.director)) AS percentage
FROM 
    director d
JOIN 
    movies_total_gross mtg ON d.name = mtg.movie_title;
```
-------------------------4718 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN m.genre = 'Drama' THEN va.voice_actor END) * 100.0 / COUNT(va.voice_actor)) AS percentage
FROM 
    voice_actors va
JOIN 
    characters c ON va.character = c.hero OR va.character = c.villian
JOIN 
    movies_total_gross m ON c.movie_title = m.movie_title;
```
-------------------------4719 sample_num
```sql
SELECT movie_title 
FROM movies_total_gross 
ORDER BY release_date ASC 
LIMIT 1;
```
-------------------------4720 sample_num
```sql
SELECT COUNT(movie_title) 
FROM movies_total_gross 
WHERE substr(release_date, length(release_date) - 1, length(release_date)) BETWEEN '10' AND '16';
```
-------------------------4721 sample_num
```sql
SELECT villian 
FROM characters 
ORDER BY release_date ASC 
LIMIT 1;
```
-------------------------4722 sample_num
```sql
SELECT movie_title 
FROM movies_total_gross 
WHERE genre = 'Action' 
ORDER BY total_gross DESC 
LIMIT 1;
```
-------------------------4723 sample_num
```sql
SELECT voice-actor 
FROM voice-actors 
WHERE character = 'Akela' AND movie = 'The Jungle Book';
```
-------------------------4724 sample_num
```sql
SELECT SUM(total_gross) AS total_box_office_gross
FROM movies_total_gross
WHERE release_date BETWEEN '2010-01-01' AND '2016-12-31';
```
-------------------------4725 sample_num
```sql
SELECT hero 
FROM characters 
WHERE movie_title = (
    SELECT movie_title 
    FROM movies_total_gross 
    WHERE genre = 'Adventure' 
    ORDER BY inflation_adjusted_gross DESC 
    LIMIT 1
);
```
-------------------------4726 sample_num
```sql
SELECT d.name 
FROM director d 
JOIN movies_total_gross m ON d.director = m.movie_title 
WHERE m.total_gross = (SELECT MIN(total_gross) FROM movies_total_gross);
```
-------------------------4727 sample_num
```sql
SELECT 
    (SUM(CASE WHEN Year = 2010 THEN [Walt Disney Parks and Resorts] END) * 100.0) / 
    SUM(CASE WHEN Year = 2010 THEN Total END) AS percentage
FROM 
    revenue;
```
-------------------------4728 sample_num
```sql
SELECT AVG(total_gross) AS average_gross
FROM movies_total_gross
WHERE genre = 'Action' AND MPAA_rating = 'PG-13';
```
-------------------------4729 sample_num
```sql
SELECT COUNT(*) 
FROM voice-actors 
WHERE movie = 'Bambi';
```
-------------------------4730 sample_num
```sql
SELECT DIVIDE(inflation_adjusted_gross, total_gross) AS percentage
FROM movies_total_gross
WHERE SUBSTR(release_date, LENGTH(release_date) - 3, LENGTH(release_date)) = '1995';
```
-------------------------4731 sample_num
```sql
SELECT 
    (SELECT inflation_adjusted_gross FROM movies_total_gross WHERE movie_title = 'Cars') - 
    (SELECT inflation_adjusted_gross FROM movies_total_gross WHERE movie_title = 'Cars 2') AS gross_difference,
    (SELECT movie_title FROM movies_total_gross ORDER BY inflation_adjusted_gross DESC LIMIT 1) AS more_popular_movie;
```
-------------------------4732 sample_num
```sql
SELECT 
    (SELECT movie_title 
     FROM movies_total_gross 
     WHERE movie_title IN (SELECT movie_title FROM director WHERE director = 'Chris Buck') 
     ORDER BY release_date DESC 
     LIMIT 1) AS most_recent_movie,
    (SELECT MAX(inflation_adjusted_gross) 
     FROM movies_total_gross 
     WHERE movie_title IN (SELECT movie_title FROM director WHERE director = 'Chris Buck')) AS most_successful_movie_gross
```
-------------------------4733 sample_num
```sql
SELECT voice_actor
FROM voice_actors
GROUP BY voice_actor
HAVING COUNT(character) > 5;
```
-------------------------4734 sample_num
```sql
SELECT movie_title, inflation_adjusted_gross,
       (inflation_adjusted_gross / (SELECT SUM(inflation_adjusted_gross) FROM movies_total_gross) * 100) AS percentage
FROM movies_total_gross
ORDER BY inflation_adjusted_gross DESC
LIMIT 5;
```
-------------------------4735 sample_num
```sql
SELECT 
    DIVIDE(COUNT(CASE WHEN mtg.total_gross > 100000000 THEN mtg.movie_title END), COUNT(mtg.movie_title)) AS percentage
FROM 
    movies_total_gross mtg
JOIN 
    director d ON mtg.movie_title = d.director
WHERE 
    d.name = 'Gary Trousdale';
```
-------------------------4736 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE ballotpedia_id IS NULL OR ballotpedia_id = '';
```
-------------------------4737 sample_num
```sql
SELECT official_full_name 
FROM current 
WHERE cspan_id IS NULL OR cspan_id = '';
```
-------------------------4738 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE birthday_bio > '1960-01-01';
```
-------------------------4739 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE gender_bio = 'F' AND fec_id IS NULL;
```
-------------------------4740 sample_num
```sql
SELECT google_entity_id_id 
FROM current 
WHERE official_full_name = 'Sherrod Brown';
```
-------------------------4741 sample_num
```sql
SELECT official_full_name, MAX(birthday_bio) AS max_birthday
FROM current
WHERE official_full_name IN ('Sherrod Brown', 'Maria Cantwell')
GROUP BY official_full_name
ORDER BY max_birthday ASC
LIMIT 1;
```
-------------------------4742 sample_num
```sql
SELECT sm.facebook 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE c.official_full_name = 'Todd Young';
```
-------------------------4743 sample_num
```sql
SELECT COUNT(*) 
FROM current c
LEFT JOIN social_media sm ON c.bioguide_id = sm.bioguide
WHERE sm.instagram IS NULL;
```
-------------------------4744 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE sm.twitter_id = '234128524';
```
-------------------------4745 sample_num
```sql
SELECT sm.youtube 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE c.gender_bio = 'F';
```
-------------------------4746 sample_num
```sql
SELECT sm.facebook
FROM current c
JOIN social-media sm ON c.bioguide_id = sm.bioguide
WHERE c.birthday_bio = (SELECT MAX(birthday_bio) FROM current);
```
-------------------------4747 sample_num
```sql
SELECT COUNT(*)
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE (c.opensecrets_id IS NULL OR c.opensecrets_id = '')
AND ct.instagram IS NULL;
```
-------------------------4748 sample_num
```sql
SELECT COUNT(*) AS non_representative_terms
FROM current_terms
WHERE name = 'Roger F. Wicker' AND (district IS NULL OR district = '');
```
-------------------------4749 sample_num
```sql
SELECT COUNT(*) 
FROM current-terms 
WHERE name = 'Sherrod Brown';
```
-------------------------4750 sample_num
```sql
SELECT c.official_full_name
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE ct.state_rank IS NOT NULL;
```
-------------------------4751 sample_num
```sql
SELECT state 
FROM current_terms 
WHERE name = 'Sherrod Brown' AND start = '1993-01-05';
```
-------------------------4752 sample_num
```sql
SELECT COUNT(DISTINCT ct.bioguide) AS female_legislators_with_more_than_4_terms
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE c.gender_bio = 'F'
GROUP BY ct.bioguide
HAVING COUNT(ct.bioguide) > 4;
```
-------------------------4753 sample_num
```sql
SELECT COUNT(DISTINCT c.bioguide_id) 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
GROUP BY c.bioguide_id 
HAVING COUNT(ct.bioguide) > 6 
AND c.birthday_bio >= '1960-01-01';
```
-------------------------4754 sample_num
```sql
SELECT AVG(term_count) AS average_terms
FROM (
    SELECT COUNT(ct.bioguide) AS term_count
    FROM current c
    JOIN current-terms ct ON c.bioguide_id = ct.bioguide
    WHERE c.gender_bio = 'F'
    GROUP BY c.bioguide_id
) AS female_terms;
```
-------------------------4755 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN s.instagram IS NULL THEN 1 END) * 100.0 / COUNT(c.bioguide_id)) AS percentage_without_instagram
FROM 
    current c
LEFT JOIN 
    social_media s ON c.bioguide_id = s.bioguide
WHERE 
    c.religion_bio = 'Roman Catholic';
```
-------------------------4756 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE gender_bio = 'M';
```
-------------------------4757 sample_num
```sql
SELECT COUNT(*) 
FROM current_terms 
WHERE party = 'Republican';
```
-------------------------4758 sample_num
```sql
SELECT COUNT(*) 
FROM social_media 
WHERE instagram IS NOT NULL AND instagram <> '';
```
-------------------------4759 sample_num
```sql
SELECT COUNT(*) 
FROM historical 
WHERE gender_bio = 'F';
```
-------------------------4760 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE gender_bio = 'M' AND religion_bio = 'Roman Catholic';
```
-------------------------4761 sample_num
```sql
SELECT party 
FROM current-terms 
WHERE name = 'Sherrod Brown' AND start = 2005;
```
-------------------------4762 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.state_rank = 'senior' 
AND ct.type = 'sen' 
AND ct.start LIKE '2013%';
```
-------------------------4763 sample_num
```sql
SELECT sm.youtube 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE c.official_full_name = 'Chris Van Hollen';
```
-------------------------4764 sample_num
```sql
SELECT 
    COUNT(*) AS official_social_media_count
FROM 
    social_media
JOIN 
    current ON social_media.bioguide = current.bioguide_id
WHERE 
    current.official_full_name = 'Mark Warner' 
    AND (facebook IS NOT NULL OR instagram IS NOT NULL OR twitter IS NOT NULL OR youtube IS NOT NULL);
```
-------------------------4765 sample_num
```sql
SELECT c.last_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.state = 'CA';
```
-------------------------4766 sample_num
```sql
SELECT official_full_name 
FROM current 
JOIN current-terms ON current.bioguide_id = current-terms.bioguide 
WHERE gender_bio = 'F' AND type = 'sen';
```
-------------------------4767 sample_num
```sql
SELECT govtrack_id FROM current WHERE official_full_name = 'Chris Van Hollen';
```
-------------------------4768 sample_num
```sql
SELECT sm.twitter 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE c.official_full_name = 'Roger F. Wicker';
```
-------------------------4769 sample_num
```sql
SELECT h.official_full_name 
FROM historical h 
JOIN historical_terms ht ON h.bioguide_id = ht.bioguide 
WHERE ht.party = 'Pro-Administration' 
AND ht.start <= 1791 
AND ht.end >= 1791;
```
-------------------------4770 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.gender_bio = 'F' 
AND ct.party = 'Republican' 
AND ct.end > CURRENT_DATE;
```
-------------------------4771 sample_num
```sql
SELECT district 
FROM current_terms 
WHERE name = 'Chris Van Hollen';
```
-------------------------4772 sample_num
```sql
SELECT COUNT(*) 
FROM current_terms 
WHERE name = 'Richard Durbin' AND district = 20;
```
-------------------------4773 sample_num
```sql
SELECT DIVIDE(COUNT(c.bioguide_id), 22) AS average_male_democrat_legislators
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE c.gender_bio = 'M' 
  AND ct.party = 'Democrat' 
  AND ct.start >= 2000 
  AND ct.end <= 2021;
```
-------------------------4774 sample_num
```sql
WITH current_female AS (
    SELECT COUNT(*) AS female_count_current
    FROM current
    WHERE gender_bio = 'F'
),
historical_female AS (
    SELECT COUNT(*) AS female_count_historical
    FROM historical
    WHERE gender_bio = 'F'
),
total_female AS (
    SELECT 
        female_count_current,
        female_count_historical,
        (female_count_current * 1.0 / (female_count_current + female_count_historical)) * 100 AS percentage_current,
        (female_count_historical * 1.0 / (female_count_current + female_count_historical)) * 100 AS percentage_historical
    FROM current_female, historical_female
)
SELECT 
    CASE 
        WHEN percentage_current > percentage_historical THEN 'Current Female Legislators' 
        ELSE 'Historical Female Legislators' 
    END AS highest_value,
    GREATEST(percentage_current, percentage_historical) AS highest_percentage
FROM total_female;
```
-------------------------4775 sample_num
```sql
SELECT youtube_id FROM social-media WHERE youtube = 'RepWassermanSchultz';
```
-------------------------4776 sample_num
```sql
SELECT sm.facebook, sm.twitter, sm.youtube
FROM current c
JOIN social-media sm ON c.bioguide_id = sm.bioguide
WHERE c.official_full_name = 'Adam Kinzinger';
```
-------------------------4777 sample_num
```sql
SELECT ct.party 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.official_full_name = 'Christopher Henderson Clark';
```
-------------------------4778 sample_num
```sql
SELECT c.official_full_name
FROM current c
JOIN social_media sm ON c.bioguide_id = sm.bioguide
WHERE sm.youtube IS NOT NULL AND (sm.instagram IS NULL OR sm.instagram = '')
LIMIT 10;
```
-------------------------4779 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.state = 'VA';
```
-------------------------4780 sample_num
```sql
SELECT first_name, last_name 
FROM historical 
JOIN historical-terms ON historical.bioguide_id = historical-terms.bioguide 
WHERE historical-terms.party = 'National Greenbacker';
```
-------------------------4781 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE sm.youtube = 'RoskamIL06';
```
-------------------------4782 sample_num
```sql
SELECT c.official_full_name
FROM current c
JOIN social_media sm ON c.bioguide_id = sm.bioguide
WHERE sm.facebook IS NOT NULL AND sm.facebook <> ''
  AND (sm.youtube IS NULL OR sm.youtube = '')
  AND (sm.instagram IS NULL OR sm.instagram = '')
  AND (sm.twitter IS NULL OR sm.twitter = '')
LIMIT 10;
```
-------------------------4783 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.state_rank = 'junior' AND ct.party = 'Republican';
```
-------------------------4784 sample_num
```sql
SELECT ct.contact_form 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.official_full_name = 'Claire McCaskill';
```
-------------------------4785 sample_num
```sql
SELECT h.wikipedia_id 
FROM historical h 
JOIN historical-terms ht ON h.bioguide_id = ht.bioguide 
WHERE ht.party = 'Readjuster Democrat';
```
-------------------------4786 sample_num
```sql
SELECT official_full_name 
FROM current 
WHERE party = 'Republican' AND nickname_name IS NOT NULL;
```
-------------------------4787 sample_num
```sql
SELECT ct.state, ct.party
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE c.official_full_name = 'Veronica Grace Boland';
```
-------------------------4788 sample_num
```sql
SELECT COUNT(*) 
FROM historical 
WHERE birthday_bio LIKE '1973%';
```
-------------------------4789 sample_num
```sql
SELECT 
    COUNT(CASE WHEN gender_bio = 'M' THEN bioguide_id END) * 1.0 / 
    NULLIF(COUNT(CASE WHEN gender_bio = 'F' THEN bioguide_id END), 0) AS male_female_ratio
FROM 
    historical;
```
-------------------------4790 sample_num
```sql
SELECT COUNT(*) 
FROM current-terms 
WHERE end = '2009-12-31' AND party = 'Republican';
```
-------------------------4791 sample_num
```sql
SELECT official_full_name, gender_bio 
FROM current 
WHERE last_name = 'Collins';
```
-------------------------4792 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN ct.class = 1 THEN ct.bioguide END) * 100.0) / COUNT(ct.bioguide) AS percent_class_1_senators
FROM 
    current c
JOIN 
    current-terms ct ON c.bioguide_id = ct.bioguide;
```
-------------------------4793 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.party = 'Independent';
```
-------------------------4794 sample_num
```sql
SELECT SUM(YEAR(end) - YEAR(start)) AS total_years_served
FROM current_terms
WHERE name = 'Jr. John Conyers';
```
-------------------------4795 sample_num
```sql
SELECT 
    SUBTRACT(MIN(ct.start), c.birthday_bio) AS age_when_started
FROM 
    current c
JOIN 
    current-terms ct ON c.bioguide_id = ct.bioguide
WHERE 
    c.official_full_name = 'Jr. F. James Sensenbrenner';
```
-------------------------4796 sample_num
```sql
SELECT c.official_full_name, c.religion_bio, ct.party
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE ct.state = 'ME';
```
-------------------------4797 sample_num
```sql
SELECT c.official_full_name, c.nickname_name
FROM current c
JOIN social_media sm ON c.bioguide_id = sm.bioguide
WHERE sm.instagram IS NOT NULL AND c.thomas_id < 1000;
```
-------------------------4798 sample_num
```sql
SELECT MAX(end) AS last_serving_date
FROM current_terms
WHERE name = 'Matt Salmon';
```
-------------------------4799 sample_num
```sql
SELECT ct.party, ct.state
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE c.house_history_id IS NOT NULL AND c.birthday_bio = '1738';
```
-------------------------4800 sample_num
```sql
SELECT c.bioguide_id, CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE ct.party = 'Liberal Republican';
```
-------------------------4801 sample_num
```sql
SELECT COUNT(*) 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.start = '1793-12-02' AND c.gender_bio = 'M';
```
-------------------------4802 sample_num
```sql
SELECT 
    COUNT(CASE WHEN start LIKE '1875%' THEN 1 END) AS legislators_1875,
    COUNT(CASE WHEN start LIKE '2005%' THEN 1 END) AS legislators_2005
FROM 
    current-terms;
```
-------------------------4803 sample_num
```sql
SELECT c.official_full_name, sm.twitter_id, sm.youtube_id
FROM current c
JOIN social_media sm ON c.bioguide_id = sm.bioguide
WHERE c.first_name = 'Richard';
```
-------------------------4804 sample_num
```sql
SELECT ct.start, ct.end, ct.party 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.official_full_name = 'Pearl Peden Oldfield';
```
-------------------------4805 sample_num
```sql
SELECT birthday_bio 
FROM current 
WHERE first_name = 'Amy' AND last_name = 'Klobuchar';
```
-------------------------4806 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE fec_id IS NULL OR fec_id = '';
```
-------------------------4807 sample_num
```sql
SELECT COUNT(*) AS female_legislators
FROM current
WHERE gender_bio = 'F';
```
-------------------------4808 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM current c
WHERE c.opensecrets_id IS NOT NULL AND c.opensecrets_id <> '';
```
-------------------------4809 sample_num
```sql
SELECT middle_name 
FROM current 
WHERE birthday_bio = '1956-08-24';
```
-------------------------4810 sample_num
```sql
SELECT COUNT(*) 
FROM current-terms 
WHERE title = 'Majority Leader';
```
-------------------------4811 sample_num
```sql
SELECT ct.title 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.birthday_bio = '1942-02-20';
```
-------------------------4812 sample_num
```sql
SELECT gender_bio 
FROM current 
JOIN current-terms ON current.bioguide_id = current-terms.bioguide 
WHERE current-terms.address = '317 Russell Senate Office Building Washington DC 20510';
```
-------------------------4813 sample_num
```sql
SELECT c.first_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.state_rank = 'senior' AND ct.chamber = 'Senate';
```
-------------------------4814 sample_num
```sql
SELECT state, COUNT(*) AS male_legislators_count
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE c.gender_bio = 'M' AND (ct.class IS NULL OR ct.class = '')
GROUP BY state;
```
-------------------------4815 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN ct.class IS NOT NULL AND YEAR(c.birthday_bio) = 1964 THEN c.bioguide_id END) * 1.0 / COUNT(c.bioguide_id)) * 100 AS percentage_senators_born_1964
FROM 
    current c
JOIN 
    current_terms ct ON c.bioguide_id = ct.bioguide;
```
-------------------------4816 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN ct.class IS NULL AND c.birthday_bio <= '1975-12-31' THEN c.bioguide_id END) * 1.0 / COUNT(c.bioguide_id)) * 100 AS percentage_not_senators_born_before_1975
FROM 
    current c
JOIN 
    current-terms ct ON c.bioguide_id = ct.bioguide;
```
-------------------------4817 sample_num
```sql
SELECT sm.twitter 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE c.birthday_bio = '1946-05-27';
```
-------------------------4818 sample_num
```sql
SELECT c.opensecrets_id 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE sm.youtube = 'Bluetkemeyer';
```
-------------------------4819 sample_num
```sql
SELECT sm.facebook 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE c.official_full_name = 'Ralph Abraham';
```
-------------------------4820 sample_num
```sql
SELECT c.first_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.address = '1005 Longworth HOB; Washington DC 20515-1408';
```
-------------------------4821 sample_num
```sql
SELECT sm.instagram 
FROM current c 
JOIN social-media sm ON c.bioguide_id = sm.bioguide 
WHERE c.birthday_bio = '1952-08-24';
```
-------------------------4822 sample_num
```sql
SELECT COUNT(*) 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.class IS NULL OR ct.class = '' 
AND c.gender_bio = 'F';
```
-------------------------4823 sample_num
```sql
SELECT c.religion_bio 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE sm.youtube = 'MaxineWaters';
```
-------------------------4824 sample_num
```sql
SELECT COUNT(*) 
FROM current-terms 
WHERE title = 'Minority Leader' AND (fec_id IS NULL OR fec_id = '');
```
-------------------------4825 sample_num
```sql
SELECT COUNT(*) AS male_legislators
FROM current
WHERE gender_bio = 'M';
```
-------------------------4826 sample_num
```sql
SELECT facebook_id 
FROM social-media 
WHERE facebook = 'RepWilson';
```
-------------------------4827 sample_num
```sql
SELECT COUNT(*) AS total_legislators
FROM current
WHERE first_name = 'John';
```
-------------------------4828 sample_num
```sql
SELECT DISTINCT ct.district
FROM current_terms ct
JOIN current c ON ct.bioguide = c.bioguide_id
WHERE ct.party = 'Anti-Administration';
```
-------------------------4829 sample_num
```sql
SELECT official_full_name 
FROM current 
WHERE birthday_bio LIKE '1960%';
```
-------------------------4830 sample_num
```sql
SELECT google_entity_id_id 
FROM current 
WHERE first_name = 'Benjamin' AND last_name = 'Hawkins';
```
-------------------------4831 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.party = 'Pro-Administration' 
AND ct.type = 'sen' 
AND ct.start = '1789-03-04' 
AND ct.end = '1791-12-31';
```
-------------------------4832 sample_num
```sql
SELECT c.first_name, c.last_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.district = 9 AND ct.type = 'rep';
```
-------------------------4833 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.party = 'Independent';
```
-------------------------4834 sample_num
```sql
SELECT ct.opensecrets_id, ct.thomas_id
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE ct.party = 'Democrat' AND ct.type = 'sen' AND ct.state = 'NJ';
```
-------------------------4835 sample_num
```sql
SELECT c.google_entity_id_id 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.type = 'sen' AND ct.state = 'NY';
```
-------------------------4836 sample_num
```sql
SELECT c.religion_bio 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.rss_url = 'http://www.corker.senate.gov/public/index.cfm/rss/feed';
```
-------------------------4837 sample_num
```sql
SELECT ct.party 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.official_full_name = 'Susan M. Collins';
```
-------------------------4838 sample_num
```sql
SELECT district 
FROM current-terms 
WHERE name = 'Jonathan Grout' AND type = 'rep';
```
-------------------------4839 sample_num
```sql
SELECT ct.party, ct.state
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE c.opensecrets_id = 'N00003689' AND c.thomas_id = '186';
```
-------------------------4840 sample_num
```sql
SELECT c.official_full_name, c.birthday_bio
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE ct.contact_form = 'http://www.brown.senate.gov/contact/';
```
-------------------------4841 sample_num
```sql
SELECT ct.state, ct.type
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE c.google_entity_id_id = 'kg:/m/02pyzk';
```
-------------------------4842 sample_num
```sql
SELECT ct.type, ct.end 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.first_name = 'John' AND c.last_name = 'Vining';
```
-------------------------4843 sample_num
```sql
SELECT 
    (SUM(CASE WHEN type = 'sen' AND gender_bio = 'F' AND strftime('%Y', birthday_bio) BETWEEN '1930' AND '1970' THEN 1 ELSE 0 END) -
     SUM(CASE WHEN type = 'rep' AND gender_bio = 'F' AND strftime('%Y', birthday_bio) BETWEEN '1930' AND '1970' THEN 1 ELSE 0 END)) AS difference
FROM current_terms;
```
-------------------------4844 sample_num
```sql
SELECT 
    (SUM(CASE WHEN ct.party = 'Independent' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS percentage
FROM 
    current c
JOIN 
    current-terms ct ON c.bioguide_id = ct.bioguide
WHERE 
    c.gender_bio = 'M' 
    AND strftime('%Y', c.birthday_bio) BETWEEN '1955' AND '1965';
```
-------------------------4845 sample_num
```sql
SELECT first_name, last_name 
FROM current 
WHERE bioguide_id = 'W000059';
```
-------------------------4846 sample_num
```sql
SELECT CASE 
    WHEN ballotpedia_id IS NULL THEN 'Thomas Carnes does not have an account on ballotpedia.org' 
    ELSE 'Thomas Carnes has an account on ballotpedia.org' 
END AS account_status
FROM current
WHERE first_name = 'Thomas' AND last_name = 'Carnes';
```
-------------------------4847 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE birthday_bio LIKE '1736%';
```
-------------------------4848 sample_num
```sql
SELECT official_full_name 
FROM current 
WHERE gender_bio = 'F';
```
-------------------------4849 sample_num
```sql
SELECT COUNT(DISTINCT district) FROM current-terms WHERE state = 'ID';
```
-------------------------4850 sample_num
```sql
SELECT COUNT(*) 
FROM current-terms 
WHERE class IS NULL;
```
-------------------------4851 sample_num
```sql
SELECT DIVIDE(SUM(gender_bio = 'M'), SUM(gender_bio = 'F')) AS gender_ratio
FROM current;
```
-------------------------4852 sample_num
```sql
SELECT 
    (SUM(CASE WHEN wikipedia_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0) / COUNT(bioguide_id) AS percentage_famous_legislators
FROM 
    current;
```
-------------------------4853 sample_num
```sql
SELECT c.official_full_name
FROM current c
LEFT JOIN social_media sm ON c.bioguide_id = sm.bioguide
WHERE sm.instagram IS NULL;
```
-------------------------4854 sample_num
```sql
SELECT c.first_name, c.last_name, ct.district, ct.state
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE ct.type = 'rep' AND ct.start LIKE '1789%';
```
-------------------------4855 sample_num
```sql
SELECT district 
FROM current-terms 
WHERE name = 'Benjamin Contee';
```
-------------------------4856 sample_num
```sql
SELECT ct.address 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.first_name = 'Amy' AND c.last_name = 'Klobuchar' AND ct.start = '2001-04-01';
```
-------------------------4857 sample_num
```sql
SELECT c.first_name, c.last_name, ct.state
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE ct.state_rank = 'junior' AND ct.start LIKE '1997%';
```
-------------------------4858 sample_num
```sql
SELECT COUNT(*)
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE c.gender_bio = 'F' 
  AND ct.type = 'rep' 
  AND ct.state = 'CA' 
  AND YEAR(ct.start) = 2015;
```
-------------------------4859 sample_num
```sql
SELECT sm.twitter_id 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE c.first_name = 'Emanuel' AND c.last_name = 'Cleaver';
```
-------------------------4860 sample_num
```sql
SELECT sm.facebook_id 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
JOIN social-media sm ON ct.bioguide = sm.bioguide 
WHERE ct.party = 'Democrat';
```
-------------------------4861 sample_num
```sql
SELECT h.*
FROM historical h
JOIN historical-terms ht ON h.bioguide_id = ht.bioguide
WHERE h.gender_bio = 'F' AND ht.end = '1791-03-03';
```
-------------------------4862 sample_num
```sql
SELECT c.official_full_name
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE c.religion_bio = 'Jewish' AND ct.state = 'FL';
```
-------------------------4863 sample_num
```sql
SELECT 
    DIVIDE(
        COUNT(current.bioguide_id) FILTER (WHERE current.wikipedia_id IS NOT NULL), 
        COUNT(historical.bioguide_id) FILTER (WHERE historical.wikipedia_id IS NOT NULL)
    ) AS ratio
FROM 
    current, 
    historical;
```
-------------------------4864 sample_num
```sql
SELECT 
    (SUM(CASE WHEN strftime('%Y', start) BETWEEN '2000' AND '2017' THEN 1 ELSE 0 END) * 100.0) / COUNT(c.bioguide_id) AS percentage
FROM 
    current c
JOIN 
    current-terms ct ON c.bioguide_id = ct.bioguide;
```
-------------------------4865 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE religion_bio = 'Catholic' AND ballotpedia_id IS NULL;
```
-------------------------4866 sample_num
```sql
SELECT COUNT(*) 
FROM current-terms 
WHERE class = 1 AND party = 'Republican' AND type = 'sen';
```
-------------------------4867 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM current c
WHERE c.google_entity_id_id IS NULL
  AND c.gender_bio = 'F'
  AND c.fec_id IS NULL;
```
-------------------------4868 sample_num
```sql
SELECT COUNT(*) 
FROM current-terms 
WHERE state = 'CA' AND type = 'rep' AND end LIKE '1995%';
```
-------------------------4869 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM current
WHERE birthday_bio = (SELECT MIN(birthday_bio) FROM current);
```
-------------------------4870 sample_num
```sql
SELECT c.bioguide_id 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.party = 'Democrat' 
AND ct.district = '13' 
AND ct.end = '2019-01-03' 
AND ct.type = 'rep';
```
-------------------------4871 sample_num
```sql
SELECT sm.twitter 
FROM current c 
JOIN social-media sm ON c.bioguide_id = sm.bioguide 
WHERE c.first_name = 'Jason' AND c.last_name = 'Lewis';
```
-------------------------4872 sample_num
```sql
SELECT c.official_full_name
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE ct.party = 'Independent'
  AND ct.type = 'sen'
  AND strftime('%Y', ct.start) >= '2011'
  AND ct.caucus = 'Democrat';
```
-------------------------4873 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE religion_bio = 'Jewish' 
AND bioguide_id NOT IN (SELECT bioguide FROM social_media WHERE facebook IS NOT NULL);
```
-------------------------4874 sample_num
```sql
SELECT party
FROM current
WHERE religion_bio = 'Baptist'
GROUP BY party
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------4875 sample_num
```sql
SELECT c.official_full_name
FROM current c
JOIN social_media sm ON c.bioguide_id = sm.bioguide
WHERE sm.facebook IS NOT NULL 
  AND sm.instagram IS NOT NULL 
  AND sm.twitter IS NOT NULL 
  AND sm.youtube IS NOT NULL;
```
-------------------------4876 sample_num
```sql
SELECT COUNT(DISTINCT district) 
FROM current-terms 
WHERE name = 'John Conyers, Jr.';
```
-------------------------4877 sample_num
```sql
SELECT c.wikipedia_id 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.party = 'Anti-Administration' AND ct.type = 'sen';
```
-------------------------4878 sample_num
```sql
SELECT c.official_full_name
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE ct.district = 13
GROUP BY c.official_full_name
HAVING SUM(CAST(strftime('%Y', ct.end) AS INTEGER) - CAST(strftime('%Y', ct.start) AS INTEGER)) = 26;
```
-------------------------4879 sample_num
```sql
SELECT COUNT(*)
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE ct.party = 'Federalist' AND ct.type = 'rep' AND c.first_name = 'Benjamin';
```
-------------------------4880 sample_num
```sql
SELECT COUNT(*) 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.gender_bio = 'F' 
AND ct.state = 'California' 
AND (strftime('%Y', ct.end) - strftime('%Y', ct.start)) >= 10 
AND ct.type = 'rep';
```
-------------------------4881 sample_num
```sql
SELECT party 
FROM current 
WHERE birthday_bio = (SELECT MIN(birthday_bio) FROM current);
```
-------------------------4882 sample_num
```sql
SELECT c.official_full_name
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
WHERE c.religion_bio = 'Lutheran'
  AND ct.type = 'rep'
  AND ct.state = 'Ohio'
  AND (strftime('%Y', ct.end) - strftime('%Y', ct.start)) = 14;
```
-------------------------4883 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE strftime('%Y', birthday_bio) > '1960' 
AND google_entity_id_id IS NULL;
```
-------------------------4884 sample_num
```sql
SELECT official_full_name 
FROM current 
WHERE house_history_id IS NOT NULL;
```
-------------------------4885 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE icpsr_id IS NOT NULL AND maplight_id IS NOT NULL;
```
-------------------------4886 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE gender_bio = 'F' AND lis_id IS NOT NULL;
```
-------------------------4887 sample_num
```sql
SELECT religion_bio 
FROM current 
WHERE first_name = 'Sherrod' AND last_name = 'Brown';
```
-------------------------4888 sample_num
```sql
SELECT religion_bio, COUNT(*) AS occurrence
FROM current
GROUP BY religion_bio
ORDER BY occurrence DESC
LIMIT 1;
```
-------------------------4889 sample_num
```sql
SELECT sm.instagram 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE c.first_name = 'Bob' AND c.last_name = 'Corker';
```
-------------------------4890 sample_num
```sql
SELECT COUNT(*) 
FROM current c
JOIN social-media sm ON c.bioguide_id = sm.bioguide
WHERE c.thomas_id IS NOT NULL AND sm.instagram IS NOT NULL;
```
-------------------------4891 sample_num
```sql
SELECT sm.facebook
FROM current c
JOIN social-media sm ON c.bioguide_id = sm.bioguide
WHERE c.wikipedia_id IS NOT NULL;
```
-------------------------4892 sample_num
```sql
SELECT COUNT(*) 
FROM current-terms 
WHERE bioguide = (
    SELECT bioguide_id 
    FROM current 
    WHERE birthday_bio = (SELECT MIN(birthday_bio) FROM current)
);
```
-------------------------4893 sample_num
```sql
SELECT ct.phone 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.first_name = 'Sherrod' AND c.last_name = 'Brown' AND ct.start = '2013-01-03';
```
-------------------------4894 sample_num
```sql
SELECT COUNT(*) 
FROM current-terms 
WHERE name = 'Sherrod Brown' AND party = 'Democrat';
```
-------------------------4895 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN current_terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.start = '2013-01-03';
```
-------------------------4896 sample_num
```sql
SELECT COUNT(*) 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.start = '2013-01-03' AND c.gender_bio = 'F';
```
-------------------------4897 sample_num
```sql
SELECT c.official_full_name
FROM current c
JOIN current-terms ct ON c.bioguide_id = ct.bioguide
GROUP BY c.bioguide_id
ORDER BY COUNT(ct.bioguide) DESC
LIMIT 1;
```
-------------------------4898 sample_num
```sql
SELECT COUNT(*) 
FROM current-terms 
WHERE name = 'Sherrod Brown' AND district = 13;
```
-------------------------4899 sample_num
```sql
SELECT c.official_full_name 
FROM current c 
JOIN social_media sm ON c.bioguide_id = sm.bioguide 
WHERE sm.facebook = 'senjoniernst';
```
-------------------------4900 sample_num
```sql
SELECT official_full_name, COUNT(*) AS term_count
FROM current-terms
WHERE official_full_name IN ('Maria Cantwell', 'Sherrod Brown')
GROUP BY official_full_name
ORDER BY term_count DESC;
```
-------------------------4901 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.gender_bio = 'F' THEN 1 ELSE 0 END) * 100.0) / COUNT(c.bioguide) AS female_percentage
FROM 
    current c
JOIN 
    current-terms ct ON c.bioguide_id = ct.bioguide
GROUP BY 
    c.bioguide_id
HAVING 
    COUNT(ct.bioguide) > 4;
```
-------------------------4902 sample_num
```sql
SELECT AVG(term_count) AS average_terms_served
FROM (
    SELECT COUNT(ct.bioguide) AS term_count
    FROM current c
    JOIN current-terms ct ON c.bioguide_id = ct.bioguide
    WHERE c.wikipedia_id IS NOT NULL
    GROUP BY c.bioguide_id
) AS term_counts;
```
-------------------------4903 sample_num
```sql
SELECT COUNT(*) 
FROM current 
WHERE gender_bio = 'F';
```
-------------------------4904 sample_num
```sql
SELECT COUNT(*) 
FROM current_terms 
WHERE state = 'NJ' AND type = 'sen';
```
-------------------------4905 sample_num
```sql
SELECT ct.address 
FROM current_terms ct 
WHERE ct.contact_form = 'http://www.carper.senate.gov/contact/';
```
-------------------------4906 sample_num
```sql
SELECT sm.instagram 
FROM current c 
JOIN social-media sm ON c.bioguide_id = sm.bioguide 
WHERE c.first_name = 'Benjamin' AND c.last_name = 'Hawkins';
```
-------------------------4907 sample_num
```sql
SELECT c.bioguide_id 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.religion_bio = 'Catholic' AND ct.state = 'NE';
```
-------------------------4908 sample_num
```sql
SELECT c.maplight_id 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE ct.state = 'ME' AND ct.type = 'rep';
```
-------------------------4909 sample_num
```sql
SELECT current-terms.type, current-terms.start 
FROM current 
JOIN current-terms ON current.bioguide_id = current-terms.bioguide 
WHERE current.birthday_bio = '1727-11-26';
```
-------------------------4910 sample_num
```sql
SELECT ct.contact_form 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.first_name = 'Rick' AND c.last_name = 'Crawford';
```
-------------------------4911 sample_num
```sql
SELECT COUNT(*) 
FROM current c 
JOIN current-terms ct ON c.bioguide_id = ct.bioguide 
WHERE c.gender_bio = 'F' AND ct.type = 'rep' AND ct.state = 'MI';
```
-------------------------4912 sample_num
```sql
SELECT 
    (SUM(CASE WHEN ct.type = 'sen' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS percentage
FROM 
    current c
JOIN 
    current-terms ct ON c.bioguide_id = ct.bioguide
WHERE 
    c.gender_bio = 'F' AND ct.state = 'ME';
```
-------------------------4913 sample_num
```sql
SELECT g.games_name
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person p ON gc.person_id = p.id
WHERE p.full_name = 'John Aalberg';
```
-------------------------4914 sample_num
```sql
SELECT g.games_name 
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person p ON gc.person_id = p.id
WHERE p.full_name = 'John Aalberg' AND gc.age = 31;
```
-------------------------4915 sample_num
```sql
SELECT age 
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
JOIN person p ON gc.person_id = p.id
WHERE p.full_name = 'John Aalberg' AND g.games_name = '1994 Winter';
```
-------------------------4916 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS num_competitors
FROM games_competitor gc
JOIN person_region pr ON gc.person_id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE nr.region_name = 'Finland';
```
-------------------------4917 sample_num
```sql
SELECT p.full_name 
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE nr.region_name = 'Finland';
```
-------------------------4918 sample_num
```sql
SELECT nr.region_name 
FROM person p 
JOIN games_competitor gc ON p.id = gc.person_id 
JOIN person_region pr ON p.id = pr.person_id 
JOIN noc_region nr ON pr.region_id = nr.id 
WHERE p.full_name = 'John Aalberg';
```
-------------------------4919 sample_num
```sql
SELECT noc_region.noc
FROM person
JOIN games_competitor ON person.id = games_competitor.person_id
JOIN person_region ON person.id = person_region.person_id
JOIN noc_region ON person_region.region_id = noc_region.id
WHERE person.gender = 'M' AND person.height = (
    SELECT MAX(height)
    FROM person
    WHERE gender = 'M'
);
```
-------------------------4920 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS female_competitors
FROM games_competitor gc
JOIN person p ON gc.person_id = p.id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE nr.region_name = 'Finland' AND p.gender = 'F';
```
-------------------------4921 sample_num
```sql
SELECT c.city_name
FROM city c
JOIN games_city gc ON c.id = gc.city_id
JOIN games g ON gc.games_id = g.id
WHERE g.games_year = 1992 AND g.season = 'Summer';
```
-------------------------4922 sample_num
```sql
SELECT g.games_name 
FROM games g
JOIN games_city gc ON g.id = gc.games_id
JOIN city c ON gc.city_id = c.id
WHERE c.city_name = 'London';
```
-------------------------4923 sample_num
```sql
SELECT MIN(g.games_year) 
FROM games g 
JOIN games_city gc ON g.id = gc.games_id 
JOIN city c ON gc.city_id = c.id 
WHERE c.city_name = 'London';
```
-------------------------4924 sample_num
```sql
SELECT COUNT(games_id) 
FROM games_city 
JOIN city ON games_city.city_id = city.id 
WHERE city.city_name = 'London';
```
-------------------------4925 sample_num
```sql
SELECT AVG(height) AS average_height
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE nr.region_name = 'Finland' AND p.gender = 'M';
```
-------------------------4926 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN nr.region_name = 'Finland' THEN gc.person_id END) * 100.0 / COUNT(gc.person_id)) AS percentage
FROM 
    games g
JOIN 
    games_competitor gc ON g.id = gc.games_id
JOIN 
    person_region pr ON gc.person_id = pr.person_id
JOIN 
    noc_region nr ON pr.region_id = nr.id
WHERE 
    g.games_year = 1994 AND g.season = 'Winter';
```
-------------------------4927 sample_num
```sql
SELECT s.sport_name 
FROM sport s 
JOIN event e ON s.id = e.sport_id 
WHERE e.event_name = 'Shooting Women''s Trap';
```
-------------------------4928 sample_num
```sql
SELECT c.city_name 
FROM city c 
JOIN games_city gc ON c.id = gc.city_id 
JOIN games g ON gc.games_id = g.id 
WHERE g.games_year = 1936 AND g.games_name = 'Winter';
```
-------------------------4929 sample_num
```sql
SELECT COUNT(games.id) AS olympic_games_count
FROM games
JOIN games_city ON games.id = games_city.games_id
JOIN city ON games_city.city_id = city.id
WHERE city.city_name = 'London';
```
-------------------------4930 sample_num
```sql
SELECT COUNT(*) 
FROM event 
WHERE sport_id = (SELECT id FROM sport WHERE sport_name = 'Swimming');
```
-------------------------4931 sample_num
```sql
SELECT nr.region_name
FROM person p
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE p.full_name = 'Peter Kohnke';
```
-------------------------4932 sample_num
```sql
SELECT g.id 
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person p ON gc.person_id = p.id
WHERE p.full_name = 'Jessica Carolina Aguilera Aguilera';
```
-------------------------4933 sample_num
```sql
SELECT s.sport_name
FROM sport s
JOIN event e ON s.id = e.sport_id
GROUP BY s.sport_name
ORDER BY COUNT(e.id) DESC
LIMIT 1;
```
-------------------------4934 sample_num
```sql
SELECT p.full_name 
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE nr.region_name = 'Sweden'
ORDER BY p.height DESC
LIMIT 1;
```
-------------------------4935 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS athlete_count
FROM games_competitor gc
JOIN person_region pr ON gc.person_id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE nr.region_name = 'Guatemala';
```
-------------------------4936 sample_num
```sql
SELECT p.full_name, COUNT(gc.games_id) AS games_participated
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
GROUP BY p.full_name
ORDER BY games_participated DESC
LIMIT 1;
```
-------------------------4937 sample_num
```sql
SELECT full_name FROM person WHERE id = 90991;
```
-------------------------4938 sample_num
```sql
SELECT COUNT(DISTINCT gc.id) AS competitor_count
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
WHERE p.full_name = 'Martina Kohlov';
```
-------------------------4939 sample_num
```sql
SELECT weight / (height * height) AS bmi
FROM person
WHERE id = 147420;
```
-------------------------4940 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.gender = 'M' THEN 1 END) * 100.0 / COUNT(p.id)) AS percentage
FROM 
    person p
JOIN 
    person_region pr ON p.id = pr.person_id
JOIN 
    noc_region nr ON pr.region_id = nr.id
WHERE 
    nr.region_name = 'Estonia';
```
-------------------------4941 sample_num
```sql
SELECT full_name 
FROM person 
JOIN games_competitor ON person.id = games_competitor.person_id 
WHERE age = (SELECT MIN(age) FROM games_competitor);
```
-------------------------4942 sample_num
```sql
SELECT COUNT(*) 
FROM competitor_event ce
JOIN games_competitor gc ON ce.competitor_id = gc.id
JOIN event e ON ce.event_id = e.id
WHERE gc.age = 24 AND e.event_name = 'Basketball Men''s Basketball';
```
-------------------------4943 sample_num
```sql
SELECT e.event_name 
FROM event e 
JOIN sport s ON e.sport_id = s.id 
WHERE s.sport_name = 'Art Competitions';
```
-------------------------4944 sample_num
```sql
SELECT COUNT(*) 
FROM competitor_event ce
JOIN games_competitor gc ON ce.competitor_id = gc.id
JOIN person p ON gc.person_id = p.id
JOIN medal m ON ce.medal_id = m.id
WHERE p.full_name = 'Henk Jan Zwolle' AND m.medal_name = 'Gold';
```
-------------------------4945 sample_num
```sql
SELECT e.event_name
FROM event e
JOIN competitor_event ce ON e.id = ce.event_id
JOIN medal m ON ce.medal_id = m.id
WHERE m.medal_name = 'Gold'
GROUP BY e.event_name
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------4946 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS athlete_count
FROM games_competitor gc
JOIN person_region pr ON gc.person_id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE nr.region_name = 'Australia';
```
-------------------------4947 sample_num
```sql
SELECT c.city_name
FROM city c
JOIN games_city gc ON c.id = gc.city_id
JOIN games g ON gc.games_id = g.id
GROUP BY c.city_name
HAVING COUNT(g.id) >= 3;
```
-------------------------4948 sample_num
```sql
SELECT COUNT(*) 
FROM games g 
JOIN games_city gc ON g.id = gc.games_id 
JOIN city c ON gc.city_id = c.id 
WHERE g.season = 'Summer' AND c.city_name = 'Stockholm';
```
-------------------------4949 sample_num
```sql
SELECT nr.region_name
FROM person_region pr
JOIN noc_region nr ON pr.region_id = nr.id
GROUP BY nr.region_name
ORDER BY COUNT(pr.person_id) DESC
LIMIT 1;
```
-------------------------4950 sample_num
```sql
SELECT c.city_name 
FROM city c 
JOIN games_city gc ON c.id = gc.city_id 
JOIN games g ON gc.games_id = g.id 
WHERE g.games_year = (SELECT MIN(games_year) FROM games);
```
-------------------------4951 sample_num
```sql
SELECT g.games_name
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
WHERE gc.age = (SELECT MAX(age) FROM games_competitor);
```
-------------------------4952 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS athlete_count
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE g.games_year = 1992 AND g.games_name = 'Summer';
```
-------------------------4953 sample_num
```sql
SELECT 
    COUNT(ce.event_id) AS total_events,
    DIVIDE(COUNT(CASE WHEN m.medal_name = 'Gold' THEN ce.event_id END), COUNT(ce.event_id)) AS percentage
FROM 
    person p
JOIN 
    games_competitor gc ON p.id = gc.person_id
JOIN 
    competitor_event ce ON gc.id = ce.competitor_id
JOIN 
    medal m ON ce.medal_id = m.id
WHERE 
    p.full_name = 'Michael Fred Phelps, II';
```
-------------------------4954 sample_num
```sql
SELECT 
    g.season,
    COUNT(gc.person_id) AS num_competitors
FROM 
    games g
JOIN 
    games_competitor gc ON g.id = gc.games_id
WHERE 
    g.games_year = 1988 AND (g.season = 'Summer' OR g.season = 'Winter')
GROUP BY 
    g.season
ORDER BY 
    num_competitors DESC
LIMIT 1;

SELECT 
    (SELECT COUNT(gc.person_id) FROM games g JOIN games_competitor gc ON g.id = gc.games_id WHERE g.games_year = 1988 AND g.season = 'Summer') -
    (SELECT COUNT(gc.person_id) FROM games g JOIN games_competitor gc ON g.id = gc.games_id WHERE g.games_year = 1988 AND g.season = 'Winter') AS competitor_difference;
```
-------------------------4955 sample_num
```sql
SELECT age, COUNT(person_id) AS num_competitors
FROM games_competitor
GROUP BY age
ORDER BY num_competitors DESC
LIMIT 1;
```
-------------------------4956 sample_num
```sql
SELECT c.city_name 
FROM city c 
JOIN games_city gc ON c.id = gc.city_id 
JOIN games g ON gc.games_id = g.id 
WHERE c.city_name LIKE 'M%';
```
-------------------------4957 sample_num
```sql
SELECT c.city_name
FROM city c
JOIN games_city gc ON c.id = gc.city_id
JOIN games g ON gc.games_id = g.id
WHERE g.games_year = 1976 AND g.games_name IN ('1976 Winter', '1976 Summer');
```
-------------------------4958 sample_num
```sql
SELECT m.medal_name 
FROM person p 
JOIN games_competitor gc ON p.id = gc.person_id 
JOIN competitor_event ce ON gc.id = ce.competitor_id 
JOIN medal m ON ce.medal_id = m.id 
WHERE p.full_name = 'Coleen Dufresne';
```
-------------------------4959 sample_num
```sql
SELECT p.full_name
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN competitor_event ce ON gc.id = ce.competitor_id
GROUP BY p.full_name
ORDER BY COUNT(ce.medal_id) DESC
LIMIT 1;
```
-------------------------4960 sample_num
```sql
SELECT nr.region_name 
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE p.full_name = 'Estelle Nze Minko';
```
-------------------------4961 sample_num
```sql
SELECT DISTINCT s.sport_name
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN competitor_event ce ON gc.id = ce.competitor_id
JOIN event e ON ce.event_id = e.id
JOIN sport s ON e.sport_id = s.id
WHERE p.full_name = 'Chin Eei Hui';
```
-------------------------4962 sample_num
```sql
SELECT full_name 
FROM person 
JOIN games_competitor ON person.id = games_competitor.person_id 
WHERE age = (SELECT MAX(age) FROM games_competitor);
```
-------------------------4963 sample_num
```sql
SELECT g.games_year, COUNT(gc.person_id) AS women_count
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person p ON gc.person_id = p.id
WHERE p.gender = 'F'
GROUP BY g.games_year
ORDER BY women_count DESC
LIMIT 1;
```
-------------------------4964 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS male_participants
FROM games_competitor gc
JOIN person p ON gc.person_id = p.id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE p.gender = 'M' AND nr.region_name = 'Belgium';
```
-------------------------4965 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS number_of_participants
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
JOIN games_city gc2 ON g.id = gc2.games_id
JOIN city c ON gc2.city_id = c.id
WHERE c.city_name = 'Sapporo';
```
-------------------------4966 sample_num
```sql
SELECT g.games_year, g.games_name 
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person p ON gc.person_id = p.id
WHERE p.full_name = 'Morten Aleksander Djupvik';
```
-------------------------4967 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS total_participants
FROM games_competitor gc
JOIN competitor_event ce ON gc.id = ce.competitor_id
JOIN event e ON ce.event_id = e.id
WHERE e.event_name = 'Sailing Mixed 12 metres';
```
-------------------------4968 sample_num
```sql
SELECT COUNT(DISTINCT e.id) AS event_count
FROM event e
JOIN sport s ON e.sport_id = s.id
WHERE s.sport_name = 'Modern Pentathlon';
```
-------------------------4969 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.gender = 'F' THEN 1 END) * 100.0 / COUNT(p.id)) AS percentage
FROM 
    person p
JOIN 
    games_competitor gc ON p.id = gc.person_id
JOIN 
    competitor_event ce ON gc.id = ce.competitor_id
JOIN 
    event e ON ce.event_id = e.id
WHERE 
    e.event_name = 'Equestrianism Mixed Three-Day Event, Individual';
```
-------------------------4970 sample_num
```sql
SELECT AVG(age) AS average_age
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE g.games_year = 1992 AND g.season = 'Summer';
```
-------------------------4971 sample_num
```sql
SELECT games_year
FROM games
WHERE season = 'Summer'
GROUP BY games_year
HAVING COUNT(games_name) = 1;
```
-------------------------4972 sample_num
```sql
SELECT COUNT(*) 
FROM games 
WHERE games_year BETWEEN 1990 AND 1999;
```
-------------------------4973 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS athlete_count
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
WHERE g.games_name = '2014 Winter';
```
-------------------------4974 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) 
FROM games_competitor gc
JOIN person_region pr ON gc.person_id = pr.person_id
JOIN competitor_event ce ON gc.id = ce.competitor_id
WHERE pr.region_id = 151 AND ce.medal_id <> 4;
```
-------------------------4975 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS athlete_count
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person_region pr ON gc.person_id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE g.games_name = '2016 Summer' AND nr.region_name = 'China';
```
-------------------------4976 sample_num
```sql
SELECT COUNT(*) 
FROM competitor_event ce 
JOIN medal m ON ce.medal_id = m.id 
JOIN event e ON ce.event_id = e.id 
WHERE m.medal_name = 'Gold' AND e.event_name = 'Ice Hockey Men''s Ice Hockey';
```
-------------------------4977 sample_num
```sql
SELECT nr.region_name, COUNT(ce.medal_id) AS medal_count
FROM noc_region nr
JOIN person_region pr ON nr.id = pr.region_id
JOIN games_competitor gc ON pr.person_id = gc.person_id
JOIN competitor_event ce ON gc.id = ce.competitor_id
GROUP BY nr.region_name
ORDER BY medal_count DESC
LIMIT 1;
```
-------------------------4978 sample_num
```sql
SELECT p.full_name
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN competitor_event ce ON gc.id = ce.competitor_id
JOIN medal m ON ce.medal_id = m.id
JOIN games g ON gc.games_id = g.id
JOIN games_city gc2 ON g.id = gc2.games_id
JOIN sport s ON ce.event_id IN (SELECT id FROM event WHERE sport_id = s.id)
WHERE m.medal_name = 'Gold' AND s.sport_name = 'Cycling';
```
-------------------------4979 sample_num
```sql
SELECT m.medal_name
FROM medal m
JOIN competitor_event ce ON m.id = ce.medal_id
JOIN games_competitor gc ON ce.competitor_id = gc.id
JOIN person p ON gc.person_id = p.id
WHERE p.full_name = 'Lee Chong Wei' AND m.id <> 4;
```
-------------------------4980 sample_num
```sql
SELECT 
    DIVIDE(COUNT(gc.person_id) FILTER (WHERE p.gender = 'F' AND gc.age < 20), COUNT(gc.person_id)) AS percentage
FROM 
    games g
JOIN 
    games_competitor gc ON g.id = gc.games_id
JOIN 
    person p ON gc.person_id = p.id
WHERE 
    g.games_year = 2002 AND g.season = 'Winter';
```
-------------------------4981 sample_num
```sql
SELECT 
    COUNT(CASE WHEN p.gender = 'M' THEN 1 END) * 1.0 / 
    COUNT(CASE WHEN p.gender = 'F' THEN 1 END) AS male_female_ratio
FROM 
    games g
JOIN 
    games_competitor gc ON g.id = gc.games_id
JOIN 
    person p ON gc.person_id = p.id
WHERE 
    g.games_year = 2012 AND g.season = 'Summer';
```
-------------------------4982 sample_num
```sql
SELECT games_name, COUNT(person_id) AS participant_count
FROM games
JOIN games_competitor ON games.id = games_competitor.games_id
WHERE season = 'Summer'
GROUP BY games_name
HAVING participant_count = (SELECT MAX(participant_count) FROM (SELECT COUNT(person_id) AS participant_count
FROM games
JOIN games_competitor ON games.id = games_competitor.games_id
WHERE season = 'Summer'
GROUP BY games_name) AS max_participants)
   OR participant_count = (SELECT MIN(participant_count) FROM (SELECT COUNT(person_id) AS participant_count
FROM games
JOIN games_competitor ON games.id = games_competitor.games_id
WHERE season = 'Summer'
GROUP BY games_name) AS min_participants);
```
-------------------------4983 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS athlete_count
FROM games_competitor gc
JOIN person_region pr ON gc.person_id = pr.person_id
JOIN competitor_event ce ON gc.id = ce.competitor_id
WHERE pr.region_id = (SELECT id FROM noc_region WHERE region_name = 'Malaysia')
AND ce.medal_id <> 4;
```
-------------------------4984 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS overweight_athletes
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person p ON gc.person_id = p.id
JOIN sport s ON s.id = (SELECT id FROM sport WHERE sport_name = 'Canoeing')
WHERE g.games_name = '2008 Summer'
AND (p.weight / (p.height * p.height)) >= 25;
```
-------------------------4985 sample_num
```sql
SELECT AVG(p.height) AS average_height
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN competitor_event ce ON gc.id = ce.competitor_id
JOIN event e ON ce.event_id = e.id
JOIN sport s ON e.sport_id = s.id
WHERE s.sport_name = 'Basketball' AND e.event_name = 'Basketball Men''s' AND p.gender = 'M';
```
-------------------------4986 sample_num
```sql
SELECT COUNT(*) 
FROM person p
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE p.gender = 'F' AND nr.region_name = 'Philippines';
```
-------------------------4987 sample_num
```sql
SELECT nr.region_name 
FROM person p 
JOIN person_region pr ON p.id = pr.person_id 
JOIN noc_region nr ON pr.region_id = nr.id 
WHERE p.full_name = 'Yao Ming';
```
-------------------------4988 sample_num
```sql
SELECT MIN(gc.age) AS age
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
WHERE p.full_name = 'Michael Fred Phelps, II';
```
-------------------------4989 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) 
FROM games_competitor gc
JOIN person p ON gc.person_id = p.id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE p.full_name = 'Clara Hughes';
```
-------------------------4990 sample_num
```sql
SELECT COUNT(*) 
FROM competitor_event ce
JOIN games_competitor gc ON ce.competitor_id = gc.id
JOIN person p ON gc.person_id = p.id
JOIN event e ON ce.event_id = e.id
WHERE p.full_name = 'Ian James Thorpe' 
AND e.event_name = 'Swimming Men''s 200 metres Freestyle';
```
-------------------------4991 sample_num
```sql
SELECT COUNT(*) 
FROM competitor_event ce
JOIN event e ON ce.event_id = e.id
JOIN sport s ON e.sport_id = s.id
JOIN games_competitor gc ON ce.competitor_id = gc.id
JOIN person p ON gc.person_id = p.id
JOIN medal m ON ce.medal_id = m.id
WHERE p.full_name = 'Larysa Semenivna Latynina (Diriy-)' 
  AND e.event_name = 'Gymnastics Women''s Individual All-Around' 
  AND m.medal_name = 'Gold';
```
-------------------------4992 sample_num
```sql
SELECT DISTINCT c.city_name
FROM city c
JOIN games_city gc ON c.id = gc.city_id
JOIN games g ON gc.games_id = g.id
JOIN games_competitor gc2 ON g.id = gc2.games_id
JOIN person p ON gc2.person_id = p.id
WHERE p.full_name = 'Carl Lewis Borack';
```
-------------------------4993 sample_num
```sql
SELECT COUNT(*) 
FROM games g
JOIN games_city gc ON g.id = gc.games_id
JOIN city c ON gc.city_id = c.id
WHERE c.city_name = 'London';
```
-------------------------4994 sample_num
```sql
SELECT c.city_name 
FROM city c 
JOIN games_city gc ON c.id = gc.city_id 
JOIN games g ON gc.games_id = g.id 
WHERE g.games_year = 1992 AND g.games_name = 'Summer';
```
-------------------------4995 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS athlete_count
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE g.games_name = '2016 Summer' AND gc.age > 59;
```
-------------------------4996 sample_num
```sql
SELECT g.games_name
FROM games g
JOIN games_city gc ON g.id = gc.games_id
JOIN city c ON gc.city_id = c.id
JOIN games_competitor gc2 ON g.id = gc2.games_id
WHERE c.city_name = 'Los Angeles'
GROUP BY g.games_name
ORDER BY COUNT(gc2.person_id) DESC
LIMIT 1;
```
-------------------------4997 sample_num
```sql
SELECT COUNT(*) 
FROM competitor_event ce
JOIN games_competitor gc ON ce.competitor_id = gc.id
JOIN event e ON ce.event_id = e.id
WHERE gc.age = 10 AND e.event_name = 'Gymnastics Men''s Parallel Bars, Teams';
```
-------------------------4998 sample_num
```sql
SELECT AVG(gc.age) AS average_age
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
JOIN person p ON gc.person_id = p.id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE g.games_name = '2016 Summer' AND nr.region_name = 'United States of America';
```
-------------------------4999 sample_num
```sql
SELECT region_name FROM noc_region WHERE noc = 'COL';
```
-------------------------5000 sample_num
```sql
SELECT sport_name FROM sport WHERE id = 19;
```
-------------------------5001 sample_num
```sql
SELECT id FROM event WHERE event_name = 'Shooting Mixed Skeet';
```
-------------------------5002 sample_num
```sql
SELECT id FROM sport WHERE sport_name = 'hockey';
```
-------------------------5003 sample_num
```sql
SELECT weight FROM person WHERE full_name = 'Dagfinn Sverre Aarskog';
```
-------------------------5004 sample_num
```sql
SELECT id FROM city WHERE city_name = 'Rio de Janeiro';
```
-------------------------5005 sample_num
```sql
SELECT COUNT(DISTINCT ce.competitor_id) AS gold_medal_winners
FROM competitor_event ce
JOIN event e ON ce.event_id = e.id
JOIN medal m ON ce.medal_id = m.id
WHERE m.medal_name = 'Gold' AND e.event_name = 'Rowing Women''s Coxed Eights';
```
-------------------------5006 sample_num
```sql
SELECT COUNT(DISTINCT e.event_name) AS event_count
FROM event e
JOIN sport s ON e.sport_id = s.id
WHERE s.sport_name = 'Cycling';
```
-------------------------5007 sample_num
```sql
SELECT nr.region_name 
FROM person p 
JOIN person_region pr ON p.id = pr.person_id 
JOIN noc_region nr ON pr.region_id = nr.id 
WHERE p.full_name = 'Vijay Singh Chauhan';
```
-------------------------5008 sample_num
```sql
SELECT g.games_year 
FROM games g 
JOIN games_city gc ON g.id = gc.games_id 
JOIN city c ON gc.city_id = c.id 
WHERE c.city_name = 'Roma';
```
-------------------------5009 sample_num
```sql
SELECT COUNT(*) 
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE gc.age = 20 AND g.games_name = '1984 Summer';
```
-------------------------5010 sample_num
```sql
SELECT COUNT(DISTINCT gc.games_id) AS games_participated
FROM games_competitor gc
JOIN person p ON gc.person_id = p.id
WHERE p.full_name = 'Prithipal Singh';
```
-------------------------5011 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS athlete_count
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE g.games_name = '1984 Summer' AND gc.age > 50;
```
-------------------------5012 sample_num
```sql
SELECT COUNT(DISTINCT e.event_name) AS event_count
FROM event e
JOIN sport s ON e.sport_id = s.id
WHERE s.sport_name = 'Athletics';
```
-------------------------5013 sample_num
```sql
SELECT p.full_name 
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE nr.region_name = 'Russia'
ORDER BY p.weight DESC
LIMIT 1;
```
-------------------------5014 sample_num
```sql
SELECT MAX(p.height) 
FROM person p 
JOIN games_competitor gc ON p.id = gc.person_id 
JOIN person_region pr ON p.id = pr.person_id 
JOIN noc_region nr ON pr.region_id = nr.id 
WHERE nr.region_name = 'Portugal';
```
-------------------------5015 sample_num
```sql
SELECT c.city_name 
FROM city c 
JOIN games_city gc ON c.id = gc.city_id 
JOIN games g ON gc.games_id = g.id 
WHERE g.games_name = '1968 Winter';
```
-------------------------5016 sample_num
```sql
SELECT r.region_name
FROM person_region pr
JOIN noc_region r ON pr.region_id = r.id
GROUP BY r.region_name
ORDER BY COUNT(pr.person_id) DESC
LIMIT 1;
```
-------------------------5017 sample_num
```sql
SELECT 
    DIVIDE(COUNT(CASE WHEN p.height > 175 THEN p.id END), COUNT(p.id)) * 100 AS percentage
FROM 
    person p
JOIN 
    person_region pr ON p.id = pr.person_id
JOIN 
    noc_region nr ON pr.region_id = nr.id
WHERE 
    nr.region_name = 'Vanuatu';
```
-------------------------5018 sample_num
```sql
SELECT AVG(p.weight) 
FROM person p 
JOIN games_competitor gc ON p.id = gc.person_id 
JOIN person_region pr ON p.id = pr.person_id 
JOIN noc_region nr ON pr.region_id = nr.id 
WHERE nr.region_name = 'Tonga' AND p.gender = 'M';
```
-------------------------5019 sample_num
```sql
SELECT c.city_name 
FROM games g 
JOIN games_city gc ON g.id = gc.games_id 
JOIN city c ON gc.city_id = c.id 
WHERE g.games_name = '1920 Summer';
```
-------------------------5020 sample_num
```sql
SELECT COUNT(*) 
FROM games g
JOIN games_city gc ON g.id = gc.games_id
JOIN city c ON gc.city_id = c.id
WHERE g.games_year BETWEEN 1900 AND 1992 AND c.city_name = 'London';
```
-------------------------5021 sample_num
```sql
SELECT COUNT(*) 
FROM games g 
JOIN games_city gc ON g.id = gc.games_id 
JOIN city c ON gc.city_id = c.id 
WHERE g.season = 'Summer' AND c.city_name = 'Paris';
```
-------------------------5022 sample_num
```sql
SELECT g.games_name 
FROM games g
JOIN games_city gc ON g.id = gc.games_id
JOIN city c ON gc.city_id = c.id
WHERE c.city_name = 'Los Angeles';
```
-------------------------5023 sample_num
```sql
SELECT c.city_name
FROM city c
JOIN games_city gc ON c.id = gc.city_id
JOIN games g ON gc.games_id = g.id
GROUP BY c.city_name
ORDER BY COUNT(g.id) DESC
LIMIT 1;
```
-------------------------5024 sample_num
```sql
SELECT g.games_name 
FROM games g 
JOIN games_city gc ON g.id = gc.games_id 
JOIN city c ON gc.city_id = c.id 
WHERE c.city_name = 'Beijing' AND g.games_year = 2008;
```
-------------------------5025 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN gc.age > 30 THEN ce.competitor_id END) * 100.0 / COUNT(ce.competitor_id)) AS percentage
FROM 
    competitor_event ce
JOIN 
    games_competitor gc ON ce.competitor_id = gc.id
WHERE 
    ce.medal_id = 1;
```
-------------------------5026 sample_num
```sql
SELECT gc.age 
FROM games g 
JOIN games_competitor gc ON g.id = gc.games_id 
JOIN person p ON gc.person_id = p.id 
WHERE p.full_name = 'A Lamusi' AND g.games_name = '2012 Summer';
```
-------------------------5027 sample_num
```sql
SELECT COUNT(*) 
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE g.games_name = '2000 Summer' AND gc.age = 31;
```
-------------------------5028 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS male_competitors
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person p ON gc.person_id = p.id
WHERE g.games_year = 1948 AND g.season = 'Summer' AND p.gender = 'M';
```
-------------------------5029 sample_num
```sql
SELECT p.full_name
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN games g ON gc.games_id = g.id
WHERE g.games_name = '1936 Summer';
```
-------------------------5030 sample_num
```sql
SELECT p.full_name
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN games g ON gc.games_id = g.id
WHERE g.games_name = '2014 Winter'
ORDER BY gc.age ASC
LIMIT 1;
```
-------------------------5031 sample_num
```sql
SELECT AVG(gc.age) AS average_age
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE g.games_year = 1988 AND g.games_name = 'Winter';
```
-------------------------5032 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.gender = 'F' AND p.height > 170 THEN p.id END) * 100.0 / COUNT(p.id)) AS percentage
FROM 
    person p
JOIN 
    games_competitor gc ON p.id = gc.person_id
JOIN 
    games g ON gc.games_id = g.id
WHERE 
    g.games_year = 1988;
```
-------------------------5033 sample_num
```sql
SELECT s.sport_name 
FROM event e 
JOIN sport s ON e.sport_id = s.id 
WHERE e.event_name = 'Cross Country Skiing Men''s 10/15 kilometres Pursuit';
```
-------------------------5034 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN g.season = 'Winter' AND gc.age > 24 THEN 1 END) * 100.0 / COUNT(gc.person_id)) AS percentage
FROM 
    games_competitor gc
JOIN 
    games g ON gc.games_id = g.id
JOIN 
    person p ON gc.person_id = p.id;
```
-------------------------5035 sample_num
```sql
SELECT pr.region_id 
FROM person p 
JOIN person_region pr ON p.id = pr.person_id 
WHERE p.full_name = 'Christine Jacoba Aaftink';
```
-------------------------5036 sample_num
```sql
SELECT p.height 
FROM person p
JOIN person_region pr ON p.id = pr.person_id
WHERE pr.region_id = 7;
```
-------------------------5037 sample_num
```sql
SELECT c.city_name 
FROM city c 
JOIN games_city gc ON c.id = gc.city_id 
WHERE gc.games_id = 3;
```
-------------------------5038 sample_num
```sql
SELECT g.id 
FROM games g
JOIN games_city gc ON g.id = gc.games_id
JOIN city c ON gc.city_id = c.id
WHERE c.city_name = 'London';
```
-------------------------5039 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS num_people
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE gc.age < 30 AND g.season = 'Summer';
```
-------------------------5040 sample_num
```sql
SELECT g.games_name
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
WHERE g.id = 13;
```
-------------------------5041 sample_num
```sql
SELECT AVG(gc.age) AS average_age
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE g.season = 'Winter';
```
-------------------------5042 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN gc.age < 35 THEN 1 END) * 100.0 / COUNT(gc.person_id)) AS percentage
FROM 
    games_competitor gc
JOIN 
    games g ON gc.games_id = g.id
WHERE 
    g.season = 'Summer';
```
-------------------------5043 sample_num
```sql
SELECT event_name 
FROM event 
WHERE sport_id = (SELECT id FROM sport WHERE sport_name = 'Basketball');
```
-------------------------5044 sample_num
```sql
SELECT m.medal_name 
FROM competitor_event ce 
JOIN medal m ON ce.medal_id = m.id 
WHERE ce.competitor_id = 9;
```
-------------------------5045 sample_num
```sql
SELECT DISTINCT competitor_event.event_id
FROM competitor_event
JOIN medal ON competitor_event.medal_id = medal.id
WHERE medal.medal_name = 'Gold';
```
-------------------------5046 sample_num
```sql
SELECT full_name 
FROM person 
WHERE weight = (SELECT MAX(weight) FROM person);
```
-------------------------5047 sample_num
```sql
SELECT c.city_name 
FROM city c 
JOIN games_city gc ON c.id = gc.city_id 
JOIN games g ON gc.games_id = g.id 
WHERE g.games_year = 1992;
```
-------------------------5048 sample_num
```sql
SELECT region_name
FROM person_region pr
JOIN noc_region nr ON pr.region_id = nr.id
GROUP BY region_name
ORDER BY COUNT(pr.person_id) DESC
LIMIT 1;
```
-------------------------5049 sample_num
```sql
SELECT full_name 
FROM person 
JOIN games_competitor ON person.id = games_competitor.person_id 
WHERE age = (SELECT MAX(age) FROM games_competitor);
```
-------------------------5050 sample_num
```sql
SELECT s.sport_name
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN competitor_event ce ON gc.id = ce.competitor_id
JOIN event e ON ce.event_id = e.id
JOIN sport s ON e.sport_id = s.id
WHERE p.full_name = 'John Aalberg';
```
-------------------------5051 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS belgian_men_count
FROM games_competitor gc
JOIN person p ON gc.person_id = p.id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE p.gender = 'M' AND nr.region_name = 'Belgium';
```
-------------------------5052 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) AS athlete_count
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
JOIN games_city gc2 ON g.id = gc2.games_id
JOIN city c ON gc2.city_id = c.id
WHERE c.city_name = 'Barcelona';
```
-------------------------5053 sample_num
```sql
SELECT COUNT(DISTINCT e.event_name) AS different_football_events
FROM event e
JOIN sport s ON e.sport_id = s.id
WHERE s.sport_name = 'Football';
```
-------------------------5054 sample_num
```sql
SELECT DISTINCT c.city_name
FROM city c
JOIN games_city gc ON c.id = gc.city_id
JOIN games g ON gc.games_id = g.id
JOIN games_competitor gc2 ON g.id = gc2.games_id
JOIN person p ON gc2.person_id = p.id
WHERE p.full_name = 'John Aalberg';
```
-------------------------5055 sample_num
```sql
SELECT COUNT(g.id) 
FROM games g 
JOIN games_city gc ON g.id = gc.games_id 
JOIN city c ON gc.city_id = c.id 
WHERE c.city_name = 'Barcelona';
```
-------------------------5056 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) 
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE g.games_name = '1992 Winter' AND gc.age > 30;
```
-------------------------5057 sample_num
```sql
SELECT g.games_name
FROM games g
JOIN games_city gc ON g.id = gc.games_id
JOIN games_competitor gc2 ON g.id = gc2.games_id
WHERE gc.city_id = (SELECT id FROM city WHERE city_name = 'Barcelona')
GROUP BY g.games_name
ORDER BY COUNT(gc2.person_id) DESC
LIMIT 1;
```
-------------------------5058 sample_num
```sql
SELECT p.full_name 
FROM person p
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE nr.region_name = 'Argentina';
```
-------------------------5059 sample_num
```sql
SELECT AVG(gc.age) AS average_age
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
JOIN person_region pr ON gc.person_id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE g.games_name = '2012 Summer' AND nr.region_name = 'Argentina';
```
-------------------------5060 sample_num
```sql
SELECT 
    DIVIDE(COUNT(ce.competitor_id) FILTER (WHERE m.medal_name = 'Bronze'), COUNT(ce.competitor_id)) AS percentage
FROM 
    competitor_event ce
JOIN 
    event e ON ce.event_id = e.id
JOIN 
    medal m ON ce.medal_id = m.id
WHERE 
    e.event_name = 'Basketball Men''s Basketball';
```
-------------------------5061 sample_num
```sql
SELECT g.games_name
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person p ON gc.person_id = p.id
WHERE p.full_name = 'Georgios Abaris';
```
-------------------------5062 sample_num
```sql
SELECT p.full_name 
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE nr.region_name = 'Greece';
```
-------------------------5063 sample_num
```sql
SELECT AVG(gc.age) AS average_age
FROM games_competitor gc
JOIN games g ON gc.games_id = g.id
WHERE g.games_name = '1924 Winter';
```
-------------------------5064 sample_num
```sql
SELECT DISTINCT noc_region.noc
FROM person
JOIN games_competitor ON person.id = games_competitor.person_id
JOIN person_region ON person.id = person_region.person_id
JOIN noc_region ON person_region.region_id = noc_region.id
WHERE person.weight = 77;
```
-------------------------5065 sample_num
```sql
SELECT g.games_name 
FROM games g 
JOIN games_city gc ON g.id = gc.games_id 
JOIN city c ON gc.city_id = c.id 
WHERE c.city_name = 'Paris';
```
-------------------------5066 sample_num
```sql
SELECT p.full_name
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN games g ON gc.games_id = g.id
WHERE g.games_name = '2000 Summer';
```
-------------------------5067 sample_num
```sql
SELECT c.city_name
FROM city c
JOIN games_city gc ON c.id = gc.city_id
JOIN games g ON gc.games_id = g.id
JOIN games_competitor gc2 ON g.id = gc2.games_id
WHERE gc2.age = (SELECT MAX(age) FROM games_competitor)
```
-------------------------5068 sample_num
```sql
SELECT p.full_name 
FROM person p 
JOIN games_competitor gc ON p.id = gc.person_id 
WHERE gc.age = (SELECT MIN(age) FROM games_competitor);
```
-------------------------5069 sample_num
```sql
SELECT g.id 
FROM games g
JOIN games_city gc ON g.id = gc.games_id
JOIN city c ON gc.city_id = c.id
WHERE c.city_name = 'Tokyo';
```
-------------------------5070 sample_num
```sql
SELECT noc_region.noc, noc_region.region_name
FROM person
JOIN games_competitor ON person.id = games_competitor.person_id
JOIN person_region ON person.id = person_region.person_id
JOIN noc_region ON person_region.region_id = noc_region.id
WHERE person.weight = (SELECT MAX(weight) FROM person);
```
-------------------------5071 sample_num
```sql
SELECT g.games_year, g.season
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person p ON gc.person_id = p.id
WHERE p.full_name = 'Sohail Abbas';
```
-------------------------5072 sample_num
```sql
SELECT AVG(p.weight) 
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN competitor_event ce ON gc.id = ce.competitor_id
JOIN medal m ON ce.medal_id = m.id
WHERE m.medal_name = 'Silver';
```
-------------------------5073 sample_num
```sql
SELECT c.city_name 
FROM city c 
JOIN games_city gc ON c.id = gc.city_id 
JOIN games g ON gc.games_id = g.id 
WHERE g.games_name = '2004 Summer';
```
-------------------------5074 sample_num
```sql
SELECT g.season
FROM games g
JOIN games_competitor gc ON g.id = gc.games_id
JOIN person p ON gc.person_id = p.id
WHERE p.height = 180 AND p.weight = 73;
```
-------------------------5075 sample_num
```sql
SELECT p.full_name
FROM person p
JOIN games_competitor gc ON p.id = gc.person_id
JOIN competitor_event ce ON gc.id = ce.competitor_id
JOIN medal m ON ce.medal_id = m.id
WHERE m.medal_name = 'Gold';
```
-------------------------5076 sample_num
```sql
SELECT AVG(height) 
FROM person 
JOIN games_competitor ON person.id = games_competitor.person_id 
WHERE age BETWEEN 22 AND 28;
```
-------------------------5077 sample_num
```sql
SELECT COUNT(DISTINCT gc.person_id) 
FROM games_competitor gc
JOIN person p ON gc.person_id = p.id
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE p.gender = 'F' AND nr.region_name = 'Iran';
```
-------------------------5078 sample_num
```sql
SELECT age FROM person 
WHERE height = (SELECT MAX(height) FROM person);
```
-------------------------5079 sample_num
```sql
SELECT 
    COUNT(CASE WHEN weight > 70 THEN 1 END) - COUNT(CASE WHEN weight < 70 THEN 1 END) AS weight_difference
FROM 
    games_competitor gc
JOIN 
    person p ON gc.person_id = p.id
WHERE 
    gc.age <= 24;
```
-------------------------5080 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN gc.age = 28 THEN 1 END) * 100.0 / COUNT(gc.id)) AS percentage
FROM 
    games g
JOIN 
    games_competitor gc ON g.id = gc.games_id
WHERE 
    g.games_name = '2014 Winter';
```
-------------------------5081 sample_num
```sql
SELECT DISTINCT nr.region_name
FROM person p
JOIN person_region pr ON p.id = pr.person_id
JOIN noc_region nr ON pr.region_id = nr.id
WHERE p.gender = 'M' AND p.height > (SELECT AVG(height) * 0.87 FROM person);
```
-------------------------5082 sample_num
```sql
SELECT SUM(zip_data.households) AS total_households
FROM zip_data
JOIN country ON zip_data.zip_code = country.zip_code
WHERE country.county = 'ARECIBO';
```
-------------------------5083 sample_num
```sql
SELECT zip_code 
FROM zip_data 
WHERE county_fips = (SELECT county_fips FROM country WHERE county = 'ARECIBO') 
ORDER BY avg_house_value DESC 
LIMIT 1;
```
-------------------------5084 sample_num
```sql
SELECT SUM(z.male_population) AS total_males
FROM zip_data z
JOIN country c ON z.zip_code = c.zip_code
WHERE c.county = 'ARECIBO';
```
-------------------------5085 sample_num
```sql
SELECT COUNT(*) 
FROM zip_data 
WHERE state = 'Delaware' AND daylight_savings = 'Yes';
```
-------------------------5086 sample_num
```sql
SELECT zip_code 
FROM zip_data 
WHERE county_fips = (SELECT county_fips FROM country WHERE county = 'ARECIBO') 
ORDER BY white_population DESC 
LIMIT 1;
```
-------------------------5087 sample_num
```sql
SELECT c.county
FROM zip_data zd
JOIN country c ON zd.zip_code = c.zip_code
WHERE zd.avg_income_per_household = (
    SELECT MAX(avg_income_per_household)
    FROM zip_data
);
```
-------------------------5088 sample_num
```sql
SELECT DISTINCT c.county
FROM country c
JOIN zip_data z ON c.zip_code = z.zip_code
WHERE z.daylight_savings = 'Yes';
```
-------------------------5089 sample_num
```sql
SELECT z.zip_code
FROM zip_data z
JOIN country c ON z.zip_code = c.zip_code
WHERE c.county = 'HUNTINGDON' AND z.employees > 30;
```
-------------------------5090 sample_num
```sql
SELECT z.asian_population
FROM zip_data z
JOIN avoid a ON z.zip_code = a.zip_code
WHERE a.bad_alias = 'URB San Joaquin';
```
-------------------------5091 sample_num
```sql
SELECT COUNT(DISTINCT z.zip_code) 
FROM zip_data z 
JOIN avoid a ON z.zip_code = a.zip_code 
WHERE a.bad_alias = 'Internal Revenue Service' 
AND z.time_zone = 'Eastern';
```
-------------------------5092 sample_num
```sql
SELECT a.bad_alias
FROM alias a
JOIN zip_data z ON a.zip_code = z.zip_code
WHERE z.avg_house_value = (SELECT MAX(avg_house_value) FROM zip_data);
```
-------------------------5093 sample_num
```sql
SELECT a.bad_alias
FROM zip_data z
JOIN avoid a ON z.zip_code = a.zip_code
WHERE z.median_female_age > 32;
```
-------------------------5094 sample_num
```sql
SELECT MAX(male_population / female_population) AS highest_gender_ratio
FROM zip_data
JOIN country ON zip_data.zip_code = country.zip_code
WHERE county = 'ARECIBO';
```
-------------------------5095 sample_num
```sql
SELECT AVG(female_median_age) AS average_median_female_age
FROM zip_data z
JOIN country c ON z.zip_code = c.zip_code
WHERE c.county = 'ARECIBO';
```
-------------------------5096 sample_num
```sql
SELECT ac.area_code
FROM zip_data zd
JOIN area_code ac ON zd.zip_code = ac.zip_code
WHERE zd.female_median_age > 32;
```
-------------------------5097 sample_num
```sql
SELECT a.alias 
FROM zip_data z 
JOIN alias a ON z.zip_code = a.zip_code 
WHERE z.city = 'Hartford';
```
-------------------------5098 sample_num
```sql
SELECT COUNT(DISTINCT county) 
FROM country 
WHERE state = 'Alabama';
```
-------------------------5099 sample_num
```sql
SELECT COUNT(*) 
FROM zip_data 
WHERE state = 'NY' AND type = 'Post Office';
```
-------------------------5100 sample_num
```sql
SELECT z.city, z.latitude, z.longitude
FROM zip_data z
JOIN area_code a ON z.zip_code = a.zip_code
WHERE a.area_code = '787';
```
-------------------------5101 sample_num
```sql
SELECT total_delivery_receptacles
FROM zip_data
WHERE state = 'CA' AND type = 'Community Post Office'
ORDER BY total_delivery_receptacles DESC
LIMIT 1;
```
-------------------------5102 sample_num
```sql
SELECT c.county
FROM zip_data z
JOIN country c ON z.zip_code = c.zip_code
WHERE z.female_population = (SELECT MAX(female_population) FROM zip_data);
```
-------------------------5103 sample_num
```sql
SELECT DISTINCT s.name
FROM state s
JOIN zip_data z ON s.abbreviation = z.state
WHERE z.division IS NULL;
```
-------------------------5104 sample_num
```sql
SELECT 
    MAX(population_2020) - MAX(population_2010) AS population_difference
FROM 
    zip_data 
WHERE 
    zip_code IN (
        SELECT 
            zip_code 
        FROM 
            zip_congress 
        WHERE 
            district IN (
                SELECT 
                    District 
                FROM 
                    congress 
                WHERE 
                    state = 'PA' 
                    AND House = 'Representative' 
                    AND abbreviation = 'PA'
            )
    )
    AND zip_code IN (
        SELECT 
            CBSA 
        FROM 
            CBSA 
        WHERE 
            CBSA_name = 'Allentown-Bethlehem-Easton, PA-NJ'
    );
```
-------------------------5105 sample_num
```sql
SELECT zip_code 
FROM country 
WHERE county = 'NEW CASTLE' AND state = 'Delaware';
```
-------------------------5106 sample_num
```sql
SELECT COUNT(*) AS representative_count
FROM congress
WHERE state = (
    SELECT state
    FROM zip_data
    ORDER BY monthly_benefits_retired_workers DESC
    LIMIT 1
);
```
-------------------------5107 sample_num
```sql
SELECT COUNT(DISTINCT z.city) AS city_count
FROM zip_data z
JOIN congress c ON z.zip_code = c.zip_code
WHERE c.first_name = 'Lisa' AND c.last_name = 'Murkowski' AND z.employees = 0;
```
-------------------------5108 sample_num
```sql
SELECT c.first_name, c.last_name
FROM congress c
JOIN (
    SELECT z.state, SUM(z.asian_population) AS total_asian_population
    FROM zip_data z
    GROUP BY z.state
    ORDER BY total_asian_population DESC
    LIMIT 3
) AS top_states ON c.abbreviation = top_states.state;
```
-------------------------5109 sample_num
```sql
SELECT state.name 
FROM country 
WHERE county = 'Outagamie';
```
-------------------------5110 sample_num
```sql
SELECT c.party 
FROM zip_data z 
JOIN zip_congress zc ON z.zip_code = zc.zip_code 
JOIN congress c ON zc.district = c.District AND c.state = z.state 
WHERE z.zip_code = '91701';
```
-------------------------5111 sample_num
```sql
SELECT SUM(zip_data.male_population) AS total_males
FROM zip_data
JOIN country ON zip_data.zip_code = country.zip_code
WHERE country.county = 'NEW HAVEN';
```
-------------------------5112 sample_num
```sql
SELECT a.alias 
FROM zip_data z 
JOIN alias a ON z.zip_code = a.zip_code 
WHERE z.latitude = 18.090875 AND z.longitude = -66.867756;
```
-------------------------5113 sample_num
```sql
SELECT ac.area_code
FROM zip_data zd
JOIN area_code ac ON zd.zip_code = ac.zip_code
WHERE zd.city = (
    SELECT city
    FROM zip_data
    ORDER BY over_65 DESC
    LIMIT 1
);
```
-------------------------5114 sample_num
```sql
SELECT COUNT(a.bad_alias) AS bad_alias_count
FROM congress c
JOIN zip_congress zc ON c.District = zc.district
JOIN zip_data zd ON zc.zip_code = zd.zip_code
JOIN avoid a ON zd.zip_code = a.zip_code
WHERE c.first_name = 'Thompson' AND c.last_name = 'Bennie' AND c.party = 'G';
```
-------------------------5115 sample_num
```sql
SELECT z.latitude, z.longitude
FROM zip_data z
JOIN area_code a ON z.zip_code = a.zip_code
WHERE a.area_code = '636';
```
-------------------------5116 sample_num
```sql
SELECT z.zip_code
FROM congress c
JOIN zip_congress zc ON c.District = zc.district
JOIN zip_data z ON zc.zip_code = z.zip_code
WHERE c.first_name = 'Buchanan' AND c.last_name = 'Vernon';
```
-------------------------5117 sample_num
```sql
SELECT s.name 
FROM area_code ac 
JOIN zip_data z ON ac.zip_code = z.zip_code 
JOIN state s ON z.state = s.abbreviation 
WHERE ac.area_code = '878';
```
-------------------------5118 sample_num
```sql
SELECT COUNT(DISTINCT county) AS county_count
FROM country
WHERE state = 'Virginia';
```
-------------------------5119 sample_num
```sql
SELECT CBSA_name, latitude, longitude 
FROM CBSA 
JOIN zip_data ON CBSA.CBSA = zip_data.CBSA 
WHERE zip_data.zip_code = '45503';
```
-------------------------5120 sample_num
```sql
SELECT country.county 
FROM congress 
JOIN zip_congress ON congress.District = zip_congress.district 
JOIN country ON zip_congress.zip_code = country.zip_code 
WHERE congress.first_name = 'Vicky' AND congress.last_name = 'Hartzler';
```
-------------------------5121 sample_num
```sql
SELECT AVG(male_median_age) AS average_male_median_age
FROM zip_data z
JOIN country c ON z.zip_code = c.zip_code
WHERE c.county = 'WINDHAM';
```
-------------------------5122 sample_num
```sql
SELECT AVG(zd.female_median_age) AS average_female_median_age
FROM congress c
JOIN zip_congress zc ON c.District = zc.district
JOIN zip_data zd ON zc.zip_code = zd.zip_code
JOIN country co ON zd.zip_code = co.zip_code
WHERE c.first_name = 'Ron' AND c.last_name = 'DeSantis';
```
-------------------------5123 sample_num
```sql
SELECT ac.area_code 
FROM zip_data zd 
JOIN area_code ac ON zd.zip_code = ac.zip_code 
WHERE zd.city = 'Bishopville' AND zd.state = 'SC';
```
-------------------------5124 sample_num
```sql
SELECT a.bad_alias 
FROM zip_data z 
JOIN avoid a ON z.zip_code = a.zip_code 
WHERE z.city = 'Geneva' AND z.state = 'AL';
```
-------------------------5125 sample_num
```sql
SELECT z.city, z.state 
FROM zip_data z 
JOIN avoid a ON z.zip_code = a.zip_code 
WHERE a.bad_alias = 'Lawrenceville';
```
-------------------------5126 sample_num
```sql
SELECT a.alias, av.bad_alias 
FROM alias a 
JOIN avoid av ON a.zip_code = av.zip_code 
WHERE a.zip_code = '38015';
```
-------------------------5127 sample_num
```sql
SELECT z.zip_code
FROM congress c
JOIN zip_congress zc ON c.District = zc.district
JOIN zip_data z ON zc.zip_code = z.zip_code
WHERE c.first_name = 'Steven' AND c.last_name = 'King';
```
-------------------------5128 sample_num
```sql
SELECT CBSA_name, CBSA_type 
FROM CBSA 
WHERE CBSA IN (
    SELECT CBSA 
    FROM zip_data 
    WHERE city = 'York' AND state = 'ME'
);
```
-------------------------5129 sample_num
```sql
SELECT z.city, z.zip_code, a.area_code
FROM zip_data z
JOIN area_code a ON z.zip_code = a.zip_code
WHERE z.median_age > 40
LIMIT 10;
```
-------------------------5130 sample_num
```sql
SELECT country.county 
FROM avoid 
JOIN country ON avoid.zip_code = country.zip_code 
WHERE avoid.bad_alias = 'Druid Hills';
```
-------------------------5131 sample_num
```sql
SELECT ac.area_code
FROM area_code ac
JOIN zip_data zd ON ac.zip_code = zd.zip_code
JOIN country c ON zd.zip_code = c.zip_code
WHERE c.county = 'Phillips' AND c.state = 'Montana';
```
-------------------------5132 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name, z.zip_code
FROM congress c
JOIN zip_congress zc ON c.District = zc.district
JOIN zip_data z ON zc.zip_code = z.zip_code
WHERE c.state = 'Wisconsin'
ORDER BY z.land_area DESC
LIMIT 1;
```
-------------------------5133 sample_num
```sql
SELECT DISTINCT s.name
FROM state s
JOIN zip_data z ON s.abbreviation = z.state
WHERE z.time_zone = 'Central';
```
-------------------------5134 sample_num
```sql
SELECT z.city, z.state
FROM zip_data z
JOIN CBSA c ON z.CBSA = c.CBSA
WHERE c.CBSA_name = 'Lexington-Fayette, KY'
LIMIT 10;
```
-------------------------5135 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN party = 'Democrat' THEN 1 END) * 100.0 / NULLIF(COUNT(CASE WHEN party = 'Republican' THEN 1 END), 0)) AS percentage_ratio,
    z.zip_code
FROM 
    congress c
JOIN 
    zip_data z ON c.abbreviation = z.state
WHERE 
    z.state = 'IN' AND 
    c.party = 'Democrat'
GROUP BY 
    z.zip_code;
```
-------------------------5136 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM congress WHERE state = 'Alabama') * 1.0 / 
    (SELECT COUNT(*) FROM congress WHERE state = 'Illinois') AS ratio;
```
-------------------------5137 sample_num
```sql
SELECT zip_code, AVG(population_2020) AS average_population_2020
FROM zip_data
GROUP BY zip_code;
```
-------------------------5138 sample_num
```sql
SELECT zd.male_population
FROM zip_data zd
JOIN CBSA c ON zd.CBSA = c.CBSA
WHERE c.CBSA_name = 'Berlin, NH';
```
-------------------------5139 sample_num
```sql
SELECT CBSA, CBSA_name
FROM zip_data
GROUP BY CBSA, CBSA_name
HAVING COUNT(zip_code) > 10;
```
-------------------------5140 sample_num
```sql
SELECT a.bad_alias 
FROM alias a 
JOIN zip_data z ON a.zip_code = z.zip_code 
WHERE z.state = 'PR';
```
-------------------------5141 sample_num
```sql
SELECT z.longitude, z.latitude
FROM congress c
JOIN zip_congress zc ON c.District = zc.district
JOIN zip_data z ON zc.zip_code = z.zip_code
WHERE c.first_name = 'Alan' AND c.last_name = 'Grayson';
```
-------------------------5142 sample_num
```sql
SELECT state 
FROM area_code 
JOIN zip_data ON area_code.zip_code = zip_data.zip_code 
WHERE area_code = '787';
```
-------------------------5143 sample_num
```sql
SELECT DISTINCT c.first_name, c.last_name
FROM congress c
JOIN zip_congress zc ON c.District = zc.district
JOIN zip_data zd ON zc.zip_code = zd.zip_code
WHERE zd.population_2020 > 30000;
```
-------------------------5144 sample_num
```sql
SELECT zip_code
FROM area_code
WHERE zip_code IN (
    SELECT zip_code
    FROM zip_data
    WHERE state = 'Massachusetts'
)
GROUP BY zip_code
HAVING COUNT(area_code) > 1;
```
-------------------------5145 sample_num
```sql
SELECT country.county 
FROM zip_data 
JOIN country ON zip_data.zip_code = country.zip_code 
WHERE zip_data.city = 'Arecibo';
```
-------------------------5146 sample_num
```sql
SELECT COUNT(DISTINCT z.zip_code) 
FROM zip_data z 
JOIN CBSA c ON z.CBSA = c.CBSA 
WHERE c.CBSA_name = 'Barre, VT';
```
-------------------------5147 sample_num
```sql
SELECT zip_code 
FROM zip_data 
WHERE county_fips = (SELECT county_fips FROM country WHERE county = 'Saint Croix') 
ORDER BY land_area DESC 
LIMIT 1;
```
-------------------------5148 sample_num
```sql
SELECT zc.district, (zd.population_2020 - zd.population_2010) AS population_difference
FROM congress c
JOIN zip_congress zc ON c.District = zc.district
JOIN zip_data zd ON zc.zip_code = zd.zip_code
WHERE c.first_name = 'Tim' AND c.last_name = 'Griffin';
```
-------------------------5149 sample_num
```sql
SELECT (zd.asian_population / zd.population_2020) * 100 AS asian_population_percentage
FROM zip_data zd
JOIN CBSA c ON zd.CBSA = c.CBSA
WHERE c.CBSA_name = 'Atmore, AL';
```
-------------------------5150 sample_num
```sql
SELECT city, MAX(asian_population) AS highest_asian_population
FROM zip_data
WHERE zip_code IN (SELECT zip_code FROM area_code WHERE area_code = '939')
GROUP BY city
ORDER BY highest_asian_population DESC
LIMIT 1;
```
-------------------------5151 sample_num
```sql
SELECT country.name AS country_name, state.name AS state_name
FROM zip_data
JOIN country ON zip_data.zip_code = country.zip_code
JOIN state ON zip_data.state = state.abbreviation
WHERE zip_data.elevation = 1039;
```
-------------------------5152 sample_num
```sql
SELECT a.alias, z.elevation
FROM alias a
JOIN zip_data z ON a.zip_code = z.zip_code
WHERE z.zip_code = '1028';
```
-------------------------5153 sample_num
```sql
SELECT ac.area_code
FROM zip_data zd
JOIN area_code ac ON zd.zip_code = ac.zip_code
WHERE zd.land_area = (SELECT MAX(land_area) FROM zip_data);
```
-------------------------5154 sample_num
```sql
SELECT ac.area_code
FROM zip_data zd
JOIN area_code ac ON zd.zip_code = ac.zip_code
WHERE zd.white_population BETWEEN 1700 AND 2000;
```
-------------------------5155 sample_num
```sql
SELECT z.asian_population
FROM zip_data z
JOIN alias a ON z.zip_code = a.zip_code
WHERE a.alias = 'Leeds';
```
-------------------------5156 sample_num
```sql
SELECT ac.area_code, c.country
FROM zip_data z
JOIN area_code ac ON z.zip_code = ac.zip_code
JOIN country c ON z.zip_code = c.zip_code
WHERE z.city = 'Savoy';
```
-------------------------5157 sample_num
```sql
SELECT a.alias
FROM zip_data z
JOIN alias a ON z.zip_code = a.zip_code
WHERE z.population_2010 = 0;
```
-------------------------5158 sample_num
```sql
SELECT COUNT(DISTINCT z.city) AS cities_with_daylight_savings
FROM zip_data z
JOIN area_code a ON z.zip_code = a.zip_code
WHERE a.area_code = '608' AND z.daylight_savings = 'Yes';
```
-------------------------5159 sample_num
```sql
SELECT AVG(z.elevation) 
FROM zip_data z 
JOIN alias a ON z.zip_code = a.zip_code 
WHERE a.alias = 'Amherst';
```
-------------------------5160 sample_num
```sql
SELECT country.state, country.county
FROM zip_data
JOIN country ON zip_data.zip_code = country.zip_code
WHERE zip_data.city = 'Dalton';
```
-------------------------5161 sample_num
```sql
SELECT DISTINCT a.alias
FROM alias a
JOIN zip_data z ON a.zip_code = z.zip_code
WHERE z.type = 'Post Office'
LIMIT 5;
```
-------------------------5162 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN type = 'P.O. Box Only' THEN 1 END) - 
     COUNT(CASE WHEN type = 'Post Office' THEN 1 END)) AS difference
FROM 
    zip_data
JOIN 
    area_code ON zip_data.zip_code = area_code.zip_code
WHERE 
    area_code.area_code = '787';
```
-------------------------5163 sample_num
```sql
SELECT 
    (SUM(population_2020) - SUM(population_2010)) * 100.0 / SUM(population_2010) AS percentage_increase
FROM 
    zip_data 
JOIN 
    country ON zip_data.zip_code = country.zip_code 
WHERE 
    country.county = 'ARROYO';
```
-------------------------5164 sample_num
```sql
SELECT zip_code, city 
FROM zip_data 
WHERE state = 'Texas' AND total_beneficiaries > 10000;
```
-------------------------5165 sample_num
```sql
SELECT COUNT(*) 
FROM zip_data 
WHERE state = 'DC' 
AND black_population > 20000;
```
-------------------------5166 sample_num
```sql
SELECT z.city, a.alias
FROM zip_data z
JOIN alias a ON z.zip_code = a.zip_code
WHERE z.zip_code = '19019';
```
-------------------------5167 sample_num
```sql
SELECT a.bad_alias 
FROM alias a 
JOIN zip_data z ON a.zip_code = z.zip_code 
WHERE z.city = 'Camuy';
```
-------------------------5168 sample_num
```sql
SELECT z.zip_code, z.city, CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM zip_data z
JOIN congress c ON z.zip_code = z.zip_code
WHERE z.population_2020 = (SELECT MAX(population_2020) FROM zip_data);
```
-------------------------5169 sample_num
```sql
SELECT COUNT(zip_code) 
FROM zip_data 
WHERE daylight_savings = 'Yes' 
AND state = 'Illinois' 
AND region = 'Midwest';
```
-------------------------5170 sample_num
```sql
SELECT country.zip_code, country.county 
FROM country 
JOIN state ON country.state = state.abbreviation 
WHERE state.name = 'Virgin Islands';
```
-------------------------5171 sample_num
```sql
SELECT z.zip_code, a.alias
FROM zip_data z
JOIN alias a ON z.zip_code = a.zip_code
WHERE z.city = 'Greeneville';
```
-------------------------5172 sample_num
```sql
SELECT 
    (SELECT COUNT(z.zip_code) 
     FROM zip_data z 
     JOIN congress c ON z.zip_code = c.zip_code 
     WHERE c.first_name = 'Smith' AND c.last_name = 'Adrian') AS Smith_Adrian_Count,
    (SELECT COUNT(z.zip_code) 
     FROM zip_data z 
     JOIN congress c ON z.zip_code = c.zip_code 
     WHERE c.first_name = 'Heck' AND c.last_name = 'Joe') AS Heck_Joe_Count
```
-------------------------5173 sample_num
```sql
SELECT z.zip_code, c.CBSA_name
FROM zip_data z
JOIN CBSA c ON z.CBSA = c.CBSA
WHERE z.city = 'Oxford';
```
-------------------------5174 sample_num
```sql
SELECT z.zip_code, z.organization
FROM zip_data z
JOIN CBSA c ON z.CBSA = c.CBSA
WHERE c.CBSA_name = 'Kingsport-Bristol, TN-VA';
```
-------------------------5175 sample_num
```sql
SELECT z.zip_code, CONCAT(c.first_name, ' ', c.last_name) AS representative_name
FROM zip_data z
JOIN zip_congress zc ON z.zip_code = zc.zip_code
JOIN congress c ON zc.district = c.District AND c.state = z.state
WHERE z.organization = 'Readers Digest';
```
-------------------------5176 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN type = 'Post Office' THEN zip_code END) * 100.0 / COUNT(zip_code)) AS percentage
FROM 
    zip_data
WHERE 
    state = 'CA';
```
-------------------------5177 sample_num
```sql
SELECT DISTINCT z.zip_code
FROM zip_data z
JOIN congress c ON z.zip_code = c.zip_code
WHERE c.House = 'Senate';
```
-------------------------5178 sample_num
```sql
SELECT z.city, COUNT(a.bad_alias) AS bad_alias_count
FROM zip_data z
JOIN avoid a ON z.zip_code = a.zip_code
GROUP BY z.city
ORDER BY bad_alias_count DESC
LIMIT 1;
```
-------------------------5179 sample_num
```sql
SELECT DISTINCT county FROM country WHERE state = 'Georgia';
```
-------------------------5180 sample_num
```sql
SELECT zip_data.zip_code, zip_data.city, zip_data.state, zip_data.latitude, zip_data.longitude
FROM zip_data
JOIN area_code ON zip_data.zip_code = area_code.zip_code
WHERE area_code.area_code = '410';
```
-------------------------5181 sample_num
```sql
SELECT CBSA_name 
FROM CBSA 
WHERE CBSA = (
    SELECT CBSA 
    FROM zip_data 
    ORDER BY avg_house_value DESC 
    LIMIT 1
);
```
-------------------------5182 sample_num
```sql
SELECT a.bad_alias
FROM alias a
JOIN zip_data z ON a.zip_code = z.zip_code
WHERE z.city = 'East Setauket';
```
-------------------------5183 sample_num
```sql
SELECT SUM(population_2010) 
FROM zip_data 
JOIN country ON zip_data.zip_code = country.zip_code 
WHERE country.county = 'WILCOX';
```
-------------------------5184 sample_num
```sql
SELECT area_code.zip_code 
FROM zip_data 
JOIN area_code ON zip_data.zip_code = area_code.zip_code 
ORDER BY zip_data.asian_population DESC 
LIMIT 1;
```
-------------------------5185 sample_num
```sql
SELECT DISTINCT z.city
FROM zip_data z
JOIN CBSA c ON z.CBSA = c.CBSA
WHERE c.CBSA_type = 'Micro';
```
-------------------------5186 sample_num
```sql
SELECT state, COUNT(DISTINCT county) AS county_count
FROM country
GROUP BY state
ORDER BY county_count DESC
LIMIT 1;
```
-------------------------5187 sample_num
```sql
SELECT SUM(zip_data.households) AS total_households
FROM zip_data
JOIN zip_congress ON zip_data.zip_code = zip_congress.zip_code
JOIN congress ON zip_congress.district = congress.District
WHERE congress.abbreviation = 'FL' AND congress.District = '10';
```
-------------------------5188 sample_num
```sql
SELECT AVG(z.avg_income_per_household) AS average_household_income
FROM zip_data z
JOIN avoid a ON z.zip_code = a.zip_code
WHERE a.bad_alias = 'Danzig';
```
-------------------------5189 sample_num
```sql
SELECT state, SUM(female_population) AS total_female_population
FROM zip_data
GROUP BY state
HAVING SUM(female_population) > (SELECT AVG(total_female_population) 
                                   FROM (SELECT SUM(female_population) AS total_female_population 
                                         FROM zip_data 
                                         GROUP BY state) AS avg_female);
```
-------------------------5190 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.county = 'CORYELL' THEN z.households ELSE 0 END) * 100.0 / SUM(z.households)) AS percentage
FROM 
    zip_data z
JOIN 
    country c ON z.zip_code = c.zip_code
WHERE 
    c.state = (SELECT abbreviation FROM state WHERE name = 'Texas'); -- Replace 'Texas' with the appropriate state name if needed
```
-------------------------5191 sample_num
```sql
SELECT CBSA.CBSA_name, CBSA.CBSA_type
FROM CBSA
JOIN zip_data ON CBSA.CBSA = zip_data.CBSA
WHERE zip_data.city = 'Cabo Rojo';
```
-------------------------5192 sample_num
```sql
SELECT country.name 
FROM country 
JOIN zip_data ON country.zip_code = zip_data.zip_code 
WHERE zip_data.city = 'Las Marias';
```
-------------------------5193 sample_num
```sql
SELECT COUNT(DISTINCT z.city) AS city_count
FROM congress c
JOIN zip_congress zc ON c.District = zc.district
JOIN zip_data z ON zc.zip_code = z.zip_code
WHERE c.first_name = 'Pedro' AND c.last_name = 'Pierluisi';
```
-------------------------5194 sample_num
```sql
SELECT a.bad_alias
FROM alias a
JOIN zip_data z ON a.zip_code = z.zip_code
WHERE z.city = 'Aguadilla';
```
-------------------------5195 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS congressman_name
FROM congress c
JOIN zip_data z ON c.state = z.state
WHERE z.city = 'Guanica';
```
-------------------------5196 sample_num
```sql
SELECT c.state, COUNT(a.bad_alias) AS bad_alias_count
FROM avoid a
JOIN zip_data z ON a.zip_code = z.zip_code
JOIN congress c ON z.zip_code = c.zip_code
GROUP BY c.state
ORDER BY bad_alias_count DESC
LIMIT 1;
```
-------------------------5197 sample_num
```sql
SELECT 
    (SELECT COUNT(bad_alias) FROM avoid a 
     JOIN zip_data z ON a.zip_code = z.zip_code 
     WHERE z.city = 'Aguada') - 
    (SELECT COUNT(bad_alias) FROM avoid a 
     JOIN zip_data z ON a.zip_code = z.zip_code 
     WHERE z.city = 'Aguadilla') AS difference;
```
-------------------------5198 sample_num
```sql
SELECT s.name
FROM CBSA c
JOIN state s ON c.CBSA = s.abbreviation
WHERE c.CBSA_type = 'Metro'
GROUP BY s.name
HAVING COUNT(*) > 50;
```
-------------------------5199 sample_num
```sql
SELECT SUM(population_2020) 
FROM zip_data 
JOIN country ON zip_data.zip_code = country.zip_code 
WHERE country.county = 'ARECIBO';
```
-------------------------5200 sample_num
```sql
SELECT DISTINCT country 
FROM zip_data 
WHERE population_2010 > 10000;
```
-------------------------5201 sample_num
```sql
SELECT country.name
FROM country
JOIN zip_data ON country.zip_code = zip_data.zip_code
WHERE zip_data.households = (
    SELECT MAX(households)
    FROM zip_data
);
```
-------------------------5202 sample_num
```sql
SELECT 
    (SUM(CASE WHEN households > 10000 THEN households ELSE 0 END) * 100.0 / SUM(households)) AS percentage
FROM 
    zip_data
WHERE 
    type = 'Residential';
```
-------------------------5203 sample_num
```sql
SELECT 
    DIVIDE(COUNT(CASE WHEN type = 'Post Office' THEN 1 END), COUNT(*)) * 100 AS percentage 
FROM 
    zip_data 
WHERE 
    county = 'SAINT CROIX';
```
-------------------------5204 sample_num
```sql
SELECT c.country
FROM area_code ac
JOIN zip_data zd ON ac.zip_code = zd.zip_code
JOIN country c ON zd.zip_code = c.zip_code
WHERE ac.area_code = '787' AND zd.type = 'Unique Post Office';
```
-------------------------5205 sample_num
```sql
SELECT z.elevation
FROM zip_data z
JOIN alias a ON z.zip_code = a.zip_code
WHERE a.alias = 'East Longmeadow';
```
-------------------------5206 sample_num
```sql
SELECT COUNT(DISTINCT city) AS total_cities
FROM zip_data
WHERE daylight_savings = 'No';
```
-------------------------5207 sample_num
```sql
SELECT country.state, area_code.area_code
FROM country
JOIN area_code ON country.zip_code = area_code.zip_code
WHERE country.zip_code = '1116';
```
-------------------------5208 sample_num
```sql
SELECT z.city, z.type
FROM zip_data z
JOIN alias a ON z.zip_code = a.zip_code
WHERE a.alias = 'St Thomas';
```
-------------------------5209 sample_num
```sql
SELECT DISTINCT city 
FROM zip_data 
WHERE county_fips IN (SELECT county_fips FROM country WHERE county = 'Noble' AND state = 'Oklahoma');
```
-------------------------5210 sample_num
```sql
SELECT ac.area_code
FROM zip_data zd
JOIN area_code ac ON zd.zip_code = ac.zip_code
WHERE zd.water_area = (
    SELECT MAX(water_area)
    FROM zip_data
    WHERE city IN ('City1', 'City2', 'City3')  -- Replace with the actual city names
);
```
-------------------------5211 sample_num
```sql
SELECT a.alias 
FROM zip_data z 
JOIN alias a ON z.zip_code = a.zip_code 
WHERE z.population_2020 = (SELECT MAX(population_2020) FROM zip_data);
```
-------------------------5212 sample_num
```sql
SELECT elevation 
FROM zip_data 
WHERE county_fips IN (SELECT county_fips FROM country WHERE state = 'MA' AND county = 'Hampden');
```
-------------------------5213 sample_num
```sql
SELECT ac.area_code
FROM area_code ac
JOIN zip_data zd ON ac.zip_code = zd.zip_code
WHERE zd.hispanic_population = (SELECT MAX(hispanic_population) FROM zip_data);
```
-------------------------5214 sample_num
```sql
SELECT a.alias
FROM zip_data z
JOIN alias a ON z.zip_code = a.zip_code
WHERE z.asian_population = 7;
```
-------------------------5215 sample_num
```sql
SELECT AVG(z.white_population) 
FROM zip_data z 
JOIN area_code a ON z.zip_code = a.zip_code 
WHERE a.area_code = 920;
```
-------------------------5216 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.state_fips < 20 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    zip_data z
JOIN 
    alias a ON z.zip_code = a.zip_code
JOIN 
    country c ON z.zip_code = c.zip_code
WHERE 
    a.alias = 'Ponce';
```
-------------------------5217 sample_num
```sql
SELECT DISTINCT c.country
FROM country c
JOIN zip_data z ON c.zip_code = z.zip_code
WHERE z.population_2020 > (0.97 * (SELECT AVG(population_2020) FROM zip_data));
```
-------------------------5218 sample_num
```sql
SELECT COUNT(zip_code) AS postal_point_count
FROM zip_congress
WHERE district IN (
    SELECT District
    FROM congress
    WHERE first_name = 'Ann' AND last_name = 'Kirkpatrick'
);
```
-------------------------5219 sample_num
```sql
SELECT z.zip_code, z.latitude, z.longitude
FROM zip_data z
JOIN CBSA c ON z.CBSA = c.CBSA
WHERE c.CBSA_name = 'Allentown-Bethlehem-Easton, PA-NJ';
```
-------------------------5220 sample_num
```sql
SELECT z.zip_code, z.city, z.latitude, z.longitude
FROM zip_data z
JOIN avoid a ON z.zip_code = a.zip_code
WHERE a.bad_alias = 'Shared Reshipper';
```
-------------------------5221 sample_num
```sql
SELECT c.first_name, c.last_name
FROM congress c
JOIN zip_data z ON c.state = z.state
WHERE z.city = 'Garfield';
```
-------------------------5222 sample_num
```sql
SELECT COUNT(zip_code) 
FROM zip_data 
WHERE CBSA IN (SELECT CBSA FROM CBSA WHERE CBSA_name = 'New York-Newark-Jersey City, NY-NJ-PA');
```
-------------------------5223 sample_num
```sql
SELECT COUNT(DISTINCT z.zip_code) AS postal_points
FROM zip_data z
JOIN congress c ON z.zip_code = z.zip_code
WHERE c.state = 'Puerto Rico';
```
-------------------------5224 sample_num
```sql
SELECT COUNT(zip_code) AS postal_points, country
FROM zip_data
JOIN country ON zip_data.zip_code = country.zip_code
WHERE zip_data.state = 'West Virginia'
GROUP BY country;
```
-------------------------5225 sample_num
```sql
SELECT z.zip_code, a.area_code
FROM zip_data z
JOIN area_code a ON z.zip_code = a.zip_code
WHERE z.type = 'Community Post Office' AND z.elevation > 6000;
```
-------------------------5226 sample_num
```sql
SELECT COUNT(DISTINCT z.zip_code) AS postal_points
FROM zip_data z
JOIN congress c ON z.state = c.state
WHERE c.House = 'Representatives' AND c.state = 'Mississippi';
```
-------------------------5227 sample_num
```sql
SELECT congress.CID 
FROM zip_data 
JOIN zip_congress ON zip_data.zip_code = zip_congress.zip_code 
JOIN congress ON zip_congress.district = congress.District 
WHERE zip_data.city = 'East Springfield';
```
-------------------------5228 sample_num
```sql
SELECT CBSA.CBSA_name
FROM zip_data
JOIN CBSA ON zip_data.CBSA = CBSA.CBSA
WHERE zip_data.employees = (SELECT MAX(employees) FROM zip_data);
```
-------------------------5229 sample_num
```sql
SELECT COUNT(DISTINCT zip_code) AS unique_post_office_count
FROM zip_data
WHERE state = 'Ohio' AND type = 'Unique Post Office';
```
-------------------------5230 sample_num
```sql
SELECT DIVIDE(SUM(total_beneficiaries), COUNT(zip_code)) AS average_beneficiaries
FROM zip_data
WHERE state = 'Guam';
```
-------------------------5231 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN party = 'Democrat' THEN 1 END) * 100.0 / COUNT(congress_rep_id)) AS percentage,
    COUNT(DISTINCT z.zip_code) AS postal_points_in_hawaii
FROM 
    congress c
LEFT JOIN 
    zip_data z ON c.abbreviation = z.state
WHERE 
    z.state = 'Hawaii';
```
-------------------------5232 sample_num
```sql
SELECT BrandName 
FROM rootbeerbrand 
WHERE FirstBrewedYear = (SELECT MIN(FirstBrewedYear) FROM rootbeerbrand);
```
-------------------------5233 sample_num
```sql
SELECT COUNT(DISTINCT BreweryName) AS NumberOfBreweries
FROM rootbeerbrand
WHERE Country = 'United States';
```
-------------------------5234 sample_num
```sql
SELECT BrandName 
FROM rootbeerbrand 
WHERE FacebookPage IS NOT NULL;
```
-------------------------5235 sample_num
```sql
SELECT BrandName 
FROM rootbeerbrand 
WHERE (CurrentRetailPrice - WholesaleCost) = (
    SELECT MIN(CurrentRetailPrice - WholesaleCost) 
    FROM rootbeerbrand
);
```
-------------------------5236 sample_num
```sql
SELECT Description FROM rootbeerbrand WHERE BrandName = 'A&W';
```
-------------------------5237 sample_num
```sql
SELECT City FROM rootbeerbrand WHERE BreweryName = 'AJ Stephans Beverages';
```
-------------------------5238 sample_num
```sql
SELECT COUNT(*) 
FROM transaction 
WHERE CustomerID = (SELECT CustomerID FROM customers WHERE First = 'Frank-Paul' AND Last = 'Santangelo') 
AND SUBSTR(TransactionDate, 1, 4) = '2014' 
AND SUBSTR(TransactionDate, 6, 2) = '07';
```
-------------------------5239 sample_num
```sql
SELECT COUNT(*) 
FROM transaction t
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE SUBSTR(t.TransactionDate, 1, 4) = '2014' 
  AND SUBSTR(t.TransactionDate, 6, 2) = '07' 
  AND c.Gender = 'M';
```
-------------------------5240 sample_num
```sql
SELECT COUNT(DISTINCT c.CustomerID) 
FROM customers c 
JOIN transaction t ON c.CustomerID = t.CustomerID 
WHERE c.SubscribedToEmailList = 'TRUE' 
AND t.CreditCardType = 'Visa' 
AND SUBSTR(t.TransactionDate, 1, 4) = '2014' 
AND SUBSTR(t.TransactionDate, 6, 2) = '07';
```
-------------------------5241 sample_num
```sql
SELECT CONCAT(c.First, ' ', c.Last) AS FullName
FROM customers c
JOIN transaction t ON c.CustomerID = t.CustomerID
WHERE SUBSTR(t.TransactionDate, 1, 4) = '2014' AND SUBSTR(t.TransactionDate, 6, 2) = '08'
GROUP BY c.CustomerID
ORDER BY COUNT(t.TransactionID) DESC
LIMIT 1;
```
-------------------------5242 sample_num
```sql
SELECT rb.BrandName
FROM transaction t
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.First = 'Frank-Paul' AND c.Last = 'Santangelo' AND t.TransactionDate = '2014-07-07';
```
-------------------------5243 sample_num
```sql
SELECT COUNT(*) 
FROM rootbeer r
JOIN transaction t ON r.RootBeerID = t.RootBeerID
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.First = 'Frank-Paul' AND c.Last = 'Santangelo' 
AND t.TransactionDate = '2014-07-07' 
AND r.ContainerType = 'Can';
```
-------------------------5244 sample_num
```sql
SELECT COUNT(*) 
FROM transaction t
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
WHERE rb.BrandName = 'Bulldog' 
AND SUBSTR(t.TransactionDate, 1, 4) = '2014' 
AND SUBSTR(t.TransactionDate, 6, 2) = '08';
```
-------------------------5245 sample_num
```sql
SELECT CONCAT(c.First, ' ', c.Last) AS FullName
FROM customers c
JOIN transaction t ON c.CustomerID = t.CustomerID
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
WHERE rb.BreweryName = 'AJ Stephans Beverages'
GROUP BY c.CustomerID;
```
-------------------------5246 sample_num
```sql
SELECT COUNT(DISTINCT rb.BrandID)
FROM rootbeerbrand rb
JOIN rootbeer r ON rb.BrandID = r.BrandID
JOIN transaction t ON r.RootBeerID = t.RootBeerID
WHERE rb.Twitter IS NULL
AND SUBSTR(t.TransactionDate, 1, 4) = '2014'
AND SUBSTR(t.TransactionDate, 6, 2) = '08';
```
-------------------------5247 sample_num
```sql
SELECT t.CreditCardNumber 
FROM transaction t 
JOIN customers c ON t.CustomerID = c.CustomerID 
WHERE c.First = 'Frank-Paul' AND c.Last = 'Santangelo' AND t.TransactionDate = '2014-07-07';
```
-------------------------5248 sample_num
```sql
SELECT COUNT(*) 
FROM rootbeer r
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
JOIN customers c ON c.CustomerID = (SELECT CustomerID FROM customers WHERE First = 'Frank-Paul' AND Last = 'Santangelo')
WHERE rb.Honey = 'FALSE' AND rb.ArtificialSweetener = 'FALSE' AND r.CustomerID = c.CustomerID;
```
-------------------------5249 sample_num
```sql
SELECT TransactionDate
FROM transaction t
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.Gender = 'M'
GROUP BY TransactionDate
HAVING COUNT(t.RootBeerID) > 3;
```
-------------------------5250 sample_num
```sql
SELECT AVG(DailySales) AS AverageRootBeersSold
FROM (
    SELECT COUNT(t.RootBeerID) AS DailySales
    FROM transaction t
    JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
    JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
    WHERE rb.BrandName = 'A&W' 
      AND SUBSTR(t.TransactionDate, 1, 4) = '2014' 
      AND SUBSTR(t.TransactionDate, 6, 2) = '08'
    GROUP BY DATE(t.TransactionDate)
) AS DailySalesCount;
```
-------------------------5251 sample_num
```sql
SELECT 
    (SUM(CASE WHEN rb.BrandID IN (SELECT BrandID FROM rootbeerbrand WHERE BreweryName = 'AJ Stephans Beverages') THEN 1 ELSE 0 END) * 1.0 / COUNT(rb.RootBeerID)) * 100 AS Percentage
FROM 
    transaction t
JOIN 
    rootbeer rb ON t.RootBeerID = rb.RootBeerID
WHERE 
    SUBSTR(t.TransactionDate, 1, 4) = '2014';
```
-------------------------5252 sample_num
```sql
SELECT COUNT(*) 
FROM rootbeerreview 
WHERE CustomerID = (SELECT CustomerID FROM customers WHERE First = 'James' AND Last = 'House');
```
-------------------------5253 sample_num
```sql
SELECT CreditCardNumber 
FROM transaction 
WHERE CustomerID = (SELECT CustomerID FROM customers WHERE First = 'Lisa' AND Last = 'Ling');
```
-------------------------5254 sample_num
```sql
SELECT Latitude, Longitude 
FROM geolocation 
JOIN location ON geolocation.LocationID = location.LocationID 
WHERE location.LocationName = 'Sac State American River Courtyard';
```
-------------------------5255 sample_num
```sql
SELECT l.LocationName 
FROM transaction t 
JOIN location l ON t.LocationID = l.LocationID 
WHERE t.TransactionID = 100885;
```
-------------------------5256 sample_num
```sql
SELECT c.City 
FROM customers c 
JOIN transaction t ON c.CustomerID = t.CustomerID 
WHERE t.TransactionID = 103545;
```
-------------------------5257 sample_num
```sql
SELECT c.PhoneNumber 
FROM customers c 
JOIN transaction t ON c.CustomerID = t.CustomerID 
WHERE t.CreditCardNumber = '6011179359005380';
```
-------------------------5258 sample_num
```sql
SELECT CONCAT(c.First, ' ', c.Last) AS FullName
FROM customers c
JOIN rootbeerreview r ON c.CustomerID = r.CustomerID
GROUP BY c.CustomerID
ORDER BY COUNT(r.CustomerID) DESC
LIMIT 1;
```
-------------------------5259 sample_num
```sql
SELECT c.FirstPurchaseDate
FROM customers c
JOIN rootbeerreview r ON c.CustomerID = r.CustomerID
WHERE r.Review = 'Tastes like Australia.';
```
-------------------------5260 sample_num
```sql
SELECT FirstPurchaseDate 
FROM customers 
WHERE First = 'Natalie' AND Last = 'Dorris';
```
-------------------------5261 sample_num
```sql
SELECT rb.BreweryName
FROM rootbeerreview rbr
JOIN rootbeerbrand rb ON rbr.BrandID = rb.BrandID
WHERE rbr.BrandID IN (
    SELECT rbr2.BrandID
    FROM rootbeerreview rbr2
    WHERE rbr2.StarRating = 5
    GROUP BY rbr2.BrandID
    ORDER BY COUNT(*) DESC
    LIMIT 1
);
```
-------------------------5262 sample_num
```sql
SELECT c.SubscribedToEmailList
FROM customers c
JOIN rootbeerreview r ON c.CustomerID = r.CustomerID
JOIN rootbeerbrand b ON r.BrandID = b.BrandID
WHERE r.StarRating = 3 
  AND b.BrandName = 'Frostie' 
  AND r.ReviewDate = '2014-04-24';
```
-------------------------5263 sample_num
```sql
SELECT rbb.CurrentRetailPrice
FROM rootbeerreview rbr
JOIN rootbeerbrand rbb ON rbr.BrandID = rbb.BrandID
WHERE rbr.Review = 'The quintessential dessert root beer. No ice cream required.';
```
-------------------------5264 sample_num
```sql
SELECT 
    (SUM(CASE WHEN rr.StarRating = 5 THEN 1 ELSE 0 END) * 1.0 / COUNT(rr.BrandID)) * 100 AS PercentageOfFiveStarRatings
FROM 
    rootbeerreview rr
JOIN 
    rootbeerbrand rb ON rr.BrandID = rb.BrandID
WHERE 
    rb.BrandName = 'River City';
```
-------------------------5265 sample_num
```sql
SELECT AVG(ReviewCount) AS AverageReviews
FROM (
    SELECT BrandID, COUNT(CustomerID) AS ReviewCount
    FROM rootbeerreview r
    JOIN rootbeerbrand b ON r.BrandID = b.BrandID
    WHERE b.State = 'CA'
    GROUP BY BrandID
) AS ReviewCounts;
```
-------------------------5266 sample_num
```sql
SELECT COUNT(*) 
FROM customers 
WHERE Gender = 'F' AND SubscribedToEmailList = 'TRUE';
```
-------------------------5267 sample_num
```sql
SELECT BrandName 
FROM rootbeerbrand 
WHERE FirstBrewedYear = (SELECT MAX(FirstBrewedYear) FROM rootbeerbrand);
```
-------------------------5268 sample_num
```sql
SELECT CONCAT(First, ' ', Last) AS FullName
FROM customers
ORDER BY FirstPurchaseDate
LIMIT 10;
```
-------------------------5269 sample_num
```sql
SELECT COUNT(DISTINCT BreweryName) AS NumberOfBreweries
FROM rootbeerbrand
WHERE Country = 'Australia';
```
-------------------------5270 sample_num
```sql
SELECT COUNT(*) 
FROM customers 
WHERE First = 'Charles' AND City = 'Sacramento';
```
-------------------------5271 sample_num
```sql
SELECT COUNT(*) 
FROM transaction 
WHERE CreditCardType = 'MasterCard' 
AND TransactionDate >= '2014-01-01' 
AND TransactionDate <= '2014-12-31';
```
-------------------------5272 sample_num
```sql
SELECT rb.BrandName
FROM rootbeerreview rbr
JOIN rootbeerbrand rb ON rbr.BrandID = rb.BrandID
JOIN customers c ON rbr.CustomerID = c.CustomerID
WHERE c.First = 'Jayne' AND c.Last = 'Collins'
ORDER BY rbr.StarRating ASC
LIMIT 1;
```
-------------------------5273 sample_num
```sql
SELECT COUNT(*)
FROM rootbeer r
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
JOIN location l ON r.LocationID = l.LocationID
WHERE rb.Honey = 'TRUE'
  AND rb.ContainerType = 'Bottle'
  AND rb.CaneSugar = 'FALSE'
  AND r.PurchaseDate <= '2015-12-31'
  AND l.LocationName = 'Sac State American River Courtyard';
```
-------------------------5274 sample_num
```sql
SELECT rb.BrandID, rb.BreweryName
FROM rootbeer r
JOIN transaction t ON r.RootBeerID = t.RootBeerID
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
WHERE t.PurchaseDate >= '2016-01-01' AND t.PurchaseDate <= '2016-12-31'
GROUP BY rb.BrandID, rb.BreweryName
ORDER BY COUNT(t.TransactionID) DESC
LIMIT 1;
```
-------------------------5275 sample_num
```sql
SELECT CONCAT(c.First, ' ', c.Last) AS FullName
FROM customers c
JOIN rootbeerreview r ON c.CustomerID = r.CustomerID
JOIN rootbeer b ON r.BrandID = b.BrandID
WHERE b.BrandName = 'River City' AND r.StarRating = 5;
```
-------------------------5276 sample_num
```sql
SELECT COUNT(*) 
FROM transaction t
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.First = 'Tom' AND c.Last = 'Hanks' 
AND t.TransactionDate >= '2015-01-01' AND t.TransactionDate < '2016-12-31';
```
-------------------------5277 sample_num
```sql
SELECT rb.BrandName, COUNT(rr.StarRating) AS FiveStarCount
FROM rootbeerreview rr
JOIN rootbeerbrand rb ON rr.BrandID = rb.BrandID
WHERE rr.StarRating = 5
GROUP BY rb.BrandName
ORDER BY FiveStarCount DESC
LIMIT 1;
```
-------------------------5278 sample_num
```sql
SELECT COUNT(t.TransactionID) AS TotalPurchased
FROM transaction t
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE rb.BrandName = 'Henry Weinhard''s' AND c.First = 'Nicholas' AND c.Last = 'Sparks';
```
-------------------------5279 sample_num
```sql
SELECT rb.BrandName, COUNT(t.RootBeerID) AS PurchaseCount
FROM rootbeerbrand rb
JOIN rootbeer r ON rb.BrandID = r.BrandID
JOIN transaction t ON r.RootBeerID = t.RootBeerID
WHERE rb.FacebookPage IS NULL AND rb.Twitter IS NULL
GROUP BY rb.BrandName
ORDER BY PurchaseCount DESC
LIMIT 1;
```
-------------------------5280 sample_num
```sql
SELECT l.LocationName, COUNT(t.RootBeerID) AS TotalSold
FROM transaction t
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
JOIN location l ON t.LocationID = l.LocationID
WHERE l.LocationName IN ('Sac State American River Courtyard', 'Sac State Union')
AND rb.BrandName = 'Dog n Suds'
GROUP BY l.LocationName
ORDER BY TotalSold DESC
LIMIT 1;
```
-------------------------5281 sample_num
```sql
SELECT COUNT(*) 
FROM rootbeer r
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
WHERE rb.BrandName = 'A&W' 
AND r.ContainerType = 'Can' 
AND r.PurchaseDate >= '2016-01-01' 
AND r.PurchaseDate <= '2016-12-31';
```
-------------------------5282 sample_num
```sql
SELECT g.Latitude, g.Longitude
FROM location l
JOIN geolocation g ON l.LocationID = g.LocationID
WHERE l.LocationName = 'Sac State Union';
```
-------------------------5283 sample_num
```sql
SELECT rb.BrandID, rbb.BrandName
FROM rootbeerreview rbr
JOIN rootbeerbrand rbb ON rbr.BrandID = rbb.BrandID
WHERE rbr.StarRating = 5
GROUP BY rb.BrandID, rbb.BrandName
HAVING COUNT(rbr.CustomerID) >= 5;
```
-------------------------5284 sample_num
```sql
SELECT rb.BrandName, 
       (SUM(CASE WHEN t.PurchaseDate >= '2014-01-01' AND t.PurchaseDate <= '2016-12-31' THEN 1 ELSE 0 END) * 1.0 / COUNT(t.BrandID)) * 100 AS PurchasePercentage
FROM rootbeer rb
JOIN rootbeerbrand rbb ON rb.BrandID = rbb.BrandID
JOIN transaction t ON rb.RootBeerID = t.RootBeerID
WHERE rbb.BreweryName = 'Dr Pepper Snapple Group'
GROUP BY rb.BrandName;
```
-------------------------5285 sample_num
```sql
WITH BrandProfit AS (
    SELECT BrandID, BrandName, (CurrentRetailPrice - WholesaleCost) AS UnitProfit
    FROM rootbeerbrand
),
LowestProfitBrand AS (
    SELECT BrandID, BrandName
    FROM BrandProfit
    WHERE UnitProfit = (SELECT MIN(UnitProfit) FROM BrandProfit)
),
CustomerPurchases AS (
    SELECT CustomerID, BrandID, COUNT(*) AS PurchaseCount
    FROM transaction
    JOIN rootbeer ON transaction.RootBeerID = rootbeer.RootBeerID
    GROUP BY CustomerID, BrandID
),
MaxPurchases AS (
    SELECT CustomerID
    FROM CustomerPurchases
    WHERE BrandID IN (SELECT BrandID FROM LowestProfitBrand)
    ORDER BY PurchaseCount DESC
    LIMIT 1
)
SELECT BrandID, CustomerID
FROM LowestProfitBrand, MaxPurchases;
```
-------------------------5286 sample_num
```sql
SELECT CONCAT(First, ' ', Last) AS FullName, PhoneNumber
FROM customers
WHERE Gender = 'M' AND City = 'Fair Oaks' AND SubscribedToEmailList = 'TRUE';
```
-------------------------5287 sample_num
```sql
SELECT 
    (SUM(CASE WHEN ContainerType = 'Can' THEN 1 ELSE 0 END) * 100.0 / COUNT(RootBeerID)) AS PercentageSoldInCans
FROM 
    rootbeer
WHERE 
    PurchaseDate >= '2014-01-01' AND PurchaseDate <= '2014-12-31';
```
-------------------------5288 sample_num
```sql
SELECT BrandName 
FROM rootbeerbrand 
WHERE FirstBrewedYear >= 1996 AND FirstBrewedYear <= 2000 
ORDER BY FirstBrewedYear DESC;
```
-------------------------5289 sample_num
```sql
SELECT BrandID
FROM rootbeerreview
WHERE StarRating = 1
GROUP BY BrandID
ORDER BY COUNT(CustomerID) DESC
LIMIT 1;
```
-------------------------5290 sample_num
```sql
SELECT 
    (SUM(CASE WHEN CreditCardType = 'Visa' THEN 1 ELSE 0 END) * 100.0) / COUNT(TransactionID) AS VisaPercentage
FROM 
    transaction;
```
-------------------------5291 sample_num
```sql
SELECT COUNT(*) 
FROM rootbeerbrand 
WHERE AvailableInCans = 'TRUE' 
  AND CornSyrup = 'TRUE' 
  AND ArtificialSweetener = 'TRUE';
```
-------------------------5292 sample_num
```sql
SELECT 
    (SUM(CASE WHEN l.LocationName = 'Sac State American River Courtyard' THEN 1 ELSE 0 END) * 100.0) / COUNT(t.LocationID) AS SalesPercentage
FROM 
    transaction t
JOIN 
    location l ON t.LocationID = l.LocationID;
```
-------------------------5293 sample_num
```sql
SELECT DIVIDE(COUNT(RootBeerID), COUNT(DISTINCT TransactionDate)) AS AverageCaffeinatedRootBeersSoldPerDay
FROM transaction t
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
WHERE r.Caffeinated = 'TRUE';
```
-------------------------5294 sample_num
```sql
SELECT ContainerType, 
       MAX(CurrentRetailPrice - WholesaleCost) AS MaxProfitPerUnit,
       MIN(CurrentRetailPrice - WholesaleCost) AS MinProfitPerUnit
FROM rootbeer
JOIN rootbeerbrand ON rootbeer.BrandID = rootbeerbrand.BrandID
GROUP BY ContainerType
HAVING MaxProfitPerUnit = (SELECT MAX(CurrentRetailPrice - WholesaleCost) FROM rootbeerbrand)
   OR MinProfitPerUnit = (SELECT MIN(CurrentRetailPrice - WholesaleCost) FROM rootbeerbrand);
```
-------------------------5295 sample_num
```sql
SELECT AVG(PurchasePrice) AS AverageCost
FROM transaction
WHERE PurchasePrice > 2 AND RootBeerID IN (
    SELECT RootBeerID
    FROM rootbeer
    WHERE ContainerType = 'Bottle'
);
```
-------------------------5296 sample_num
```sql
SELECT COUNT(*) 
FROM rootbeer r
JOIN location l ON r.LocationID = l.LocationID
JOIN geolocation g ON l.LocationID = g.LocationID
WHERE r.ContainerType = 'Bottle' 
AND g.Latitude = 38.559615 
AND g.Longitude = -121.42243;
```
-------------------------5297 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN r.StarRating >= 3 THEN 1 END) * 100.0 / COUNT(c.CustomerID)) AS Percentage
FROM 
    customers c
LEFT JOIN 
    rootbeerreview r ON c.CustomerID = r.CustomerID
WHERE 
    c.SubscribedToEmailList = 'FALSE';
```
-------------------------5298 sample_num
```sql
SELECT rb.BrandName
FROM rootbeerreview rbr
JOIN rootbeer rb ON rbr.BrandID = rb.BrandID
WHERE rbr.StarRating = 5 AND YEAR(rbr.ReviewDate) = 2012
GROUP BY rb.BrandID
ORDER BY COUNT(rbr.StarRating) DESC
LIMIT 1;
```
-------------------------5299 sample_num
```sql
SELECT COUNT(DISTINCT t.CustomerID) AS FemaleCustomersWithArtificialSweetener
FROM customers c
JOIN transaction t ON c.CustomerID = t.CustomerID
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
WHERE c.Gender = 'F' AND rb.ArtificialSweetener = 'TRUE';
```
-------------------------5300 sample_num
```sql
SELECT 
    (SUM(CASE WHEN rb.CaneSugar = 'TRUE' THEN 1 ELSE 0 END) - 
     SUM(CASE WHEN rb.CornSyrup = 'TRUE' THEN 1 ELSE 0 END)) AS Difference
FROM 
    rootbeer rb
JOIN 
    rootbeerbrand rbb ON rb.BrandID = rbb.BrandID;
```
-------------------------5301 sample_num
```sql
SELECT rb.BreweryName
FROM transaction t
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
WHERE t.TransactionDate >= '2015-01-01' AND t.TransactionDate <= '2015-12-31'
GROUP BY rb.BreweryName
ORDER BY COUNT(r.BrandID) DESC
LIMIT 1;
```
-------------------------5302 sample_num
```sql
SELECT 
    (COUNT(DISTINCT t.CustomerID) * 1.0 / COUNT(DISTINCT c.CustomerID)) * 100 AS Percentage
FROM 
    customers c
LEFT JOIN 
    transaction t ON c.CustomerID = t.CustomerID
LEFT JOIN 
    rootbeer r ON t.RootBeerID = r.RootBeerID
LEFT JOIN 
    rootbeerbrand rb ON r.BrandID = rb.BrandID
WHERE 
    c.Gender = 'M' 
    AND c.City = 'Sacramento' 
    AND rb.BrandName = 'Dominion' 
    AND t.TransactionDate >= '2013-01-01' 
    AND t.TransactionDate < '2014-01-01';
```
-------------------------5303 sample_num
```sql
SELECT 
    (SELECT AVG(SalesPerDay) 
     FROM (
         SELECT COUNT(t.TransactionID) / COUNT(DISTINCT t.TransactionDate) AS SalesPerDay
         FROM transaction t
         JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
         JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
         WHERE rb.Honey = 'TRUE'
         GROUP BY r.BrandID
     ) AS HoneySales) -
    (SELECT AVG(SalesPerDay) 
     FROM (
         SELECT COUNT(t.TransactionID) / COUNT(DISTINCT t.TransactionDate) AS SalesPerDay
         FROM transaction t
         JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
         JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
         WHERE rb.Honey = 'FALSE'
         GROUP BY r.BrandID
     ) AS NoHoneySales) AS DifferenceInAverageSales;
```
-------------------------5304 sample_num
```sql
SELECT CONCAT(c.First, ' ', c.Last) AS FullName, c.Email
FROM customers c
JOIN transaction t ON c.CustomerID = t.CustomerID
JOIN location l ON t.LocationID = l.LocationID
WHERE t.CreditCardType = 'American Express' AND l.LocationName = 'Sac State Union';
```
-------------------------5305 sample_num
```sql
SELECT rb.BrandName, MAX(rr.StarRating) AS HighestStarRating
FROM rootbeerreview rr
JOIN rootbeerbrand rb ON rr.BrandID = rb.BrandID
WHERE rr.ReviewDate LIKE '2014-09%'
GROUP BY rb.BrandName
ORDER BY HighestStarRating DESC
LIMIT 1;
```
-------------------------5306 sample_num
```sql
SELECT g.Latitude, g.Longitude
FROM customers c
JOIN transaction t ON c.CustomerID = t.CustomerID
JOIN geolocation g ON t.LocationID = g.LocationID
WHERE t.CreditCardType = 'American Express';
```
-------------------------5307 sample_num
```sql
SELECT COUNT(DISTINCT c.CustomerID) AS FolsomVisaCustomers
FROM customers c
JOIN transaction t ON c.CustomerID = t.CustomerID
WHERE c.City = 'Folsom' AND t.CreditCardType = 'Visa';
```
-------------------------5308 sample_num
```sql
SELECT DISTINCT c.City
FROM customers c
JOIN rootbeerreview r ON c.CustomerID = r.CustomerID
WHERE r.StarRating = 5 AND r.ReviewDate LIKE '2012-11%';
```
-------------------------5309 sample_num
```sql
SELECT DISTINCT rb.BrandName
FROM rootbeerreview rbr
JOIN rootbeer rb ON rbr.BrandID = rb.BrandID
JOIN customers c ON rbr.CustomerID = c.CustomerID
WHERE c.First = 'Peg' AND c.Last = 'Winchester';
```
-------------------------5310 sample_num
```sql
SELECT rb.BrandName
FROM rootbeerreview rbr
JOIN rootbeerbrand rb ON rbr.BrandID = rb.BrandID
WHERE rbr.StarRating = 1
GROUP BY rb.BrandName
ORDER BY COUNT(rbr.StarRating) DESC
LIMIT 1;
```
-------------------------5311 sample_num
```sql
SELECT CreditCardNumber
FROM transaction t
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
WHERE r.Alcoholic = 'FALSE'
GROUP BY CreditCardNumber
ORDER BY COUNT(CreditCardNumber) DESC
LIMIT 1;
```
-------------------------5312 sample_num
```sql
SELECT First, Last 
FROM customers 
WHERE CustomerID IN (
    SELECT CustomerID 
    FROM rootbeerreview 
    WHERE StarRating = 5
);
```
-------------------------5313 sample_num
```sql
SELECT g.Latitude
FROM rootbeer r
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
JOIN location l ON r.LocationID = l.LocationID
JOIN geolocation g ON l.LocationID = g.LocationID
WHERE rb.BrandName = 'Thomas Kemper'
GROUP BY g.Latitude
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------5314 sample_num
```sql
SELECT StarRating
FROM rootbeerreview
JOIN rootbeer ON rootbeerreview.BrandID = rootbeer.BrandID
JOIN rootbeerbrand ON rootbeer.BrandID = rootbeerbrand.BrandID
WHERE rootbeerbrand.CornSyrup = 'TRUE'
GROUP BY StarRating
ORDER BY COUNT(StarRating) DESC
LIMIT 1;
```
-------------------------5315 sample_num
```sql
SELECT g.Latitude, g.Longitude
FROM geolocation g
JOIN location l ON g.LocationID = l.LocationID
WHERE l.ZipCode = '95819';
```
-------------------------5316 sample_num
```sql
SELECT rb.BrandName
FROM rootbeer r
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
JOIN location l ON r.LocationID = l.LocationID
JOIN geolocation g ON l.LocationID = g.LocationID
WHERE g.Latitude = 38.566129 AND g.Longitude = -121.426432;
```
-------------------------5317 sample_num
```sql
SELECT 
    AVG(CurrentRetailPrice - WholesaleCost) AS AverageUnitProfit
FROM 
    rootbeerbrand 
JOIN 
    rootbeer ON rootbeer.BrandID = rootbeerbrand.BrandID 
WHERE 
    rootbeer.ContainerType = 'Can';
```
-------------------------5318 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN rr.StarRating = 3 THEN rr.CustomerID END) * 100.0) / COUNT(DISTINCT t.CustomerID) AS Percentage
FROM 
    transaction t
JOIN 
    rootbeerreview rr ON t.CustomerID = rr.CustomerID
WHERE 
    t.CreditCardType = 'Discover';
```
-------------------------5319 sample_num
```sql
SELECT DISTINCT BrandID FROM rootbeerreview WHERE StarRating > 3;
```
-------------------------5320 sample_num
```sql
SELECT COUNT(DISTINCT rb.BrandID) AS NumberOfBrands
FROM rootbeer rb
WHERE rb.ContainerType = 'Bottle'
AND rb.PurchaseDate BETWEEN '2015-04-03' AND '2015-10-26';
```
-------------------------5321 sample_num
```sql
SELECT CONCAT(c.First, ' ', c.Last) AS FullName
FROM customers c
JOIN rootbeerreview r ON c.CustomerID = r.CustomerID
WHERE r.StarRating = 5 AND r.Review = 'The quintessential dessert root beer. No ice cream required.';
```
-------------------------5322 sample_num
```sql
SELECT COUNT(Email) AS EmailCount, COUNT(PhoneNumber) AS PhoneNumberCount
FROM customers c
JOIN rootbeerreview r ON c.CustomerID = r.CustomerID
WHERE c.City = 'Sacramento' AND r.StarRating > 3 AND r.ReviewDate LIKE '2014%';
```
-------------------------5323 sample_num
```sql
SELECT COUNT(DISTINCT c.CustomerID)
FROM customers c
JOIN rootbeerreview r ON c.CustomerID = r.CustomerID
WHERE c.Gender = 'F'
  AND c.SubscribedToEmailList = 'TRUE'
  AND c.City = 'Sacramento'
  AND r.StarRating = 4
  AND r.ReviewDate BETWEEN '2016-01-03' AND '2016-10-26';
```
-------------------------5324 sample_num
```sql
SELECT rb.BrandName, rbb.BreweryName
FROM rootbeer r
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
WHERE r.ContainerType = 'Can' AND r.PurchaseDate < '2015-06-06';
```
-------------------------5325 sample_num
```sql
SELECT BrandName 
FROM rootbeerbrand 
WHERE BrandID IN (
    SELECT BrandID 
    FROM rootbeer 
    WHERE ContainerType = 'Bottle'
) AND FirstBrewedYear < 1930;
```
-------------------------5326 sample_num
```sql
SELECT COUNT(*) 
FROM transaction t
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.First = 'Anna' AND c.Last = 'Himes' 
AND t.CreditCardType = 'MasterCard' 
AND t.TransactionDate BETWEEN '2014-12-25' AND '2016-05-20';
```
-------------------------5327 sample_num
```sql
SELECT AVG(StarRating) AS AverageStarRating
FROM rootbeerreview
WHERE BrandID = 10018 AND ReviewDate BETWEEN '2015-01-25' AND '2015-03-10'
AND CustomerID IN (SELECT CustomerID FROM customers WHERE Gender = 'F');
```
-------------------------5328 sample_num
```sql
SELECT rb.BrandName 
FROM rootbeerreview rbr 
JOIN rootbeerbrand rb ON rbr.BrandID = rb.BrandID 
WHERE rbr.CustomerID = 331115 AND rbr.StarRating = 1 AND rbr.Review = 'Yuk, more like licorice soda';
```
-------------------------5329 sample_num
```sql
SELECT SUM(PurchasePrice) AS TotalPurchases
FROM transaction t
JOIN location l ON t.LocationID = l.LocationID
WHERE t.CreditCardType = 'Visa'
  AND l.LocationName = 'Sac State American River Courtyard'
  AND t.TransactionDate BETWEEN '2014-06-03' AND '2015-11-27';
```
-------------------------5330 sample_num
```sql
SELECT COUNT(*) 
FROM transaction 
WHERE LocationID IN (SELECT LocationID FROM location WHERE LocationName = 'Sac State Union') 
AND CreditCardType = 'American Express' 
AND TransactionDate LIKE '2014%';
```
-------------------------5331 sample_num
```sql
SELECT g.Latitude, g.Longitude 
FROM geolocation g 
JOIN location l ON g.LocationID = l.LocationID 
WHERE l.LocationName = 'Sac State Union';
```
-------------------------5332 sample_num
```sql
SELECT Review 
FROM rootbeerreview 
WHERE BrandID = (SELECT BrandID FROM rootbeerbrand WHERE BrandName = 'Bulldog') 
AND ReviewDate = '2013-07-26';
```
-------------------------5333 sample_num
```sql
SELECT rb.BrandName, 
       (rb.CurrentRetailPrice - rb.WholesaleCost) AS UnitProfit
FROM rootbeerreview rbr
JOIN rootbeerbrand rb ON rbr.BrandID = rb.BrandID
WHERE rbr.StarRating = 5 
  AND rbr.ReviewDate LIKE '2013%';
```
-------------------------5334 sample_num
```sql
SELECT 
    CONCAT(c.First, ' ', c.Last) AS FullName,
    DATEDIFF(rr.ReviewDate, c.FirstPurchaseDate) AS DaysSinceFirstPurchase
FROM 
    customers c
JOIN 
    rootbeerreview rr ON c.CustomerID = rr.CustomerID
WHERE 
    c.CustomerID = (SELECT CustomerID FROM customers ORDER BY FirstPurchaseDate LIMIT 1)
ORDER BY 
    rr.ReviewDate
LIMIT 1;
```
-------------------------5335 sample_num
```sql
SELECT DISTINCT t.CreditCardType 
FROM customers c 
JOIN transaction t ON c.CustomerID = t.CustomerID 
WHERE c.First = 'Kenneth' AND c.Last = 'Walton';
```
-------------------------5336 sample_num
```sql
SELECT rb.ContainerType, rbb.BrandName, rbr.StarRating
FROM rootbeer rb
JOIN rootbeerbrand rbb ON rb.BrandID = rbb.BrandID
JOIN rootbeerreview rbr ON rbb.BrandID = rbr.BrandID
WHERE rb.RootBeerID = 10054;
```
-------------------------5337 sample_num
```sql
SELECT rb.*
FROM rootbeer rb
JOIN transaction t ON rb.RootBeerID = t.RootBeerID
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.First IN ('Tim', 'Dawn') AND c.Last IN ('Ocel', 'Childress');
```
-------------------------5338 sample_num
```sql
SELECT RootBeerID 
FROM rootbeer 
WHERE BrandID IN (
    SELECT BrandID 
    FROM rootbeerbrand 
    WHERE BrandName IN ('Bulldog', 'Bundaberg', 'Dad''s', 'Dog n Suds', 'Virgil''s')
);
```
-------------------------5339 sample_num
```sql
SELECT COUNT(*) 
FROM transaction t
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.First = 'Jim' AND c.Last = 'Breech' AND r.ContainerType = 'Bottle';
```
-------------------------5340 sample_num
```sql
SELECT COUNT(*) 
FROM transaction t
JOIN rootbeer r ON t.RootBeerID = r.RootBeerID
JOIN rootbeerbrand rb ON r.BrandID = rb.BrandID
JOIN location l ON r.LocationID = l.LocationID
WHERE rb.State = 'CA';
```
-------------------------5341 sample_num
```sql
SELECT AVG(rr.StarRating) AS AverageReview
FROM rootbeerreview rr
JOIN customers c ON rr.CustomerID = c.CustomerID
WHERE c.SubscribedToEmailList = 'TRUE';
```
-------------------------5342 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM rootbeer r 
     JOIN location l ON r.LocationID = l.LocationID 
     WHERE r.ContainerType = 'Bottle' AND l.State = 'LA') -
    (SELECT COUNT(*) FROM rootbeer r 
     JOIN location l ON r.LocationID = l.LocationID 
     WHERE r.ContainerType = 'Bottle' AND l.State = 'MO') AS AmountDifference;
```
-------------------------5343 sample_num
```sql
SELECT 
    DIVIDE(
        (SELECT COUNT(TransactionID) FROM transaction t 
         JOIN location l ON t.LocationID = l.LocationID 
         WHERE l.LocationName = 'Sac State American River Courtyard'),
        (SELECT COUNT(TransactionID) FROM transaction t 
         JOIN location l ON t.LocationID = l.LocationID 
         WHERE l.LocationName = 'Sac State Union')
    ) AS TransactionRatio;
```
-------------------------5344 sample_num
```sql
SELECT c.First, c.Last, t.CreditCardType, SUM(t.PurchasePrice) AS TotalSpent
FROM transaction t
JOIN customers c ON t.CustomerID = c.CustomerID
GROUP BY c.CustomerID, c.First, c.Last, t.CreditCardType
ORDER BY TotalSpent DESC
LIMIT 10;
```
-------------------------5345 sample_num
```sql
SELECT rb.BrandName, SUM(t.PurchasePrice) AS TotalAmountSold
FROM rootbeerbrand rb
JOIN rootbeer r ON rb.BrandID = r.BrandID
JOIN transaction t ON r.RootBeerID = t.RootBeerID
WHERE rb.Caffeinated = 'FALSE' AND rb.CaneSugar = 'FALSE'
GROUP BY rb.BrandName;
```
-------------------------5346 sample_num
```sql
SELECT rb.BrandName
FROM rootbeer rb
JOIN transaction t ON rb.RootBeerID = t.RootBeerID
GROUP BY rb.BrandID
ORDER BY COUNT(t.RootBeerID) ASC
LIMIT 1;
```
-------------------------5347 sample_num
```sql
SELECT rb.BrandID, AVG(rr.StarRating) AS AverageStarRating
FROM rootbeer r
JOIN rootbeerreview rr ON r.BrandID = rr.BrandID
JOIN (
    SELECT BrandID, COUNT(*) AS SalesCount
    FROM rootbeer
    GROUP BY BrandID
    ORDER BY SalesCount DESC
    LIMIT 1
) AS best_seller ON r.BrandID = best_seller.BrandID
GROUP BY rb.BrandID;
```
-------------------------5348 sample_num
```sql
SELECT 
    (SUM(CASE WHEN rb.BrandName = 'River City' THEN t.PurchasePrice ELSE 0 END) - 
     SUM(CASE WHEN rb.BrandName = 'Frostie' THEN t.PurchasePrice ELSE 0 END)) * 100.0 / 
     NULLIF(SUM(CASE WHEN rb.BrandName = 'Frostie' THEN t.PurchasePrice ELSE 0 END), 0) AS PercentageDifference
FROM 
    transaction t
JOIN 
    rootbeer rb ON t.RootBeerID = rb.RootBeerID
JOIN 
    rootbeerbrand rbb ON rb.BrandID = rbb.BrandID;
```
-------------------------5349 sample_num
```sql
SELECT DISTINCT City FROM location WHERE State = 'CA';
```
-------------------------5350 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Gender = 'F' AND SubscribedToEmailList = 'TRUE' THEN 1 END) * 100.0) / 
    COUNT(CASE WHEN SubscribedToEmailList = 'TRUE' THEN 1 END) AS FemaleSubscriptionPercentage
FROM 
    customers;
```
-------------------------5351 sample_num
```sql
SELECT DISTINCT t.CreditCardType
FROM transaction t
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.First = 'Dick' AND c.Last = 'Ruthven';
```
-------------------------5352 sample_num
```sql
SELECT COUNT(*) 
FROM transaction 
WHERE LocationID IN (SELECT LocationID FROM location WHERE LocationName = 'Sac State Union');
```
-------------------------5353 sample_num
```sql
SELECT StarRating 
FROM rootbeerreview 
WHERE CustomerID = (SELECT CustomerID FROM customers WHERE First = 'Urijah' AND Last = 'Faber') 
AND BrandID = (SELECT BrandID FROM rootbeerbrand WHERE BrandName = 'Frostie');
```
-------------------------5354 sample_num
```sql
SELECT rb.BrandName
FROM rootbeerreview rbr
JOIN rootbeerbrand rb ON rbr.BrandID = rb.BrandID
WHERE rbr.Review = 'Too Spicy!'
ORDER BY rbr.StarRating ASC
LIMIT 1;
```
-------------------------5355 sample_num
```sql
SELECT COUNT(*) 
FROM transaction 
WHERE LocationID = (SELECT LocationID FROM location WHERE LocationName = 'Sac State American River Courtyard') 
AND CreditCardType = 'MasterCard';
```
-------------------------5356 sample_num
```sql
SELECT rb.BrandName
FROM rootbeerreview rbr
JOIN rootbeerbrand rb ON rbr.BrandID = rb.BrandID
WHERE rbr.ReviewDate LIKE '2012%'
AND rb.CaneSugar = 'TRUE'
AND rb.Honey = 'TRUE'
GROUP BY rb.BrandName
ORDER BY MIN(rbr.StarRating)
LIMIT 1;
```
-------------------------5357 sample_num
```sql
SELECT g.Latitude, g.Longitude
FROM transaction t
JOIN customers c ON t.CustomerID = c.CustomerID
JOIN location l ON t.LocationID = l.LocationID
JOIN geolocation g ON l.LocationID = g.LocationID
WHERE c.First = 'Tommy' AND c.Last = 'Kono' AND t.TransactionDate LIKE '2014%';
```
-------------------------5358 sample_num
```sql
SELECT c.Email 
FROM customers c 
JOIN transaction t ON c.CustomerID = t.CustomerID 
WHERE t.TransactionID = 100016;
```
-------------------------5359 sample_num
```sql
SELECT COUNT(*) 
FROM transaction 
WHERE CreditCardType = 'American Express' 
AND RootBeerID IN (SELECT RootBeerID FROM rootbeer WHERE ContainerType = 'Bottle');
```
-------------------------5360 sample_num
```sql
SELECT l.LocationName, COUNT(r.RootBeerID) AS BottleSales
FROM rootbeer r
JOIN location l ON r.LocationID = l.LocationID
WHERE r.ContainerType = 'Bottle'
GROUP BY l.LocationName
ORDER BY BottleSales DESC
LIMIT 1;
```
-------------------------5361 sample_num
```sql
SELECT rb.BrandName
FROM rootbeerbrand rb
JOIN rootbeerreview rbr ON rb.BrandID = rbr.BrandID
WHERE rbr.StarRating = 5
GROUP BY rb.BrandName
ORDER BY COUNT(rbr.StarRating) DESC
LIMIT 3;
```
-------------------------5362 sample_num
```sql
SELECT g.Latitude, g.Longitude
FROM geolocation g
JOIN location l ON g.LocationID = l.LocationID
WHERE l.LocationName = 'Sac State American River Courtyard';
```
-------------------------5363 sample_num
```sql
SELECT COUNT(SalesID) FROM Sales WHERE CustomerID = 80;
```
-------------------------5364 sample_num
```sql
SELECT SUM(Quantity) AS TotalQuantity
FROM Sales
WHERE SalesID BETWEEN 1 AND 10;
```
-------------------------5365 sample_num
```sql
SELECT AVG(Quantity) AS AverageQuantity
FROM Sales
WHERE SalesID BETWEEN 20 AND 30;
```
-------------------------5366 sample_num
```sql
SELECT ProductID 
FROM Sales 
WHERE Quantity = (SELECT MAX(Quantity) FROM Sales);
```
-------------------------5367 sample_num
```sql
SELECT COUNT(ProductID) 
FROM Products 
WHERE Price = (SELECT MIN(Price) FROM Products);
```
-------------------------5368 sample_num
```sql
SELECT Name FROM Products WHERE Price = 0;
```
-------------------------5369 sample_num
```sql
SELECT Name FROM Products WHERE ProductID BETWEEN 1 AND 10;
```
-------------------------5370 sample_num
```sql
SELECT p.Name 
FROM Products p 
JOIN Sales s ON p.ProductID = s.ProductID 
ORDER BY s.Quantity ASC 
LIMIT 1;
```
-------------------------5371 sample_num
```sql
SELECT COUNT(DISTINCT CustomerID) 
FROM Sales 
JOIN Products ON Sales.ProductID = Products.ProductID 
WHERE Products.Name = 'Hex Nut 9';
```
-------------------------5372 sample_num
```sql
SELECT COUNT(SalesID) AS TotalSalesIDs
FROM Sales
JOIN Products ON Sales.ProductID = Products.ProductID
WHERE Products.Name = 'Flat Washer 8';
```
-------------------------5373 sample_num
```sql
SELECT p.Name 
FROM Products p 
JOIN Sales s ON p.ProductID = s.ProductID 
WHERE s.SalesPersonID = 10;
```
-------------------------5374 sample_num
```sql
SELECT c.FirstName 
FROM Customers c 
JOIN Sales s ON c.CustomerID = s.CustomerID 
WHERE s.ProductID = 1;
```
-------------------------5375 sample_num
```sql
SELECT c.LastName 
FROM Customers c 
JOIN Sales s ON c.CustomerID = s.CustomerID 
WHERE s.SalesID = 178;
```
-------------------------5376 sample_num
```sql
SELECT DISTINCT s.ProductID
FROM Sales s
JOIN Customers c ON s.CustomerID = c.CustomerID
WHERE c.FirstName = 'Abby';
```
-------------------------5377 sample_num
```sql
SELECT DISTINCT s.ProductID
FROM Sales s
JOIN Employees e ON s.SalesPersonID = e.EmployeeID
WHERE e.FirstName = 'Meander';
```
-------------------------5378 sample_num
```sql
SELECT e.LastName 
FROM Sales s 
JOIN Employees e ON s.SalesPersonID = e.EmployeeID 
WHERE s.SalesID = 100;
```
-------------------------5379 sample_num
```sql
SELECT e.FirstName 
FROM Employees e
JOIN Sales s ON e.EmployeeID = s.SalesPersonID
JOIN Customers c ON s.CustomerID = c.CustomerID
WHERE c.FirstName = 'Abigail';
```
-------------------------5380 sample_num
```sql
SELECT SUM(Quantity) AS FreeGiftsReceived
FROM Sales
JOIN Products ON Sales.ProductID = Products.ProductID
WHERE Sales.CustomerID = 11782 AND Products.Price = 0;
```
-------------------------5381 sample_num
```sql
SELECT CONCAT(c.FirstName, ' ', c.MiddleInitial, ' ', c.LastName) AS FullName
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
WHERE s.SalesPersonID = 5;
```
-------------------------5382 sample_num
```sql
SELECT SalesID 
FROM Sales 
WHERE SalesPersonID IN (
    SELECT EmployeeID 
    FROM Employees 
    WHERE FirstName LIKE 's%'
);
```
-------------------------5383 sample_num
```sql
SELECT MAX(p.Price) AS HighestPrice
FROM Sales s
JOIN Products p ON s.ProductID = p.ProductID
WHERE s.CustomerID BETWEEN 1 AND 100;
```
-------------------------5384 sample_num
```sql
SELECT c.FirstName, c.LastName, MAX(s.Quantity) AS HighestQuantity
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
WHERE c.LastName = 'Valdez'
GROUP BY c.FirstName, c.LastName
ORDER BY HighestQuantity DESC
LIMIT 1;
```
-------------------------5385 sample_num
```sql
SELECT SUM(SalesID) 
FROM Sales 
WHERE SalesPersonID IN (
    SELECT EmployeeID 
    FROM Employees 
    WHERE FirstName IN ('Morningstar', 'Heather', 'Dean')
);
```
-------------------------5386 sample_num
```sql
SELECT CASE 
           WHEN COUNT(*) > 0 THEN 'Yes' 
           ELSE 'No' 
       END AS HasPurchased
FROM Sales s
JOIN Customers c ON s.CustomerID = c.CustomerID
WHERE s.ProductID = 498 AND c.FirstName = 'Alex';
```
-------------------------5387 sample_num
```sql
SELECT SUM(P.Price * S.Quantity) AS TotalPrice
FROM Sales S
JOIN Products P ON S.ProductID = P.ProductID
JOIN Customers C ON S.CustomerID = C.CustomerID
WHERE C.FirstName = 'Adam';
```
-------------------------5388 sample_num
```sql
SELECT SUM(Price * Quantity) AS TotalPrice
FROM Sales
JOIN Products ON Sales.ProductID = Products.ProductID
WHERE Products.ProductID BETWEEN 400 AND 500;
```
-------------------------5389 sample_num
```sql
SELECT SUM(S.Quantity) AS TotalQuantity
FROM Sales S
JOIN Products P ON S.ProductID = P.ProductID
WHERE P.Name LIKE 'C%';
```
-------------------------5390 sample_num
```sql
SELECT SUM(S.Quantity) AS TotalQuantity
FROM Sales S
JOIN Customers C ON S.CustomerID = C.CustomerID
WHERE C.FirstName = 'Adrian';
```
-------------------------5391 sample_num
```sql
SELECT ProductID 
FROM Products 
ORDER BY Price DESC 
LIMIT 5;
```
-------------------------5392 sample_num
```sql
SELECT COUNT(*) AS FreebieCount FROM Products WHERE Price = 0;
```
-------------------------5393 sample_num
```sql
SELECT p.Name 
FROM Products p 
JOIN Sales s ON p.ProductID = s.ProductID 
WHERE s.Quantity > 950;
```
-------------------------5394 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.MiddleInitial, ' ', e.LastName) AS FullName
FROM Employees e
JOIN Sales s ON e.EmployeeID = s.SalesPersonID
WHERE s.Quantity = 1000;
```
-------------------------5395 sample_num
```sql
SELECT p.Name, s.Quantity
FROM Sales s
JOIN Products p ON s.ProductID = p.ProductID
WHERE s.SalesID BETWEEN 1 AND 10;
```
-------------------------5396 sample_num
```sql
SELECT SUM(P.Price * S.Quantity) AS TotalSalesAmount
FROM Sales S
JOIN Products P ON S.ProductID = P.ProductID
WHERE P.Name = 'Reflector';
```
-------------------------5397 sample_num
```sql
SELECT 
    CASE 
        WHEN SUM(CASE WHEN p.Name = 'HL Mountain Frame - Silver, 42' THEN s.Quantity ELSE 0 END) > 
             SUM(CASE WHEN p.Name = 'HL Mountain Frame - Black, 42' THEN s.Quantity ELSE 0 END) 
        THEN 'Silver' 
        ELSE 'Black' 
    END AS BestSellingColour
FROM 
    Sales s
JOIN 
    Products p ON s.ProductID = p.ProductID
WHERE 
    p.Name IN ('HL Mountain Frame - Silver, 42', 'HL Mountain Frame - Black, 42');
```
-------------------------5398 sample_num
```sql
SELECT 
    (SELECT Price FROM Products WHERE Name = 'HL Mountain Frame - Black, 42') - 
    (SELECT Price FROM Products WHERE Name = 'LL Mountain Frame - Black, 42') AS PriceDifference;
```
-------------------------5399 sample_num
```sql
SELECT SUM(s.Quantity) AS TotalSales
FROM Sales s
JOIN Employees e ON s.SalesPersonID = e.EmployeeID
WHERE e.FirstName = 'Michel' AND e.MiddleInitial = 'E' AND e.LastName = 'DeFrance';
```
-------------------------5400 sample_num
```sql
SELECT AVG(CustomerCount) AS AverageCustomersPerSalesPerson
FROM (
    SELECT SalesPersonID, COUNT(DISTINCT CustomerID) AS CustomerCount
    FROM Sales
    GROUP BY SalesPersonID
) AS SalesCounts;
```
-------------------------5401 sample_num
```sql
SELECT COUNT(DISTINCT s.CustomerID) 
FROM Sales s
JOIN Employees e ON s.SalesPersonID = e.EmployeeID
JOIN Products p ON s.ProductID = p.ProductID
WHERE e.FirstName = 'Innes' AND e.MiddleInitial = 'E.' AND e.LastName = 'del Castillo'
AND p.Name = 'Short-Sleeve Classic Jersey, L';
```
-------------------------5402 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.MiddleInitial, ' ', e.LastName) AS SalesPersonName
FROM Sales s
JOIN Employees e ON s.SalesPersonID = e.EmployeeID
JOIN Customers c ON s.CustomerID = c.CustomerID
JOIN Products p ON s.ProductID = p.ProductID
WHERE c.FirstName = 'Elizabeth' AND c.MiddleInitial = 'A' AND c.LastName = 'White'
AND p.Name = 'Road-250 Black, 48';
```
-------------------------5403 sample_num
```sql
SELECT COUNT(DISTINCT SalesPersonID) AS SalesPeopleCount
FROM Sales
JOIN Products ON Sales.ProductID = Products.ProductID
WHERE Products.Name = 'Headlights - Weatherproof';
```
-------------------------5404 sample_num
```sql
SELECT SUM(S.Quantity * P.Price) AS Revenue
FROM Sales S
JOIN Products P ON S.ProductID = P.ProductID
WHERE P.Name = 'HL Road Frame - Red, 56';
```
-------------------------5405 sample_num
```sql
SELECT COUNT(SalesID) 
FROM Sales 
WHERE CustomerID = (SELECT CustomerID FROM Customers WHERE FirstName = 'Joe' AND MiddleInitial = 'L' AND LastName = 'Lopez');
```
-------------------------5406 sample_num
```sql
SELECT CONCAT(c.FirstName, ' ', c.MiddleInitial, ' ', c.LastName) AS CustomerName
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
JOIN Products p ON s.ProductID = p.ProductID
WHERE p.Name = 'Touring Rim';
```
-------------------------5407 sample_num
```sql
SELECT e.EmployeeID, e.FirstName, e.LastName, COUNT(DISTINCT s.CustomerID) AS NumberOfCustomers
FROM Employees e
LEFT JOIN Sales s ON e.EmployeeID = s.SalesPersonID
GROUP BY e.EmployeeID, e.FirstName, e.LastName;
```
-------------------------5408 sample_num
```sql
SELECT COUNT(DISTINCT SalesPersonID) AS SalesPeopleCount
FROM Sales
WHERE CustomerID IS NOT NULL;
```
-------------------------5409 sample_num
```sql
SELECT FirstName, MiddleInitial, LastName 
FROM Employees 
WHERE EmployeeID = 7;
```
-------------------------5410 sample_num
```sql
SELECT 
    (SELECT Name FROM Products WHERE Price = (SELECT MAX(Price) FROM Products WHERE Price > 0)) AS MostExpensiveProduct,
    (SELECT Name FROM Products WHERE Price = (SELECT MIN(Price) FROM Products WHERE Price > 0)) AS LeastExpensiveProduct;
```
-------------------------5411 sample_num
```sql
SELECT 
    (SUM(CASE WHEN e.FirstName = 'Albert' AND e.MiddleInitial = 'I' AND e.LastName = 'Ringer' THEN s.Quantity ELSE 0 END) * 1.0 / COUNT(s.CustomerID)) * 100 AS Percentage
FROM 
    Sales s
JOIN 
    Products p ON s.ProductID = p.ProductID
JOIN 
    Customers c ON s.CustomerID = c.CustomerID
JOIN 
    Employees e ON s.SalesPersonID = e.EmployeeID
WHERE 
    p.Name = 'ML Bottom Bracket';
```
-------------------------5412 sample_num
```sql
SELECT COUNT(*) FROM Customers WHERE FirstName = 'Abigail';
```
-------------------------5413 sample_num
```sql
SELECT SUM(Quantity) AS TotalBladeSold
FROM Sales s
JOIN Products p ON s.ProductID = p.ProductID
WHERE p.Name = 'Blade';
```
-------------------------5414 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.LastName) AS FullName
FROM Employees e
JOIN Sales s ON e.EmployeeID = s.SalesPersonID
GROUP BY e.EmployeeID
ORDER BY SUM(s.Quantity) DESC
LIMIT 1;
```
-------------------------5415 sample_num
```sql
SELECT CONCAT(c.FirstName, ' ', c.LastName) AS FullName
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
GROUP BY c.CustomerID, c.FirstName, c.LastName
ORDER BY SUM(s.Quantity) DESC
LIMIT 1;
```
-------------------------5416 sample_num
```sql
SELECT p.Name
FROM Sales s
JOIN Products p ON s.ProductID = p.ProductID
WHERE s.SalesPersonID = 20
GROUP BY p.Name
ORDER BY SUM(s.Quantity) DESC
LIMIT 1;
```
-------------------------5417 sample_num
```sql
SELECT DISTINCT e.FirstName
FROM Employees e
JOIN Sales s ON e.EmployeeID = s.SalesPersonID
WHERE s.Quantity > 500;
```
-------------------------5418 sample_num
```sql
SELECT Customers.FirstName
FROM Customers
JOIN Sales ON Customers.CustomerID = Sales.CustomerID
WHERE Sales.SalesPersonID = 1;
```
-------------------------5419 sample_num
```sql
SELECT SUM(S.Quantity) AS TotalTradingQuantity
FROM Sales S
JOIN Employees E ON S.SalesPersonID = E.EmployeeID
JOIN Customers C ON S.CustomerID = C.CustomerID
WHERE E.FirstName = 'Abraham' AND C.FirstName = 'Aaron' AND C.LastName = 'Alexander';
```
-------------------------5420 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Customers
JOIN Sales ON Customers.CustomerID = Sales.CustomerID
WHERE Sales.Quantity > 600;
```
-------------------------5421 sample_num
```sql
SELECT c.FirstName, c.LastName, SUM(s.Quantity) AS TotalQuantity
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
WHERE c.FirstName = 'Cameron'
GROUP BY c.CustomerID, c.FirstName, c.LastName
ORDER BY TotalQuantity DESC
LIMIT 1;
```
-------------------------5422 sample_num
```sql
SELECT SalesID 
FROM Sales 
JOIN Products ON Sales.ProductID = Products.ProductID 
WHERE Products.Name = 'Hex Nut' AND Products.Price > 100;
```
-------------------------5423 sample_num
```sql
SELECT DISTINCT CustomerID 
FROM Sales 
JOIN Products ON Sales.ProductID = Products.ProductID 
WHERE Products.Price BETWEEN 1000 AND 2000;
```
-------------------------5424 sample_num
```sql
SELECT SUM(Quantity) AS TotalQuantity
FROM Sales s
JOIN Products p ON s.ProductID = p.ProductID
WHERE p.Price = 0;
```
-------------------------5425 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.Price = 0 THEN s.Quantity ELSE 0 END) * 1.0 / SUM(s.Quantity)) * 100 AS GiftProductPercentage
FROM 
    Sales s
JOIN 
    Products p ON s.ProductID = p.ProductID;
```
-------------------------5426 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.Name = 'Blade' THEN s.Quantity ELSE 0 END) * 1.0 / SUM(s.Quantity)) * 100 AS BladePercentage
FROM 
    Sales s
JOIN 
    Products p ON s.ProductID = p.ProductID;
```
-------------------------5427 sample_num
```sql
SELECT COUNT(*) FROM Employees WHERE LastName = 'Ringer';
```
-------------------------5428 sample_num
```sql
SELECT COUNT(*) 
FROM Products 
WHERE ProductID < 15 AND Price <= 10;
```
-------------------------5429 sample_num
```sql
SELECT p.Name 
FROM Sales s
JOIN Employees e ON s.SalesPersonID = e.EmployeeID
JOIN Products p ON s.ProductID = p.ProductID
WHERE e.FirstName = 'Aaron' AND e.LastName = 'Alexander';
```
-------------------------5430 sample_num
```sql
SELECT ProductID, Name 
FROM Products 
WHERE ProductID IN (
    SELECT ProductID 
    FROM Sales 
    WHERE Quantity BETWEEN 400 AND 500
) 
ORDER BY Price DESC 
LIMIT 1;
```
-------------------------5431 sample_num
```sql
SELECT c.FirstName, c.LastName, MAX(s.Quantity) AS HighestQuantity
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
WHERE c.FirstName = 'Kate'
GROUP BY c.CustomerID, c.FirstName, c.LastName
ORDER BY HighestQuantity DESC
LIMIT 1;
```
-------------------------5432 sample_num
```sql
SELECT CustomerID, SalesID 
FROM Sales 
WHERE ProductID IN (SELECT ProductID FROM Products WHERE Price BETWEEN 100 AND 150) 
AND Quantity < 25;
```
-------------------------5433 sample_num
```sql
SELECT S.Quantity, P.Price
FROM Sales S
JOIN Customers C ON S.CustomerID = C.CustomerID
JOIN Products P ON S.ProductID = P.ProductID
WHERE C.FirstName = 'Abigail' AND C.LastName = 'Henderson';
```
-------------------------5434 sample_num
```sql
SELECT COUNT(*) 
FROM Sales s
JOIN Products p ON s.ProductID = p.ProductID
WHERE s.Quantity = 60 AND p.Price <= 500;
```
-------------------------5435 sample_num
```sql
SELECT COUNT(DISTINCT c.CustomerID) 
FROM Customers c 
JOIN Sales s ON c.CustomerID = s.CustomerID 
WHERE c.FirstName = 'Erica' AND s.Quantity < 200;
```
-------------------------5436 sample_num
```sql
SELECT p.Name
FROM Sales s
JOIN Customers c ON s.CustomerID = c.CustomerID
JOIN Products p ON s.ProductID = p.ProductID
WHERE c.FirstName = 'Kathryn' AND c.LastName = 'Ashe'
ORDER BY s.Quantity DESC
LIMIT 1;
```
-------------------------5437 sample_num
```sql
SELECT p.Price, s.Quantity 
FROM Products p 
JOIN Sales s ON p.ProductID = s.ProductID 
WHERE p.Name = 'Seat Tube';
```
-------------------------5438 sample_num
```sql
SELECT p.Name, p.Price
FROM Products p
JOIN Sales s ON p.ProductID = s.ProductID
JOIN Customers c ON s.CustomerID = c.CustomerID
WHERE c.FirstName = 'Erica' AND c.LastName = 'Xu';
```
-------------------------5439 sample_num
```sql
SELECT SalesID 
FROM Sales 
WHERE Quantity = 590 
AND ProductID = (SELECT ProductID FROM Products WHERE Name = 'External Lock Washer 7');
```
-------------------------5440 sample_num
```sql
SELECT c.FirstName, c.LastName
FROM Sales s
JOIN Customers c ON s.CustomerID = c.CustomerID
WHERE s.SalesID BETWEEN 30 AND 40
GROUP BY c.CustomerID, c.FirstName, c.LastName
HAVING SUM(s.Quantity) = 403;
```
-------------------------5441 sample_num
```sql
SELECT DISTINCT c.CustomerID, c.LastName
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
WHERE s.Quantity > (SELECT AVG(Quantity) * 0.9 FROM Sales);
```
-------------------------5442 sample_num
```sql
SELECT 
    (SUM(CASE WHEN p.Price BETWEEN 200 AND 300 THEN 1 ELSE 0 END) * 100.0) / COUNT(p.Price) AS Percentage
FROM 
    Sales s
JOIN 
    Products p ON s.ProductID = p.ProductID
WHERE 
    s.SalesID BETWEEN 1 AND 200;
```
-------------------------5443 sample_num
```sql
SELECT Name FROM Products WHERE Price = (SELECT MAX(Price) FROM Products);
```
-------------------------5444 sample_num
```sql
SELECT COUNT(*) FROM Customers WHERE FirstName = 'Madison';
```
-------------------------5445 sample_num
```sql
SELECT COUNT(*) 
FROM Products 
WHERE Name LIKE '%HL Touring Frame%';
```
-------------------------5446 sample_num
```sql
SELECT COUNT(*) AS CustomerCount
FROM Customers
WHERE LastName IN (
    SELECT LastName
    FROM Customers
    GROUP BY LastName
    ORDER BY COUNT(*) DESC
    LIMIT 1
);
```
-------------------------5447 sample_num
```sql
SELECT COUNT(*) AS FreeGiftCount FROM Products WHERE Price = 0;
```
-------------------------5448 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.MiddleInitial, ' ', e.LastName) AS SalesPersonName
FROM Sales s
JOIN Employees e ON s.SalesPersonID = e.EmployeeID
GROUP BY e.EmployeeID, e.FirstName, e.MiddleInitial, e.LastName
ORDER BY COUNT(s.SalesID) DESC
LIMIT 1;
```
-------------------------5449 sample_num
```sql
SELECT CONCAT(c.FirstName, ' ', c.MiddleInitial, ' ', c.LastName) AS FullName
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
JOIN Products p ON s.ProductID = p.ProductID
ORDER BY s.Quantity * p.Price DESC
LIMIT 1;
```
-------------------------5450 sample_num
```sql
SELECT SUM(Quantity) AS TotalSold
FROM Sales s
JOIN Products p ON s.ProductID = p.ProductID
WHERE p.Name = 'Mountain-500 Black 42';
```
-------------------------5451 sample_num
```sql
SELECT SUM(s.Quantity * p.Price) AS TotalSales
FROM Sales s
JOIN Employees e ON s.SalesPersonID = e.EmployeeID
JOIN Products p ON s.ProductID = p.ProductID
WHERE e.FirstName = 'Heather' AND e.LastName = 'McBadden';
```
-------------------------5452 sample_num
```sql
SELECT SUM(S.Quantity) AS TotalSold
FROM Sales S
JOIN Employees E ON S.SalesPersonID = E.EmployeeID
JOIN Products P ON S.ProductID = P.ProductID
WHERE E.FirstName = 'Stearns' AND E.LastName = 'MacFeather' AND P.Name = 'Mountain-100 Silver, 38';
```
-------------------------5453 sample_num
```sql
SELECT COUNT(DISTINCT p.ProductID) AS ProductTypes
FROM Sales s
JOIN Customers c ON s.CustomerID = c.CustomerID
JOIN Products p ON s.ProductID = p.ProductID
WHERE c.FirstName = 'Dalton' AND c.MiddleInitial = 'M' AND c.LastName = 'Coleman';
```
-------------------------5454 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.MiddleInitial, ' ', e.LastName) AS FullName, COUNT(s.SalesID) AS SalesCount
FROM Employees e
JOIN Sales s ON e.EmployeeID = s.SalesPersonID
GROUP BY e.EmployeeID
ORDER BY SalesCount DESC
LIMIT 3;
```
-------------------------5455 sample_num
```sql
SELECT ProductID
FROM Sales
WHERE ProductID IN (SELECT ProductID FROM Products WHERE Name LIKE 'Mountain-500 Black%')
GROUP BY ProductID
ORDER BY SUM(Quantity) DESC
LIMIT 1;
```
-------------------------5456 sample_num
```sql
SELECT COUNT(DISTINCT Sales.SalesPersonID) AS NumberOfEmployees
FROM Sales
JOIN Products ON Sales.ProductID = Products.ProductID
WHERE Products.Name = 'ML Road Frame-W - Yellow, 40';
```
-------------------------5457 sample_num
```sql
SELECT SUM(Quantity) 
FROM Sales 
WHERE SalesID = 551971 AND ProductID = (SELECT ProductID FROM Products WHERE Name = 'Chainring Bolts');
```
-------------------------5458 sample_num
```sql
SELECT COUNT(DISTINCT s.SalesPersonID) AS EmployeeCount
FROM Sales s
JOIN Products p ON s.ProductID = p.ProductID
WHERE p.Name = 'Touring-2000 Blue, 50' AND s.Quantity > 20000;
```
-------------------------5459 sample_num
```sql
SELECT SUM(S.Quantity * P.Price) AS TotalCost
FROM Sales S
JOIN Products P ON S.ProductID = P.ProductID
JOIN Employees E ON S.SalesPersonID = E.EmployeeID
WHERE P.Name = 'Road-650, Red, 60' AND E.FirstName = 'Abraham' AND E.MiddleInitial = 'E.' AND E.LastName = 'Bennet';
```
-------------------------5460 sample_num
```sql
SELECT P.Name, SUM(S.Quantity * P.Price) AS TotalPrice
FROM Sales S
JOIN Products P ON S.ProductID = P.ProductID
GROUP BY P.ProductID
ORDER BY SUM(S.Quantity) DESC
LIMIT 1;
```
-------------------------5461 sample_num
```sql
SELECT FirstName FROM Customers WHERE LastName = 'Chen';
```
-------------------------5462 sample_num
```sql
SELECT MiddleInitial
FROM Employees
GROUP BY MiddleInitial
ORDER BY COUNT(MiddleInitial) DESC
LIMIT 1;
```
-------------------------5463 sample_num
```sql
SELECT AVG(Price) AS AveragePrice
FROM Products
WHERE Price BETWEEN 100 AND 200;
```
-------------------------5464 sample_num
```sql
SELECT CONCAT(c.FirstName, ' ', c.MiddleInitial, ' ', c.LastName) AS FullName
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
WHERE s.Quantity > (SELECT AVG(Quantity) FROM Sales);
```
-------------------------5465 sample_num
```sql
SELECT CONCAT(c.FirstName, ' ', c.MiddleInitial, ' ', c.LastName) AS FullName
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
JOIN Products p ON s.ProductID = p.ProductID
GROUP BY c.CustomerID
ORDER BY SUM(s.Quantity * p.Price) DESC
LIMIT 1;
```
-------------------------5466 sample_num
```sql
SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(s.Quantity * p.Price) AS TotalSales
FROM Employees e
JOIN Sales s ON e.EmployeeID = s.SalesPersonID
JOIN Products p ON s.ProductID = p.ProductID
WHERE p.Name = 'Blade'
GROUP BY e.EmployeeID, e.FirstName, e.LastName
ORDER BY TotalSales DESC
LIMIT 1;
```
-------------------------5467 sample_num
```sql
SELECT CONCAT(c.FirstName, ' ', c.MiddleInitial, ' ', c.LastName) AS FullName, SUM(s.Quantity * p.Price) AS TotalSpent
FROM Customers c
JOIN Sales s ON c.CustomerID = s.CustomerID
JOIN Products p ON s.ProductID = p.ProductID
GROUP BY c.CustomerID
HAVING TotalSpent > 50000
ORDER BY TotalSpent DESC;
```
-------------------------5468 sample_num
```sql
SELECT p.Name
FROM Sales s
JOIN Products p ON s.ProductID = p.ProductID
GROUP BY p.Name
ORDER BY SUM(s.Quantity) DESC
LIMIT 1;
```
-------------------------5469 sample_num
```sql
SELECT DISTINCT p.ProductID, p.Name
FROM Products p
JOIN Sales s ON p.ProductID = s.ProductID
GROUP BY p.ProductID, p.Name
HAVING AVG(s.Quantity) < (SELECT AVG(Quantity) FROM Sales);
```
-------------------------5470 sample_num
```sql
SELECT COUNT(*) 
FROM Dish 
WHERE first_appeared < 1851 OR first_appeared > 2012;
```
-------------------------5471 sample_num
```sql
SELECT 
    CASE 
        WHEN (last_appeared - first_appeared) FILTER (WHERE name = 'Anchovies') > (last_appeared - first_appeared) FILTER (WHERE name = 'Fresh lobsters in every style') THEN 'Anchovies'
        WHEN (last_appeared - first_appeared) FILTER (WHERE name = 'Fresh lobsters in every style') > (last_appeared - first_appeared) FILTER (WHERE name = 'Anchovies') THEN 'Fresh lobsters in every style'
        ELSE 'Both lasted the same duration'
    END AS longer_dish
FROM Dish
WHERE name IN ('Anchovies', 'Fresh lobsters in every style');
```
-------------------------5472 sample_num
```sql
SELECT name 
FROM Dish 
WHERE lowest_price = 0 
ORDER BY menus_appeared DESC 
LIMIT 1;
```
-------------------------5473 sample_num
```sql
SELECT COUNT(*) 
FROM Menu 
WHERE name = 'Waldorf Astoria' AND page_count = 4;
```
-------------------------5474 sample_num
```sql
SELECT d.name 
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
WHERE mi.menu_page_id = 1389 AND mi.xpos < 0.25 AND mi.ypos < 0.25;
```
-------------------------5475 sample_num
```sql
SELECT mi.price 
FROM Dish d 
JOIN MenuItem mi ON d.id = mi.dish_id 
JOIN MenuPage mp ON mi.menu_page_id = mp.id 
WHERE d.name = 'Clear green turtle';
```
-------------------------5476 sample_num
```sql
SELECT COUNT(DISTINCT mp.id) AS stable_price_menu_pages
FROM MenuPage mp
JOIN MenuItem mi ON mp.id = mi.menu_page_id
JOIN Dish d ON mi.dish_id = d.id
WHERE d.name = 'Clear green turtle' AND mi.high_price IS NULL;
```
-------------------------5477 sample_num
```sql
SELECT MAX(mi.high_price) AS highest_price
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
WHERE d.name = 'Clear green turtle';
```
-------------------------5478 sample_num
```sql
SELECT DISTINCT m.id
FROM Menu m
JOIN MenuItem mi ON m.id = mi.menu_page_id
JOIN Dish d ON mi.dish_id = d.id
WHERE d.name = 'Clear green turtle';
```
-------------------------5479 sample_num
```sql
SELECT COUNT(DISTINCT m.id) 
FROM Menu m 
JOIN MenuItem mi ON m.id = mi.menu_page_id 
JOIN Dish d ON mi.dish_id = d.id 
WHERE d.name = 'Clear green turtle' AND m.currency = 'Dollars';
```
-------------------------5480 sample_num
```sql
SELECT COUNT(DISTINCT m.id) 
FROM Menu m 
JOIN MenuItem mi ON m.id = mi.menu_page_id 
JOIN Dish d ON mi.dish_id = d.id 
WHERE d.name = 'Clear green turtle' 
AND m.call_number IS NULL;
```
-------------------------5481 sample_num
```sql
SELECT d.name 
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
JOIN Menu m ON mp.menu_id = m.id
WHERE m.name = 'Zentral Theater Terrace';
```
-------------------------5482 sample_num
```sql
SELECT d.name 
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
JOIN Menu m ON mi.menu_page_id = (SELECT mp.id FROM MenuPage mp WHERE mp.menu_id = m.id)
WHERE m.name = 'Zentral Theater Terrace'
ORDER BY mi.high_price DESC
LIMIT 1;
```
-------------------------5483 sample_num
```sql
SELECT COUNT(DISTINCT di.id) AS dish_count
FROM Menu m
JOIN MenuItem mi ON m.id = mi.menu_page_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
JOIN Dish di ON mi.dish_id = di.id
WHERE m.name = 'Zentral Theater Terrace';
```
-------------------------5484 sample_num
```sql
SELECT SUM(m.dish_count) 
FROM Menu m 
WHERE m.name = 'Waldorf Astoria';
```
-------------------------5485 sample_num
```sql
SELECT DISTINCT m.id 
FROM Menu m 
JOIN MenuItem mi ON m.id = mi.menu_page_id 
JOIN Dish d ON mi.dish_id = d.id 
WHERE m.sponsor IS NULL AND d.name = 'Clear green turtle';
```
-------------------------5486 sample_num
```sql
SELECT AVG(mp.page_number) AS average_page_number
FROM Menu m
JOIN MenuPage mp ON m.id = mp.menu_id
JOIN MenuItem mi ON mp.id = mi.menu_page_id
JOIN Dish d ON mi.dish_id = d.id
WHERE d.name = 'Clear green turtle';
```
-------------------------5487 sample_num
```sql
SELECT AVG(mi.price) AS average_price
FROM Menu m
JOIN MenuItem mi ON m.id = mi.menu_page_id
WHERE m.name = 'Zentral Theater Terrace';
```
-------------------------5488 sample_num
```sql
SELECT COUNT(*) 
FROM MenuItem 
WHERE created_at LIKE '2011-03-28%';
```
-------------------------5489 sample_num
```sql
SELECT COUNT(*) 
FROM MenuItem 
WHERE menu_page_id = 144;
```
-------------------------5490 sample_num
```sql
SELECT COUNT(*) 
FROM Menu 
WHERE location = 'Dutcher House';
```
-------------------------5491 sample_num
```sql
SELECT COUNT(*) 
FROM Dish 
WHERE times_appeared > menus_appeared;
```
-------------------------5492 sample_num
```sql
SELECT COUNT(*) FROM Menu WHERE venue = 'STEAMSHIP';
```
-------------------------5493 sample_num
```sql
SELECT COUNT(*) 
FROM Menu 
WHERE date = '1898-11-17';
```
-------------------------5494 sample_num
```sql
SELECT Dish.name 
FROM Dish 
JOIN MenuItem ON Dish.id = MenuItem.dish_id 
WHERE MenuItem.menu_page_id = 174;
```
-------------------------5495 sample_num
```sql
SELECT d.name, mp.id 
FROM Dish d 
JOIN MenuItem mi ON d.id = mi.dish_id 
JOIN MenuPage mp ON mi.menu_page_id = mp.id 
WHERE d.first_appeared = 1861;
```
-------------------------5496 sample_num
```sql
SELECT d.name, MAX(mi.high_price) AS highest_price
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
WHERE mi.menu_page_id = 7610 AND mi.created_at LIKE '2011-05-23%'
GROUP BY d.name;
```
-------------------------5497 sample_num
```sql
SELECT d.*
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
WHERE mp.page_number = 30
ORDER BY mp.full_height ASC
LIMIT 1;
```
-------------------------5498 sample_num
```sql
SELECT mp.page_number, m.name
FROM Menu m
JOIN MenuPage mp ON m.id = mp.menu_id
WHERE m.page_count = (SELECT MAX(page_count) FROM Menu);
```
-------------------------5499 sample_num
```sql
SELECT COUNT(DISTINCT mi.dish_id) AS dish_count
FROM Menu m
JOIN MenuPage mp ON m.id = mp.menu_id
JOIN MenuItem mi ON mp.id = mi.menu_page_id
WHERE m.id = (SELECT id FROM Menu ORDER BY dish_count DESC LIMIT 1)
AND mp.page_number = 2;
```
-------------------------5500 sample_num
```sql
SELECT mi.id 
FROM MenuItem mi 
JOIN Dish d ON mi.dish_id = d.id 
WHERE d.name = 'Fresh lobsters in every style';
```
-------------------------5501 sample_num
```sql
SELECT d.*
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
JOIN Menu m ON mp.menu_id = m.id
WHERE m.sponsor = 'CHAS.BRADLEY''S OYSTER & DINING ROOM'
AND mi.xpos < 0.25
AND mi.ypos < 0.25;
```
-------------------------5502 sample_num
```sql
SELECT m.sponsor, m.event
FROM Menu m
JOIN MenuItem mi ON m.id = mi.menu_id
JOIN Dish d ON mi.dish_id = d.id
WHERE d.name = 'Cerealine with Milk';
```
-------------------------5503 sample_num
```sql
SELECT 
    (SUM(CASE WHEN xpos BETWEEN 0.25 AND 0.75 AND ypos BETWEEN 0.25 AND 0.75 THEN 1 ELSE 0 END) * 100.0 / COUNT(id)) AS percent
FROM 
    Dish d
JOIN 
    MenuItem mi ON d.id = mi.dish_id
JOIN 
    MenuPage mp ON mi.menu_page_id = mp.id
WHERE 
    d.name LIKE '%Bluefish%';
```
-------------------------5504 sample_num
```sql
SELECT sponsor FROM Menu WHERE id = 12463;
```
-------------------------5505 sample_num
```sql
SELECT event FROM Menu WHERE sponsor = 'REPUBLICAN HOUSE';
```
-------------------------5506 sample_num
```sql
SELECT place FROM Menu WHERE id = 12472;
```
-------------------------5507 sample_num
```sql
SELECT physical_description FROM Menu WHERE sponsor = 'Noviomagus';
```
-------------------------5508 sample_num
```sql
SELECT occasion FROM Menu WHERE id = 12463;
```
-------------------------5509 sample_num
```sql
SELECT location FROM Menu WHERE sponsor = 'Norddeutscher Lloyd Bremen';
```
-------------------------5510 sample_num
```sql
SELECT mp.id 
FROM MenuPage mp
JOIN Menu m ON mp.menu_id = m.id
WHERE m.sponsor = 'Occidental & Oriental';
```
-------------------------5511 sample_num
```sql
SELECT DISTINCT mp.image_id
FROM Menu m
JOIN MenuPage mp ON m.id = mp.menu_id
WHERE m.location = 'Manhattan Hotel';
```
-------------------------5512 sample_num
```sql
SELECT mp.full_height, mp.full_width 
FROM Menu m 
JOIN MenuPage mp ON m.id = mp.menu_id 
WHERE m.name = 'El Fuerte Del Palmar';
```
-------------------------5513 sample_num
```sql
SELECT m.uuid 
FROM Menu m 
WHERE m.name = 'The Biltmore' AND m.uuid = 'c02c9a3b-6881-7080-e040-e00a180631aa';
```
-------------------------5514 sample_num
```sql
SELECT m.name 
FROM Menu m 
JOIN MenuPage mp ON m.id = mp.menu_id 
WHERE mp.full_height = (SELECT MAX(full_height) FROM MenuPage);
```
-------------------------5515 sample_num
```sql
SELECT m.page_count 
FROM Menu m 
JOIN MenuPage mp ON m.id = mp.menu_id 
WHERE mp.id = 130;
```
-------------------------5516 sample_num
```sql
SELECT MIN(mi.price) AS price
FROM MenuItem mi
JOIN MenuPage mp ON mi.menu_page_id = mp.id
WHERE mp.image_id = 4000009194;
```
-------------------------5517 sample_num
```sql
SELECT DISTINCT mp.page_number
FROM MenuPage mp
JOIN MenuItem mi ON mp.id = mi.menu_page_id
WHERE mi.xpos > 0.75 AND mi.ypos < 0.25;
```
-------------------------5518 sample_num
```sql
SELECT DISTINCT d.name
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
JOIN Menu m ON mp.menu_id = m.id
WHERE SUBSTR(m.created_at, 6, 2) = '04';
```
-------------------------5519 sample_num
```sql
SELECT Dish.name 
FROM Dish 
JOIN MenuItem ON Dish.id = MenuItem.dish_id 
JOIN MenuPage ON MenuItem.menu_page_id = MenuPage.id 
WHERE MenuPage.id = 1389;
```
-------------------------5520 sample_num
```sql
SELECT MAX(price) AS highest_price 
FROM MenuItem 
WHERE id BETWEEN 1 AND 5;
```
-------------------------5521 sample_num
```sql
SELECT d.name 
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
WHERE mi.xpos < 0.25 AND mi.ypos < 0.25;
```
-------------------------5522 sample_num
```sql
SELECT SUM(dish_count) AS total_dish_count
FROM Menu
WHERE uuid IN ('510d47e4-2958-a3d9-e040-e00a18064a99', '510d47e4-295a-a3d9-e040-e00a18064a99');
```
-------------------------5523 sample_num
```sql
SELECT SUM(mi.price) AS total_price
FROM MenuItem mi
JOIN MenuPage mp ON mi.menu_page_id = mp.id
WHERE mp.menu_id = 12882;
```
-------------------------5524 sample_num
```sql
SELECT d.id, d.name, d.highest_price
FROM Dish d
ORDER BY d.highest_price DESC
LIMIT 5;
```
-------------------------5525 sample_num
```sql
SELECT COUNT(*) AS free_dish_count FROM Dish WHERE lowest_price = 0;
```
-------------------------5526 sample_num
```sql
SELECT * FROM Dish 
WHERE first_appeared = 1855 AND last_appeared = 1900;
```
-------------------------5527 sample_num
```sql
SELECT * FROM Menu ORDER BY dish_count DESC LIMIT 10;
```
-------------------------5528 sample_num
```sql
SELECT COUNT(DISTINCT dish_id) 
FROM MenuItem 
WHERE xpos > 0.75 AND ypos < 0.25;
```
-------------------------5529 sample_num
```sql
SELECT 
    DATEDIFF(Dish.last_appeared, Dish.first_appeared) AS duration_on_menu,
    Dish.updated_at AS latest_update
FROM 
    Dish
WHERE 
    Dish.name = 'Clear Green Turtle';
```
-------------------------5530 sample_num
```sql
SELECT COUNT(*) AS dish_count
FROM Dish
WHERE (last_appeared - first_appeared) > 100;
```
-------------------------5531 sample_num
```sql
SELECT COUNT(*) 
FROM Dish 
WHERE (last_appeared - first_appeared) < 5;
```
-------------------------5532 sample_num
```sql
SELECT d.name, mi.price 
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
WHERE d.lowest_price = 0;
```
-------------------------5533 sample_num
```sql
SELECT mi.price 
FROM MenuItem mi 
JOIN MenuPage mp ON mi.menu_page_id = mp.id 
WHERE mp.menu_id = 12474 AND mp.page_number = 2;
```
-------------------------5534 sample_num
```sql
SELECT COUNT(*) 
FROM Dish 
WHERE created_at BETWEEN '2011-03-31 20:24:46 UTC' AND '2011-04-15 23:09:51 UTC';
```
-------------------------5535 sample_num
```sql
SELECT DISTINCT m.sponsor
FROM Menu m
JOIN MenuPage mp ON m.id = mp.menu_id
WHERE mp.full_height > 10000;
```
-------------------------5536 sample_num
```sql
SELECT mp.image_id, mp.full_height, mp.full_width
FROM Menu m
JOIN MenuPage mp ON m.id = mp.menu_id
WHERE m.event = '100TH ANNIVERSARY OF BIRTH OF DANIEL WEBSTER';
```
-------------------------5537 sample_num
```sql
SELECT DISTINCT m.event
FROM MenuPage mp
JOIN Menu m ON mp.menu_id = m.id
WHERE mp.full_width < 2000;
```
-------------------------5538 sample_num
```sql
SELECT D.name 
FROM Dish D 
JOIN MenuItem MI ON D.id = MI.dish_id 
WHERE MI.price = 180000;
```
-------------------------5539 sample_num
```sql
SELECT mi.xpos, mi.ypos, DATEDIFF(d.last_appeared, d.first_appeared) AS duration
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
WHERE d.name = 'Small Hominy';
```
-------------------------5540 sample_num
```sql
SELECT mp.page_number, mp.image_id, (mp.full_height * mp.full_width) AS image_area
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
JOIN Menu m ON mp.menu_id = m.id
WHERE d.name = 'Baked Stuffed Mullet & Sauce Pomard';
```
-------------------------5541 sample_num
```sql
SELECT COUNT(*) 
FROM Dish 
WHERE times_appeared > menus_appeared;
```
-------------------------5542 sample_num
```sql
SELECT COUNT(*) 
FROM Menu 
WHERE sponsor = 'Krogs Fiske Restaurant' AND date LIKE '2015-04%';
```
-------------------------5543 sample_num
```sql
SELECT name, MAX(DATEDIFF(last_appeared, first_appeared)) AS history_length
FROM Dish
GROUP BY id
ORDER BY history_length DESC
LIMIT 1;
```
-------------------------5544 sample_num
```sql
SELECT event FROM Menu WHERE id = 21380 AND date = '1887-07-21';
```
-------------------------5545 sample_num
```sql
SELECT COUNT(*) 
FROM MenuPage 
WHERE menu_id = (SELECT id FROM Menu WHERE name = 'Emil Kuehn');
```
-------------------------5546 sample_num
```sql
SELECT COUNT(DISTINCT m.id) AS menu_count
FROM Menu m
JOIN MenuItem mi ON m.id = mi.menu_page_id
JOIN Dish d ON mi.dish_id = d.id
WHERE d.name = 'puree of split peas aux croutons';
```
-------------------------5547 sample_num
```sql
SELECT D.name 
FROM Dish D 
JOIN MenuItem MI ON D.id = MI.dish_id 
WHERE MI.high_price IS NULL 
AND SUBSTR(MI.created_at, 1, 4) = '2011' 
AND SUBSTR(MI.created_at, 7, 1) = '4';
```
-------------------------5548 sample_num
```sql
SELECT m.name
FROM Menu m
JOIN MenuPage mp ON m.id = mp.menu_id
GROUP BY m.id
ORDER BY COUNT(mp.page_number) DESC
LIMIT 1;
```
-------------------------5549 sample_num
```sql
SELECT DISTINCT mp.id
FROM MenuPage mp
JOIN MenuItem mi ON mp.id = mi.menu_page_id
JOIN Dish d ON mi.dish_id = d.id
WHERE d.name = 'mashed potatoes';
```
-------------------------5550 sample_num
```sql
SELECT COUNT(*) 
FROM Menu 
WHERE sponsor = 'PACIFIC MAIL STEAMSHIP COMPANY' 
AND id IN (
    SELECT menu_id 
    FROM MenuPage 
    GROUP BY menu_id 
    HAVING COUNT(page_number) <= 2
);
```
-------------------------5551 sample_num
```sql
SELECT mp.id
FROM MenuItem mi
JOIN MenuPage mp ON mi.menu_page_id = mp.id
JOIN Dish d ON mi.dish_id = d.id
JOIN Menu m ON mp.menu_id = m.id
WHERE d.name = 'milk'
ORDER BY mi.price DESC
LIMIT 1;
```
-------------------------5552 sample_num
```sql
SELECT menu_id 
FROM Menu 
WHERE sponsor = 'OCCIDENTAL & ORIENTAL STEAMSHIP COMPANY' 
GROUP BY id 
ORDER BY COUNT(*) DESC 
LIMIT 1;
```
-------------------------5553 sample_num
```sql
SELECT mi.xpos, mi.ypos
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
WHERE d.name = 'breaded veal cutlet with peas';
```
-------------------------5554 sample_num
```sql
SELECT d.name 
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
WHERE mi.menu_page_id = 48706 AND mi.xpos > 0.75 AND mi.ypos > 0.75;
```
-------------------------5555 sample_num
```sql
SELECT d.name 
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
JOIN Menu m ON mp.menu_id = m.id
WHERE m.sponsor = 'THE SOCIETY OF THE CUMBERLAND' 
  AND m.event = '19NTH REUNION' 
  AND m.place = 'GRAND PACIFIC HOTEL, CHICAGO, ILL';
```
-------------------------5556 sample_num
```sql
SELECT m.sponsor
FROM Menu m
JOIN MenuItem mi ON m.id = mi.menu_id
JOIN Dish d ON mi.dish_id = d.id
WHERE d.name = 'baked apples with cream'
ORDER BY mi.price DESC
LIMIT 1;
```
-------------------------5557 sample_num
```sql
SELECT 
    (SELECT COUNT(dish_id) / COUNT(DISTINCT menu_id) 
     FROM MenuItem 
     WHERE menu_page_id IN (SELECT id FROM MenuPage WHERE menu_id IN (SELECT id FROM Menu WHERE name = 'Souper de Luxe'))) AS average_dishes_per_menu,
    (SELECT name 
     FROM Dish 
     WHERE id = (SELECT dish_id 
                 FROM MenuItem 
                 GROUP BY dish_id 
                 ORDER BY COUNT(dish_id) DESC 
                 LIMIT 1)) AS most_appeared_dish;
```
-------------------------5558 sample_num
```sql
SELECT id FROM Menu WHERE sponsor IS NULL;
```
-------------------------5559 sample_num
```sql
SELECT COUNT(*) FROM Menu WHERE event = 'LUNCH';
```
-------------------------5560 sample_num
```sql
SELECT COUNT(*) 
FROM Menu 
WHERE page_count > 10 AND dish_count > 20;
```
-------------------------5561 sample_num
```sql
SELECT id 
FROM Menu 
ORDER BY dish_count DESC 
LIMIT 1;
```
-------------------------5562 sample_num
```sql
SELECT COUNT(DISTINCT di.id) AS dish_count
FROM Menu m
JOIN MenuItem mi ON m.id = mi.menu_page_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
JOIN Dish di ON mi.dish_id = di.id
WHERE m.name = 'Zentral Theater Terrace';
```
-------------------------5563 sample_num
```sql
SELECT COUNT(*) 
FROM Menu 
WHERE call_number IS NULL AND strftime('%Y', date) < '1950';
```
-------------------------5564 sample_num
```sql
SELECT mp.image_id 
FROM Menu m 
JOIN MenuPage mp ON m.id = mp.menu_id 
WHERE m.name = 'Zentral Theater Terrace' AND mp.page_number = 1;
```
-------------------------5565 sample_num
```sql
SELECT m.name 
FROM Menu m 
JOIN MenuPage mp ON m.id = mp.menu_id 
WHERE mp.image_id = 5189412;
```
-------------------------5566 sample_num
```sql
SELECT 
    CASE 
        WHEN SUM(CASE WHEN menu.name = 'Zentral Theater Terrace' THEN menuPage.full_width ELSE 0 END) > 
             SUM(CASE WHEN menu.name = 'Young''s Hotel' THEN menuPage.full_width ELSE 0 END) 
        THEN 'Zentral Theater Terrace' 
        ELSE 'Young''s Hotel' 
    END AS bigger_menu_page
FROM 
    Menu menu
JOIN 
    MenuPage menuPage ON menu.id = menuPage.menu_id
WHERE 
    menuPage.page_number = 1;
```
-------------------------5567 sample_num
```sql
SELECT mp.*
FROM MenuPage mp
JOIN Menu m ON mp.menu_id = m.id
WHERE m.name = 'Ritz Carlton'
ORDER BY mp.full_height DESC
LIMIT 1;
```
-------------------------5568 sample_num
```sql
SELECT COUNT(*) 
FROM MenuPage mp 
JOIN Menu m ON mp.menu_id = m.id 
WHERE m.name = 'Ritz Carlton' AND mp.full_width > 1000;
```
-------------------------5569 sample_num
```sql
SELECT COUNT(*) 
FROM MenuItem 
WHERE menu_page_id IN (SELECT id FROM MenuPage WHERE menu_id = 12882 AND page_number = 1);
```
-------------------------5570 sample_num
```sql
SELECT d.name 
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
WHERE mp.menu_id = 12882 AND mp.page_number = 1;
```
-------------------------5571 sample_num
```sql
SELECT DISTINCT mp.page_number
FROM Dish d
JOIN MenuItem mi ON d.id = mi.dish_id
JOIN MenuPage mp ON mi.menu_page_id = mp.id
WHERE d.name = 'Chicken gumbo';
```
-------------------------5572 sample_num
```sql
SELECT mp.menu_id
FROM MenuPage mp
JOIN MenuItem mi ON mp.id = mi.menu_page_id
JOIN Dish d ON mi.dish_id = d.id
WHERE d.name = 'Chicken gumbo'
ORDER BY mp.full_width DESC
LIMIT 1;
```
-------------------------5573 sample_num
```sql
SELECT COUNT(*) 
FROM MenuItem mi
JOIN Dish d ON mi.dish_id = d.id
WHERE d.name = 'Chicken gumbo';
```
-------------------------5574 sample_num
```sql
SELECT COUNT(DISTINCT mp.id) AS stable_price_count
FROM MenuPage mp
JOIN MenuItem mi ON mp.id = mi.menu_page_id
JOIN Dish d ON mi.dish_id = d.id
WHERE d.name = 'Paysanne Soup' AND mi.high_price IS NULL;
```
-------------------------5575 sample_num
```sql
SELECT MAX(mi.high_price) 
FROM Dish d 
JOIN MenuItem mi ON d.id = mi.dish_id 
JOIN MenuPage mp ON mi.menu_page_id = mp.id 
WHERE d.name = 'Chicken gumbo';
```
-------------------------5576 sample_num
```sql
SELECT full_height * full_width AS space_covered
FROM MenuPage mp
JOIN Menu m ON mp.menu_id = m.id
WHERE mp.page_number = 1 AND m.name = 'Zentral Theater Terrace';
```
-------------------------5577 sample_num
```sql
SELECT AVG(dish_count) AS average_dishes_per_page
FROM (
    SELECT COUNT(mi.dish_id) AS dish_count
    FROM MenuPage mp
    LEFT JOIN MenuItem mi ON mp.id = mi.menu_page_id
    WHERE mp.menu_id = 12882
    GROUP BY mp.id
) AS dish_counts;
```
-------------------------5578 sample_num
```sql
SELECT COUNT(*) 
FROM shipment 
WHERE cust_id = (SELECT cust_id FROM customer WHERE cust_name = 'S K L Enterprises Inc') 
AND YEAR(ship_date) = 2017;
```
-------------------------5579 sample_num
```sql
SELECT SUM(weight) AS total_weight
FROM shipment
JOIN customer ON shipment.cust_id = customer.cust_id
WHERE customer.cust_name = 'S K L Enterprises Inc';
```
-------------------------5580 sample_num
```sql
SELECT COUNT(*) 
FROM shipment s
JOIN customer c ON s.cust_id = c.cust_id
JOIN driver d ON s.driver_id = d.driver_id
WHERE d.first_name = 'Sue' AND d.last_name = 'Newell' 
AND c.cust_name = 'S K L Enterprises Inc';
```
-------------------------5581 sample_num
```sql
SELECT COUNT(*) AS shipment_count
FROM shipment s
JOIN customer c ON s.cust_id = c.cust_id
WHERE c.state = 'FL';
```
-------------------------5582 sample_num
```sql
SELECT s.ship_id 
FROM shipment s 
JOIN customer c ON s.cust_id = c.cust_id 
WHERE c.cust_type = 'retailer';
```
-------------------------5583 sample_num
```sql
SELECT COUNT(DISTINCT c.cust_id) 
FROM customer c 
JOIN shipment s ON c.cust_id = s.cust_id 
WHERE CAST(s.ship_date AS DATE) = 2017 
AND c.annual_revenue > 30000000;
```
-------------------------5584 sample_num
```sql
SELECT COUNT(*) 
FROM shipment 
JOIN customer ON shipment.cust_id = customer.cust_id 
JOIN driver ON shipment.driver_id = driver.driver_id 
WHERE driver.first_name = 'Sue' AND driver.last_name = 'Newell' 
AND CAST(ship_date AS DATE) = '2017-01-01';
```
-------------------------5585 sample_num
```sql
SELECT CONCAT(d.first_name, ' ', d.last_name) AS full_name
FROM driver d
JOIN shipment s ON d.driver_id = s.driver_id
WHERE YEAR(CAST(s.ship_date AS DATE)) = 2017
GROUP BY d.driver_id
ORDER BY COUNT(s.ship_id) DESC
LIMIT 1;
```
-------------------------5586 sample_num
```sql
SELECT COUNT(*) 
FROM shipment s
JOIN city c ON s.city_id = c.city_id
WHERE CAST(s.ship_date AS DATE) = '2017' AND c.state = 'New Jersey';
```
-------------------------5587 sample_num
```sql
SELECT MAX(s.weight) AS max_weight
FROM shipment s
JOIN city c ON s.city_id = c.city_id
WHERE c.city_name = 'New York';
```
-------------------------5588 sample_num
```sql
SELECT 
    (SELECT SUM(weight) FROM shipment s JOIN city c ON s.city_id = c.city_id WHERE c.city_name = 'New York') - 
    (SELECT SUM(weight) FROM shipment s JOIN city c ON s.city_id = c.city_id WHERE c.city_name = 'Chicago') AS weight_difference;
```
-------------------------5589 sample_num
```sql
SELECT DISTINCT c.city_name
FROM shipment s
JOIN customer cu ON s.cust_id = cu.cust_id
JOIN city c ON s.city_id = c.city_id
WHERE cu.cust_name = 'S K L Enterprises Inc';
```
-------------------------5590 sample_num
```sql
SELECT AVG(weight) AS average_weight
FROM shipment
WHERE cust_id = (SELECT cust_id FROM customer WHERE cust_name = 'S K L Enterprises Inc');
```
-------------------------5591 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.city = 'Jacksonville' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_jacksonville
FROM 
    shipment s
JOIN 
    customer c ON s.cust_id = c.cust_id
JOIN 
    city ci ON s.city_id = ci.city_id
WHERE 
    ci.state = 'Florida';
```
-------------------------5592 sample_num
```sql
SELECT 
    CASE 
        WHEN t.make = 'Peterbit' THEN 'Texas (TX)' 
        WHEN t.make = 'Mack' THEN 'North Carolina (NC)' 
        WHEN t.make = 'Kenworth' THEN 'Washington (WA)' 
    END AS headquarter
FROM 
    shipment s
JOIN 
    truck t ON s.truck_id = t.truck_id
WHERE 
    s.ship_id = 1045;
```
-------------------------5593 sample_num
```sql
SELECT COUNT(*) AS shipment_count
FROM shipment
WHERE truck_id = (SELECT truck_id FROM truck WHERE model_year = (SELECT MIN(model_year) FROM truck));
```
-------------------------5594 sample_num
```sql
SELECT c.cust_name 
FROM customer c 
JOIN shipment s ON c.cust_id = s.cust_id 
WHERE s.ship_id = 1275;
```
-------------------------5595 sample_num
```sql
SELECT c.city_name 
FROM shipment s 
JOIN city c ON s.city_id = c.city_id 
WHERE s.ship_id = 1701;
```
-------------------------5596 sample_num
```sql
SELECT CONCAT(d.first_name, ' ', d.last_name) AS driver_name
FROM shipment s
JOIN driver d ON s.driver_id = d.driver_id
WHERE s.ship_id = 1021;
```
-------------------------5597 sample_num
```sql
SELECT CONCAT(d.first_name, ' ', d.last_name) AS driver_name
FROM shipment s
JOIN driver d ON s.driver_id = d.driver_id
WHERE s.ship_date = '2017-11-05';
```
-------------------------5598 sample_num
```sql
SELECT c.population 
FROM shipment s 
JOIN city c ON s.city_id = c.city_id 
WHERE s.ship_id = 1398;
```
-------------------------5599 sample_num
```sql
SELECT MIN(ship_date) AS first_shipment_date
FROM shipment s
JOIN customer c ON s.cust_id = c.cust_id
WHERE c.state = 'SC';
```
-------------------------5600 sample_num
```sql
SELECT s.weight 
FROM shipment s
JOIN driver d ON s.driver_id = d.driver_id
WHERE d.first_name = 'Leszek' AND d.last_name = 'Kieltyka' AND s.ship_date = '2017-09-25';
```
-------------------------5601 sample_num
```sql
SELECT c.area 
FROM shipment s 
JOIN city c ON s.city_id = c.city_id 
WHERE s.ship_id = 1346;
```
-------------------------5602 sample_num
```sql
SELECT weight 
FROM shipment 
JOIN customer ON shipment.cust_id = customer.cust_id 
WHERE customer.cust_name = 'U-haul Center Of N Syracuse' 
AND shipment.ship_date = '2016-09-21';
```
-------------------------5603 sample_num
```sql
SELECT CONCAT(d.first_name, ' ', d.last_name) AS full_name
FROM shipment s
JOIN driver d ON s.driver_id = d.driver_id
WHERE s.truck_id = 3 AND s.ship_date = '2016-09-19';
```
-------------------------5604 sample_num
```sql
SELECT area / population AS population_density
FROM city
WHERE city_id = (SELECT city_id FROM shipment WHERE ship_id = 1369);
```
-------------------------5605 sample_num
```sql
SELECT AVG(shipment_count) AS average_shipments
FROM (
    SELECT COUNT(s.ship_id) AS shipment_count
    FROM shipment s
    JOIN truck t ON s.truck_id = t.truck_id
    WHERE t.make = 'Kenworth'
    GROUP BY s.truck_id
) AS shipment_counts;
```
-------------------------5606 sample_num
```sql
SELECT weight 
FROM shipment 
WHERE driver_id = (SELECT driver_id FROM driver WHERE first_name = 'Sue' AND last_name = 'Newell') 
AND ship_date = (SELECT MIN(ship_date) FROM shipment WHERE driver_id = (SELECT driver_id FROM driver WHERE first_name = 'Sue' AND last_name = 'Newell'));
```
-------------------------5607 sample_num
```sql
SELECT c.cust_name 
FROM shipment s 
JOIN customer c ON s.cust_id = c.cust_id 
WHERE s.weight = (SELECT MAX(weight) FROM shipment);
```
-------------------------5608 sample_num
```sql
SELECT CONCAT(d.first_name, ' ', d.last_name) AS full_name
FROM shipment s
JOIN driver d ON s.driver_id = d.driver_id
WHERE s.ship_date = (SELECT MIN(ship_date) FROM shipment);
```
-------------------------5609 sample_num
```sql
SELECT COUNT(*) AS total_shipments
FROM shipment
JOIN customer ON shipment.cust_id = customer.cust_id
WHERE customer.cust_name = 'Olympic Camper Sales Inc';
```
-------------------------5610 sample_num
```sql
SELECT COUNT(*) 
FROM shipment s
JOIN customer c ON s.cust_id = c.cust_id
JOIN city ci ON s.city_id = ci.city_id
WHERE ci.city_name = 'New York' 
AND c.cust_name = 'Harry''s Hot Rod Auto & Truck Accessories';
```
-------------------------5611 sample_num
```sql
SELECT COUNT(*) 
FROM (
    SELECT weight 
    FROM shipment 
    ORDER BY weight DESC 
    LIMIT 5
) AS top_shipments
JOIN truck ON shipment.truck_id = truck.truck_id
WHERE truck.make = 'Mack';
```
-------------------------5612 sample_num
```sql
SELECT CONCAT(d.first_name, ' ', d.last_name) AS full_name
FROM driver d
JOIN shipment s ON d.driver_id = s.driver_id
JOIN city c ON s.city_id = c.city_id
WHERE c.population = (SELECT MIN(population) FROM city)
GROUP BY d.driver_id
ORDER BY COUNT(s.ship_id) DESC
LIMIT 1;
```
-------------------------5613 sample_num
```sql
SELECT COUNT(*) 
FROM shipment 
WHERE weight < 1000 
AND truck_id = (SELECT truck_id FROM truck ORDER BY model_year ASC LIMIT 1);
```
-------------------------5614 sample_num
```sql
SELECT annual_revenue 
FROM customer 
WHERE cust_id = (
    SELECT cust_id 
    FROM shipment 
    GROUP BY cust_id 
    ORDER BY COUNT(ship_id) DESC 
    LIMIT 1
);
```
-------------------------5615 sample_num
```sql
SELECT COUNT(*) 
FROM shipment s
JOIN city c ON s.city_id = c.city_id
JOIN customer cu ON s.cust_id = cu.cust_id
WHERE c.city_name = 'Downey' 
  AND cu.state = 'CA' 
  AND YEAR(s.ship_date) = 2016;
```
-------------------------5616 sample_num
```sql
SELECT COUNT(*) 
FROM shipment s
JOIN driver d ON s.driver_id = d.driver_id
JOIN city c ON s.city_id = c.city_id
WHERE d.first_name = 'Holger' AND d.last_name = 'Nohr' AND c.city_name = 'North Las Vegas';
```
-------------------------5617 sample_num
```sql
SELECT COUNT(*) AS shipment_count
FROM shipment
WHERE city_id = (
    SELECT city_id
    FROM city
    ORDER BY population / area DESC
    LIMIT 1
);
```
-------------------------5618 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN state = 'TX' THEN cust_id END) * 100.0 / COUNT(cust_id)) AS percentage
FROM 
    customer
WHERE 
    cust_name LIKE 'Lorenzo%';
```
-------------------------5619 sample_num
```sql
SELECT SUM(s.weight) AS total_weight
FROM shipment s
JOIN city c ON s.city_id = c.city_id
WHERE c.city_name = 'San Mateo' AND c.state = 'California' AND YEAR(s.ship_date) = 2016;
```
-------------------------5620 sample_num
```sql
SELECT SUM(s.weight) AS total_weight
FROM shipment s
JOIN truck t ON s.truck_id = t.truck_id
WHERE t.make = 'Peterbilt' 
  AND t.model_year = (SELECT MAX(model_year) FROM truck WHERE make = 'Peterbilt')
  AND CAST(s.ship_date AS DATE) BETWEEN '2016-01-01' AND '2016-12-31';
```
-------------------------5621 sample_num
```sql
SELECT c.cust_name, MAX(s.weight) AS max_weight
FROM shipment s
JOIN customer c ON s.cust_id = c.cust_id
JOIN city ci ON s.city_id = ci.city_id
WHERE ci.city_name = 'Boston'
GROUP BY c.cust_name
ORDER BY max_weight DESC
LIMIT 1;
```
-------------------------5622 sample_num
```sql
SELECT c.city_name 
FROM shipment s 
JOIN city c ON s.city_id = c.city_id 
WHERE s.ship_id = 1002;
```
-------------------------5623 sample_num
```sql
SELECT AVG(s.weight) AS average_shipment_weight
FROM shipment s
JOIN truck t ON s.truck_id = t.truck_id
WHERE t.make = 'Mack' AND t.model_year = (SELECT MIN(model_year) FROM truck WHERE make = 'Mack');
```
-------------------------5624 sample_num
```sql
SELECT CONCAT(d.first_name, ' ', d.last_name) AS full_name
FROM driver d
JOIN shipment s ON d.driver_id = s.driver_id
JOIN city c ON s.city_id = c.city_id
WHERE c.city_name = 'New York' AND s.ship_date LIKE '2016-02%';
```
-------------------------5625 sample_num
```sql
SELECT c.cust_name 
FROM customer c 
JOIN shipment s ON c.cust_id = s.cust_id 
JOIN city ci ON s.city_id = ci.city_id 
WHERE ci.city_name = 'Oak Park';
```
-------------------------5626 sample_num
```sql
SELECT COUNT(s.ship_id) AS number_of_shipments
FROM shipment s
JOIN customer c ON s.cust_id = c.cust_id
JOIN driver d ON s.driver_id = d.driver_id
JOIN city ct ON s.city_id = ct.city_id
WHERE d.first_name = 'Andrea' AND d.last_name = 'Simons'
  AND ct.city_name = 'Huntsville'
  AND YEAR(s.ship_date) = 2016;
```
-------------------------5627 sample_num
```sql
SELECT 
    d.driver_id, 
    d.first_name, 
    d.last_name, 
    COUNT(s.ship_id) / (24 * COUNT(DISTINCT s.driver_id)) AS average_shipments_per_month
FROM 
    driver d
LEFT JOIN 
    shipment s ON d.driver_id = s.driver_id
GROUP BY 
    d.driver_id, d.first_name, d.last_name;
```
-------------------------5628 sample_num
```sql
SELECT 
    (SUM(CASE WHEN weight >= 10000 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    shipment
JOIN 
    customer ON shipment.cust_id = customer.cust_id
WHERE 
    customer.cust_name = 'Sunguard Window Tinting & Truck Accessories' 
    AND YEAR(ship_date) = 2017;
```
-------------------------5629 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.cust_name = 'Autoware Inc' THEN s.ship_id END) * 100.0 / COUNT(s.ship_id)) AS percentage
FROM 
    shipment s
JOIN 
    customer c ON s.cust_id = c.cust_id
JOIN 
    driver d ON s.driver_id = d.driver_id
WHERE 
    d.first_name = 'Sue' AND d.last_name = 'Newel';
```
-------------------------5630 sample_num
```sql
SELECT COUNT(DISTINCT c.city_id)
FROM city c
JOIN shipment s ON c.city_id = s.city_id
WHERE c.state = 'New Jersey'
GROUP BY c.city_id
HAVING SUM(s.weight) > 20000;
```
-------------------------5631 sample_num
```sql
SELECT COUNT(DISTINCT c.city_id) 
FROM city c 
JOIN shipment s ON c.city_id = s.city_id 
WHERE c.population > 50000 AND YEAR(s.ship_date) = 2017;
```
-------------------------5632 sample_num
```sql
SELECT s.weight 
FROM shipment s 
JOIN truck t ON s.truck_id = t.truck_id 
WHERE t.make = 'Peterbilt';
```
-------------------------5633 sample_num
```sql
SELECT t.model_year 
FROM shipment s 
JOIN truck t ON s.truck_id = t.truck_id 
WHERE s.ship_id = 1003;
```
-------------------------5634 sample_num
```sql
SELECT t.make 
FROM shipment s 
JOIN truck t ON s.truck_id = t.truck_id 
WHERE s.ship_id = 1011;
```
-------------------------5635 sample_num
```sql
SELECT d.first_name 
FROM driver d 
JOIN shipment s ON d.driver_id = s.driver_id 
WHERE s.ship_id = 1028;
```
-------------------------5636 sample_num
```sql
SELECT d.state 
FROM shipment s 
JOIN driver d ON s.driver_id = d.driver_id 
WHERE s.ship_id = 1055;
```
-------------------------5637 sample_num
```sql
SELECT d.address 
FROM driver d 
JOIN shipment s ON d.driver_id = s.driver_id 
WHERE s.weight > 50000;
```
-------------------------5638 sample_num
```sql
SELECT CONCAT(d.first_name, ' ', d.last_name) AS full_name
FROM driver d
JOIN shipment s ON d.driver_id = s.driver_id
WHERE s.ship_date = '2016-02-03';
```
-------------------------5639 sample_num
```sql
SELECT AVG(c.annual_revenue) AS average_annual_revenue
FROM customer c
JOIN shipment s ON c.cust_id = s.cust_id
WHERE s.weight < 65000;
```
-------------------------5640 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN s.weight < 70000 THEN c.cust_id END) * 100.0 / COUNT(c.cust_id)) AS percentage_wholesaler
FROM 
    customer c
JOIN 
    shipment s ON c.cust_id = s.cust_id
WHERE 
    c.cust_type = 'wholesaler';
```
-------------------------5641 sample_num
```sql
SELECT d.last_name 
FROM driver d 
JOIN shipment s ON d.driver_id = s.driver_id 
WHERE s.ship_id = 1088;
```
-------------------------5642 sample_num
```sql
SELECT d.phone
FROM driver d
JOIN shipment s ON d.driver_id = s.driver_id
GROUP BY d.driver_id
HAVING SUM(s.weight) > 20000;
```
-------------------------5643 sample_num
```sql
SELECT t.make, t.model_year 
FROM shipment s 
JOIN truck t ON s.truck_id = t.truck_id 
WHERE s.ship_id = 1055;
```
-------------------------5644 sample_num
```sql
SELECT COUNT(*) FROM truck WHERE model_year = 2009;
```
-------------------------5645 sample_num
```sql
SELECT COUNT(*) AS manufacturer_count 
FROM customer 
WHERE cust_type = 'manufacturer';
```
-------------------------5646 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE state = 'CA' AND cust_type = 'retailer';
```
-------------------------5647 sample_num
```sql
SELECT COUNT(*) FROM city WHERE state = 'Connecticut';
```
-------------------------5648 sample_num
```sql
SELECT city_name 
FROM city 
WHERE state = 'CA' 
ORDER BY population DESC 
LIMIT 1;
```
-------------------------5649 sample_num
```sql
SELECT annual_revenue 
FROM customer 
WHERE cust_name = 'Klett & Sons Repair';
```
-------------------------5650 sample_num
```sql
SELECT CONCAT(d.first_name, ' ', d.last_name) AS full_name
FROM shipment s
JOIN driver d ON s.driver_id = d.driver_id
WHERE s.weight = (SELECT MIN(weight) FROM shipment);
```
-------------------------5651 sample_num
```sql
SELECT COUNT(*) 
FROM shipment s
JOIN customer c ON s.cust_id = c.cust_id
WHERE c.state = 'CA' AND CAST(s.ship_date AS DATE) BETWEEN '2016-01-01' AND '2016-12-31';
```
-------------------------5652 sample_num
```sql
SELECT t.make 
FROM truck t
JOIN shipment s ON t.truck_id = s.truck_id
JOIN driver d ON s.driver_id = d.driver_id
WHERE d.first_name = 'Zachery' AND d.last_name = 'Hicks';
```
-------------------------5653 sample_num
```sql
SELECT DISTINCT c.cust_name
FROM customer c
JOIN shipment s ON c.cust_id = s.cust_id
WHERE s.ship_date LIKE '2017-02-%';
```
-------------------------5654 sample_num
```sql
SELECT t.make, CONCAT(d.first_name, ' ', d.last_name) AS driver_name
FROM shipment s
JOIN customer c ON s.cust_id = c.cust_id
JOIN truck t ON s.truck_id = t.truck_id
JOIN driver d ON s.driver_id = d.driver_id
WHERE c.cust_name = 'Klett & Sons Repair';
```
-------------------------5655 sample_num
```sql
SELECT ship_id 
FROM shipment 
WHERE driver_id = (SELECT driver_id FROM driver WHERE first_name = 'Zachery' AND last_name = 'Hicks') 
ORDER BY weight DESC 
LIMIT 1;
```
-------------------------5656 sample_num
```sql
SELECT COUNT(*) 
FROM shipment s
JOIN driver d ON s.driver_id = d.driver_id
JOIN city c ON s.city_id = c.city_id
WHERE d.first_name = 'Zachery' 
  AND d.last_name = 'Hicks' 
  AND c.city_name = 'New York' 
  AND CAST(s.ship_date AS DATE) BETWEEN '2016-01-01' AND '2016-12-31';
```
-------------------------5657 sample_num
```sql
SELECT t.make, COUNT(s.ship_id) AS shipment_count
FROM shipment s
JOIN truck t ON s.truck_id = t.truck_id
WHERE EXTRACT(YEAR FROM CAST(s.ship_date AS DATE)) = 2016
GROUP BY t.make
ORDER BY shipment_count DESC
LIMIT 1;
```
-------------------------5658 sample_num
```sql
SELECT COUNT(*) 
FROM shipment 
WHERE city_id = (SELECT city_id 
                 FROM city 
                 WHERE state = 'California' 
                 ORDER BY population ASC 
                 LIMIT 1);
```
-------------------------5659 sample_num
```sql
SELECT c.city_name
FROM shipment s
JOIN city c ON s.city_id = c.city_id
WHERE s.weight = (SELECT MAX(weight) FROM shipment);
```
-------------------------5660 sample_num
```sql
SELECT DISTINCT c.city_name
FROM city c
JOIN shipment s ON c.city_id = s.city_id
JOIN driver d ON s.driver_id = d.driver_id
WHERE d.first_name = 'Zachery' AND d.last_name = 'Hicks';
```
-------------------------5661 sample_num
```sql
SELECT AVG(shipment_count) AS average_shipments
FROM (
    SELECT COUNT(ship_id) AS shipment_count
    FROM shipment s
    JOIN customer c ON s.cust_id = c.cust_id
    JOIN driver d ON s.driver_id = d.driver_id
    WHERE d.first_name = 'Zachery' 
      AND d.last_name = 'Hicks' 
      AND EXTRACT(YEAR FROM s.ship_date) = 2017
    GROUP BY EXTRACT(MONTH FROM s.ship_date)
) AS monthly_shipments;
```
-------------------------5662 sample_num
```sql
SELECT 
    (SUM(CASE WHEN d.first_name = 'Zachery' AND d.last_name = 'Hicks' THEN s.weight ELSE 0 END) / SUM(s.weight) * 100) AS percentage
FROM 
    shipment s
JOIN 
    customer c ON s.cust_id = c.cust_id
JOIN 
    driver d ON s.driver_id = d.driver_id
JOIN 
    city ci ON s.city_id = ci.city_id
WHERE 
    ci.state = 'California' AND 
    CAST(s.ship_date AS DATE) BETWEEN '2016-01-01' AND '2016-12-31';
```
-------------------------5663 sample_num
```sql
SELECT COUNT(*) AS shipment_count
FROM shipment
WHERE driver_id = (SELECT driver_id FROM driver WHERE first_name = 'Zachary' AND last_name = 'Hicks');
```
-------------------------5664 sample_num
```sql
SELECT ship_id 
FROM shipment 
WHERE city_id = (SELECT city_id FROM city ORDER BY area DESC LIMIT 1);
```
-------------------------5665 sample_num
```sql
SELECT d.first_name, d.last_name
FROM driver d
JOIN shipment s ON d.driver_id = s.driver_id
JOIN city c ON s.city_id = c.city_id
WHERE c.population = (SELECT MIN(population) FROM city);
```
-------------------------5666 sample_num
```sql
SELECT COUNT(*) 
FROM shipment s
JOIN city c ON s.city_id = c.city_id
WHERE c.city_name = 'Cicero' AND c.state = 'Illinois' 
AND s.weight BETWEEN 9000 AND 15000;
```
-------------------------5667 sample_num
```sql
SELECT t.model_year 
FROM shipment s 
JOIN truck t ON s.truck_id = t.truck_id 
WHERE s.ship_id = 1233;
```
-------------------------5668 sample_num
```sql
SELECT d.address 
FROM driver d 
JOIN shipment s ON d.driver_id = s.driver_id 
JOIN customer c ON s.cust_id = c.cust_id 
WHERE c.address = '7052 Carroll Road' AND c.city = 'San Diego' AND c.state = 'California';
```
-------------------------5669 sample_num
```sql
SELECT COUNT(*) 
FROM shipment 
JOIN driver ON shipment.driver_id = driver.driver_id 
WHERE driver.first_name = 'Maria' AND driver.last_name = 'Craft' 
AND CAST(shipment.ship_date AS DATE) = '2017-01-01';
```
-------------------------5670 sample_num
```sql
SELECT t.model_year 
FROM shipment s 
JOIN truck t ON s.truck_id = t.truck_id 
WHERE s.ship_id = 1245;
```
-------------------------5671 sample_num
```sql
SELECT d.address 
FROM driver d 
JOIN shipment s ON d.driver_id = s.driver_id 
WHERE s.ship_id = 1127;
```
-------------------------5672 sample_num
```sql
SELECT c.annual_revenue 
FROM customer c 
JOIN shipment s ON c.cust_id = s.cust_id 
WHERE s.ship_id = 1047;
```
-------------------------5673 sample_num
```sql
SELECT s.weight 
FROM shipment s 
JOIN driver d ON s.driver_id = d.driver_id 
WHERE d.first_name = 'Andrea' AND d.last_name = 'Simons' AND s.ship_date = '2016-03-07';
```
-------------------------5674 sample_num
```sql
SELECT c.city_name 
FROM shipment s 
JOIN city c ON s.city_id = c.city_id 
WHERE s.ship_date = '2017-01-16';
```
-------------------------5675 sample_num
```sql
SELECT COUNT(*) 
FROM shipment s 
JOIN customer c ON s.cust_id = c.cust_id 
WHERE c.state = 'NY';
```
-------------------------5676 sample_num
```sql
SELECT cust_name FROM customer WHERE cust_id = (SELECT cust_id FROM shipment WHERE ship_id = 1147);
```
-------------------------5677 sample_num
```sql
SELECT ship_id 
FROM shipment 
WHERE city_id = (SELECT city_id 
                 FROM city 
                 WHERE population = (SELECT MAX(population) FROM city));
```
-------------------------5678 sample_num
```sql
SELECT CONCAT(d.first_name, ' ', d.last_name) AS driver_name
FROM shipment s
JOIN driver d ON s.driver_id = d.driver_id
WHERE s.ship_date = '2016-02-22';
```
-------------------------5679 sample_num
```sql
SELECT s.weight 
FROM shipment s 
JOIN customer c ON s.cust_id = c.cust_id 
WHERE c.annual_revenue = 39448581;
```
-------------------------5680 sample_num
```sql
SELECT c.address 
FROM customer c 
JOIN shipment s ON c.cust_id = s.cust_id 
WHERE s.ship_id = 1117;
```
-------------------------5681 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN CAST(ship_date AS DATE) = '2017-01-01' THEN ship_id END) * 100.0 / COUNT(ship_id)) AS percentage
FROM 
    shipment s
JOIN 
    customer c ON s.cust_id = c.cust_id
WHERE 
    c.state = 'TX';
```
-------------------------5682 sample_num
```sql
SELECT 
    (SELECT COUNT(ship_id) FROM shipment s JOIN truck t ON s.truck_id = t.truck_id WHERE t.model_year = 2005) -
    (SELECT COUNT(ship_id) FROM shipment s JOIN truck t ON s.truck_id = t.truck_id WHERE t.model_year = 2006) AS shipment_difference;
```
-------------------------5683 sample_num
```sql
SELECT d.first_name, d.last_name
FROM shipment s
JOIN driver d ON s.driver_id = d.driver_id
WHERE s.weight > (SELECT AVG(weight) * 0.95 FROM shipment);
```
-------------------------5684 sample_num
```sql
SELECT title, COUNT(DISTINCT wid) AS different_words
FROM pages
JOIN pages_words ON pages.pid = pages_words.pid
WHERE lid = (SELECT lid FROM langs WHERE lang = 'Catalan')
GROUP BY title
ORDER BY LENGTH(title) DESC
LIMIT 1;
```
-------------------------5685 sample_num
```sql
SELECT p.title 
FROM pages p 
JOIN langs l ON p.lid = l.lid 
JOIN pages_words pw ON p.pid = pw.pid 
GROUP BY p.pid 
HAVING l.lang = 'Catalan' AND COUNT(DISTINCT pw.wid) < 10;
```
-------------------------5686 sample_num
```sql
SELECT p.page 
FROM pages p 
JOIN langs l ON p.lid = l.lid 
WHERE l.lang = 'Catalan' AND p.title LIKE '% Art %';
```
-------------------------5687 sample_num
```sql
SELECT title 
FROM pages 
WHERE lid = (SELECT lid FROM langs WHERE lang = 'Catalan') 
AND revision = 16203226;
```
-------------------------5688 sample_num
```sql
SELECT title 
FROM pages 
WHERE lid = (SELECT lid FROM langs WHERE lang = 'Catalan') 
AND revision BETWEEN 106600 AND 106700;
```
-------------------------5689 sample_num
```sql
SELECT COUNT(*) 
FROM pages p 
JOIN langs l ON p.lid = l.lid 
WHERE l.lang = 'Catalan' 
AND p.words BETWEEN 1000 AND 2000;
```
-------------------------5690 sample_num
```sql
SELECT p.pid 
FROM pages p 
JOIN langs l ON p.lid = l.lid 
JOIN pages_words pw ON p.pid = pw.pid 
JOIN words w ON pw.wid = w.wid 
WHERE l.lang = 'Catalan' AND w.word = 'decimal';
```
-------------------------5691 sample_num
```sql
SELECT w.word, pw.occurrences
FROM words w
JOIN pages_words pw ON w.wid = pw.wid
JOIN pages p ON pw.pid = p.pid
JOIN langs l ON p.lid = l.lid
WHERE l.lang = 'Catalan'
ORDER BY pw.occurrences DESC
LIMIT 1;
```
-------------------------5692 sample_num
```sql
SELECT w1st
FROM biwords
WHERE w2nd = 'antic';
```
-------------------------5693 sample_num
```sql
SELECT p.title, pw.occurrences
FROM pages p
JOIN pages_words pw ON p.pid = pw.pid
JOIN words w ON pw.wid = w.wid
WHERE w.word = 'quipu';
```
-------------------------5694 sample_num
```sql
SELECT AVG(occurrences) AS average_occurrences
FROM biwords
WHERE w1st = 'system';
```
-------------------------5695 sample_num
```sql
SELECT SUM(pages) AS total_pages 
FROM langs 
WHERE lang = 'ca';
```
-------------------------5696 sample_num
```sql
SELECT w1.word AS w1st, w2.word AS w2nd, b.occurrences
FROM biwords b
JOIN langs l ON b.lid = l.lid
JOIN words w1 ON b.w1st = w1.wid
JOIN words w2 ON b.w2nd = w2.wid
WHERE l.lang = 'Catalan'
ORDER BY b.occurrences DESC
LIMIT 1;
```
-------------------------5697 sample_num
```sql
SELECT w.wid 
FROM langs l 
JOIN langs_words lw ON l.lid = lw.lid 
JOIN words w ON lw.wid = w.wid 
WHERE l.lang = 'catalan' AND lw.occurrences <= 10;
```
-------------------------5698 sample_num
```sql
SELECT title 
FROM pages 
WHERE lid = (SELECT lid FROM langs WHERE lang = 'Catalan') 
ORDER BY words DESC 
LIMIT 1;
```
-------------------------5699 sample_num
```sql
SELECT pid FROM pages WHERE title = 'Arqueozoologia';
```
-------------------------5700 sample_num
```sql
SELECT w.wid, MAX(pw.occurrences) AS max_occurrences
FROM pages p
JOIN langs l ON p.lid = l.lid
JOIN pages_words pw ON p.pid = pw.pid
JOIN words w ON pw.wid = w.wid
WHERE l.lang = 'Catalan' AND p.title = 'Abadia'
GROUP BY w.wid
ORDER BY max_occurrences DESC
LIMIT 1;
```
-------------------------5701 sample_num
```sql
SELECT p.title, pw.wid
FROM pages p
JOIN langs l ON p.lid = l.lid
JOIN pages_words pw ON p.pid = pw.pid
WHERE l.lang = 'Catalan'
GROUP BY p.pid, p.title
ORDER BY COUNT(DISTINCT pw.wid) ASC
LIMIT 5;
```
-------------------------5702 sample_num
```sql
SELECT b.occurrences
FROM biwords b
JOIN langs l ON b.lid = l.lid
JOIN words w1 ON b.w1st = w1.wid
JOIN words w2 ON b.w2nd = w2.wid
WHERE l.lang = 'Catalan' AND w1.word = 'i' AND w2.word = 'a';
```
-------------------------5703 sample_num
```sql
SELECT w1.word AS w1st, w2.word AS w2nd
FROM biwords b
JOIN words w1 ON b.w1st = w1.wid
JOIN words w2 ON b.w2nd = w2.wid
WHERE b.occurrences = 2;
```
-------------------------5704 sample_num
```sql
SELECT b.w1st, b.w2nd, b.occurrences
FROM biwords b
JOIN pages p ON b.lid = p.lid
WHERE p.title = 'Addicio'
ORDER BY b.occurrences DESC
LIMIT 1;
```
-------------------------5705 sample_num
```sql
SELECT SUM(words) AS total_word
FROM pages
WHERE title IN ('Adam', 'Acampada');
```
-------------------------5706 sample_num
```sql
SELECT pid, revision FROM pages WHERE title LIKE 'Aigua dolÃ§a%';
```
-------------------------5707 sample_num
```sql
SELECT title 
FROM pages 
ORDER BY words DESC 
LIMIT 1;
```
-------------------------5708 sample_num
```sql
SELECT AVG(word_count) AS average_words
FROM (
    SELECT words AS word_count
    FROM pages
    WHERE words >= 10
    ORDER BY words
    LIMIT 10
) AS fewest_words;
```
-------------------------5709 sample_num
```sql
SELECT pid 
FROM pages 
WHERE words < 10 
LIMIT 5;
```
-------------------------5710 sample_num
```sql
SELECT pid FROM pages WHERE title LIKE 'b%';
```
-------------------------5711 sample_num
```sql
SELECT p.title 
FROM pages p 
JOIN pages_words pw ON p.pid = pw.pid 
JOIN words w ON pw.wid = w.wid 
WHERE w.word = 'desena';
```
-------------------------5712 sample_num
```sql
SELECT wid FROM words WHERE word = 'Sometent';
```
-------------------------5713 sample_num
```sql
SELECT EXISTS (
    SELECT 1 
    FROM pages 
    WHERE title = 'Animals' AND pid IN (
        SELECT pid 
        FROM pages_words 
        WHERE wid = 88
    )
) AS is_word_id_88_for_title_animals;
```
-------------------------5714 sample_num
```sql
SELECT pw.occurrences 
FROM pages_words pw 
JOIN pages p ON pw.pid = p.pid 
WHERE p.title = 'Any anomalÃ­stic' AND pw.wid = (SELECT wid FROM words WHERE word = 'del');
```
-------------------------5715 sample_num
```sql
SELECT w1st, w2nd FROM biwords WHERE occurrences = 4 LIMIT 1;
```
-------------------------5716 sample_num
```sql
SELECT SUM(occurrences) AS total_occurrences
FROM biwords
WHERE w1st = 'nombre' OR w2nd = 'nombre';
```
-------------------------5717 sample_num
```sql
SELECT DISTINCT 
    CASE 
        WHEN b.w1st = 'John' THEN b.w2nd 
        ELSE b.w1st 
    END AS paired_word
FROM 
    biwords b
WHERE 
    b.w1st = 'John' OR b.w2nd = 'John'
LIMIT 10;
```
-------------------------5718 sample_num
```sql
SELECT p.pid 
FROM pages p 
JOIN pages_words pw ON p.pid = pw.pid 
JOIN words w ON pw.wid = w.wid 
WHERE w.word = 'fresc';
```
-------------------------5719 sample_num
```sql
SELECT w.wid, w.word, bw.w2nd
FROM words w
LEFT JOIN biwords bw ON w.wid = bw.w1st
WHERE w.wid BETWEEN 1 AND 10;
```
-------------------------5720 sample_num
```sql
SELECT SUM(w.occurrences) AS total_occurrences
FROM pages p
JOIN pages_words pw ON p.pid = pw.pid
JOIN words w ON pw.wid = w.wid
WHERE p.title = 'Atomium' AND w.word IN (SELECT word FROM words WHERE word IN (SELECT DISTINCT word FROM pages WHERE title = 'Atomium') LIMIT 3);
```
-------------------------5721 sample_num
```sql
SELECT word, MAX(occurrences) AS max_occurrences
FROM words
GROUP BY word
ORDER BY max_occurrences DESC
LIMIT 1;
```
-------------------------5722 sample_num
```sql
SELECT pid 
FROM pages 
WHERE lid = (SELECT lid FROM langs WHERE lang = 'Catalan') 
AND title REGEXP '[0-9]';
```
-------------------------5723 sample_num
```sql
SELECT title 
FROM pages 
ORDER BY words ASC 
LIMIT 1;
```
-------------------------5724 sample_num
```sql
SELECT w1st, w2nd 
FROM biwords 
ORDER BY occurrences DESC 
LIMIT 1;
```
-------------------------5725 sample_num
```sql
SELECT SUM(occurrences) AS total_occurrences
FROM words
WHERE LENGTH(word) = 3;
```
-------------------------5726 sample_num
```sql
SELECT AVG(word_count) AS average_word_count
FROM (
    SELECT COUNT(DISTINCT wid) AS word_count
    FROM pages_words
    JOIN pages ON pages.pid = pages_words.pid
    WHERE pages.title LIKE 'A%'
    GROUP BY pages.pid
) AS word_counts;
```
-------------------------5727 sample_num
```sql
SELECT AVG(occurrences) AS average_repetitions
FROM biwords
WHERE w1st = 34;
```
-------------------------5728 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN words = 1500 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    pages;
```
-------------------------5729 sample_num
```sql
SELECT 
    lid, 
    (COUNT(CASE WHEN w1st = w2nd THEN occurrences END) * 100.0 / COUNT(occurrences)) AS percentage
FROM 
    biwords
GROUP BY 
    lid;
```
-------------------------5730 sample_num
```sql
SELECT p.title 
FROM pages p 
JOIN pages_words pw ON p.pid = pw.pid 
JOIN words w ON pw.wid = w.wid 
WHERE w.word = 'comunitat';
```
-------------------------5731 sample_num
```sql
SELECT COUNT(DISTINCT pid) 
FROM pages_words 
WHERE wid = (SELECT wid FROM words WHERE word = 'ripoll');
```
-------------------------5732 sample_num
```sql
SELECT SUM(occurrences) AS total_repeated_words
FROM pages_words
WHERE pid = (SELECT pid FROM pages WHERE title = 'Llista de conflictes armats');
```
-------------------------5733 sample_num
```sql
SELECT COUNT(*) > 0 AS pair_exists
FROM biwords
WHERE (w1st IN (SELECT wid FROM words WHERE word = 'fukunaga') AND w2nd IN (SELECT wid FROM words WHERE word = 'd''egees'))
   OR (w1st IN (SELECT wid FROM words WHERE word = 'd''egees') AND w2nd IN (SELECT wid FROM words WHERE word = 'fukunaga'));
```
-------------------------5734 sample_num
```sql
SELECT AVG(total_occurrences) AS average_repetitions
FROM (
    SELECT p.pid, SUM(pw.occurrences) AS total_occurrences
    FROM pages p
    JOIN pages_words pw ON p.pid = pw.pid
    GROUP BY p.pid
    HAVING COUNT(DISTINCT pw.wid) = 100
) AS subquery;
```
-------------------------5735 sample_num
```sql
SELECT pid FROM pages WHERE title = 'Acampada' AND lid = (SELECT lid FROM langs WHERE lang = 'Catalan');
```
-------------------------5736 sample_num
```sql
SELECT title 
FROM pages 
WHERE words > 300 
LIMIT 3;
```
-------------------------5737 sample_num
```sql
SELECT occurrences FROM words WHERE wid = 8;
```
-------------------------5738 sample_num
```sql
SELECT wid, word, occurrences 
FROM words 
ORDER BY occurrences DESC 
LIMIT 3;
```
-------------------------5739 sample_num
```sql
SELECT occurrences 
FROM biwords 
WHERE (w1st = 1 AND w2nd = 25) OR (w1st = 25 AND w2nd = 1;
```
-------------------------5740 sample_num
```sql
SELECT words FROM pages WHERE revision = 27457362;
```
-------------------------5741 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN w.occurrences > 16000 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    words w
JOIN 
    langs_words lw ON w.wid = lw.wid
WHERE 
    lw.lid = 1;
```
-------------------------5742 sample_num
```sql
SELECT pid 
FROM pages 
WHERE lid = 1 
ORDER BY words DESC 
LIMIT 1;
```
-------------------------5743 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN occurrences < 80 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    biwords
WHERE 
    lid = (SELECT lid FROM langs WHERE lang = 'Catalan');
```
-------------------------5744 sample_num
```sql
SELECT COUNT(*) FROM pages WHERE lid = (SELECT lid FROM langs WHERE lang = 'ca');
```
-------------------------5745 sample_num
```sql
SELECT pid, title, revision 
FROM pages 
WHERE lid = 1 
LIMIT 3;
```
-------------------------5746 sample_num
```sql
SELECT l.lang 
FROM biwords b 
JOIN langs l ON b.lid = l.lid 
WHERE b.w1st = 1 AND b.w2nd = 616;
```
-------------------------5747 sample_num
```sql
SELECT occurrences FROM words WHERE word = 'nombre' AND wid IN (SELECT wid FROM langs_words WHERE lid = 1);
```
-------------------------5748 sample_num
```sql
SELECT w2nd FROM biwords WHERE w1st = 1 AND w2nd = 8968;
```
-------------------------5749 sample_num
```sql
SELECT w.word, lw.occurrences
FROM langs_words lw
JOIN words w ON lw.wid = w.wid
WHERE lw.lid = 1
ORDER BY lw.occurrences DESC
LIMIT 1;
```
-------------------------5750 sample_num
```sql
SELECT occurrences FROM pages_words WHERE pid = 44 AND wid = (SELECT wid FROM words WHERE word = 'votives');
```
-------------------------5751 sample_num
```sql
SELECT pw.occurrences
FROM pages_words pw
JOIN biwords b ON pw.wid = b.w2nd
WHERE pw.pid = 16 AND b.w1st = 1 AND b.w2nd = 109;
```
-------------------------5752 sample_num
```sql
SELECT 
    (COUNT(w.wid) * 100.0 / (SELECT COUNT(*) FROM words w2 JOIN langs l ON w2.wid = l.lid WHERE l.lang = 'ca')) AS percentage
FROM 
    words w
JOIN 
    langs l ON w.wid = l.lid
WHERE 
    w.occurrences < 180 AND l.lang = 'ca';
```
-------------------------5753 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.words > 10000 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    pages p
JOIN 
    langs l ON p.lid = l.lid
WHERE 
    l.lang = 'ca';
```
-------------------------5754 sample_num
```sql
SELECT occurrences FROM words WHERE word = 'desena';
```
-------------------------5755 sample_num
```sql
SELECT COUNT(*) 
FROM words 
WHERE occurrences > 10;
```
-------------------------5756 sample_num
```sql
SELECT pages FROM langs WHERE lang = 'Catalan';
```
-------------------------5757 sample_num
```sql
SELECT COUNT(*) 
FROM words 
WHERE occurrences > 2000 AND occurrences < 5000;
```
-------------------------5758 sample_num
```sql
SELECT title 
FROM pages 
WHERE lid = (SELECT lid FROM langs WHERE lang = 'Catalan') 
AND revision = 106601;
```
-------------------------5759 sample_num
```sql
SELECT title FROM pages WHERE revision = 28040864;
```
-------------------------5760 sample_num
```sql
SELECT SUM(occurrences) AS total_occurrences
FROM biwords
WHERE (w1st = (SELECT wid FROM words WHERE word = 'barcelona') AND w2nd = (SELECT wid FROM words WHERE word = 'precolombina'))
   OR (w1st = (SELECT wid FROM words WHERE word = 'precolombina') AND w2nd = (SELECT wid FROM words WHERE word = 'barcelona'));
```
-------------------------5761 sample_num
```sql
SELECT l.locale 
FROM langs l 
JOIN pages p ON l.lid = p.lid 
WHERE p.title = 'Anys 90';
```
-------------------------5762 sample_num
```sql
SELECT w.word 
FROM words w 
JOIN langs_words lw ON w.wid = lw.wid 
JOIN langs l ON lw.lid = l.lid 
WHERE l.lang = 'Catalan' AND lw.occurrences = 71303;
```
-------------------------5763 sample_num
```sql
SELECT l.locale 
FROM langs l 
JOIN pages p ON l.lid = p.lid 
WHERE p.title = 'Abril';
```
-------------------------5764 sample_num
```sql
SELECT SUM(p.words) AS total_words
FROM pages p
JOIN pages_words pw1 ON p.pid = pw1.pid AND pw1.wid = 100
JOIN pages_words pw2 ON p.pid = pw2.pid AND pw2.wid = 317;
```
-------------------------5765 sample_num
```sql
SELECT COUNT(DISTINCT pw.pid) AS total_pages
FROM pages_words pw
JOIN words w ON pw.wid = w.wid
WHERE w.occurrences = 2593;
```
-------------------------5766 sample_num
```sql
SELECT p.title 
FROM pages p 
JOIN pages_words pw ON p.pid = pw.pid 
WHERE pw.wid < 20;
```
-------------------------5767 sample_num
```sql
SELECT COUNT(*) 
FROM words 
WHERE occurrences = 3;
```
-------------------------5768 sample_num
```sql
SELECT lw.lid
FROM langs_words lw
WHERE lw.occurrences = 8;
```
-------------------------5769 sample_num
```sql
SELECT AVG(percentage) AS average_percentage
FROM (
    SELECT 
        pid,
        (SUM(occurrences) * 100.0 / NULLIF(SUM(pages.words), 0)) AS percentage
    FROM pages
    JOIN words ON pages.pid = pages_words.pid
    JOIN pages_words ON pages.pid = pages_words.pid
    WHERE pages.revision < 106680
    GROUP BY pid
) AS percentages;
```
-------------------------5770 sample_num
```sql
SELECT SUM(pages.words) AS total_pages
FROM words
JOIN pages_words ON words.wid = pages_words.wid
JOIN pages ON pages_words.pid = pages.pid
WHERE words.occurrences > 3000;
```
-------------------------5771 sample_num
```sql
SELECT w1.word, w2.word 
FROM words w1, words w2 
WHERE w1.wid = 20 AND w2.wid = 50;
```
-------------------------5772 sample_num
```sql
SELECT COUNT(*) FROM pages WHERE lid = (SELECT lid FROM langs WHERE lang = 'ca');
```
-------------------------5773 sample_num
```sql
SELECT title 
FROM pages 
WHERE lid = 1 AND words > 4000;
```
-------------------------5774 sample_num
```sql
SELECT words FROM pages WHERE title = 'Asclepi';
```
-------------------------5775 sample_num
```sql
SELECT 
    CASE 
        WHEN (SELECT COUNT(*) FROM words WHERE wid IN (SELECT wid FROM pages_words WHERE pid = (SELECT pid FROM pages WHERE title = 'Afluent'))) > 
             (SELECT COUNT(*) FROM words WHERE wid IN (SELECT wid FROM pages_words WHERE pid = (SELECT pid FROM pages WHERE title = 'Asclepi'))) 
        THEN 'Afluent' 
        ELSE 'Asclepi' 
    END AS page_with_more_words;
```
-------------------------5776 sample_num
```sql
SELECT occurrences FROM words WHERE word = 'nombre';
```
-------------------------5777 sample_num
```sql
SELECT w.word 
FROM words w 
JOIN langs_words lw ON w.wid = lw.wid 
JOIN langs l ON lw.lid = l.lid 
WHERE l.lang = 'Catalan' AND lw.occurrences > 200000;
```
-------------------------5778 sample_num
```sql
SELECT l.locale 
FROM langs l 
JOIN pages p ON l.lid = p.lid 
WHERE p.title = 'Asclepi';
```
-------------------------5779 sample_num
```sql
SELECT pw.occurrences 
FROM pages_words pw 
JOIN pages p ON pw.pid = p.pid 
WHERE p.title = 'Àbac' AND pw.wid = (SELECT wid FROM words WHERE word = 'grec');
```
-------------------------5780 sample_num
```sql
SELECT p.title 
FROM pages p 
JOIN pages_words pw ON p.pid = pw.pid 
JOIN words w ON pw.wid = w.wid 
WHERE w.word = 'grec' AND pw.occurrences > 20;
```
-------------------------5781 sample_num
```sql
SELECT p.words
FROM pages p
JOIN pages_words pw ON p.pid = pw.pid
JOIN words w ON pw.wid = w.wid
WHERE w.word = 'grec' AND w.occurrences = 52;
```
-------------------------5782 sample_num
```sql
SELECT occurrences 
FROM biwords 
WHERE w1st = (SELECT wid FROM words WHERE word = 'àbac') 
  AND w2nd = (SELECT wid FROM words WHERE word = 'xinès');
```
-------------------------5783 sample_num
```sql
SELECT 
    CASE 
        WHEN MAX(CASE WHEN w1st = 'àbac' AND w2nd = 'xinès' THEN occurrences END) > 
             MAX(CASE WHEN w1st = 'àbac' AND w2nd = 'grec' THEN occurrences END) 
        THEN 'àbac-xinès' 
        ELSE 'àbac-grec' 
    END AS higher_occurrence
FROM biwords;
```
-------------------------5784 sample_num
```sql
SELECT (w1.occurrences - b.occurrences) AS difference
FROM biwords b
JOIN words w1 ON b.w1st = w1.word
WHERE b.lid = (SELECT lid FROM langs WHERE lang = 'àbac-xinès');
```
-------------------------5785 sample_num
```sql
SELECT w1st, w2nd, occurrences 
FROM biwords 
WHERE w1st = 'àbac';
```
-------------------------5786 sample_num
```sql
SELECT SUM(occurrences) AS total_occurrences
FROM biwords
WHERE w1st = 'àbac';
```
-------------------------5787 sample_num
```sql
SELECT COUNT(DISTINCT p.pid) 
FROM biwords b 
JOIN langs l ON b.lid = l.lid 
JOIN pages p ON l.lid = p.lid 
JOIN words w1 ON b.w1st = w1.word 
JOIN words w2 ON b.w2nd = w2.word 
WHERE w1.word = 'àbac' AND w2.word = 'xinès';
```
-------------------------5788 sample_num
```sql
SELECT 
    (100.0 * (p1.occurrences - p2.occurrences) / p2.occurrences) AS percentage_increase
FROM 
    (SELECT pw.occurrences 
     FROM pages_words pw 
     JOIN pages p ON pw.pid = p.pid 
     JOIN words w ON pw.wid = w.wid 
     WHERE p.title = 'Àbac' AND w.word = 'grec') AS p1,
    (SELECT pw.occurrences 
     FROM pages_words pw 
     JOIN pages p ON pw.pid = p.pid 
     JOIN words w ON pw.wid = w.wid 
     WHERE p.title = 'Astronomia' AND w.word = 'grec') AS p2;
```
-------------------------5789 sample_num
```sql
SELECT COUNT(*) 
FROM pages 
WHERE lid = (SELECT lid FROM langs WHERE lang = 'ca');
```
-------------------------5790 sample_num
```sql
SELECT lw.wid
FROM langs_words lw
JOIN langs l ON lw.lid = l.lid
WHERE l.lang = 'Catalan'
ORDER BY lw.occurrences DESC
LIMIT 1;
```
-------------------------5791 sample_num
```sql
SELECT w2nd 
FROM biwords 
WHERE occurrences = (SELECT MAX(occurrences) FROM biwords);
```
-------------------------5792 sample_num
```sql
SELECT occurrences FROM words WHERE word = 'panajot';
```
-------------------------5793 sample_num
```sql
SELECT word FROM words WHERE occurrences = 340691;
```
-------------------------5794 sample_num
```sql
SELECT wid FROM words WHERE word = 'periodograma';
```
-------------------------5795 sample_num
```sql
SELECT w2nd FROM biwords WHERE occurrences = 116430;
```
-------------------------5796 sample_num
```sql
SELECT SUM(occurrences) 
FROM biwords 
WHERE w1st = 'riu' OR w2nd = 'riu';
```
-------------------------5797 sample_num
```sql
SELECT pw.wid
FROM pages_words pw
JOIN pages p ON pw.pid = p.pid
WHERE p.title = 'Agricultura'
ORDER BY pw.occurrences DESC
LIMIT 1;
```
-------------------------5798 sample_num
```sql
SELECT occurrences 
FROM pages_words 
WHERE pid = (SELECT pid FROM pages WHERE title = 'Astre') 
AND wid = 2823;
```
-------------------------5799 sample_num
```sql
SELECT p.title
FROM pages_words pw
JOIN pages p ON pw.pid = p.pid
WHERE pw.wid = 174
ORDER BY pw.occurrences DESC
LIMIT 1;
```
-------------------------5800 sample_num
```sql
SELECT SUM(pw.occurrences) AS total_occurrences
FROM pages_words pw
JOIN words w ON pw.wid = w.wid
JOIN pages p ON pw.pid = p.pid
WHERE w.word = 'heròdot' AND p.page = 'Wikipedia';
```
-------------------------5801 sample_num
```sql
SELECT wid 
FROM pages_words 
WHERE pid = (SELECT pid FROM pages WHERE revision = 28278070) 
ORDER BY occurrences DESC 
LIMIT 1;
```
-------------------------5802 sample_num
```sql
SELECT occurrences 
FROM biwords 
WHERE lid = (SELECT lid FROM langs WHERE lang = 'your_language') 
AND w1st = (SELECT wid FROM words WHERE word = 'que') 
AND w2nd = (SELECT wid FROM words WHERE word = 'gregorio');
```
-------------------------5803 sample_num
```sql
SELECT SUM(occurrences) 
FROM biwords 
WHERE w2nd = (SELECT wid FROM words WHERE word = 'base');
```
-------------------------5804 sample_num
```sql
SELECT lw.occurrences 
FROM langs_words lw 
JOIN words w ON lw.wid = w.wid 
WHERE lw.lid = 1 AND w.word = 'exemple';
```
-------------------------5805 sample_num
```sql
SELECT word 
FROM words 
JOIN langs_words ON words.wid = langs_words.wid 
WHERE langs_words.lid = 1 AND langs_words.occurrences = 274499;
```
-------------------------5806 sample_num
```sql
SELECT 
    (SELECT occurrences FROM biwords WHERE w1st = 'a' AND w2nd = 'base') / 
    (SELECT occurrences FROM biwords WHERE w1st = 'a' AND w2nd = 'decimal') AS ratio
```
-------------------------5807 sample_num
```sql
SELECT 
    (SELECT occurrences FROM words WHERE word = 'grec') * 100.0 / 
    (SELECT SUM(occurrences) FROM pages_words pw 
     JOIN pages p ON pw.pid = p.pid 
     WHERE p.title = 'Art') AS percentage
```
-------------------------5808 sample_num
```sql
SELECT COUNT(*) 
FROM pages 
WHERE lid = 1 AND words > 4000;
```
-------------------------5809 sample_num
```sql
SELECT p.title 
FROM pages p 
JOIN langs l ON p.lid = l.lid 
JOIN pages_words pw ON p.pid = pw.pid 
GROUP BY p.pid 
HAVING COUNT(DISTINCT pw.wid) = 10 AND l.lid = 1;
```
-------------------------5810 sample_num
```sql
SELECT w.word 
FROM words w 
JOIN langs_words lw ON w.wid = lw.wid 
JOIN langs l ON lw.lid = l.lid 
WHERE l.lang = 'Catalan' 
ORDER BY lw.occurrences DESC 
LIMIT 1;
```
-------------------------5811 sample_num
```sql
SELECT title 
FROM pages 
WHERE lid = 1 
ORDER BY words DESC 
LIMIT 3;
```
-------------------------5812 sample_num
```sql
SELECT revision FROM pages WHERE lid = 1 AND title = 'Arqueologia';
```
-------------------------5813 sample_num
```sql
SELECT COUNT(*) 
FROM pages 
WHERE lid = 1 AND words > 300 AND revision > 28330000;
```
-------------------------5814 sample_num
```sql
SELECT DISTINCT pw.pid 
FROM pages_words pw 
JOIN words w ON pw.wid = w.wid 
WHERE w.word = 'nombre';
```
-------------------------5815 sample_num
```sql
SELECT COUNT(DISTINCT p.pid) 
FROM pages p 
JOIN langs l ON p.lid = l.lid 
JOIN pages_words pw ON p.pid = pw.pid 
JOIN words w ON pw.wid = w.wid 
WHERE l.lang = 'Catalan' AND w.word = 'nombre' AND pw.occurrences > 5;
```
-------------------------5816 sample_num
```sql
SELECT COUNT(*) 
FROM biwords 
WHERE w2nd = (SELECT wid FROM words WHERE word = 'grec');
```
-------------------------5817 sample_num
```sql
SELECT p.title 
FROM pages p 
JOIN pages_words pw ON p.pid = pw.pid 
JOIN words w ON pw.wid = w.wid 
WHERE w.word = 'grec' AND pw.occurrences = 52;
```
-------------------------5818 sample_num
```sql
SELECT COUNT(*) 
FROM biwords 
WHERE w1st = 'àbac' AND occurrences > 10;
```
-------------------------5819 sample_num
```sql
SELECT AVG(pw.occurrences) AS average_occurrence
FROM pages_words pw
JOIN words w ON pw.wid = w.wid
WHERE w.word = 'grec';
```
-------------------------5820 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE FL_DATE = '2018-08-01';
```
-------------------------5821 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE FL_DATE = '2018/8/1' AND ORIGIN = 'JFK';
```
-------------------------5822 sample_num
```sql
SELECT DEST 
FROM Airlines 
WHERE CANCELLED = 1 AND FL_DATE = '2018-08-01';
```
-------------------------5823 sample_num
```sql
SELECT FL_DATE 
FROM Airlines 
WHERE CANCELLED = 1 AND CANCELLATION_CODE = 'A';
```
-------------------------5824 sample_num
```sql
SELECT DISTINCT ORIGIN 
FROM Airlines 
WHERE FL_DATE = '2018-08-01' AND DEP_DELAY > 0;
```
-------------------------5825 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE FL_DATE = '2018/8/1' 
AND ORIGIN = (SELECT Code FROM Airports WHERE Description = 'New York, NY: John F. Kennedy International');
```
-------------------------5826 sample_num
```sql
SELECT DEST 
FROM Airlines 
WHERE FL_DATE = '2018-08-01' 
ORDER BY DEP_DELAY DESC 
LIMIT 1;
```
-------------------------5827 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE ORIGIN = (SELECT Code FROM Airports WHERE Description = 'New York, NY: John F. Kennedy International') 
AND ARR_DELAY < 0;
```
-------------------------5828 sample_num
```sql
SELECT MIN(CRS_DEP_TIME) 
FROM Airlines 
WHERE ORIGIN = (SELECT Code FROM Airports WHERE Description = 'New York, NY: John F. Kennedy International') 
AND FL_DATE = '2018-08-01';
```
-------------------------5829 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE FL_DATE = '2018-08-01' 
AND OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'American Airlines Inc.: AA');
```
-------------------------5830 sample_num
```sql
SELECT DISTINCT a.OP_CARRIER_FL_NUM
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
JOIN Airports ap ON a.ORIGIN = ap.Code
WHERE ac.Description = 'American Airlines Inc.: AA'
AND ap.Description = 'New York, NY: John F. Kennedy International';
```
-------------------------5831 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines a 
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code 
WHERE ac.Description = 'American Airlines Inc.: AA' 
AND a.FL_DATE = '2018-08-01' 
AND a.ACTUAL_ELAPSED_TIME < a.CRS_ELAPSED_TIME;
```
-------------------------5832 sample_num
```sql
SELECT OP_CARRIER_FL_NUM 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'American Airlines Inc.: AA') 
ORDER BY DEP_DELAY DESC 
LIMIT 1;
```
-------------------------5833 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'American Airlines Inc.: AA') 
AND DEST = 'JFK';
```
-------------------------5834 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'American Airlines Inc.: AA') 
AND FL_DATE = '2018-08-01' 
AND CANCELLED = 1;
```
-------------------------5835 sample_num
```sql
SELECT 
    SUM(CASE WHEN a.Description = 'American Airlines Inc.: AA' THEN 1 ELSE 0 END) AS American_Airlines_Flights,
    SUM(CASE WHEN a.Description = 'Endeavor Air Inc.: 9E' THEN 1 ELSE 0 END) AS Endeavor_Air_Flights
FROM 
    Airlines al
JOIN 
    Air Carriers a ON al.OP_CARRIER_AIRLINE_ID = a.Code
WHERE 
    al.FL_DATE = '2018-08-01';
```
-------------------------5836 sample_num
```sql
SELECT AVG(DEP_DELAY) AS average_departure_delay
FROM Airlines
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'American Airlines Inc.: AA');
```
-------------------------5837 sample_num
```sql
SELECT DIVIDE(COUNT(*), 31) AS average_flights
FROM Airlines
WHERE OP_CARRIER_AIRLINE_ID = 'AA' AND FL_DATE LIKE '2018/8%';
```
-------------------------5838 sample_num
```sql
SELECT COUNT(*) FROM "Air Carriers";
```
-------------------------5839 sample_num
```sql
SELECT COUNT(DISTINCT TAIL_NUM) 
FROM Airlines 
WHERE ORIGIN = (SELECT Code FROM Airports WHERE Description = 'Los Angeles, CA: Los Angeles International') 
AND FL_DATE = '2018-08-27';
```
-------------------------5840 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE DEST = (SELECT Code FROM Airports WHERE Description LIKE '%Oakland%') 
AND FL_DATE = '2018-08-07';
```
-------------------------5841 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Alaska Airlines Inc.: AS') 
AND DEP_DELAY > 0 
AND FL_DATE = '2018-08-02';
```
-------------------------5842 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE DEST = 'MIA' AND ARR_DELAY < 0 AND FL_DATE = '2018-08-12';
```
-------------------------5843 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'American Airlines Inc.: AA') 
AND CANCELLED = 1 
AND CANCELLATION_CODE = 'A';
```
-------------------------5844 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Endeavor Air Inc.: 9E') 
AND FL_DATE = '2018-08-31' 
AND ACTUAL_ELAPSED_TIME < CRS_ELAPSED_TIME;
```
-------------------------5845 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Spirit Air Lines: NK') 
AND FL_DATE = '2018-08-07';
```
-------------------------5846 sample_num
```sql
SELECT ac.Description 
FROM Airlines a 
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code 
WHERE a.TAIL_NUM = 'N702SK';
```
-------------------------5847 sample_num
```sql
SELECT a.Description
FROM Airlines AS al
JOIN Airports AS a ON al.DEST_AIRPORT_ID = a.Code
WHERE al.FL_DATE = '2018-08-15'
GROUP BY a.Description
ORDER BY COUNT(al.DEST_AIRPORT_ID) DESC
LIMIT 1;
```
-------------------------5848 sample_num
```sql
SELECT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.ORIGIN = 'ATL' 
  AND a.DEST = 'PHL' 
  AND a.FL_DATE = '2018-08-01' 
  AND a.CRS_DEP_TIME = '2040';
```
-------------------------5849 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE DEST = (SELECT Code FROM Airports WHERE Description = 'Lake Charles, LA: Lake Charles Regional') 
AND FL_DATE = '2018-08-15';
```
-------------------------5850 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE ORIGIN = (SELECT Code FROM Airports WHERE Description = 'San Diego, CA: San Diego International') 
AND DEST = (SELECT Code FROM Airports WHERE Description = 'Los Angeles, CA: Los Angeles International') 
AND FL_DATE LIKE '2018/8%';
```
-------------------------5851 sample_num
```sql
SELECT 
    (SUM(CASE WHEN CANCELLATION_CODE = 'C' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS cancellation_percentage
FROM 
    Airlines
WHERE 
    ORIGIN = (SELECT Code FROM Airports WHERE Description = 'Los Angeles, CA: Los Angeles International');
```
-------------------------5852 sample_num
```sql
SELECT 
    (SUM(CASE WHEN ACTUAL_ELAPSED_TIME < CRS_ELAPSED_TIME THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Airlines A
JOIN 
    Airports AP ON A.DEST_AIRPORT_ID = AP.Code
WHERE 
    AP.Description LIKE '%Pittsburgh%';
```
-------------------------5853 sample_num
```sql
SELECT Description FROM Air Carriers WHERE Code = '19049';
```
-------------------------5854 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE FL_DATE = '2018-08-01' AND DEP_DELAY <= 0;
```
-------------------------5855 sample_num
```sql
SELECT Code FROM Airports WHERE Description LIKE '%Ankara, Turkey%';
```
-------------------------5856 sample_num
```sql
SELECT MAX(WEATHER_DELAY) AS Longest_Weather_Delay
FROM Airlines
WHERE ORIGIN_AIRPORT_ID = 12264;
```
-------------------------5857 sample_num
```sql
SELECT Code FROM Airports WHERE Description = 'Anita Bay, AK: Anita Bay Airport';
```
-------------------------5858 sample_num
```sql
SELECT ORIGIN_AIRPORT_ID
FROM Airlines
ORDER BY LATE_AIRCRAFT_DELAY DESC
LIMIT 1;
```
-------------------------5859 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines a
JOIN Airports o ON a.ORIGIN_AIRPORT_ID = o.Code
JOIN Airports d ON a.DEST_AIRPORT_ID = d.Code
WHERE o.Description = 'Chicago, IL: Chicago O\'Hare International' 
AND d.Description = 'Atlanta, GA: Hartsfield-Jackson Atlanta International';
```
-------------------------5860 sample_num
```sql
SELECT COUNT(DISTINCT TAIL_NUM) 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Southwest Airlines Co.: WN');
```
-------------------------5861 sample_num
```sql
SELECT FL_DATE, COUNT(*) AS CancelledFlights
FROM Airlines
JOIN Airports ON Airlines.ORIGIN_AIRPORT_ID = Airports.Code
WHERE FL_DATE LIKE '2018/8%' AND CANCELLED = 1 AND CANCELLATION_CODE = 'A' AND Airports.Description = 'Dallas/Fort Worth, TX: Dallas/Fort Worth International'
GROUP BY FL_DATE
ORDER BY CancelledFlights DESC
LIMIT 1;
```
-------------------------5862 sample_num
```sql
SELECT DISTINCT TAIL_NUM 
FROM Airlines 
WHERE ARR_DELAY <= 0 
AND DEST = (SELECT Code FROM Airports WHERE Description = 'Bakersfield, CA: Meadows Field') 
AND FL_DATE LIKE '2018/8%';
```
-------------------------5863 sample_num
```sql
SELECT OP_CARRIER_AIRLINE_ID
FROM Airlines
WHERE DEST = (SELECT Code FROM Airports WHERE Description = 'Boston, MA: Logan International')
GROUP BY OP_CARRIER_AIRLINE_ID
ORDER BY MAX(SECURITY_DELAY) DESC
LIMIT 1;
```
-------------------------5864 sample_num
```sql
SELECT ac.Description, COUNT(DISTINCT a.TAIL_NUM) AS aircraft_count
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
GROUP BY ac.Description
ORDER BY aircraft_count DESC
LIMIT 5;
```
-------------------------5865 sample_num
```sql
SELECT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.CANCELLED = 0
GROUP BY ac.Description
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------5866 sample_num
```sql
SELECT ac.Description 
FROM Airlines a 
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code 
WHERE a.TAIL_NUM = 'N202NN';
```
-------------------------5867 sample_num
```sql
SELECT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
JOIN Airports ap ON a.DEST_AIRPORT_ID = ap.Code
WHERE ap.Description = 'Chicago, IL: Chicago Midway International'
GROUP BY ac.Description
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------5868 sample_num
```sql
SELECT TAIL_NUM
FROM Airlines
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Compass Airlines: CP')
AND ORIGIN = 'LAX' AND DEST = 'ABQ'
GROUP BY TAIL_NUM
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------5869 sample_num
```sql
SELECT ORIGIN, COUNT(ORIGIN) AS flight_count
FROM Airlines
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Republic Airline: YX')
GROUP BY ORIGIN
ORDER BY flight_count DESC
LIMIT 1;
```
-------------------------5870 sample_num
```sql
SELECT OP_CARRIER_AIRLINE_ID
FROM Airlines
WHERE (ACTUAL_ELAPSED_TIME - CRS_ELAPSED_TIME) = (
    SELECT MIN(ACTUAL_ELAPSED_TIME - CRS_ELAPSED_TIME)
    FROM Airlines
);
```
-------------------------5871 sample_num
```sql
SELECT 
    TAIL_NUM,
    DIVIDE(SUM(LATE_AIRCRAFT_DELAY), 60) AS total_delayed_hours
FROM 
    Airlines
WHERE 
    OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Delta Air Lines Inc.: DL')
    AND FL_DATE LIKE '2018/8/%'
GROUP BY 
    TAIL_NUM
ORDER BY 
    total_delayed_hours DESC
LIMIT 1;
```
-------------------------5872 sample_num
```sql
SELECT Code, Description FROM Airports LIMIT 3;
```
-------------------------5873 sample_num
```sql
SELECT Code FROM "Air Carriers" WHERE Description LIKE 'Mississippi Valley Airlines%';
```
-------------------------5874 sample_num
```sql
SELECT CRS_DEP_TIME, DEP_TIME 
FROM Airlines 
WHERE ORIGIN = 'PHL' 
  AND DEST = 'MDT' 
  AND TAIL_NUM = 'N627AE' 
  AND FL_DATE = '2018-08-13';
```
-------------------------5875 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE FL_DATE = '2018-08-01' AND ORIGIN = 'ABE';
```
-------------------------5876 sample_num
```sql
SELECT DISTINCT DEST 
FROM Airlines 
WHERE ORIGIN = 'ABY';
```
-------------------------5877 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE ORIGIN = 'DFW' AND DEST = 'SNA' AND DEP_DELAY = 0;
```
-------------------------5878 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines a
JOIN Airports o ON a.ORIGIN_AIRPORT_ID = o.Code
JOIN Airports d ON a.DEST_AIRPORT_ID = d.Code
WHERE o.Description = 'Charlotte, NC: Charlotte Douglas International' 
  AND d.Description = 'Austin, TX: Austin - Bergstrom International' 
  AND a.CANCELLATION_CODE = 'A';
```
-------------------------5879 sample_num
```sql
SELECT OP_CARRIER_AIRLINE_ID, COUNT(*) AS cancelled_flights
FROM Airlines
WHERE CANCELLED = 1
GROUP BY OP_CARRIER_AIRLINE_ID
ORDER BY cancelled_flights DESC
LIMIT 1;
```
-------------------------5880 sample_num
```sql
SELECT DEP_TIME 
FROM Airlines a 
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code 
JOIN Airports ap ON a.DEST_AIRPORT_ID = ap.Code 
WHERE ac.Description LIKE '%JetBlue Airways%' 
  AND a.TAIL_NUM = 'N903JB' 
  AND ap.Description LIKE '%Fort Lauderdale-Hollywood%' 
  AND a.FL_DATE = '2018-08-20';
```
-------------------------5881 sample_num
```sql
SELECT DISTINCT OP_CARRIER_AIRLINE_ID 
FROM Airlines 
WHERE ORIGIN = 'ACY' AND DEST = 'FLL';
```
-------------------------5882 sample_num
```sql
SELECT Description FROM Airports WHERE Code = 'A11';
```
-------------------------5883 sample_num
```sql
SELECT COUNT(*) AS total_flights
FROM Airlines
WHERE ORIGIN = 'OKC';
```
-------------------------5884 sample_num
```sql
SELECT COUNT(*) 
FROM Airports 
WHERE Code LIKE 'C%';
```
-------------------------5885 sample_num
```sql
SELECT DEST FROM Airlines WHERE OP_CARRIER_FL_NUM = '1596';
```
-------------------------5886 sample_num
```sql
SELECT Description 
FROM Airports 
WHERE Code LIKE '%3';
```
-------------------------5887 sample_num
```sql
SELECT Code FROM Airports WHERE Description = 'Driftwood Bay, AK: Driftwood Bay Airport';
```
-------------------------5888 sample_num
```sql
SELECT COUNT(*) AS cancelled_flights
FROM Airlines
WHERE CANCELLED = 1;
```
-------------------------5889 sample_num
```sql
SELECT TAIL_NUM 
FROM Airlines 
WHERE FL_DATE = '2018-08-17';
```
-------------------------5890 sample_num
```sql
SELECT ORIGIN 
FROM Airlines 
WHERE ACTUAL_ELAPSED_TIME = (SELECT MIN(ACTUAL_ELAPSED_TIME) FROM Airlines);
```
-------------------------5891 sample_num
```sql
SELECT FL_DATE, TAIL_NUM 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID IN (SELECT Code FROM Air Carriers WHERE Description = 'Ross Aviation Inc.: GWE');
```
-------------------------5892 sample_num
```sql
SELECT ac.Description, ac.Code
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.ARR_TIME = (SELECT MIN(ARR_TIME) FROM Airlines);
```
-------------------------5893 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = 'B6' 
AND ARR_DELAY_NEW = 0;
```
-------------------------5894 sample_num
```sql
SELECT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.DEST = 'MIA';
```
-------------------------5895 sample_num
```sql
SELECT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.CANCELLED = 1;
```
-------------------------5896 sample_num
```sql
SELECT ACTUAL_ELAPSED_TIME 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Semo Aviation Inc.: SEM');
```
-------------------------5897 sample_num
```sql
SELECT TAIL_NUM 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Asap Air Inc.: ASP') 
ORDER BY DEP_DELAY DESC 
LIMIT 1;
```
-------------------------5898 sample_num
```sql
SELECT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.DEP_DELAY = 0;
```
-------------------------5899 sample_num
```sql
SELECT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.ACTUAL_ELAPSED_TIME = (SELECT MAX(ACTUAL_ELAPSED_TIME) FROM Airlines);
```
-------------------------5900 sample_num
```sql
SELECT DISTINCT DEST 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID IN (
    SELECT Code 
    FROM Air Carriers 
    WHERE Description = 'Southeast Alaska Airlines: WEB'
);
```
-------------------------5901 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines a 
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code 
WHERE a.FL_DATE BETWEEN '2018-08-10' AND '2018-08-20' 
AND a.CANCELLED = 1 
AND ac.Description = 'Spirit Air Lines: NK';
```
-------------------------5902 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.FL_DATE = '2018/8/2' AND ac.Description LIKE '%Horizon Air%';
```
-------------------------5903 sample_num
```sql
SELECT TAIL_NUM 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID IN (SELECT Code FROM Air Carriers WHERE Description = 'Iscargo Hf: ICQ') 
AND ARR_TIME <= 1000;
```
-------------------------5904 sample_num
```sql
SELECT FL_DATE 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Profit Airlines Inc.: XBH') 
AND ACTUAL_ELAPSED_TIME < 100;
```
-------------------------5905 sample_num
```sql
SELECT COUNT(*) 
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE ac.Description LIKE '%Republic Airline%' AND a.DEP_DELAY > 30;
```
-------------------------5906 sample_num
```sql
SELECT DISTINCT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.FL_DATE = '2018/8/25' AND a.DEP_DELAY = -5;
```
-------------------------5907 sample_num
```sql
SELECT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.TAIL_NUM = 'N922US' AND a.ORIGIN = 'PHX';
```
-------------------------5908 sample_num
```sql
SELECT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.ARR_DELAY < 0 AND a.DEP_DELAY < 0;
```
-------------------------5909 sample_num
```sql
SELECT TAIL_NUM 
FROM Airlines 
WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Southwest Airlines Co.: WN') 
AND ACTUAL_ELAPSED_TIME < (SELECT AVG(ACTUAL_ELAPSED_TIME) * 0.8 FROM Airlines WHERE OP_CARRIER_AIRLINE_ID = (SELECT Code FROM Air Carriers WHERE Description = 'Southwest Airlines Co.: WN'));
```
-------------------------5910 sample_num
```sql
SELECT ac.Description
FROM Airlines a
JOIN Air Carriers ac ON a.OP_CARRIER_AIRLINE_ID = ac.Code
WHERE a.DEST = 'PHX' 
AND a.ARR_TIME < (SELECT AVG(ARR_TIME) * 0.4 FROM Airlines WHERE DEST = 'PHX');
```
-------------------------5911 sample_num
```sql
SELECT 
    (SUM(CASE WHEN DEP_DELAY < 0 THEN 1 ELSE 0 END) * 1.0 / COUNT(*)) * 100 AS percentage_earlier_departure
FROM 
    Airlines
WHERE 
    OP_CARRIER_AIRLINE_ID IN (SELECT Code FROM Air Carriers WHERE Description LIKE '%American Airlines%');
```
-------------------------5912 sample_num
```sql
SELECT COUNT(*) 
FROM book 
WHERE publisher_id = 1929 AND num_pages > 500;
```
-------------------------5913 sample_num
```sql
SELECT publication_date 
FROM book 
WHERE num_pages = (SELECT MAX(num_pages) FROM book);
```
-------------------------5914 sample_num
```sql
SELECT publisher.publisher_name 
FROM book 
JOIN publisher ON book.publisher_id = publisher.publisher_id 
WHERE book.title = 'The Illuminati';
```
-------------------------5915 sample_num
```sql
SELECT COUNT(*) 
FROM book 
WHERE publisher_id = (SELECT publisher_id FROM publisher WHERE publisher_name = 'Thomas Nelson');
```
-------------------------5916 sample_num
```sql
SELECT publisher_name
FROM publisher
JOIN book ON publisher.publisher_id = book.publisher_id
GROUP BY publisher_name
ORDER BY COUNT(book.book_id) DESC
LIMIT 1;
```
-------------------------5917 sample_num
```sql
SELECT title 
FROM book 
WHERE publisher_id = (SELECT publisher_id FROM publisher WHERE publisher_name = 'Thomas Nelson') 
ORDER BY publication_date ASC 
LIMIT 1;
```
-------------------------5918 sample_num
```sql
SELECT COUNT(*) 
FROM book 
JOIN publisher ON book.publisher_id = publisher.publisher_id 
WHERE publisher.publisher_name = 'Thomas Nelson' AND book.num_pages > 300;
```
-------------------------5919 sample_num
```sql
SELECT p.publisher_name
FROM book b
JOIN publisher p ON b.publisher_id = p.publisher_id
WHERE b.num_pages = (SELECT MAX(num_pages) FROM book);
```
-------------------------5920 sample_num
```sql
SELECT COUNT(*) 
FROM book 
WHERE language_id = (SELECT language_id FROM book_language WHERE language_name = 'English');
```
-------------------------5921 sample_num
```sql
SELECT b.title 
FROM book b 
JOIN book_language bl ON b.language_id = bl.language_id 
WHERE bl.language_name = 'British English';
```
-------------------------5922 sample_num
```sql
SELECT MIN(ol.price) AS cheapest_order_price
FROM order_line ol
JOIN cust_order co ON ol.order_id = co.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE b.title = 'The Little House';
```
-------------------------5923 sample_num
```sql
SELECT b.title
FROM book b
JOIN order_line ol ON b.book_id = ol.book_id
JOIN cust_order co ON ol.order_id = co.order_id
JOIN customer c ON co.customer_id = c.customer_id
WHERE c.first_name = 'Lucas' AND c.last_name = 'Wyldbore';
```
-------------------------5924 sample_num
```sql
SELECT COUNT(b.book_id) AS books_over_300_pages
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE c.first_name = 'Lucas' AND c.last_name = 'Wyldbore' AND b.num_pages > 300;
```
-------------------------5925 sample_num
```sql
SELECT SUM(ol.price) AS total_price
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
WHERE c.first_name = 'Lucas' AND c.last_name = 'Wyldbore';
```
-------------------------5926 sample_num
```sql
SELECT AVG(ol.price) AS average_spend
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
WHERE c.first_name = 'Lucas' AND c.last_name = 'Wyldbore';
```
-------------------------5927 sample_num
```sql
SELECT 
    (SUM(CASE WHEN ol.price > 13 THEN 1 ELSE 0 END) * 100.0 / COUNT(ol.order_id)) AS percentage_over_13
FROM 
    customer c
JOIN 
    cust_order co ON c.customer_id = co.customer_id
JOIN 
    order_line ol ON co.order_id = ol.order_id
WHERE 
    c.first_name = 'Lucas' AND c.last_name = 'Wyldbore';
```
-------------------------5928 sample_num
```sql
SELECT city FROM address WHERE address_id = 547;
```
-------------------------5929 sample_num
```sql
SELECT COUNT(*) AS order_count
FROM cust_order
WHERE customer_id = (SELECT customer_id FROM customer WHERE first_name = 'Cordy' AND last_name = 'Dumbarton');
```
-------------------------5930 sample_num
```sql
SELECT title 
FROM book 
WHERE language_id = (SELECT language_id FROM book_language WHERE language_name = 'Japanese') 
ORDER BY publication_date ASC 
LIMIT 1;
```
-------------------------5931 sample_num
```sql
SELECT publisher_name
FROM publisher
WHERE publisher_id = (
    SELECT publisher_id
    FROM book
    GROUP BY publisher_id
    ORDER BY COUNT(book_id) DESC
    LIMIT 1
);
```
-------------------------5932 sample_num
```sql
SELECT COUNT(*) 
FROM book 
WHERE publisher_id = (SELECT publisher_id FROM publisher WHERE publisher_name = 'Kensington');
```
-------------------------5933 sample_num
```sql
SELECT bl.language_name 
FROM book b 
JOIN book_language bl ON b.language_id = bl.language_id 
WHERE b.book_id = 1405;
```
-------------------------5934 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
GROUP BY c.customer_id
ORDER BY COUNT(co.order_id) DESC
LIMIT 1;
```
-------------------------5935 sample_num
```sql
SELECT title 
FROM book 
WHERE book_id IN (
    SELECT book_id 
    FROM order_line 
    GROUP BY book_id 
    ORDER BY COUNT(order_id) DESC 
    LIMIT 1
);
```
-------------------------5936 sample_num
```sql
SELECT COUNT(*) 
FROM book_author ba
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'David Foster Wallace';
```
-------------------------5937 sample_num
```sql
SELECT COUNT(DISTINCT co.order_id) AS order_count
FROM cust_order co
JOIN order_line ol ON co.order_id = ol.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE b.title = 'O Xará';
```
-------------------------5938 sample_num
```sql
SELECT c.first_name, c.last_name, co.country_name
FROM customer c
JOIN customer_address ca ON c.customer_id = ca.customer_id
JOIN address a ON ca.address_id = a.address_id
JOIN country co ON a.country_id = co.country_id
WHERE c.first_name = 'Malina' AND c.last_name = 'Johnson';
```
-------------------------5939 sample_num
```sql
SELECT COUNT(*) 
FROM address 
WHERE country_id = (SELECT country_id FROM country WHERE country_name = 'Ukraine');
```
-------------------------5940 sample_num
```sql
SELECT country.country_name 
FROM address 
JOIN country ON address.country_id = country.country_id 
WHERE address.city = 'Žirovnica';
```
-------------------------5941 sample_num
```sql
SELECT 
    (SUM(CASE WHEN sm.method_name = 'International' THEN 1 ELSE 0 END) * 100.0 / COUNT(o.order_id)) AS international_shipping_percentage
FROM 
    cust_order o
JOIN 
    shipping_method sm ON o.shipping_method_id = sm.method_id
WHERE 
    o.order_date LIKE '2022-11-10%';
```
-------------------------5942 sample_num
```sql
SELECT AVG(num_pages) AS average_num_pages
FROM book
JOIN book_author ON book.book_id = book_author.book_id
JOIN author ON book_author.author_id = author.author_id
WHERE author.author_name = 'David Coward';
```
-------------------------5943 sample_num
```sql
SELECT cost FROM shipping_method WHERE method_name = 'Standard';
```
-------------------------5944 sample_num
```sql
SELECT title 
FROM book 
WHERE publication_date LIKE '1900%' 
ORDER BY publication_date 
LIMIT 1;
```
-------------------------5945 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM customer
WHERE email = 'aalleburtonkc@yellowbook.com';
```
-------------------------5946 sample_num
```sql
SELECT COUNT(*) 
FROM cust_order co
JOIN customer_address ca ON co.dest_address_id = ca.address_id
JOIN address a ON ca.address_id = a.address_id
JOIN country c ON a.country_id = c.country_id
WHERE c.country_name = 'Iran' AND co.order_date LIKE '2022%';
```
-------------------------5947 sample_num
```sql
SELECT COUNT(*) 
FROM cust_order co
JOIN customer c ON co.customer_id = c.customer_id
JOIN shipping_method sm ON co.shipping_method_id = sm.method_id
WHERE c.first_name = 'Daisey' AND c.last_name = 'Lamball' 
AND sm.method_name = 'International';
```
-------------------------5948 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
GROUP BY c.customer_id
ORDER BY COUNT(ol.book_id) DESC
LIMIT 1;
```
-------------------------5949 sample_num
```sql
SELECT COUNT(o.order_id) AS returned_orders
FROM cust_order o
JOIN order_history h ON o.order_id = h.order_id
JOIN customer c ON o.customer_id = c.customer_id
WHERE c.first_name = 'Antonia' AND c.last_name = 'Poltun' AND h.status_id = (SELECT status_id FROM order_status WHERE status_value = 'Returned');
```
-------------------------5950 sample_num
```sql
SELECT sm.method_name
FROM shipping_method sm
JOIN cust_order co ON sm.method_id = co.shipping_method_id
GROUP BY sm.method_id, sm.method_name
ORDER BY COUNT(co.shipping_method_id) DESC
LIMIT 1;
```
-------------------------5951 sample_num
```sql
SELECT COUNT(DISTINCT o.order_id) AS delivered_orders
FROM cust_order o
JOIN order_history oh ON o.order_id = oh.order_id
JOIN order_status os ON oh.status_id = os.status_id
WHERE os.status_value = 'Delivered' AND oh.status_date LIKE '2021%';
```
-------------------------5952 sample_num
```sql
SELECT b.title 
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'J.K Rowling'
ORDER BY b.publication_date ASC
LIMIT 1;
```
-------------------------5953 sample_num
```sql
SELECT COUNT(*) 
FROM book_author ba 
JOIN author a ON ba.author_id = a.author_id 
WHERE a.author_name = 'A.R. Braunmuller';
```
-------------------------5954 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN book b ON p.publisher_id = b.publisher_id
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Agatha Christie'
AND b.publication_date = (
    SELECT MIN(publication_date)
    FROM book
    JOIN book_author ON book.book_id = book_author.book_id
    JOIN author ON book_author.author_id = author.author_id
    WHERE author.author_name = 'Agatha Christie'
);
```
-------------------------5955 sample_num
```sql
SELECT b.title 
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Danielle Steel';
```
-------------------------5956 sample_num
```sql
SELECT COUNT(b.book_id) AS book_count
FROM book b
JOIN publisher p ON b.publisher_id = p.publisher_id
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'William Shakespeare' AND p.publisher_name = 'Penguin Classics';
```
-------------------------5957 sample_num
```sql
SELECT publisher_name
FROM publisher
JOIN book ON publisher.publisher_id = book.publisher_id
GROUP BY publisher_name
ORDER BY COUNT(book.book_id) DESC
LIMIT 1;
```
-------------------------5958 sample_num
```sql
SELECT SUM(sm.cost) AS total_shipping_cost, COUNT(co.order_id) AS orders_in_2022
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN shipping_method sm ON co.shipping_method_id = sm.method_id
WHERE c.first_name = 'Page' AND c.last_name = 'Holsey' AND co.order_date LIKE '2022%';
```
-------------------------5959 sample_num
```sql
SELECT publisher_name FROM publisher WHERE publisher_id = 22;
```
-------------------------5960 sample_num
```sql
SELECT COUNT(*) 
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Al Gore' AND b.num_pages < 400;
```
-------------------------5961 sample_num
```sql
SELECT a.author_name, p.publisher_name
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
JOIN publisher p ON b.publisher_id = p.publisher_id
WHERE b.publication_date = '1997-07-10';
```
-------------------------5962 sample_num
```sql
SELECT bl.language_name 
FROM book b 
JOIN book_language bl ON b.language_id = bl.language_id 
WHERE b.isbn13 = '23755004321';
```
-------------------------5963 sample_num
```sql
SELECT b.title 
FROM book b 
JOIN order_line ol ON b.book_id = ol.book_id 
ORDER BY ol.price DESC 
LIMIT 1;
```
-------------------------5964 sample_num
```sql
SELECT SUM(ol.price) AS total_price
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
WHERE c.first_name = 'Lucas' AND c.last_name = 'Wyldbore';
```
-------------------------5965 sample_num
```sql
SELECT b.isbn13 
FROM book b 
JOIN book_language bl ON b.language_id = bl.language_id 
WHERE bl.language_name = 'Spanish';
```
-------------------------5966 sample_num
```sql
SELECT COUNT(*) 
FROM book b
JOIN publisher p ON b.publisher_id = p.publisher_id
JOIN order_line ol ON b.book_id = ol.book_id
WHERE ol.price < 1 AND p.publisher_name = 'Berkley Trade';
```
-------------------------5967 sample_num
```sql
SELECT b.title
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE c.first_name = 'Zia' AND c.last_name = 'Roizin';
```
-------------------------5968 sample_num
```sql
SELECT a.author_name
FROM author a
JOIN book_author ba ON a.author_id = ba.author_id
JOIN book b ON ba.book_id = b.book_id
WHERE b.num_pages = (SELECT MAX(num_pages) FROM book);
```
-------------------------5969 sample_num
```sql
SELECT DISTINCT c.email
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE b.title = 'Switch on the Night';
```
-------------------------5970 sample_num
```sql
SELECT a.author_name
FROM author a
JOIN book_author ba ON a.author_id = ba.author_id
JOIN book b ON ba.book_id = b.book_id
JOIN publisher p ON b.publisher_id = p.publisher_id
WHERE p.publisher_name = 'Abrams';
```
-------------------------5971 sample_num
```sql
SELECT publisher.publisher_name 
FROM book 
JOIN publisher ON book.publisher_id = publisher.publisher_id 
WHERE book.title = 'The Illuminati';
```
-------------------------5972 sample_num
```sql
SELECT 
    (SUM(CASE WHEN b.publication_date LIKE '1992%' THEN 1 ELSE 0 END) * 100.0 / COUNT(b.book_id)) AS percentage
FROM 
    book b
JOIN 
    book_author ba ON b.book_id = ba.book_id
JOIN 
    author a ON ba.author_id = a.author_id
WHERE 
    a.author_name = 'Abraham Lincoln';
```
-------------------------5973 sample_num
```sql
SELECT DISTINCT p.publisher_name
FROM publisher p
JOIN book b ON p.publisher_id = b.publisher_id
WHERE b.publication_date LIKE '2004%'
AND b.num_pages > (SELECT AVG(num_pages) * 0.7 FROM book);
```
-------------------------5974 sample_num
```sql
SELECT email FROM customer WHERE first_name = 'Moss' AND last_name = 'Zarb';
```
-------------------------5975 sample_num
```sql
SELECT street_name FROM address WHERE city = 'Dallas';
```
-------------------------5976 sample_num
```sql
SELECT b.title 
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Orson Scott Card' AND b.publication_date LIKE '2001%';
```
-------------------------5977 sample_num
```sql
SELECT COUNT(b.book_id) AS book_count
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Orson Scott Card';
```
-------------------------5978 sample_num
```sql
SELECT a.author_name, b.title
FROM author a
JOIN book_author ba ON a.author_id = ba.author_id
JOIN book b ON ba.book_id = b.book_id
WHERE b.num_pages > 3000;
```
-------------------------5979 sample_num
```sql
SELECT a.author_name 
FROM author a 
JOIN book_author ba ON a.author_id = ba.author_id 
JOIN book b ON ba.book_id = b.book_id 
WHERE b.title = 'The Prophet';
```
-------------------------5980 sample_num
```sql
SELECT COUNT(*) AS number_of_books
FROM book
WHERE publisher_id = (SELECT publisher_id FROM publisher WHERE publisher_name = 'Ace Hardcover');
```
-------------------------5981 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN book b ON p.publisher_id = b.publisher_id
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Barry Eisler';
```
-------------------------5982 sample_num
```sql
SELECT COUNT(*) 
FROM book 
WHERE language_id = (SELECT language_id FROM book_language WHERE language_name = 'Japanese');
```
-------------------------5983 sample_num
```sql
SELECT SUM(ol.price) AS total_price
FROM order_line ol
JOIN cust_order co ON ol.order_id = co.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE b.title = 'The Prophet';
```
-------------------------5984 sample_num
```sql
SELECT COUNT(cust_order.order_id) AS number_of_orders
FROM cust_order
JOIN customer ON cust_order.customer_id = customer.customer_id
JOIN customer_address ON customer.customer_id = customer_address.customer_id
JOIN address ON customer_address.address_id = address.address_id
JOIN order_history ON cust_order.order_id = order_history.order_id
JOIN author ON book_author.author_id = author.author_id
JOIN book ON book_author.book_id = book.book_id
WHERE author.author_name = 'Daisey Lamball' AND cust_order.order_date LIKE '2021%';
```
-------------------------5985 sample_num
```sql
SELECT COUNT(DISTINCT c.customer_id) AS customer_count
FROM customer c
JOIN customer_address ca ON c.customer_id = ca.customer_id
JOIN address a ON ca.address_id = a.address_id
JOIN country co ON a.country_id = co.country_id
WHERE co.country_name = 'Australia';
```
-------------------------5986 sample_num
```sql
SELECT COUNT(DISTINCT oh.order_id) AS delivered_orders
FROM order_history oh
JOIN order_status os ON oh.status_id = os.status_id
WHERE os.status_value = 'Delivered' AND oh.status_date LIKE '2019-12%';
```
-------------------------5987 sample_num
```sql
SELECT c.first_name, c.last_name
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE b.title = 'Fantasmas';
```
-------------------------5988 sample_num
```sql
SELECT 
    (SUM(CASE WHEN sm.method_name = 'International' THEN 1 ELSE 0 END) * 100.0 / COUNT(co.order_id)) AS international_shipping_percentage
FROM 
    cust_order co
JOIN 
    shipping_method sm ON co.shipping_method_id = sm.method_id
WHERE 
    co.order_date LIKE '2020%';
```
-------------------------5989 sample_num
```sql
SELECT * FROM author WHERE author_name LIKE 'George%';
```
-------------------------5990 sample_num
```sql
SELECT YEAR(order_date) AS order_year, COUNT(order_id) AS order_count
FROM cust_order
GROUP BY order_year
ORDER BY order_count DESC
LIMIT 1;
```
-------------------------5991 sample_num
```sql
SELECT AVG(price) AS average_price FROM order_line;
```
-------------------------5992 sample_num
```sql
SELECT title FROM book WHERE publication_date LIKE '1995%';
```
-------------------------5993 sample_num
```sql
SELECT SUBSTR(email, CHARINDEX('@', email) + 1) AS domain, COUNT(*) AS domain_count
FROM customer
GROUP BY domain
ORDER BY domain_count DESC
LIMIT 1;
```
-------------------------5994 sample_num
```sql
SELECT COUNT(*) FROM publisher WHERE publisher_name LIKE '%book%';
```
-------------------------5995 sample_num
```sql
SELECT bl.language_name
FROM book b
JOIN book_language bl ON b.language_id = bl.language_id
GROUP BY bl.language_name
ORDER BY COUNT(b.book_id) ASC
LIMIT 1;
```
-------------------------5996 sample_num
```sql
SELECT co.order_date
FROM customer AS c
JOIN cust_order AS co ON c.customer_id = co.customer_id
WHERE c.first_name = 'Adrian' AND c.last_name = 'Kunzelmann';
```
-------------------------5997 sample_num
```sql
SELECT COUNT(*) 
FROM address 
WHERE country_id = (SELECT country_id FROM country WHERE country_name = 'Philippines');
```
-------------------------5998 sample_num
```sql
SELECT a.author_name
FROM author a
JOIN book_author ba ON a.author_id = ba.author_id
GROUP BY a.author_id, a.author_name
ORDER BY COUNT(ba.book_id) DESC
LIMIT 1;
```
-------------------------5999 sample_num
```sql
SELECT b.title 
FROM book b 
JOIN publisher p ON b.publisher_id = p.publisher_id 
WHERE p.publisher_name = 'Harper Collins';
```
-------------------------6000 sample_num
```sql
SELECT COUNT(*) 
FROM order_history oh
JOIN order_status os ON oh.status_id = os.status_id
WHERE os.status_value = 'Returned' 
AND oh.status_date LIKE '%2020%';
```
-------------------------6001 sample_num
```sql
SELECT method_name
FROM shipping_method
JOIN cust_order ON shipping_method.method_id = cust_order.shipping_method_id
GROUP BY method_name
ORDER BY COUNT(cust_order.order_id) ASC
LIMIT 1 OFFSET 1;
```
-------------------------6002 sample_num
```sql
SELECT COUNT(*) AS inactive_address_count
FROM customer_address ca
JOIN address_status as ON ca.status_id = as.status_id
WHERE as.address_status = 'Inactive';
```
-------------------------6003 sample_num
```sql
SELECT b.title
FROM book b
JOIN order_line ol ON b.book_id = ol.book_id
GROUP BY b.book_id, b.title
ORDER BY COUNT(ol.order_id) DESC
LIMIT 1;
```
-------------------------6004 sample_num
```sql
SELECT a.street_name, a.city
FROM address a
JOIN cust_order co ON a.address_id = co.dest_address_id
GROUP BY a.address_id
ORDER BY COUNT(co.order_id) DESC
LIMIT 1;
```
-------------------------6005 sample_num
```sql
SELECT 
    Subtract(strftime('%Y', oh.status_date), strftime('%Y', co.order_date)) AS "year", 
    Subtract(strftime('%m', oh.status_date), strftime('%m', co.order_date)) AS "month", 
    Subtract(strftime('%d', oh.status_date), strftime('%d', co.order_date)) AS "day"
FROM 
    cust_order co
JOIN 
    order_history oh ON co.order_id = oh.order_id
WHERE 
    co.order_id = 2398;
```
-------------------------6006 sample_num
```sql
SELECT c.first_name, c.last_name, COUNT(ca.address_id) AS address_count
FROM customer c
JOIN customer_address ca ON c.customer_id = ca.customer_id
GROUP BY c.customer_id
ORDER BY address_count DESC
LIMIT 1;
```
-------------------------6007 sample_num
```sql
SELECT 
    (SUM(CASE WHEN sm.method_name = 'International' THEN ol.price ELSE 0 END) / SUM(ol.price)) * 100 AS international_percentage
FROM 
    order_line ol
JOIN 
    cust_order co ON ol.order_id = co.order_id
JOIN 
    shipping_method sm ON co.shipping_method_id = sm.method_id;
```
-------------------------6008 sample_num
```sql
SELECT a.author_name
FROM author a
JOIN book_author ba ON a.author_id = ba.author_id
JOIN book b ON ba.book_id = b.book_id
GROUP BY a.author_id, a.author_name
HAVING SUM(b.num_pages) < (SELECT AVG(num_pages) FROM book);
```
-------------------------6009 sample_num
```sql
SELECT MIN(price) AS lowest_price
FROM order_line
WHERE price != 0;
```
-------------------------6010 sample_num
```sql
SELECT COUNT(DISTINCT c.customer_id) AS customer_count
FROM customer c
JOIN customer_address ca ON c.customer_id = ca.customer_id
JOIN address a ON ca.address_id = a.address_id
WHERE a.city = 'Villeneuve-la-Garenne';
```
-------------------------6011 sample_num
```sql
SELECT COUNT(*) FROM author WHERE author_name LIKE 'Adam';
```
-------------------------6012 sample_num
```sql
SELECT COUNT(*) AS yahoo_mail_customers
FROM customer
WHERE email LIKE '%@yahoo.com';
```
-------------------------6013 sample_num
```sql
SELECT a.city
FROM customer c
JOIN customer_address ca ON c.customer_id = ca.customer_id
JOIN address a ON ca.address_id = a.address_id
JOIN country co ON a.country_id = co.country_id
WHERE co.country_name = 'United States of America';
```
-------------------------6014 sample_num
```sql
SELECT COUNT(*) 
FROM cust_order co
JOIN customer c ON co.customer_id = c.customer_id
JOIN shipping_method sm ON co.shipping_method_id = sm.method_id
WHERE c.first_name = 'Marcelia' 
  AND c.last_name = 'Goering' 
  AND substr(co.order_date, 1, 4) = '2021' 
  AND sm.method_name = 'Priority';
```
-------------------------6015 sample_num
```sql
SELECT b.title, ol.price
FROM book b
JOIN order_line ol ON b.book_id = ol.book_id
WHERE ol.price = (SELECT MAX(price) FROM order_line);
```
-------------------------6016 sample_num
```sql
SELECT COUNT(DISTINCT co.customer_id) AS customer_count
FROM cust_order co
JOIN order_line ol ON co.order_id = ol.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE b.title = 'Anleitung zum Zickigsein';
```
-------------------------6017 sample_num
```sql
SELECT MAX(ol.price) AS most_expensive_price
FROM order_line ol
JOIN cust_order co ON ol.order_id = co.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE b.title = 'Bite Me If You Can (Argeneau #6)';
```
-------------------------6018 sample_num
```sql
SELECT COUNT(DISTINCT co.customer_id) AS customer_count
FROM cust_order co
JOIN order_line ol ON co.order_id = ol.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE b.publication_date = (SELECT MIN(publication_date) FROM book);
```
-------------------------6019 sample_num
```sql
SELECT b.title 
FROM book b 
JOIN book_language bl ON b.language_id = bl.language_id 
JOIN publisher p ON b.publisher_id = p.publisher_id 
WHERE bl.language_name = 'Spanish' AND p.publisher_name = 'Alfaguara';
```
-------------------------6020 sample_num
```sql
SELECT COUNT(DISTINCT co.customer_id) AS customer_count
FROM cust_order co
JOIN order_line ol ON co.order_id = ol.order_id
JOIN book b ON ol.book_id = b.book_id
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Stephen King' 
AND b.publication_date = (SELECT MIN(publication_date) FROM book WHERE book_id IN (SELECT book_id FROM book_author WHERE author_id = (SELECT author_id FROM author WHERE author_name = 'Stephen King')));
```
-------------------------6021 sample_num
```sql
SELECT bl.language_name
FROM book b
JOIN book_language bl ON b.language_id = bl.language_id
WHERE b.publication_date IN (
    SELECT MIN(publication_date) FROM book
    UNION
    SELECT MIN(publication_date) FROM book
    WHERE publication_date > (SELECT MIN(publication_date) FROM book)
)
```
-------------------------6022 sample_num
```sql
SELECT p.publisher_name 
FROM book b 
JOIN publisher p ON b.publisher_id = p.publisher_id 
WHERE b.title = 'The Secret Garden';
```
-------------------------6023 sample_num
```sql
SELECT COUNT(*) 
FROM book b
JOIN publisher p ON b.publisher_id = p.publisher_id
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE p.publisher_name = 'Scholastic' AND a.author_name = 'J.K Rowling';
```
-------------------------6024 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN book b ON p.publisher_id = b.publisher_id
GROUP BY p.publisher_id, p.publisher_name
HAVING COUNT(b.book_id) >= 30;
```
-------------------------6025 sample_num
```sql
SELECT DISTINCT street_name, SUBSTR(street_number, -1) AS last_number
FROM address;
```
-------------------------6026 sample_num
```sql
SELECT a.street_number, a.street_name, a.city, c.country_name
FROM address a
JOIN customer_address ca ON a.address_id = ca.address_id
JOIN customer c ON ca.customer_id = c.customer_id
JOIN country co ON a.country_id = co.country_id
WHERE a.city = 'Lazaro Cardenas';
```
-------------------------6027 sample_num
```sql
SELECT isbn13 FROM book WHERE num_pages > 135 AND num_pages < 140;
```
-------------------------6028 sample_num
```sql
SELECT title 
FROM book 
ORDER BY publication_date ASC 
LIMIT 6;
```
-------------------------6029 sample_num
```sql
SELECT COUNT(DISTINCT ol.book_id) AS total_books_ordered
FROM cust_order co
JOIN order_line ol ON co.order_id = ol.order_id
WHERE SUBSTR(co.order_date, 1, 7) = '2020-12';
```
-------------------------6030 sample_num
```sql
SELECT first_name, last_name 
FROM customer 
WHERE last_name LIKE 'K%';
```
-------------------------6031 sample_num
```sql
SELECT DISTINCT a.city
FROM customer c
JOIN customer_address ca ON c.customer_id = ca.customer_id
JOIN address a ON ca.address_id = a.address_id
JOIN country co ON a.country_id = co.country_id
WHERE co.country_name = 'Costa Rica';
```
-------------------------6032 sample_num
```sql
SELECT a.street_number, a.street_name, a.city
FROM customer_address ca
JOIN address_status as ON ca.status_id = as.status_id
JOIN address a ON ca.address_id = a.address_id
WHERE as.address_status = 'Inactive';
```
-------------------------6033 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN customer_address ca ON c.customer_id = ca.customer_id
JOIN address a ON ca.address_id = a.address_id
WHERE a.city = 'Baiyin';
```
-------------------------6034 sample_num
```sql
SELECT DISTINCT c.email
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN shipping_method sm ON co.shipping_method_id = sm.method_id
WHERE sm.method_name = 'Priority';
```
-------------------------6035 sample_num
```sql
SELECT co.order_date
FROM customer_address ca
JOIN address a ON ca.address_id = a.address_id
JOIN cust_order co ON ca.customer_id = co.customer_id
WHERE a.street_number = '460';
```
-------------------------6036 sample_num
```sql
SELECT o.order_id
FROM cust_order o
JOIN order_history oh ON o.order_id = oh.order_id
JOIN order_status os ON oh.status_id = os.status_id
WHERE os.status_value = 'cancelled';
```
-------------------------6037 sample_num
```sql
SELECT os.status_value
FROM cust_order co
JOIN order_history oh ON co.order_id = oh.order_id
JOIN order_status os ON oh.status_id = os.status_id
WHERE SUBSTR(co.order_date, 1, 10) = '2022-04-10';
```
-------------------------6038 sample_num
```sql
SELECT MAX(ol.price) AS highest_price
FROM order_line ol
JOIN cust_order co ON ol.order_id = co.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE b.title = 'The Prophet';
```
-------------------------6039 sample_num
```sql
SELECT DISTINCT co.order_date
FROM cust_order co
JOIN order_line ol ON co.order_id = ol.order_id
WHERE ol.price = 16.54;
```
-------------------------6040 sample_num
```sql
SELECT b.title 
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Peter H. Smith';
```
-------------------------6041 sample_num
```sql
SELECT COUNT(*) 
FROM book 
JOIN publisher ON book.publisher_id = publisher.publisher_id 
WHERE book.num_pages < 300 AND publisher.publisher_name = 'HarperCollins Publishers';
```
-------------------------6042 sample_num
```sql
SELECT COUNT(*) 
FROM book 
WHERE language_id = (SELECT language_id FROM book_language WHERE language_name = 'Japanese');
```
-------------------------6043 sample_num
```sql
SELECT AVG(b.num_pages) AS average_num_pages
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Jennifer Crusie';
```
-------------------------6044 sample_num
```sql
SELECT 
    (SUM(CASE WHEN sm.method_name = 'International' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    cust_order co
JOIN 
    customer c ON co.customer_id = c.customer_id
JOIN 
    shipping_method sm ON co.shipping_method_id = sm.method_id
WHERE 
    c.first_name = 'Kaleena';
```
-------------------------6045 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE b.title = 'The Sorrows of Young Werther';
```
-------------------------6046 sample_num
```sql
SELECT b.title
FROM book b
JOIN order_line ol ON b.book_id = ol.book_id
JOIN cust_order co ON ol.order_id = co.order_id
JOIN customer c ON co.customer_id = c.customer_id
WHERE c.first_name = 'Ursola' AND c.last_name = 'Purdy';
```
-------------------------6047 sample_num
```sql
SELECT a.author_name
FROM author a
JOIN book_author ba ON a.author_id = ba.author_id
JOIN book b ON ba.book_id = b.book_id
WHERE b.num_pages = (SELECT MAX(num_pages) FROM book);
```
-------------------------6048 sample_num
```sql
SELECT COUNT(b.book_id) AS available_books
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
JOIN publisher p ON b.publisher_id = p.publisher_id
WHERE a.author_name = 'Akira Watanabe' AND p.publisher_name = 'Gravity';
```
-------------------------6049 sample_num
```sql
SELECT a.street_number, a.street_name, a.city, c.country_name
FROM customer AS cu
JOIN customer_address AS ca ON cu.customer_id = ca.customer_id
JOIN address AS a ON ca.address_id = a.address_id
JOIN country AS c ON a.country_id = c.country_id
WHERE cu.first_name = 'Ursola' AND cu.last_name = 'Purdy';
```
-------------------------6050 sample_num
```sql
SELECT a.author_name 
FROM author a 
JOIN book_author ba ON a.author_id = ba.author_id 
JOIN book b ON ba.book_id = b.book_id 
WHERE b.title = 'The Mystery in the Rocky Mountains';
```
-------------------------6051 sample_num
```sql
SELECT p.publisher_name 
FROM book b 
JOIN publisher p ON b.publisher_id = p.publisher_id 
WHERE b.title = 'Girls\' Night In';
```
-------------------------6052 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN book b ON p.publisher_id = b.publisher_id
WHERE b.publication_date = (SELECT MIN(publication_date) FROM book);
```
-------------------------6053 sample_num
```sql
SELECT 
    (SUM(CASE WHEN method_name = 'Express' THEN cost ELSE 0 END) - 
     SUM(CASE WHEN method_name = 'Priority' THEN cost ELSE 0 END)) AS cost_difference
FROM 
    shipping_method
WHERE 
    method_name IN ('Express', 'Priority');
```
-------------------------6054 sample_num
```sql
SELECT COUNT(*) AS cancelled_orders
FROM order_history oh
JOIN order_status os ON oh.status_id = os.status_id
WHERE os.status_value = 'Cancelled' 
AND SUBSTR(oh.status_date, 1, 4) = '2022';
```
-------------------------6055 sample_num
```sql
SELECT b.title 
FROM book b 
JOIN publisher p ON b.publisher_id = p.publisher_id 
WHERE p.publisher_name = 'BBC Audiobooks';
```
-------------------------6056 sample_num
```sql
SELECT COUNT(*) AS total_books
FROM book
WHERE SUBSTR(publication_date, 1, 4) = '2017';
```
-------------------------6057 sample_num
```sql
SELECT isbn13 
FROM book 
WHERE title = 'The Mystery in the Rocky Mountains';
```
-------------------------6058 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN os.status_value = 'Returned' THEN 1 END) * 100.0 / COUNT(*)) AS return_percentage
FROM 
    order_history oh
JOIN 
    order_status os ON oh.status_id = os.status_id
WHERE 
    SUBSTR(oh.status_date, 1, 4) = '2022';
```
-------------------------6059 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN as.address_status = 'Inactive' THEN 1 END) * 100.0 / COUNT(*)) AS inactive_percentage
FROM 
    customer_address ca
JOIN 
    address a ON ca.address_id = a.address_id
JOIN 
    address_status as ON ca.status_id = as.status_id;
```
-------------------------6060 sample_num
```sql
SELECT num_pages FROM book WHERE title = 'Seaward';
```
-------------------------6061 sample_num
```sql
SELECT a.author_name 
FROM author a 
JOIN book_author ba ON a.author_id = ba.author_id 
JOIN book b ON ba.book_id = b.book_id 
WHERE b.title = 'First Things First';
```
-------------------------6062 sample_num
```sql
SELECT b.title 
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Tom Clancy';
```
-------------------------6063 sample_num
```sql
SELECT b.title 
FROM book b 
JOIN book_author ba ON b.book_id = ba.book_id 
JOIN author a ON ba.author_id = a.author_id 
WHERE a.author_name = 'Hirohiko Araki' AND b.publication_date = '2006-06-06';
```
-------------------------6064 sample_num
```sql
SELECT p.publisher_name 
FROM book b 
JOIN publisher p ON b.publisher_id = p.publisher_id 
WHERE b.title = "Hitchhiker's Guide To The Galaxy: The Filming of the Douglas Adams classic";
```
-------------------------6065 sample_num
```sql
SELECT b.title 
FROM book b 
JOIN publisher p ON b.publisher_id = p.publisher_id 
WHERE p.publisher_name = 'ADV Manga';
```
-------------------------6066 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN customer_address ca ON c.customer_id = ca.customer_id
JOIN address a ON ca.address_id = a.address_id
WHERE a.street_number = '55' AND a.street_name = 'Dorton Pass' AND a.city = 'Huangqiao';
```
-------------------------6067 sample_num
```sql
SELECT c.country_name
FROM address a
JOIN country c ON a.country_id = c.country_id
WHERE a.street_number = '9' AND a.street_name = 'Green Ridge Point' AND a.city = 'Arendal';
```
-------------------------6068 sample_num
```sql
SELECT street_number, street_name, city 
FROM address 
WHERE country_id = (SELECT country_id FROM country WHERE country_name = 'Poland') 
LIMIT 10;
```
-------------------------6069 sample_num
```sql
SELECT sm.method_name
FROM cust_order co
JOIN customer c ON co.customer_id = c.customer_id
JOIN shipping_method sm ON co.shipping_method_id = sm.method_id
WHERE c.first_name = 'Nicolette' AND c.last_name = 'Sadler' AND co.order_date = '2020-06-29 19:40:07';
```
-------------------------6070 sample_num
```sql
SELECT b.title 
FROM book b 
JOIN book_language bl ON b.language_id = bl.language_id 
WHERE bl.language_name = 'Arabic';
```
-------------------------6071 sample_num
```sql
SELECT bl.language_name 
FROM book b 
JOIN book_language bl ON b.language_id = bl.language_id 
WHERE b.title = 'El plan infinito';
```
-------------------------6072 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN a.author_name = 'Hirohiko Araki' THEN 1 END) * 100.0) / COUNT(b.book_id) AS percentage
FROM 
    book b
JOIN 
    publisher p ON b.publisher_id = p.publisher_id
JOIN 
    book_author ba ON b.book_id = ba.book_id
JOIN 
    author a ON ba.author_id = a.author_id
WHERE 
    p.publisher_name = 'Viz Media';
```
-------------------------6073 sample_num
```sql
SELECT AVG(b.num_pages) AS average_pages
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Zilpha Keatley Snyder';
```
-------------------------6074 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name 
FROM customer 
WHERE email = 'ckupis4@tamu.edu';
```
-------------------------6075 sample_num
```sql
SELECT title, num_pages 
FROM book 
ORDER BY num_pages DESC 
LIMIT 1;
```
-------------------------6076 sample_num
```sql
SELECT COUNT(b.book_id) AS number_of_books
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'A.J. Ayer';
```
-------------------------6077 sample_num
```sql
SELECT b.title 
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'A.J. Ayer';
```
-------------------------6078 sample_num
```sql
SELECT p.publisher_name 
FROM book b 
JOIN publisher p ON b.publisher_id = p.publisher_id 
WHERE b.title = 'The Season: A Candid Look at Broadway';
```
-------------------------6079 sample_num
```sql
SELECT 
    AVG(CASE WHEN bl.language_name = 'English' THEN 1 ELSE 0 END) AS average_english_books
FROM 
    book b
JOIN 
    book_language bl ON b.language_id = bl.language_id
JOIN 
    publisher p ON b.publisher_id = p.publisher_id
WHERE 
    p.publisher_name = 'Carole Marsh Mysteries';
```
-------------------------6080 sample_num
```sql
SELECT title 
FROM book 
WHERE publisher_id = (SELECT publisher_id FROM publisher WHERE publisher_name = 'Free Press') 
AND SUBSTR(publication_date, 1, 4) BETWEEN '1990' AND '2000' 
ORDER BY num_pages DESC 
LIMIT 1;
```
-------------------------6081 sample_num
```sql
SELECT ol.price
FROM book b
JOIN order_line ol ON b.book_id = ol.book_id
JOIN cust_order co ON ol.order_id = co.order_id
WHERE b.title = 'The Servant Leader' AND SUBSTR(b.publication_date, 1, 4) = '2003';
```
-------------------------6082 sample_num
```sql
SELECT a.street_number, a.street_name, a.city
FROM customer c
JOIN customer_address ca ON c.customer_id = ca.customer_id
JOIN address a ON ca.address_id = a.address_id
WHERE c.first_name = 'Kandy' AND ca.status_id = 1;
```
-------------------------6083 sample_num
```sql
SELECT COUNT(DISTINCT ol.book_id) AS total_books_ordered
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
WHERE c.first_name = 'Kandy' AND c.last_name = 'Adamec';
```
-------------------------6084 sample_num
```sql
SELECT COUNT(*) 
FROM order_history oh
JOIN order_status os ON oh.status_id = os.status_id
WHERE os.status_value = 'Returned' 
AND SUBSTR(oh.status_date, 1, 4) = '2022';
```
-------------------------6085 sample_num
```sql
SELECT c.country_id, co.country_name
FROM customer AS c
JOIN customer_address AS ca ON c.customer_id = ca.customer_id
JOIN address AS a ON ca.address_id = a.address_id
JOIN country AS co ON a.country_id = co.country_id
WHERE c.email = 'rturbitt2@geocities.jp';
```
-------------------------6086 sample_num
```sql
SELECT publisher_name
FROM publisher
JOIN book ON publisher.publisher_id = book.publisher_id
GROUP BY publisher_name
ORDER BY COUNT(book.book_id) DESC
LIMIT 1;
```
-------------------------6087 sample_num
```sql
SELECT b.title
FROM book b
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'A.J. Ayer'
ORDER BY b.publication_date ASC
LIMIT 1;
```
-------------------------6088 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN ol.price > 10 THEN ol.book_id END) * 100.0 / COUNT(ol.book_id)) AS percentage
FROM 
    cust_order co
JOIN 
    customer c ON co.customer_id = c.customer_id
JOIN 
    order_line ol ON co.order_id = ol.order_id
WHERE 
    c.first_name = 'Ruthanne' AND c.last_name = 'Vatini';
```
-------------------------6089 sample_num
```sql
SELECT title 
FROM book 
WHERE publisher_id = (SELECT publisher_id FROM publisher WHERE publisher_name = 'AK Press');
```
-------------------------6090 sample_num
```sql
SELECT c.first_name, c.last_name
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
WHERE ol.price = (SELECT MIN(price) FROM order_line);
```
-------------------------6091 sample_num
```sql
SELECT b.isbn13
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
JOIN book b ON ol.book_id = b.book_id
WHERE c.email = 'fsier3e@ihg.com';
```
-------------------------6092 sample_num
```sql
SELECT DISTINCT a.author_name
FROM author a
JOIN book_author ba ON a.author_id = ba.author_id
JOIN book b ON ba.book_id = b.book_id
JOIN order_line ol ON b.book_id = ol.book_id
WHERE ol.price >= 19;
```
-------------------------6093 sample_num
```sql
SELECT publisher.publisher_name 
FROM book 
JOIN publisher ON book.publisher_id = publisher.publisher_id 
WHERE book.isbn13 = '76092025986';
```
-------------------------6094 sample_num
```sql
SELECT COUNT(*) 
FROM book 
JOIN publisher ON book.publisher_id = publisher.publisher_id 
WHERE publisher.publisher_name = 'Birlinn' 
AND SUBSTR(book.publication_date, 1, 4) = '2008' 
AND book.num_pages BETWEEN 600 AND 700;
```
-------------------------6095 sample_num
```sql
SELECT ol.price 
FROM book b 
JOIN order_line ol ON b.book_id = ol.book_id 
WHERE b.isbn13 = '9780763628321';
```
-------------------------6096 sample_num
```sql
SELECT b.num_pages 
FROM cust_order co 
JOIN order_line ol ON co.order_id = ol.order_id 
JOIN book b ON ol.book_id = b.book_id 
WHERE co.order_id = 1167;
```
-------------------------6097 sample_num
```sql
SELECT b.title 
FROM book b 
JOIN book_language bl ON b.language_id = bl.language_id 
WHERE bl.language_name = 'British English';
```
-------------------------6098 sample_num
```sql
SELECT COUNT(*) 
FROM book 
WHERE publisher_id = (SELECT publisher_id FROM publisher WHERE publisher_name = 'Brava') 
AND SUBSTR(publication_date, 1, 4) = '2006';
```
-------------------------6099 sample_num
```sql
SELECT b.isbn13, ol.price 
FROM book b 
JOIN order_line ol ON b.book_id = ol.book_id 
WHERE b.book_id = 7160;
```
-------------------------6100 sample_num
```sql
SELECT b.title 
FROM book b 
JOIN order_line ol ON b.book_id = ol.book_id 
WHERE ol.order_id = 931;
```
-------------------------6101 sample_num
```sql
SELECT bl.language_name 
FROM book b 
JOIN book_language bl ON b.language_id = bl.language_id 
WHERE b.title = 'Zorro';
```
-------------------------6102 sample_num
```sql
SELECT DISTINCT c.email
FROM customer c
JOIN cust_order co ON c.customer_id = co.customer_id
JOIN order_line ol ON co.order_id = ol.order_id
WHERE ol.price BETWEEN 3 AND 5;
```
-------------------------6103 sample_num
```sql
SELECT b.isbn13 
FROM book b 
JOIN order_line ol ON b.book_id = ol.book_id 
WHERE ol.price = 7.5;
```
-------------------------6104 sample_num
```sql
SELECT p.publisher_name
FROM publisher p
JOIN book b ON p.publisher_id = b.publisher_id
JOIN book_author ba ON b.book_id = ba.book_id
JOIN author a ON ba.author_id = a.author_id
WHERE a.author_name = 'Alan Lee';
```
-------------------------6105 sample_num
```sql
SELECT SUM(b.num_pages) 
FROM book b
JOIN order_line ol ON b.book_id = ol.book_id
JOIN cust_order co ON ol.order_id = co.order_id
JOIN customer c ON co.customer_id = c.customer_id
WHERE c.first_name = 'Mick' AND c.last_name = 'Sever';
```
-------------------------6106 sample_num
```sql
SELECT a.author_name
FROM author a
JOIN book b ON a.author_id = b.book_id
WHERE b.publication_date = (SELECT MAX(publication_date) FROM book);
```
-------------------------6107 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN bl.language_name = 'English' THEN b.book_id END) * 100.0 / COUNT(b.book_id)) AS percentage_english_books
FROM 
    book b
JOIN 
    publisher p ON b.publisher_id = p.publisher_id
JOIN 
    book_language bl ON b.language_id = bl.language_id
WHERE 
    p.publisher_name = 'Ace Book';
```
-------------------------6108 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN b.num_pages < 500 THEN 1 END) - 
     COUNT(CASE WHEN b.num_pages > 500 THEN 1 END)) AS page_difference
FROM 
    book b
JOIN 
    order_line ol ON b.book_id = ol.book_id
WHERE 
    ol.price < 1;
```
-------------------------6109 sample_num
```sql
SELECT bl.language_name, b.title
FROM order_line ol
JOIN book b ON ol.book_id = b.book_id
JOIN book_language bl ON b.language_id = bl.language_id
WHERE ol.price < (SELECT AVG(price) * 0.2 FROM order_line);
```
-------------------------6110 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN employee s ON e.supervisor = s.employee_id
WHERE s.first_name = 'Darlisha' AND s.last_name = 'Jacobs' AND e.title = 'Sanitarian';
```
-------------------------6111 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
WHERE e.title = 'Sanitarian' AND i.inspection_date LIKE '2010-05%';
```
-------------------------6112 sample_num
```sql
SELECT COUNT(*) 
FROM inspection 
WHERE employee_id = (SELECT employee_id FROM employee WHERE first_name = 'Joshua' AND last_name = 'Rosa') 
AND inspection_date LIKE '2010%';
```
-------------------------6113 sample_num
```sql
SELECT e.aka_name 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
JOIN employee emp ON i.employee_id = emp.employee_id 
WHERE emp.first_name = 'Joshua' AND emp.last_name = 'Rosa';
```
-------------------------6114 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
WHERE i.inspection_date LIKE '2010%' 
AND e.facility_type IN ('Restaurant', 'Cafeteria';
```
-------------------------6115 sample_num
```sql
SELECT e.latitude, e.longitude
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE i.inspection_date = '2010-05-11';
```
-------------------------6116 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
WHERE i.inspection_date LIKE '2010%' AND e.ward = 42;
```
-------------------------6117 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
JOIN establishment est ON i.license_no = est.license_no
WHERE est.dba_name = 'Burbank' AND e.title = 'Sanitarian';
```
-------------------------6118 sample_num
```sql
SELECT establishment.aka_name 
FROM establishment 
JOIN inspection ON establishment.license_no = inspection.license_no 
WHERE inspection.results = 'Fail' 
AND inspection.inspection_date LIKE '2010%';
```
-------------------------6119 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
JOIN establishment est ON i.license_no = est.license_no
WHERE est.dba_name = 'AMUNDSEN HIGH SCHOOL' AND i.inspection_date = '2010-05-11';
```
-------------------------6120 sample_num
```sql
SELECT COUNT(*) 
FROM inspection 
WHERE employee_id = (SELECT employee_id FROM employee WHERE first_name = 'Joshua' AND last_name = 'Rosa') 
AND results = 'Pass';
```
-------------------------6121 sample_num
```sql
SELECT i2.inspection_date
FROM inspection i1
JOIN inspection i2 ON i1.inspection_id = i2.followup_to
JOIN establishment e ON i1.license_no = e.license_no
WHERE e.dba_name = 'Azha Restaurant Inc.' AND i1.inspection_date = '2010-01-21';
```
-------------------------6122 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) AS serious_issues_count
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE i.inspection_date LIKE '2010%' AND e.risk_level = 3;
```
-------------------------6123 sample_num
```sql
SELECT AVG(inspection_count) AS average_inspections
FROM (
    SELECT COUNT(i.inspection_id) AS inspection_count
    FROM inspection i
    JOIN employee e ON i.employee_id = e.employee_id
    WHERE i.inspection_date LIKE '2010%' AND e.salary > 70000
    GROUP BY e.employee_id
) AS inspection_counts;
```
-------------------------6124 sample_num
```sql
SELECT point_level 
FROM inspection_point 
WHERE Description = 'Refrigeration and metal stem thermometers provided and conspicuous';
```
-------------------------6125 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
WHERE i.inspection_id = '48224';
```
-------------------------6126 sample_num
```sql
SELECT COUNT(*) 
FROM inspection 
WHERE license_no IN (
    SELECT license_no 
    FROM establishment 
    WHERE dba_name = 'All Style Buffet' AND facility_type = 'Restaurant'
);
```
-------------------------6127 sample_num
```sql
SELECT MIN(i.inspection_date) AS first_inspection_date
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE e.aka_name = 'WING HUNG CHOP SUEY RESTAURANT';
```
-------------------------6128 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
WHERE e.facility_type = 'Restaurant' AND i.inspection_date = '2015-05-08';
```
-------------------------6129 sample_num
```sql
SELECT COUNT(*) 
FROM violation v
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE v.inspection_id = '1454071' AND ip.category = 'Food Maintenance';
```
-------------------------6130 sample_num
```sql
SELECT COUNT(v.point_id) AS number_of_violations
FROM inspection i
JOIN establishment e ON i.license_no = e.license_no
JOIN violation v ON i.inspection_id = v.inspection_id
WHERE e.dba_name = 'ROYAL THAI CUISINE' AND i.inspection_date = '2015-05-08';
```
-------------------------6131 sample_num
```sql
SELECT COUNT(*) 
FROM inspection 
WHERE license_no IN (
    SELECT license_no 
    FROM establishment 
    WHERE facility_type = 'Grocery Store' AND address = '3635 W DIVERSEY AVE'
);
```
-------------------------6132 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
GROUP BY e.employee_id
ORDER BY COUNT(i.inspection_id) DESC
LIMIT 1;
```
-------------------------6133 sample_num
```sql
SELECT COUNT(*) 
FROM inspection 
WHERE results = 'Out of Business' 
AND employee_id = (SELECT employee_id FROM employee WHERE first_name = 'Lisa' AND last_name = 'Tillman');
```
-------------------------6134 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) AS establishment_count
FROM employee emp
JOIN inspection ins ON emp.employee_id = ins.employee_id
WHERE emp.title = 'Sanitarian'
AND emp.address = '5000 N Wolcott Ave'
AND ins.inspection_date BETWEEN '2011-04-30' AND '2011-06-01';
```
-------------------------6135 sample_num
```sql
SELECT e.phone 
FROM employee e 
JOIN inspection i ON e.employee_id = i.employee_id 
WHERE i.inspection_id = '634597' AND e.title = 'Sanitarian';
```
-------------------------6136 sample_num
```sql
SELECT salary 
FROM employee 
WHERE employee_id = (
    SELECT employee_id 
    FROM inspection 
    GROUP BY employee_id 
    ORDER BY COUNT(employee_id) DESC 
    LIMIT 1
);
```
-------------------------6137 sample_num
```sql
SELECT AVG(inspection_count) AS average_inspections
FROM (
    SELECT COUNT(i.inspection_id) AS inspection_count
    FROM inspection i
    JOIN establishment e ON i.license_no = e.license_no
    WHERE e.risk_level = '3' AND e.facility_type = 'TAVERN'
    GROUP BY e.license_no
) AS inspection_counts;
```
-------------------------6138 sample_num
```sql
SELECT 
    (SUM(CASE WHEN results = 'Pass' THEN 1 ELSE 0 END) * 1.0 / COUNT(inspection_id)) AS pass_rate
FROM 
    inspection 
JOIN 
    establishment ON inspection.license_no = establishment.license_no
WHERE 
    establishment.dba_name = 'POCKETS' 
    AND establishment.facility_type = 'Restaurant';
```
-------------------------6139 sample_num
```sql
SELECT COUNT(*) 
FROM employee 
WHERE title = 'Sanitarian' AND city = 'Chicago' AND zip = '60617';
```
-------------------------6140 sample_num
```sql
SELECT aka_name FROM establishment WHERE address = '2903 W IRVING PARK RD';
```
-------------------------6141 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM employee
WHERE salary = (SELECT MIN(salary) FROM employee);
```
-------------------------6142 sample_num
```sql
SELECT COUNT(*) 
FROM establishment 
WHERE dba_name = 'HOMEMADE PIZZA' AND risk_level = 2;
```
-------------------------6143 sample_num
```sql
SELECT COUNT(*) 
FROM violation 
WHERE point_id = 3 AND fine = 500;
```
-------------------------6144 sample_num
```sql
SELECT COUNT(*) 
FROM employee 
WHERE supervisor = (SELECT employee_id FROM employee WHERE first_name = 'Gregory' AND last_name = 'Cardenas');
```
-------------------------6145 sample_num
```sql
SELECT MIN(i.inspection_date) AS first_inspection_date
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE e.dba_name = 'RENALDI''S PIZZA';
```
-------------------------6146 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
WHERE i.inspection_date LIKE '2016-03%'
GROUP BY e.employee_id
ORDER BY COUNT(i.inspection_id) DESC
LIMIT 1;
```
-------------------------6147 sample_num
```sql
SELECT establishment.dba_name
FROM establishment
JOIN inspection ON establishment.license_no = inspection.license_no
WHERE inspection.results = 'Pass w/ Conditions' 
AND inspection.inspection_date LIKE '2012-05%';
```
-------------------------6148 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) AS passed_businesses
FROM inspection i
JOIN employee e ON i.employee_id = e.employee_id
WHERE i.inspection_type = 'Short Form Complaint' 
  AND i.results = 'Pass' 
  AND e.first_name = 'David' 
  AND e.last_name = 'Hodges';
```
-------------------------6149 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) AS business_count
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE e.ward = 42 
  AND i.results = 'Fail' 
  AND i.inspection_date BETWEEN '2010-01-01' AND '2015-12-31'
GROUP BY e.license_no
HAVING COUNT(i.results) >= 5;
```
-------------------------6150 sample_num
```sql
SELECT salary 
FROM employee 
WHERE employee_id = (
    SELECT employee_id 
    FROM inspection 
    GROUP BY employee_id 
    ORDER BY COUNT(inspection_id) DESC 
    LIMIT 1
);
```
-------------------------6151 sample_num
```sql
SELECT e.aka_name
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
JOIN violation v ON i.inspection_id = v.inspection_id
WHERE i.inspection_date LIKE '2014%'
GROUP BY e.aka_name
ORDER BY SUM(v.fine) DESC
LIMIT 1;
```
-------------------------6152 sample_num
```sql
SELECT e.latitude, e.longitude
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE i.results = 'Fail'
GROUP BY e.license_no
ORDER BY COUNT(i.results) DESC
LIMIT 1;
```
-------------------------6153 sample_num
```sql
SELECT v.inspector_comment
FROM inspection i
JOIN establishment e ON i.license_no = e.license_no
JOIN violation v ON i.inspection_id = v.inspection_id
WHERE e.dba_name = 'TAQUERIA LA FIESTA' AND i.inspection_date = '2010-01-25';
```
-------------------------6154 sample_num
```sql
SELECT SUM(v.fine) AS total_fine
FROM violation v
JOIN inspection i ON v.inspection_id = i.inspection_id
JOIN establishment e ON i.license_no = e.license_no
WHERE e.dba_name = 'RON OF JAPAN INC' AND i.inspection_date LIKE '2014-02%';
```
-------------------------6155 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
JOIN establishment est ON i.license_no = est.license_no
WHERE est.dba_name = 'TAQUERIA LA PAZ';
```
-------------------------6156 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
JOIN violation v ON i.inspection_id = v.inspection_id
GROUP BY e.employee_id
ORDER BY SUM(v.fine) DESC
LIMIT 1;
```
-------------------------6157 sample_num
```sql
SELECT AVG(inspection_count) AS average_inspections, CONCAT(e.first_name, ' ', e.last_name) AS employee_name
FROM (
    SELECT e.employee_id, e.first_name, e.last_name, COUNT(i.inspection_id) AS inspection_count
    FROM employee e
    JOIN inspection i ON e.employee_id = i.employee_id
    WHERE e.title = 'Sanitarian'
    ORDER BY e.salary DESC
    LIMIT 5
) AS top_employees
GROUP BY employee_name;
```
-------------------------6158 sample_num
```sql
WITH inspection_counts AS (
    SELECT 
        e.dba_name,
        COUNT(i.inspection_id) AS total_inspections,
        SUM(CASE WHEN i.results = 'Pass' THEN 1 ELSE 0 END) AS passed_inspections,
        SUM(CASE WHEN i.results = 'Fail' THEN 1 ELSE 0 END) AS failed_inspections
    FROM 
        establishment e
    JOIN 
        inspection i ON e.license_no = i.license_no
    GROUP BY 
        e.dba_name
),
max_inspection AS (
    SELECT 
        dba_name,
        total_inspections,
        passed_inspections,
        failed_inspections
    FROM 
        inspection_counts
    WHERE 
        total_inspections = (SELECT MAX(total_inspections) FROM inspection_counts)
)
SELECT 
    dba_name,
    total_inspections,
    (passed_inspections * 100.0 / total_inspections) AS percentage_passed,
    (failed_inspections * 100.0 / total_inspections) AS percentage_failed
FROM 
    max_inspection;
```
-------------------------6159 sample_num
```sql
SELECT last_name 
FROM employee 
WHERE address = '7211 S Hermitage Ave' AND city = 'Chicago' AND state = 'IL';
```
-------------------------6160 sample_num
```sql
SELECT e.dba_name, emp.first_name, emp.last_name
FROM inspection i
JOIN establishment e ON i.license_no = e.license_no
JOIN employee emp ON i.employee_id = emp.employee_id
WHERE i.inspection_id = 44256 AND i.inspection_date = '2010-05-05';
```
-------------------------6161 sample_num
```sql
SELECT e.address
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE e.facility_type = 'School' 
  AND i.results = 'Pass' 
  AND i.inspection_date LIKE '2010-03%';
```
-------------------------6162 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
WHERE i.inspection_type = 'Canvass' AND i.inspection_date = '2010-03-09';
```
-------------------------6163 sample_num
```sql
SELECT inspection_id 
FROM inspection 
WHERE license_no IN (
    SELECT license_no 
    FROM establishment 
    WHERE dba_name = 'PIZZA RUSTICA, INC.'
);
```
-------------------------6164 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) AS restaurant_count
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE e.facility_type = 'Restaurant'
  AND e.risk_level = (SELECT MAX(risk_level) FROM establishment)
  AND i.results = 'Pass';
```
-------------------------6165 sample_num
```sql
SELECT DISTINCT e.first_name, e.last_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
JOIN violation v ON i.inspection_id = v.inspection_id
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE ip.category = 'Display of Inspection Report Summary';
```
-------------------------6166 sample_num
```sql
SELECT e.title 
FROM employee e 
JOIN inspection i ON e.employee_id = i.employee_id 
WHERE i.inspection_id = 60332;
```
-------------------------6167 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) AS failed_restaurants
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE e.facility_type = 'Restaurant'
  AND e.risk_level = (SELECT MIN(risk_level) FROM establishment WHERE facility_type = 'Restaurant')
  AND i.inspection_type = 'Complaint'
  AND i.results = 'Fail';
```
-------------------------6168 sample_num
```sql
SELECT v.fine, CONCAT(e.address, ', ', e.city, ', ', e.state) AS complete_address
FROM violation v
JOIN inspection i ON v.inspection_id = i.inspection_id
JOIN establishment e ON i.license_no = e.license_no
WHERE i.inspection_id = 48216;
```
-------------------------6169 sample_num
```sql
SELECT DISTINCT i.inspection_id
FROM inspection i
JOIN violation v ON i.inspection_id = v.inspection_id
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE ip.point_level = 'Critical' AND v.fine = 500 AND v.inspector_comment = 'CDI ON 5-17-10';
```
-------------------------6170 sample_num
```sql
SELECT ip.Description, v.inspector_comment
FROM inspection_point ip
JOIN violation v ON ip.point_id = v.point_id
WHERE v.inspection_id = 164795;
```
-------------------------6171 sample_num
```sql
SELECT v.inspector_comment, ip.code
FROM violation v
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE v.inspection_id = 54216 AND v.point_id = 34;
```
-------------------------6172 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN e.risk_level = (SELECT MAX(risk_level) FROM establishment) THEN e.license_no END) * 100.0 / COUNT(e.license_no)) AS percentage
FROM 
    establishment e
JOIN 
    inspection i ON e.license_no = i.license_no
WHERE 
    i.results = 'Fail';
```
-------------------------6173 sample_num
```sql
SELECT 
    ABS(
        (SELECT COUNT(DISTINCT e.employee_id) 
         FROM employee e 
         JOIN inspection i ON e.employee_id = i.employee_id 
         JOIN violation v ON i.inspection_id = v.inspection_id 
         WHERE e.salary BETWEEN 75000 AND 85000 AND v.fine = 100) - 
        (SELECT COUNT(DISTINCT e.employee_id) 
         FROM employee e 
         JOIN inspection i ON e.employee_id = i.employee_id 
         JOIN violation v ON i.inspection_id = v.inspection_id 
         WHERE e.salary BETWEEN 75000 AND 85000 AND v.fine = 500)
    ) AS difference;
```
-------------------------6174 sample_num
```sql
SELECT COUNT(*) 
FROM inspection 
WHERE inspection_date LIKE '2011-01%';
```
-------------------------6175 sample_num
```sql
SELECT COUNT(*) 
FROM inspection 
WHERE results = 'Fail' AND inspection_date LIKE '2014%';
```
-------------------------6176 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN v.fine = 100 THEN i.inspection_id END) * 100.0 / COUNT(i.inspection_id)) AS percentage_minor_fine
FROM 
    inspection i
LEFT JOIN 
    violation v ON i.inspection_id = v.inspection_id;
```
-------------------------6177 sample_num
```sql
SELECT ip.point_id, v.fine
FROM inspection i
JOIN violation v ON i.inspection_id = v.inspection_id
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE i.inspection_date = '2010-08-07';
```
-------------------------6178 sample_num
```sql
SELECT COUNT(*) 
FROM inspection_point 
WHERE category = 'Personnel';
```
-------------------------6179 sample_num
```sql
SELECT e.dba_name, i.results
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE e.city = 'BURNHAM';
```
-------------------------6180 sample_num
```sql
SELECT 
    SUM(CASE WHEN ip.category = 'Toxic Items' THEN 1 ELSE 0 END) AS toxic_items_inspections,
    SUM(CASE WHEN ip.category = 'No Smoking Regulations' THEN 1 ELSE 0 END) AS no_smoking_regulations_inspections
FROM 
    inspection i
JOIN 
    violation v ON i.inspection_id = v.inspection_id
JOIN 
    inspection_point ip ON v.point_id = ip.point_id;
```
-------------------------6181 sample_num
```sql
SELECT e.dba_name 
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
JOIN employee emp ON i.employee_id = emp.employee_id
WHERE emp.first_name = 'Sarah' AND emp.last_name = 'Lindsey' AND i.inspection_date = '2012-11-20';
```
-------------------------6182 sample_num
```sql
SELECT ip.category, v.fine
FROM inspection i
JOIN employee e ON i.employee_id = e.employee_id
JOIN violation v ON i.inspection_id = v.inspection_id
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE e.first_name = 'Lisa' AND e.last_name = 'Tillman' 
AND i.inspection_date LIKE '2014-01%';
```
-------------------------6183 sample_num
```sql
SELECT COUNT(DISTINCT i.inspection_id) AS total_inspections
FROM inspection i
JOIN violation v ON i.inspection_id = v.inspection_id
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE ip.category = 'Display of Inspection Report Summary';
```
-------------------------6184 sample_num
```sql
SELECT inspection_type, results 
FROM inspection 
JOIN establishment ON inspection.license_no = establishment.license_no 
WHERE establishment.dba_name = 'Riverwalk café';
```
-------------------------6185 sample_num
```sql
SELECT e.first_name, e.last_name, i.results
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
JOIN establishment est ON i.license_no = est.license_no
WHERE est.dba_name = 'JEAN SAMOCKI';
```
-------------------------6186 sample_num
```sql
SELECT SUM(v.fine) AS total_fine
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
JOIN violation v ON i.inspection_id = v.inspection_id
WHERE e.dba_name = 'HACIENDA LOS TORRES' 
  AND e.ward = 36 
  AND i.results = 'Fail';
```
-------------------------6187 sample_num
```sql
SELECT SUM(v.fine) AS total_fine
FROM violation v
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE ip.category = 'Food Equipment and Utensil';
```
-------------------------6188 sample_num
```sql
SELECT e.dba_name, e.latitude, e.longitude
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE i.inspection_date = '2013-07-29' AND i.results = 'Fail';
```
-------------------------6189 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN i.results LIKE 'Pass%' THEN 1 END) * 100.0 / COUNT(i.inspection_id)) AS percentage_verified_quality,
    COUNT(DISTINCT CASE WHEN e.city = 'CHICAGO' AND i.results LIKE 'Pass%' THEN e.license_no END) AS chicago_businesses
FROM 
    inspection i
JOIN 
    establishment e ON i.license_no = e.license_no;
```
-------------------------6190 sample_num
```sql
SELECT AVG(inspections_per_year) AS average_inspections_per_year
FROM (
    SELECT COUNT(inspection_id) / 8 AS inspections_per_year
    FROM inspection T1
    JOIN employee T2 ON T1.employee_id = T2.employee_id
    WHERE T2.first_name = 'Jessica' AND T2.last_name = 'Anthony'
    AND T1.inspection_date > '2010-01-01' AND T1.inspection_date < '2017-12-31'
) AS yearly_inspections;
```
-------------------------6191 sample_num
```sql
SELECT e.first_name 
FROM employee e 
JOIN inspection i ON e.employee_id = i.employee_id 
WHERE i.inspection_id = 48225;
```
-------------------------6192 sample_num
```sql
SELECT e.address 
FROM employee e 
JOIN inspection i ON e.employee_id = i.employee_id 
WHERE i.inspection_id = 52238;
```
-------------------------6193 sample_num
```sql
SELECT e.last_name 
FROM employee e 
JOIN inspection i ON e.employee_id = i.employee_id 
WHERE i.inspection_id = 52238;
```
-------------------------6194 sample_num
```sql
SELECT i.results 
FROM inspection i 
JOIN employee e ON i.employee_id = e.employee_id 
WHERE e.first_name = 'Thomas' AND e.last_name = 'Langley';
```
-------------------------6195 sample_num
```sql
SELECT e.address 
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
WHERE i.inspection_date = '2010-11-05';
```
-------------------------6196 sample_num
```sql
SELECT e.phone
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
WHERE i.inspection_type = 'Canvass';
```
-------------------------6197 sample_num
```sql
SELECT title 
FROM employee 
WHERE employee_id = (SELECT employee_id FROM inspection WHERE inspection_id = 52269);
```
-------------------------6198 sample_num
```sql
SELECT i.results 
FROM inspection i 
JOIN establishment e ON i.license_no = e.license_no 
WHERE e.dba_name = 'XANDO COFFEE & BAR / COSI SANDWICH BAR';
```
-------------------------6199 sample_num
```sql
SELECT inspection_type 
FROM inspection 
WHERE license_no IN (
    SELECT license_no 
    FROM establishment 
    WHERE dba_name = 'JOHN SCHALLER'
);
```
-------------------------6200 sample_num
```sql
SELECT e.dba_name 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
WHERE i.inspection_type = 'License';
```
-------------------------6201 sample_num
```sql
SELECT COUNT(*) 
FROM inspection i
JOIN establishment e ON i.license_no = e.license_no
WHERE i.inspection_date LIKE '2010%' AND e.risk_level = 3;
```
-------------------------6202 sample_num
```sql
SELECT DISTINCT e.dba_name 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
WHERE i.results IN ('Pass', 'Pass w/Conditions');
```
-------------------------6203 sample_num
```sql
SELECT SUM(e.salary) AS total_salary
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
WHERE i.inspection_id BETWEEN 52270 AND 52272;
```
-------------------------6204 sample_num
```sql
SELECT AVG(e.salary) AS average_salary
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
WHERE i.inspection_type = 'License Re-Inspection';
```
-------------------------6205 sample_num
```sql
SELECT e.zip, i.results 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
WHERE e.license_no = '1222441';
```
-------------------------6206 sample_num
```sql
SELECT MIN(i.inspection_date) AS first_inspection_date
FROM inspection i
JOIN establishment e ON i.license_no = e.license_no
WHERE e.dba_name = 'JOHN SCHALLER' AND i.inspection_date LIKE '2010%';
```
-------------------------6207 sample_num
```sql
SELECT CONCAT(e.first_name, ' ', e.last_name) AS full_name
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
WHERE i.license_no = '1334073';
```
-------------------------6208 sample_num
```sql
SELECT e.dba_name 
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
JOIN employee emp ON i.employee_id = emp.employee_id
WHERE emp.first_name = 'Joshua' AND emp.last_name = 'Rosa';
```
-------------------------6209 sample_num
```sql
SELECT COUNT(DISTINCT e.employee_id)
FROM employee e
JOIN inspection i ON e.employee_id = i.employee_id
WHERE e.salary > 70000 AND i.results = 'Fail';
```
-------------------------6210 sample_num
```sql
SELECT DISTINCT e.dba_name 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
WHERE i.results = 'Pass' AND i.inspection_date LIKE '2010%';
```
-------------------------6211 sample_num
```sql
SELECT e.dba_name 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
JOIN employee emp ON i.employee_id = emp.employee_id 
WHERE emp.first_name = 'Joshua' AND emp.last_name = 'Rosa';
```
-------------------------6212 sample_num
```sql
SELECT COUNT(*) 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
WHERE e.facility_type = 'Tavern' 
AND i.results = 'Fail' 
AND i.inspection_date LIKE '2010-07%';
```
-------------------------6213 sample_num
```sql
SELECT e.risk_level 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
JOIN employee emp ON i.employee_id = emp.employee_id 
WHERE emp.first_name = 'Bob' AND emp.last_name = 'Benson';
```
-------------------------6214 sample_num
```sql
SELECT e.dba_name, i.results
FROM inspection i
JOIN employee emp ON i.employee_id = emp.employee_id
JOIN establishment e ON i.license_no = e.license_no
WHERE emp.first_name = 'Bob' AND emp.last_name = 'Benson' AND i.inspection_date LIKE '2010%';
```
-------------------------6215 sample_num
```sql
SELECT e.title 
FROM employee e 
JOIN inspection i ON e.employee_id = i.employee_id 
WHERE i.license_no = '1576687';
```
-------------------------6216 sample_num
```sql
SELECT COUNT(*) 
FROM inspection_point 
WHERE point_level = 'Serious' AND fine = 0;
```
-------------------------6217 sample_num
```sql
SELECT (SUM(CASE WHEN v.fine = 250 THEN 1 ELSE 0 END) * 100.0 / COUNT(DISTINCT e.license_no)) AS percentage
FROM establishment e
LEFT JOIN inspection i ON e.license_no = i.license_no
LEFT JOIN violation v ON i.inspection_id = v.inspection_id;
```
-------------------------6218 sample_num
```sql
SELECT (COUNT(CASE WHEN e.risk_level = 1 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE i.results = 'Pass';
```
-------------------------6219 sample_num
```sql
SELECT address, city, state 
FROM employee 
WHERE first_name = 'Standard' AND last_name = 'Murray';
```
-------------------------6220 sample_num
```sql
SELECT facility_type 
FROM establishment 
WHERE dba_name = 'Kinetic Playground';
```
-------------------------6221 sample_num
```sql
SELECT salary FROM employee WHERE first_name = 'Jessica' AND last_name = 'Anthony';
```
-------------------------6222 sample_num
```sql
SELECT dba_name 
FROM establishment 
WHERE facility_type = 'Restaurant' 
AND latitude = 41.9532864854 
AND longitude = -87.7673790701422;
```
-------------------------6223 sample_num
```sql
SELECT COUNT(*) AS total_supervisors
FROM employee
WHERE title = 'Supervisor';
```
-------------------------6224 sample_num
```sql
SELECT address, city, state, zip 
FROM establishment 
WHERE dba_name = 'OLD TIMERS REST & LOUNGE' 
AND city = 'CHICAGO' 
AND facility_type = 'Restaurant';
```
-------------------------6225 sample_num
```sql
SELECT COUNT(*) 
FROM employee 
WHERE city = 'Hoffman Estates' AND state = 'IL';
```
-------------------------6226 sample_num
```sql
SELECT COUNT(*) 
FROM establishment 
WHERE risk_level = (SELECT MAX(risk_level) FROM establishment);
```
-------------------------6227 sample_num
```sql
SELECT first_name, last_name 
FROM employee 
WHERE salary = 82700;
```
-------------------------6228 sample_num
```sql
SELECT e.last_name 
FROM employee e 
JOIN inspection i ON e.employee_id = i.employee_id 
WHERE i.inspection_id = 52256;
```
-------------------------6229 sample_num
```sql
SELECT e.dba_name 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
JOIN violation v ON i.inspection_id = v.inspection_id 
WHERE e.facility_type = 'Tavern' AND v.fine = 100;
```
-------------------------6230 sample_num
```sql
SELECT ip.point_level
FROM inspection_point ip
JOIN violation v ON ip.point_id = v.point_id
WHERE v.fine = 0;
```
-------------------------6231 sample_num
```sql
SELECT e.facility_type, e.license_no
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE e.risk_level = (SELECT MIN(risk_level) FROM establishment)
AND i.results = 'Fail';
```
-------------------------6232 sample_num
```sql
SELECT i.results 
FROM inspection i
JOIN employee e ON i.employee_id = e.employee_id
WHERE i.inspection_date = '2010-02-24' AND e.first_name = 'Arnold' AND e.last_name = 'Holder';
```
-------------------------6233 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) AS failed_restaurants
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE e.facility_type = 'Restaurant' 
  AND i.results = 'Fail' 
  AND i.inspection_date LIKE '2010-04%';
```
-------------------------6234 sample_num
```sql
SELECT inspection_id 
FROM inspection 
WHERE employee_id IN (
    SELECT employee_id 
    FROM employee 
    WHERE first_name = 'Rosemary' AND last_name = 'Kennedy'
);
```
-------------------------6235 sample_num
```sql
SELECT i.inspection_type 
FROM inspection i 
JOIN employee e ON i.employee_id = e.employee_id 
WHERE i.inspection_date = '2010-07-07' 
AND e.first_name = 'Lisa' 
AND e.last_name = 'Tillman';
```
-------------------------6236 sample_num
```sql
SELECT i.inspection_id 
FROM inspection i
JOIN violation v ON i.inspection_id = v.inspection_id
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE v.inspector_comment = 'MUST CLEAN AND BETTER ORGANIZE HALLWAY AREA' 
AND ip.code IN ('7-38-030', '015', '010 (A)', '005 (A)');
```
-------------------------6237 sample_num
```sql
SELECT e.dba_name
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
WHERE e.risk_level = (SELECT MAX(risk_level) FROM establishment)
AND i.results = 'Fail';
```
-------------------------6238 sample_num
```sql
SELECT i.inspection_id 
FROM inspection i
JOIN employee e ON i.employee_id = e.employee_id
JOIN establishment est ON i.license_no = est.license_no
WHERE e.first_name = 'David' AND e.last_name = 'Hodges' 
AND est.dba_name = 'KAMAYAN EXPRESS';
```
-------------------------6239 sample_num
```sql
SELECT MIN(salary) AS min_salary, MAX(salary) AS max_salary
FROM employee
WHERE employee_id = (SELECT employee_id FROM inspection WHERE inspection_id = 58424);
```
-------------------------6240 sample_num
```sql
SELECT v.inspection_id
FROM violation v
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE v.inspector_comment = 'A certified food service manager must be present in all establishments at which potentially hazardous food is prepared or served. NO CERTIFIED FOOD MANAGER ON DUTY AT THIS TIME FOODS ARE COOKED AND SERVED SERIOUS CITATION ISSUED'
AND ip.category = 'Personnel';
```
-------------------------6241 sample_num
```sql
SELECT COUNT(DISTINCT e.license_no) AS grocery_stores_paid_250_fine
FROM establishment e
JOIN inspection i ON e.license_no = i.license_no
JOIN violation v ON i.inspection_id = v.inspection_id
WHERE e.facility_type = 'Grocery Store' AND v.fine = 250;
```
-------------------------6242 sample_num
```sql
SELECT ip.category 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
JOIN violation v ON i.inspection_id = v.inspection_id 
JOIN inspection_point ip ON v.point_id = ip.point_id 
WHERE e.dba_name = 'J & J FOOD';
```
-------------------------6243 sample_num
```sql
SELECT DISTINCT e.dba_name 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
WHERE e.facility_type = 'Tavern' 
AND i.results = 'Fail' 
AND i.inspection_date LIKE '2010-01%';
```
-------------------------6244 sample_num
```sql
SELECT COUNT(DISTINCT i.inspection_id) AS serious_inspections_no_fines
FROM inspection i
JOIN violation v ON i.inspection_id = v.inspection_id
JOIN inspection_point ip ON v.point_id = ip.point_id
WHERE ip.point_level = 'Serious' AND v.fine = 0;
```
-------------------------6245 sample_num
```sql
SELECT e.dba_name 
FROM establishment e 
JOIN inspection i ON e.license_no = i.license_no 
JOIN inspection_point ip ON i.inspection_id = ip.point_id 
WHERE ip.category = 'No Smoking Regulations';
```
-------------------------6246 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN results = 'Pass' THEN inspection_id END) - 
     COUNT(CASE WHEN results = 'Fail' THEN inspection_id END)) AS difference
FROM 
    inspection 
JOIN 
    establishment ON inspection.license_no = establishment.license_no
WHERE 
    inspection.inspection_type = 'Canvass' 
    AND establishment.facility_type = 'Restaurant';
```
-------------------------6247 sample_num
```sql
SELECT e.first_name, e.last_name
FROM employee e
WHERE e.salary > (SELECT AVG(salary) * 0.7 FROM employee)
AND e.employee_id IN (
    SELECT i.employee_id
    FROM inspection i
    WHERE i.results = 'Fail' 
    AND i.inspection_date LIKE '2010-02%'
);
```
-------------------------6248 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN e.facility_type = 'Restaurant' THEN 1 END) * 100.0 / COUNT(*)) AS restaurant_percentage
FROM 
    establishment e
JOIN 
    inspection i ON e.license_no = i.license_no
JOIN 
    violation v ON i.inspection_id = v.inspection_id
WHERE 
    v.fine = 500;
```
-------------------------6249 sample_num
```sql
SELECT c.name 
FROM coins c 
JOIN historical h ON c.id = h.coin_id 
WHERE YEAR(h.date) = 2018 
ORDER BY h.market_cap DESC 
LIMIT 1;
```
-------------------------6250 sample_num
```sql
SELECT SUM(volume_24h) AS total_value
FROM historical h
JOIN coins c ON h.coin_id = c.id
WHERE c.name = 'Argentum' AND h.date = '2016-10-11';
```
-------------------------6251 sample_num
```sql
SELECT AVG(price) AS average_price
FROM historical h
JOIN coins c ON h.coin_id = c.id
WHERE c.name = 'Zetacoin' AND h.date BETWEEN '2013-11-01' AND '2013-11-07';
```
-------------------------6252 sample_num
```sql
SELECT time_high, time_low 
FROM historical h 
JOIN coins c ON h.coin_id = c.id 
WHERE c.name = 'WRAP' 
AND MONTH(h.date) = 8 
AND YEAR(h.date) = 2016;
```
-------------------------6253 sample_num
```sql
SELECT date 
FROM historical 
WHERE coin_id = (SELECT id FROM coins WHERE name = 'DigixDAO') 
AND price = (SELECT MAX(price) FROM historical WHERE coin_id = (SELECT id FROM coins WHERE name = 'DigixDAO'));
```
-------------------------6254 sample_num
```sql
SELECT c.name, h.date, h.price
FROM historical h
JOIN coins c ON h.coin_id = c.id
ORDER BY h.percent_change_24h DESC
LIMIT 1;
```
-------------------------6255 sample_num
```sql
SELECT AVG(circulating_supply) AS average_monthly_circulating_supply
FROM historical h
JOIN coins c ON h.coin_id = c.id
WHERE c.name = 'Frozen' AND h.date BETWEEN '2014-01-01' AND '2014-12-31'
GROUP BY DATE_FORMAT(h.date, '%Y-%m');
```
-------------------------6256 sample_num
```sql
SELECT c.id, c.name, MAX(h.date) AS last_transaction_date
FROM coins c
LEFT JOIN historical h ON c.id = h.coin_id
WHERE c.status = 'inactive'
GROUP BY c.id, c.name;
```
-------------------------6257 sample_num
```sql
SELECT price 
FROM historical 
WHERE coin_id = (SELECT id FROM coins WHERE slug = 'bitcoin') 
AND YEAR(date) = 2016;
```
-------------------------6258 sample_num
```sql
SELECT date, price 
FROM historical 
WHERE coin_id = (SELECT id FROM coins WHERE slug = 'bitcoin') 
ORDER BY price ASC 
LIMIT 1;
```
-------------------------6259 sample_num
```sql
SELECT c.name, c.status
FROM coins c
JOIN historical h ON c.id = h.coin_id
GROUP BY c.id
HAVING AVG(h.price) > 1000;
```
-------------------------6260 sample_num
```sql
SELECT c.name, h.date
FROM historical h
JOIN coins c ON h.coin_id = c.id
ORDER BY h.percent_change_1h ASC
LIMIT 1;
```
-------------------------6261 sample_num
```sql
SELECT c.name
FROM coins c
JOIN historical h ON c.id = h.coin_id
WHERE c.category = 'token'
ORDER BY (h.high - h.low) DESC
LIMIT 1;
```
-------------------------6262 sample_num
```sql
SELECT c.name
FROM coins c
JOIN historical h ON c.id = h.coin_id
WHERE h.date = '2013-06-22' AND h.percent_change_24h > (
    SELECT AVG(percent_change_24h)
    FROM historical
    WHERE date = '2013-06-22'
);
```
-------------------------6263 sample_num
```sql
SELECT c.name 
FROM coins c 
JOIN historical h ON c.id = h.coin_id 
WHERE h.cmc_rank = 1 AND h.date = '2013-04-28';
```
-------------------------6264 sample_num
```sql
SELECT price 
FROM historical 
WHERE coin_id = (SELECT id FROM coins WHERE slug = 'bitcoin') 
AND date = '2013-04-28';
```
-------------------------6265 sample_num
```sql
SELECT c.name 
FROM coins c 
JOIN historical h ON c.id = h.coin_id 
WHERE h.date = '2013-05-03' AND h.open IS NULL;
```
-------------------------6266 sample_num
```sql
SELECT close 
FROM historical 
WHERE coin_id = (SELECT id FROM coins WHERE name = 'Bitcoin') 
AND date = '2013-04-29';
```
-------------------------6267 sample_num
```sql
SELECT time_high 
FROM historical 
WHERE coin_id = (SELECT id FROM coins WHERE slug = 'bitcoin') 
AND date = '2013-04-29' 
AND high = (SELECT MAX(high) FROM historical WHERE coin_id = (SELECT id FROM coins WHERE slug = 'bitcoin') AND date = '2013-04-29');
```
-------------------------6268 sample_num
```sql
SELECT MAX(high - low) AS max_profit
FROM historical
WHERE coin_id = (SELECT id FROM coins WHERE slug = 'bitcoin')
AND date = '2013-04-28';
```
-------------------------6269 sample_num
```sql
SELECT MAX(max_supply) - MAX(total_supply) AS bitcoins_burned
FROM historical
WHERE coin_id = (SELECT id FROM coins WHERE slug = 'bitcoin')
AND date <= '2013-04-28';
```
-------------------------6270 sample_num
```sql
SELECT c.name, h.volume_24h
FROM historical h
JOIN coins c ON h.coin_id = c.id
WHERE h.date = '2016-01-08'
ORDER BY h.volume_24h DESC
LIMIT 1;
```
-------------------------6271 sample_num
```sql
SELECT c.name 
FROM coins c 
JOIN historical h ON c.id = h.coin_id 
WHERE h.date = '2013-04-28' AND h.total_supply > 10000000;
```
-------------------------6272 sample_num
```sql
SELECT 
    CASE 
        WHEN h.percent_change_7d > 0 THEN 'increased' 
        WHEN h.percent_change_7d < 0 THEN 'decreased' 
        ELSE 'no change' 
    END AS price_trend
FROM 
    historical h
JOIN 
    coins c ON h.coin_id = c.id
WHERE 
    c.slug = 'bitcoin' AND h.date = '2013-05-05';
```
-------------------------6273 sample_num
```sql
SELECT c.name, h.circulating_supply
FROM historical h
JOIN coins c ON h.coin_id = c.id
WHERE h.date = '2013-04-28' AND c.name IN ('Bitcoin', 'Litecoin')
ORDER BY h.circulating_supply DESC
LIMIT 1;
```
-------------------------6274 sample_num
```sql
SELECT price FROM historical WHERE coin_id = (SELECT id FROM coins WHERE slug = 'bitcoin') AND date = '2013-04-28';
```
-------------------------6275 sample_num
```sql
SELECT AVG(price) AS average_price
FROM historical
WHERE coin_id = (SELECT id FROM coins WHERE name = 'Bitcoin')
AND YEAR(date) = 2013;
```
-------------------------6276 sample_num
```sql
SELECT 
    (SUM(max_supply) - SUM(total_supply)) / SUM(total_supply) * 100 AS percentage_burned
FROM 
    historical
WHERE 
    coin_id = (SELECT id FROM coins WHERE slug = 'bitcoin') 
    AND date < '2018-04-28';
```
-------------------------6277 sample_num
```sql
SELECT name FROM coins WHERE status = 'extinct';
```
-------------------------6278 sample_num
```sql
SELECT description FROM coins WHERE name = 'BitBar';
```
-------------------------6279 sample_num
```sql
SELECT name 
FROM coins 
WHERE YEAR(date_added) = 2013 AND MONTH(date_added) = 5;
```
-------------------------6280 sample_num
```sql
SELECT name, symbol FROM coins WHERE date_added LIKE '2013-06-14%';
```
-------------------------6281 sample_num
```sql
SELECT name 
FROM coins 
WHERE status = 'untracked' AND YEAR(date_added) = 2014;
```
-------------------------6282 sample_num
```sql
SELECT name 
FROM coins 
WHERE LENGTH(tag_names) - LENGTH(REPLACE(tag_names, ',', '')) = 2;
```
-------------------------6283 sample_num
```sql
SELECT c.name 
FROM coins c 
JOIN historical h ON c.id = h.coin_id 
ORDER BY h.price DESC 
LIMIT 1;
```
-------------------------6284 sample_num
```sql
SELECT c.name 
FROM coins c 
JOIN historical h ON c.id = h.coin_id 
WHERE h.cmc_rank = 1 AND h.date = '2013-04-29';
```
-------------------------6285 sample_num
```sql
SELECT date, low AS lowest_price
FROM historical
WHERE coin_id = (SELECT id FROM coins WHERE slug = 'bitcoin')
ORDER BY low ASC
LIMIT 1;
```
-------------------------6286 sample_num
```sql
SELECT c.name 
FROM coins c 
JOIN historical h ON c.id = h.coin_id 
ORDER BY h.volume_24h DESC 
LIMIT 1;
```
-------------------------6287 sample_num
```sql
SELECT DISTINCT c.name 
FROM coins c 
JOIN historical h ON c.id = h.coin_id 
WHERE h.open IS NULL AND YEAR(h.date) = 2013 AND MONTH(h.date) = 5;
```
-------------------------6288 sample_num
```sql
SELECT MAX(close) AS highest_closed_price
FROM historical
WHERE coin_id = (SELECT id FROM coins WHERE slug = 'chncoin');
```
-------------------------6289 sample_num
```sql
SELECT date 
FROM historical 
JOIN coins ON historical.coin_id = coins.id 
WHERE coins.name = 'Peercoin' AND historical.cmc_rank = 5;
```
-------------------------6290 sample_num
```sql
SELECT date, MAX(market_cap) AS max_market_cap
FROM historical
WHERE coin_id = (SELECT id FROM coins WHERE name = 'Devcoin')
GROUP BY date
ORDER BY max_market_cap DESC
LIMIT 1;
```
-------------------------6291 sample_num
```sql
SELECT c.name 
FROM coins c 
JOIN historical h ON c.id = h.coin_id 
WHERE h.date = '2014-01-01' AND h.cmc_rank <= 5;
```
-------------------------6292 sample_num
```sql
SELECT date FROM historical WHERE coin_id = (SELECT id FROM coins WHERE name = 'Lebowskis') AND open IS NULL;
```
-------------------------6293 sample_num
```sql
SELECT date, MAX(price) AS highest_price
FROM historical
WHERE coin_id = (SELECT id FROM coins WHERE name = 'Terracoin')
GROUP BY date
ORDER BY highest_price DESC
LIMIT 1;
```
-------------------------6294 sample_num
```sql
SELECT COUNT(*) 
FROM historical h 
JOIN coins c ON h.coin_id = c.id 
WHERE c.name = 'Bytecoin' 
AND YEAR(h.date) = 2013 
AND MONTH(h.date) = 6;
```
-------------------------6295 sample_num
```sql
SELECT c.name
FROM coins c
JOIN historical h ON c.id = h.coin_id
WHERE h.date = '2013-04-28' AND h.price > (
    SELECT AVG(price)
    FROM historical
    WHERE date = '2013-04-28'
);
```
-------------------------6296 sample_num
```sql
SELECT 
    COUNT(*) * 100.0 / (SELECT COUNT(*) FROM coins) AS percentage,
    GROUP_CONCAT(c.name) AS coin_names
FROM 
    historical h
JOIN 
    coins c ON h.coin_id = c.id
WHERE 
    h.date = '2013-05-29' AND h.percent_change_1h > 0;
```
-------------------------6297 sample_num
```sql
SELECT COUNT(*) 
FROM Employees 
WHERE TitleOfCourtesy = 'Dr.';
```
-------------------------6298 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
WHERE EmployeeID = (SELECT ReportsTo FROM Employees WHERE FirstName = 'Nancy' AND LastName = 'Davolio');
```
-------------------------6299 sample_num
```sql
SELECT HomePhone FROM Employees WHERE FirstName = 'Nancy' AND LastName = 'Davolio';
```
-------------------------6300 sample_num
```sql
SELECT COUNT(*) 
FROM Employees 
WHERE ReportsTo = (SELECT EmployeeID FROM Employees WHERE FirstName = 'Andrew' AND LastName = 'Fuller');
```
-------------------------6301 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
WHERE Salary = (SELECT MAX(Salary) FROM Employees);
```
-------------------------6302 sample_num
```sql
SELECT 
    (SELECT SUM(Salary) FROM Employees WHERE LastName = 'Fuller' AND FirstName = 'Andrew') - 
    (SELECT SUM(Salary) FROM Employees WHERE LastName = 'Davolio' AND FirstName = 'Nancy') AS SalaryDifference;
```
-------------------------6303 sample_num
```sql
SELECT COUNT(*) 
FROM Employees 
WHERE Title = 'Sales Representative' AND Country = 'UK';
```
-------------------------6304 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
WHERE EmployeeID IN (
    SELECT EmployeeID
    FROM Orders
    WHERE CustomerID IN (
        SELECT CustomerID
        FROM Customers
        WHERE City = 'Hollis'
    )
);
```
-------------------------6305 sample_num
```sql
SELECT COUNT(DISTINCT TerritoryID) 
FROM Territories 
WHERE EmployeeID = (SELECT EmployeeID FROM Employees WHERE FirstName = 'Nancy' AND LastName = 'Davolio');
```
-------------------------6306 sample_num
```sql
SELECT Territories.TerritoryDescription
FROM Territories
JOIN Employees ON Territories.EmployeeID = Employees.EmployeeID
WHERE Employees.FirstName = 'Nancy' AND Employees.LastName = 'Davolio';
```
-------------------------6307 sample_num
```sql
SELECT COUNT(DISTINCT Territories.TerritoryID) AS TotalTerritories
FROM Employees
JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID
JOIN Customers ON Orders.CustomerID = Customers.CustomerID
JOIN Territories ON Customers.CustomerID = Territories.CustomerID
WHERE Employees.City = 'London';
```
-------------------------6308 sample_num
```sql
SELECT t.TerritoryDescription
FROM Territories t
JOIN Employees e ON t.EmployeeID = e.EmployeeID
WHERE e.ReportsTo = (SELECT EmployeeID FROM Employees WHERE FirstName = 'Andrew' AND LastName = 'Fuller');
```
-------------------------6309 sample_num
```sql
SELECT COUNT(DISTINCT e.EmployeeID) 
FROM Employees e
JOIN Territories t ON e.EmployeeID = t.EmployeeID
WHERE e.Country = 'UK'
GROUP BY e.EmployeeID
HAVING COUNT(DISTINCT t.TerritoryID) > 4;
```
-------------------------6310 sample_num
```sql
SELECT COUNT(*) 
FROM Territories 
WHERE RegionDescription = 'Eastern';
```
-------------------------6311 sample_num
```sql
SELECT TerritoryDescription 
FROM Territories 
WHERE RegionDescription = 'Eastern';
```
-------------------------6312 sample_num
```sql
SELECT COUNT(*) 
FROM Employees 
WHERE EmployeeID IN (SELECT DISTINCT EmployeeID FROM Orders WHERE CustomerID IN (SELECT CustomerID FROM Customers WHERE RegionDescription = 'Eastern'));
```
-------------------------6313 sample_num
```sql
SELECT e.HomePhone
FROM Employees e
JOIN Territories t ON e.EmployeeID = t.EmployeeID
WHERE t.RegionDescription = 'Eastern';
```
-------------------------6314 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM Territories WHERE RegionDescription = 'Eastern') - 
    (SELECT COUNT(*) FROM Territories WHERE RegionDescription = 'Southern') AS TerritoryDifference;
```
-------------------------6315 sample_num
```sql
SELECT p.ProductName
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
WHERE od.OrderID = 10248;
```
-------------------------6316 sample_num
```sql
SELECT od.Quantity 
FROM OrderDetails od 
JOIN Products p ON od.ProductID = p.ProductID 
WHERE p.ProductName = 'Ikura' AND od.OrderID = 10273;
```
-------------------------6317 sample_num
```sql
SELECT SUM(P.Price * OD.Quantity) AS TotalPrice
FROM OrderDetails OD
JOIN Products P ON OD.ProductID = P.ProductID
JOIN Orders O ON OD.OrderID = O.OrderID
WHERE P.ProductName = 'Ikura' AND O.OrderID = 10273;
```
-------------------------6318 sample_num
```sql
SELECT SUM(p.UnitsInStock + p.UnitsOnOrder) AS TotalProduction
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
WHERE od.OrderID = 10248
ORDER BY od.Quantity DESC
LIMIT 1;
```
-------------------------6319 sample_num
```sql
SELECT P.ProductName, MAX(P.ReorderLevel) AS HighestSatisfaction
FROM Products P
JOIN OrderDetails OD ON P.ProductID = OD.ProductID
WHERE OD.OrderID = 10248
GROUP BY P.ProductName
ORDER BY HighestSatisfaction DESC
LIMIT 1;
```
-------------------------6320 sample_num
```sql
SELECT COUNT(*) AS OrderCount
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.ProductName = 'Tofu';
```
-------------------------6321 sample_num
```sql
SELECT DISTINCT o.OrderID
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.Discontinued = 1;
```
-------------------------6322 sample_num
```sql
SELECT COUNT(DISTINCT o.OrderID) AS OrderCount
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.ProductName = 'Ikura' AND od.UnitPrice < p.Price;
```
-------------------------6323 sample_num
```sql
SELECT Suppliers.SupplierName 
FROM Products 
JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID 
WHERE Products.ProductName = 'Aniseed Syrup';
```
-------------------------6324 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.Country = 'Japan';
```
-------------------------6325 sample_num
```sql
SELECT DISTINCT s.Phone
FROM Suppliers s
JOIN Products p ON s.SupplierID = p.SupplierID
WHERE p.UnitsInStock < p.UnitsOnOrder;
```
-------------------------6326 sample_num
```sql
SELECT COUNT(*) 
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE p.Discontinued = 1 AND s.Country = 'USA';
```
-------------------------6327 sample_num
```sql
SELECT s.SupplierName
FROM Suppliers s
JOIN Products p ON s.SupplierID = p.SupplierID
WHERE p.Unit = (SELECT MAX(Unit) FROM Products);
```
-------------------------6328 sample_num
```sql
SELECT AVG(Salary) AS AverageSalary
FROM Employees
WHERE EmployeeID IN (
    SELECT EmployeeID
    FROM Territories
    GROUP BY EmployeeID
    HAVING COUNT(TerritoryID) > 4
);
```
-------------------------6329 sample_num
```sql
SELECT 
    ( (p.Price - od.UnitPrice) / p.Price ) * 100 AS PercentageLower
FROM 
    Products p
JOIN 
    OrderDetails od ON p.ProductID = od.ProductID
JOIN 
    Orders o ON od.OrderID = o.OrderID
WHERE 
    p.ProductName = 'Ikura' AND o.OrderID = 10273;
```
-------------------------6330 sample_num
```sql
SELECT AVG(od.Quantity) AS AverageQuantity
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.ProductName = 'Ikura';
```
-------------------------6331 sample_num
```sql
SELECT TOP 1 P.ProductID, P.ProductName, 
       MAX(CAST(OD.Quantity AS FLOAT) / P.UnitsInStock) AS Ratio
FROM OrderDetails OD
JOIN Products P ON OD.ProductID = P.ProductID
JOIN Orders O ON OD.OrderID = O.OrderID
WHERE O.OrderID = 10248
GROUP BY P.ProductID, P.ProductName
ORDER BY Ratio DESC;
```
-------------------------6332 sample_num
```sql
SELECT FirstName, LastName 
FROM Employees 
ORDER BY BirthDate DESC 
LIMIT 1;
```
-------------------------6333 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
ORDER BY BirthDate DESC
LIMIT 1;
```
-------------------------6334 sample_num
```sql
SELECT COUNT(*) AS NumberOfOrders
FROM Orders
WHERE EmployeeID = (SELECT EmployeeID FROM Employees WHERE FirstName = 'Michael' AND LastName = 'Suyama');
```
-------------------------6335 sample_num
```sql
SELECT TerritoryDescription 
FROM Employees 
WHERE TitleOfCourtesy = 'Mr' AND LastName = 'King' AND FirstName = 'Robert';
```
-------------------------6336 sample_num
```sql
SELECT t.TerritoryDescription
FROM Employees e
JOIN Employees s ON e.ReportsTo = s.EmployeeID
JOIN Territories t ON s.TerritoryID = t.TerritoryID
WHERE e.FirstName = 'Laura' AND e.LastName = 'Callahan' AND e.TitleOfCourtesy = 'Ms';
```
-------------------------6337 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
WHERE EmployeeID IN (
    SELECT EmployeeID
    FROM Territories
    WHERE TerritoryDescription = 'Santa Monica'
);
```
-------------------------6338 sample_num
```sql
SELECT e.HomePhone 
FROM Employees e 
JOIN Territories t ON e.EmployeeID = t.EmployeeID 
WHERE t.TerritoryDescription = 'Savannah';
```
-------------------------6339 sample_num
```sql
SELECT SUM(od.Quantity) AS TotalQuantity
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
WHERE o.CustomerID = 'HILAA' AND o.OrderDate = '1997-12-25';
```
-------------------------6340 sample_num
```sql
SELECT COUNT(DISTINCT od.ProductID) AS ProductCount
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
WHERE o.OrderID = (
    SELECT OrderID
    FROM Orders
    ORDER BY Freight DESC
    LIMIT 1
);
```
-------------------------6341 sample_num
```sql
SELECT S.ShipperName 
FROM Orders O 
JOIN Shippers S ON O.ShipperID = S.ShipperID 
WHERE O.OrderID = 10585;
```
-------------------------6342 sample_num
```sql
SELECT COUNT(*) AS NumberOfOrders
FROM Orders o
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.ShipperName = 'Federal Shipping';
```
-------------------------6343 sample_num
```sql
SELECT COUNT(DISTINCT ProductID) 
FROM Products 
WHERE CategoryID = (SELECT CategoryID FROM Categories WHERE CategoryName = 'dairy products');
```
-------------------------6344 sample_num
```sql
SELECT c.CategoryName 
FROM Products p 
JOIN Categories c ON p.CategoryID = c.CategoryID 
WHERE p.ProductName = 'Tofu';
```
-------------------------6345 sample_num
```sql
SELECT SUM(p.Unit) AS TotalProduction
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.SupplierName = 'Escargots Nouveaux';
```
-------------------------6346 sample_num
```sql
SELECT p.ProductName, p.ReorderLevel
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.SupplierName = 'Nord-Ost-Fisch Handelsgesellschaft mbH';
```
-------------------------6347 sample_num
```sql
SELECT COUNT(DISTINCT p.ProductID) AS ProductCount
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.SupplierName = 'Karkki Oy';
```
-------------------------6348 sample_num
```sql
SELECT s.ContactName 
FROM Products p 
JOIN Suppliers s ON p.SupplierID = s.SupplierID 
WHERE p.ProductName = 'Gudbrandsdalsost';
```
-------------------------6349 sample_num
```sql
SELECT s.Country 
FROM Suppliers s 
JOIN Products p ON s.SupplierID = p.SupplierID 
WHERE p.ProductName = 'Scottish Longbreads';
```
-------------------------6350 sample_num
```sql
SELECT COUNT(*) AS NumberOfTerritories
FROM Territories
WHERE RegionDescription = 'Northern';
```
-------------------------6351 sample_num
```sql
SELECT RegionID FROM Territories WHERE TerritoryDescription = 'Columbia';
```
-------------------------6352 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN s.ShipperName = 'United Package' THEN 1 END) * 100.0 / COUNT(o.ShipperID)) AS PercentageFulfilled
FROM 
    Orders o
JOIN 
    Customers c ON o.CustomerID = c.CustomerID
JOIN 
    Shippers s ON o.ShipperID = s.ShipperID
WHERE 
    c.CustomerID = 'WHITC';
```
-------------------------6353 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN S.ShipperName = 'United Package' THEN O.OrderID END) - 
     COUNT(CASE WHEN S.ShipperName = 'Speedy Express' THEN O.OrderID END)) * 100.0 / 
     NULLIF(COUNT(CASE WHEN S.ShipperName = 'Speedy Express' THEN O.OrderID END), 0) AS PercentMoreOrders
FROM 
    Orders O
JOIN 
    Shippers S ON O.ShipperID = S.ShipperID;
```
-------------------------6354 sample_num
```sql
SELECT 
    (SELECT COUNT(TerritoryDescription) FROM Territories WHERE RegionDescription = 'Eastern') / 
    (SELECT COUNT(TerritoryDescription) FROM Territories WHERE RegionDescription = 'Southern') AS Times;
```
-------------------------6355 sample_num
```sql
SELECT COUNT(*) AS CustomerCount
FROM Customers
WHERE Country = (
    SELECT Country
    FROM Customers
    GROUP BY Country
    ORDER BY COUNT(CustomerID) DESC
    LIMIT 1
);
```
-------------------------6356 sample_num
```sql
SELECT OrderID FROM Orders WHERE Freight > 800;
```
-------------------------6357 sample_num
```sql
SELECT Address, City, Region, Country, PostalCode 
FROM Customers 
WHERE CustomerName = 'Island Trading';
```
-------------------------6358 sample_num
```sql
SELECT ProductName, Price 
FROM Products 
WHERE Price = (SELECT MAX(Price) FROM Products);
```
-------------------------6359 sample_num
```sql
SELECT COUNT(*) FROM Suppliers WHERE Country = 'USA';
```
-------------------------6360 sample_num
```sql
SELECT ProductName 
FROM Products 
WHERE ReorderLevel = (SELECT MAX(ReorderLevel) FROM Products);
```
-------------------------6361 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
WHERE Salary = (SELECT MAX(Salary) FROM Employees);
```
-------------------------6362 sample_num
```sql
SELECT ProductName FROM Products WHERE Discontinued = 1;
```
-------------------------6363 sample_num
```sql
SELECT AVG(Salary) AS AverageSalary
FROM Employees
WHERE Title = 'Sales Representative' AND Country = 'UK';
```
-------------------------6364 sample_num
```sql
SELECT S.ShipperName
FROM Orders O
JOIN Shippers S ON O.ShipperID = S.ShipperID
WHERE O.ShipCountry = 'USA'
GROUP BY S.ShipperName
ORDER BY COUNT(O.ShipperID) DESC
LIMIT 1;
```
-------------------------6365 sample_num
```sql
SELECT COUNT(*) 
FROM Products 
WHERE SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'Pavlova, Ltd.');
```
-------------------------6366 sample_num
```sql
SELECT COUNT(*) 
FROM Orders o
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE o.CustomerID = 'GREAL' AND s.ShipperName = 'United Package';
```
-------------------------6367 sample_num
```sql
SELECT s.SupplierName
FROM Suppliers s
JOIN Products p ON s.SupplierID = p.SupplierID
WHERE p.ReorderLevel = (SELECT MAX(ReorderLevel) FROM Products);
```
-------------------------6368 sample_num
```sql
SELECT COUNT(*) AS TotalOrders
FROM Orders o
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.ShipperName = 'United Package';
```
-------------------------6369 sample_num
```sql
SELECT COUNT(DISTINCT s.SupplierID) 
FROM Suppliers s 
JOIN Products p ON s.SupplierID = p.SupplierID 
WHERE s.Country = 'Australia' AND p.Discontinued = 1;
```
-------------------------6370 sample_num
```sql
SELECT SUM((p.Price * od.Quantity) + o.Freight) AS TotalPurchasePrice
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.ProductID IN (
    SELECT ProductID
    FROM Products
    ORDER BY Price DESC
    LIMIT 2
);
```
-------------------------6371 sample_num
```sql
SELECT SupplierName 
FROM Suppliers 
WHERE SupplierID = (
    SELECT SupplierID 
    FROM Products 
    GROUP BY SupplierID 
    ORDER BY COUNT(ProductID) DESC 
    LIMIT 1
);
```
-------------------------6372 sample_num
```sql
SELECT DISTINCT p.ProductName
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
WHERE p.Price < 5;
```
-------------------------6373 sample_num
```sql
SELECT e.FirstName, e.LastName
FROM Employees e
JOIN Territories t ON e.EmployeeID = t.EmployeeID
GROUP BY e.EmployeeID
ORDER BY COUNT(t.TerritoryID) DESC
LIMIT 1;
```
-------------------------6374 sample_num
```sql
SELECT ProductID, COUNT(ProductID) AS OrderCount
FROM OrderDetails
GROUP BY ProductID
ORDER BY OrderCount DESC
LIMIT 1;
```
-------------------------6375 sample_num
```sql
SELECT Territories.Description
FROM Employees
JOIN Territories ON Employees.EmployeeID = Territories.EmployeeID
WHERE Employees.TitleOfCourtesy = 'Dr.';
```
-------------------------6376 sample_num
```sql
SELECT TerritoryDescription 
FROM Territories 
WHERE RegionDescription = 'Eastern';
```
-------------------------6377 sample_num
```sql
SELECT AVG(TerritoryCount) AS AverageTerritories
FROM (
    SELECT COUNT(TerritoryID) AS TerritoryCount
    FROM Employees
    WHERE Title = 'Sales Representative'
    GROUP BY EmployeeID
) AS TerritoryCounts;
```
-------------------------6378 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE c.CategoryName = 'Beverages'
ORDER BY p.ReorderLevel DESC
LIMIT 1;
```
-------------------------6379 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.LastName) AS FullName
FROM Employees e
JOIN Orders o ON e.EmployeeID = o.EmployeeID
GROUP BY e.EmployeeID
ORDER BY COUNT(o.OrderID) DESC
LIMIT 1;
```
-------------------------6380 sample_num
```sql
SELECT COUNT(od.ProductID) AS ProductCount
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
WHERE o.OrderID = (
    SELECT o2.OrderID
    FROM Orders o2
    ORDER BY o2.Freight DESC
    LIMIT 1
);
```
-------------------------6381 sample_num
```sql
SELECT ProductID
FROM Products
WHERE CategoryID = (SELECT CategoryID FROM Categories WHERE CategoryName = 'Seafood')
ORDER BY (UnitsInStock + UnitsOnOrder) DESC
LIMIT 1;
```
-------------------------6382 sample_num
```sql
SELECT 
    (e1.Salary - e2.Salary) AS SalaryDifference
FROM 
    Employees e1
JOIN 
    (SELECT EmployeeID, COUNT(DISTINCT TerritoryID) AS TerritoryCount
     FROM Territories
     GROUP BY EmployeeID
     ORDER BY TerritoryCount DESC
     LIMIT 2) t1 ON e1.EmployeeID = t1.EmployeeID
JOIN 
    (SELECT EmployeeID, COUNT(DISTINCT TerritoryID) AS TerritoryCount
     FROM Territories
     GROUP BY EmployeeID
     ORDER BY TerritoryCount DESC
     LIMIT 2 OFFSET 1) t2 ON e2.EmployeeID = t2.EmployeeID;
```
-------------------------6383 sample_num
```sql
SELECT AVG(Price) AS AveragePrice
FROM Products
WHERE UnitsInStock > 50;
```
-------------------------6384 sample_num
```sql
SELECT CustomerName 
FROM Customers 
WHERE City = (
    SELECT City 
    FROM Customers 
    GROUP BY City 
    ORDER BY COUNT(*) DESC 
    LIMIT 1
);
```
-------------------------6385 sample_num
```sql
SELECT CustomerName, ContactName, 'N/A' AS ContactTitle
FROM Customers
WHERE City = 'Madrid';
```
-------------------------6386 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName, HomePhone
FROM Employees
ORDER BY BirthDate DESC;
```
-------------------------6387 sample_num
```sql
SELECT AVG(Price) AS AveragePrice
FROM Products
WHERE ProductID IN (
    SELECT ProductID
    FROM OrderDetails
    JOIN Orders ON OrderDetails.OrderID = Orders.OrderID
    JOIN Customers ON Orders.CustomerID = Customers.CustomerID
    WHERE Customers.Country = 'UK'
);
```
-------------------------6388 sample_num
```sql
SELECT od.ProductID, SUM(od.Quantity * p.Price) AS TotalAmount
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
GROUP BY od.ProductID
ORDER BY TotalAmount DESC
LIMIT 1;
```
-------------------------6389 sample_num
```sql
SELECT DISTINCT Suppliers.SupplierName, Suppliers.Address, Suppliers.Phone
FROM Suppliers
JOIN Products ON Suppliers.SupplierID = Products.SupplierID
WHERE Products.Price > 30;
```
-------------------------6390 sample_num
```sql
SELECT c.CustomerName, c.Address
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
WHERE o.Freight > (SELECT AVG(Freight) FROM Orders)
GROUP BY c.CustomerName, c.Address;
```
-------------------------6391 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
WHERE EmployeeID IN (
    SELECT EmployeeID
    FROM Territories
    WHERE TerritoryDescription = 'Wilton'
);
```
-------------------------6392 sample_num
```sql
SELECT SupplierName 
FROM Suppliers 
WHERE Country <> 'USA' AND Discontinued = 1;
```
-------------------------6393 sample_num
```sql
SELECT TOP 5 p.ProductName, (p.Price + o.Freight) AS TotalCost
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
WHERE o.OrderDate >= '1998-01-01 00:00:00' AND o.OrderDate < '1999-01-01 00:00:00'
ORDER BY TotalCost DESC;
```
-------------------------6394 sample_num
```sql
SELECT COUNT(DISTINCT c.CustomerID) AS NumberOfCustomers
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE c.Country = 'Canada' AND s.ShipperName = 'Federal Shipping';
```
-------------------------6395 sample_num
```sql
SELECT P.ProductName, COUNT(OD.OrderID) AS OrderCount
FROM Products P
JOIN OrderDetails OD ON P.ProductID = OD.ProductID
JOIN Orders O ON OD.OrderID = O.OrderID
GROUP BY P.ProductName
ORDER BY OrderCount DESC
LIMIT 10;
```
-------------------------6396 sample_num
```sql
SELECT SupplierID, COUNT(ProductID) AS ProductCount
FROM Products
GROUP BY SupplierID
ORDER BY ProductCount DESC
LIMIT 1;
```
-------------------------6397 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName, RegionDescription
FROM Employees
ORDER BY FullName;
```
-------------------------6398 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.LastName) AS FullName, e.Title, e.Address
FROM Employees e
JOIN Orders o ON e.EmployeeID = o.EmployeeID
WHERE o.OrderDate >= '1996-01-01 00:00:00' AND o.OrderDate < '1997-01-01 00:00:00'
GROUP BY e.EmployeeID
ORDER BY COUNT(o.OrderID) DESC
LIMIT 1;
```
-------------------------6399 sample_num
```sql
SELECT AVG(p.Price) AS AverageUnitPrice
FROM Orders o
JOIN Shippers s ON o.ShipperID = s.ShipperID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE s.ShipperName = 'United Package' 
AND o.OrderDate >= '1997-01-01 00:00:00' 
AND o.OrderDate < '1998-01-01 00:00:00';
```
-------------------------6400 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN ShipperName = 'Speedy Express' THEN 1 END) * 100.0 / COUNT(*)) AS PercentageSpeedyExpress
FROM 
    Orders
JOIN 
    Shippers ON Orders.ShipperID = Shippers.ShipperID;
```
-------------------------6401 sample_num
```sql
SELECT TitleOfCourtesy 
FROM Employees 
ORDER BY Salary ASC 
LIMIT 3;
```
-------------------------6402 sample_num
```sql
SELECT LastName 
FROM Employees 
WHERE EmployeeID IN (
    SELECT EmployeeID 
    FROM Employees 
    WHERE SupervisorID = (SELECT EmployeeID FROM Employees WHERE Title = 'Vice President, Sales')
);
```
-------------------------6403 sample_num
```sql
SELECT MAX(TotalPrice) AS HighestTotalPrice
FROM (
    SELECT O.OrderID, SUM(P.Price * OD.Quantity * (1 - OD.Discount)) AS TotalPrice
    FROM Orders O
    JOIN OrderDetails OD ON O.OrderID = OD.OrderID
    JOIN Products P ON OD.ProductID = P.ProductID
    GROUP BY O.OrderID
) AS OrderTotals;
```
-------------------------6404 sample_num
```sql
SELECT ProductID, ProductName, (UnitsInStock + UnitsOnOrder) AS TotalQuantity
FROM Products
ORDER BY TotalQuantity DESC
LIMIT 3;
```
-------------------------6405 sample_num
```sql
SELECT ProductID
FROM Products
WHERE UnitPrice IN (
    SELECT DISTINCT UnitPrice
    FROM Products
    ORDER BY UnitPrice DESC
    LIMIT 10
)
ORDER BY ReorderLevel ASC
LIMIT 1;
```
-------------------------6406 sample_num
```sql
SELECT COUNT(*) 
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE p.Discontinued = 0 AND c.CategoryName = 'Dairy Products';
```
-------------------------6407 sample_num
```sql
SELECT TerritoryDescription 
FROM Employees 
JOIN Territories ON Employees.EmployeeID = Territories.EmployeeID 
WHERE Employees.Title = 'Inside Sales Coordinator';
```
-------------------------6408 sample_num
```sql
SELECT DISTINCT Shippers.ShipperName
FROM Orders
JOIN Shippers ON Orders.ShipperID = Shippers.ShipperID
JOIN OrderDetails ON Orders.OrderID = OrderDetails.OrderID
JOIN Products ON OrderDetails.ProductID = Products.ProductID
GROUP BY Shippers.ShipperName
HAVING SUM(OrderDetails.Quantity * Products.Price) > 2000000;
```
-------------------------6409 sample_num
```sql
SELECT S.ShipperName, COUNT(O.OrderID) AS ShipCount
FROM Orders O
JOIN Shippers S ON O.ShipperID = S.ShipperID
JOIN Customers C ON O.CustomerID = C.CustomerID
WHERE C.City = 'Aachen'
GROUP BY S.ShipperName
ORDER BY ShipCount DESC
LIMIT 1;
```
-------------------------6410 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
WHERE EmployeeID IN (
    SELECT EmployeeID
    FROM Employees
    WHERE RegionDescription = 'Northern'
);
```
-------------------------6411 sample_num
```sql
SELECT ContactName 
FROM Suppliers 
WHERE SupplierName = 'Pavlova';
```
-------------------------6412 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.ShipperID IN (SELECT ShipperID FROM Shippers WHERE City = 'Paris');
```
-------------------------6413 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
JOIN Customers c ON o.CustomerID = c.CustomerID
WHERE c.PostalCode = '28023'
GROUP BY p.ProductName
ORDER BY SUM(od.Quantity) ASC
LIMIT 1;
```
-------------------------6414 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.LastName) AS FullName
FROM Employees e
JOIN Employees s ON e.ReportsTo = s.EmployeeID
WHERE s.FirstName = 'Andrew' AND s.LastName = 'Fuller' AND e.RegionDescription = 'Southern';
```
-------------------------6415 sample_num
```sql
SELECT o.OrderDate
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE c.CustomerName = 'Du monde entier' AND od.Quantity = 9 AND p.ProductName = 'Filo Mix';
```
-------------------------6416 sample_num
```sql
SELECT DISTINCT c.CategoryName
FROM Categories c
JOIN Products p ON c.CategoryID = p.CategoryID
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
WHERE o.OrderID = 10933;
```
-------------------------6417 sample_num
```sql
SELECT HomePhone 
FROM Employees 
WHERE EmployeeID IN (
    SELECT EmployeeID 
    FROM Territories 
    WHERE TerritoryDescription = 'Portsmouth'
);
```
-------------------------6418 sample_num
```sql
SELECT AVG(Quantity) AS AverageQuantity
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.ShipperName = 'Federal Shipping' 
AND o.OrderDate >= '1996-11-01 00:00:00' 
AND o.OrderDate < '1996-12-01 00:00:00';
```
-------------------------6419 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN ShippedDate >= '1996-09-01' AND ShippedDate < '1996-10-01' THEN OrderID END) * 100.0 / 
    COUNT(OrderID)) AS percentage
FROM 
    Orders o
JOIN 
    Shippers s ON o.ShipperID = s.ShipperID
WHERE 
    s.ShipperName = 'United Package' 
    AND o.OrderDate >= '1996-01-01' 
    AND o.OrderDate < '1997-01-01';
```
-------------------------6420 sample_num
```sql
SELECT COUNT(*) 
FROM Suppliers 
WHERE Country = 'Mexico' AND ContactTitle = 'Owner';
```
-------------------------6421 sample_num
```sql
SELECT Address, City, Region, PostalCode, Country 
FROM Customers 
WHERE ContactName = 'Andr Fonseca';
```
-------------------------6422 sample_num
```sql
SELECT SupplierName AS CompanyName FROM Suppliers WHERE Phone LIKE '(171)%'
UNION
SELECT ShipperName AS CompanyName FROM Shippers WHERE Phone LIKE '(171)%';
```
-------------------------6423 sample_num
```sql
SELECT 
    (SELECT COUNT(EmployeeID) FROM Employees WHERE Country = 'UK' AND Title = 'sales representative') -
    (SELECT COUNT(EmployeeID) FROM Employees WHERE Country = 'USA' AND Title = 'sales representative') AS EmployeeDifference;
```
-------------------------6424 sample_num
```sql
SELECT COUNT(*) 
FROM Employees 
WHERE City = 'Sao Paulo' AND Country = 'Brazil' AND ContactTitle = 'Sales Associate';
```
-------------------------6425 sample_num
```sql
SELECT e.LastName
FROM Orders o
JOIN Employees e ON o.EmployeeID = e.EmployeeID
WHERE o.OrderID = 10521 AND o.CustomerID = 'CACTU';
```
-------------------------6426 sample_num
```sql
SELECT S.Phone AS ShippingCost
FROM Orders O
JOIN Shippers S ON O.ShipperID = S.ShipperID
JOIN Customers C ON O.CustomerID = C.CustomerID
WHERE O.OrderID = 10692 AND C.CustomerName = 'Alfreds Futterkiste';
```
-------------------------6427 sample_num
```sql
SELECT ShipperName 
FROM Orders 
JOIN Shippers ON Orders.ShipperID = Shippers.ShipperID 
WHERE OrderID = 10558;
```
-------------------------6428 sample_num
```sql
SELECT o.OrderID 
FROM Orders o 
JOIN Shippers s ON o.ShipperID = s.ShipperID 
WHERE s.ShipperName = 'Speedy Express' 
LIMIT 3;
```
-------------------------6429 sample_num
```sql
SELECT p.ProductName 
FROM Products p 
JOIN Categories c ON p.CategoryID = c.CategoryID 
WHERE c.CategoryName = 'beverage';
```
-------------------------6430 sample_num
```sql
SELECT c.Description 
FROM Products p 
JOIN Categories c ON p.CategoryID = c.CategoryID 
WHERE p.ProductName = 'tofu';
```
-------------------------6431 sample_num
```sql
SELECT Suppliers.SupplierName 
FROM Products 
JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID 
WHERE Products.ProductName = 'Gula Malacca';
```
-------------------------6432 sample_num
```sql
SELECT p.ProductName 
FROM Products p 
JOIN Suppliers s ON p.SupplierID = s.SupplierID 
WHERE s.SupplierName = 'Aux joyeux ecclsiastiques';
```
-------------------------6433 sample_num
```sql
SELECT Price FROM Products WHERE ProductName = 'Konbu' AND SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'Mayumi''s');
```
-------------------------6434 sample_num
```sql
SELECT s.ContactName 
FROM Products p 
JOIN Suppliers s ON p.SupplierID = s.SupplierID 
WHERE p.ProductName = 'Camembert Pierrot';
```
-------------------------6435 sample_num
```sql
SELECT ProductName 
FROM Products 
JOIN Categories ON Products.CategoryID = Categories.CategoryID 
WHERE Products.Discontinued = 1 AND Categories.CategoryName = 'Meat/Poultry' 
LIMIT 3;
```
-------------------------6436 sample_num
```sql
SELECT ProductName 
FROM Products 
WHERE SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'Heli Swaren GmbH & Co. KG') 
ORDER BY ReorderLevel DESC 
LIMIT 2;
```
-------------------------6437 sample_num
```sql
SELECT ContactName 
FROM Suppliers 
WHERE SupplierName = 'Heli Swaren GmbH & Co. KG';
```
-------------------------6438 sample_num
```sql
SELECT Country FROM Suppliers WHERE SupplierName = 'Drachenblut Delikatessen';
```
-------------------------6439 sample_num
```sql
SELECT COUNT(*) AS TerritoryCount FROM Territories;
```
-------------------------6440 sample_num
```sql
SELECT MAX(TotalPrice) AS LargestTotalPrice
FROM (
    SELECT O.OrderID, SUM(P.Price * OD.Quantity * (1 - OD.Discount)) AS TotalPrice
    FROM Orders O
    JOIN OrderDetails OD ON O.OrderID = OD.OrderID
    JOIN Products P ON OD.ProductID = P.ProductID
    GROUP BY O.OrderID
) AS OrderTotals;
```
-------------------------6441 sample_num
```sql
SELECT ProductName 
FROM Products 
WHERE Price = (SELECT MAX(Price) FROM Products);
```
-------------------------6442 sample_num
```sql
SELECT COUNT(*) 
FROM Orders o
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.Country = 'France';
```
-------------------------6443 sample_num
```sql
SELECT TerritoryDescription 
FROM Customers 
WHERE City = 'Hoffman Estates';
```
-------------------------6444 sample_num
```sql
SELECT Suppliers.Phone 
FROM Products 
JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID 
WHERE Products.ProductName = 'Thringer Rostbratwurst';
```
-------------------------6445 sample_num
```sql
SELECT DISTINCT e.FirstName
FROM Employees e
JOIN Orders o ON e.EmployeeID = o.EmployeeID
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.City = 'Reims';
```
-------------------------6446 sample_num
```sql
SELECT MAX(od.Quantity) AS LargestQuantity
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.ProductName = 'Manjimup Dried Apples';
```
-------------------------6447 sample_num
```sql
SELECT COUNT(*) AS NumberOfOrders
FROM Orders
WHERE ShipperID = (SELECT ShipperID FROM Shippers WHERE ShipperName = 'Speedy Express');
```
-------------------------6448 sample_num
```sql
SELECT TerritoryDescription 
FROM Territories 
WHERE RegionDescription = 'Southern';
```
-------------------------6449 sample_num
```sql
SELECT Price FROM Products WHERE ProductID IN (
    SELECT ProductID FROM Categories WHERE CategoryName = 'Cheeses'
);
```
-------------------------6450 sample_num
```sql
SELECT COUNT(*) AS OrderCount
FROM Orders
WHERE CustomerID = (SELECT CustomerID FROM Customers WHERE CustomerName = 'Laughing Bacchus Wine Cellars');
```
-------------------------6451 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
JOIN Customers c ON o.CustomerID = c.CustomerID
WHERE c.Address = 'Starenweg 5';
```
-------------------------6452 sample_num
```sql
SELECT ProductName 
FROM Products 
WHERE SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'Bigfoot Breweries');
```
-------------------------6453 sample_num
```sql
SELECT t.TerritoryDescription
FROM Employees e
JOIN Territories t ON e.EmployeeID = t.EmployeeID
WHERE e.LastName = 'King' AND e.FirstName = 'Robert';
```
-------------------------6454 sample_num
```sql
SELECT DISTINCT c.ContactName
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.ShipCountry = 'Switzerland';
```
-------------------------6455 sample_num
```sql
SELECT 
    DIVIDE(COUNT(CASE WHEN Title = 'Sales Representative' THEN OrderID END), COUNT(OrderID)) AS percentage
FROM 
    Orders o
JOIN 
    Employees e ON o.EmployeeID = e.EmployeeID;
```
-------------------------6456 sample_num
```sql
SELECT COUNT(*) 
FROM Employees 
WHERE EmployeeID IN (
    SELECT CustomerID 
    FROM Customers 
    WHERE Country = 'USA'
) AND TitleOfCourtesy = 'Dr.';
```
-------------------------6457 sample_num
```sql
SELECT AVG(Salary) AS AverageSalary
FROM Employees
WHERE EmployeeID BETWEEN 1 AND 9;
```
-------------------------6458 sample_num
```sql
SELECT SUM(Salary) AS TotalSalary
FROM Employees
WHERE Country = 'UK';
```
-------------------------6459 sample_num
```sql
SELECT e.Photo, e.Notes 
FROM Employees e 
WHERE e.FirstName = 'Laura' AND e.LastName = 'Callahan' 
AND e.Phone = '(206) 555-1189';
```
-------------------------6460 sample_num
```sql
SELECT Notes 
FROM Employees 
WHERE EmployeeID = (SELECT EmployeeID FROM Employees ORDER BY Salary DESC LIMIT 1);
```
-------------------------6461 sample_num
```sql
SELECT DISTINCT o.CustomerID
FROM Orders o
JOIN Employees e ON o.EmployeeID = e.EmployeeID
WHERE e.FirstName = 'Michael' AND e.LastName = 'Suyama';
```
-------------------------6462 sample_num
```sql
SELECT DISTINCT c.Country
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
WHERE c.CustomerName = 'Janet Leverling';
```
-------------------------6463 sample_num
```sql
SELECT COUNT(*) AS OrderCount
FROM Orders
WHERE CustomerID = (SELECT CustomerID FROM Customers WHERE ContactName = 'Margaret Peacock');
```
-------------------------6464 sample_num
```sql
SELECT AVG(E.Salary) AS AverageSalaryPerOrder
FROM Employees E
JOIN Orders O ON E.EmployeeID = O.EmployeeID
WHERE E.FirstName = 'Andrew' AND E.LastName = 'Fuller';
```
-------------------------6465 sample_num
```sql
SELECT p.ProductName 
FROM Products p 
JOIN Suppliers s ON p.SupplierID = s.SupplierID 
WHERE s.SupplierName = 'Exotic Liquids';
```
-------------------------6466 sample_num
```sql
SELECT p.ProductName, p.Unit, od.Quantity
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
WHERE s.SupplierName = 'Tokyo Traders';
```
-------------------------6467 sample_num
```sql
SELECT COUNT(*) 
FROM Products 
WHERE SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'New Orleans Cajun Delights') 
AND Discontinued = 1;
```
-------------------------6468 sample_num
```sql
SELECT AVG(Price) AS AverageUnitPrice
FROM Products
WHERE SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'Formaggi Fortini s.r.l.');
```
-------------------------6469 sample_num
```sql
SELECT COUNT(p.ProductName) AS TotalProducts
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.Country = 'Japan';
```
-------------------------6470 sample_num
```sql
SELECT Suppliers.ContactName 
FROM Products 
JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID 
WHERE Products.ProductName = 'Teatime Chocolate Biscuits';
```
-------------------------6471 sample_num
```sql
SELECT SupplierName 
FROM Suppliers 
WHERE ReorderLevel = (SELECT MAX(ReorderLevel) FROM Products);
```
-------------------------6472 sample_num
```sql
SELECT Suppliers.ContactName 
FROM Products 
JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID 
WHERE Products.Unit = '10 boxes x 12 pieces';
```
-------------------------6473 sample_num
```sql
SELECT SUM(od.Quantity) AS TotalUnitsOnOrder
FROM OrderDetails od
JOIN Orders o ON od.OrderID = o.OrderID
JOIN Customers c ON o.CustomerID = c.CustomerID
JOIN Suppliers s ON p.SupplierID = s.SupplierID
JOIN Products p ON od.ProductID = p.ProductID
WHERE s.SupplierName = 'Exotic Liquids';
```
-------------------------6474 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN SupplierName = 'Gai pturage' THEN 1 END) * 100.0 / COUNT(*)) AS Percentage
FROM 
    Products;
```
-------------------------6475 sample_num
```sql
SELECT ProductID 
FROM Products 
ORDER BY UnitsInStock DESC 
LIMIT 5;
```
-------------------------6476 sample_num
```sql
SELECT COUNT(*) AS DiscontinuedProducts
FROM Products
WHERE Discontinued = 1;
```
-------------------------6477 sample_num
```sql
SELECT Address, Phone, Salary 
FROM Employees 
WHERE Title = 'Sales Manager';
```
-------------------------6478 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName, Photo AS PhotoURL
FROM Employees
WHERE Title = 'Vice President, Sales';
```
-------------------------6479 sample_num
```sql
SELECT c.CustomerName, SUM(od.Quantity * p.Price) AS TotalSales
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
GROUP BY c.CustomerName
ORDER BY TotalSales DESC
LIMIT 10;
```
-------------------------6480 sample_num
```sql
SELECT c.CategoryName, AVG(od.Quantity * p.Price) AS AverageSales
FROM Categories c
JOIN Products p ON c.CategoryID = p.CategoryID
JOIN OrderDetails od ON p.ProductID = od.ProductID
GROUP BY c.CategoryName;
```
-------------------------6481 sample_num
```sql
SELECT SUM(od.Quantity) AS TotalOrderQuantity
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.ProductName = 'Uncle Bob''s Organic Dried Pears';
```
-------------------------6482 sample_num
```sql
SELECT COUNT(*) 
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
JOIN OrderDetails od ON p.ProductID = od.ProductID
WHERE c.CategoryName = 'Seafood' AND od.Quantity > 50;
```
-------------------------6483 sample_num
```sql
SELECT p.ProductID, p.ProductName, p.ReorderLevel
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.SupplierName = 'Pavlova, Ltd';
```
-------------------------6484 sample_num
```sql
SELECT s.SupplierName
FROM Suppliers s
JOIN Products p ON s.SupplierID = p.SupplierID
WHERE p.Discontinued = 1;
```
-------------------------6485 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
LEFT JOIN Territories ON Employees.EmployeeID = Territories.EmployeeID
GROUP BY Employees.EmployeeID
HAVING COUNT(TerritoryID) < 4;
```
-------------------------6486 sample_num
```sql
SELECT COUNT(DISTINCT EmployeeID) 
FROM Employees 
WHERE EmployeeID IN (SELECT EmployeeID FROM Territories WHERE RegionDescription = 'Eastern');
```
-------------------------6487 sample_num
```sql
SELECT COUNT(*) AS TotalOrders
FROM Orders o
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE o.OrderDate BETWEEN '1997-03-01' AND '1997-10-08'
AND s.ShipperName = 'Federal Shipping';
```
-------------------------6488 sample_num
```sql
SELECT COUNT(DISTINCT o.CustomerID) 
FROM Orders o
JOIN Employees e ON o.EmployeeID = e.EmployeeID
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.ShipCountry = 'Brazil' 
AND e.FirstName = 'Margaret' 
AND e.LastName = 'Peacock' 
AND o.OrderDate BETWEEN '1997-03-31' AND '1997-12-10';
```
-------------------------6489 sample_num
```sql
SELECT p.ProductID, p.ProductName, p.Unit, p.Price, od.Quantity
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
WHERE od.Quantity = 1;
```
-------------------------6490 sample_num
```sql
SELECT p.ProductName, (p.Price * od.Quantity) AS StockValue
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
JOIN OrderDetails od ON p.ProductID = od.ProductID
WHERE c.CategoryName = 'Condiments';
```
-------------------------6491 sample_num
```sql
SELECT COUNT(*) AS TerritoryCount
FROM Territories
WHERE EmployeeID = (SELECT EmployeeID FROM Employees WHERE LastName = 'Dodsworth' AND FirstName = 'Anne');
```
-------------------------6492 sample_num
```sql
SELECT c.CustomerID, c.CustomerName, MAX(DATEDIFF(o.ShippedDate, o.RequiredDate)) AS LongestDelay
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
WHERE c.Country = 'USA' AND o.ShippedDate IS NOT NULL AND o.RequiredDate IS NOT NULL
GROUP BY c.CustomerID, c.CustomerName;
```
-------------------------6493 sample_num
```sql
SELECT c.ContactName, c.Phone
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
GROUP BY c.CustomerID, c.ContactName, c.Phone
ORDER BY SUM(od.Quantity * p.Price * (1 - od.Discount)) DESC
LIMIT 1;
```
-------------------------6494 sample_num
```sql
SELECT 
    CONCAT(e.FirstName, ' ', e.LastName) AS SalesRepresentative,
    CONCAT(s.FirstName, ' ', s.LastName) AS Supervisor
FROM 
    Customers c
JOIN 
    Orders o ON c.CustomerID = o.CustomerID
JOIN 
    OrderDetails od ON o.OrderID = od.OrderID
JOIN 
    Products p ON od.ProductID = p.ProductID
JOIN 
    Employees e ON o.EmployeeID = e.EmployeeID
JOIN 
    Employees s ON e.ReportsTo = s.EmployeeID
GROUP BY 
    c.CustomerID, e.EmployeeID
ORDER BY 
    SUM(od.Quantity * p.Price * (1 - od.Discount)) DESC
LIMIT 1;
```
-------------------------6495 sample_num
```sql
SELECT COUNT(*) AS CustomerCount 
FROM Customers 
WHERE City = 'Berlin' AND Country = 'Germany';
```
-------------------------6496 sample_num
```sql
SELECT COUNT(*) AS ProductCount
FROM Products
WHERE SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'Exotic Liquids');
```
-------------------------6497 sample_num
```sql
SELECT Suppliers.SupplierName, Products.ProductName
FROM Products
JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID
WHERE Products.Price = (SELECT MIN(Price) FROM Products);
```
-------------------------6498 sample_num
```sql
SELECT AVG(Price) AS AverageUnitPrice
FROM Products
WHERE SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'Tokyo Traders');
```
-------------------------6499 sample_num
```sql
SELECT COUNT(*) AS TerritoryCount
FROM Territories
WHERE RegionDescription = 'Eastern';
```
-------------------------6500 sample_num
```sql
SELECT RegionDescription
FROM Territories
GROUP BY RegionDescription
ORDER BY COUNT(TerritoryID) DESC
LIMIT 1;
```
-------------------------6501 sample_num
```sql
SELECT RegionDescription 
FROM Territories 
WHERE TerritoryID = 2116;
```
-------------------------6502 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.City = 'Madrid' THEN o.CustomerID END) * 100.0 / COUNT(o.CustomerID)) AS Percentage
FROM 
    Orders o
JOIN 
    Customers c ON o.CustomerID = c.CustomerID
WHERE 
    YEAR(o.OrderDate) = 1996;
```
-------------------------6503 sample_num
```sql
SELECT LastName + ', ' + FirstName AS FullName
FROM Employees;
```
-------------------------6504 sample_num
```sql
SELECT FirstName 
FROM Employees 
WHERE Salary = (SELECT MAX(Salary) FROM Employees);
```
-------------------------6505 sample_num
```sql
SELECT COUNT(*) 
FROM Employees 
WHERE Title = 'Sales Representative' AND Salary > 2000;
```
-------------------------6506 sample_num
```sql
SELECT COUNT(*) 
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID
WHERE YEAR(o.OrderDate) = 1996 AND c.Country = 'UK';
```
-------------------------6507 sample_num
```sql
SELECT c.CustomerName, COUNT(o.OrderID) AS OrderCount
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
WHERE YEAR(o.OrderDate) = 1998
GROUP BY c.CustomerName
ORDER BY OrderCount DESC
LIMIT 1;
```
-------------------------6508 sample_num
```sql
SELECT c.Country, COUNT(o.OrderID) AS NumberOfOrders
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID
WHERE YEAR(o.OrderDate) = 1996
GROUP BY c.Country;
```
-------------------------6509 sample_num
```sql
SELECT COUNT(*) 
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID
WHERE c.CustomerName = 'Hanna Moos' AND YEAR(o.OrderDate) = 1999;
```
-------------------------6510 sample_num
```sql
SELECT MIN(DATEDIFF(ShippedDate, OrderDate)) AS FastestShippingDays
FROM Orders
JOIN Customers ON Orders.CustomerID = Customers.CustomerID
JOIN Shippers ON Orders.ShipperID = Shippers.ShipperID
WHERE Customers.CustomerName = 'Berglunds snabbkp';
```
-------------------------6511 sample_num
```sql
SELECT Customers.CustomerName 
FROM Orders 
JOIN Customers ON Orders.CustomerID = Customers.CustomerID 
WHERE Orders.OrderID = 10257;
```
-------------------------6512 sample_num
```sql
SELECT YEAR(OrderDate) AS OrderYear
FROM Orders
JOIN Customers ON Orders.CustomerID = Customers.CustomerID
WHERE Customers.CustomerName = 'Around the Horn'
GROUP BY YEAR(OrderDate)
ORDER BY COUNT(OrderID) DESC
LIMIT 1;
```
-------------------------6513 sample_num
```sql
SELECT COUNT(*) 
FROM Employees 
WHERE ReportsTo IS NOT NULL 
AND EmployeeID IN (SELECT EmployeeID FROM Employees WHERE FirstName = 'Andrew' AND LastName = 'Fuller');
```
-------------------------6514 sample_num
```sql
SELECT Country
FROM Suppliers
GROUP BY Country
ORDER BY COUNT(SupplierID) DESC
LIMIT 1;
```
-------------------------6515 sample_num
```sql
SELECT CONCAT(LastName, ', ', FirstName) AS FullName
FROM Employees
WHERE ReportsTo IS NOT NULL AND EmployeeID IN (
    SELECT EmployeeID
    FROM Employees
    WHERE Title = 'Sales Manager'
);
```
-------------------------6516 sample_num
```sql
SELECT COUNT(o.OrderID) AS OrderCount
FROM Orders o
WHERE o.CustomerID = (
    SELECT o2.CustomerID
    FROM Orders o2
    WHERE o2.OrderDate BETWEEN '1996-08-01' AND '1996-08-31'
    GROUP BY o2.CustomerID
    ORDER BY COUNT(o2.OrderID) DESC
    LIMIT 1
)
AND o.OrderDate BETWEEN '1996-08-01' AND '1996-08-31';
```
-------------------------6517 sample_num
```sql
SELECT Salary FROM Employees WHERE HireDate = (SELECT MIN(HireDate) FROM Employees);
```
-------------------------6518 sample_num
```sql
SELECT MAX(DATEDIFF(OrderDate, BirthDate)) AS OldestEmployeeAgeAtHire
FROM Employees
JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID;
```
-------------------------6519 sample_num
```sql
SELECT SUM(p.Price * od.Quantity) AS TotalSalesAmount
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
WHERE p.Discontinued = 1;
```
-------------------------6520 sample_num
```sql
SELECT c.CategoryName
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE p.Discontinued = 1
GROUP BY c.CategoryName
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------6521 sample_num
```sql
SELECT SUM(od.Quantity) AS TotalCondimentsSold
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
JOIN Categories c ON p.CategoryID = c.CategoryID
JOIN Orders o ON od.OrderID = o.OrderID
WHERE c.CategoryName = 'Condiments' AND YEAR(o.OrderDate) = 1997;
```
-------------------------6522 sample_num
```sql
SELECT c.CustomerName
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
GROUP BY c.CustomerID, o.OrderID
ORDER BY SUM(od.Quantity) DESC
LIMIT 1;
```
-------------------------6523 sample_num
```sql
SELECT AVG(MonthlyProductCount) AS MonthlyAverageProductsShipped
FROM (
    SELECT MONTH(o.OrderDate) AS OrderMonth, SUM(od.Quantity) AS MonthlyProductCount
    FROM Orders o
    JOIN OrderDetails od ON o.OrderID = od.OrderID
    JOIN Shippers s ON o.ShipperID = s.ShipperID
    WHERE YEAR(o.OrderDate) = 1996 AND s.ShipperName = 'Federal Shipping'
    GROUP BY MONTH(o.OrderDate)
) AS MonthlyCounts;
```
-------------------------6524 sample_num
```sql
SELECT ProductName 
FROM Products 
WHERE SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'G''day, Mate');
```
-------------------------6525 sample_num
```sql
SELECT COUNT(TerritoryID) 
FROM Territories 
WHERE RegionID = (SELECT RegionID 
                  FROM Territories 
                  GROUP BY RegionID 
                  ORDER BY COUNT(TerritoryID) DESC 
                  LIMIT 1);
```
-------------------------6526 sample_num
```sql
SELECT SupplierName 
FROM Suppliers 
WHERE SupplierID = (
    SELECT SupplierID 
    FROM Products 
    WHERE Price = (SELECT MAX(Price) FROM Products)
);
```
-------------------------6527 sample_num
```sql
SELECT COUNT(*) 
FROM Employees 
WHERE (TitleOfCourtesy = 'Mrs.' OR TitleOfCourtesy = 'Ms.') 
AND (SELECT COUNT(DISTINCT TerritoryID) FROM Territories WHERE EmployeeID = Employees.EmployeeID) >= 3;
```
-------------------------6528 sample_num
```sql
SELECT TOP 8 s.SupplierName, COUNT(p.ProductID) AS ProductCount
FROM Suppliers s
JOIN Products p ON s.SupplierID = p.SupplierID
WHERE p.ReorderLevel = (SELECT MAX(ReorderLevel) FROM Products)
GROUP BY s.SupplierName
ORDER BY ProductCount DESC;
```
-------------------------6529 sample_num
```sql
SELECT c.CustomerName
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE od.Discount = 0
GROUP BY c.CustomerID, c.CustomerName, o.OrderID
ORDER BY SUM(p.Price * od.Quantity) DESC
LIMIT 1;
```
-------------------------6530 sample_num
```sql
SELECT SUM(od.Quantity * p.Price) AS TotalSales
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
JOIN Employees e ON o.EmployeeID = e.EmployeeID
WHERE e.FirstName = 'Nancy' AND e.LastName = 'Davolio'
AND YEAR(o.OrderDate) = 1996 AND MONTH(o.OrderDate) = 12
AND od.Discount = 0;
```
-------------------------6531 sample_num
```sql
SELECT SUM(p.Price * od.Quantity) AS TotalSales
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE YEAR(o.OrderDate) = 1997;
```
-------------------------6532 sample_num
```sql
SELECT AVG(AnnualSales) AS AverageAnnualSales
FROM (
    SELECT YEAR(OrderDate) AS Year, SUM(od.Quantity * p.Price * (1 - od.Discount)) AS AnnualSales
    FROM Orders o
    JOIN OrderDetails od ON o.OrderID = od.OrderID
    JOIN Products p ON od.ProductID = p.ProductID
    WHERE o.OrderDate > '1996-01-01' AND o.OrderDate < '1998-12-31'
    GROUP BY YEAR(OrderDate)
) AS AnnualSalesData;
```
-------------------------6533 sample_num
```sql
SELECT COUNT(*) 
FROM Orders 
JOIN Shippers ON Orders.ShipperID = Shippers.ShipperID 
WHERE Shippers.ShipCountry = 'Venezuela' 
AND YEAR(Orders.OrderDate) = 1996;
```
-------------------------6534 sample_num
```sql
SELECT CategoryID, Description FROM Categories WHERE CategoryName = 'Condiments';
```
-------------------------6535 sample_num
```sql
SELECT O.OrderID, OD.ProductID, P.Price AS UnitPrice
FROM Orders O
JOIN OrderDetails OD ON O.OrderID = OD.OrderID
JOIN Products P ON OD.ProductID = P.ProductID
GROUP BY O.OrderID, OD.ProductID, P.Price
HAVING SUM(OD.Quantity * P.Price * (1 - 0)) > 15000;
```
-------------------------6536 sample_num
```sql
SELECT TerritoryID FROM Territories WHERE EmployeeID = 7;
```
-------------------------6537 sample_num
```sql
SELECT SupplierName, Address 
FROM Suppliers 
WHERE City = 'Sydney';
```
-------------------------6538 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName, 
       YEAR(HireDate) - YEAR(BirthDate) AS AgeWhenHired
FROM Employees
WHERE Title = 'Vice President, Sales';
```
-------------------------6539 sample_num
```sql
SELECT SupplierName FROM Suppliers WHERE Country = 'Germany';
```
-------------------------6540 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName, 
       SUBTRACT(2022, YEAR(BirthDate)) AS Age
FROM Employees
WHERE City = 'London';
```
-------------------------6541 sample_num
```sql
SELECT CustomerName, Address, Phone, Fax 
FROM Customers 
WHERE City = 'London';
```
-------------------------6542 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName, Title
FROM Employees
WHERE ReportsTo = (SELECT EmployeeID FROM Employees WHERE Title = 'Sales Manager');
```
-------------------------6543 sample_num
```sql
SELECT CustomerName, City 
FROM Customers 
WHERE Country = 'Canada';
```
-------------------------6544 sample_num
```sql
SELECT SUM(UnitsInStock + UnitsOnOrder) AS TotalProductionAmount, ProductName
FROM Products
WHERE Unit = '10 - 500 g pkgs.'
GROUP BY ProductName;
```
-------------------------6545 sample_num
```sql
SELECT p.ProductName, c.CategoryName
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE p.ReorderLevel = (SELECT MAX(ReorderLevel) FROM Products);
```
-------------------------6546 sample_num
```sql
SELECT s.SupplierName, s.City, p.ProductName
FROM Suppliers s
JOIN Products p ON s.SupplierID = p.SupplierID
WHERE (p.UnitsInStock + p.UnitsOnOrder) > 120;
```
-------------------------6547 sample_num
```sql
SELECT s.ContactName, e.Title, p.ProductName
FROM Suppliers s
JOIN Products p ON s.SupplierID = p.SupplierID
JOIN Employees e ON e.EmployeeID = s.ContactName
WHERE s.SupplierName = 'Escargots Nouveaux';
```
-------------------------6548 sample_num
```sql
SELECT Territories.TerritoryID, Territories.Description, Regions.RegionDescription
FROM Territories
JOIN Employees ON Territories.EmployeeID = Employees.EmployeeID
JOIN Regions ON Territories.RegionID = Regions.RegionID
WHERE Employees.FirstName = 'Margaret' AND Employees.LastName = 'Peacock';
```
-------------------------6549 sample_num
```sql
SELECT p.ProductName 
FROM Products p 
JOIN Suppliers s ON p.SupplierID = s.SupplierID 
WHERE s.Country = 'Spain';
```
-------------------------6550 sample_num
```sql
SELECT p.ProductName
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE o.CustomerID = 'WILMK' AND o.OrderDate = '1998-03-26 00:00:00';
```
-------------------------6551 sample_num
```sql
SELECT ProductID, ProductName 
FROM Products 
WHERE CategoryID = (SELECT CategoryID FROM Categories WHERE CategoryName = 'Meat/Poultry');
```
-------------------------6552 sample_num
```sql
SELECT COUNT(*) AS NumberOfOrders
FROM Orders
WHERE CustomerID IN (
    SELECT CustomerID
    FROM Customers
    WHERE Country = 'Ireland'
);
```
-------------------------6553 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
JOIN Customers c ON o.CustomerID = c.CustomerID
WHERE YEAR(o.OrderDate) = 1996 AND c.Country = 'Norway';
```
-------------------------6554 sample_num
```sql
SELECT DISTINCT s.SupplierName
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID
JOIN Employees e ON o.EmployeeID = e.EmployeeID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE c.Country = 'Brazil'
  AND e.FirstName = 'Anne'
  AND e.LastName = 'Dodsworth'
  AND YEAR(o.OrderDate) = 1996
  AND MONTH(o.OrderDate) = 12;
```
-------------------------6555 sample_num
```sql
SELECT 
    CONCAT(e.FirstName, ' ', e.LastName) AS FullName, 
    e.Title, 
    e.Salary, 
    COUNT(o.OrderID) AS NumberOfOrders
FROM 
    Employees e
LEFT JOIN 
    Orders o ON e.EmployeeID = o.EmployeeID
LEFT JOIN 
    Shippers s ON o.ShipperID = s.ShipperID
WHERE 
    e.BirthDate = (SELECT MIN(BirthDate) FROM Employees)
    AND o.ShipCountry = 'USA'
GROUP BY 
    e.EmployeeID;
```
-------------------------6556 sample_num
```sql
SELECT TerritoryID, Description 
FROM Territories 
WHERE RegionDescription = 'Southern';
```
-------------------------6557 sample_num
```sql
SELECT AVG(od.Quantity * p.Price) AS AveragePayment
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE c.CategoryName = 'Confections';
```
-------------------------6558 sample_num
```sql
SELECT SUM(p.Price * od.Quantity) AS TotalPayment
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE c.City = 'San Francisco';
```
-------------------------6559 sample_num
```sql
SELECT p.ProductID, p.ProductName, (p.UnitsInStock + p.UnitsOnOrder) AS TotalProduction
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.Country = 'Japan';
```
-------------------------6560 sample_num
```sql
SELECT p.ProductName, c.CategoryName, p.Price
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.Country = 'Australia' AND p.Discontinued = 1;
```
-------------------------6561 sample_num
```sql
SELECT s.Country, o.OrderID
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
WHERE p.ProductName = 'Ipoh Coffee'
AND o.OrderID = (
    SELECT od2.OrderID
    FROM OrderDetails od2
    JOIN Products p2 ON od2.ProductID = p2.ProductID
    GROUP BY od2.OrderID
    ORDER BY SUM(p2.Price * od2.Quantity * (1 - od2.Discount)) DESC
    LIMIT 1
);
```
-------------------------6562 sample_num
```sql
SELECT p.ProductID, p.ProductName, SUM(od.Quantity * p.Price * (1 - od.Discount)) AS TotalPayment
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
WHERE od.OrderID = '10979'
GROUP BY p.ProductID, p.ProductName;
```
-------------------------6563 sample_num
```sql
SELECT s.ContactName, s.SupplierName
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE c.CategoryName = 'Grains/Cereals' AND s.SupplierID BETWEEN 1 AND 10;
```
-------------------------6564 sample_num
```sql
SELECT S.Phone, COUNT(O.OrderID) AS NumberOfShippedOrders
FROM Shippers S
LEFT JOIN Orders O ON S.ShipperID = O.ShipperID
WHERE S.ShipperName = 'Speedy Express' AND O.OrderDate = '1998-01-30'
GROUP BY S.Phone;
```
-------------------------6565 sample_num
```sql
SELECT od.OrderDetailID, p.ProductName, o.OrderDate, od.Quantity, 
       DATEDIFF(od.ShippedDate, o.RequiredDate) AS OverdueDays
FROM OrderDetails od
JOIN Orders o ON od.OrderID = o.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE DATEDIFF(od.ShippedDate, o.RequiredDate) < 0
ORDER BY OverdueDays ASC
LIMIT 1;
```
-------------------------6566 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
JOIN Shippers s ON o.ShipperID = s.ShipperID
JOIN Employees e ON o.EmployeeID = e.EmployeeID
WHERE s.ShipCountry = 'Mexico' 
AND YEAR(o.OrderDate) = 1996 
AND e.Title = 'Inside Sales Coordinator';
```
-------------------------6567 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE c.CategoryName = 'Dairy Products'
ORDER BY p.ReorderLevel DESC
LIMIT 1;
```
-------------------------6568 sample_num
```sql
SELECT SUM(UnitsInStock + UnitsOnOrder) AS ProductionVolume
FROM Products
WHERE ProductName = 'Mascarpone Fabioli';
```
-------------------------6569 sample_num
```sql
SELECT p.ProductName, c.CategoryName
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE p.Price = (SELECT MAX(Price) FROM Products)
   OR p.Price = (SELECT MIN(Price) FROM Products);
```
-------------------------6570 sample_num
```sql
SELECT c.CustomerName, SUM(p.Price * od.Quantity * (1 - od.Discount)) AS OrderValue
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
GROUP BY c.CustomerName
ORDER BY OrderValue DESC
LIMIT 1;
```
-------------------------6571 sample_num
```sql
SELECT COUNT(*) AS NumberOfEmployees
FROM Employees
WHERE RegionDescription = 'Northern';
```
-------------------------6572 sample_num
```sql
SELECT AVG(TotalSales) AS AverageOrderValue
FROM (
    SELECT O.OrderID, SUM(P.Price * OD.Quantity) AS TotalSales
    FROM Orders O
    JOIN OrderDetails OD ON O.OrderID = OD.OrderID
    JOIN Products P ON OD.ProductID = P.ProductID
    GROUP BY O.OrderID
) AS OrderTotals;
```
-------------------------6573 sample_num
```sql
SELECT (SUM(CASE WHEN Discontinued = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(ProductID)) AS DiscontinuedPercentage
FROM Products;
```
-------------------------6574 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.LastName) AS FullName
FROM Employees e
JOIN Orders o ON e.EmployeeID = o.EmployeeID
WHERE o.OrderID = 10274;
```
-------------------------6575 sample_num
```sql
SELECT COUNT(*) AS TotalOrders
FROM Orders
JOIN Customers ON Orders.CustomerID = Customers.CustomerID
WHERE Customers.CustomerName = 'GROSELLA-Restaurante';
```
-------------------------6576 sample_num
```sql
SELECT p.ProductName, od.Quantity
FROM OrderDetails od
JOIN Orders o ON od.OrderID = o.OrderID
JOIN Customers c ON o.CustomerID = c.CustomerID
JOIN Employees e ON o.EmployeeID = e.EmployeeID
JOIN Products p ON od.ProductID = p.ProductID
WHERE c.CustomerName = 'GROSELLA-Restaurante' AND e.FirstName = 'Nancy' AND e.LastName = 'Davolio';
```
-------------------------6577 sample_num
```sql
SELECT 
    COUNT(o.OrderID) AS TotalOrders,
    AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AverageOrderValue
FROM 
    Customers c
JOIN 
    Orders o ON c.CustomerID = o.CustomerID
JOIN 
    OrderDetails od ON o.OrderID = od.OrderID
JOIN 
    Products p ON od.ProductID = p.ProductID
WHERE 
    c.CustomerName = 'Laughing Bacchus Wine Cellars';
```
-------------------------6578 sample_num
```sql
SELECT SUM(od.Quantity) AS TotalBoxes
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
WHERE p.ProductName = 'Pavlova';
```
-------------------------6579 sample_num
```sql
SELECT MAX(Salary) AS MaxSalary, MIN(Salary) AS MinSalary 
FROM Employees 
WHERE Title = 'Sales Representative' AND City = 'Northwind';
```
-------------------------6580 sample_num
```sql
SELECT COUNT(*) 
FROM Suppliers 
WHERE Country = 'USA';
```
-------------------------6581 sample_num
```sql
SELECT ProductName 
FROM Products 
WHERE Discontinued = 1;
```
-------------------------6582 sample_num
```sql
SELECT ContactName 
FROM Suppliers 
WHERE SupplierName = 'Eastern Connection';
```
-------------------------6583 sample_num
```sql
SELECT COUNT(DISTINCT ShipperID) AS NumberOfShippers
FROM Orders;
```
-------------------------6584 sample_num
```sql
SELECT 
    COUNT(o.OrderID) AS TotalOrders,
    (SUM(CASE WHEN s.Country = 'Austria' THEN 1 ELSE 0 END) * 100.0 / COUNT(o.OrderID)) AS PercentShippedToAustria
FROM 
    Orders o
JOIN 
    Employees e ON o.EmployeeID = e.EmployeeID
JOIN 
    Shippers s ON o.ShipperID = s.ShipperID
WHERE 
    e.FirstName = 'Andrew' AND e.LastName = 'Fuller';
```
-------------------------6585 sample_num
```sql
SELECT CategoryName 
FROM Categories 
WHERE Description = 'Soft drinks, coffees, teas, beers, and ales';
```
-------------------------6586 sample_num
```sql
SELECT Phone FROM Suppliers WHERE SupplierName = 'Around the Horn';
```
-------------------------6587 sample_num
```sql
SELECT Phone FROM Suppliers WHERE SupplierName = 'Blondesddsl pre et fils' AND City = 'Strasbourg';
```
-------------------------6588 sample_num
```sql
SELECT COUNT(*) AS NumberOfCompanies
FROM Customers
WHERE City = 'London';
```
-------------------------6589 sample_num
```sql
SELECT Address 
FROM Suppliers 
WHERE SupplierName = 'Eastern Connection' AND ContactName = 'Ann Devon';
```
-------------------------6590 sample_num
```sql
SELECT SupplierName FROM Suppliers WHERE Country = 'France';
```
-------------------------6591 sample_num
```sql
SELECT COUNT(ProductName) 
FROM Products 
WHERE SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'Exotic Liquids');
```
-------------------------6592 sample_num
```sql
SELECT Suppliers.SupplierName
FROM Products
JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID
WHERE Products.Price = (SELECT MAX(Price) FROM Products);
```
-------------------------6593 sample_num
```sql
SELECT Suppliers.SupplierName
FROM Suppliers
JOIN Products ON Suppliers.SupplierID = Products.SupplierID
WHERE Suppliers.City = 'London'
GROUP BY Suppliers.SupplierName
ORDER BY SUM(Products.Quantity) DESC
LIMIT 1;
```
-------------------------6594 sample_num
```sql
SELECT p.ProductName
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.SupplierName = 'Exotic Liquids'
ORDER BY p.ReorderLevel DESC
LIMIT 1;
```
-------------------------6595 sample_num
```sql
SELECT c.CategoryName 
FROM Products p 
JOIN Categories c ON p.CategoryID = c.CategoryID 
JOIN Suppliers s ON p.SupplierID = s.SupplierID 
WHERE p.ProductName = 'Chef Anton''s Gumbo Mix' 
AND s.SupplierName = 'New Orleans Cajun Delights';
```
-------------------------6596 sample_num
```sql
SELECT Suppliers.Country
FROM Suppliers
JOIN Products ON Suppliers.SupplierID = Products.SupplierID
WHERE Suppliers.SupplierName = 'Leka Trading' AND Products.ProductName = 'Ipoh Coffee';
```
-------------------------6597 sample_num
```sql
SELECT c.CategoryName
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
JOIN OrderDetails od ON p.ProductID = od.ProductID
GROUP BY c.CategoryName
ORDER BY SUM(od.Quantity) DESC
LIMIT 1;
```
-------------------------6598 sample_num
```sql
SELECT 
    (SELECT Price FROM Products WHERE ProductName = 'Chef Anton''s Cajun Seasoning') - 
    (SELECT Price FROM Products WHERE ProductName = 'Chef Anton''s Gumbo Mix') AS PriceDifference
WHERE 
    (SELECT SupplierName FROM Suppliers WHERE SupplierID = (SELECT SupplierID FROM Products WHERE ProductName = 'Chef Anton''s Cajun Seasoning')) = 'New Orleans Cajun Delights' 
    AND 
    (SELECT SupplierName FROM Suppliers WHERE SupplierID = (SELECT SupplierID FROM Products WHERE ProductName = 'Chef Anton''s Gumbo Mix')) = 'New Orleans Cajun Delights';
```
-------------------------6599 sample_num
```sql
SELECT p.ProductName 
FROM Products p 
JOIN Suppliers s ON p.SupplierID = s.SupplierID 
WHERE s.SupplierName = 'Cooperativa de Quesos ''Las Cabras'' AND p.Price > 20;
```
-------------------------6600 sample_num
```sql
SELECT p.ProductName 
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
WHERE s.SupplierName = 'Tokyo Traders' AND od.Quantity > 40;
```
-------------------------6601 sample_num
```sql
SELECT c.CategoryName
FROM Categories c
JOIN Products p ON c.CategoryID = p.CategoryID
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.SupplierName = 'Exotic Liquids' AND p.UnitsInStock > 100;
```
-------------------------6602 sample_num
```sql
SELECT 
    COUNT(DISTINCT p.ProductName) AS ProductCount,
    (SUM(CASE WHEN od.Quantity < 50 THEN od.Quantity ELSE 0 END) * 100.0 / SUM(od.Quantity)) AS PercentageLessThan50
FROM 
    Products p
JOIN 
    OrderDetails od ON p.ProductID = od.ProductID;
```
-------------------------6603 sample_num
```sql
SELECT 
    SUM(od.Quantity) AS TotalGeitostQuantity,
    (SUM(od.Quantity) * 100.0 / (SELECT SUM(Quantity) FROM OrderDetails)) AS GeitostPercentage
FROM 
    OrderDetails od
JOIN 
    Products p ON od.ProductID = p.ProductID
WHERE 
    p.ProductName = 'Geitost';
```
-------------------------6604 sample_num
```sql
SELECT Title 
FROM Employees 
WHERE CONCAT(FirstName, ' ', LastName) = 'Robert King';
```
-------------------------6605 sample_num
```sql
SELECT ShipperName, Phone 
FROM Shippers 
WHERE Phone = '(503) 555-9931';
```
-------------------------6606 sample_num
```sql
SELECT Address, HomePhone 
FROM Employees 
WHERE FirstName = 'Margaret' AND LastName = 'Peacock';
```
-------------------------6607 sample_num
```sql
SELECT Address, City, PostalCode, Country 
FROM Customers 
WHERE CustomerName = 'Rattlesnake Canyon Grocery';
```
-------------------------6608 sample_num
```sql
SELECT p.ProductName 
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE c.CategoryName = 'Confections';
```
-------------------------6609 sample_num
```sql
SELECT Suppliers.SupplierName, Suppliers.ContactName
FROM Products
JOIN Suppliers ON Products.SupplierID = Suppliers.SupplierID
WHERE Products.ProductName = 'Sir Rodney''s Marmalade';
```
-------------------------6610 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
WHERE EmployeeID IN (
    SELECT EmployeeID
    FROM Territories
    WHERE TerritoryDescription = 'Denver'
);
```
-------------------------6611 sample_num
```sql
SELECT t.TerritoryDescription
FROM Territories t
JOIN Employees e ON t.EmployeeID = e.EmployeeID
WHERE e.FirstName = 'Laura' AND e.LastName = 'Callahan';
```
-------------------------6612 sample_num
```sql
SELECT COUNT(*) AS NumberOfOrders
FROM Orders o
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.ShipperName = 'Federal Shipping';
```
-------------------------6613 sample_num
```sql
SELECT p.ProductName 
FROM Products p 
JOIN Suppliers s ON p.SupplierID = s.SupplierID 
WHERE s.Country = 'Finland';
```
-------------------------6614 sample_num
```sql
SELECT c.CategoryName, c.Description
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE p.ProductName = 'Mozzarella di Giovanni';
```
-------------------------6615 sample_num
```sql
SELECT DISTINCT s.SupplierName
FROM Suppliers s
JOIN Products p ON s.SupplierID = p.SupplierID
JOIN Categories c ON p.CategoryID = c.CategoryID
WHERE c.Description = 'cheeses';
```
-------------------------6616 sample_num
```sql
SELECT p.ProductName 
FROM Products p 
JOIN Suppliers s ON p.SupplierID = s.SupplierID 
WHERE s.SupplierName = 'Zaanse Snoepfabriek';
```
-------------------------6617 sample_num
```sql
SELECT p.ProductName, p.Price
FROM Products p
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE s.SupplierName = 'Plutzer Lebensmittelgromrkte AG' AND p.Discontinued = 1;
```
-------------------------6618 sample_num
```sql
SELECT DISTINCT c.City AS ShipCity
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.ProductName = 'Mishi Kobe Niku';
```
-------------------------6619 sample_num
```sql
SELECT 
    (SUM(CASE WHEN o.ShipperID = (SELECT ShipperID FROM Shippers WHERE ShipperName = 'Speedy Express') AND c.Country = 'Sweden' THEN 1 ELSE 0 END) * 100.0) / 
    COUNT(*) AS Percentage
FROM 
    Orders o
JOIN 
    Customers c ON o.CustomerID = c.CustomerID;
```
-------------------------6620 sample_num
```sql
SELECT COUNT(*) 
FROM Territories 
WHERE RegionID = 1;
```
-------------------------6621 sample_num
```sql
SELECT Region, COUNT(TerritoryID) AS TotalTerritories
FROM Territories
GROUP BY Region;
```
-------------------------6622 sample_num
```sql
SELECT COUNT(*) FROM Suppliers WHERE Country = 'UK';
```
-------------------------6623 sample_num
```sql
SELECT ContactName FROM Suppliers WHERE SupplierName = 'Tokyo Traders';
```
-------------------------6624 sample_num
```sql
SELECT COUNT(*) 
FROM Employees 
WHERE Country = 'USA' AND Title = 'Sales Representative';
```
-------------------------6625 sample_num
```sql
SELECT MAX(Salary) AS HighestSalary, Title
FROM Employees
GROUP BY Title
ORDER BY HighestSalary DESC
LIMIT 1;
```
-------------------------6626 sample_num
```sql
SELECT COUNT(*) 
FROM Products 
WHERE SupplierID = (SELECT SupplierID FROM Suppliers WHERE SupplierName = 'Plutzer Lebensmittelgromrkte AG') 
AND UnitsInStock = 0 
AND UnitsOnOrder > 0;
```
-------------------------6627 sample_num
```sql
SELECT p.ProductID, p.ProductName, p.Price, SUM(od.Quantity) AS TotalQuantitySold
FROM Products p
JOIN OrderDetails od ON p.ProductID = od.ProductID
WHERE p.Price = (SELECT MAX(Price) FROM Products)
GROUP BY p.ProductID, p.ProductName, p.Price;
```
-------------------------6628 sample_num
```sql
SELECT e.FirstName, e.LastName, e.EmployeeID, COUNT(o.OrderID) AS OrderCount
FROM Employees e
LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID
GROUP BY e.EmployeeID
ORDER BY OrderCount ASC
LIMIT 1;
```
-------------------------6629 sample_num
```sql
SELECT p.ProductName, COUNT(od.ProductID) AS ProductCount
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
WHERE c.Country = 'Germany'
GROUP BY p.ProductName
ORDER BY ProductCount DESC
LIMIT 1;
```
-------------------------6630 sample_num
```sql
SELECT SUM(p.Price * od.Quantity) AS TotalProductValue
FROM Orders o
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE o.ShipCountry = 'Brazil' AND s.ShipperName = 'Speedy Express';
```
-------------------------6631 sample_num
```sql
SELECT 
    COUNT(e.EmployeeID) AS SubordinateCount,
    MAX(od.Quantity * p.Price) AS MaxOrderValue
FROM 
    Employees e
LEFT JOIN 
    Orders o ON e.EmployeeID = o.EmployeeID
LEFT JOIN 
    OrderDetails od ON o.OrderID = od.OrderID
LEFT JOIN 
    Products p ON od.ProductID = p.ProductID
WHERE 
    e.ReportsTo = 2;
```
-------------------------6632 sample_num
```sql
SELECT 
    e.FirstName, 
    e.LastName, 
    COUNT(od.OrderDetailID) AS SalesCount, 
    SUM(od.Quantity * p.Price) AS TotalSales
FROM 
    Employees e
JOIN 
    Orders o ON e.EmployeeID = o.EmployeeID
JOIN 
    OrderDetails od ON o.OrderID = od.OrderID
JOIN 
    Products p ON od.ProductID = p.ProductID
WHERE 
    e.Title = 'Sales Representative'
GROUP BY 
    e.EmployeeID
ORDER BY 
    TotalSales DESC
LIMIT 1;
```
-------------------------6633 sample_num
```sql
SELECT COUNT(*) AS EmployeeCount, 
       COUNT(DISTINCT City) AS UniqueRegions
FROM Employees
WHERE Country = 'UK';
```
-------------------------6634 sample_num
```sql
SELECT c.CustomerName, o.OrderID, SUM(od.Quantity * p.Price) AS TotalPurchase, s.Country AS ShipCountry
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
JOIN Shippers s ON o.ShipperID = s.ShipperID
GROUP BY c.CustomerName, o.OrderID, s.Country
ORDER BY TotalPurchase DESC
LIMIT 1;
```
-------------------------6635 sample_num
```sql
SELECT c.CustomerName, cat.CategoryName, COUNT(od.ProductID) AS ProductCount
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
JOIN OrderDetails od ON o.OrderID = od.OrderID
JOIN Products p ON od.ProductID = p.ProductID
JOIN Categories cat ON p.CategoryID = cat.CategoryID
GROUP BY c.CustomerID, cat.CategoryID
HAVING COUNT(od.ProductID) = (
    SELECT MAX(ProductCount)
    FROM (
        SELECT COUNT(od2.ProductID) AS ProductCount
        FROM Customers c2
        JOIN Orders o2 ON c2.CustomerID = o2.CustomerID
        JOIN OrderDetails od2 ON o2.OrderID = od2.OrderID
        JOIN Products p2 ON od2.ProductID = p2.ProductID
        JOIN Categories cat2 ON p2.CategoryID = cat2.CategoryID
        GROUP BY c2.CustomerID, cat2.CategoryID
    ) AS subquery
)
ORDER BY c.CustomerName, cat.CategoryName;
```
-------------------------6636 sample_num
```sql
SELECT p.ProductID, p.ProductName, SUM(od.Quantity * p.Price) AS TotalSales
FROM Products p
JOIN Categories c ON p.CategoryID = c.CategoryID
JOIN OrderDetails od ON p.ProductID = od.ProductID
JOIN Orders o ON od.OrderID = o.OrderID
WHERE c.CategoryName = 'Confections'
GROUP BY p.ProductID, p.ProductName
ORDER BY TotalSales DESC
LIMIT 1;
```
-------------------------6637 sample_num
```sql
SELECT ProductName FROM Products WHERE ProductID = 77;
```
-------------------------6638 sample_num
```sql
SELECT SupplierName FROM Suppliers WHERE Country = 'USA';
```
-------------------------6639 sample_num
```sql
SELECT Title FROM Employees WHERE FirstName = 'Laura' AND LastName = 'Callahan';
```
-------------------------6640 sample_num
```sql
SELECT e.FirstName 
FROM Employees e
JOIN Orders o ON e.EmployeeID = o.EmployeeID
JOIN Customers c ON o.CustomerID = c.CustomerID
WHERE c.CustomerName = 'Victuailles en stock';
```
-------------------------6641 sample_num
```sql
SELECT COUNT(*) AS NumberOfOrders
FROM Orders o
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.ShipperName = 'Federal Shipping';
```
-------------------------6642 sample_num
```sql
SELECT e.FirstName, e.LastName
FROM Employees e
JOIN Orders o ON e.EmployeeID = o.EmployeeID
JOIN Customers c ON o.CustomerID = c.CustomerID
WHERE c.City = 'Morristown';
```
-------------------------6643 sample_num
```sql
SELECT TerritoryDescription 
FROM Territories 
WHERE RegionDescription = 'Northern';
```
-------------------------6644 sample_num
```sql
SELECT Orders.OrderID
FROM Orders
JOIN Employees ON Orders.EmployeeID = Employees.EmployeeID
WHERE Employees.FirstName = 'Michael' AND Employees.LastName = 'Suyama';
```
-------------------------6645 sample_num
```sql
SELECT 
    (SELECT COUNT(TerritoryDescription) FROM Territories WHERE RegionID = 3) * 1.0 / 
    (SELECT COUNT(TerritoryDescription) FROM Territories WHERE RegionID = 2) AS TerritoryRatio;
```
-------------------------6646 sample_num
```sql
SELECT EmployeeID FROM Employees WHERE TerritoryID BETWEEN 1000 AND 2000;
```
-------------------------6647 sample_num
```sql
SELECT t.TerritoryID, t.TerritoryDescription, r.RegionDescription
FROM Territories t
JOIN Employees e ON t.EmployeeID = e.EmployeeID
JOIN Regions r ON t.RegionID = r.RegionID
WHERE e.FirstName = 'Nancy' AND e.LastName = 'Davolio';
```
-------------------------6648 sample_num
```sql
SELECT e.FirstName, e.LastName, COUNT(o.OrderID) AS NumberOfOrders
FROM Employees e
LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID
WHERE e.Title = 'Sales Representative' AND YEAR(e.HireDate) = 1992
GROUP BY e.EmployeeID, e.FirstName, e.LastName;
```
-------------------------6649 sample_num
```sql
SELECT SUM(od.Quantity * p.Price * (1 - od.Discount)) AS TotalPayment
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
WHERE p.ProductName = 'Vegie-spread';
```
-------------------------6650 sample_num
```sql
SELECT DISTINCT Suppliers.SupplierName
FROM Suppliers
JOIN Products ON Suppliers.SupplierID = Products.SupplierID
JOIN OrderDetails ON Products.ProductID = OrderDetails.ProductID
JOIN Orders ON OrderDetails.OrderID = Orders.OrderID
WHERE Orders.OrderDate = '1996-08-14';
```
-------------------------6651 sample_num
```sql
SELECT p.ProductName, s.SupplierName
FROM OrderDetails od
JOIN Products p ON od.ProductID = p.ProductID
JOIN Suppliers s ON p.SupplierID = s.SupplierID
WHERE od.OrderID = 10337 AND p.ReorderLevel = (
    SELECT MAX(ReorderLevel)
    FROM Products
);
```
-------------------------6652 sample_num
```sql
SELECT S.ShipperName
FROM Shippers S
JOIN Orders O ON S.ShipperID = O.ShipperID
WHERE O.OrderDate >= '1998-01-01' AND O.OrderDate < '1998-04-01'
GROUP BY S.ShipperName
ORDER BY COUNT(O.OrderID) DESC
LIMIT 1;
```
-------------------------6653 sample_num
```sql
SELECT COUNT(*) FROM Customers WHERE City = 'London';
```
-------------------------6654 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS Title
FROM Employees
WHERE FirstName = 'Michael' AND LastName = 'Suyama';
```
-------------------------6655 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
WHERE BirthDate = '1955-03-04 00:00:00';
```
-------------------------6656 sample_num
```sql
SELECT e.FirstName 
FROM Employees e 
JOIN Orders o ON e.EmployeeID = o.EmployeeID 
WHERE o.OrderID = 10250;
```
-------------------------6657 sample_num
```sql
SELECT COUNT(*) 
FROM Orders o
JOIN Employees e ON o.EmployeeID = e.EmployeeID
WHERE e.City = 'Tacoma';
```
-------------------------6658 sample_num
```sql
SELECT c.Country
FROM Orders o
JOIN Employees e ON o.EmployeeID = e.EmployeeID
JOIN Customers c ON o.CustomerID = c.CustomerID
WHERE o.OrderID = 10257;
```
-------------------------6659 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS EmployeeTitle
FROM Employees
WHERE EmployeeID = (SELECT EmployeeID FROM Orders WHERE OrderID = 10270);
```
-------------------------6660 sample_num
```sql
SELECT Customers.Phone
FROM Customers
JOIN Orders ON Customers.CustomerID = Orders.CustomerID
WHERE Orders.OrderID = 10264;
```
-------------------------6661 sample_num
```sql
SELECT Customers.City, Customers.Country
FROM Orders
JOIN Customers ON Orders.CustomerID = Customers.CustomerID
WHERE Orders.OrderID = 10276;
```
-------------------------6662 sample_num
```sql
SELECT MAX(E.Salary) AS HighestSalary, AVG(E.Salary) AS AverageSalary
FROM Employees E
JOIN Orders O ON E.EmployeeID = O.EmployeeID
JOIN Shippers S ON O.ShipperID = S.ShipperID
WHERE S.ShipCountry = 'Brazil';
```
-------------------------6663 sample_num
```sql
SELECT 
    (SUM(CASE WHEN o.ShippedDate BETWEEN '1996-01-01' AND '1996-12-31' THEN e.Salary ELSE 0 END) / SUM(e.Salary)) * 100 AS percentage_salary
FROM 
    Employees e
JOIN 
    Orders o ON e.EmployeeID = o.EmployeeID
WHERE 
    o.ShippedDate IS NOT NULL;
```
-------------------------6664 sample_num
```sql
SELECT HireDate 
FROM Employees 
WHERE EmployeeID = (SELECT EmployeeID FROM Orders WHERE OrderID = 10281);
```
-------------------------6665 sample_num
```sql
SELECT COUNT(*) AS OrderCount
FROM Orders
WHERE EmployeeID IN (SELECT EmployeeID FROM Employees WHERE ReportsTo = 5);
```
-------------------------6666 sample_num
```sql
SELECT CONCAT(FirstName, ' ', LastName) AS FullName
FROM Employees
WHERE EmployeeID = (SELECT EmployeeID FROM Orders WHERE OrderID = 10280);
```
-------------------------6667 sample_num
```sql
SELECT Shippers.ShipperName 
FROM Orders 
JOIN Shippers ON Orders.ShipperID = Shippers.ShipperID 
WHERE Orders.OrderID = 10260;
```
-------------------------6668 sample_num
```sql
SELECT COUNT(*) 
FROM Orders o
JOIN Shippers s ON o.ShipperID = s.ShipperID
WHERE s.ShipperName = 'United Package';
```
-------------------------6669 sample_num
```sql
SELECT S.Phone 
FROM Orders O 
JOIN Shippers S ON O.ShipperID = S.ShipperID 
WHERE O.OrderID = 10296;
```
-------------------------6670 sample_num
```sql
SELECT COUNT(DISTINCT l_linenumber) AS returned_item_kinds
FROM lineitem
WHERE l_returnflag = 'R' AND l_orderkey = 5;
```
-------------------------6671 sample_num
```sql
SELECT MAX(l_shipdate) 
FROM lineitem 
WHERE l_orderkey = 1;
```
-------------------------6672 sample_num
```sql
SELECT o_orderkey, o_orderdate
FROM orders
WHERE o_orderkey IN (4, 36)
ORDER BY o_orderdate ASC
LIMIT 1;
```
-------------------------6673 sample_num
```sql
SELECT o_comment 
FROM orders 
WHERE o_totalprice = (SELECT MAX(o_totalprice) FROM orders);
```
-------------------------6674 sample_num
```sql
SELECT c_phone FROM customer WHERE c_name = 'Customer#000000001';
```
-------------------------6675 sample_num
```sql
SELECT COUNT(*) 
FROM orders 
JOIN customer ON orders.o_custkey = customer.c_custkey 
WHERE customer.c_mktsegment = 'HOUSEHOLD';
```
-------------------------6676 sample_num
```sql
SELECT MAX(o_totalprice) 
FROM orders 
JOIN customer ON orders.o_custkey = customer.c_custkey 
WHERE customer.c_mktsegment = 'HOUSEHOLD';
```
-------------------------6677 sample_num
```sql
SELECT o_comment 
FROM orders 
JOIN customer ON orders.o_custkey = customer.c_custkey 
WHERE customer.c_mktsegment = 'HOUSEHOLD';
```
-------------------------6678 sample_num
```sql
SELECT c_name 
FROM customer 
JOIN orders ON customer.c_custkey = orders.o_custkey 
WHERE o_totalprice = (SELECT MAX(o_totalprice) FROM orders) 
LIMIT 1;
```
-------------------------6679 sample_num
```sql
SELECT o_orderkey 
FROM orders o 
JOIN customer c ON o.o_custkey = c.c_custkey 
WHERE c.c_acctbal < 0;
```
-------------------------6680 sample_num
```sql
SELECT COUNT(*) 
FROM orders o
JOIN customer c ON o.o_custkey = c.c_custkey
WHERE c.c_mktsegment = 'HOUSEHOLD' AND o.o_orderpriority = '1-URGENT';
```
-------------------------6681 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE c_nationkey = (SELECT n_nationkey FROM nation WHERE n_name = 'BRAZIL');
```
-------------------------6682 sample_num
```sql
SELECT c_phone 
FROM customer 
WHERE c_mktsegment = 'HOUSEHOLD' 
AND c_nationkey = (SELECT n_nationkey FROM nation WHERE n_name = 'BRAZIL');
```
-------------------------6683 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE c_nationkey = (SELECT n_nationkey FROM nation WHERE n_name = 'GERMANY') 
AND c_acctbal > 1000;
```
-------------------------6684 sample_num
```sql
SELECT COUNT(*) AS total_orders
FROM orders o
JOIN customer c ON o.o_custkey = c.c_custkey
JOIN nation n ON c.c_nationkey = n.n_nationkey
WHERE n.n_name = 'GERMANY';
```
-------------------------6685 sample_num
```sql
SELECT SUM(o_totalprice) AS total_price
FROM orders o
JOIN customer c ON o.o_custkey = c.c_custkey
JOIN nation n ON c.c_nationkey = n.n_nationkey
WHERE n.n_name = 'GERMANY';
```
-------------------------6686 sample_num
```sql
SELECT o_orderkey
FROM orders o
JOIN customer c ON o.o_custkey = c.c_custkey
JOIN nation n ON c.c_nationkey = n.n_nationkey
WHERE n.n_name = 'GERMANY'
ORDER BY o.o_orderdate ASC
LIMIT 1;
```
-------------------------6687 sample_num
```sql
SELECT AVG(o_totalprice) AS average_order_price
FROM orders o
JOIN customer c ON o.o_custkey = c.c_custkey
JOIN nation n ON c.c_nationkey = n.n_nationkey
WHERE n.n_name = 'GERMANY';
```
-------------------------6688 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN n.n_name = 'GERMANY' THEN c.c_custkey END) * 100.0 / COUNT(c.c_custkey)) AS percentage
FROM 
    customer c
JOIN 
    nation n ON c.c_nationkey = n.n_nationkey;
```
-------------------------6689 sample_num
```sql
SELECT COUNT(DISTINCT n_nationkey) 
FROM nation 
WHERE n_regionkey = 2;
```
-------------------------6690 sample_num
```sql
SELECT n.n_name 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
WHERE s.s_suppkey = 34;
```
-------------------------6691 sample_num
```sql
SELECT r.r_name
FROM supplier s
JOIN nation n ON s.s_nationkey = n.n_nationkey
JOIN region r ON n.n_regionkey = r.r_regionkey
WHERE s.s_name = 'Supplier#000000129';
```
-------------------------6692 sample_num
```sql
SELECT n.n_name 
FROM customer c 
JOIN nation n ON c.c_nationkey = n.n_nationkey 
WHERE c.c_name = 'Customer#000000055';
```
-------------------------6693 sample_num
```sql
SELECT r.r_name 
FROM customer c 
JOIN nation n ON c.c_nationkey = n.n_nationkey 
JOIN region r ON n.n_regionkey = r.r_regionkey 
WHERE c.c_custkey = 106936;
```
-------------------------6694 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE c_acctbal < 0 
AND c_nationkey = (SELECT n_nationkey FROM nation WHERE n_name = 'MOROCCO');
```
-------------------------6695 sample_num
```sql
SELECT MULTIPLY(l_extendedprice, SUBTRACT(1, l_discount)) AS discounted_price
FROM lineitem
JOIN orders ON lineitem.l_orderkey = orders.o_orderkey
WHERE orders.o_totalprice = 231499.38 AND lineitem.l_suppkey = 9397;
```
-------------------------6696 sample_num
```sql
SELECT DISTINCT l.l_suppkey
FROM orders o
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE o.o_totalprice = 218195.43 AND l.l_returnflag = 'R';
```
-------------------------6697 sample_num
```sql
SELECT SUM(MULTIPLY(MULTIPLY(l_extendedprice, SUBTRACT(1, l_discount)), SUM(1, l_tax))) AS charge
FROM orders o
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE o.o_clerk = 'Clerk#000000936' 
  AND o.o_orderstatus = '4-NOT SPECIFIED' 
  AND o.o_orderdate = '1995-03-13' 
  AND l.l_shipmode = 'TRUCK';
```
-------------------------6698 sample_num
```sql
SELECT SUBTRACT(l_receiptdate, l_commitdate) AS delivery_time
FROM lineitem l
JOIN orders o ON l.l_orderkey = o.o_orderkey
WHERE o.o_orderdate = '1996-07-27' AND o.o_custkey = 129301
ORDER BY l.l_linenumber
LIMIT 1;
```
-------------------------6699 sample_num
```sql
SELECT c_name 
FROM customer 
JOIN orders ON customer.c_custkey = orders.o_custkey 
WHERE orders.o_clerk = 'Clerk#000000803' AND orders.o_orderdate = '1997-12-10';
```
-------------------------6700 sample_num
```sql
SELECT SUM(l_extendedprice * (1 - l_discount) - (ps_supplycost * l_quantity) ) AS profit
FROM lineitem
JOIN partsupp ON lineitem.l_partkey = partsupp.ps_partkey
WHERE lineitem.l_suppkey = 7414 AND lineitem.l_orderkey = 817154;
```
-------------------------6701 sample_num
```sql
SELECT n.n_name
FROM supplier s
JOIN nation n ON s.s_nationkey = n.n_nationkey
WHERE s.s_acctbal < 0
GROUP BY n.n_name
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------6702 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN r_name = 'EUROPE' THEN 1 END) * 100.0 / COUNT(n_name)) AS percentage
FROM 
    nation n
JOIN 
    region r ON n.n_regionkey = r.r_regionkey;
```
-------------------------6703 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN s_acctbal < 0 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    supplier s
JOIN 
    nation n ON s.s_nationkey = n.n_nationkey
WHERE 
    n.n_name = 'JAPAN';
```
-------------------------6704 sample_num
```sql
SELECT c_name 
FROM customer 
WHERE c_acctbal = (SELECT MIN(c_acctbal) FROM customer);
```
-------------------------6705 sample_num
```sql
SELECT COUNT(*) 
FROM orders o 
JOIN lineitem l ON o.o_orderkey = l.l_orderkey 
WHERE YEAR(l.l_shipdate) = 1998;
```
-------------------------6706 sample_num
```sql
SELECT COUNT(*) AS num_customers_in_debt
FROM customer
WHERE c_acctbal < 0;
```
-------------------------6707 sample_num
```sql
SELECT COUNT(l_linenumber) 
FROM lineitem 
WHERE l_shipmode = 'AIR' 
  AND YEAR(l_shipdate) = 1994 
  AND l_returnflag = 'R';
```
-------------------------6708 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE c_mktsegment = 'AUTOMOBILE';
```
-------------------------6709 sample_num
```sql
SELECT l_orderkey
FROM lineitem
WHERE l_extendedprice = (SELECT MAX(l_extendedprice) FROM lineitem)
LIMIT 2;
```
-------------------------6710 sample_num
```sql
SELECT l_shipdate
FROM orders
JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey
WHERE o_totalprice = (SELECT MAX(o_totalprice) FROM orders);
```
-------------------------6711 sample_num
```sql
SELECT n.n_name
FROM customer c
JOIN nation n ON c.c_nationkey = n.n_nationkey
GROUP BY n.n_name
ORDER BY COUNT(c.c_custkey) DESC
LIMIT 1;
```
-------------------------6712 sample_num
```sql
SELECT COUNT(*) 
FROM orders o 
JOIN lineitem l ON o.o_orderkey = l.l_orderkey 
WHERE o.o_orderpriority = '1-URGENT' 
AND DATEDIFF(l.l_shipdate, o.o_orderdate) = 1;
```
-------------------------6713 sample_num
```sql
SELECT COUNT(*) 
FROM customer c 
JOIN nation n ON c.c_nationkey = n.n_nationkey 
WHERE c.acctbal < 0 AND c.c_mktsegment = 'HOUSEHOLD' AND n.n_name = 'RUSSIA';
```
-------------------------6714 sample_num
```sql
SELECT COUNT(*) 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
WHERE n.n_name = 'JAPAN';
```
-------------------------6715 sample_num
```sql
SELECT COUNT(*) 
FROM orders 
WHERE o_orderpriority = '3-MEDIUM' 
AND o_orderkey IN (SELECT l_orderkey FROM lineitem WHERE l_shipmode = 'SHIP');
```
-------------------------6716 sample_num
```sql
SELECT c_mktsegment
FROM customer c
JOIN nation n ON c.c_nationkey = n.n_nationkey
WHERE n.n_name = 'UNITED STATES'
GROUP BY c_mktsegment
ORDER BY COUNT(c.c_custkey) DESC
LIMIT 1;
```
-------------------------6717 sample_num
```sql
SELECT n_name 
FROM nation 
JOIN region ON nation.n_regionkey = region.r_regionkey 
WHERE region.r_name = 'ASIA';
```
-------------------------6718 sample_num
```sql
SELECT p.p_name 
FROM part p 
JOIN partsupp ps ON p.p_partkey = ps.ps_partkey 
WHERE p.p_mfgr = 'Manufacturer#3' AND ps.ps_supplycost = 1000;
```
-------------------------6719 sample_num
```sql
SELECT COUNT(DISTINCT n_nationkey) 
FROM nation 
JOIN region ON nation.n_regionkey = region.r_regionkey 
WHERE region.r_comment = 'asymptotes sublate after the r';
```
-------------------------6720 sample_num
```sql
SELECT COUNT(*) 
FROM part 
JOIN lineitem ON part.p_partkey = lineitem.l_partkey 
WHERE part.p_mfgr = 'Manufacturer#5' 
  AND part.p_retailprice < 1000 
  AND lineitem.l_shipmode = 'RAIL';
```
-------------------------6721 sample_num
```sql
SELECT SUM(SUBTRACT(MULTIPLY(l_extendedprice, (SUBTRACT(1, l_discount))), l_quantity) - (MULTIPLY(ps_supplycost, l_quantity))) AS profit
FROM lineitem
JOIN part ON lineitem.l_partkey = part.p_partkey
JOIN partsupp ON lineitem.l_suppkey = partsupp.ps_suppkey
WHERE part.p_name = 'smoke turquoise purple blue salmon'
  AND lineitem.l_receiptdate = '1996-05-07'
  AND lineitem.l_shipinstruct = 'DELIVER IN PERSON';
```
-------------------------6722 sample_num
```sql
SELECT AVG(l_extendedprice) AS avg_price_before_discount
FROM lineitem
WHERE l_orderkey IN (
    SELECT o_orderkey
    FROM orders
    ORDER BY o_totalprice DESC
    LIMIT 10
);
```
-------------------------6723 sample_num
```sql
SELECT c.c_name, 
       COUNT(o.o_orderkey) AS order_count, 
       AVG(o.o_totalprice) AS avg_total_price
FROM customer c
JOIN orders o ON c.c_custkey = o.o_custkey
GROUP BY c.c_name
ORDER BY order_count DESC
LIMIT 3;
```
-------------------------6724 sample_num
```sql
SELECT COUNT(l_linenumber) 
FROM lineitem 
WHERE l_shipdate = '1993-12-04';
```
-------------------------6725 sample_num
```sql
SELECT o_orderdate 
FROM orders 
WHERE o_totalprice = (SELECT MAX(o_totalprice) FROM orders);
```
-------------------------6726 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c_acctbal < 0 THEN 1 END) * 100.0 / COUNT(c_custkey)) AS percentage
FROM 
    customer;
```
-------------------------6727 sample_num
```sql
SELECT COUNT(*) AS nearly_out_of_stock_count
FROM partsupp
WHERE ps_availqty < 10;
```
-------------------------6728 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p_mfgr = 'Manufacturer#3' THEN p_partkey END) * 100.0 / COUNT(p_partkey)) AS percentage
FROM 
    part;
```
-------------------------6729 sample_num
```sql
SELECT p_name 
FROM part 
WHERE p_type = 'MEDIUM PLATED BRASS' 
LIMIT 5;
```
-------------------------6730 sample_num
```sql
SELECT COUNT(DISTINCT o.o_orderkey) AS urgent_orders
FROM orders o
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE l.l_shipdate LIKE '1998-11-%' AND l.l_shipmode = 'AIR' AND o.o_orderpriority = '1-URGENT';
```
-------------------------6731 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE c_nationkey = (SELECT n_nationkey FROM nation WHERE n_name = 'INDIA');
```
-------------------------6732 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE c_nationkey = (SELECT n_nationkey FROM nation WHERE n_name = 'MOROCCO') 
AND c_acctbal < 0;
```
-------------------------6733 sample_num
```sql
SELECT n_nationkey, n_name 
FROM nation 
WHERE n_regionkey = (SELECT r_regionkey FROM region WHERE r_name = 'Africa');
```
-------------------------6734 sample_num
```sql
SELECT SUM(o_totalprice) AS total_price
FROM orders
WHERE o_custkey = (SELECT c_custkey FROM customer WHERE c_name = 'Customer#000000013');
```
-------------------------6735 sample_num
```sql
SELECT COUNT(l.l_linenumber) AS total_items, 
       SUM(l.l_extendedprice * (1 - l.l_discount) * (1 + l.l_tax)) AS total_charges
FROM customer c
JOIN orders o ON c.c_custkey = o.o_custkey
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE c.c_name = 'Customer#000021159';
```
-------------------------6736 sample_num
```sql
SELECT SUM(l_extendedprice * (1 - l_discount) - (ps_supplycost * l_quantity)) AS total_profit
FROM lineitem
JOIN part ON lineitem.l_partkey = part.p_partkey
JOIN partsupp ON lineitem.l_suppkey = partsupp.ps_suppkey
WHERE part.p_name = 'chocolate floral blue coral cyan';
```
-------------------------6737 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN n.n_name = 'GERMANY' THEN s.s_suppkey END) * 100.0 / COUNT(s.s_suppkey)) AS percentage
FROM 
    supplier s
JOIN 
    nation n ON s.s_nationkey = n.n_nationkey;
```
-------------------------6738 sample_num
```sql
SELECT s_name 
FROM supplier s 
JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey 
JOIN part p ON ps.ps_partkey = p.p_partkey 
WHERE p.p_name = 'smoke red pale saddle plum';
```
-------------------------6739 sample_num
```sql
SELECT COUNT(*) 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
JOIN region r ON n.n_regionkey = r.r_regionkey 
WHERE r.r_name = 'MIDDLE EAST' AND s.s_acctbal < 0;
```
-------------------------6740 sample_num
```sql
SELECT p.p_name
FROM lineitem l
JOIN part p ON l.l_partkey = p.p_partkey
WHERE l.l_shipmode = 'RAIL' AND l.l_shipdate = '1995-12-01' AND l.l_discount = 0.1;
```
-------------------------6741 sample_num
```sql
SELECT p.p_name
FROM part p
JOIN partsupp ps ON p.p_partkey = ps.ps_partkey
JOIN supplier s ON ps.ps_suppkey = s.s_suppkey
WHERE s.s_name = 'Supplier#000000018' AND ps.ps_supplycost > 900;
```
-------------------------6742 sample_num
```sql
SELECT COUNT(DISTINCT o.o_orderkey) AS orders_shipped_1994
FROM orders o
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE YEAR(l.l_shipdate) = 1994;
```
-------------------------6743 sample_num
```sql
SELECT COUNT(*) 
FROM lineitem 
WHERE l_shipmode = 'RAIL' AND l_quantity < 30;
```
-------------------------6744 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE c_mktsegment = 'FURNITURE' AND c_nationkey = 1;
```
-------------------------6745 sample_num
```sql
SELECT c_phone 
FROM customer 
WHERE c_acctbal = (SELECT MAX(c_acctbal) FROM customer);
```
-------------------------6746 sample_num
```sql
SELECT o_orderpriority 
FROM orders 
WHERE o_totalprice = (SELECT MAX(o_totalprice) FROM orders);
```
-------------------------6747 sample_num
```sql
SELECT COUNT(*) AS total_orders
FROM orders o
JOIN customer c ON o.o_custkey = c.c_custkey
JOIN nation n ON c.c_nationkey = n.n_nationkey
WHERE n.n_name = 'UNITED STATES';
```
-------------------------6748 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE c_nationkey = (SELECT n_nationkey FROM nation WHERE n_name = 'BRAZIL') 
AND c_mktsegment = 'automobile';
```
-------------------------6749 sample_num
```sql
SELECT o_comment 
FROM orders 
JOIN customer ON orders.o_custkey = customer.c_custkey 
WHERE customer.c_mktsegment = 'Furniture' 
LIMIT 5;
```
-------------------------6750 sample_num
```sql
SELECT n_name 
FROM nation 
WHERE n_regionkey = (SELECT r_regionkey FROM region WHERE r_name = 'ASIA');
```
-------------------------6751 sample_num
```sql
SELECT n_name 
FROM nation n 
JOIN region r ON n.n_regionkey = r.r_regionkey 
WHERE r.r_comment = 'furiously express accounts wake sly';
```
-------------------------6752 sample_num
```sql
SELECT COUNT(*) AS total_suppliers
FROM supplier s
JOIN nation n ON s.s_nationkey = n.n_nationkey
WHERE n.n_name = 'GERMANY';
```
-------------------------6753 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE c_nationkey IN (SELECT n_nationkey FROM nation WHERE n_name IN (SELECT r_regionkey FROM region WHERE r_name = 'ASIA')) 
AND c_acctbal < 0;
```
-------------------------6754 sample_num
```sql
SELECT c_phone 
FROM customer 
WHERE c_custkey = (
    SELECT o_custkey 
    FROM orders 
    ORDER BY o_totalprice DESC 
    LIMIT 1
);
```
-------------------------6755 sample_num
```sql
SELECT COUNT(DISTINCT l.l_partkey) AS product_count
FROM lineitem l
JOIN part p ON l.l_partkey = p.p_partkey
WHERE p.p_retailprice > 1000 AND l.l_shipmode = 'SHIP';
```
-------------------------6756 sample_num
```sql
SELECT c.c_name, c.c_mktsegment
FROM customer c
JOIN orders o ON c.c_custkey = o.o_custkey
WHERE o.o_totalprice = 199180.63;
```
-------------------------6757 sample_num
```sql
SELECT n.n_name AS nation, r.r_name AS region
FROM customer c
JOIN nation n ON c.c_nationkey = n.n_nationkey
JOIN region r ON n.n_regionkey = r.r_regionkey
WHERE c.c_address = 'wH55UnX7 VI';
```
-------------------------6758 sample_num
```sql
SELECT COUNT(*) 
FROM customer c 
JOIN nation n ON c.c_nationkey = n.n_nationkey 
WHERE n.n_name = 'BRAZIL' AND c.c_acctbal < 1000;
```
-------------------------6759 sample_num
```sql
SELECT n.n_name
FROM customer c
JOIN nation n ON c.c_nationkey = n.n_nationkey
WHERE c.c_mktsegment = 'BUILDING' 
AND c.c_acctbal > (SELECT AVG(c_acctbal) * 0.8 FROM customer);
```
-------------------------6760 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN n.n_name = 'United States' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    customer c
JOIN 
    nation n ON c.c_nationkey = n.n_nationkey
WHERE 
    c.c_acctbal < 4000;
```
-------------------------6761 sample_num
```sql
SELECT c_name, c_phone 
FROM customer 
WHERE c_acctbal > 9000;
```
-------------------------6762 sample_num
```sql
SELECT AVG(l_quantity) AS average_items_shipped
FROM lineitem
WHERE l_shipdate BETWEEN '1994-04-01' AND '1994-04-30';
```
-------------------------6763 sample_num
```sql
SELECT o_orderkey 
FROM orders 
WHERE o_totalprice BETWEEN 200000 AND 300000;
```
-------------------------6764 sample_num
```sql
SELECT p_partkey 
FROM part 
WHERE p_retailprice > (SELECT AVG(p_retailprice) FROM part);
```
-------------------------6765 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN ps_supplycost > 500 THEN 1 END) * 100.0 / COUNT(ps_suppkey)) AS percentage
FROM 
    partsupp;
```
-------------------------6766 sample_num
```sql
SELECT s_suppkey, s_acctbal
FROM supplier
ORDER BY s_acctbal DESC
LIMIT 10;
```
-------------------------6767 sample_num
```sql
SELECT COUNT(DISTINCT o.o_custkey) AS customer_count
FROM orders o
JOIN customer c ON o.o_custkey = c.c_custkey
WHERE c.c_acctbal > 0 AND o.o_orderpriority = '1-URGENT';
```
-------------------------6768 sample_num
```sql
SELECT c_name, c_phone 
FROM customer 
WHERE c_nationkey = (SELECT n_nationkey FROM nation WHERE n_name = 'INDIA') 
AND c_acctbal > (SELECT AVG(c_acctbal) FROM customer);
```
-------------------------6769 sample_num
```sql
SELECT p.p_partkey, p.p_name, ps.ps_supplycost
FROM partsupp ps
JOIN part p ON ps.ps_partkey = p.p_partkey
JOIN supplier s ON ps.ps_suppkey = s.s_suppkey
WHERE s.s_name = 'Supplier#000000654'
ORDER BY ps.ps_supplycost DESC
LIMIT 5;
```
-------------------------6770 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c_mktsegment = 'AUTOMOBILE' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    customer c
JOIN 
    nation n ON c.c_nationkey = n.n_nationkey
WHERE 
    n.n_name = 'FRANCE';
```
-------------------------6771 sample_num
```sql
SELECT p.p_name
FROM part p
JOIN lineitem l ON p.p_partkey = l.l_partkey
JOIN partsupp ps ON p.p_partkey = ps.ps_partkey
GROUP BY p.p_name
ORDER BY SUM(l.l_extendedprice * (1 - l.l_discount) - ps.ps_supplycost * l.l_quantity) DESC
LIMIT 1;
```
-------------------------6772 sample_num
```sql
SELECT n.n_name
FROM nation n
JOIN customer c ON n.n_nationkey = c.c_nationkey
GROUP BY n.n_name
HAVING COUNT(c.c_name) < (SELECT AVG(customer_count) 
                           FROM (SELECT COUNT(c_name) AS customer_count 
                                 FROM customer 
                                 GROUP BY c_nationkey) AS avg_counts)
ORDER BY COUNT(c.c_name) ASC;
```
-------------------------6773 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c_mktsegment = 'HOUSEHOLD' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    customer c
JOIN 
    nation n ON c.c_nationkey = n.n_nationkey
JOIN 
    region r ON n.n_regionkey = r.r_regionkey
WHERE 
    r.r_name = 'AFRICA';
```
-------------------------6774 sample_num
```sql
SELECT p_name
FROM part p
JOIN partsupp ps ON p.p_partkey = ps.ps_partkey
ORDER BY ps.ps_availqty DESC
LIMIT 10;
```
-------------------------6775 sample_num
```sql
SELECT 
    (AVG(CASE WHEN l_shipmode = 'SHIP' THEN p.p_retailprice END) - 
     AVG(CASE WHEN l_shipmode = 'AIR' THEN p.p_retailprice END)) AS price_difference
FROM 
    lineitem l
JOIN 
    part p ON l.l_partkey = p.p_partkey;
```
-------------------------6776 sample_num
```sql
SELECT AVG(l_discount) AS average_discount
FROM lineitem l
JOIN part p ON l.l_partkey = p.p_partkey
WHERE p.p_mfgr = 'Manufacturer#5';
```
-------------------------6777 sample_num
```sql
SELECT COUNT(DISTINCT l.l_partkey) AS medium_priority_parts
FROM lineitem l
JOIN orders o ON l.l_orderkey = o.o_orderkey
WHERE l.l_shipmode = 'RAIL' AND o.o_orderpriority = '3-MEDIUM';
```
-------------------------6778 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN s_acctbal < avg_acctbal THEN 1 END) * 100.0 / COUNT(s_suppkey)) AS percentage
FROM 
    supplier s
JOIN 
    nation n ON s.s_nationkey = n.n_nationkey
JOIN 
    region r ON n.n_regionkey = r.r_regionkey,
    (SELECT AVG(s_acctbal) AS avg_acctbal 
     FROM supplier s
     JOIN nation n ON s.s_nationkey = n.n_nationkey
     JOIN region r ON n.n_regionkey = r.r_regionkey
     WHERE r.r_name = 'EUROPE') AS avg_table
WHERE 
    r.r_name = 'EUROPE';
```
-------------------------6779 sample_num
```sql
SELECT 
    (AVG(CASE WHEN YEAR(o.o_orderdate) = 1995 THEN l.l_orderkey END) - 
     AVG(CASE WHEN YEAR(o.o_orderdate) = 1996 THEN l.l_orderkey END)) AS avg_low_priority_diff
FROM 
    lineitem l
JOIN 
    orders o ON l.l_orderkey = o.o_orderkey
WHERE 
    o.o_orderpriority = '5-LOW' AND 
    YEAR(l.l_shipdate) IN (1995, 1996) AND 
    l.l_shipmode = 'TRUCK';
```
-------------------------6780 sample_num
```sql
SELECT c_custkey FROM customer WHERE c_acctbal < 0;
```
-------------------------6781 sample_num
```sql
SELECT l_orderkey, l_partkey, (l_extendedprice * (1 - l_discount)) AS price_after_discount
FROM lineitem
ORDER BY l_orderkey, price_after_discount
LIMIT 3;
```
-------------------------6782 sample_num
```sql
SELECT COUNT(DISTINCT l_orderkey) 
FROM lineitem 
WHERE l_returnflag = 'R' AND l_quantity > 10;
```
-------------------------6783 sample_num
```sql
SELECT SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS total_price
FROM lineitem
WHERE l_shipmode = 'AIR' AND l_shipinstruct = 'NONE';
```
-------------------------6784 sample_num
```sql
SELECT COUNT(*) 
FROM orders o1 
WHERE o1.o_orderpriority <> '1-URGENT' 
AND o1.o_orderdate = (SELECT MAX(o2.o_orderdate) 
                       FROM orders o2 
                       WHERE o2.o_orderpriority <> '1-URGENT') 
AND EXISTS (SELECT 1 
            FROM orders o3 
            WHERE o3.o_orderkey = o1.o_orderkey 
            AND o3.o_orderpriority = '1-URGENT');
```
-------------------------6785 sample_num
```sql
SELECT COUNT(*) 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
WHERE n.n_name = 'EGYPT' AND s.s_acctbal < 0;
```
-------------------------6786 sample_num
```sql
SELECT COUNT(l.l_linenumber) 
FROM lineitem l 
JOIN orders o ON l.l_orderkey = o.o_orderkey 
WHERE l.l_shipmode = 'REG AIR' AND o.o_orderdate = '1995-03-22';
```
-------------------------6787 sample_num
```sql
SELECT COUNT(*) 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
JOIN region r ON n.n_regionkey = r.r_regionkey 
WHERE r.r_name = 'EUROPE';
```
-------------------------6788 sample_num
```sql
SELECT c.c_mktsegment
FROM customer c
JOIN orders o ON c.c_custkey = o.o_custkey
WHERE o.o_orderdate BETWEEN '1994-04-01' AND '1994-04-30'
GROUP BY c.c_custkey, c.c_mktsegment
ORDER BY COUNT(o.o_orderkey) DESC
LIMIT 1;
```
-------------------------6789 sample_num
```sql
SELECT p.p_name
FROM part p
JOIN partsupp ps ON p.p_partkey = ps.ps_partkey
JOIN supplier s ON ps.ps_suppkey = s.s_suppkey
WHERE s.s_name = 'Supplier#000000034';
```
-------------------------6790 sample_num
```sql
SELECT ps_supplycost 
FROM partsupp 
JOIN part ON partsupp.ps_partkey = part.p_partkey 
WHERE part.p_type = 'LARGE BURNISHED COPPER';
```
-------------------------6791 sample_num
```sql
SELECT COUNT(DISTINCT c.c_custkey) 
FROM customer c 
JOIN orders o ON c.c_custkey = o.o_custkey 
JOIN nation n ON c.c_nationkey = n.n_nationkey 
WHERE n.n_name = 'MOZAMBIQUE' AND o.o_orderpriority = '5-LOW';
```
-------------------------6792 sample_num
```sql
SELECT p.p_name
FROM part p
JOIN partsupp ps ON p.p_partkey = ps.ps_partkey
WHERE ps.ps_availqty < 10
ORDER BY ps.ps_supplycost ASC
LIMIT 1;
```
-------------------------6793 sample_num
```sql
SELECT COUNT(DISTINCT o_clerk) 
FROM orders 
WHERE o_custkey IN (
    SELECT c_custkey 
    FROM customer 
    WHERE c_address = 'uFTe2u518et8Q8UC'
);
```
-------------------------6794 sample_num
```sql
SELECT DISTINCT p.p_name
FROM part p
JOIN lineitem l ON p.p_partkey = l.l_partkey
WHERE l.l_discount = 0.0000;
```
-------------------------6795 sample_num
```sql
SELECT COUNT(*) 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
WHERE n.n_name = 'GERMANY' AND s.s_comment LIKE 'carefully regular packages%';
```
-------------------------6796 sample_num
```sql
SELECT COUNT(*) 
FROM lineitem l 
JOIN orders o ON l.l_orderkey = o.o_orderkey 
WHERE l.l_shipdate = '1994-11-19' AND o.o_orderdate = '1994-09-21';
```
-------------------------6797 sample_num
```sql
SELECT AVG((SUM(l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity)) / COUNT(ps_partkey)) AS average_profit
FROM lineitem
JOIN partsupp ON lineitem.l_partkey = partsupp.ps_partkey
JOIN part ON partsupp.ps_partkey = part.p_partkey
WHERE part.p_type = 'PROMO BRUSHED STEEL';
```
-------------------------6798 sample_num
```sql
SELECT (COUNT(CASE WHEN n.n_name = 'IRAN' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM customer c
JOIN nation n ON c.c_nationkey = n.n_nationkey
WHERE c.c_mktsegment = 'HOUSEHOLD';
```
-------------------------6799 sample_num
```sql
SELECT c_mktsegment, c_name, c_address, c_phone 
FROM customer 
WHERE c_custkey = 3;
```
-------------------------6800 sample_num
```sql
SELECT l_linenumber 
FROM lineitem 
WHERE l_discount = 0.1 
LIMIT 3;
```
-------------------------6801 sample_num
```sql
SELECT COUNT(*) 
FROM lineitem 
WHERE l_quantity > 40 AND l_shipmode = 'AIR';
```
-------------------------6802 sample_num
```sql
SELECT l_shipmode, COUNT(*) AS instruction_count
FROM lineitem
WHERE l_shipinstruct = 'DELIVER IN PERSON' AND l_shipmode IN ('RAIL', 'MAIL')
GROUP BY l_shipmode
ORDER BY instruction_count DESC
LIMIT 1;
```
-------------------------6803 sample_num
```sql
SELECT o_totalprice, o_orderpriority 
FROM orders 
WHERE o_orderkey = 33;
```
-------------------------6804 sample_num
```sql
SELECT COUNT(*) 
FROM orders 
WHERE YEAR(o_orderdate) = 1998 AND o_totalprice < 950;
```
-------------------------6805 sample_num
```sql
SELECT c_name 
FROM customer 
WHERE c_acctbal < 0 
LIMIT 3;
```
-------------------------6806 sample_num
```sql
SELECT l_extendedprice * (1 - l_discount) AS discounted_price
FROM lineitem
WHERE l_linenumber = 1;
```
-------------------------6807 sample_num
```sql
SELECT 
    COUNT(CASE WHEN l_returnflag IN ('A', 'N') THEN l_linenumber END) - 
    COUNT(CASE WHEN l_returnflag = 'R' THEN l_linenumber END) AS difference
FROM 
    lineitem
WHERE 
    l_extendedprice < 16947.7;
```
-------------------------6808 sample_num
```sql
SELECT ps_supplycost 
FROM partsupp 
JOIN part ON partsupp.ps_partkey = part.p_partkey 
WHERE part.p_type = 'large plated tin';
```
-------------------------6809 sample_num
```sql
SELECT p_name 
FROM part 
JOIN partsupp ON part.p_partkey = partsupp.ps_partkey 
WHERE ps_availqty > 9998 
LIMIT 3;
```
-------------------------6810 sample_num
```sql
SELECT p.p_name
FROM part p
JOIN partsupp ps ON p.p_partkey = ps.ps_partkey
WHERE p.p_container = 'WRAP BAG' AND ps.ps_supplycost < 10
LIMIT 2;
```
-------------------------6811 sample_num
```sql
SELECT n.n_name 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
WHERE s.s_suppkey = 1;
```
-------------------------6812 sample_num
```sql
SELECT n_name 
FROM nation 
WHERE n_regionkey = (SELECT r_regionkey FROM region WHERE r_name = 'Africa');
```
-------------------------6813 sample_num
```sql
SELECT r.r_name
FROM region r
JOIN nation n ON r.r_regionkey = n.n_regionkey
GROUP BY r.r_name
ORDER BY COUNT(n.n_nationkey) ASC
LIMIT 1;
```
-------------------------6814 sample_num
```sql
SELECT COUNT(*) 
FROM customer c 
JOIN nation n ON c.c_nationkey = n.n_nationkey 
WHERE c.c_mktsegment = 'FURNITURE' AND n.n_name = 'Iraq';
```
-------------------------6815 sample_num
```sql
SELECT c.c_name 
FROM customer c 
JOIN orders o ON c.c_custkey = o.o_custkey 
WHERE c.c_custkey = 93697 AND o.o_totalprice = 191918.92;
```
-------------------------6816 sample_num
```sql
SELECT n.n_name, r.r_name
FROM customer c
JOIN nation n ON c.c_nationkey = n.n_nationkey
JOIN region r ON n.n_regionkey = r.r_regionkey
WHERE c.c_name = 'Customer#000000008';
```
-------------------------6817 sample_num
```sql
SELECT 
    DATEDIFF(l_receiptdate, l_commitdate) AS delivery_time, 
    o_clerk 
FROM 
    orders 
JOIN 
    lineitem ON orders.o_orderkey = lineitem.l_orderkey 
WHERE 
    orders.o_orderkey = 6;
```
-------------------------6818 sample_num
```sql
SELECT COUNT(*) 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
WHERE n.n_name = 'Japan' AND s.s_acctbal < 0;
```
-------------------------6819 sample_num
```sql
SELECT c_name 
FROM customer 
ORDER BY c_acctbal ASC 
LIMIT 1;
```
-------------------------6820 sample_num
```sql
SELECT o_orderdate 
FROM orders 
WHERE o_orderpriority = '1-URGENT';
```
-------------------------6821 sample_num
```sql
SELECT COUNT(*) 
FROM lineitem 
WHERE l_shipinstruct = 'DELIVER IN PERSON';
```
-------------------------6822 sample_num
```sql
SELECT MAX(s_acctbal) AS largest_supplier_account_balance FROM supplier;
```
-------------------------6823 sample_num
```sql
SELECT COUNT(*) AS close_to_out_of_stock
FROM partsupp
WHERE ps_availqty < 10;
```
-------------------------6824 sample_num
```sql
SELECT n_name 
FROM nation 
WHERE n_regionkey = (SELECT r_regionkey FROM region WHERE r_name = 'EUROPE');
```
-------------------------6825 sample_num
```sql
SELECT ps_supplycost 
FROM partsupp 
JOIN part ON partsupp.ps_partkey = part.p_partkey 
WHERE part.p_name = 'violet olive rose ivory sandy';
```
-------------------------6826 sample_num
```sql
SELECT c_phone 
FROM customer 
WHERE c_nationkey = (SELECT n_nationkey FROM nation WHERE n_name = 'Ethiopia');
```
-------------------------6827 sample_num
```sql
SELECT SUM(o_totalprice) AS total_price
FROM orders
WHERE o_custkey = (SELECT c_custkey FROM customer WHERE c_phone = '627-220-3983');
```
-------------------------6828 sample_num
```sql
SELECT DISTINCT l_shipmode 
FROM lineitem 
JOIN orders ON lineitem.l_orderkey = orders.o_orderkey 
WHERE orders.o_orderdate = '1994-12-31';
```
-------------------------6829 sample_num
```sql
SELECT s_acctbal 
FROM supplier 
WHERE s_suppkey = (
    SELECT ps_suppkey 
    FROM partsupp 
    GROUP BY ps_suppkey 
    ORDER BY COUNT(ps_partkey) DESC 
    LIMIT 1
);
```
-------------------------6830 sample_num
```sql
SELECT n.n_name 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
WHERE s.s_acctbal = 4393.04;
```
-------------------------6831 sample_num
```sql
SELECT r.r_name
FROM region r
JOIN nation n ON r.r_regionkey = n.n_regionkey
JOIN customer c ON n.n_nationkey = c.c_nationkey
GROUP BY r.r_name
ORDER BY COUNT(c.c_custkey) DESC
LIMIT 1;
```
-------------------------6832 sample_num
```sql
SELECT DISTINCT c_phone 
FROM customer 
JOIN orders ON customer.c_custkey = orders.o_custkey 
WHERE orders.o_totalprice > 300000;
```
-------------------------6833 sample_num
```sql
SELECT DISTINCT o.o_clerk
FROM orders o
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE l.l_shipmode = 'MAIL';
```
-------------------------6834 sample_num
```sql
SELECT n.n_name
FROM supplier s
JOIN nation n ON s.s_nationkey = n.n_nationkey
ORDER BY s.s_acctbal ASC
LIMIT 5;
```
-------------------------6835 sample_num
```sql
SELECT s_address 
FROM supplier 
WHERE s_suppkey IN (
    SELECT ps_suppkey 
    FROM partsupp 
    WHERE ps_partkey IN (
        SELECT p_partkey 
        FROM part 
        WHERE p_size = (SELECT MAX(p_size) FROM part)
    )
);
```
-------------------------6836 sample_num
```sql
SELECT p.p_name, s.s_name, MAX(l.l_extendedprice * (1 - l.l_discount) - (ps.ps_supplycost * l.l_quantity)) AS profit
FROM lineitem l
JOIN partsupp ps ON l.l_partkey = ps.ps_partkey
JOIN part p ON ps.ps_partkey = p.p_partkey
JOIN supplier s ON ps.ps_suppkey = s.s_suppkey
GROUP BY p.p_name, s.s_name
ORDER BY profit DESC
LIMIT 1;
```
-------------------------6837 sample_num
```sql
SELECT (COUNT(s.s_suppkey) FILTER (WHERE n.n_name = 'ASIA') * 100.0 / COUNT(s.s_suppkey)) AS proportion
FROM supplier s
JOIN nation n ON s.s_nationkey = n.n_nationkey;
```
-------------------------6838 sample_num
```sql
SELECT o_totalprice FROM orders WHERE o_orderkey = 32;
```
-------------------------6839 sample_num
```sql
SELECT COUNT(DISTINCT l_orderkey) AS order_keys_not_discounted
FROM lineitem
WHERE l_discount = 0;
```
-------------------------6840 sample_num
```sql
SELECT *
FROM lineitem
WHERE l_shipmode = 'truck' AND YEAR(l_shipdate) < 1997;
```
-------------------------6841 sample_num
```sql
SELECT COUNT(*) 
FROM lineitem 
WHERE l_returnflag = 'R' AND YEAR(l_shipdate) = 1998;
```
-------------------------6842 sample_num
```sql
SELECT l_linenumber, l_quantity 
FROM lineitem 
WHERE l_shipmode = 'AIR' 
ORDER BY l_quantity DESC 
LIMIT 1;
```
-------------------------6843 sample_num
```sql
SELECT c_name 
FROM customer 
WHERE c_acctbal < 0;
```
-------------------------6844 sample_num
```sql
SELECT COUNT(*) 
FROM customer c 
JOIN nation n ON c.c_nationkey = n.n_nationkey 
WHERE c.c_mktsegment = 'household' AND n.n_name = 'Germany';
```
-------------------------6845 sample_num
```sql
SELECT c.c_phone
FROM customer c
JOIN orders o ON c.c_custkey = o.o_custkey
WHERE o.o_orderpriority = '1-URGENT';
```
-------------------------6846 sample_num
```sql
SELECT c.c_name
FROM customer c
JOIN orders o ON c.c_custkey = o.o_custkey
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE l.l_discount = (SELECT MAX(l_discount) FROM lineitem);
```
-------------------------6847 sample_num
```sql
SELECT o.o_orderkey, o.o_totalprice, l.l_shipdate
FROM orders o
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
ORDER BY o.o_totalprice DESC
LIMIT 5;
```
-------------------------6848 sample_num
```sql
SELECT o_comment 
FROM orders 
JOIN customer ON orders.o_custkey = customer.c_custkey 
WHERE customer.c_mktsegment = 'FURNITURE';
```
-------------------------6849 sample_num
```sql
SELECT c_name 
FROM customer 
JOIN orders ON customer.c_custkey = orders.o_custkey 
WHERE orders.o_totalprice > 300000;
```
-------------------------6850 sample_num
```sql
SELECT c.c_name 
FROM customer c 
JOIN nation n ON c.c_nationkey = n.n_nationkey 
WHERE n.n_name = 'INDIA' AND c.c_acctbal > 5000;
```
-------------------------6851 sample_num
```sql
SELECT s_phone 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
WHERE n.n_name = 'JAPAN';
```
-------------------------6852 sample_num
```sql
SELECT s_name 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
WHERE n.n_name = 'ARGENTINA' AND s.s_acctbal < 0;
```
-------------------------6853 sample_num
```sql
SELECT COUNT(DISTINCT n.n_nationkey) AS country_count
FROM nation n
JOIN region r ON n.n_regionkey = r.r_regionkey
WHERE r.r_name = 'ALGERIA';
```
-------------------------6854 sample_num
```sql
SELECT DISTINCT c.c_name
FROM customer c
JOIN orders o ON c.c_custkey = o.o_custkey
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE l.l_discount = 0.1 
AND (o.o_orderdate BETWEEN '1994-01-01' AND '1995-01-01');
```
-------------------------6855 sample_num
```sql
SELECT (COUNT(n.n_name) FILTER (WHERE r.r_name = 'America') * 100.0 / COUNT(n.n_name)) AS percentage
FROM nation n
JOIN region r ON n.n_regionkey = r.r_regionkey;
```
-------------------------6856 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c_mktsegment = 'HOUSEHOLD' THEN 1 END) * 100.0 / COUNT(*)) AS household_percentage
FROM 
    customer c
JOIN 
    nation n ON c.c_nationkey = n.n_nationkey
WHERE 
    n.n_name = 'Indonesia';
```
-------------------------6857 sample_num
```sql
SELECT p_name 
FROM part 
WHERE p_type = 'PROMO BRUSHED STEEL';
```
-------------------------6858 sample_num
```sql
SELECT p_comment 
FROM part 
WHERE p_name = 'burlywood plum powder puff mint';
```
-------------------------6859 sample_num
```sql
SELECT COUNT(*) 
FROM part 
WHERE p_retailprice > 1900;
```
-------------------------6860 sample_num
```sql
SELECT COUNT(*) 
FROM part 
WHERE p_type = 'PROMO BRUSHED STEEL' AND p_mfgr = 'Manufacturer#5';
```
-------------------------6861 sample_num
```sql
SELECT DISTINCT p_brand 
FROM part 
WHERE p_type = 'PROMO BRUSHED STEEL';
```
-------------------------6862 sample_num
```sql
SELECT p_name 
FROM part 
ORDER BY p_retailprice DESC 
LIMIT 1;
```
-------------------------6863 sample_num
```sql
SELECT p_name, p_size
FROM part
WHERE p_name IN ('pink powder drab lawn cyan', 'cornflower sky burlywood green beige')
ORDER BY p_size DESC
LIMIT 1;
```
-------------------------6864 sample_num
```sql
SELECT COUNT(*) 
FROM part 
WHERE p_container = 'JUMBO CASE';
```
-------------------------6865 sample_num
```sql
SELECT MIN(p_size) 
FROM part 
WHERE p_container = 'JUMBO CASE';
```
-------------------------6866 sample_num
```sql
SELECT COUNT(*) FROM supplier WHERE s_acctbal < 0;
```
-------------------------6867 sample_num
```sql
SELECT s_name
FROM supplier
ORDER BY s_acctbal DESC
LIMIT 3;
```
-------------------------6868 sample_num
```sql
SELECT s_phone 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
WHERE n.n_name = 'Germany';
```
-------------------------6869 sample_num
```sql
SELECT s_name 
FROM supplier s 
JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey 
JOIN part p ON ps.ps_partkey = p.p_partkey 
WHERE p.p_name = 'hot spring dodger dim light';
```
-------------------------6870 sample_num
```sql
SELECT MIN(ps_supplycost) 
FROM partsupp 
JOIN part ON partsupp.ps_partkey = part.p_partkey 
WHERE part.p_name = 'hot spring dodger dim light';
```
-------------------------6871 sample_num
```sql
SELECT s.s_name
FROM supplier s
JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey
JOIN part p ON ps.ps_partkey = p.p_partkey
WHERE p.p_name = 'hot spring dodger dim light'
AND ps.ps_supplycost = (
    SELECT MIN(ps_supplycost)
    FROM partsupp
    JOIN part ON partsupp.ps_partkey = part.p_partkey
    WHERE part.p_name = 'hot spring dodger dim light'
);
```
-------------------------6872 sample_num
```sql
SELECT SUM(ps_availqty) AS total_quantity_available
FROM partsupp
JOIN part ON partsupp.ps_partkey = part.p_partkey
WHERE part.p_name = 'hot spring dodger dim light';
```
-------------------------6873 sample_num
```sql
SELECT s.s_phone
FROM supplier s
JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey
JOIN part p ON ps.ps_partkey = p.p_partkey
WHERE p.p_name = 'hot spring dodger dim light'
ORDER BY ps.ps_availqty DESC
LIMIT 1;
```
-------------------------6874 sample_num
```sql
SELECT s_name 
FROM supplier 
WHERE s_suppkey IN (
    SELECT ps_suppkey 
    FROM partsupp 
    WHERE ps_partkey IN (
        SELECT p_partkey 
        FROM part 
        WHERE p_retailprice = (SELECT MAX(p_retailprice) FROM part)
    )
);
```
-------------------------6875 sample_num
```sql
SELECT COUNT(DISTINCT s.s_suppkey) 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey 
JOIN part p ON ps.ps_partkey = p.p_partkey 
WHERE p.p_name = 'hot spring dodger dim light' AND n.n_name = 'VIETNAM';
```
-------------------------6876 sample_num
```sql
SELECT COUNT(DISTINCT s.s_suppkey) 
FROM supplier s 
JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey 
JOIN part p ON ps.ps_partkey = p.p_partkey 
WHERE p.p_type = 'PROMO BRUSHED STEEL' AND s.s_acctbal < 0;
```
-------------------------6877 sample_num
```sql
SELECT DISTINCT s.s_name
FROM supplier s
JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey
JOIN part p ON ps.ps_partkey = p.p_partkey
WHERE p.p_brand = 'Brand#55';
```
-------------------------6878 sample_num
```sql
SELECT COUNT(*) 
FROM part p 
JOIN partsupp ps ON p.p_partkey = ps.ps_partkey 
WHERE p.p_type = 'PROMO BRUSHED STEEL' 
GROUP BY p.p_partkey 
HAVING SUM(ps.ps_availqty) < 5000;
```
-------------------------6879 sample_num
```sql
SELECT COUNT(DISTINCT o.o_orderkey) AS order_count
FROM orders o
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
JOIN part p ON l.l_partkey = p.p_partkey
WHERE p.p_name = 'hot spring dodger dim light';
```
-------------------------6880 sample_num
```sql
SELECT SUM(l.l_quantity) AS total_quantity
FROM lineitem l
JOIN orders o ON l.l_orderkey = o.o_orderkey
JOIN part p ON l.l_partkey = p.p_partkey
WHERE p.p_name = 'hot spring dodger dim light';
```
-------------------------6881 sample_num
```sql
SELECT l_orderkey
FROM lineitem
JOIN part ON lineitem.l_partkey = part.p_partkey
WHERE part.p_container = 'JUMBO CASE'
GROUP BY l_orderkey
HAVING COUNT(lineitem.l_partkey) > 2;
```
-------------------------6882 sample_num
```sql
SELECT COUNT(*) 
FROM supplier s 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
JOIN region r ON n.n_regionkey = r.r_regionkey 
WHERE s.s_acctbal < 0 AND r.r_name = 'EUROPE';
```
-------------------------6883 sample_num
```sql
SELECT COUNT(DISTINCT s.s_suppkey) 
FROM supplier s 
JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey 
JOIN part p ON ps.ps_partkey = p.p_partkey 
JOIN nation n ON s.s_nationkey = n.n_nationkey 
JOIN region r ON n.n_regionkey = r.r_regionkey 
WHERE p.p_name = 'hot spring dodger dim light' AND r.r_name = 'EUROPE';
```
-------------------------6884 sample_num
```sql
SELECT DISTINCT s_phone
FROM supplier s
JOIN lineitem l ON s.s_suppkey = l.l_suppkey
WHERE l.l_orderkey = 1;
```
-------------------------6885 sample_num
```sql
SELECT COUNT(DISTINCT s.s_suppkey) AS in_debt_suppliers
FROM supplier s
JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey
JOIN lineitem l ON ps.ps_partkey = l.l_partkey
WHERE l.l_orderkey = 4 AND s.s_acctbal < 0;
```
-------------------------6886 sample_num
```sql
SELECT COUNT(DISTINCT l.partkey) AS returned_parts_count
FROM lineitem l
JOIN supplier s ON l.suppkey = s.s_suppkey
WHERE l.returnflag = 'R' AND s.acctbal < 0;
```
-------------------------6887 sample_num
```sql
SELECT l_shipdate 
FROM lineitem 
JOIN part ON lineitem.l_partkey = part.p_partkey 
WHERE part.p_name = 'burnished seashell gainsboro navajo chocolate' 
AND lineitem.l_orderkey = 1;
```
-------------------------6888 sample_num
```sql
SELECT l_quantity 
FROM lineitem 
WHERE l_orderkey = 1 AND l_partkey IN (SELECT p_partkey FROM part WHERE p_name = 'burnished seashell gainsboro navajo chocolate');
```
-------------------------6889 sample_num
```sql
SELECT p.p_name, SUM(l.l_quantity) AS total_quantity
FROM lineitem l
JOIN part p ON l.l_partkey = p.p_partkey
WHERE l.l_orderkey = 1 AND p.p_name IN ('salmon white grey tan navy', 'burnished seashell gainsboro navajo chocolate')
GROUP BY p.p_name
ORDER BY total_quantity DESC
LIMIT 1;
```
-------------------------6890 sample_num
```sql
SELECT MAX(l_discount) 
FROM lineitem 
JOIN orders ON lineitem.l_orderkey = orders.o_orderkey 
JOIN part ON lineitem.l_partkey = part.p_partkey 
WHERE part.p_name = 'burnished seashell gainsboro navajo chocolate';
```
-------------------------6891 sample_num
```sql
SELECT DISTINCT l_shipmode 
FROM lineitem 
JOIN part ON lineitem.l_partkey = part.p_partkey 
WHERE part.p_name = 'burnished seashell gainsboro navajo chocolate';
```
-------------------------6892 sample_num
```sql
SELECT AVG(ps_supplycost) AS average_supply_cost
FROM partsupp
JOIN part ON partsupp.ps_partkey = part.p_partkey
WHERE part.p_name = 'hot spring dodger dim light';
```
-------------------------6893 sample_num
```sql
SELECT 
    (MAX(ps_supplycost) - MIN(ps_supplycost)) / MIN(ps_supplycost) * 100 AS percentage_difference
FROM 
    partsupp
WHERE 
    ps_partkey IN (SELECT p_partkey FROM part WHERE p_name = 'hot spring dodger dim light');
```
-------------------------6894 sample_num
```sql
SELECT 
    (l_extendedprice * (1 - l_discount)) - (ps_supplycost * l_quantity) AS profit
FROM 
    lineitem 
JOIN 
    partsupp ON lineitem.l_partkey = partsupp.ps_partkey
WHERE 
    lineitem.l_partkey = 98768 AND lineitem.l_orderkey = 1;
```
-------------------------6895 sample_num
```sql
SELECT l_extendedprice * (1 - l_discount) AS discounted_price
FROM lineitem
JOIN part ON lineitem.l_partkey = part.p_partkey
WHERE part.p_name = 'burnished seashell gainsboro navajo chocolate' AND lineitem.l_orderkey = 1;
```
-------------------------6896 sample_num
```sql
SELECT c_mktsegment 
FROM customer 
WHERE c_acctbal = (SELECT MAX(c_acctbal) FROM customer);
```
-------------------------6897 sample_num
```sql
SELECT COUNT(*) 
FROM lineitem 
WHERE YEAR(l_shipdate) = 1997 AND l_shipmode = 'MAIL';
```
-------------------------6898 sample_num
```sql
SELECT COUNT(*) FROM customer WHERE c_mktsegment = 'FURNITURE';
```
-------------------------6899 sample_num
```sql
SELECT COUNT(*) 
FROM lineitem 
WHERE YEAR(l_shipdate) = 1994 AND l_shipmode = 'TRUCK' AND l_returnflag = 'R';
```
-------------------------6900 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE c_mktsegment = 'MACHINERY' AND c_acctbal < 0;
```
-------------------------6901 sample_num
```sql
SELECT COUNT(*) 
FROM orders 
WHERE o_clerk = 'Clerk#000000001' 
  AND o_orderpriority = '1-URGENT' 
  AND YEAR(o_orderdate) = 1997;
```
-------------------------6902 sample_num
```sql
SELECT c.c_name
FROM customer c
JOIN orders o ON c.c_custkey = o.o_custkey
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE l_receiptdate IS NOT NULL AND l_commitdate IS NOT NULL
ORDER BY DATEDIFF(l_receiptdate, l_commitdate) DESC
LIMIT 1;
```
-------------------------6903 sample_num
```sql
SELECT SUM(o_totalprice) AS total_price
FROM orders o
JOIN customer c ON o.o_custkey = c.c_custkey
JOIN nation n ON c.c_nationkey = n.n_nationkey
WHERE n.n_name = 'Argentina';
```
-------------------------6904 sample_num
```sql
SELECT COUNT(DISTINCT c.c_custkey) 
FROM customer c 
JOIN orders o ON c.c_custkey = o.o_custkey 
WHERE c.c_mktsegment = 'BUILDING' AND o.o_totalprice >= 50000;
```
-------------------------6905 sample_num
```sql
SELECT n.n_name
FROM nation n
JOIN supplier s ON n.n_nationkey = s.s_nationkey
GROUP BY n.n_name
ORDER BY COUNT(s.s_suppkey) ASC
LIMIT 1;
```
-------------------------6906 sample_num
```sql
SELECT ps.ps_supplycost 
FROM partsupp ps 
JOIN part p ON ps.ps_partkey = p.p_partkey 
WHERE p.p_name = 'medium metallic grey dodger linen';
```
-------------------------6907 sample_num
```sql
SELECT n.n_name AS country, COUNT(*) AS indebted_supplier_count
FROM supplier s
JOIN nation n ON s.s_nationkey = n.n_nationkey
WHERE s.s_acctbal < 0
GROUP BY n.n_name
ORDER BY indebted_supplier_count DESC
LIMIT 2;
```
-------------------------6908 sample_num
```sql
SELECT p.p_name
FROM part p
JOIN partsupp ps ON p.p_partkey = ps.ps_partkey
WHERE ps.ps_supplycost >= 1000;
```
-------------------------6909 sample_num
```sql
SELECT n.n_name
FROM supplier s
JOIN nation n ON s.s_nationkey = n.n_nationkey
WHERE s.s_acctbal = (SELECT MIN(s_acctbal) FROM supplier);
```
-------------------------6910 sample_num
```sql
SELECT o.o_clerk
FROM orders o
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE l.l_extendedprice = (SELECT MAX(l_extendedprice) FROM lineitem);
```
-------------------------6911 sample_num
```sql
SELECT SUM(l_quantity) AS total_quantity
FROM orders o
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
WHERE o.o_custkey = 101660 AND o.o_orderdate = '1995-10-05';
```
-------------------------6912 sample_num
```sql
SELECT SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS total_tax
FROM lineitem
JOIN orders ON lineitem.l_orderkey = orders.o_orderkey
WHERE orders.o_custkey = 88931 AND orders.o_orderdate = '1994-07-13';
```
-------------------------6913 sample_num
```sql
SELECT p.p_name
FROM orders o
JOIN lineitem l ON o.o_orderkey = l.l_orderkey
JOIN part p ON l.l_partkey = p.p_partkey
WHERE o.o_custkey = 110942;
```
-------------------------6914 sample_num
```sql
SELECT p.p_name, (l.l_extendedprice * (1 - l.l_discount)) AS discounted_price
FROM lineitem l
JOIN orders o ON l.l_orderkey = o.o_orderkey
JOIN part p ON l.l_partkey = p.p_partkey
WHERE o.o_custkey = 111511 AND o.o_orderkey = 53159;
```
-------------------------6915 sample_num
```sql
SELECT height_in_inch 
FROM PlayerInfo 
JOIN height_info ON PlayerInfo.height = height_info.height_id 
WHERE PlayerName = 'David Bornhammar';
```
-------------------------6916 sample_num
```sql
SELECT PlayerName 
FROM PlayerInfo 
WHERE height > (6 * 12 + 2);
```
-------------------------6917 sample_num
```sql
SELECT COUNT(*) 
FROM PlayerInfo 
WHERE height > (6 * 12 + 2) AND nation = 'Sweden';
```
-------------------------6918 sample_num
```sql
SELECT PlayerName 
FROM PlayerInfo 
WHERE height = (SELECT MAX(height_in_cm) FROM height_info);
```
-------------------------6919 sample_num
```sql
SELECT w.weight_in_kg 
FROM PlayerInfo p 
JOIN weight_info w ON p.weight = w.weight_id 
WHERE p.PlayerName = 'David Bornhammar';
```
-------------------------6920 sample_num
```sql
SELECT COUNT(*) 
FROM PlayerInfo 
JOIN weight_info ON PlayerInfo.weight = weight_info.weight_id 
WHERE weight_info.weight_in_kg > 90;
```
-------------------------6921 sample_num
```sql
SELECT COUNT(*) 
FROM PlayerInfo 
WHERE weight > 90 AND position_info = 'D';
```
-------------------------6922 sample_num
```sql
SELECT PlayerName
FROM PlayerInfo
WHERE weight > 90
ORDER BY sum_7yr_GP DESC
LIMIT 1;
```
-------------------------6923 sample_num
```sql
SELECT w.weight_in_kg
FROM PlayerInfo p
JOIN weight_info w ON p.weight = w.weight_id
WHERE p.sum_7yr_TOI = (
    SELECT MAX(sum_7yr_TOI)
    FROM PlayerInfo
);
```
-------------------------6924 sample_num
```sql
SELECT 
    (SELECT height_in_cm FROM height_info h JOIN PlayerInfo p ON h.height_id = p.height WHERE p.PlayerName = 'David Bornhammar') - 
    (SELECT height_in_cm FROM height_info h JOIN PlayerInfo p ON h.height_id = p.height WHERE p.PlayerName = 'Pauli Levokari') AS height_difference_cm;
```
-------------------------6925 sample_num
```sql
SELECT COUNT(*) 
FROM PlayerInfo 
WHERE shoots = 'R' AND weight > 90;
```
-------------------------6926 sample_num
```sql
SELECT PlayerName 
FROM PlayerInfo 
JOIN weight_info ON PlayerInfo.weight = weight_info.weight_id 
WHERE weight_info.weight_in_kg > 90 AND PlayerInfo.shoots = 'R';
```
-------------------------6927 sample_num
```sql
SELECT 
    P.PlayerName, 
    W.weight_in_kg, 
    H.height_in_cm, 
    (W.weight_in_kg / POWER((H.height_in_cm / 100.0), 2)) AS BMI
FROM 
    PlayerInfo P
JOIN 
    weight_info W ON P.weight = W.weight_id
JOIN 
    height_info H ON P.height = H.height_id
WHERE 
    P.PlayerName = 'David Bornhammar';
```
-------------------------6928 sample_num
```sql
SELECT AVG(h.height_in_cm) AS average_height
FROM PlayerInfo p
JOIN height_info h ON p.height = h.height_id
WHERE p.position_info = 'D';
```
-------------------------6929 sample_num
```sql
SELECT MAX(weight_in_lbs) AS heaviest_player_weight
FROM weight_info;
```
-------------------------6930 sample_num
```sql
SELECT COUNT(*) 
FROM PlayerInfo 
WHERE shoots = 'R' AND height = (SELECT height_id FROM height_info WHERE height_in_inch = '5\'7"');
```
-------------------------6931 sample_num
```sql
SELECT PlayerName
FROM PlayerInfo
WHERE sum_7yr_GP > 500
ORDER BY PIM DESC
LIMIT 1;
```
-------------------------6932 sample_num
```sql
SELECT MAX(h.height_in_cm) 
FROM PlayerInfo p 
JOIN height_info h ON p.height = h.height_id 
WHERE p.birthplace = 'Edmonton, AB, CAN';
```
-------------------------6933 sample_num
```sql
SELECT COUNT(DISTINCT p.ELITEID) 
FROM PlayerInfo p 
JOIN SeasonStatus s ON p.ELITEID = s.ELITEID 
WHERE p.overallby = 'Anaheim Ducks' 
AND p.draftyear = 2008 
AND s.TEAM = 'U.S. National U18 Team';
```
-------------------------6934 sample_num
```sql
SELECT w.weight_in_kg
FROM PlayerInfo p
JOIN SeasonStatus s ON p.ELITEID = s.ELITEID
JOIN weight_info w ON p.weight = w.weight_id
WHERE s.PLUSMINUS = (SELECT MAX(PLUSMINUS) FROM SeasonStatus);
```
-------------------------6935 sample_num
```sql
SELECT ELITEID, MAX(P) AS MaxPoints
FROM SeasonStatus
WHERE LEAGUE = 'QMJHL' AND SEASON = '2004-2005'
GROUP BY ELITEID
ORDER BY MaxPoints DESC
LIMIT 1;
```
-------------------------6936 sample_num
```sql
SELECT DISTINCT p.PlayerName
FROM PlayerInfo p
JOIN SeasonStatus s ON p.ELITEID = s.ELITEID
WHERE s.TEAM = 'Acadie-Bathurst Titan'
  AND s.GAMETYPE = 'Regular Season'
  AND s.SEASON = '1998-1999';
```
-------------------------6937 sample_num
```sql
SELECT SUM(SS.GP) AS TotalGames
FROM PlayerInfo P
JOIN height_info H ON P.height = H.height_id
JOIN SeasonStatus SS ON P.ELITEID = SS.ELITEID
WHERE H.height_in_cm = (SELECT MAX(height_in_cm) FROM height_info);
```
-------------------------6938 sample_num
```sql
SELECT PlayerName, birthdate 
FROM PlayerInfo 
JOIN SeasonStatus ON PlayerInfo.ELITEID = SeasonStatus.ELITEID 
WHERE SeasonStatus.SEASON = '1997-1998' AND SeasonStatus.LEAGUE = 'OHL' 
ORDER BY birthdate DESC 
LIMIT 1;
```
-------------------------6939 sample_num
```sql
SELECT COUNT(*) 
FROM PlayerInfo 
WHERE shoots = 'L' 
AND ELITEID IN (SELECT ELITEID FROM SeasonStatus WHERE GP = 72);
```
-------------------------6940 sample_num
```sql
SELECT 
    (SUM(CASE WHEN GAMETYPE = 'Regular Season' THEN G ELSE 0 END) - 
     SUM(CASE WHEN GAMETYPE = 'Playoffs' THEN G ELSE 0 END)) AS goal_difference
FROM 
    SeasonStatus
WHERE 
    ELITEID = (SELECT ELITEID FROM PlayerInfo WHERE PlayerName = 'Pavel Brendl') 
    AND SEASON = '1998-1999';
```
-------------------------6941 sample_num
```sql
SELECT AVG(w.weight_in_lbs) AS average_weight
FROM PlayerInfo p
JOIN weight_info w ON p.weight = w.weight_id
WHERE p.CSS_rank = (SELECT MAX(CSS_rank) FROM PlayerInfo);
```
-------------------------6942 sample_num
```sql
SELECT 
    (SUM(CASE WHEN GP > 20 THEN 1 ELSE 0 END) * 100.0 / COUNT(ELITEID)) AS percentage
FROM 
    SeasonStatus
WHERE 
    SEASON = '2007-2008' AND 
    GAMETYPE = 'Playoffs';
```
-------------------------6943 sample_num
```sql
SELECT PlayerInfo.PlayerName
FROM SeasonStatus
JOIN PlayerInfo ON SeasonStatus.ELITEID = PlayerInfo.ELITEID
WHERE SeasonStatus.LEAGUE = 'WHL' AND SeasonStatus.SEASON = '2007-2008'
ORDER BY SeasonStatus.G DESC
LIMIT 1;
```
-------------------------6944 sample_num
```sql
SELECT PlayerName 
FROM PlayerInfo 
JOIN SeasonStatus ON PlayerInfo.ELITEID = SeasonStatus.ELITEID 
WHERE SeasonStatus.TEAM = 'Chilliwack Chiefs' AND SeasonStatus.P > 100;
```
-------------------------6945 sample_num
```sql
SELECT PlayerName 
FROM PlayerInfo 
JOIN weight_info ON PlayerInfo.weight = weight_info.weight_id 
WHERE weight_info.weight_in_kg = 120;
```
-------------------------6946 sample_num
```sql
SELECT p.PlayerName, h.height_in_cm
FROM PlayerInfo p
JOIN height_info h ON p.height = h.height_id
WHERE h.height_in_cm = (SELECT h2.height_in_cm 
                         FROM PlayerInfo p2 
                         JOIN height_info h2 ON p2.height = h2.height_id 
                         WHERE p2.PlayerName = 'Brian Gionta');
```
-------------------------6947 sample_num
```sql
SELECT PlayerName, position_info
FROM PlayerInfo
WHERE ELITEID = (
    SELECT ELITEID
    FROM SeasonStatus
    ORDER BY PIM DESC
    LIMIT 1
);
```
-------------------------6948 sample_num
```sql
SELECT PlayerName
FROM PlayerInfo p
JOIN SeasonStatus s ON p.ELITEID = s.ELITEID
WHERE p.draftyear = (SELECT draftyear FROM SeasonStatus ORDER BY P DESC LIMIT 1)
ORDER BY P DESC
LIMIT 1;
```
-------------------------6949 sample_num
```sql
SELECT 
    (SUM(CASE WHEN nation IN ('Belarus', 'Bulgaria', 'Czech Republic', 'Hungary', 'Moldova', 'Poland', 'Romania', 'Slovakia', 'Ukraine') THEN 1 ELSE 0 END) * 100.0) / COUNT(ELITEID) AS percentage_eastern_europe_players
FROM 
    PlayerInfo
WHERE 
    overallby = 'Toronto Maple Leafs';
```
-------------------------6950 sample_num
```sql
SELECT PlayerName, MAX(CSS_rank) AS Highest_Prospect
FROM PlayerInfo
WHERE draftyear = 2008 AND overallby = 'Toronto Maple Leafs'
GROUP BY PlayerName
ORDER BY Highest_Prospect DESC
LIMIT 1;
```
-------------------------6951 sample_num
```sql
SELECT p.PlayerName, s.TEAM
FROM PlayerInfo p
JOIN SeasonStatus s ON p.ELITEID = s.ELITEID
WHERE s.SEASON = '2006-2007' AND s.LEAGUE = 'SuperElit' AND s.GAMETYPE = 'Playoffs'
ORDER BY s.P DESC
LIMIT 1;
```
-------------------------6952 sample_num
```sql
SELECT COUNT(*) 
FROM PlayerInfo 
WHERE overallby = 'Toronto Maple Leafs' AND sum_7yr_GP > 300;
```
-------------------------6953 sample_num
```sql
SELECT h.height_in_cm 
FROM PlayerInfo p 
JOIN SeasonStatus s ON p.ELITEID = s.ELITEID 
JOIN height_info h ON p.height = h.height_id 
WHERE s.TEAM = 'Yale Univ.' AND s.PIM = 28 AND s.SEASON = '2005-2006';
```
-------------------------6954 sample_num
```sql
SELECT 
    (SUM(CASE WHEN PlayerName = 'Ian Schultz' THEN G ELSE 0 END) / SUM(G)) * 100 AS percentage
FROM 
    SeasonStatus
WHERE 
    TEAM = 'Calgary Hitmen' AND 
    SEASON = '2007-2008';
```
-------------------------6955 sample_num
```sql
SELECT 
    (SUM(CASE WHEN PlayerName = 'Yevgeni Muratov' THEN PIM ELSE 0 END) / SUM(PIM)) * 100.0 AS percentage
FROM 
    SeasonStatus
WHERE 
    TEAM = 'Ak Bars Kazan' AND 
    SEASON = '1999-2000';
```
-------------------------6956 sample_num
```sql
SELECT birthplace FROM PlayerInfo WHERE PlayerName = 'Aaron Gagnon';
```
-------------------------6957 sample_num
```sql
SELECT w.weight_in_kg 
FROM PlayerInfo p 
JOIN weight_info w ON p.weight = w.weight_id 
WHERE p.PlayerName = 'Tony Martensson';
```
-------------------------6958 sample_num
```sql
SELECT PlayerName 
FROM PlayerInfo 
JOIN weight_info ON PlayerInfo.weight = weight_info.weight_id 
WHERE weight_info.weight_in_lbs = 190;
```
-------------------------6959 sample_num
```sql
SELECT PlayerName 
FROM PlayerInfo 
JOIN weight_info ON PlayerInfo.weight = weight_info.weight_id 
ORDER BY weight_info.weight_in_kg DESC 
LIMIT 1;
```
-------------------------6960 sample_num
```sql
SELECT 
    (SUM(CASE WHEN nation = 'Denmark' AND weight > 154 THEN 1 ELSE 0 END) * 100.0) / COUNT(ELITEID) AS percentage
FROM 
    PlayerInfo
JOIN 
    weight_info ON PlayerInfo.weight = weight_info.weight_id
WHERE 
    nation = 'Denmark' OR weight > 154;
```
-------------------------6961 sample_num
```sql
SELECT TEAM FROM SeasonStatus WHERE ELITEID = (SELECT ELITEID FROM PlayerInfo WHERE PlayerName = 'Andreas Jamtin');
```
-------------------------6962 sample_num
```sql
SELECT SEASON FROM SeasonStatus WHERE ELITEID = (SELECT ELITEID FROM PlayerInfo WHERE PlayerName = 'Niklas Eckerblom');
```
-------------------------6963 sample_num
```sql
SELECT GAMETYPE 
FROM SeasonStatus 
WHERE ELITEID = (SELECT ELITEID FROM PlayerInfo WHERE PlayerName = 'Matthias Trattnig');
```
-------------------------6964 sample_num
```sql
SELECT DISTINCT P.nation
FROM PlayerInfo P
JOIN SeasonStatus S ON P.ELITEID = S.ELITEID
WHERE S.SEASON = '1997-1998';
```
-------------------------6965 sample_num
```sql
SELECT MAX(P) AS highest_point
FROM SeasonStatus
WHERE ELITEID = (SELECT ELITEID FROM PlayerInfo WHERE PlayerName = 'Per Mars' AND draftyear = YEAR(CURRENT_DATE));
```
-------------------------6966 sample_num
```sql
SELECT PlayerName, MIN(height_in_cm) AS shortest_height
FROM PlayerInfo
JOIN height_info ON PlayerInfo.height = height_info.height_id
WHERE nation = 'Italy'
GROUP BY PlayerName
ORDER BY shortest_height
LIMIT 1;
```
-------------------------6967 sample_num
```sql
SELECT PlayerName 
FROM PlayerInfo 
WHERE height = (SELECT height_id FROM height_info WHERE height_in_inch = '5\'8"');
```
-------------------------6968 sample_num
```sql
SELECT COUNT(*) 
FROM PlayerInfo 
WHERE birthyear = 1982 AND height > 182;
```
-------------------------6969 sample_num
```sql
SELECT 
    (SUM(CASE WHEN nation = 'Russia' AND height < 200 THEN 1 ELSE 0 END) * 100.0) / COUNT(ELITEID) AS percentage
FROM 
    PlayerInfo;
```
-------------------------6970 sample_num
```sql
SELECT PlayerName, MIN(weight_in_lbs) AS lightest_weight
FROM PlayerInfo
JOIN weight_info ON PlayerInfo.weight = weight_info.weight_id
WHERE nation = 'USA'
GROUP BY PlayerName
ORDER BY lightest_weight ASC
LIMIT 1;
```
-------------------------6971 sample_num
```sql
SELECT ELITEID, SUM(PIM) AS total_penalty_minutes
FROM SeasonStatus
WHERE SEASON = '2000-2001'
GROUP BY ELITEID
ORDER BY total_penalty_minutes DESC
LIMIT 1;
```
-------------------------6972 sample_num
```sql
SELECT PlayerInfo.PlayerName 
FROM PlayerInfo 
JOIN SeasonStatus ON PlayerInfo.ELITEID = SeasonStatus.ELITEID 
WHERE SeasonStatus.TEAM = 'Avangard Omsk' AND SeasonStatus.SEASON = '2000-2001';
```
-------------------------6973 sample_num
```sql
SELECT PlayerName, MAX(PIM) AS Max_PIM
FROM PlayerInfo
JOIN SeasonStatus ON PlayerInfo.ELITEID = SeasonStatus.ELITEID
WHERE overallby = 'Arizona Coyotes' AND draftyear = 2000
GROUP BY PlayerName
ORDER BY Max_PIM DESC
LIMIT 1;
```
-------------------------6974 sample_num
```sql
SELECT COUNT(*) 
FROM PlayerInfo 
WHERE overallby = 'Arizona Coyotes' AND height = (SELECT height_id FROM height_info WHERE height_in_cm = 195);
```
-------------------------6975 sample_num
```sql
SELECT DISTINCT p.PlayerName
FROM PlayerInfo p
JOIN SeasonStatus s ON p.ELITEID = s.ELITEID
WHERE s.TEAM = 'Avangard Omsk' 
  AND s.GAMETYPE = 'Playoffs' 
  AND s.SEASON = '2000-2001';
```
-------------------------6976 sample_num
```sql
SELECT PlayerInfo.PlayerName, MAX(SeasonStatus.P) AS MaxPoints
FROM SeasonStatus
JOIN PlayerInfo ON SeasonStatus.ELITEID = PlayerInfo.ELITEID
WHERE SeasonStatus.SEASON = '2000-2001' AND SeasonStatus.LEAGUE = 'International'
GROUP BY PlayerInfo.PlayerName
ORDER BY MaxPoints DESC
LIMIT 1;
```
-------------------------6977 sample_num
```sql
SELECT COUNT(*) 
FROM PlayerInfo p 
JOIN weight_info w ON p.weight = w.weight_id 
WHERE p.birthyear = 1980 AND w.weight_in_lbs = 185;
```
-------------------------6978 sample_num
```sql
SELECT ELITEID, SUM(GP) AS total_GP
FROM SeasonStatus
WHERE SEASON = '2000-2001' AND LEAGUE = 'International'
GROUP BY ELITEID
ORDER BY total_GP DESC
LIMIT 1;
```
-------------------------6979 sample_num
```sql
SELECT p.PlayerName 
FROM PlayerInfo p 
JOIN SeasonStatus s ON p.ELITEID = s.ELITEID 
WHERE s.SEASON = '2000-2001' 
  AND s.TEAM = 'Avangard Omsk' 
  AND s.LEAGUE = 'International' 
  AND s.G = 0;
```
-------------------------6980 sample_num
```sql
SELECT PlayerName, birthdate 
FROM PlayerInfo 
JOIN SeasonStatus ON PlayerInfo.ELITEID = SeasonStatus.ELITEID 
WHERE SeasonStatus.TEAM = 'Avangard Omsk' 
  AND SeasonStatus.GAMETYPE = 'Regular Season' 
  AND SeasonStatus.SEASON = '2000-2001' 
ORDER BY birthdate ASC 
LIMIT 1;
```
-------------------------6981 sample_num
```sql
SELECT PlayerInfo.PlayerName, MAX(SeasonStatus.A) AS MaxAssists
FROM PlayerInfo
JOIN SeasonStatus ON PlayerInfo.ELITEID = SeasonStatus.ELITEID
WHERE SeasonStatus.LEAGUE = 'OHL' 
  AND SeasonStatus.GAMETYPE = 'Regular Season' 
  AND SeasonStatus.SEASON = '2007-2008'
GROUP BY PlayerInfo.PlayerName
ORDER BY MaxAssists DESC
LIMIT 1;
```
-------------------------6982 sample_num
```sql
SELECT COUNT(DISTINCT ss.TEAM) AS team_count
FROM PlayerInfo p
JOIN weight_info w ON p.weight = w.weight_id
JOIN SeasonStatus ss ON p.ELITEID = ss.ELITEID
WHERE p.overallby = 'Arizona Coyotes' 
AND w.weight_in_lbs = (SELECT MAX(w2.weight_in_lbs)
                       FROM PlayerInfo p2
                       JOIN weight_info w2 ON p2.weight = w2.weight_id
                       WHERE p2.overallby = 'Arizona Coyotes');
```
-------------------------6983 sample_num
```sql
SELECT AVG(w.weight_in_lbs) AS average_weight_pounds
FROM PlayerInfo p
JOIN weight_info w ON p.weight = w.weight_id
WHERE p.overallby = 'Arizona Coyotes';
```
-------------------------6984 sample_num
```sql
SELECT AVG(h.height_in_cm) AS average_height_cm
FROM PlayerInfo p
JOIN SeasonStatus s ON p.ELITEID = s.ELITEID
JOIN height_info h ON p.height = h.height_id
WHERE s.TEAM = 'Acadie-Bathurst Titan' AND s.GAMETYPE = 'Regular Season';
```
-------------------------6985 sample_num
```sql
SELECT SUM(GP) AS total_games
FROM SeasonStatus
WHERE ELITEID = (SELECT ELITEID FROM PlayerInfo WHERE PlayerName = 'Per Mars')
AND SEASON = '1997-1998';
```
-------------------------6986 sample_num
```sql
SELECT w.weight_in_kg 
FROM PlayerInfo p 
JOIN weight_info w ON p.weight = w.weight_id 
WHERE p.PlayerName = 'Matthias Trattnig';
```
-------------------------6987 sample_num
```sql
SELECT PlayerName 
FROM PlayerInfo 
WHERE height > (5 * 12 + 9);
```
-------------------------6988 sample_num
```sql
SELECT TEAM 
FROM SeasonStatus 
WHERE ELITEID = (SELECT ELITEID FROM PlayerInfo WHERE PlayerName = 'Niklas Eckerblom') 
AND SEASON = '1997-1998';
```
-------------------------6989 sample_num
```sql
SELECT TEAM, COUNT(*) AS SwedishCount
FROM PlayerInfo
WHERE nation = 'Sweden'
GROUP BY TEAM
ORDER BY SwedishCount DESC
LIMIT 1;
```
-------------------------6990 sample_num
```sql
SELECT COUNT(*) AS playoffs_count
FROM SeasonStatus
WHERE ELITEID = (SELECT ELITEID FROM PlayerInfo WHERE PlayerName = 'Per Mars')
AND GAMETYPE = 'Playoffs';
```
-------------------------6991 sample_num
```sql
SELECT PlayerInfo.PlayerName
FROM SeasonStatus
JOIN PlayerInfo ON SeasonStatus.ELITEID = PlayerInfo.ELITEID
WHERE SeasonStatus.TEAM = 'Rimouski Oceanic' AND SeasonStatus.GAMETYPE = 'Playoffs'
ORDER BY SeasonStatus.G DESC
LIMIT 1;
```
-------------------------6992 sample_num
```sql
SELECT nation, COUNT(*) AS player_count
FROM PlayerInfo
JOIN SeasonStatus ON PlayerInfo.ELITEID = SeasonStatus.ELITEID
WHERE TEAM = 'Plymouth Whalers'
GROUP BY nation
ORDER BY player_count DESC
LIMIT 1;
```
-------------------------6993 sample_num
```sql
SELECT PlayerInfo.PlayerName
FROM SeasonStatus
JOIN PlayerInfo ON SeasonStatus.ELITEID = PlayerInfo.ELITEID
WHERE SeasonStatus.TEAM = 'Plymouth Whalers' AND SeasonStatus.SEASON = '1999-2000'
ORDER BY SeasonStatus.A DESC
LIMIT 1;
```
-------------------------6994 sample_num
```sql
SELECT p.PlayerName, h.height_in_inch
FROM PlayerInfo p
JOIN SeasonStatus s ON p.ELITEID = s.ELITEID
JOIN height_info h ON p.height = h.height_id
WHERE s.TEAM = 'Oshawa Generals';
```
-------------------------6995 sample_num
```sql
SELECT PlayerInfo.PlayerName, MIN(PlayerInfo.birthdate) AS oldest_birthdate
FROM PlayerInfo
JOIN SeasonStatus ON PlayerInfo.ELITEID = SeasonStatus.ELITEID
WHERE SeasonStatus.LEAGUE = 'OHL' AND SeasonStatus.SEASON = '1997-2000'
GROUP BY PlayerInfo.PlayerName
ORDER BY oldest_birthdate
LIMIT 1;
```
-------------------------6996 sample_num
```sql
SELECT PlayerName 
FROM PlayerInfo 
WHERE ELITEID = (
    SELECT ELITEID 
    FROM SeasonStatus 
    WHERE TEAM = 'USA U20' 
    ORDER BY GP DESC 
    LIMIT 1
) 
ORDER BY height DESC 
LIMIT 1;
```
-------------------------6997 sample_num
```sql
SELECT 
    (SUM(CASE WHEN P.nation = 'Sweden' THEN 1 ELSE 0 END) * 100.0 / COUNT(P.ELITEID)) AS percentage
FROM 
    PlayerInfo P
JOIN 
    SeasonStatus S ON P.ELITEID = S.ELITEID
WHERE 
    S.GAMETYPE = 'Playoffs' 
    AND S.SEASON IN ('1997-1998', '1998-1999', '1999-2000');
```
-------------------------6998 sample_num
```sql
SELECT 
    (SUM(CASE WHEN PIM IS NOT NULL AND nation = 'Sweden' THEN PIM ELSE 0 END) * 100.0) / 
    COUNT(CASE WHEN LEAGUE = 'OHL' THEN ELITEID END) AS percentage
FROM 
    PlayerInfo 
JOIN 
    SeasonStatus ON PlayerInfo.ELITEID = SeasonStatus.ELITEID
WHERE 
    LEAGUE = 'OHL';
```
-------------------------6999 sample_num
```sql
SELECT AVG(StandardCost) AS AverageStandardCost
FROM Product
WHERE ProductNumber = 'CA-1098';
```
-------------------------7000 sample_num
```sql
SELECT p.Name AS ProductName, pch.StartDate
FROM Product p
JOIN ProductCostHistory pch ON p.ProductID = pch.ProductID
WHERE pch.EndDate IS NULL;
```
-------------------------7001 sample_num
```sql
SELECT p.ProductID, p.Name, p.StandardCost
FROM Product p
JOIN ProductCostHistory pch ON p.ProductID = pch.ProductID
WHERE p.StandardCost - pch.StandardCost > 80;
```
-------------------------7002 sample_num
```sql
SELECT p.Name, SUM(sci.Quantity) AS TotalQuantity
FROM Product p
JOIN ShoppingCartItem sci ON p.ProductID = sci.ProductID
WHERE sci.ShoppingCartID = 14951
GROUP BY p.Name;
```
-------------------------7003 sample_num
```sql
SELECT p.Name
FROM Product p
JOIN ShoppingCartItem sci ON p.ProductID = sci.ProductID
WHERE sci.Quantity > 5;
```
-------------------------7004 sample_num
```sql
SELECT p.Name AS ProductName
FROM PurchaseOrderDetail pod
JOIN Product p ON pod.ProductID = p.ProductID
WHERE p.Class = 'L';
```
-------------------------7005 sample_num
```sql
SELECT p.Name AS ProductName, p.ListPrice AS SellingPrice
FROM TransactionHistory th
JOIN Product p ON th.ProductID = p.ProductID
WHERE th.Quantity > 10000;
```
-------------------------7006 sample_num
```sql
SELECT p.ProductID, p.Name, SUM(th.Quantity) AS TotalQuantity
FROM Product p
JOIN TransactionHistory th ON p.ProductID = th.ProductID
WHERE p.Class = 'H'
GROUP BY p.ProductID, p.Name
HAVING SUM(th.Quantity) = 1;
```
-------------------------7007 sample_num
```sql
SELECT COUNT(*) AS TransactionCount
FROM TransactionHistory
WHERE ProductID IN (
    SELECT ProductID
    FROM Product
    WHERE ProductLine = 'M'
);
```
-------------------------7008 sample_num
```sql
SELECT SUM((p.ListPrice - p.StandardCost) * sci.Quantity) AS TotalSalesProfit
FROM ShoppingCartItem sci
JOIN Product p ON sci.ProductID = p.ProductID
WHERE sci.ShoppingCartID = '20621';
```
-------------------------7009 sample_num
```sql
SELECT Name, ListPrice 
FROM Product 
WHERE Class = 'H';
```
-------------------------7010 sample_num
```sql
SELECT ProductLine, COUNT(*) AS ProductCount
FROM Product
WHERE FinishedGoodsFlag = 1
GROUP BY ProductLine
ORDER BY ProductCount DESC
LIMIT 1;
```
-------------------------7011 sample_num
```sql
SELECT ProductID, Rating, Comments 
FROM ProductReview 
WHERE ReviewerName LIKE 'J%';
```
-------------------------7012 sample_num
```sql
SELECT p.Name AS ProductName, p.ProductLine, pr.Rating, p.ListPrice
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE pr.Rating = 1
ORDER BY pr.Rating
LIMIT 1;
```
-------------------------7013 sample_num
```sql
SELECT ProductID, Name, AVG(ListPrice - StandardCost) AS Profit
FROM Product
GROUP BY ProductID, Name
HAVING AVG(ListPrice - StandardCost) > 100;
```
-------------------------7014 sample_num
```sql
SELECT p.Name AS ProductName, pr.ReviewerName, pr.Rating, pr.Comments
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE p.ProductLine = 'R';
```
-------------------------7015 sample_num
```sql
SELECT COUNT(ReviewerName) AS NumberOfReviews, AVG(Rating) AS AverageRating
FROM ProductReview
WHERE ProductID = (SELECT ProductID FROM Product WHERE Name = 'HL Mountain Pedal');
```
-------------------------7016 sample_num
```sql
SELECT DISTINCT p.Name
FROM PurchaseOrderDetail pod
JOIN Product p ON pod.ProductID = p.ProductID
WHERE pod.PurchaseOrderID IN (
    SELECT PurchaseOrderID
    FROM PurchaseOrderDetail
    GROUP BY PurchaseOrderID
    HAVING SUM(ReceivedQty) = 0 AND SUM(RejectedQty) > 0
);
```
-------------------------7017 sample_num
```sql
SELECT TOP 1 p.Name, sod.UnitPrice
FROM Product p
JOIN SalesOrderDetail sod ON p.ProductID = sod.ProductID
WHERE sod.RejectedQty = 0
ORDER BY sod.LineTotal DESC;
```
-------------------------7018 sample_num
```sql
SELECT p.Name, p.ProductLine
FROM Product p
JOIN PurchaseOrderDetail pod ON p.ProductID = pod.ProductID
WHERE pod.OrderQty >= 5000;
```
-------------------------7019 sample_num
```sql
SELECT SUM(OrderQty) AS TotalOrderedQuantity
FROM SalesOrderDetail
JOIN Product ON SalesOrderDetail.ProductID = Product.ProductID
WHERE Product.ProductLine = 'T';
```
-------------------------7020 sample_num
```sql
SELECT TOP 1 p.Name, sod.LineTotal
FROM SalesOrderDetail sod
JOIN Product p ON sod.ProductID = p.ProductID
WHERE p.Class = 'L'
ORDER BY sod.LineTotal DESC;
```
-------------------------7021 sample_num
```sql
SELECT TOP 1 Name 
FROM Product 
JOIN ProductVendor ON Product.ProductID = ProductVendor.ProductID 
ORDER BY (ProductVendor.LastReceiptCost - Product.StandardCost) DESC;
```
-------------------------7022 sample_num
```sql
SELECT p.Name
FROM Product p
JOIN ProductVendor pv ON p.ProductID = pv.ProductID
WHERE pv.MinOrderQty = 100
ORDER BY p.Name DESC;
```
-------------------------7023 sample_num
```sql
SELECT p.Name, (p.ListPrice - p.StandardCost) AS Profit
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE pr.Rating = 5
ORDER BY pr.ReviewDate DESC
LIMIT 1;
```
-------------------------7024 sample_num
```sql
SELECT SUM((p.ListPrice - p.StandardCost) * th.Quantity) AS TotalProfit
FROM TransactionHistory th
JOIN Product p ON th.ProductID = p.ProductID
WHERE th.ProductID = 827;
```
-------------------------7025 sample_num
```sql
SELECT FromCurrencyCode, ToCurrencyCode, AVG(AverageRate) AS HighestAverageRate
FROM CurrencyRate
GROUP BY FromCurrencyCode, ToCurrencyCode
ORDER BY HighestAverageRate DESC
LIMIT 1;
```
-------------------------7026 sample_num
```sql
SELECT SUM(OrderQty) AS TotalOrdered
FROM SalesOrderDetail
WHERE UnitPrice = (SELECT MAX(UnitPrice) FROM SalesOrderDetail);
```
-------------------------7027 sample_num
```sql
SELECT TOP 1 st.Name, st.SalesLastYear
FROM SalesTerritory st
WHERE st.CountryRegionCode = 'US' AND (st.Name = 'Northwest' OR st.Name = 'Southeast')
ORDER BY st.SalesLastYear DESC;
```
-------------------------7028 sample_num
```sql
SELECT CONCAT(E.FirstName, ' ', E.MiddleName, ' ', E.LastName) AS FullName
FROM Employee E
JOIN JobCandidate JC ON E.BusinessEntityID = JC.BusinessEntityID
JOIN Document D ON D.Owner = E.BusinessEntityID
WHERE E.JobTitle = 'Document Control Manager' AND D.Status = 2;
```
-------------------------7029 sample_num
```sql
SELECT TOP 1 c.CustomerID
FROM Customer c
JOIN SalesOrderHeader soh ON c.CustomerID = soh.CustomerID
JOIN SalesPerson sp ON soh.SalesPersonID = sp.BusinessEntityID
WHERE sp.Bonus = (SELECT MAX(Bonus) FROM SalesPerson)
ORDER BY soh.SubTotal DESC;
```
-------------------------7030 sample_num
```sql
SELECT SUM(UnitPrice * OrderQty) AS TotalPrice
FROM SalesOrderDetail
WHERE SalesOrderID = 46625 AND SpecialOfferID IN (
    SELECT SpecialOfferID
    FROM SpecialOffer
    WHERE MinQty <= 14 AND MaxQty >= 11
) AND ProductID = 716;
```
-------------------------7031 sample_num
```sql
SELECT COUNT(*) 
FROM Product 
WHERE ReorderPoint < 600 
  AND MakeFlag = 1 
  AND ProductID IN (
      SELECT ProductAssemblyID 
      FROM BillOfMaterials 
      WHERE BOMLevel = 4 
        AND PerAssemblyQty = 1
  );
```
-------------------------7032 sample_num
```sql
SELECT MAX(SalesPerson.Bonus) AS HighestBonus
FROM SalesPerson
JOIN SalesTerritory ON SalesPerson.TerritoryID = SalesTerritory.TerritoryID
WHERE SalesTerritory.Name = 'Canada';
```
-------------------------7033 sample_num
```sql
SELECT p.Name
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE pr.Rating = 1;
```
-------------------------7034 sample_num
```sql
SELECT COUNT(DISTINCT e.BusinessEntityID) AS WorkerCount
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
WHERE edh.StartDate BETWEEN '2009-01-01' AND '2009-12-31'
AND d.Name = 'Production';
```
-------------------------7035 sample_num
```sql
SELECT TOP 1 
    CONCAT(e.FirstName, ' ', e.MiddleName, ' ', e.LastName) AS FullName, 
    e.JobTitle 
FROM 
    Employee e 
JOIN 
    EmployeePayHistory eph ON e.BusinessEntityID = eph.BusinessEntityID 
WHERE 
    e.MaritalStatus = 'S' AND 
    e.Gender = 'F' 
ORDER BY 
    eph.Rate DESC;
```
-------------------------7036 sample_num
```sql
SELECT CONCAT(FirstName, ' ', MiddleName, ' ', LastName) AS FullName, HireDate
FROM Employee
WHERE JobTitle = 'Vice President of Engineering';
```
-------------------------7037 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
JOIN EmployeePayHistory ON Employee.BusinessEntityID = EmployeePayHistory.BusinessEntityID 
WHERE Employee.CurrentFlag = 1 AND EmployeePayHistory.Rate <= 30;
```
-------------------------7038 sample_num
```sql
SELECT d.Name AS DepartmentName
FROM Department d
JOIN Employee e ON d.DepartmentID = e.DepartmentID
WHERE e.HireDate = (SELECT MAX(HireDate) FROM Employee);
```
-------------------------7039 sample_num
```sql
SELECT CONCAT(p.FirstName, ' ', p.LastName) AS FullName, e.Gender
FROM Employee e
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
JOIN Store s ON e.BusinessEntityID = s.SalesPersonID
WHERE p.PersonType = 'SC'
ORDER BY e.HireDate DESC
LIMIT 1;
```
-------------------------7040 sample_num
```sql
SELECT PayFrequency
FROM Employee
WHERE SickLeaveHours = (SELECT MIN(SickLeaveHours) FROM Employee);
```
-------------------------7041 sample_num
```sql
SELECT TOP 1 JobTitle 
FROM Employee 
JOIN EmployeePayHistory ON Employee.BusinessEntityID = EmployeePayHistory.BusinessEntityID 
ORDER BY Rate ASC;
```
-------------------------7042 sample_num
```sql
SELECT COUNT(e.BusinessEntityID) AS TotalEmployees
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
WHERE d.Name = 'Finance';
```
-------------------------7043 sample_num
```sql
SELECT 
    ProductID, 
    Name, 
    ListPrice - StandardCost AS Profit, 
    BOMLevel 
FROM 
    Product 
JOIN 
    BillOfMaterials ON Product.ProductID = BillOfMaterials.ProductAssemblyID 
WHERE 
    ListPrice IN (
        (SELECT MAX(ListPrice) FROM Product),
        (SELECT MIN(ListPrice) FROM Product WHERE ListPrice > 0)
    );
```
-------------------------7044 sample_num
```sql
SELECT v.Name AS VendorName, 
       SUM(p.StandardPrice - pv.LastReceiptCost) AS NetProfit
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
JOIN Product p ON pv.ProductID = p.ProductID
WHERE v.CreditRating > 3
GROUP BY v.Name;
```
-------------------------7045 sample_num
```sql
SELECT COUNT(DISTINCT c.CustomerID) AS AccountCount
FROM Customer c
JOIN BusinessEntityAddress bea ON c.BusinessEntityID = bea.BusinessEntityID
JOIN Address a ON bea.AddressID = a.AddressID
WHERE a.AddressLine2 IS NOT NULL AND LEN(a.AddressLine2) > 0;
```
-------------------------7046 sample_num
```sql
SELECT Address.PostalCode
FROM Address
JOIN BusinessEntityAddress ON Address.AddressID = BusinessEntityAddress.AddressID
JOIN BusinessEntity ON BusinessEntityAddress.BusinessEntityID = BusinessEntity.BusinessEntityID
WHERE BusinessEntity.ModifiedDate = (
    SELECT MAX(ModifiedDate)
    FROM BusinessEntity
    WHERE YEAR(ModifiedDate) = 2022 AND MONTH(ModifiedDate) = 10
);
```
-------------------------7047 sample_num
```sql
SELECT MAX(DATEDIFF(EndDate, StartDate)) AS LongestAssemblyDuration
FROM WorkOrder
WHERE ProductID IN (
    SELECT ProductID
    FROM Product
    WHERE Name LIKE '%bicycle%'
);
```
-------------------------7048 sample_num
```sql
SELECT SUM(BillOfMaterials.PerAssemblyQty) AS TotalAssemblyItems
FROM BillOfMaterials
JOIN Product ON BillOfMaterials.ProductAssemblyID = Product.ProductID
WHERE Product.ProductLine = 'Bikes' AND BillOfMaterials.EndDate IS NULL;
```
-------------------------7049 sample_num
```sql
SELECT UnitMeasureCode 
FROM BillOfMaterials 
WHERE PerAssemblyQty = (SELECT MAX(PerAssemblyQty) FROM BillOfMaterials);
```
-------------------------7050 sample_num
```sql
SELECT COUNT(*) 
FROM Document 
WHERE DocumentSummary IS NULL;
```
-------------------------7051 sample_num
```sql
SELECT Title 
FROM Document 
WHERE Status = 1;
```
-------------------------7052 sample_num
```sql
SELECT e.JobTitle
FROM Employee e
JOIN BusinessEntity b ON e.BusinessEntityID = b.BusinessEntityID
JOIN Document d ON b.BusinessEntityID = d.Owner
WHERE d.Status = 2;
```
-------------------------7053 sample_num
```sql
SELECT EmployeePayHistory.PayFrequency
FROM Employee
JOIN EmployeePayHistory ON Employee.BusinessEntityID = EmployeePayHistory.BusinessEntityID
WHERE Employee.BirthDate = (SELECT MIN(BirthDate) FROM Employee);
```
-------------------------7054 sample_num
```sql
SELECT COUNT(*) 
FROM EmployeePayHistory 
WHERE PayFrequency = 2 
AND BusinessEntityID IN (
    SELECT BusinessEntityID 
    FROM Employee 
    WHERE MaritalStatus = 'M'
);
```
-------------------------7055 sample_num
```sql
SELECT e.BusinessEntityID, ep.Rate
FROM Employee e
JOIN EmployeePayHistory ep ON e.BusinessEntityID = ep.BusinessEntityID
WHERE e.HireDate = (SELECT MAX(HireDate) FROM Employee);
```
-------------------------7056 sample_num
```sql
SELECT COUNT(*) 
FROM EmployeePayHistory ep 
JOIN Employee e ON ep.BusinessEntityID = e.BusinessEntityID 
WHERE ep.Rate > 40 AND e.Gender = 'M';
```
-------------------------7057 sample_num
```sql
SELECT MAX(Rate) AS HighestPayRate
FROM EmployeePayHistory
JOIN Employee ON EmployeePayHistory.BusinessEntityID = Employee.BusinessEntityID
WHERE Employee.SalariedFlag = 1;
```
-------------------------7058 sample_num
```sql
SELECT VacationHours 
FROM Employee 
WHERE PayFrequency = 2;
```
-------------------------7059 sample_num
```sql
SELECT Rate 
FROM EmployeePayHistory 
WHERE BusinessEntityID = (
    SELECT BusinessEntityID 
    FROM Employee 
    WHERE VacationHours = (SELECT MAX(VacationHours) FROM Employee)
);
```
-------------------------7060 sample_num
```sql
SELECT COUNT(*) 
FROM Employee e 
JOIN EmployeePayHistory ep ON e.BusinessEntityID = ep.BusinessEntityID 
WHERE ep.Rate > 35 AND e.SickLeaveHours > 10;
```
-------------------------7061 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
WHERE CurrentFlag = 1 AND Gender = 'M' AND BusinessEntityID IN (
    SELECT BusinessEntityID 
    FROM EmployeePayHistory 
    WHERE PayFrequency = 2
);
```
-------------------------7062 sample_num
```sql
SELECT COUNT(*) 
FROM Employee e
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
WHERE e.JobTitle = 'Sales Person' AND p.Gender = 'M';
```
-------------------------7063 sample_num
```sql
SELECT JobTitle 
FROM Employee 
WHERE BirthDate = (SELECT MAX(BirthDate) FROM Employee);
```
-------------------------7064 sample_num
```sql
SELECT e.NameStyle
FROM Employee e
JOIN EmployeePayHistory eph ON e.BusinessEntityID = eph.BusinessEntityID
WHERE eph.Rate = (SELECT MIN(Rate) FROM EmployeePayHistory);
```
-------------------------7065 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
WHERE MaritalStatus = 'M' AND NameStyle = '0';
```
-------------------------7066 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
WHERE SickLeaveHours > 10 AND EmailPromotion IN (1, 2);
```
-------------------------7067 sample_num
```sql
SELECT *
FROM Employee
WHERE VacationHours > 20 AND EmailPromotion IN (1, 2);
```
-------------------------7068 sample_num
```sql
SELECT p.AdditionalContactInfo
FROM Employee e
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
WHERE e.JobTitle = 'Sales Person'
AND p.BirthDate = (SELECT MAX(BirthDate) FROM Employee e2 JOIN Person p2 ON e2.BusinessEntityID = p2.BusinessEntityID WHERE p2.PersonType = 'SP');
```
-------------------------7069 sample_num
```sql
SELECT FirstName 
FROM Employee 
JOIN Person ON Employee.BusinessEntityID = Person.BusinessEntityID 
WHERE Person.NameStyle = 0 AND Employee.Gender = 'M';
```
-------------------------7070 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
WHERE CurrentFlag = 1 AND Title = 'Mr';
```
-------------------------7071 sample_num
```sql
SELECT e.BusinessEntityID, p.FirstName, p.LastName, e.JobTitle, ep.Rate
FROM Employee e
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
JOIN EmployeePayHistory ep ON e.BusinessEntityID = ep.BusinessEntityID
WHERE p.MaritalStatus = 'M' AND ep.Rate = (
    SELECT MAX(Rate)
    FROM EmployeePayHistory
    WHERE BusinessEntityID IN (
        SELECT BusinessEntityID
        FROM Employee
        JOIN Person ON Employee.BusinessEntityID = Person.BusinessEntityID
        WHERE Person.MaritalStatus = 'M'
    )
);
```
-------------------------7072 sample_num
```sql
SELECT p.Suffix
FROM Employee e
JOIN BusinessEntityContact bec ON e.BusinessEntityID = bec.BusinessEntityID
JOIN Person p ON bec.PersonID = p.BusinessEntityID
JOIN Store s ON e.BusinessEntityID = s.BusinessEntityID
WHERE p.PersonType = 'SC'
ORDER BY e.SickLeaveHours DESC
LIMIT 1;
```
-------------------------7073 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
WHERE MaritalStatus = 'M' 
AND NameStyle = 1 
AND BusinessEntityID IN (
    SELECT BusinessEntityID 
    FROM EmployeePayHistory 
    WHERE PayFrequency = (SELECT MAX(PayFrequency) FROM EmployeePayHistory)
);
```
-------------------------7074 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
WHERE CurrentFlag = 1 
AND BusinessEntityID IN (SELECT BusinessEntityID FROM Person WHERE EmailPromotion = 0);
```
-------------------------7075 sample_num
```sql
SELECT pcc.CreditCardID
FROM PersonCreditCard pcc
JOIN Person p ON p.BusinessEntityID = pcc.BusinessEntityID
WHERE p.PersonType = 'SC';
```
-------------------------7076 sample_num
```sql
SELECT AVG(VacationHours) AS AverageVacationHours
FROM Employee
JOIN Person ON Employee.BusinessEntityID = Person.BusinessEntityID
WHERE Person.PersonType = 'EM' AND Person.Gender = 'M';
```
-------------------------7077 sample_num
```sql
WITH MarriedEmployees AS (
    SELECT e.BusinessEntityID, ep.Rate
    FROM Employee e
    JOIN EmployeePayHistory ep ON e.BusinessEntityID = ep.BusinessEntityID
    WHERE e.MaritalStatus = 'M' AND e.EmailPromotion = 1
),
AveragePay AS (
    SELECT AVG(Rate) AS AvgRate
    FROM MarriedEmployees
),
MaxPay AS (
    SELECT MAX(Rate) AS MaxRate
    FROM MarriedEmployees
)
SELECT (MaxRate - AvgRate) AS PayDifference
FROM MaxPay, AveragePay;
```
-------------------------7078 sample_num
```sql
SELECT 
    CAST(COUNT(CASE WHEN p.PersonType = 'SC' AND e.MaritalStatus = 'M' THEN p.BusinessEntityID END) AS FLOAT) / 
    NULLIF(COUNT(CASE WHEN e.MaritalStatus = 'M' THEN p.BusinessEntityID END), 0) AS Probability
FROM 
    Person p
JOIN 
    Employee e ON p.BusinessEntityID = e.BusinessEntityID
WHERE 
    e.MaritalStatus = 'M' AND e.NameStyle = 0;
```
-------------------------7079 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN VacationHours > 20 THEN BusinessEntityID END) * 100.0 / COUNT(BusinessEntityID)) AS Percentage
FROM 
    Employee
WHERE 
    CurrentFlag = 1 AND SickLeaveHours > 10;
```
-------------------------7080 sample_num
```sql
SELECT AVG(LastReceiptCost) AS AverageLastReceiptCost
FROM ProductVendor
WHERE AverageLeadTime = 60;
```
-------------------------7081 sample_num
```sql
SELECT AVG(ActualCost) AS AverageCost
FROM TransactionHistory
WHERE TransactionType = 'P' 
AND TransactionDate BETWEEN '2012-01-01' AND '2012-06-30';
```
-------------------------7082 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN MaritalStatus = 'M' THEN 1 END) * 100.0 / COUNT(*)) AS PercentageMarried
FROM 
    Employee
WHERE 
    Gender = 'M' AND 
    YEAR(HireDate) = 2009;
```
-------------------------7083 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.FirstName = 'Mary' AND p.EmailPromotion = 2 AND b.ContactTypeID = 'SC' THEN 1 END) * 100.0) / COUNT(p.BusinessEntityID) AS Percentage
FROM 
    Person p
JOIN 
    BusinessEntityContact b ON p.BusinessEntityID = b.PersonID
WHERE 
    p.FirstName = 'Mary' AND p.EmailPromotion = 2;
```
-------------------------7084 sample_num
```sql
SELECT p.ProductID
FROM Product p
JOIN ProductVendor pv ON p.ProductID = pv.ProductID
WHERE (p.ListPrice - pv.LastReceiptCost) < 0;
```
-------------------------7085 sample_num
```sql
SELECT AVG(TotalDue) AS AverageTotalDue
FROM SalesOrderHeader
WHERE Status = 2;
```
-------------------------7086 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN OrderQty < 3 AND UnitPriceDiscount = 0.2 THEN SalesOrderID END) * 100.0 / COUNT(SalesOrderID)) AS Percentage
FROM 
    SalesOrderDetail;
```
-------------------------7087 sample_num
```sql
SELECT BusinessEntityID
FROM SalesPerson
WHERE (SalesYTD - SalesLastYear) / SalesLastYear > 0.6
AND Bonus > 3000;
```
-------------------------7088 sample_num
```sql
SELECT 
    COUNT(DISTINCT BusinessEntityID) AS NumberOfBusinesses
FROM 
    BusinessEntityAddress
WHERE 
    AddressTypeID IN (2, 5);
```
-------------------------7089 sample_num
```sql
SELECT DISTINCT c.CustomerID
FROM SalesOrderDetail sod
JOIN SalesOrderHeader soh ON sod.SalesOrderID = soh.SalesOrderID
JOIN Customer c ON soh.CustomerID = c.CustomerID
WHERE sod.OrderQty = 32 AND sod.UnitPrice = 35;
```
-------------------------7090 sample_num
```sql
SELECT c.Name
FROM CreditCard cc
JOIN Person p ON cc.BusinessEntityID = p.BusinessEntityID
JOIN BusinessEntityContact bec ON p.BusinessEntityID = bec.PersonID
JOIN BusinessEntity be ON bec.BusinessEntityID = be.BusinessEntityID
WHERE cc.CardType = 'ColonialVoice' AND cc.ExpMonth = 3 AND cc.ExpYear = 2005;
```
-------------------------7091 sample_num
```sql
SELECT v.CreditRating
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
WHERE pv.AverageLeadTime = 16
  AND pv.StandardPrice = 18.9900
  AND pv.LastReceiptDate >= '2011-08-27 00:00:00'
  AND pv.LastReceiptDate < '2011-08-28 00:00:00';
```
-------------------------7092 sample_num
```sql
SELECT COUNT(*) AS TotalProducts
FROM Product
WHERE ProductSubcategoryID IN (
    SELECT ProductSubcategoryID
    FROM ProductSubcategory
    WHERE Name IN ('Accessories', 'Components')
);
```
-------------------------7093 sample_num
```sql
SELECT JobTitle 
FROM Employee 
WHERE BusinessEntityID = (
    SELECT BusinessEntityID 
    FROM EmployeeDepartmentHistory 
    WHERE DepartmentID = 12 
    ORDER BY StartDate DESC 
    LIMIT 1
);
```
-------------------------7094 sample_num
```sql
SELECT FirstName, LastName 
FROM Employee 
WHERE JobTitle = 'Production Supervisor' 
AND MaritalStatus = 'S' 
AND Gender = 'M';
```
-------------------------7095 sample_num
```sql
SELECT SUM(pi.Quantity) AS TotalProducts
FROM ProductInventory pi
JOIN Product p ON pi.ProductID = p.ProductID
JOIN ProductSubcategory ps ON p.ProductSubcategoryID = ps.ProductSubcategoryID
WHERE ps.Name = 'Subassembly';
```
-------------------------7096 sample_num
```sql
SELECT SUM(StockedQty) AS TotalRejectedProducts
FROM WorkOrder
WHERE ScrapReasonID IN (
    SELECT ScrapReasonID
    FROM ScrapReason
    WHERE Name = 'Trim length too long'
);
```
-------------------------7097 sample_num
```sql
SELECT SUM(SOD.OrderQty) AS TotalQuantity
FROM SalesOrderDetail SOD
JOIN SalesOrderHeader SOH ON SOD.SalesOrderID = SOH.SalesOrderID
WHERE SOH.SalesPersonID = 257 AND SOH.Status = 3;
```
-------------------------7098 sample_num
```sql
SELECT COUNT(DISTINCT sd.ProductID) AS DifferentProductsSold
FROM SalesOrderDetail sd
JOIN SpecialOfferProduct sop ON sd.SpecialOfferID = sop.SpecialOfferID
WHERE sop.SpecialOfferID IS NULL AND sd.OrderQty > 2;
```
-------------------------7099 sample_num
```sql
SELECT th.TransactionType
FROM Product p
JOIN ProductInventory pi ON p.ProductID = pi.ProductID
JOIN TransactionHistory th ON p.ProductID = th.ProductID
WHERE p.Color = 'Yellow' 
  AND p.Size = 62 
  AND pi.Quantity >= 500;
```
-------------------------7100 sample_num
```sql
SELECT ps.Name
FROM Product p
JOIN ProductSubcategory ps ON p.ProductSubcategoryID = ps.ProductSubcategoryID
WHERE p.Color = 'gray'
ORDER BY p.SafetyStockLevel ASC
LIMIT 1;
```
-------------------------7101 sample_num
```sql
SELECT p.ProductCostHistory.EndDate
FROM ProductCostHistory pch
JOIN Product p ON pch.ProductID = p.ProductID
WHERE p.WeightUnitMeasureCode = 'G'
ORDER BY p.Weight DESC
LIMIT 1;
```
-------------------------7102 sample_num
```sql
SELECT 
    (SUM(CASE WHEN sr.Name IN ('Drill size too small', 'Drill size too large') THEN wo.ScrappedQty ELSE 0 END) * 100.0) / NULLIF(SUM(wo.OrderQty), 0) AS PercentageNotRejected
FROM 
    WorkOrder wo
JOIN 
    ScrapReason sr ON wo.ScrapReasonID = sr.ScrapReasonID;
```
-------------------------7103 sample_num
```sql
SELECT AVG(OrderQty) AS AverageOrderedQuantity
FROM SalesOrderDetail
JOIN SalesOrderHeader ON SalesOrderDetail.SalesOrderID = SalesOrderHeader.SalesOrderID
JOIN ShipMethod ON SalesOrderHeader.ShipMethodID = ShipMethod.ShipMethodID
WHERE ShipMethod.Name = 'Cargo Transport 5';
```
-------------------------7104 sample_num
```sql
SELECT STR.Name
FROM SalesTerritory ST
JOIN SalesPerson SP ON ST.TerritoryID = SP.TerritoryID
JOIN SalesTaxRate STR ON ST.CountryRegionCode = STR.StateProvinceID
WHERE ST.TerritoryID = (
    SELECT TOP 1 ST2.TerritoryID
    FROM SalesTerritory ST2
    JOIN SalesPerson SP2 ON ST2.TerritoryID = SP2.TerritoryID
    GROUP BY ST2.TerritoryID
    ORDER BY SUM(SP2.SalesYTD - SP2.SalesLastYear) DESC
)
```
-------------------------7105 sample_num
```sql
SELECT COUNT(*) 
FROM EmployeePayHistory 
WHERE PayFrequency = 1 AND Rate > 50;
```
-------------------------7106 sample_num
```sql
SELECT CONCAT(FirstName, ' ', MiddleName, ' ', LastName) AS FullName
FROM Person
WHERE BusinessEntityID = 1 AND PersonType = 'EM';
```
-------------------------7107 sample_num
```sql
SELECT Name FROM Vendor WHERE BusinessEntityID = 1492;
```
-------------------------7108 sample_num
```sql
SELECT COUNT(*) AS VendorCount
FROM Vendor
WHERE MinOrderQty > 500 AND MaxOrderQty < 15000;
```
-------------------------7109 sample_num
```sql
SELECT Name FROM Department WHERE GroupName = 'Executive General and Administration';
```
-------------------------7110 sample_num
```sql
SELECT LastName 
FROM Person 
WHERE PersonType = 'EM' AND MiddleName LIKE 'C%';
```
-------------------------7111 sample_num
```sql
SELECT COUNT(DISTINCT v.BusinessEntityID) AS VendorCount
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
WHERE pv.AverageLeadTime = 25 AND pv.OnOrderQty > 0;
```
-------------------------7112 sample_num
```sql
SELECT TOP 3 ProductNumber
FROM Product
ORDER BY StandardCost ASC;
```
-------------------------7113 sample_num
```sql
SELECT COUNT(*) AS BlackProductsNotForSale
FROM Product
WHERE Color = 'Black' AND FinishedGoodsFlag = 0;
```
-------------------------7114 sample_num
```sql
SELECT TOP 3 BusinessEntityID, JobTitle, SickLeaveHours
FROM Employee
ORDER BY SickLeaveHours DESC;
```
-------------------------7115 sample_num
```sql
SELECT CONCAT(AddressLine1, ' ', AddressLine2) AS FullAddress
FROM Address
WHERE AddressID = 11906;
```
-------------------------7116 sample_num
```sql
SELECT (pv.LastReceiptCost - pv.StandardPrice) AS NetProfit
FROM ProductVendor pv
WHERE pv.BusinessEntityID = 1580;
```
-------------------------7117 sample_num
```sql
SELECT SUM(SalesOrderDetail.LineTotal) AS SalesRevenue
FROM SalesOrderDetail
JOIN SalesOrderHeader ON SalesOrderDetail.SalesOrderID = SalesOrderHeader.SalesOrderID
WHERE SalesOrderDetail.ProductID = 740;
```
-------------------------7118 sample_num
```sql
SELECT DISTINCT pr.ReviewerName
FROM ProductReview pr
WHERE pr.Rating = 5;
```
-------------------------7119 sample_num
```sql
SELECT BusinessEntityID 
FROM Vendor 
WHERE CreditRating = 5;
```
-------------------------7120 sample_num
```sql
SELECT FirstName, BirthDate FROM Person WHERE BusinessEntityID = 18;
```
-------------------------7121 sample_num
```sql
SELECT ct.Name AS Job
FROM Person p
JOIN BusinessEntityContact bec ON p.BusinessEntityID = bec.BusinessEntityID
JOIN ContactType ct ON bec.ContactTypeID = ct.ContactTypeID
WHERE p.PersonID = 18;
```
-------------------------7122 sample_num
```sql
SELECT TOP 3 b.BusinessEntityID, b.Name
FROM BusinessEntity b
JOIN BusinessEntityContact bec ON b.BusinessEntityID = bec.BusinessEntityID
JOIN PhoneNumberType pnt ON bec.ContactTypeID = pnt.PhoneNumberTypeID
WHERE pnt.Name = 'cell';
```
-------------------------7123 sample_num
```sql
SELECT c.Name AS CurrencyName
FROM Currency c
JOIN CountryRegionCurrency crc ON c.CurrencyCode = crc.CurrencyCode
JOIN CountryRegion cr ON crc.CountryRegionCode = cr.CountryRegionCode
WHERE cr.Name = 'Brazil';
```
-------------------------7124 sample_num
```sql
SELECT COUNT(e.BusinessEntityID) AS NumberOfEmployees
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
WHERE d.Name = 'Finance';
```
-------------------------7125 sample_num
```sql
SELECT v.Name AS VendorName, pv.AverageLeadTime
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
WHERE v.BusinessEntityID = 1496;
```
-------------------------7126 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM Address WHERE City = 'Bothell') - 
    (SELECT COUNT(*) FROM Address WHERE City = 'Kenmore') AS AccountDifference,
    (SELECT Name FROM StateProvince WHERE StateProvinceID IN 
        (SELECT StateProvinceID FROM Address WHERE City IN ('Bothell', 'Kenmore')) 
    LIMIT 1) AS StateName
```
-------------------------7127 sample_num
```sql
SELECT pm.Name
FROM ProductModel pm
JOIN ProductModelProductDescriptionCulture pmPDC ON pm.ProductModelID = pmPDC.ProductModelID
JOIN ProductDescription pd ON pmPDC.ProductDescriptionID = pd.ProductDescriptionID
JOIN Culture c ON pmPDC.CultureID = c.CultureID
WHERE pd.Description LIKE '%chromoly steel%'
AND c.Name = 'English'
AND pm.Name LIKE '%AdventureWorks%';
```
-------------------------7128 sample_num
```sql
SELECT COUNT(*) AS TotalCompanies, SalesTerritory.Name AS GeographicalLocation
FROM SalesPerson
JOIN SalesTerritory ON SalesPerson.TerritoryID = SalesTerritory.TerritoryID
WHERE SalesPerson.CommissionPct >= 0.018
GROUP BY SalesTerritory.Name;
```
-------------------------7129 sample_num
```sql
SELECT PhoneNumberTypeID, Name, COUNT(*) AS Count
FROM BusinessEntityContact
JOIN PhoneNumberType ON BusinessEntityContact.ContactTypeID = PhoneNumberType.PhoneNumberTypeID
GROUP BY PhoneNumberTypeID, Name
ORDER BY Count DESC;
```
-------------------------7130 sample_num
```sql
SELECT TOP 1 ContactTypeID, COUNT(*) AS ContactCount
FROM BusinessEntityContact
GROUP BY ContactTypeID
ORDER BY ContactCount DESC;
```
-------------------------7131 sample_num
```sql
SELECT e.EmailAddress
FROM Employee emp
JOIN BusinessEntityContact bec ON emp.BusinessEntityID = bec.BusinessEntityID
JOIN EmailAddress e ON bec.PersonID = e.BusinessEntityID
JOIN Person p ON emp.BusinessEntityID = p.BusinessEntityID
WHERE p.PersonType = 'SP';
```
-------------------------7132 sample_num
```sql
SELECT JobTitle FROM Employee WHERE BusinessEntityID = (SELECT BusinessEntityID FROM Person WHERE FirstName = 'Suchitra');
```
-------------------------7133 sample_num
```sql
SELECT COUNT(*) 
FROM Employee e
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
WHERE p.PersonType = 'EM' AND p.MaritalStatus = 'S';
```
-------------------------7134 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM Product WHERE ProductID IN 
        (SELECT ProductID FROM ProductModelProductDescriptionCulture 
         WHERE CultureID = (SELECT CultureID FROM Culture WHERE Name = 'English'))) AS EnglishCount,
    (SELECT COUNT(*) FROM Product WHERE ProductID IN 
        (SELECT ProductID FROM ProductModelProductDescriptionCulture 
         WHERE CultureID = (SELECT CultureID FROM Culture WHERE Name = 'Arabic'))) AS ArabicCount,
    (SELECT COUNT(*) FROM Product WHERE ProductID IN 
        (SELECT ProductID FROM ProductModelProductDescriptionCulture 
         WHERE CultureID = (SELECT CultureID FROM Culture WHERE Name = 'English'))) - 
    (SELECT COUNT(*) FROM Product WHERE ProductID IN 
        (SELECT ProductID FROM ProductModelProductDescriptionCulture 
         WHERE CultureID = (SELECT CultureID FROM Culture WHERE Name = 'Arabic'))) AS Difference;
```
-------------------------7135 sample_num
```sql
SELECT AddressLine1 
FROM Address 
JOIN BusinessEntityAddress ON Address.AddressID = BusinessEntityAddress.AddressID 
WHERE BusinessEntityAddress.BusinessEntityID = 1;
```
-------------------------7136 sample_num
```sql
SELECT BusinessEntityID, Name 
FROM BusinessEntity 
WHERE BusinessEntityID IN (
    SELECT BusinessEntityID 
    FROM BusinessEntityAddress 
    WHERE AddressID IN (
        SELECT AddressID 
        FROM Address 
        WHERE City = 'Duvall'
    )
);
```
-------------------------7137 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Culture.Name = 'Thai' THEN 1 END) * 100.0) / COUNT(*) AS PercentageThai
FROM 
    Culture;
```
-------------------------7138 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN e.Gender = 'M' THEN 1 END) * 100.0) / COUNT(CASE WHEN e.PersonType = 'EM' THEN 1 END) AS MalePercentage
FROM 
    Employee e;
```
-------------------------7139 sample_num
```sql
SELECT a.AddressLine1, a.City, sp.Name AS StateProvince
FROM Address a
JOIN StateProvince sp ON a.StateProvinceID = sp.StateProvinceID
WHERE a.AddressID = '15873' AND sp.IsOnlyStateProvinceFlag = '0';
```
-------------------------7140 sample_num
```sql
SELECT CONCAT(a.AddressLine1, ' ', a.AddressLine2) AS FullAddress
FROM BusinessEntityAddress bea
JOIN Address a ON bea.AddressID = a.AddressID
WHERE bea.BusinessEntityID = 24;
```
-------------------------7141 sample_num
```sql
SELECT ExpYear FROM CreditCard WHERE CreditCardID = 9648;
```
-------------------------7142 sample_num
```sql
SELECT BusinessEntityID 
FROM Person 
WHERE FirstName = 'Emma' AND LastName = 'Harris';
```
-------------------------7143 sample_num
```sql
SELECT LocationID 
FROM Location 
WHERE Name = 'Debur and Polish';
```
-------------------------7144 sample_num
```sql
SELECT DepartmentID 
FROM Department 
WHERE GroupName = 'Sales and Marketing';
```
-------------------------7145 sample_num
```sql
SELECT sp.BusinessEntityID
FROM SalesOrderHeader soh
JOIN SalesPerson sp ON soh.SalesPersonID = sp.BusinessEntityID
WHERE soh.TotalDue = 1635823.3967
AND YEAR(soh.OrderDate) = YEAR(GETDATE()) - 1;
```
-------------------------7146 sample_num
```sql
SELECT StartTime FROM Shift WHERE ShiftID = 2;
```
-------------------------7147 sample_num
```sql
SELECT Name FROM ContactType WHERE ContactTypeID = 16;
```
-------------------------7148 sample_num
```sql
SELECT MIN(ShipBase) AS MinimumShippingCharge
FROM ShipMethod
WHERE Name = 'OVERSEAS - DELUXE';
```
-------------------------7149 sample_num
```sql
SELECT Name FROM Culture WHERE CultureID = 'fr';
```
-------------------------7150 sample_num
```sql
SELECT CurrencyCode FROM Currency WHERE Name = 'Mauritius Rupee';
```
-------------------------7151 sample_num
```sql
SELECT PhoneNumberTypeID FROM PhoneNumberType WHERE Name = 'Cell';
```
-------------------------7152 sample_num
```sql
SELECT BirthDate 
FROM Employee 
WHERE JobTitle = 'Production Technician' 
AND HireDate = '2008-12-07' 
AND BirthDate = (SELECT MIN(BirthDate) FROM Employee WHERE JobTitle = 'Production Technician');
```
-------------------------7153 sample_num
```sql
SELECT pm.Name 
FROM Product p 
JOIN ProductModel pm ON p.ProductModelID = pm.ProductModelID 
WHERE p.ProductID = 793;
```
-------------------------7154 sample_num
```sql
SELECT um.UnitMeasureCode
FROM ProductInventory pi
JOIN UnitMeasure um ON pi.UnitMeasureCode = um.UnitMeasureCode
WHERE pi.ProductID = 762;
```
-------------------------7155 sample_num
```sql
SELECT a.AddressLine1, a.AddressLine2, a.City
FROM BusinessEntityAddress bea
JOIN Address a ON bea.AddressID = a.AddressID
WHERE bea.BusinessEntityID = 4;
```
-------------------------7156 sample_num
```sql
SELECT UnitMeasureCode 
FROM BillOfMaterials 
WHERE ComponentID = 494 AND EndDate IS NULL;
```
-------------------------7157 sample_num
```sql
SELECT COUNT(*) 
FROM Document d
JOIN Employee e ON d.Owner = e.BusinessEntityID
WHERE e.JobTitle = 'Document Control Assistant' 
  AND e.BirthDate = '1975-12-25' 
  AND d.DocumentSummary IS NULL;
```
-------------------------7158 sample_num
```sql
SELECT ProductID, ListPrice, StartDate
FROM ProductListPriceHistory
WHERE ListPrice - (SELECT StandardCost FROM Product WHERE ProductID = ProductListPriceHistory.ProductID) = 21.9037
AND StartDate > '2012-10-01';
```
-------------------------7159 sample_num
```sql
SELECT LargePhoto, LargePhotoFileName FROM ProductPhoto WHERE ProductID = 1;
```
-------------------------7160 sample_num
```sql
SELECT LENGTH(p.PasswordHash) AS PasswordLength
FROM Person AS pe
JOIN Password AS p ON pe.BusinessEntityID = p.BusinessEntityID
WHERE pe.FirstName = 'Catherine' AND pe.LastName = 'Ward';
```
-------------------------7161 sample_num
```sql
SELECT Rating 
FROM ProductReview 
WHERE ReviewerName = 'Jill' AND ProductID = (SELECT ProductID FROM Product WHERE Name = 'HL Mountain Pedal');
```
-------------------------7162 sample_num
```sql
SELECT SUBTRACT(LastReceiptCost, StandardPrice) AS Profit
FROM ProductVendor
JOIN Product ON ProductVendor.ProductID = Product.ProductID
WHERE Product.Name = 'Freewheel';
```
-------------------------7163 sample_num
```sql
SELECT CASE WHEN Bonus > 0 THEN 'Yes' ELSE 'No' END AS SalesTaskCompleted
FROM SalesPerson
JOIN Person ON SalesPerson.BusinessEntityID = Person.BusinessEntityID
WHERE Person.FirstName = 'Rachel' AND Person.LastName = 'Valdez';
```
-------------------------7164 sample_num
```sql
SELECT COUNT(DISTINCT TaxType) AS TaxTypeCount
FROM SalesTaxRate
WHERE StateProvinceID = (SELECT StateProvinceID FROM StateProvince WHERE Name = 'Quebec')
AND Name LIKE '%+%';
```
-------------------------7165 sample_num
```sql
SELECT e.EmailAddress 
FROM Person p 
JOIN EmailAddress e ON p.BusinessEntityID = e.BusinessEntityID 
WHERE p.FirstName = 'Kevin' AND p.LastName = 'Wright';
```
-------------------------7166 sample_num
```sql
SELECT COUNT(*) 
FROM StateProvince 
WHERE CountryRegionCode = 'FR' AND IsOnlyStateProvinceFlag = 1 AND StateProvinceCode IS NULL;
```
-------------------------7167 sample_num
```sql
SELECT TransactionType 
FROM TransactionHistory 
WHERE ProductID = (SELECT ProductID FROM Product WHERE Name = 'HL Road Frame - Black, 48') 
AND TransactionDate = '2012-12-13';
```
-------------------------7168 sample_num
```sql
SELECT TransactionType 
FROM TransactionHistory 
WHERE TransactionDate = '2012-11-03' 
AND ProductID = (SELECT ProductID FROM Product WHERE Name = 'LL Road Handlebars');
```
-------------------------7169 sample_num
```sql
SELECT CreditRating 
FROM Vendor 
WHERE rowguid = '33671A4E-DF2B-4879-807B-E3F930DD5C0C';
```
-------------------------7170 sample_num
```sql
SELECT PreferredVendorStatus 
FROM Vendor 
WHERE rowguid = '684F328D-C185-43B9-AF9A-37ACC680D2AF';
```
-------------------------7171 sample_num
```sql
SELECT CASE 
           WHEN ActiveFlag = 2 THEN 'Vendor is actively used' 
           WHEN ActiveFlag = 1 THEN 'Vendor no longer used' 
           ELSE 'Unknown status' 
       END AS VendorStatus
FROM Vendor
WHERE BusinessEntityID = (SELECT BusinessEntityID FROM Person WHERE PersonID = 2054);
```
-------------------------7172 sample_num
```sql
SELECT pn.PhoneNumber
FROM Person p
JOIN BusinessEntityContact bec ON p.BusinessEntityID = bec.PersonID
JOIN BusinessEntity be ON bec.BusinessEntityID = be.BusinessEntityID
JOIN PhoneNumber pn ON be.BusinessEntityID = pn.BusinessEntityID
WHERE p.FirstName = 'Gerald' AND p.LastName = 'Patel';
```
-------------------------7173 sample_num
```sql
SELECT PhoneNumberType.Name
FROM BusinessEntityContact
JOIN PhoneNumberType ON BusinessEntityContact.ContactTypeID = PhoneNumberType.PhoneNumberTypeID
WHERE BusinessEntityContact.BusinessEntityID = 13626;
```
-------------------------7174 sample_num
```sql
SELECT JobTitle 
FROM Employee 
JOIN Person ON Employee.BusinessEntityID = Person.BusinessEntityID 
WHERE FirstName = 'Lynn' AND LastName = 'Tsoflias';
```
-------------------------7175 sample_num
```sql
SELECT COUNT(*) AS NumberOfSubCategories
FROM ProductSubcategory
WHERE ProductCategoryID = 1;
```
-------------------------7176 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN d.DocumentSummary IS NULL THEN 1 END) * 100.0) / COUNT(d.DocumentSummary) AS PercentageOfPrivateDocuments
FROM 
    Employee e
JOIN 
    BusinessEntity b ON e.BusinessEntityID = b.BusinessEntityID
JOIN 
    Document d ON b.BusinessEntityID = d.Owner
WHERE 
    e.JobTitle = 'Document Control Assistant' 
    AND e.HireDate = '2009-01-22';
```
-------------------------7177 sample_num
```sql
SELECT 
    Product.Name AS ProductName,
    (LastReceiptCost - StandardCost) / StandardCost AS profit_ratio
FROM 
    Product
JOIN 
    ProductVendor ON Product.ProductID = ProductVendor.ProductID
WHERE 
    Product.Name = 'HL Grip Tape';
```
-------------------------7178 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN PhoneNumberTypeID = 1 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    PhoneNumber;
```
-------------------------7179 sample_num
```sql
SELECT ProductAssemblyID 
FROM BillOfMaterials 
WHERE UnitMeasureCode = 'EA' 
AND BOMLevel = 2 
AND PerAssemblyQty > 10;
```
-------------------------7180 sample_num
```sql
SELECT COUNT(LocationID) 
FROM WorkOrderRouting 
WHERE ActualResourceHrs = 2;
```
-------------------------7181 sample_num
```sql
SELECT SUM(StockedQty) AS TotalStockedQuantity
FROM WorkOrder
WHERE LocationID = 40;
```
-------------------------7182 sample_num
```sql
SELECT 
    UnitMeasureCode, 
    SUM(PerAssemblyQty) AS TotalPerAssemblyQty 
FROM 
    BillOfMaterials 
WHERE 
    UnitMeasureCode IN ('EA', 'IN', 'OZ') 
GROUP BY 
    UnitMeasureCode;
```
-------------------------7183 sample_num
```sql
SELECT ProductID 
FROM Product 
WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM WorkOrder);
```
-------------------------7184 sample_num
```sql
SELECT p.Name
FROM Product p
JOIN TransactionHistory th ON p.ProductID = th.ProductID
WHERE th.TransactionType = 'P';
```
-------------------------7185 sample_num
```sql
SELECT 
    CONCAT(FirstName, ' ', COALESCE(MiddleName, ''), ' ', LastName) AS FullName
FROM 
    Employee
WHERE 
    JobTitle = 'Accountant';
```
-------------------------7186 sample_num
```sql
SELECT e.JobTitle 
FROM Employee e 
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID 
WHERE p.FirstName = 'Ken' AND p.LastName = 'Sánchez';
```
-------------------------7187 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
WHERE Gender = 'M' AND BusinessEntityID IN (
    SELECT BusinessEntityID 
    FROM Person 
    WHERE EmailPromotion = 0
);
```
-------------------------7188 sample_num
```sql
SELECT TOP 1 
    sp.BusinessEntityID, 
    (SUM(sp.SalesLastYear) / SUM(spq.SalesQuota)) * 100 AS PercentageAchieved
FROM 
    SalesPerson sp
JOIN 
    SalesPersonQuotaHistory spq ON sp.BusinessEntityID = spq.BusinessEntityID
WHERE 
    YEAR(spq.QuotaDate) = 2013
GROUP BY 
    sp.BusinessEntityID
ORDER BY 
    PercentageAchieved DESC;
```
-------------------------7189 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
WHERE MaritalStatus = 'M' 
AND BusinessEntityID IN (SELECT BusinessEntityID FROM Person WHERE PersonType = 'EM');
```
-------------------------7190 sample_num
```sql
SELECT COUNT(DISTINCT b.BusinessEntityID) AS VendorContactCount
FROM Employee e
JOIN BusinessEntityContact b ON e.BusinessEntityID = b.BusinessEntityID
JOIN Person p ON b.PersonID = p.BusinessEntityID
WHERE e.JobTitle LIKE 'Production Technician%' 
  AND e.MaritalStatus = 'S' 
  AND p.PersonType = 'VC';
```
-------------------------7191 sample_num
```sql
SELECT SUM(SickLeaveHours) AS TotalSickLeaveHours
FROM Employee
WHERE BusinessEntityID IN (
    SELECT BusinessEntityID
    FROM Person
    WHERE EmailPromotion = 0
);
```
-------------------------7192 sample_num
```sql
SELECT p.FirstName, p.LastName, e.HireDate
FROM Person p
JOIN Employee e ON p.BusinessEntityID = e.BusinessEntityID
JOIN SalesPerson sp ON e.BusinessEntityID = sp.BusinessEntityID
WHERE e.HireDate < '2010-01-01';
```
-------------------------7193 sample_num
```sql
SELECT 
    p.FirstName, 
    p.LastName, 
    sp.SalesYTD, 
    sp.SalesQuota * 12 AS ProjectedYearlySalesQuota
FROM 
    SalesPerson sp
JOIN 
    Person p ON sp.BusinessEntityID = p.BusinessEntityID
WHERE 
    p.PersonType = 'SP'
ORDER BY 
    sp.SalesYTD DESC
LIMIT 1;
```
-------------------------7194 sample_num
```sql
SELECT COUNT(*)
FROM Person
JOIN Employee ON Person.BusinessEntityID = Employee.BusinessEntityID
WHERE Person.FirstName = 'Alex' 
  AND Employee.MaritalStatus = 'S' 
  AND Employee.OrganizationLevel = 1;
```
-------------------------7195 sample_num
```sql
SELECT AVG(E.VacationHours) AS AverageVacationHours
FROM Employee E
JOIN SalesPerson S ON E.BusinessEntityID = S.BusinessEntityID
WHERE E.PersonType = 'SC';
```
-------------------------7196 sample_num
```sql
SELECT p.LastName, e.JobTitle
FROM Document d
JOIN Employee e ON d.Owner = e.BusinessEntityID
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
WHERE d.Title = 'Crank Arm and Tire Maintenance';
```
-------------------------7197 sample_num
```sql
SELECT OrganizationLevel
FROM Employee
WHERE Suffix IS NULL;
```
-------------------------7198 sample_num
```sql
SELECT DISTINCT sp.BusinessEntityID
FROM SalesPersonQuotaHistory spq
JOIN SalesPerson sp ON spq.BusinessEntityID = sp.BusinessEntityID
WHERE spq.QuotaDate BETWEEN '2013-01-01' AND '2013-12-31'
  AND spq.SalesQuota <= sp.SalesQuota
  AND sp.TerritoryID = 1;
```
-------------------------7199 sample_num
```sql
SELECT p.LastName
FROM Employee e
JOIN JobCandidate jc ON e.BusinessEntityID = jc.BusinessEntityID
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
WHERE d.Name = 'Human Resources' AND edh.EndDate IS NULL;
```
-------------------------7200 sample_num
```sql
SELECT e.EmailAddress
FROM Employee emp
JOIN BusinessEntityContact bec ON emp.BusinessEntityID = bec.BusinessEntityID
JOIN EmailAddress e ON bec.PersonID = e.BusinessEntityID
WHERE emp.Gender = 'F' AND emp.MaritalStatus = 'S';
```
-------------------------7201 sample_num
```sql
SELECT DISTINCT p.Color
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID;
```
-------------------------7202 sample_num
```sql
SELECT 
    SUM(CASE WHEN YEAR(QuotaDate) = 2013 THEN SalesQuota ELSE 0 END) AS ProjectedSalesQuota2013,
    SalesYTD
FROM 
    SalesPersonQuotaHistory
JOIN 
    SalesPerson ON SalesPersonQuotaHistory.BusinessEntityID = SalesPerson.BusinessEntityID
WHERE 
    SalesPerson.BusinessEntityID = 275;
```
-------------------------7203 sample_num
```sql
SELECT BusinessEntityID 
FROM SalesPersonQuotaHistory 
WHERE YEAR(QuotaDate) = 2013 AND SalesQuota > (SELECT SalesYTD FROM SalesPerson WHERE SalesPerson.BusinessEntityID = SalesPersonQuotaHistory.BusinessEntityID);
```
-------------------------7204 sample_num
```sql
SELECT 
    DIVIDE(SUM(CASE WHEN Gender = 'F' THEN 1 ELSE 0 END), 
           SUM(CASE WHEN Gender IN ('F', 'M') THEN 1 ELSE 0 END)) AS percentage
FROM 
    Employee
WHERE 
    EmailPromotion = 1;
```
-------------------------7205 sample_num
```sql
SELECT 
    SUM(CASE WHEN e.MaritalStatus = 'M' AND e.JobTitle <> 'Sales' THEN 1 ELSE 0 END) AS MarriedNonSalesEmployees,
    SUM(CASE WHEN e.MaritalStatus = 'S' AND e.JobTitle <> 'Sales' THEN 1 ELSE 0 END) AS SingleNonSalesEmployees
FROM 
    Employee e
JOIN 
    Person p ON e.BusinessEntityID = p.BusinessEntityID
WHERE 
    p.PersonType = 'EM';
```
-------------------------7206 sample_num
```sql
SELECT 
    SUM(Bonus) AS TotalBonus,
    (SUM(Bonus) / SUM(SalesQuota)) * 100 AS Percentage
FROM 
    SalesPersonQuotaHistory
JOIN 
    SalesPerson ON SalesPersonQuotaHistory.BusinessEntityID = SalesPerson.BusinessEntityID
WHERE 
    YEAR(QuotaDate) = 2013;
```
-------------------------7207 sample_num
```sql
SELECT COUNT(DISTINCT CardType) AS TotalCardTypes, 
       SUM(CASE WHEN CardType = 'Vista' THEN 1 ELSE 0 END) AS VistaCount
FROM CreditCard;
```
-------------------------7208 sample_num
```sql
SELECT Name FROM Product WHERE ProductID = 475;
```
-------------------------7209 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
WHERE BirthDate < '1980-01-01' AND (MaritalStatus = 'S' OR MaritalStatus IS NULL);
```
-------------------------7210 sample_num
```sql
SELECT Store.Name
FROM Store
JOIN SalesPerson ON Store.SalesPersonID = SalesPerson.BusinessEntityID
WHERE SalesPerson.BusinessEntityID = 277;
```
-------------------------7211 sample_num
```sql
SELECT SUM(Quantity) AS TotalSold
FROM TransactionHistory
WHERE ProductID = 989 
AND TransactionDate BETWEEN '2013-08-01' AND '2013-08-30' 
AND TransactionType = 'S';
```
-------------------------7212 sample_num
```sql
SELECT * FROM CreditCard WHERE ExpYear < 2007;
```
-------------------------7213 sample_num
```sql
SELECT eph.Rate
FROM EmployeePayHistory eph
JOIN Employee e ON eph.BusinessEntityID = e.BusinessEntityID
WHERE YEAR(e.HireDate) - YEAR(e.BirthDate) = 20;
```
-------------------------7214 sample_num
```sql
SELECT st.Name
FROM SalesPerson sp
JOIN SalesTerritory st ON sp.TerritoryID = st.TerritoryID
WHERE sp.BusinessEntityID = 277;
```
-------------------------7215 sample_num
```sql
SELECT FirstName + ' ' + COALESCE(MiddleName + ' ', '') + LastName AS FullName
FROM Employee
WHERE JobTitle = 'Vice President of Production';
```
-------------------------7216 sample_num
```sql
SELECT COUNT(e.BusinessEntityID) AS EmployeeCount
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
JOIN Shift s ON edh.ShiftID = s.ShiftID
WHERE d.Name = 'Information Service' AND s.Name = 'Evening';
```
-------------------------7217 sample_num
```sql
SELECT poh.PurchaseOrderID
FROM PurchaseOrderHeader poh
JOIN Vendor v ON poh.VendorID = v.BusinessEntityID
WHERE v.CreditRating < 5;
```
-------------------------7218 sample_num
```sql
SELECT 
    CASE 
        WHEN ct.Name = 'Work' THEN 'Work Number' 
        WHEN ct.Name = 'Home' THEN 'Home Number' 
        ELSE 'Unknown' 
    END AS PhoneNumberType
FROM 
    PhoneNumberType ct
JOIN 
    EmailAddress ea ON ea.BusinessEntityID = (SELECT BusinessEntityID FROM EmailAddress WHERE EmailAddress = '114-555-0100')
WHERE 
    ea.EmailAddressID = (SELECT EmailAddressID FROM EmailAddress WHERE EmailAddress = '114-555-0100');
```
-------------------------7219 sample_num
```sql
SELECT SUM(PurchaseOrderHeader.Freight) AS TotalShipmentCost
FROM PurchaseOrderHeader
JOIN ShipMethod ON PurchaseOrderHeader.ShipMethodID = ShipMethod.ShipMethodID
WHERE ShipMethod.Name = 'Cargo Transport 5' 
AND PurchaseOrderHeader.OrderDate = '2011-12-14';
```
-------------------------7220 sample_num
```sql
SELECT COUNT(so.SalesOrderID) AS SalesOrderCount
FROM SalesOrderHeader so
JOIN SalesPerson sp ON so.SalesPersonID = sp.BusinessEntityID
JOIN Person p ON sp.BusinessEntityID = p.BusinessEntityID
WHERE p.FirstName = 'David' AND p.LastName = 'Campbell' AND p.PersonType = 'SP';
```
-------------------------7221 sample_num
```sql
SELECT e.EmailAddress
FROM Employee AS e
JOIN BusinessEntityContact AS bec ON e.BusinessEntityID = bec.BusinessEntityID
JOIN EmailAddress AS ea ON bec.PersonID = ea.BusinessEntityID
WHERE e.JobTitle = 'Facilities Manager';
```
-------------------------7222 sample_num
```sql
SELECT COUNT(DISTINCT c.CustomerID) AS CustomerCount
FROM Customer c
JOIN SalesTerritory st ON c.TerritoryID = st.TerritoryID
WHERE st.Name = 'Canada';
```
-------------------------7223 sample_num
```sql
SELECT CONCAT(a.AddressLine1, ' ', a.AddressLine2, ' ', a.City) AS ShippingAddress
FROM SalesOrderHeader soh
JOIN Address a ON soh.ShipToAddressID = a.AddressID
WHERE soh.SalesOrderID = 43873;
```
-------------------------7224 sample_num
```sql
SELECT FirstName 
FROM Employee 
WHERE SickLeaveHours > 65;
```
-------------------------7225 sample_num
```sql
SELECT COUNT(*) 
FROM Employee e
JOIN EmployeePayHistory eph ON e.BusinessEntityID = eph.BusinessEntityID
WHERE e.JobTitle = 'Production Technician' 
AND eph.Rate < (SELECT AVG(Rate) FROM EmployeePayHistory WHERE BusinessEntityID IN (SELECT BusinessEntityID FROM Employee WHERE JobTitle = 'Production Technician'));
```
-------------------------7226 sample_num
```sql
SELECT 
    DIVIDE(SUM(CASE WHEN cr.Name = 'United Kingdom' THEN 1 ELSE 0 END), COUNT(so.SalesOrderID)) AS ProportionOfUKSalesOrders
FROM 
    SalesOrderHeader so
JOIN 
    Customer c ON so.CustomerID = c.CustomerID
JOIN 
    BusinessEntity be ON c.PersonID = be.BusinessEntityID
JOIN 
    BusinessEntityAddress bea ON be.BusinessEntityID = bea.BusinessEntityID
JOIN 
    Address a ON bea.AddressID = a.AddressID
JOIN 
    StateProvince sp ON a.StateProvinceID = sp.StateProvinceID
JOIN 
    CountryRegion cr ON sp.CountryRegionCode = cr.CountryRegionCode;
```
-------------------------7227 sample_num
```sql
SELECT ModifiedDate 
FROM PhoneNumberType 
WHERE PhoneNumberTypeID = (SELECT PhoneNumberTypeID FROM EmailAddress WHERE EmailAddress = '1500 555-0143');
```
-------------------------7228 sample_num
```sql
SELECT TOP 1 sp.BusinessEntityID
FROM SalesPerson sp
ORDER BY sp.SalesYTD DESC;
```
-------------------------7229 sample_num
```sql
SELECT *
FROM Vendor
WHERE ActiveFlag = 1 AND PurchasingWebServiceURL IS NOT NULL;
```
-------------------------7230 sample_num
```sql
SELECT TOP 1 st.Name AS TerritoryName, COUNT(c.CustomerID) AS CustomerCount
FROM SalesTerritory st
JOIN Customer c ON st.TerritoryID = c.TerritoryID
WHERE c.ModifiedDate BETWEEN '2014-09-12 00:00:00' AND '2014-09-12 23:59:59'
GROUP BY st.Name
ORDER BY CustomerCount DESC;
```
-------------------------7231 sample_num
```sql
SELECT SUM(TotalDue) AS TotalCost
FROM SalesOrderHeader
WHERE OrderDate = '2013-05-29';
```
-------------------------7232 sample_num
```sql
SELECT TOP 1 FirstName, COUNT(*) AS NameCount
FROM Person
JOIN BusinessEntityContact ON Person.BusinessEntityID = BusinessEntityContact.PersonID
WHERE BusinessEntityContact.ContactTypeID = (SELECT ContactTypeID FROM ContactType WHERE Name = 'Vendor')
GROUP BY FirstName
ORDER BY NameCount DESC;
```
-------------------------7233 sample_num
```sql
SELECT FirstName + ' ' + COALESCE(MiddleName + ' ', '') + LastName AS FullName
FROM Employee
WHERE JobTitle = 'Production Technician - WC50';
```
-------------------------7234 sample_num
```sql
SELECT SUM(OrderQty) AS TotalMinipumpsSold
FROM SalesOrderDetail
WHERE ProductID IN (SELECT ProductID FROM Product WHERE Name = 'Minipump');
```
-------------------------7235 sample_num
```sql
SELECT BusinessEntityID 
FROM PersonCreditCard 
WHERE CreditCardID = (SELECT CreditCardID FROM CreditCard WHERE CardNumber = '11113366963373');
```
-------------------------7236 sample_num
```sql
SELECT a.*
FROM Address a
JOIN BusinessEntityAddress bea ON a.AddressID = bea.AddressID
JOIN Person p ON bea.BusinessEntityID = p.BusinessEntityID
JOIN AddressType at ON bea.AddressTypeID = at.AddressTypeID
WHERE p.BusinessEntityID = 5555 AND at.Name = 'Home';
```
-------------------------7237 sample_num
```sql
SELECT p.Name
FROM Product p
JOIN SpecialOfferProduct sop ON p.ProductID = sop.ProductID
JOIN SpecialOffer so ON sop.SpecialOfferID = so.SpecialOfferID
WHERE so.Description = '15';
```
-------------------------7238 sample_num
```sql
SELECT c.CardNumber 
FROM CreditCard c
JOIN Person p ON c.BusinessEntityID = p.BusinessEntityID
WHERE p.FirstName = 'Michelle' AND p.LastName = 'Cox';
```
-------------------------7239 sample_num
```sql
SELECT sr.ReasonType
FROM SalesOrderHeader soh
JOIN SalesOrderHeaderSalesReason sohsr ON soh.SalesOrderID = sohsr.SalesOrderID
JOIN SalesReason sr ON sohsr.SalesReasonID = sr.SalesReasonID
WHERE soh.SalesOrderID = 51883;
```
-------------------------7240 sample_num
```sql
SELECT c.CardNumber
FROM SalesOrderHeader soh
JOIN CreditCard c ON soh.CreditCardID = c.CreditCardID
WHERE soh.SalesOrderID = 45793;
```
-------------------------7241 sample_num
```sql
SELECT sp.*
FROM SalesPerson sp
JOIN SalesTerritory st ON sp.TerritoryID = st.TerritoryID
WHERE st.Name = 'Northwest' AND st.CountryRegionCode = 'US';
```
-------------------------7242 sample_num
```sql
SELECT e.BusinessEntityID, e.JobTitle, ep.Rate
FROM Employee e
JOIN EmployeePayHistory ep ON e.BusinessEntityID = ep.BusinessEntityID
WHERE e.JobTitle = 'Production Technician'
ORDER BY ep.Rate DESC
LIMIT 1;
```
-------------------------7243 sample_num
```sql
SELECT CONCAT(E.FirstName, ' ', E.MiddleName, ' ', E.LastName) AS FullName
FROM SalesPerson SP
JOIN Employee E ON SP.BusinessEntityID = E.BusinessEntityID
WHERE SP.TerritoryID = 9;
```
-------------------------7244 sample_num
```sql
SELECT so.Description 
FROM SpecialOffer so 
JOIN SpecialOfferProduct sop ON so.SpecialOfferID = sop.SpecialOfferID 
WHERE sop.ProductID = 762;
```
-------------------------7245 sample_num
```sql
SELECT 
    AVG(CASE WHEN Gender = 'M' THEN Rate END) AS AvgMaleRate,
    AVG(CASE WHEN Gender = 'F' THEN Rate END) AS AvgFemaleRate,
    (AVG(CASE WHEN Gender = 'F' THEN Rate END) - AVG(CASE WHEN Gender = 'M' THEN Rate END)) AS diff
FROM 
    EmployeePayHistory
JOIN 
    Employee ON EmployeePayHistory.BusinessEntityID = Employee.BusinessEntityID;
```
-------------------------7246 sample_num
```sql
SELECT 
    (SUM(CASE WHEN ShiftID = (SELECT ShiftID FROM Shift WHERE Name = 'Night') THEN 1 ELSE 0 END) * 100.0) / COUNT(ShiftID) AS percentage
FROM 
    Employee;
```
-------------------------7247 sample_num
```sql
SELECT COUNT(*) 
FROM Employee 
WHERE MaritalStatus = 'M' 
AND Gender = 'M' 
AND BirthDate <= '1959-12-31';
```
-------------------------7248 sample_num
```sql
SELECT TOP 5 ProductSubcategoryID, MAX(ListPrice) AS HighestSellingPrice
FROM Product
GROUP BY ProductSubcategoryID
ORDER BY HighestSellingPrice DESC;
```
-------------------------7249 sample_num
```sql
SELECT MIN(HireDate) AS FirstAccountantHired
FROM Employee
WHERE JobTitle = 'Accountant';
```
-------------------------7250 sample_num
```sql
SELECT TOP 1 JobTitle, COUNT(*) AS HireCount
FROM Employee
WHERE HireDate BETWEEN '2007-01-01' AND '2007-12-31'
GROUP BY JobTitle
ORDER BY HireCount DESC;
```
-------------------------7251 sample_num
```sql
SELECT 
    Vendor.BusinessEntityID,
    Vendor.Name,
    (ProductVendor.LastReceiptCost - ProductVendor.StandardPrice) AS ProfitOnNet
FROM 
    ProductVendor
JOIN 
    Vendor ON ProductVendor.BusinessEntityID = Vendor.BusinessEntityID
WHERE 
    ProductVendor.StandardPrice = (
        SELECT MAX(StandardPrice) 
        FROM ProductVendor
    )
LIMIT 1;
```
-------------------------7252 sample_num
```sql
SELECT COUNT(DISTINCT DepartmentID) AS NumberOfDepartments
FROM EmployeeDepartmentHistory edh
JOIN Employee e ON edh.BusinessEntityID = e.BusinessEntityID
WHERE e.FirstName = 'Sheela' AND e.LastName = 'Ward'
AND (YEAR(edh.StartDate) BETWEEN 2011 AND 2012 OR YEAR(edh.EndDate) BETWEEN 2011 AND 2012);
```
-------------------------7253 sample_num
```sql
SELECT AVG(2009 - YEAR(BirthDate)) AS AverageAge
FROM Employee
WHERE BirthDate IS NOT NULL;
```
-------------------------7254 sample_num
```sql
SELECT d.Name, d.GroupName
FROM Department d
JOIN EmployeeDepartmentHistory edh ON d.DepartmentID = edh.DepartmentID
GROUP BY d.DepartmentID, d.Name, d.GroupName
ORDER BY COUNT(edh.BusinessEntityID) ASC
LIMIT 1;
```
-------------------------7255 sample_num
```sql
SELECT 
    SUBTRACT(2015, YEAR(BirthDate)) AS Age, 
    Rate 
FROM 
    Employee 
WHERE 
    JobTitle = 'Marketing Specialist' 
    AND BirthDate IS NOT NULL 
ORDER BY 
    BirthDate 
LIMIT 1;
```
-------------------------7256 sample_num
```sql
SELECT v.Name AS VendorName, SUM(poh.TotalDue) AS TotalAmountDue
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
JOIN PurchaseOrderDetail pod ON pv.ProductID = pod.ProductID
JOIN PurchaseOrderHeader poh ON pod.PurchaseOrderID = poh.PurchaseOrderID
WHERE pv.StandardPrice = (
    SELECT MIN(StandardPrice)
    FROM ProductVendor
)
GROUP BY v.Name;
```
-------------------------7257 sample_num
```sql
SELECT 
    p.BusinessEntityID AS EmployeeID,
    YEAR(HireDate) - YEAR(BirthDate) AS AgeAtHire
FROM 
    PurchaseOrderHeader poh
JOIN 
    Employee e ON poh.EmployeeID = e.BusinessEntityID
JOIN 
    Person p ON e.BusinessEntityID = p.BusinessEntityID
WHERE 
    (TotalDue - Freight) = (
        SELECT MAX(TotalDue - Freight) 
        FROM PurchaseOrderHeader
    );
```
-------------------------7258 sample_num
```sql
SELECT 
    CONCAT(FirstName, ' ', MiddleName, ' ', LastName) AS FullName,
    Rate AS Salary
FROM 
    Employee
ORDER BY 
    Rate DESC
OFFSET 9 ROWS
FETCH NEXT 1 ROWS ONLY;
```
-------------------------7259 sample_num
```sql
SELECT p.Name, (p.ListPrice - p.StandardCost) AS Profit
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE pr.ReviewerName = 'John Smith' AND pr.Rating = 5;
```
-------------------------7260 sample_num
```sql
SELECT Employee.BusinessEntityID, Employee.JobTitle, Employee.HireDate, EmployeePayHistory.Rate / 40 AS SalaryRatePerHour
FROM Employee
JOIN EmployeePayHistory ON Employee.BusinessEntityID = EmployeePayHistory.BusinessEntityID
ORDER BY Employee.HireDate ASC
LIMIT 5;
```
-------------------------7261 sample_num
```sql
SELECT TOP 1 v.BusinessEntityID, v.Name, (pv.StandardPrice - pv.LastReceiptCost) AS ProfitOnNet
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
WHERE pv.MaxOrderQty BETWEEN 500 AND 750
ORDER BY ProfitOnNet DESC
OFFSET 9 ROWS;
```
-------------------------7262 sample_num
```sql
SELECT 
    E.BusinessEntityID,
    E.FirstName,
    E.LastName,
    YEAR('2011-12-31') - YEAR(E.HireDate) AS LengthOfStay
FROM 
    Employee E
JOIN 
    SalesOrderHeader SO ON E.BusinessEntityID = SO.SalesPersonID
WHERE 
    SO.Status = 1
    AND E.HireDate IS NOT NULL;
```
-------------------------7263 sample_num
```sql
SELECT p.Name, p.DaysToManufacture
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE pr.Rating = 2 AND p.Class = 'M'
ORDER BY pr.Rating DESC
LIMIT 1;
```
-------------------------7264 sample_num
```sql
SELECT TOP 1 
    CONCAT(e.FirstName, ' ', e.MiddleName, ' ', e.LastName) AS FullName, 
    e.JobTitle 
FROM 
    Employee e 
ORDER BY 
    e.HireDate ASC;
```
-------------------------7265 sample_num
```sql
SELECT COUNT(*) 
FROM WorkOrder w
JOIN Product p ON w.ProductID = p.ProductID
WHERE w.Quantity BETWEEN 100 AND 250 
AND p.ReorderPoint <= 375 
AND w.TransactionType = 'W';
```
-------------------------7266 sample_num
```sql
SELECT 
    (SELECT AVG(Rate) FROM EmployeePayHistory WHERE BusinessEntityID IN (SELECT BusinessEntityID FROM Employee WHERE Gender = 'F')) AS AvgFemaleSalary,
    (SELECT AVG(Rate) FROM EmployeePayHistory WHERE BusinessEntityID IN (SELECT BusinessEntityID FROM Employee WHERE Gender = 'M')) AS AvgMaleSalary,
    (SELECT AVG(Rate) FROM EmployeePayHistory WHERE BusinessEntityID IN (SELECT BusinessEntityID FROM Employee WHERE Gender = 'F')) - 
    (SELECT AVG(Rate) FROM EmployeePayHistory WHERE BusinessEntityID IN (SELECT BusinessEntityID FROM Employee WHERE Gender = 'M')) AS SalaryDifference
```
-------------------------7267 sample_num
```sql
SELECT v.Name
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
JOIN Product p ON pv.ProductID = p.ProductID
WHERE p.MakeFlag = 0 
  AND p.Style = 'W' 
  AND p.ProductSubcategoryID = (SELECT ProductSubcategoryID FROM ProductSubcategory WHERE Name = 'Tights');
```
-------------------------7268 sample_num
```sql
SELECT PayFrequency, COUNT(*) AS Frequency
FROM EmployeePayHistory
WHERE BusinessEntityID = (SELECT BusinessEntityID FROM Employee WHERE JobTitle = 'Scheduling Assistant' ORDER BY HireDate ASC LIMIT 1)
GROUP BY PayFrequency;
```
-------------------------7269 sample_num
```sql
SELECT 
    p.Class, 
    p.ProductLine, 
    p.ListPrice
FROM 
    Product p
JOIN 
    SalesOrderDetail sod ON p.ProductID = sod.ProductID
JOIN 
    SalesOrderHeader soh ON sod.SalesOrderID = soh.SalesOrderID
WHERE 
    soh.OnlineOrderFlag = 1
GROUP BY 
    p.ProductID, p.Class, p.ProductLine, p.ListPrice
ORDER BY 
    SUM(sod.OrderQty) ASC
LIMIT 1;
```
-------------------------7270 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.MiddleName, ' ', e.LastName) AS FullName
FROM SalesPerson sp
JOIN Employee e ON sp.BusinessEntityID = e.BusinessEntityID
WHERE sp.CommissionPct = (SELECT MAX(CommissionPct) FROM SalesPerson);
```
-------------------------7271 sample_num
```sql
SELECT TOP 1 
    FirstName + ' ' + COALESCE(MiddleName + ' ', '') + LastName AS FullName
FROM 
    Employee
ORDER BY 
    DATEDIFF(YEAR, BirthDate, HireDate) ASC
OFFSET 1 ROWS;
```
-------------------------7272 sample_num
```sql
SELECT 
    p.Name AS ProductName,
    SUM((p.ListPrice - p.StandardCost) * sod.OrderQty) AS TotalProfit
FROM 
    SalesOrderDetail sod
JOIN 
    SalesOrderHeader soh ON sod.SalesOrderID = soh.SalesOrderID
JOIN 
    Product p ON sod.ProductID = p.ProductID
WHERE 
    soh.OnlineOrderFlag = 1
GROUP BY 
    p.ProductID, p.Name
ORDER BY 
    SUM(sod.OrderQty) DESC
LIMIT 1;
```
-------------------------7273 sample_num
```sql
SELECT TOP 1 
    po.PurchaseOrderID, 
    v.Name AS VendorName, 
    MAX(po.OrderQty - po.ReceivedQty) AS MaxDifference
FROM 
    PurchaseOrderDetail po
JOIN 
    PurchaseOrderHeader poh ON po.PurchaseOrderID = poh.PurchaseOrderID
JOIN 
    Vendor v ON poh.VendorID = v.BusinessEntityID
GROUP BY 
    po.PurchaseOrderID, v.Name
ORDER BY 
    MaxDifference DESC;
```
-------------------------7274 sample_num
```sql
SELECT 
    AVG(PV.AverageLeadTime) AS AverageLeadTime,
    (PV.LastReceiptCost - P.StandardCost) AS ProfitOnNet,
    CONCAT(A.AddressLine1, ' ', A.AddressLine2, ' ', A.City, ' ', A.PostalCode) AS FullLocation
FROM 
    ProductVendor PV
JOIN 
    Product P ON PV.ProductID = P.ProductID
JOIN 
    Vendor V ON PV.BusinessEntityID = V.BusinessEntityID
JOIN 
    BusinessEntityAddress BEA ON V.BusinessEntityID = BEA.BusinessEntityID
JOIN 
    Address A ON BEA.AddressID = A.AddressID
WHERE 
    P.ProductID = 843
GROUP BY 
    PV.LastReceiptCost, P.StandardCost, A.AddressLine1, A.AddressLine2, A.City, A.PostalCode;
```
-------------------------7275 sample_num
```sql
SELECT COUNT(*) AS SalespersonsNotMetQuota
FROM SalesPerson
WHERE Bonus = 0;
```
-------------------------7276 sample_num
```sql
SELECT COUNT(*) 
FROM SalesTaxRate 
WHERE TaxType = 1 AND Name LIKE '%+%';
```
-------------------------7277 sample_num
```sql
SELECT MAX(ActualCost) AS HighestProductCost
FROM TransactionHistory
WHERE TransactionType = 'P';
```
-------------------------7278 sample_num
```sql
SELECT Status 
FROM SalesOrderHeader 
WHERE Freight = (SELECT MAX(Freight) FROM SalesOrderHeader);
```
-------------------------7279 sample_num
```sql
SELECT COUNT(*) AS OutOfStockProducts
FROM ProductVendor
WHERE OnOrderQty = 0;
```
-------------------------7280 sample_num
```sql
SELECT ProductID, MAX(StandardPrice - LastReceiptCost) AS HighestProfit
FROM ProductVendor
JOIN Product ON ProductVendor.ProductID = Product.ProductID
GROUP BY ProductID
ORDER BY HighestProfit DESC
LIMIT 1;
```
-------------------------7281 sample_num
```sql
SELECT ReviewerName, COUNT(*) AS HighestRatingCount
FROM ProductReview
WHERE Rating = (SELECT MAX(Rating) FROM ProductReview)
GROUP BY ReviewerName
ORDER BY HighestRatingCount DESC
LIMIT 1;
```
-------------------------7282 sample_num
```sql
SELECT ProductID, COUNT(ProductReviewID) AS ReviewCount
FROM ProductReview
GROUP BY ProductID
ORDER BY ReviewCount DESC
LIMIT 1;
```
-------------------------7283 sample_num
```sql
SELECT COUNT(DISTINCT p.ProductID) AS ProductsWithoutHighestRating
FROM Product p
JOIN SalesOrderDetail sod ON p.ProductID = sod.ProductID
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE p.MakeFlag = 0 AND pr.Rating <> 5;
```
-------------------------7284 sample_num
```sql
SELECT MAX(review_count) AS BiggestAmountOfReviews
FROM (
    SELECT ProductID, COUNT(ProductReviewID) AS review_count
    FROM ProductReview
    WHERE ProductID IN (SELECT ProductID FROM Product WHERE FinishedGoodsFlag = 1)
    GROUP BY ProductID
) AS review_counts;
```
-------------------------7285 sample_num
```sql
SELECT COUNT(*) 
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE p.MakeFlag = 1 
  AND p.FinishedGoodsFlag = 1 
GROUP BY p.ProductID 
HAVING COUNT(pr.Comments) > 10;
```
-------------------------7286 sample_num
```sql
SELECT p.Name
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE p.FinishedGoodsFlag = 1
GROUP BY p.ProductID, p.Name
HAVING COUNT(pr.Comments) > 10;
```
-------------------------7287 sample_num
```sql
SELECT ReviewerName
FROM ProductReview
JOIN Product ON ProductReview.ProductID = Product.ProductID
WHERE Product.Class = 'M' AND Product.Style = 'W' AND ProductReview.Rating = 5;
```
-------------------------7288 sample_num
```sql
SELECT Class
FROM Product
WHERE ProductID = (
    SELECT ProductID
    FROM ProductReview
    GROUP BY ProductID
    ORDER BY COUNT(Comments) DESC
    LIMIT 1
);
```
-------------------------7289 sample_num
```sql
SELECT DISTINCT e.EmailAddress
FROM ProductReview pr
JOIN Product p ON pr.ProductID = p.ProductID
JOIN EmailAddress e ON pr.ReviewerName = e.EmailAddressID
WHERE p.Class = 'H';
```
-------------------------7290 sample_num
```sql
SELECT p.Name
FROM Product p
JOIN ProductListPriceHistory plph ON p.ProductID = plph.ProductID
GROUP BY p.ProductID, p.Name
HAVING COUNT(plph.ListPrice) > 3;
```
-------------------------7291 sample_num
```sql
SELECT pd.Description 
FROM Product p 
JOIN ProductDescription pd ON p.ProductID = pd.ProductDescriptionID 
WHERE p.Name = 'Headset Ball Bearings';
```
-------------------------7292 sample_num
```sql
SELECT MAX(StandardPrice) AS HighestVendorSellingPrice
FROM ProductVendor PV
JOIN Product P ON PV.ProductID = P.ProductID
WHERE P.Name = 'Hex Nut 5';
```
-------------------------7293 sample_num
```sql
SELECT v.Name AS VendorName, pv.StandardPrice
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
JOIN Product p ON pv.ProductID = p.ProductID
WHERE p.Name = 'Hex Nut 5';
```
-------------------------7294 sample_num
```sql
SELECT COUNT(DISTINCT v.BusinessEntityID) AS GoodCreditRatingVendors
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
JOIN Product p ON pv.ProductID = p.ProductID
WHERE p.Name = 'Hex Nut 5' AND v.CreditRating BETWEEN 1 AND 3;
```
-------------------------7295 sample_num
```sql
SELECT v.PurchasingWebServiceURL
FROM Product p
JOIN ProductVendor pv ON p.ProductID = pv.ProductID
JOIN Vendor v ON pv.BusinessEntityID = v.BusinessEntityID
WHERE p.Name = 'Hex Nut 5';
```
-------------------------7296 sample_num
```sql
SELECT v.Name
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
JOIN Product p ON pv.ProductID = p.ProductID
WHERE p.Name = 'Hex Nut 5'
ORDER BY pv.StandardPrice ASC
LIMIT 1;
```
-------------------------7297 sample_num
```sql
SELECT COUNT(*) AS HighClassProductsSold
FROM SalesOrderDetail sod
JOIN Product p ON sod.ProductID = p.ProductID
JOIN ProductVendor pv ON p.ProductID = pv.ProductID
WHERE pv.PreferredVendorStatus = 1 AND p.Class = 'H';
```
-------------------------7298 sample_num
```sql
SELECT pl.ListPrice
FROM ProductListPriceHistory pl
JOIN Product p ON pl.ProductID = p.ProductID
WHERE p.Name = 'LL Fork';
```
-------------------------7299 sample_num
```sql
SELECT COUNT(*) 
FROM Product 
WHERE ProductLine = 'M' 
AND ProductID IN (
    SELECT ProductID 
    FROM ProductVendor 
    GROUP BY ProductID 
    HAVING COUNT(BusinessEntityID) > 2
);
```
-------------------------7300 sample_num
```sql
SELECT COUNT(DISTINCT p.ProductID) AS MountainProductCount
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE p.ProductLine = 'M';
```
-------------------------7301 sample_num
```sql
SELECT DISTINCT pr.EmailAddress
FROM ProductReview pr
JOIN Product p ON pr.ProductID = p.ProductID
WHERE p.Name = 'HL Mountain Pedal' AND pr.Rating = 1;
```
-------------------------7302 sample_num
```sql
SELECT COUNT(*) 
FROM Product 
WHERE DaysToManufacture > 2 AND (OnOrderQty = 0 OR OnOrderQty IS NULL);
```
-------------------------7303 sample_num
```sql
SELECT p.ProductID, p.Name
FROM Product p
WHERE p.DaysToManufacture > 2
  AND (p.OnOrderQty = 0 OR p.OnOrderQty IS NULL)
  AND p.MakeFlag = 1;
```
-------------------------7304 sample_num
```sql
SELECT COUNT(*) AS MostReviewedProductCount
FROM ProductReview
WHERE ProductID IN (
    SELECT ProductID
    FROM Product
    WHERE FinishedGoodsFlag = 1 AND ProductLine = 'M'
)
GROUP BY ProductID
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------7305 sample_num
```sql
SELECT v.Name AS VendorName, 
       AVG(pv.StandardPrice) AS AverageSellingPrice
FROM Product p
JOIN ProductVendor pv ON p.ProductID = pv.ProductID
JOIN Vendor v ON pv.BusinessEntityID = v.BusinessEntityID
WHERE p.Name = 'Hex Nut 5'
GROUP BY v.Name;
```
-------------------------7306 sample_num
```sql
SELECT TOP 1 p.Name
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE p.ProductLine = 'M'
GROUP BY p.ProductID, p.Name
ORDER BY AVG(pr.Rating) DESC;
```
-------------------------7307 sample_num
```sql
SELECT TOP 3 p.ProductID, p.Name, AVG(pr.Rating) AS AverageRating
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE p.MakeFlag = 1
GROUP BY p.ProductID, p.Name
ORDER BY AverageRating DESC;
```
-------------------------7308 sample_num
```sql
SELECT e.BusinessEntityID
FROM Employee e
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
WHERE p.PersonType = 'EM'
ORDER BY e.BusinessEntityID ASC;
```
-------------------------7309 sample_num
```sql
SELECT FirstName, MiddleName, LastName 
FROM Person 
WHERE PersonType = 'IN' AND LastName = 'Anderson';
```
-------------------------7310 sample_num
```sql
SELECT e.Title, e.FirstName, e.LastName, e.HireDate
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
WHERE edh.EndDate IS NOT NULL;
```
-------------------------7311 sample_num
```sql
SELECT FirstName, LastName 
FROM Employee 
WHERE SalariedFlag = 1 AND YEAR(HireDate) >= 2007;
```
-------------------------7312 sample_num
```sql
SELECT FirstName, LastName 
FROM Employee 
WHERE MaritalStatus = 'M' AND VacationHours < 20;
```
-------------------------7313 sample_num
```sql
SELECT TOP 1 
    E.FirstName + ' ' + E.LastName AS EmployeeName, 
    2022 - YEAR(E.BirthDate) + 1 AS Age
FROM 
    Employee E
JOIN 
    EmployeeDepartmentHistory EDH ON E.BusinessEntityID = EDH.BusinessEntityID
JOIN 
    Shift S ON EDH.ShiftID = S.ShiftID
WHERE 
    S.ShiftID = 3
ORDER BY 
    E.BirthDate ASC;
```
-------------------------7314 sample_num
```sql
SELECT e.*
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
WHERE d.Name = 'Shipping and Receiving' AND YEAR(e.HireDate) = 2009;
```
-------------------------7315 sample_num
```sql
SELECT e.JobTitle, d.Name AS DepartmentName
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
WHERE e.BirthDate = (SELECT MIN(BirthDate) FROM Employee);
```
-------------------------7316 sample_num
```sql
SELECT 
    edh.DepartmentID,
    AVG(eph.Rate) AS AverageHourlyPayRate
FROM 
    EmployeePayHistory eph
JOIN 
    EmployeeDepartmentHistory edh ON eph.BusinessEntityID = edh.BusinessEntityID
WHERE 
    eph.RateChangeDate = (
        SELECT MAX(RateChangeDate) 
        FROM EmployeePayHistory 
        WHERE BusinessEntityID = eph.BusinessEntityID
    )
GROUP BY 
    edh.DepartmentID;
```
-------------------------7317 sample_num
```sql
SELECT TOP 1 e.BusinessEntityID, e.JobTitle, eph.Rate
FROM Employee e
JOIN EmployeePayHistory eph ON e.BusinessEntityID = eph.BusinessEntityID
WHERE e.JobTitle != 'Chief Executive Officer'
ORDER BY eph.Rate DESC;
```
-------------------------7318 sample_num
```sql
SELECT v.Name
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
WHERE pv.ProductID = 319
ORDER BY pv.AverageLeadTime ASC
LIMIT 1;
```
-------------------------7319 sample_num
```sql
SELECT p.Name 
FROM Product p
JOIN ProductVendor pv ON p.ProductID = pv.ProductID
JOIN Vendor v ON pv.BusinessEntityID = v.BusinessEntityID
WHERE v.Name = 'Australia Bike Retailer'
ORDER BY p.ProductID;
```
-------------------------7320 sample_num
```sql
SELECT TOP 1 v.Name, (pv.StandardPrice - pv.LastReceiptCost) AS ProfitOnNet
FROM ProductVendor pv
JOIN Vendor v ON pv.BusinessEntityID = v.BusinessEntityID
WHERE pv.ProductID = 342
ORDER BY ProfitOnNet DESC;
```
-------------------------7321 sample_num
```sql
SELECT 
    MAX(EPH.Rate) AS CurrentPayRate,
    MIN(EPH.Rate) AS PreviousPayRate,
    (MAX(EPH.Rate) - MIN(EPH.Rate)) / NULLIF(MIN(EPH.Rate), 0) * 100 AS PercentageIncrement
FROM 
    EmployeePayHistory EPH
JOIN 
    Employee E ON EPH.BusinessEntityID = E.BusinessEntityID
WHERE 
    E.FirstName = 'Rob' AND E.LastName = 'Walters';
```
-------------------------7322 sample_num
```sql
SELECT AVG(YEAR(CURDATE()) - YEAR(HireDate)) AS AverageLengthOfEmployment
FROM Employee
JOIN EmployeeDepartmentHistory ON Employee.BusinessEntityID = EmployeeDepartmentHistory.BusinessEntityID
JOIN Department ON EmployeeDepartmentHistory.DepartmentID = Department.DepartmentID
WHERE Department.Name = 'Research and Development';
```
-------------------------7323 sample_num
```sql
SELECT AVG(YEAR(CURDATE()) - YEAR(HireDate)) AS AverageAge
FROM Employee;
```
-------------------------7324 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN JobTitle = 'Sales Representative' THEN 1 END) * 100.0 / COUNT(*)) AS SalesRepresentativePercentage
FROM 
    Employee;
```
-------------------------7325 sample_num
```sql
SELECT p.FirstName, p.LastName, e.LoginID AS PhoneNumber
FROM Employee e
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
WHERE e.JobTitle = 'Marketing Manager';
```
-------------------------7326 sample_num
```sql
SELECT p.FirstName, p.LastName, cc.CardType
FROM Person p
JOIN PersonCreditCard pcc ON p.BusinessEntityID = pcc.BusinessEntityID
JOIN CreditCard cc ON pcc.CreditCardID = cc.CreditCardID
WHERE cc.CardType = 'Distinguish';
```
-------------------------7327 sample_num
```sql
SELECT sp.Name, st.Name AS TerritoryName
FROM Store s
JOIN SalesPerson sp ON s.SalesPersonID = sp.BusinessEntityID
JOIN SalesTerritory st ON sp.TerritoryID = st.TerritoryID
WHERE s.Name = 'Area Bike Accessories';
```
-------------------------7328 sample_num
```sql
SELECT s.Name AS StoreName, sp.BusinessEntityID AS SalesRepresentativeID
FROM Store s
JOIN SalesPerson sp ON s.SalesPersonID = sp.BusinessEntityID
JOIN SalesTerritory st ON sp.TerritoryID = st.TerritoryID
WHERE st.Name = 'France';
```
-------------------------7329 sample_num
```sql
SELECT p.Name AS ProductName, v.Name AS VendorName
FROM Product p
JOIN ProductVendor pv ON p.ProductID = pv.ProductID
JOIN Vendor v ON pv.BusinessEntityID = v.BusinessEntityID
WHERE YEAR(p.SellStartDate) = 2013;
```
-------------------------7330 sample_num
```sql
SELECT TOP 1 e.FirstName + ' ' + e.LastName AS SalesRepresentative
FROM SalesPerson sp
JOIN Employee e ON sp.BusinessEntityID = e.BusinessEntityID
ORDER BY sp.SalesYTD DESC;
```
-------------------------7331 sample_num
```sql
SELECT p.*
FROM Product p
JOIN ProductVendor pv ON p.ProductID = pv.ProductID
WHERE pv.MinOrderQty = 1000 AND p.StandardCost > 17;
```
-------------------------7332 sample_num
```sql
SELECT TOP 1 JobTitle
FROM Employee
WHERE BusinessEntityID IN (
    SELECT BusinessEntityID
    FROM Person
    WHERE Gender = 'M' AND MaritalStatus = 'M'
)
ORDER BY BirthDate ASC;
```
-------------------------7333 sample_num
```sql
SELECT v.Name 
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
JOIN Product p ON pv.ProductID = p.ProductID
WHERE p.ProductNumber = 'WB-H098';
```
-------------------------7334 sample_num
```sql
SELECT TOP 1 v.BusinessEntityID, v.Name, pv.AverageLeadTime
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
WHERE pv.ProductID = 348
ORDER BY pv.AverageLeadTime ASC;
```
-------------------------7335 sample_num
```sql
SELECT TOP 1 *
FROM Employee
WHERE YEAR(BirthDate) >= 1970
ORDER BY SickLeaveHours ASC;
```
-------------------------7336 sample_num
```sql
WITH EmployeeAges AS (
    SELECT 
        d.DepartmentID,
        AVG(DATEDIFF(YEAR, e.BirthDate, GETDATE())) AS AverageAge,
        MIN(e.BirthDate) AS YoungestBirthDate
    FROM 
        Employee e
    JOIN 
        EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
    JOIN 
        Department d ON edh.DepartmentID = d.DepartmentID
    GROUP BY 
        d.DepartmentID
)
SELECT 
    DepartmentID,
    AverageAge,
    (SELECT DepartmentID FROM EmployeeAges WHERE BirthDate = YoungestBirthDate) AS YoungestDepartment
FROM 
    EmployeeAges;
```
-------------------------7337 sample_num
```sql
SELECT TOP 3 ProductSubcategoryID FROM ProductSubcategory;
```
-------------------------7338 sample_num
```sql
SELECT 
    SalesQuota - SalesYTD AS SalesDifference
FROM 
    SalesPerson
WHERE 
    BusinessEntityID = 288;
```
-------------------------7339 sample_num
```sql
SELECT TOP 3 BusinessEntityID, SalesLastYear
FROM SalesPerson
ORDER BY SalesLastYear ASC;
```
-------------------------7340 sample_num
```sql
SELECT TOP 3 Name, SalesYTD
FROM SalesTerritory
ORDER BY SalesYTD DESC;
```
-------------------------7341 sample_num
```sql
SELECT DISTINCT SpecialOffer.Category
FROM SpecialOffer
WHERE SpecialOffer.Type = 'Group Discount' AND SpecialOffer.Category = 'Reseller';
```
-------------------------7342 sample_num
```sql
SELECT MAX(DiscountPct) 
FROM SpecialOffer 
WHERE Type = 'Excess Inventory';
```
-------------------------7343 sample_num
```sql
SELECT 
    (SELECT PlannedCost FROM WorkOrderRouting WHERE ProductID = 818) - 
    (SELECT ActualCost FROM WorkOrder WHERE ProductID = 818) AS CostDifference;
```
-------------------------7344 sample_num
```sql
SELECT COUNT(*) 
FROM BillOfMaterials 
WHERE EndDate IS NULL AND BOMLevel = 2;
```
-------------------------7345 sample_num
```sql
SELECT COUNT(*) 
FROM Document 
WHERE Status = 2 AND DocumentSummary IS NULL;
```
-------------------------7346 sample_num
```sql
SELECT *
FROM SalesTaxRate
WHERE Name LIKE '%+%';
```
-------------------------7347 sample_num
```sql
SELECT TOP 1 TransactionID
FROM TransactionHistory
WHERE TransactionType = 'W'
ORDER BY Quantity DESC;
```
-------------------------7348 sample_num
```sql
SELECT TOP 3 *
FROM Vendor
WHERE PreferredVendorStatus = 0;
```
-------------------------7349 sample_num
```sql
SELECT COUNT(*) AS NotPreferableVendors
FROM Vendor
WHERE PreferredVendorStatus = 0 AND ActiveFlag = 1;
```
-------------------------7350 sample_num
```sql
SELECT COUNT(DISTINCT e.BusinessEntityID) AS EmployeeCount
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Shift s ON edh.ShiftID = s.ShiftID
WHERE edh.StartDate >= '2009-01-01' AND s.Name LIKE '%Night%';
```
-------------------------7351 sample_num
```sql
SELECT d.Name AS DepartmentName, COUNT(e.BusinessEntityID) AS PersonnelCount
FROM Department d
JOIN EmployeeDepartmentHistory edh ON d.DepartmentID = edh.DepartmentID
JOIN Employee e ON edh.BusinessEntityID = e.BusinessEntityID
JOIN EmployeeDepartmentHistory edh2 ON e.BusinessEntityID = edh2.BusinessEntityID
JOIN Shift s ON edh2.ShiftID = s.ShiftID
WHERE s.Name = 'Night'
GROUP BY d.Name
ORDER BY PersonnelCount DESC
LIMIT 1;
```
-------------------------7352 sample_num
```sql
SELECT COUNT(*) AS ShipmentCount
FROM SalesOrderHeader AS soh
JOIN ShipMethod AS sm ON soh.ShipMethodID = sm.ShipMethodID
WHERE sm.Name = 'XRQ - TRUCK GROUND';
```
-------------------------7353 sample_num
```sql
SELECT sr.Name
FROM SalesOrderHeader soh
JOIN SalesOrderHeaderSalesReason sohsr ON soh.SalesOrderID = sohsr.SalesOrderID
JOIN SalesReason sr ON sohsr.SalesReasonID = sr.SalesReasonID
WHERE soh.SalesOrderID = 43718;
```
-------------------------7354 sample_num
```sql
SELECT Name 
FROM ProductSubcategory 
WHERE ProductCategoryID = (SELECT ProductCategoryID FROM ProductCategory WHERE Name = 'bikes');
```
-------------------------7355 sample_num
```sql
SELECT TerritoryID, MAX(SalesQuota) AS HighestYearlySalesQuota
FROM SalesPersonQuotaHistory
GROUP BY TerritoryID
ORDER BY HighestYearlySalesQuota DESC;
```
-------------------------7356 sample_num
```sql
SELECT p.Name, sod.OrderQty, sod.UnitPrice, sod.LineTotal
FROM SalesOrderHeader soh
JOIN SalesOrderDetail sod ON soh.SalesOrderID = sod.SalesOrderID
JOIN Product p ON sod.ProductID = p.ProductID
WHERE soh.SalesOrderNumber = '43660';
```
-------------------------7357 sample_num
```sql
SELECT TOP 5 p.ProductID, p.Name, SUM(so.OrderQty) AS TotalOrders
FROM Product p
JOIN SalesOrderDetail so ON p.ProductID = so.ProductID
GROUP BY p.ProductID, p.Name
ORDER BY TotalOrders DESC;
```
-------------------------7358 sample_num
```sql
SELECT ProductInventory.Shelf
FROM ProductInventory
JOIN Product ON ProductInventory.ProductID = Product.ProductID
WHERE Product.Name LIKE '%down tube%';
```
-------------------------7359 sample_num
```sql
SELECT at.Name
FROM Store s
JOIN BusinessEntityAddress bea ON s.BusinessEntityID = bea.BusinessEntityID
JOIN AddressType at ON bea.AddressTypeID = at.AddressTypeID
WHERE s.Name = 'Fun Toys and Bikes';
```
-------------------------7360 sample_num
```sql
SELECT p.FirstName, p.LastName, e.JobTitle, e.EmailPromotion
FROM Store s
JOIN SalesPerson sp ON s.SalesPersonID = sp.BusinessEntityID
JOIN BusinessEntityContact bec ON s.BusinessEntityID = bec.BusinessEntityID
JOIN Person p ON bec.PersonID = p.BusinessEntityID
JOIN Employee e ON p.BusinessEntityID = e.BusinessEntityID
WHERE s.Name = 'Next-Door Bike Store';
```
-------------------------7361 sample_num
```sql
SELECT DISTINCT th.ReferenceOrderID
FROM Product p
JOIN TransactionHistory th ON p.ProductID = th.ProductID
WHERE p.Name = 'Mountain End Caps';
```
-------------------------7362 sample_num
```sql
SELECT AddressLine1 
FROM Address 
JOIN BusinessEntityAddress ON Address.AddressID = BusinessEntityAddress.AddressID 
WHERE BusinessEntityAddress.BusinessEntityID = 12;
```
-------------------------7363 sample_num
```sql
SELECT TOP 3 BusinessEntityID, Name 
FROM Store 
WHERE City = 'Dallas';
```
-------------------------7364 sample_num
```sql
SELECT sp.Name
FROM StateProvince sp
JOIN Address a ON sp.StateProvinceID = a.StateProvinceID
WHERE a.City = 'Racine';
```
-------------------------7365 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.Name = 'Arabic' THEN 1 END) * 100.0 / COUNT(c.CultureID)) - 
    (COUNT(CASE WHEN c.Name = 'Thai' THEN 1 END) * 100.0 / COUNT(c.CultureID)) AS PercentageDifference
FROM 
    Culture c
JOIN 
    ProductModelProductDescriptionCulture pm ON c.CultureID = pm.CultureID;
```
-------------------------7366 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN sp.SalesQuota > 300000 THEN 1 END) * 100.0 / COUNT(sp.TerritoryID)) AS Percentage
FROM 
    SalesPerson sp
JOIN 
    SalesTerritory st ON sp.TerritoryID = st.TerritoryID
JOIN 
    CountryRegion cr ON st.CountryRegionCode = cr.CountryRegionCode
WHERE 
    cr.Name = 'Northwest' AND cr.CountryRegionCode = 'US';
```
-------------------------7367 sample_num
```sql
SELECT (pv.LastReceiptCost - p.StandardCost) AS NetProfit
FROM Product p
JOIN ProductVendor pv ON p.ProductID = pv.ProductID
WHERE p.Name = 'Crankarm';
```
-------------------------7368 sample_num
```sql
SELECT TOP 1 p.Name
FROM Product p
JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE pr.Rating = 5
ORDER BY pr.ModifiedDate DESC;
```
-------------------------7369 sample_num
```sql
SELECT MAX(Rate) AS SecondHighestSalaryPerHour
FROM EmployeePayHistory
WHERE BusinessEntityID IN (
    SELECT BusinessEntityID
    FROM Employee
    WHERE SalariedFlag = 0
) 
AND PayFrequency = 1
GROUP BY BusinessEntityID
ORDER BY SecondHighestSalaryPerHour DESC
OFFSET 1 ROWS FETCH NEXT 1 ROWS ONLY;
```
-------------------------7370 sample_num
```sql
SELECT COUNT(*) 
FROM CreditCard 
WHERE CardType = 'Vista' AND ExpYear <= 2006;
```
-------------------------7371 sample_num
```sql
SELECT StartTime 
FROM Shift 
WHERE Name = 'Night';
```
-------------------------7372 sample_num
```sql
SELECT p.Name, p.Weight
FROM Product p
WHERE p.WeightUnitMeasureCode = 'LB'
AND p.ProductID IN (
    SELECT TOP 1 ProductID
    FROM Product
    GROUP BY Style
    ORDER BY COUNT(*) DESC
)
ORDER BY p.Weight;
```
-------------------------7373 sample_num
```sql
SELECT 
    st.Name AS TerritoryName, 
    cr.Name AS CountryRegionName, 
    MAX(st.SalesLastYear - st.SalesYTD) AS SalesDifference
FROM 
    SalesTerritory st
JOIN 
    CountryRegion cr ON st.CountryRegionCode = cr.CountryRegionCode
GROUP BY 
    st.Name, cr.Name
ORDER BY 
    SalesDifference DESC
LIMIT 1;
```
-------------------------7374 sample_num
```sql
SELECT TOP 6 Name, ReorderPoint
FROM Product
WHERE SizeUnitMeasureCode = 'CM'
ORDER BY Size DESC;
```
-------------------------7375 sample_num
```sql
SELECT TotalDue 
FROM PurchaseOrderHeader 
ORDER BY Freight DESC 
OFFSET 2 ROWS 
FETCH NEXT 1 ROWS ONLY;
```
-------------------------7376 sample_num
```sql
SELECT (ListPrice - StandardCost) * 10 AS Profit
FROM Product
WHERE Weight = (SELECT MIN(Weight) FROM Product);
```
-------------------------7377 sample_num
```sql
SELECT PurchaseOrderID, TaxAmt 
FROM PurchaseOrderHeader 
WHERE TaxAmt = (SELECT MAX(TaxAmt) FROM PurchaseOrderHeader);
```
-------------------------7378 sample_num
```sql
SELECT COUNT(DISTINCT sp.BusinessEntityID) AS NumberOfPersons
FROM SalesPerson sp
WHERE sp.SalesQuota <= 50000;
```
-------------------------7379 sample_num
```sql
SELECT Shift.Name
FROM Employee
JOIN EmployeeDepartmentHistory ON Employee.BusinessEntityID = EmployeeDepartmentHistory.BusinessEntityID
JOIN Shift ON EmployeeDepartmentHistory.ShiftID = Shift.ShiftID
WHERE YEAR(Employee.BirthDate) < 1969
ORDER BY Employee.BirthDate ASC
OFFSET 5 ROWS
FETCH NEXT 1 ROWS ONLY;
```
-------------------------7380 sample_num
```sql
SELECT p.ProductID, p.Name, (p.ListPrice - p.StandardCost) AS Profit, pr.Rating
FROM Product p
LEFT JOIN ProductReview pr ON p.ProductID = pr.ProductID
WHERE p.DaysToManufacture = (SELECT MIN(DaysToManufacture) FROM Product)
ORDER BY Profit DESC
LIMIT 1;
```
-------------------------7381 sample_num
```sql
SELECT CONCAT(e.FirstName, ' ', e.MiddleName, ' ', e.LastName) AS FullName
FROM SalesPerson sp
JOIN Employee e ON sp.BusinessEntityID = e.BusinessEntityID
WHERE sp.Bonus < 1000;
```
-------------------------7382 sample_num
```sql
SELECT E.ModifiedDate
FROM Employee E
JOIN EmployeeDepartmentHistory EDH ON E.BusinessEntityID = EDH.BusinessEntityID
JOIN Department D ON EDH.DepartmentID = D.DepartmentID
WHERE E.JobTitle = 'Senior Tool Designer'
  AND YEAR(E.HireDate) - YEAR(E.BirthDate) = 33
  AND D.Name = 'Engineering'
  AND EDH.EndDate IS NOT NULL
ORDER BY EDH.EndDate DESC
LIMIT 1;
```
-------------------------7383 sample_num
```sql
SELECT SUM(PurchaseOrderHeader.TotalDue) AS TotalDueAmount
FROM Vendor
JOIN PurchaseOrderHeader ON Vendor.BusinessEntityID = PurchaseOrderHeader.VendorID
WHERE Vendor.CreditRating = 4 AND Vendor.PreferredVendorStatus = 0;
```
-------------------------7384 sample_num
```sql
SELECT d.Name AS DepartmentName
FROM Department d
JOIN Employee e ON d.DepartmentID = e.DepartmentID
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Shift s ON edh.ShiftID = s.ShiftID
WHERE s.Name = 'Night'
GROUP BY d.Name
HAVING COUNT(s.Name) = (
    SELECT MAX(shift_count)
    FROM (
        SELECT COUNT(s.Name) AS shift_count
        FROM Department d
        JOIN Employee e ON d.DepartmentID = e.DepartmentID
        JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
        JOIN Shift s ON edh.ShiftID = s.ShiftID
        WHERE s.Name = 'Night'
        GROUP BY d.Name
    ) AS counts
);
```
-------------------------7385 sample_num
```sql
SELECT (2 * (p.ListPrice - p.StandardCost)) AS Profit
FROM Product p
JOIN ProductSubcategory ps ON p.ProductSubcategoryID = ps.ProductSubcategoryID
WHERE p.Class = 'H' AND p.Name LIKE '%Road Bike%' AND p.Size = 58;
```
-------------------------7386 sample_num
```sql
SELECT TOP 10 
    FirstName + ' ' + ISNULL(MiddleName + ' ', '') + LastName AS FullName
FROM 
    Employee
WHERE 
    MaritalStatus = 'M' 
    AND JobTitle = 'Production Technician'
ORDER BY 
    BirthDate DESC;
```
-------------------------7387 sample_num
```sql
SELECT v.Name, v.CreditRating, (pv.LastReceiptCost - p.StandardCost) AS ProfitOnNet
FROM ProductVendor pv
JOIN Vendor v ON pv.BusinessEntityID = v.BusinessEntityID
JOIN Product p ON pv.ProductID = p.ProductID
WHERE pv.AverageLeadTime = 60
ORDER BY ProfitOnNet DESC
LIMIT 1;
```
-------------------------7388 sample_num
```sql
SELECT 
    pv.BusinessEntityID AS VendorID,
    v.Name AS VendorName,
    (pv.LastReceiptCost - pv.StandardPrice) AS ProfitOnNet
FROM 
    ProductVendor pv
JOIN 
    Vendor v ON pv.BusinessEntityID = v.BusinessEntityID
JOIN 
    Product p ON pv.ProductID = p.ProductID
WHERE 
    pv.MaxOrderQty = 200;
```
-------------------------7389 sample_num
```sql
SELECT TOP 1 
    CONCAT(p.FirstName, ' ', p.LastName) AS FullName,
    COUNT(poh.PurchaseOrderID) AS RejectedOrderCount
FROM 
    Employee e
JOIN 
    Person p ON e.BusinessEntityID = p.BusinessEntityID
JOIN 
    PurchaseOrderHeader poh ON e.BusinessEntityID = poh.EmployeeID
WHERE 
    p.PersonType = 'EM' AND poh.Status = 3
GROUP BY 
    p.FirstName, p.LastName
ORDER BY 
    RejectedOrderCount DESC;
```
-------------------------7390 sample_num
```sql
SELECT Name 
FROM Vendor 
JOIN ProductVendor ON Vendor.BusinessEntityID = ProductVendor.BusinessEntityID 
WHERE MinOrderQty = (SELECT DISTINCT MinOrderQty 
                      FROM ProductVendor 
                      ORDER BY MinOrderQty 
                      OFFSET 1 ROWS 
                      FETCH NEXT 1 ROWS ONLY);
```
-------------------------7391 sample_num
```sql
SELECT v.Name, pv.MinOrderQty
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
WHERE v.ActiveFlag = 0;
```
-------------------------7392 sample_num
```sql
SELECT 
    CONCAT(FirstName, ' ', MiddleName, ' ', LastName) AS FullName,
    YEAR(HireDate) - YEAR(BirthDate) AS AgeAtHire
FROM 
    Employee
WHERE 
    VacationHours <= 10
ORDER BY 
    HireDate
LIMIT 1;
```
-------------------------7393 sample_num
```sql
SELECT DISTINCT p.PersonType
FROM Employee e
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
WHERE e.HireDate BETWEEN '2008-01-01' AND '2008-12-31'
  AND e.MaritalStatus = 'S'
  AND e.Gender = 'F';
```
-------------------------7394 sample_num
```sql
SELECT 
    (p.ListPrice - p.StandardCost) AS Profit
FROM 
    Product p
JOIN 
    ProductReview pr ON p.ProductID = pr.ProductID
WHERE 
    pr.ReviewerName = 'David' AND pr.Rating = 4
ORDER BY 
    pr.ReviewDate DESC
OFFSET 1 ROW FETCH NEXT 1 ROW ONLY;
```
-------------------------7395 sample_num
```sql
SELECT sp.Name AS StateProvinceName, st.Group AS GeographicArea
FROM SalesTaxRate str
JOIN StateProvince sp ON str.StateProvinceID = sp.StateProvinceID
ORDER BY str.TaxRate ASC
OFFSET 1 ROW FETCH NEXT 1 ROW ONLY;
```
-------------------------7396 sample_num
```sql
SELECT 
    AVG(ListPrice - StandardCost) AS AverageProfit,
    COUNT(DISTINCT Size) AS VarietyOfSizes,
    COUNT(DISTINCT Color) AS AvailableColors
FROM 
    Product
WHERE 
    Class = 'L' 
    AND Style = 'U' 
    AND ProductSubcategoryID IN (SELECT ProductSubcategoryID FROM ProductSubcategory WHERE Name = 'road frame');
```
-------------------------7397 sample_num
```sql
SELECT DiscountPct 
FROM SpecialOffer 
WHERE Description = 'LL Road Frame Sale';
```
-------------------------7398 sample_num
```sql
SELECT COUNT(*) 
FROM SpecialOffer 
WHERE Type = 'Excess Inventory';
```
-------------------------7399 sample_num
```sql
SELECT TOP 1 Description, DiscountPct 
FROM SpecialOffer 
WHERE Type = 'Seasonal' 
ORDER BY DiscountPct DESC;
```
-------------------------7400 sample_num
```sql
SELECT TOP 3 *
FROM SpecialOffer
WHERE Category = 'Reseller'
ORDER BY DiscountPct DESC;
```
-------------------------7401 sample_num
```sql
SELECT s.Demographics 
FROM Store s 
WHERE s.Name = 'Valley Bicycle Specialists';
```
-------------------------7402 sample_num
```sql
SELECT COUNT(*) 
FROM Product 
WHERE MakeFlag = 1 AND FinishedGoodsFlag = 1;
```
-------------------------7403 sample_num
```sql
SELECT MIN(SafetyStockLevel) AS MinimumInventoryQuantity
FROM Product
WHERE Name = 'Chainring Bolts';
```
-------------------------7404 sample_num
```sql
SELECT TOP 1 Name, StandardCost 
FROM Product 
ORDER BY StandardCost DESC;
```
-------------------------7405 sample_num
```sql
SELECT PersonType 
FROM Person 
WHERE FirstName = 'David' AND LastName = 'Bradley';
```
-------------------------7406 sample_num
```sql
SELECT COUNT(e.BusinessEntityID) AS NumberOfMrStoreContacts
FROM Employee e
JOIN BusinessEntityContact bec ON e.BusinessEntityID = bec.BusinessEntityID
JOIN Person p ON bec.PersonID = p.BusinessEntityID
WHERE p.PersonType = 'SC' AND p.Title = 'Mr.';
```
-------------------------7407 sample_num
```sql
SELECT s.Name, a.AddressLine1, a.AddressLine2
FROM Store s
JOIN BusinessEntityAddress bea ON s.BusinessEntityID = bea.BusinessEntityID
JOIN Address a ON bea.AddressID = a.AddressID
WHERE s.Name = 'Valley Bicycle Specialists';
```
-------------------------7408 sample_num
```sql
SELECT EmailAddress 
FROM EmailAddress 
WHERE BusinessEntityID = (
    SELECT BusinessEntityID 
    FROM Person 
    WHERE FirstName = 'David' AND LastName = 'Bradley'
);
```
-------------------------7409 sample_num
```sql
SELECT e.EmailAddress, p.FirstName, p.LastName, pn.PhoneNumber
FROM Store s
JOIN BusinessEntityContact bec ON s.BusinessEntityID = bec.BusinessEntityID
JOIN Person p ON bec.PersonID = p.BusinessEntityID
JOIN EmailAddress e ON s.BusinessEntityID = e.BusinessEntityID
JOIN PhoneNumber pn ON p.BusinessEntityID = pn.BusinessEntityID
WHERE p.PersonType = 'SC';
```
-------------------------7410 sample_num
```sql
SELECT p.PasswordHash 
FROM Person AS p 
JOIN Password AS pw ON p.BusinessEntityID = pw.BusinessEntityID 
WHERE p.FirstName = 'David' AND p.LastName = 'Bradley';
```
-------------------------7411 sample_num
```sql
SELECT e.EmailAddress
FROM Employee emp
JOIN BusinessEntityContact bec ON emp.BusinessEntityID = bec.BusinessEntityID
JOIN EmailAddress e ON bec.PersonID = e.BusinessEntityID
WHERE emp.EmailPromotion = 2;
```
-------------------------7412 sample_num
```sql
SELECT c.CardNumber 
FROM Person p 
JOIN CreditCard cc ON p.BusinessEntityID = cc.BusinessEntityID 
WHERE p.FirstName = 'David' AND p.LastName = 'Bradley';
```
-------------------------7413 sample_num
```sql
SELECT ExpYear 
FROM CreditCard 
WHERE CreditCardID IN (
    SELECT CreditCardID 
    FROM PersonCreditCard 
    WHERE BusinessEntityID = (
        SELECT BusinessEntityID 
        FROM Person 
        WHERE FirstName = 'David' AND LastName = 'Bradley'
    )
);
```
-------------------------7414 sample_num
```sql
SELECT p.FirstName, p.LastName
FROM Person p
JOIN BusinessEntityContact bec ON p.BusinessEntityID = bec.PersonID
JOIN Store s ON bec.BusinessEntityID = s.BusinessEntityID
JOIN PersonCreditCard pcc ON p.BusinessEntityID = pcc.BusinessEntityID
JOIN CreditCard cc ON pcc.CreditCardID = cc.CreditCardID
WHERE cc.ExpYear = 2007 AND p.PersonType = 'SC';
```
-------------------------7415 sample_num
```sql
SELECT COUNT(DISTINCT e.BusinessEntityID) AS StoreContactWithVistaCreditCard
FROM Employee e
JOIN BusinessEntityContact bec ON e.BusinessEntityID = bec.BusinessEntityID
JOIN Person p ON bec.PersonID = p.BusinessEntityID
JOIN PersonCreditCard pcc ON e.BusinessEntityID = pcc.BusinessEntityID
JOIN CreditCard cc ON pcc.CreditCardID = cc.CreditCardID
WHERE p.PersonType = 'SC' AND cc.CardType = 'vista';
```
-------------------------7416 sample_num
```sql
SELECT COUNT(DISTINCT DepartmentID) AS DepartmentCount
FROM EmployeeDepartmentHistory
WHERE BusinessEntityID IN (
    SELECT BusinessEntityID
    FROM Employee
    WHERE FirstName = 'David' AND LastName = 'Bradley'
);
```
-------------------------7417 sample_num
```sql
SELECT d.Name 
FROM Department d
JOIN EmployeeDepartmentHistory edh ON d.DepartmentID = edh.DepartmentID
JOIN Employee e ON edh.BusinessEntityID = e.BusinessEntityID
WHERE e.LoginID = 'DavidBradley';
```
-------------------------7418 sample_num
```sql
SELECT COUNT(DISTINCT e.BusinessEntityID) AS NumberOfPeople
FROM EmployeeDepartmentHistory edh
JOIN Employee e ON edh.BusinessEntityID = e.BusinessEntityID
WHERE edh.DepartmentID = (SELECT DepartmentID FROM Department WHERE Name = 'Engineering')
AND YEAR(edh.StartDate) <= 2009
AND (edh.EndDate IS NULL OR YEAR(edh.EndDate) > 2009);
```
-------------------------7419 sample_num
```sql
SELECT p.FirstName, p.LastName
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
WHERE d.Name = 'Engineering'
ORDER BY DATEDIFF(edh.EndDate, edh.StartDate) DESC
LIMIT 1;
```
-------------------------7420 sample_num
```sql
SELECT COUNT(DISTINCT e.BusinessEntityID) AS StoreContactCount
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
JOIN BusinessEntityContact bec ON e.BusinessEntityID = bec.BusinessEntityID
JOIN Person p ON bec.PersonID = p.BusinessEntityID
WHERE d.GroupName = 'Manufacturing'
AND YEAR(edh.StartDate) < 2007
AND YEAR(edh.EndDate) > 2007
AND p.PersonType = 'SC';
```
-------------------------7421 sample_num
```sql
SELECT c.CardNumber
FROM CreditCard c
JOIN Employee e ON c.BusinessEntityID = e.BusinessEntityID
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
WHERE d.Name = 'Finance' AND edh.EndDate IS NOT NULL;
```
-------------------------7422 sample_num
```sql
SELECT COUNT(e.BusinessEntityID) AS EmployeeCount
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
JOIN Department d ON edh.DepartmentID = d.DepartmentID
JOIN PersonCreditCard pcc ON e.BusinessEntityID = pcc.BusinessEntityID
JOIN CreditCard cc ON pcc.CreditCardID = cc.CreditCardID
WHERE d.Name = 'Engineering'
AND YEAR(edh.StartDate) = 2007
AND cc.ExpYear = 2007;
```
-------------------------7423 sample_num
```sql
SELECT e.EmailAddress
FROM Employee e
JOIN (
    SELECT BusinessEntityID, COUNT(DepartmentID) AS DeptSwitchCount
    FROM EmployeeDepartmentHistory
    GROUP BY BusinessEntityID
) edh ON e.BusinessEntityID = edh.BusinessEntityID
WHERE edh.DeptSwitchCount = (
    SELECT MAX(DeptSwitchCount)
    FROM (
        SELECT COUNT(DepartmentID) AS DeptSwitchCount
        FROM EmployeeDepartmentHistory
        GROUP BY BusinessEntityID
    ) AS subquery
);
```
-------------------------7424 sample_num
```sql
SELECT COUNT(DISTINCT e.BusinessEntityID) AS EmployeeCount
FROM Employee e
JOIN EmployeeDepartmentHistory edh ON e.BusinessEntityID = edh.BusinessEntityID
WHERE e.EmailPromotion = 0 AND edh.DepartmentID = (SELECT DepartmentID FROM Department WHERE Name = 'Engineering');
```
-------------------------7425 sample_num
```sql
SELECT COUNT(*) 
FROM EmployeeDepartmentHistory 
WHERE DepartmentID IN (SELECT DepartmentID FROM Department WHERE GroupName = 'Quality Assurance Group') 
AND YEAR(StartDate) = 2007;
```
-------------------------7426 sample_num
```sql
SELECT p.Name
FROM Product p
JOIN SpecialOfferProduct sop ON p.ProductID = sop.ProductID
JOIN SpecialOffer so ON sop.SpecialOfferID = so.SpecialOfferID
WHERE so.Description = 'LL Road Frame Sale';
```
-------------------------7427 sample_num
```sql
SELECT SUM(SOD.OrderQty) AS TotalProducts
FROM SalesOrderDetail SOD
JOIN SalesOrderHeader SOH ON SOD.SalesOrderID = SOH.SalesOrderID
JOIN SpecialOffer SO ON SOD.SpecialOfferID = SO.SpecialOfferID
WHERE SO.Description = 'LL Road Frame Sale';
```
-------------------------7428 sample_num
```sql
SELECT COUNT(*) > 0 AS HasBeenOnSale
FROM Product
WHERE Name = 'Chainring Bolts' AND SellStartDate IS NOT NULL;
```
-------------------------7429 sample_num
```sql
SELECT SUM(SOD.OrderQty) AS TotalProducts
FROM SalesOrderDetail SOD
JOIN SalesOrderHeader SOH ON SOD.SalesOrderID = SOH.SalesOrderID
JOIN SpecialOffer SO ON SO.SpecialOfferID = SOD.SpecialOfferID
JOIN Product P ON SOD.ProductID = P.ProductID
JOIN ProductSubcategory PS ON P.ProductSubcategoryID = PS.ProductSubcategoryID
JOIN ProductCategory PC ON PS.ProductCategoryID = PC.ProductCategoryID
WHERE SO.Description = 'LL Road Frame Sale' AND PC.Name = 'Clothing';
```
-------------------------7430 sample_num
```sql
SELECT p.*
FROM Product p
JOIN ProductSubcategory ps ON p.ProductSubcategoryID = ps.ProductSubcategoryID
JOIN ProductCategory pc ON ps.ProductCategoryID = pc.ProductCategoryID
WHERE pc.Name = 'Clothing' AND p.MakeFlag = 1 AND p.FinishedGoodsFlag = 1;
```
-------------------------7431 sample_num
```sql
SELECT AVG(YEAR(EndDate) - YEAR(StartDate)) AS AverageStay
FROM EmployeeDepartmentHistory T1
JOIN Department D ON T1.DepartmentID = D.DepartmentID
WHERE D.Name = 'Engineering' AND T1.EndDate IS NOT NULL;
```
-------------------------7432 sample_num
```sql
SELECT AVG(EH.Rate) AS AveragePayRate
FROM EmployeePayHistory EH
JOIN Employee E ON EH.BusinessEntityID = E.BusinessEntityID
JOIN EmployeeDepartmentHistory EDH ON E.BusinessEntityID = EDH.BusinessEntityID
JOIN Department D ON EDH.DepartmentID = D.DepartmentID
WHERE D.Name = 'Engineering' 
AND EDH.StartDate < '2007-01-01' 
AND EDH.EndDate > '2007-12-31';
```
-------------------------7433 sample_num
```sql
SELECT 
    (MAX(ListPrice) - MIN(ListPrice)) / MIN(ListPrice) * 100 AS PriceDifferencePercentage
FROM 
    Product
WHERE 
    ProductSubcategoryID IN (
        SELECT ProductSubcategoryID 
        FROM ProductSubcategory 
        WHERE ProductCategoryID = (SELECT ProductCategoryID FROM ProductCategory WHERE Name = 'Clothing')
    );
```
-------------------------7434 sample_num
```sql
SELECT AVG(ListPrice - StandardCost) AS AverageProfit
FROM Product
JOIN ProductSubcategory ON Product.ProductSubcategoryID = ProductSubcategory.ProductSubcategoryID
JOIN ProductCategory ON ProductSubcategory.ProductCategoryID = ProductCategory.ProductCategoryID
WHERE ProductCategory.Name = 'Clothing';
```
-------------------------7435 sample_num
```sql
SELECT ProductID, StandardCost 
FROM ProductCostHistory 
WHERE StartDate <= '2013-12-31' AND EndDate >= '2013-01-01' 
ORDER BY StandardCost ASC 
LIMIT 1;
```
-------------------------7436 sample_num
```sql
SELECT * FROM Product WHERE Color = 'Yellow';
```
-------------------------7437 sample_num
```sql
SELECT BusinessEntityID 
FROM Person 
WHERE FirstName = 'Hung-Fu' AND LastName = 'Ting';
```
-------------------------7438 sample_num
```sql
SELECT pn.PhoneNumber
FROM PhoneNumber pn
JOIN BusinessEntityContact bec ON pn.BusinessEntityID = bec.BusinessEntityID
WHERE bec.PersonID = 12597;
```
-------------------------7439 sample_num
```sql
SELECT ListPrice FROM Product WHERE ProductID = 912;
```
-------------------------7440 sample_num
```sql
SELECT * FROM WorkOrderRouting WHERE ActualCost != PlannedCost;
```
-------------------------7441 sample_num
```sql
SELECT ThumbnailPhotoFileName 
FROM ProductPhoto 
WHERE ProductPhotoID = (SELECT ProductPhotoID FROM ProductProductPhoto WHERE ProductID = 979);
```
-------------------------7442 sample_num
```sql
SELECT Name FROM Product WHERE ListPrice > 1000;
```
-------------------------7443 sample_num
```sql
SELECT TOP 1 ProductID, Name, (ListPrice - StandardCost) AS Profit
FROM Product
ORDER BY Profit DESC;
```
-------------------------7444 sample_num
```sql
SELECT p.Name 
FROM Product p
JOIN ProductInventory pi ON p.ProductID = pi.ProductID
WHERE pi.LocationID = 1 AND pi.Shelf = 'L' AND pi.Bin = 6;
```
-------------------------7445 sample_num
```sql
SELECT LocationID 
FROM WorkOrderRouting 
WHERE WorkOrderID = 35493;
```
-------------------------7446 sample_num
```sql
SELECT * 
FROM ProductPhoto 
WHERE LargePhoto IS NOT NULL;
```
-------------------------7447 sample_num
```sql
SELECT p.*
FROM Product p
JOIN ProductSubcategory ps ON p.ProductSubcategoryID = ps.ProductSubcategoryID
WHERE ps.Name = 'Socks';
```
-------------------------7448 sample_num
```sql
SELECT FLOOR(100 / ListPrice) AS NumberOfCableLocks
FROM Product
WHERE Name = 'Cable Lock';
```
-------------------------7449 sample_num
```sql
SELECT sr.Name 
FROM WorkOrder wo
JOIN ScrapReason sr ON wo.ScrapReasonID = sr.ScrapReasonID
WHERE wo.WorkOrderID = 57788;
```
-------------------------7450 sample_num
```sql
SELECT StandardCost FROM Product WHERE Name LIKE '%sports%';
```
-------------------------7451 sample_num
```sql
SELECT SUM(ProductInventory.Quantity) AS TotalQuantity
FROM ProductInventory
JOIN Location ON ProductInventory.LocationID = Location.LocationID
WHERE ProductInventory.ProductID = 476 AND Location.Name = 'Metal Storage';
```
-------------------------7452 sample_num
```sql
SELECT *
FROM Product
WHERE StandardCost < (SELECT AVG(StandardCost) FROM Product);
```
-------------------------7453 sample_num
```sql
SELECT 
    DIVIDE((ListPrice - StandardCost), StandardCost) AS percentage_of_profit
FROM 
    Product
WHERE 
    ProductID = '858';
```
-------------------------7454 sample_num
```sql
SELECT COUNT(*) 
FROM ProductPhoto 
WHERE ProductPhotoID != 1;
```
-------------------------7455 sample_num
```sql
SELECT DATEDIFF(DAY, ActualStartDate, ActualEndDate) AS DaysToEnd
FROM WorkOrder
WHERE WorkOrderID = 425;
```
-------------------------7456 sample_num
```sql
SELECT TOP 1 Name, ListPrice 
FROM Product 
WHERE SellStartDate <= '2012-12-31' AND (SellEndDate IS NULL OR SellEndDate >= '2012-01-01') 
ORDER BY ListPrice DESC;
```
-------------------------7457 sample_num
```sql
SELECT StandardCost 
FROM Product 
WHERE ProductID = '847';
```
-------------------------7458 sample_num
```sql
SELECT OrganizationLevel 
FROM Employee 
WHERE JobTitle = 'Human Resources Manager';
```
-------------------------7459 sample_num
```sql
SELECT COUNT(*) AS WorkOrdersNotMetDueDate
FROM WorkOrder
WHERE EndDate > DueDate;
```
-------------------------7460 sample_num
```sql
SELECT StandardCost, ProductNumber 
FROM Product 
WHERE ProductID = 888;
```
-------------------------7461 sample_num
```sql
SELECT COUNT(*) 
FROM ProductPhoto 
WHERE ThumbnailPhotoFileName = 'roadster_black_small.gif';
```
-------------------------7462 sample_num
```sql
SELECT LocationID, Shelf AS Compartment, Bin AS Container
FROM ProductInventory
WHERE ProductID = (SELECT ProductID FROM Product WHERE Name = 'Lock Ring');
```
-------------------------7463 sample_num
```sql
SELECT pc.Name AS ProductCategory
FROM ProductSubcategory ps
JOIN ProductCategory pc ON ps.ProductCategoryID = pc.ProductCategoryID
WHERE ps.Name = 'Road Frames';
```
-------------------------7464 sample_num
```sql
SELECT w.*
FROM WorkOrder w
JOIN ScrapReason sr ON w.ScrapReasonID = sr.ScrapReasonID
WHERE sr.Name = 'handling damage';
```
-------------------------7465 sample_num
```sql
SELECT (ListPrice - StandardCost) AS Profit
FROM Product
WHERE ProductID = '792';
```
-------------------------7466 sample_num
```sql
SELECT p.FirstName, p.LastName
FROM Person p
JOIN EmailAddress e ON p.BusinessEntityID = e.BusinessEntityID
WHERE e.EmailAddress = 'regina7@adventure-works.com';
```
-------------------------7467 sample_num
```sql
SELECT LocationID, Shelf, Bin, Quantity 
FROM ProductInventory 
WHERE ProductID = '810';
```
-------------------------7468 sample_num
```sql
SELECT p.Name 
FROM WorkOrder w
JOIN Product p ON w.ProductID = p.ProductID
WHERE w.WorkOrderID = 2540;
```
-------------------------7469 sample_num
```sql
SELECT ListPrice FROM Product WHERE Name = 'AWC Logo Cap';
```
-------------------------7470 sample_num
```sql
SELECT w.*
FROM WorkOrder w
JOIN Product p ON w.ProductID = p.ProductID
WHERE p.Name = 'Down Tube';
```
-------------------------7471 sample_num
```sql
SELECT AVG((ListPrice - StandardCost) / StandardCost * 100) AS AverageProfitPercentage
FROM Product;
```
-------------------------7472 sample_num
```sql
SELECT 
    CAST(SUM(CASE WHEN Name = 'Subassembly' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(WorkOrderID) AS Proportion
FROM 
    WorkOrder;
```
-------------------------7473 sample_num
```sql
SELECT COUNT(DISTINCT OBJ_SAMPLE_ID) 
FROM IMG_OBJ 
WHERE IMG_ID = 1;
```
-------------------------7474 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) AS ImageCount
FROM IMG_OBJ
GROUP BY IMG_ID
HAVING COUNT(OBJ_SAMPLE_ID) > 20;
```
-------------------------7475 sample_num
```sql
SELECT IMG_ID
FROM IMG_OBJ
GROUP BY IMG_ID
ORDER BY COUNT(OBJ_SAMPLE_ID) DESC
LIMIT 1;
```
-------------------------7476 sample_num
```sql
SELECT OBJ_SAMPLE_ID 
FROM IMG_OBJ 
WHERE IMG_ID = 1 AND OBJ_CLASS_ID = 297;
```
-------------------------7477 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_REL 
WHERE IMG_ID = 5 AND OBJ1_SAMPLE_ID = OBJ2_SAMPLE_ID;
```
-------------------------7478 sample_num
```sql
SELECT X, Y, W, H 
FROM IMG_OBJ 
WHERE IMG_ID = 5 
AND OBJ_SAMPLE_ID IN (
    SELECT OBJ1_SAMPLE_ID 
    FROM IMG_REL 
    WHERE IMG_ID = 5 
    AND OBJ1_SAMPLE_ID = OBJ2_SAMPLE_ID
);
```
-------------------------7479 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_OBJ 
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID 
WHERE IMG_OBJ.IMG_ID = 1 AND OBJ_CLASSES.OBJ_CLASS = 'man';
```
-------------------------7480 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ 
WHERE OBJ_CLASS_ID IN (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'man');
```
-------------------------7481 sample_num
```sql
SELECT DISTINCT OBJ_CLASSES.OBJ_CLASS
FROM IMG_OBJ
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID
WHERE IMG_OBJ.IMG_ID = 1;
```
-------------------------7482 sample_num
```sql
SELECT PRED_CLASS
FROM IMG_REL
JOIN PRED_CLASSES ON IMG_REL.PRED_CLASS_ID = PRED_CLASSES.PRED_CLASS_ID
WHERE IMG_REL.IMG_ID = 1 AND IMG_REL.OBJ1_SAMPLE_ID = 8 AND IMG_REL.OBJ2_SAMPLE_ID = 4;
```
-------------------------7483 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_REL 
WHERE IMG_ID = 1 AND PRED_CLASS_ID = (SELECT PRED_CLASS_ID FROM PRED_CLASSES WHERE PRED_CLASS = 'parked on');
```
-------------------------7484 sample_num
```sql
SELECT PRED_CLASSES.PRED_CLASS
FROM IMG_REL
JOIN PRED_CLASSES ON IMG_REL.PRED_CLASS_ID = PRED_CLASSES.PRED_CLASS_ID
WHERE IMG_REL.IMG_ID = 1 AND (IMG_REL.OBJ1_SAMPLE_ID = 14 OR IMG_REL.OBJ2_SAMPLE_ID = 14);
```
-------------------------7485 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_REL 
WHERE PRED_CLASS_ID = (SELECT PRED_CLASS_ID FROM PRED_CLASSES WHERE PRED_CLASS = 'parked on') 
AND OBJ1_SAMPLE_ID != OBJ2_SAMPLE_ID;
```
-------------------------7486 sample_num
```sql
SELECT IMG_ID
FROM IMG_REL
WHERE PRED_CLASS_ID = (SELECT PRED_CLASS_ID FROM PRED_CLASSES WHERE PRED_CLASS = 'parked on')
GROUP BY IMG_ID
HAVING COUNT(DISTINCT CASE WHEN OBJ1_SAMPLE_ID != OBJ2_SAMPLE_ID THEN CONCAT(OBJ1_SAMPLE_ID, '-', OBJ2_SAMPLE_ID) END) > 2;
```
-------------------------7487 sample_num
```sql
SELECT PRED_CLASSES.PRED_CLASS
FROM IMG_REL
JOIN PRED_CLASSES ON IMG_REL.PRED_CLASS_ID = PRED_CLASSES.PRED_CLASS_ID
WHERE IMG_REL.IMG_ID = 5 AND IMG_REL.OBJ1_SAMPLE_ID = IMG_REL.OBJ2_SAMPLE_ID;
```
-------------------------7488 sample_num
```sql
SELECT IMG_OBJ.X, IMG_OBJ.Y, IMG_OBJ.W, IMG_OBJ.H
FROM IMG_OBJ
JOIN IMG_REL ON IMG_OBJ.OBJ_SAMPLE_ID = IMG_REL.OBJ1_SAMPLE_ID OR IMG_OBJ.OBJ_SAMPLE_ID = IMG_REL.OBJ2_SAMPLE_ID
JOIN PRED_CLASSES ON IMG_REL.PRED_CLASS_ID = PRED_CLASSES.PRED_CLASS_ID
WHERE IMG_OBJ.IMG_ID = 1 AND PRED_CLASSES.PRED_CLASS = 'by';
```
-------------------------7489 sample_num
```sql
SELECT AVG(ABS(o1.Y - o2.Y) ) AS average_y_difference
FROM IMG_REL r
JOIN IMG_OBJ o1 ON r.IMG_ID = o1.IMG_ID AND r.OBJ1_SAMPLE_ID = o1.OBJ_SAMPLE_ID
JOIN IMG_OBJ o2 ON r.IMG_ID = o2.IMG_ID AND r.OBJ2_SAMPLE_ID = o2.OBJ_SAMPLE_ID
WHERE r.IMG_ID = 1 AND r.PRED_CLASS_ID = (SELECT PRED_CLASS_ID FROM PRED_CLASSES WHERE PRED_CLASS = 'parked on')
AND o1.OBJ_SAMPLE_ID != o2.OBJ_SAMPLE_ID;
```
-------------------------7490 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN o.OBJ_CLASS = 'man' THEN i.OBJ_SAMPLE_ID END) * 100.0 / COUNT(i.OBJ_SAMPLE_ID)) AS percentage
FROM 
    IMG_OBJ i
JOIN 
    OBJ_CLASSES o ON i.OBJ_CLASS_ID = o.OBJ_CLASS_ID
WHERE 
    i.IMG_ID = 1;
```
-------------------------7491 sample_num
```sql
SELECT COUNT(*) AS total_attribute_classes FROM ATT_CLASSES;
```
-------------------------7492 sample_num
```sql
SELECT COUNT(*) FROM OBJ_CLASSES;
```
-------------------------7493 sample_num
```sql
SELECT COUNT(*) AS number_of_predicted_classes FROM PRED_CLASSES;
```
-------------------------7494 sample_num
```sql
SELECT X, Y, W, H 
FROM IMG_OBJ 
WHERE IMG_ID = 2324765 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'kite');
```
-------------------------7495 sample_num
```sql
SELECT COUNT(DISTINCT IMG_OBJ.OBJ_SAMPLE_ID) AS white_object_count
FROM IMG_OBJ
JOIN IMG_OBJ_ATT ON IMG_OBJ.IMG_ID = IMG_OBJ_ATT.IMG_ID AND IMG_OBJ.OBJ_SAMPLE_ID = IMG_OBJ_ATT.OBJ_SAMPLE_ID
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID
WHERE IMG_OBJ.IMG_ID = 2347915 AND ATT_CLASSES.ATT_CLASS = 'white';
```
-------------------------7496 sample_num
```sql
SELECT COUNT(DISTINCT IMG_OBJ.OBJ_SAMPLE_ID) AS sample_count
FROM IMG_OBJ
JOIN IMG_OBJ_ATT ON IMG_OBJ.IMG_ID = IMG_OBJ_ATT.IMG_ID AND IMG_OBJ.OBJ_SAMPLE_ID = IMG_OBJ_ATT.OBJ_SAMPLE_ID
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID
WHERE IMG_OBJ.IMG_ID = 2377985 AND ATT_CLASSES.ATT_CLASS = 'electrical';
```
-------------------------7497 sample_num
```sql
SELECT PRED_CLASS.PRED_CLASS 
FROM IMG_REL 
JOIN PRED_CLASSES AS PRED_CLASS ON IMG_REL.PRED_CLASS_ID = PRED_CLASS.PRED_CLASS_ID 
WHERE IMG_REL.IMG_ID = 2345511 AND IMG_REL.OBJ1_SAMPLE_ID = 12 AND IMG_REL.OBJ2_SAMPLE_ID = 8;
```
-------------------------7498 sample_num
```sql
SELECT OBJ1_SAMPLE_ID 
FROM IMG_REL 
WHERE IMG_ID = 2345524 AND OBJ2_SAMPLE_ID = 1 AND PRED_CLASS_ID = (SELECT PRED_CLASS_ID FROM PRED_CLASSES WHERE PRED_CLASS = 'lying on');
```
-------------------------7499 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_OBJ 
WHERE IMG_ID = 6 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'food');
```
-------------------------7500 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ 
WHERE OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'suit');
```
-------------------------7501 sample_num
```sql
SELECT r.PRED_CLASS_ID, p.PRED_CLASS
FROM IMG_REL r
JOIN IMG_OBJ o1 ON r.IMG_ID = o1.IMG_ID AND o1.OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'feathers')
JOIN IMG_OBJ o2 ON r.IMG_ID = o2.IMG_ID AND o2.OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'onion')
JOIN PRED_CLASSES p ON r.PRED_CLASS_ID = p.PRED_CLASS_ID
WHERE r.IMG_ID = 2345528;
```
-------------------------7502 sample_num
```sql
SELECT a.ATT_CLASS 
FROM ATT_CLASSES a
JOIN IMG_OBJ_ATT ia ON a.ATT_CLASS_ID = ia.ATT_CLASS_ID
JOIN IMG_OBJ io ON ia.IMG_ID = io.IMG_ID
WHERE io.IMG_ID = 2377988 AND io.OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'weeds');
```
-------------------------7503 sample_num
```sql
SELECT o.OBJ_CLASS
FROM IMG_OBJ_ATT ia
JOIN IMG_OBJ io ON ia.IMG_ID = io.IMG_ID AND ia.OBJ_SAMPLE_ID = io.OBJ_SAMPLE_ID
JOIN OBJ_CLASSES o ON io.OBJ_CLASS_ID = o.OBJ_CLASS_ID
JOIN ATT_CLASSES a ON ia.ATT_CLASS_ID = a.ATT_CLASS_ID
WHERE a.ATT_CLASS = 'blurry' AND ia.IMG_ID = 2377993;
```
-------------------------7504 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_OBJ 
WHERE IMG_ID = 2353079 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'wall');
```
-------------------------7505 sample_num
```sql
SELECT OBJ_CLASS 
FROM OBJ_CLASSES 
WHERE OBJ_CLASS_ID = (
    SELECT OBJ_CLASS_ID 
    FROM IMG_OBJ 
    WHERE IMG_ID = 2320341 AND OBJ_SAMPLE_ID = 10
);
```
-------------------------7506 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN o.OBJ_CLASS = 'broccoli' THEN i.OBJ_SAMPLE_ID END) * 1.0) / 
    (COUNT(CASE WHEN o.OBJ_CLASS = 'tomato' THEN i.OBJ_SAMPLE_ID END)) AS ratio
FROM 
    IMG_OBJ i
JOIN 
    OBJ_CLASSES o ON i.OBJ_CLASS_ID = o.OBJ_CLASS_ID;
```
-------------------------7507 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ_ATT 
GROUP BY IMG_ID 
HAVING COUNT(ATT_CLASS_ID) >= 25;
```
-------------------------7508 sample_num
```sql
SELECT DISTINCT IMG_ID 
FROM IMG_REL 
WHERE OBJ1_SAMPLE_ID = OBJ2_SAMPLE_ID;
```
-------------------------7509 sample_num
```sql
SELECT COUNT(OBJ_SAMPLE_ID) 
FROM IMG_OBJ_ATT 
WHERE ATT_CLASS_ID = (
    SELECT ATT_CLASS_ID 
    FROM IMG_OBJ_ATT 
    GROUP BY ATT_CLASS_ID 
    ORDER BY COUNT(OBJ_SAMPLE_ID) DESC 
    LIMIT 1
);
```
-------------------------7510 sample_num
```sql
SELECT OBJ_CLASS_ID 
FROM OBJ_CLASSES 
WHERE OBJ_CLASS IN ('bus', 'train', 'aeroplane', 'car', 'etc.');
```
-------------------------7511 sample_num
```sql
SELECT OBJ_CLASSES.OBJ_CLASS
FROM ATT_CLASSES
JOIN IMG_OBJ_ATT ON ATT_CLASSES.ATT_CLASS_ID = IMG_OBJ_ATT.ATT_CLASS_ID
JOIN IMG_OBJ ON IMG_OBJ_ATT.IMG_ID = IMG_OBJ.IMG_ID
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID
WHERE ATT_CLASSES.ATT_CLASS = 'very large bike';
```
-------------------------7512 sample_num
```sql
SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'onion';
```
-------------------------7513 sample_num
```sql
SELECT DISTINCT a.ATT_CLASS
FROM ATT_CLASSES a
JOIN IMG_OBJ_ATT ia ON a.ATT_CLASS_ID = ia.ATT_CLASS_ID
WHERE ia.IMG_ID = 8;
```
-------------------------7514 sample_num
```sql
SELECT X, Y, W, H 
FROM IMG_OBJ 
WHERE IMG_ID = 4 
AND OBJ_SAMPLE_ID IN (
    SELECT OBJ1_SAMPLE_ID 
    FROM IMG_REL 
    WHERE IMG_ID = 4 
    AND PRED_CLASS_ID = 144
);
```
-------------------------7515 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ_ATT 
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID 
WHERE ATT_CLASSES.ATT_CLASS = 'black' 
GROUP BY IMG_ID 
HAVING COUNT(ATT_CLASS_ID) >= 5;
```
-------------------------7516 sample_num
```sql
SELECT IMG_REL.PRED_CLASS_ID
FROM IMG_OBJ
JOIN IMG_REL ON IMG_OBJ.IMG_ID = IMG_REL.IMG_ID
WHERE IMG_OBJ.H = (SELECT MAX(H) FROM IMG_OBJ);
```
-------------------------7517 sample_num
```sql
SELECT IMG_ID
FROM IMG_OBJ_ATT
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID
WHERE ATT_CLASSES.ATT_CLASS = 'white'
GROUP BY IMG_ID
ORDER BY COUNT(ATT_CLASS_ID) DESC
LIMIT 1;
```
-------------------------7518 sample_num
```sql
SELECT IMG_OBJ.X, IMG_OBJ.Y
FROM IMG_OBJ
JOIN IMG_REL ON IMG_OBJ.IMG_ID = IMG_REL.IMG_ID
WHERE IMG_REL.PRED_CLASS_ID = 98;
```
-------------------------7519 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_REL 
WHERE IMG_ID = 3050 AND PRED_CLASS_ID IN (SELECT PRED_CLASS_ID FROM PRED_CLASSES WHERE PRED_CLASS = 'has');
```
-------------------------7520 sample_num
```sql
SELECT DISTINCT o.OBJ_CLASS
FROM IMG_OBJ i
JOIN OBJ_CLASSES o ON i.OBJ_CLASS_ID = o.OBJ_CLASS_ID
WHERE i.X = 0 AND i.Y = 0;
```
-------------------------7521 sample_num
```sql
SELECT DISTINCT PRED_CLASSES.PRED_CLASS
FROM IMG_REL
JOIN PRED_CLASSES ON IMG_REL.PRED_CLASS_ID = PRED_CLASSES.PRED_CLASS_ID
WHERE IMG_REL.OBJ1_SAMPLE_ID = IMG_REL.OBJ2_SAMPLE_ID;
```
-------------------------7522 sample_num
```sql
SELECT X, Y, W, H 
FROM IMG_OBJ 
WHERE IMG_ID = 2222 
AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'feathers');
```
-------------------------7523 sample_num
```sql
SELECT COUNT(DISTINCT IMG_REL.IMG_ID) AS image_count
FROM IMG_REL
WHERE OBJ1_SAMPLE_ID != OBJ2_SAMPLE_ID
AND PRED_CLASS_ID IN (SELECT PRED_CLASS_ID FROM PRED_CLASSES WHERE PRED_CLASS = 'on');
```
-------------------------7524 sample_num
```sql
SELECT OBJ_CLASSES.OBJ_CLASS 
FROM IMG_OBJ 
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID 
WHERE IMG_OBJ.X = 0 AND IMG_OBJ.Y = 0 AND IMG_OBJ.W = 135 AND IMG_OBJ.H = 212;
```
-------------------------7525 sample_num
```sql
SELECT W, H 
FROM IMG_OBJ 
WHERE IMG_ID = 3 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'keyboard');
```
-------------------------7526 sample_num
```sql
SELECT MIN(X) AS min_x, MAX(X + W) AS max_x, MIN(Y) AS min_y, MAX(Y + H) AS max_y
FROM IMG_OBJ
WHERE IMG_ID = 6 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'folk');
```
-------------------------7527 sample_num
```sql
SELECT X, Y, W, H 
FROM IMG_OBJ 
WHERE IMG_ID = 285930 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'onion');
```
-------------------------7528 sample_num
```sql
SELECT 
    (SELECT COUNT(*) 
     FROM IMG_OBJ 
     WHERE IMG_ID = 72) AS object_count,
    (SELECT OBJ_CLASS 
     FROM IMG_OBJ 
     JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID 
     WHERE IMG_ID = 72 
       AND X = 341 
       AND Y = 27 
       AND W = 42 
       AND H = 51) AS identified_objects;
```
-------------------------7529 sample_num
```sql
SELECT a.ATT_CLASS
FROM IMG_OBJ_ATT ia
JOIN ATT_CLASSES a ON ia.ATT_CLASS_ID = a.ATT_CLASS_ID
WHERE ia.IMG_ID = 5
GROUP BY a.ATT_CLASS
HAVING COUNT(DISTINCT ia.OBJ_SAMPLE_ID) >= 2;
```
-------------------------7530 sample_num
```sql
SELECT a.ATT_CLASS
FROM ATT_CLASSES a
JOIN IMG_OBJ_ATT ia ON a.ATT_CLASS_ID = ia.ATT_CLASS_ID
JOIN IMG_OBJ io ON ia.IMG_ID = io.IMG_ID
JOIN OBJ_CLASSES o ON io.OBJ_CLASS_ID = o.OBJ_CLASS_ID
WHERE o.OBJ_CLASS = 'wall' AND io.IMG_ID = 27;
```
-------------------------7531 sample_num
```sql
SELECT o.OBJ_CLASS 
FROM OBJ_CLASSES o
JOIN IMG_OBJ img ON o.OBJ_CLASS_ID = img.OBJ_CLASS_ID
JOIN IMG_OBJ_ATT img_att ON img.IMG_ID = img_att.IMG_ID AND img.OBJ_SAMPLE_ID = img_att.OBJ_SAMPLE_ID
JOIN ATT_CLASSES a ON img_att.ATT_CLASS_ID = a.ATT_CLASS_ID
WHERE img.IMG_ID = 10 AND a.ATT_CLASS = 'scattered';
```
-------------------------7532 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ 
WHERE OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'bridge');
```
-------------------------7533 sample_num
```sql
SELECT AVG(obj_count) AS average_object_elements
FROM (
    SELECT IMG_ID, COUNT(OBJ_CLASS_ID) AS obj_count
    FROM IMG_OBJ
    GROUP BY IMG_ID
) AS img_counts;
```
-------------------------7534 sample_num
```sql
SELECT a.ATT_CLASS
FROM IMG_OBJ io
JOIN IMG_OBJ_ATT ioa ON io.IMG_ID = ioa.IMG_ID AND io.OBJ_SAMPLE_ID = ioa.OBJ_SAMPLE_ID
JOIN ATT_CLASSES a ON ioa.ATT_CLASS_ID = a.ATT_CLASS_ID
JOIN OBJ_CLASSES o ON io.OBJ_CLASS_ID = o.OBJ_CLASS_ID
WHERE io.IMG_ID = 1 AND o.OBJ_CLASS = 'van';
```
-------------------------7535 sample_num
```sql
SELECT 
    o.OBJ_CLASS, 
    a.ATT_CLASS, 
    r.PRED_CLASS 
FROM 
    IMG_OBJ io 
JOIN 
    OBJ_CLASSES o ON io.OBJ_CLASS_ID = o.OBJ_CLASS_ID 
LEFT JOIN 
    IMG_OBJ_ATT ioa ON io.IMG_ID = ioa.IMG_ID AND io.OBJ_SAMPLE_ID = ioa.OBJ_SAMPLE_ID 
LEFT JOIN 
    ATT_CLASSES a ON ioa.ATT_CLASS_ID = a.ATT_CLASS_ID 
LEFT JOIN 
    IMG_REL ir ON io.IMG_ID = ir.IMG_ID AND io.OBJ_SAMPLE_ID = ir.OBJ1_SAMPLE_ID 
LEFT JOIN 
    PRED_CLASSES r ON ir.PRED_CLASS_ID = r.PRED_CLASS_ID 
WHERE 
    io.IMG_ID = 1 
    AND io.X = 388 
    AND io.Y = 369 
    AND io.W = 48 
    AND io.H = 128;
```
-------------------------7536 sample_num
```sql
SELECT P.PRED_CLASS
FROM IMG_REL R
JOIN PRED_CLASSES P ON R.PRED_CLASS_ID = P.PRED_CLASS_ID
WHERE R.IMG_ID = 1 AND R.OBJ1_SAMPLE_ID = 25 AND R.OBJ2_SAMPLE_ID = 2;
```
-------------------------7537 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_OBJ_ATT 
WHERE IMG_ID = 4 AND OBJ_SAMPLE_ID = 7;
```
-------------------------7538 sample_num
```sql
SELECT COUNT(DISTINCT OBJ_CLASS_ID) AS ObjectElementCount
FROM IMG_OBJ
WHERE IMG_ID = 31;
```
-------------------------7539 sample_num
```sql
SELECT IMG_OBJ_ATT.ATT_CLASS_ID
FROM IMG_OBJ_ATT
JOIN IMG_OBJ ON IMG_OBJ_ATT.IMG_ID = IMG_OBJ.IMG_ID
WHERE IMG_OBJ.IMG_ID = 20
GROUP BY IMG_OBJ_ATT.ATT_CLASS_ID
ORDER BY COUNT(IMG_OBJ.OBJ_CLASS_ID) DESC
LIMIT 1;
```
-------------------------7540 sample_num
```sql
SELECT X, Y, W, H 
FROM IMG_OBJ 
WHERE IMG_ID = 42 AND OBJ_SAMPLE_ID = 7;
```
-------------------------7541 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN a.ATT_CLASS = 'white' THEN i.OBJ_SAMPLE_ID END) * 100.0 / COUNT(i.OBJ_SAMPLE_ID)) AS percentage
FROM 
    IMG_OBJ i
LEFT JOIN 
    IMG_OBJ_ATT ia ON i.IMG_ID = ia.IMG_ID AND i.OBJ_SAMPLE_ID = ia.OBJ_SAMPLE_ID
LEFT JOIN 
    ATT_CLASSES a ON ia.ATT_CLASS_ID = a.ATT_CLASS_ID
WHERE 
    i.IMG_ID = 99;
```
-------------------------7542 sample_num
```sql
SELECT COUNT(DISTINCT ATT_CLASS_ID) 
FROM IMG_OBJ_ATT 
WHERE IMG_ID = 5;
```
-------------------------7543 sample_num
```sql
SELECT OBJ_CLASS FROM OBJ_CLASSES WHERE OBJ_CLASS_ID = 10;
```
-------------------------7544 sample_num
```sql
SELECT OBJ_CLASS 
FROM OBJ_CLASSES 
WHERE OBJ_CLASS_ID = (
    SELECT OBJ_CLASS_ID 
    FROM IMG_OBJ 
    WHERE X = 422 AND Y = 63 AND W = 77 AND H = 363
);
```
-------------------------7545 sample_num
```sql
SELECT PRED_CLASS FROM PRED_CLASSES WHERE PRED_CLASS_ID = 12;
```
-------------------------7546 sample_num
```sql
SELECT X, Y, W, H FROM IMG_OBJ WHERE IMG_ID = 8;
```
-------------------------7547 sample_num
```sql
SELECT COUNT(DISTINCT IMG_OBJ.OBJ_SAMPLE_ID) 
FROM IMG_OBJ 
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID 
WHERE IMG_OBJ.IMG_ID = 908 AND OBJ_CLASSES.OBJ_CLASS = 'tip';
```
-------------------------7548 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_OBJ 
WHERE IMG_ID = 41 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'kitchen');
```
-------------------------7549 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ 
WHERE OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'paint');
```
-------------------------7550 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_OBJ 
WHERE IMG_ID = 2315533 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'cloud');
```
-------------------------7551 sample_num
```sql
SELECT * FROM OBJ_CLASSES WHERE OBJ_CLASS = 'onion';
```
-------------------------7552 sample_num
```sql
SELECT X, Y, W, H 
FROM IMG_OBJ 
WHERE IMG_ID = 1344 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'spoon');
```
-------------------------7553 sample_num
```sql
SELECT 
    DIVIDE(SUM(CASE WHEN o.OBJ_CLASS = 'surface' THEN 1 ELSE 0 END), COUNT(*)) * 100 AS percentage
FROM 
    IMG_OBJ i
JOIN 
    OBJ_CLASSES o ON i.OBJ_CLASS_ID = o.OBJ_CLASS_ID
WHERE 
    i.IMG_ID = 2654;
```
-------------------------7554 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ 
WHERE OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'wood');
```
-------------------------7555 sample_num
```sql
SELECT o.OBJ_CLASS
FROM IMG_OBJ i
JOIN OBJ_CLASSES o ON i.OBJ_CLASS_ID = o.OBJ_CLASS_ID
ORDER BY i.H DESC
LIMIT 1;
```
-------------------------7556 sample_num
```sql
SELECT 
    (SUM(CASE WHEN o.OBJ_CLASS = 'airplane' THEN 1 ELSE 0 END) * 100.0 / COUNT(o.OBJ_CLASS)) AS percentage
FROM 
    OBJ_CLASSES o
JOIN 
    IMG_OBJ i ON o.OBJ_CLASS_ID = i.OBJ_CLASS_ID;
```
-------------------------7557 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_OBJ 
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID 
WHERE IMG_OBJ.IMG_ID = 660 AND OBJ_CLASSES.OBJ_CLASS = 'animal';
```
-------------------------7558 sample_num
```sql
SELECT COUNT(*) AS number_of_samples
FROM IMG_OBJ
WHERE IMG_ID = 1098 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'bed');
```
-------------------------7559 sample_num
```sql
SELECT o.OBJ_CLASS
FROM IMG_OBJ i
JOIN OBJ_CLASSES o ON i.OBJ_CLASS_ID = o.OBJ_CLASS_ID
WHERE i.H = (SELECT MIN(H) FROM IMG_OBJ);
```
-------------------------7560 sample_num
```sql
SELECT X, Y, W, H 
FROM IMG_OBJ 
WHERE IMG_ID = 250 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'kitchen');
```
-------------------------7561 sample_num
```sql
SELECT IMG_ID
FROM IMG_OBJ
GROUP BY IMG_ID
HAVING COUNT(OBJ_SAMPLE_ID) > 20;
```
-------------------------7562 sample_num
```sql
SELECT OBJ_SAMPLE_ID 
FROM IMG_OBJ 
WHERE IMG_ID = 8 
ORDER BY W DESC 
LIMIT 1;
```
-------------------------7563 sample_num
```sql
SELECT OBJ_SAMPLE_ID 
FROM IMG_OBJ 
WHERE IMG_ID = 5 AND X = 634 AND Y = 468;
```
-------------------------7564 sample_num
```sql
SELECT OBJ_SAMPLE_ID
FROM IMG_OBJ_ATT
GROUP BY OBJ_SAMPLE_ID
ORDER BY COUNT(ATT_CLASS_ID) DESC
LIMIT 1;
```
-------------------------7565 sample_num
```sql
SELECT 
    (SELECT COUNT(OBJ_SAMPLE_ID) FROM IMG_OBJ WHERE IMG_ID = 1) * 1.0 / 
    (SELECT COUNT(OBJ_SAMPLE_ID) FROM IMG_OBJ WHERE IMG_ID = 6) AS ratio;
```
-------------------------7566 sample_num
```sql
SELECT AVG(sample_count) AS average_object_samples
FROM (
    SELECT IMG_ID, COUNT(OBJ_SAMPLE_ID) AS sample_count
    FROM IMG_OBJ
    GROUP BY IMG_ID
) AS subquery;
```
-------------------------7567 sample_num
```sql
SELECT DISTINCT IMG_OBJ.IMG_ID
FROM IMG_OBJ
JOIN IMG_OBJ_ATT ON IMG_OBJ.IMG_ID = IMG_OBJ_ATT.IMG_ID
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID
WHERE ATT_CLASSES.ATT_CLASS = 'wired';
```
-------------------------7568 sample_num
```sql
SELECT OBJ_CLASSES.OBJ_CLASS 
FROM IMG_OBJ 
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID 
WHERE IMG_OBJ.IMG_ID = 10;
```
-------------------------7569 sample_num
```sql
SELECT a.ATT_CLASS
FROM ATT_CLASSES a
JOIN IMG_OBJ_ATT ia ON a.ATT_CLASS_ID = ia.ATT_CLASS_ID
JOIN IMG_OBJ io ON ia.IMG_ID = io.IMG_ID
JOIN OBJ_CLASSES o ON io.OBJ_CLASS_ID = o.OBJ_CLASS_ID
WHERE o.OBJ_CLASS = 'tip' AND io.IMG_ID = 1314;
```
-------------------------7570 sample_num
```sql
SELECT P.PRED_CLASS
FROM IMG_REL R
JOIN PRED_CLASSES P ON R.PRED_CLASS_ID = P.PRED_CLASS_ID
JOIN IMG_OBJ O1 ON R.OBJ1_SAMPLE_ID = O1.OBJ_SAMPLE_ID AND O1.IMG_ID = 2360078
JOIN IMG_OBJ O2 ON R.OBJ2_SAMPLE_ID = O2.OBJ_SAMPLE_ID AND O2.IMG_ID = 2360078
WHERE O1.OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'chain')
  AND O2.OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'label');
```
-------------------------7571 sample_num
```sql
SELECT COUNT(DISTINCT IMG_OBJ.IMG_ID) 
FROM IMG_OBJ 
JOIN IMG_OBJ_ATT ON IMG_OBJ.IMG_ID = IMG_OBJ_ATT.IMG_ID 
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID 
WHERE ATT_CLASSES.ATT_CLASS = 'polka dot';
```
-------------------------7572 sample_num
```sql
SELECT a.ATT_CLASS
FROM IMG_OBJ io
JOIN IMG_OBJ_ATT ioa ON io.IMG_ID = ioa.IMG_ID AND io.OBJ_SAMPLE_ID = ioa.OBJ_SAMPLE_ID
JOIN ATT_CLASSES a ON ioa.ATT_CLASS_ID = a.ATT_CLASS_ID
WHERE io.IMG_ID = 400 AND io.W = (
    SELECT MAX(W)
    FROM IMG_OBJ
    WHERE IMG_ID = 400
);
```
-------------------------7573 sample_num
```sql
SELECT OC.OBJ_CLASS
FROM OBJ_CLASSES OC
JOIN IMG_OBJ IO ON OC.OBJ_CLASS_ID = IO.OBJ_CLASS_ID
GROUP BY OC.OBJ_CLASS
ORDER BY COUNT(IO.IMG_ID) DESC
LIMIT 1;
```
-------------------------7574 sample_num
```sql
SELECT W, H 
FROM IMG_OBJ 
WHERE IMG_ID = 1 AND OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'van');
```
-------------------------7575 sample_num
```sql
SELECT IMG_OBJ.X, IMG_OBJ.Y
FROM IMG_OBJ
JOIN IMG_OBJ_ATT ON IMG_OBJ.IMG_ID = IMG_OBJ_ATT.IMG_ID AND IMG_OBJ.OBJ_SAMPLE_ID = IMG_OBJ_ATT.OBJ_SAMPLE_ID
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID
WHERE IMG_OBJ.IMG_ID = 1 AND ATT_CLASSES.ATT_CLASS = 'sparse';
```
-------------------------7576 sample_num
```sql
SELECT 
    DIVIDE(COUNT(DISTINCT IMG_OBJ.OBJ_SAMPLE_ID) FILTER (WHERE OBJ_CLASSES.OBJ_CLASS = 'street lights'), 
            COUNT(DISTINCT IMG_OBJ.OBJ_SAMPLE_ID)) AS percentage
FROM 
    IMG_OBJ
JOIN 
    OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID;
```
-------------------------7577 sample_num
```sql
SELECT 
    DIVIDE(COUNT(IMG_OBJ.OBJ_SAMPLE_ID) FILTER (WHERE OBJ_CLASSES.OBJ_CLASS = 'windows' AND IMG_OBJ.IMG_ID = 5), 
           COUNT(IMG_OBJ.OBJ_SAMPLE_ID) FILTER (WHERE IMG_OBJ.IMG_ID = 5)) AS percentage
FROM 
    IMG_OBJ
JOIN 
    OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID
WHERE 
    IMG_OBJ.IMG_ID = 5;
```
-------------------------7578 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ 
WHERE X = 5 AND Y = 5;
```
-------------------------7579 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ 
GROUP BY IMG_ID 
HAVING COUNT(OBJ_SAMPLE_ID) < 15;
```
-------------------------7580 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ_ATT 
GROUP BY IMG_ID 
HAVING COUNT(ATT_CLASS_ID) = 10;
```
-------------------------7581 sample_num
```sql
SELECT DISTINCT IMG_ID
FROM IMG_REL
GROUP BY IMG_ID, OBJ1_SAMPLE_ID, OBJ2_SAMPLE_ID
HAVING COUNT(PRED_CLASS_ID) > 1;
```
-------------------------7582 sample_num
```sql
SELECT COUNT(DISTINCT img.IMG_ID) AS image_count
FROM IMG_OBJ img
JOIN OBJ_CLASSES obj ON img.OBJ_CLASS_ID = obj.OBJ_CLASS_ID
WHERE obj.OBJ_CLASS IN ('vegetables', 'fruits')
GROUP BY img.IMG_ID
HAVING COUNT(DISTINCT obj.OBJ_CLASS) = 2;
```
-------------------------7583 sample_num
```sql
SELECT IMG_ID 
FROM IMG_REL 
WHERE PRED_CLASS_ID = (SELECT PRED_CLASS_ID FROM PRED_CLASSES WHERE PRED_CLASS = 'parked on');
```
-------------------------7584 sample_num
```sql
SELECT DISTINCT OC.OBJ_CLASS
FROM IMG_OBJ IO
JOIN OBJ_CLASSES OC ON IO.OBJ_CLASS_ID = OC.OBJ_CLASS_ID
WHERE IO.X = 5 AND IO.Y = 5;
```
-------------------------7585 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ 
WHERE OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'keyboard');
```
-------------------------7586 sample_num
```sql
SELECT W, H 
FROM IMG_OBJ 
WHERE OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'keyboard') 
AND X = 5 AND Y = 647;
```
-------------------------7587 sample_num
```sql
SELECT DISTINCT IMG_ID 
FROM IMG_OBJ_ATT 
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID 
WHERE ATT_CLASSES.ATT_CLASS = 'horse';
```
-------------------------7588 sample_num
```sql
SELECT IMG_OBJ.X, IMG_OBJ.Y
FROM IMG_OBJ
JOIN IMG_OBJ_ATT ON IMG_OBJ.IMG_ID = IMG_OBJ_ATT.IMG_ID
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID
WHERE ATT_CLASSES.ATT_CLASS = 'horse' AND OBJ_CLASSES.OBJ_CLASS = 'fur';
```
-------------------------7589 sample_num
```sql
SELECT a.ATT_CLASS
FROM ATT_CLASSES a
JOIN IMG_OBJ_ATT ia ON a.ATT_CLASS_ID = ia.ATT_CLASS_ID
WHERE ia.IMG_ID = 15;
```
-------------------------7590 sample_num
```sql
SELECT COUNT(DISTINCT img.IMG_ID) AS image_count
FROM IMG_REL img_rel
JOIN IMG_OBJ img ON img_rel.IMG_ID = img.IMG_ID
WHERE img_rel.PRED_CLASS_ID IN (
    SELECT PRED_CLASS_ID
    FROM PRED_CLASSES
    WHERE PRED_CLASS = 'reading'
)
GROUP BY img_rel.OBJ1_SAMPLE_ID, img_rel.OBJ2_SAMPLE_ID
HAVING COUNT(DISTINCT img_rel.PRED_CLASS_ID) > 1;
```
-------------------------7591 sample_num
```sql
SELECT COUNT(DISTINCT IMG_ID) 
FROM IMG_OBJ_ATT 
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID 
WHERE ATT_CLASSES.ATT_CLASS = 'picture';
```
-------------------------7592 sample_num
```sql
SELECT COUNT(DISTINCT img.IMG_ID) AS image_count
FROM IMG_OBJ img
JOIN OBJ_CLASSES obj ON img.OBJ_CLASS_ID = obj.OBJ_CLASS_ID
JOIN IMG_OBJ_ATT img_att ON img.IMG_ID = img_att.IMG_ID
JOIN ATT_CLASSES att ON img_att.ATT_CLASS_ID = att.ATT_CLASS_ID
WHERE obj.OBJ_CLASS = 'bear' AND att.ATT_CLASS = 'picture';
```
-------------------------7593 sample_num
```sql
SELECT DISTINCT a.ATT_CLASS
FROM ATT_CLASSES a
JOIN IMG_OBJ_ATT ioa ON a.ATT_CLASS_ID = ioa.ATT_CLASS_ID
JOIN IMG_OBJ io ON ioa.IMG_ID = io.IMG_ID
WHERE io.X = 5 AND io.Y = 5;
```
-------------------------7594 sample_num
```sql
SELECT AVG(image_count) AS average_images
FROM (
    SELECT COUNT(DISTINCT IMG_ID) AS image_count
    FROM IMG_OBJ_ATT
    JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID
    WHERE ATT_CLASSES.ATT_CLASS = 'keyboard'
    GROUP BY IMG_ID
) AS subquery;
```
-------------------------7595 sample_num
```sql
SELECT 
    DIVIDE(
        COUNT(CASE WHEN OC.OBJ_CLASS = 'man' THEN IO.IMG_ID END), 
        COUNT(CASE WHEN OC.OBJ_CLASS = 'person' THEN IO.IMG_ID END)
    ) AS ratio
FROM 
    IMG_OBJ IO
JOIN 
    OBJ_CLASSES OC ON IO.OBJ_CLASS_ID = OC.OBJ_CLASS_ID;
```
-------------------------7596 sample_num
```sql
SELECT OBJ_SAMPLE_ID 
FROM IMG_OBJ 
WHERE IMG_ID = 17 AND X = 0 AND Y = 0;
```
-------------------------7597 sample_num
```sql
SELECT W, H FROM IMG_OBJ WHERE OBJ_SAMPLE_ID = 2;
```
-------------------------7598 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_OBJ 
WHERE IMG_ID = 12 AND Y = 0;
```
-------------------------7599 sample_num
```sql
SELECT a.ATT_CLASS
FROM ATT_CLASSES a
JOIN IMG_OBJ_ATT ia ON a.ATT_CLASS_ID = ia.ATT_CLASS_ID
WHERE ia.IMG_ID = 22;
```
-------------------------7600 sample_num
```sql
SELECT OBJ_CLASSES.OBJ_CLASS
FROM IMG_OBJ
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID
WHERE IMG_OBJ.IMG_ID = 36 AND IMG_OBJ.X = 0 AND IMG_OBJ.Y = 0;
```
-------------------------7601 sample_num
```sql
SELECT X, Y, W, H 
FROM IMG_OBJ 
WHERE OBJ_CLASS_ID = (SELECT OBJ_CLASS_ID FROM OBJ_CLASSES WHERE OBJ_CLASS = 'pizza') 
LIMIT 10;
```
-------------------------7602 sample_num
```sql
SELECT o.OBJ_CLASS
FROM IMG_OBJ i
JOIN OBJ_CLASSES o ON i.OBJ_CLASS_ID = o.OBJ_CLASS_ID
WHERE i.X = 126 AND i.Y = 363;
```
-------------------------7603 sample_num
```sql
SELECT OBJ_CLASS_ID
FROM IMG_OBJ
WHERE IMG_ID = 56
GROUP BY OBJ_CLASS_ID
ORDER BY COUNT(OBJ_CLASS_ID) DESC
LIMIT 1;
```
-------------------------7604 sample_num
```sql
SELECT OBJ_CLASSES.OBJ_CLASS, IMG_OBJ.W, IMG_OBJ.H
FROM IMG_OBJ
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID
WHERE IMG_OBJ.IMG_ID = 22;
```
-------------------------7605 sample_num
```sql
SELECT PRED_CLASS 
FROM PRED_CLASSES 
WHERE PRED_CLASS_ID IN (SELECT PRED_CLASS_ID FROM IMG_REL WHERE IMG_ID = 68);
```
-------------------------7606 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_REL 
WHERE IMG_ID = 107 AND PRED_CLASS_ID IN (SELECT PRED_CLASS_ID FROM PRED_CLASSES WHERE PRED_CLASS = 'has');
```
-------------------------7607 sample_num
```sql
SELECT PRED_CLASS_ID
FROM IMG_REL
WHERE IMG_ID = 4434
GROUP BY PRED_CLASS_ID
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------7608 sample_num
```sql
SELECT COUNT(*) AS dress_count, X, Y 
FROM IMG_OBJ 
JOIN OBJ_CLASSES ON IMG_OBJ.OBJ_CLASS_ID = OBJ_CLASSES.OBJ_CLASS_ID 
WHERE OBJ_CLASSES.OBJ_CLASS = 'dress' AND IMG_OBJ.IMG_ID = 1764 
GROUP BY X, Y;
```
-------------------------7609 sample_num
```sql
SELECT IMG_OBJ.X, IMG_OBJ.Y
FROM IMG_OBJ
JOIN IMG_OBJ_ATT ON IMG_OBJ.IMG_ID = IMG_OBJ_ATT.IMG_ID AND IMG_OBJ.OBJ_SAMPLE_ID = IMG_OBJ_ATT.OBJ_SAMPLE_ID
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID
WHERE IMG_OBJ.IMG_ID = 23 AND ATT_CLASSES.ATT_CLASS = 'cast';
```
-------------------------7610 sample_num
```sql
SELECT COUNT(*) 
FROM IMG_OBJ_ATT 
JOIN ATT_CLASSES ON IMG_OBJ_ATT.ATT_CLASS_ID = ATT_CLASSES.ATT_CLASS_ID 
WHERE ATT_CLASSES.ATT_CLASS = 'blue' AND IMG_OBJ_ATT.IMG_ID = 2355735;
```
-------------------------7611 sample_num
```sql
SELECT AVG(W) AS average_width, AVG(H) AS average_height, oc.OBJ_CLASS
FROM IMG_OBJ io
JOIN OBJ_CLASSES oc ON io.OBJ_CLASS_ID = oc.OBJ_CLASS_ID
WHERE io.IMG_ID = 47
GROUP BY oc.OBJ_CLASS;
```
-------------------------7612 sample_num
```sql
SELECT firstName, lastName 
FROM Master 
WHERE birthCountry != 'USA' AND birthYear = 1990;
```
-------------------------7613 sample_num
```sql
SELECT nameGiven 
FROM Master 
WHERE shootCatch IS NULL AND pos = 'F';
```
-------------------------7614 sample_num
```sql
SELECT DISTINCT M.playerID, M.firstName, M.lastName
FROM Master M
LEFT JOIN HOF H ON M.hofID = H.hofID
WHERE H.hofID IS NULL;
```
-------------------------7615 sample_num
```sql
SELECT firstName, birthYear, birthMon, birthDay
FROM Master
WHERE deathYear IS NULL
ORDER BY birthYear DESC, birthMon DESC, birthDay DESC
LIMIT 1;
```
-------------------------7616 sample_num
```sql
SELECT CONCAT(firstName, ' ', lastName) AS player_name, 
       (deathYear - birthYear) AS age_when_died
FROM Master
WHERE deathYear IS NOT NULL 
  AND shootCatch IS NULL;
```
-------------------------7617 sample_num
```sql
SELECT M.firstName, M.lastName
FROM Goalies G
JOIN Master M ON G.playerID = M.playerID
WHERE G.year BETWEEN 2000 AND 2005
GROUP BY M.playerID
HAVING COUNT(DISTINCT G.tmID) > 2;
```
-------------------------7618 sample_num
```sql
SELECT AVG(weight) AS average_weight
FROM Master
WHERE height > 72;
```
-------------------------7619 sample_num
```sql
SELECT m.firstName, m.birthCountry
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
GROUP BY g.playerID, m.firstName, m.birthCountry
HAVING SUM(g.Min) > 5000;
```
-------------------------7620 sample_num
```sql
SELECT DISTINCT g1.playerID, m.firstName, m.lastName
FROM Goalies g1
JOIN Master m ON g1.playerID = m.playerID
WHERE g1.lgID = 'PCHA' AND g1.playerID IN (
    SELECT g2.playerID
    FROM Goalies g2
    WHERE g2.lgID = 'NHL'
);
```
-------------------------7621 sample_num
```sql
SELECT g.lastName, g.year, MAX(g.Min) AS maxMinutes
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
WHERE m.deathYear IS NOT NULL
GROUP BY g.lastName, g.year
ORDER BY g.lastName;
```
-------------------------7622 sample_num
```sql
SELECT 
    m.nameGiven AS given_name, 
    m.height, 
    m.weight, 
    YEAR(NOW()) - m.birthYear AS age
FROM 
    Goalies g
JOIN 
    Master m ON g.playerID = m.playerID
WHERE 
    g.year BETWEEN 2000 AND 2010 
    AND g.tmID = 'COL';
```
-------------------------7623 sample_num
```sql
SELECT g.playerID, g.year
FROM Goalies g
WHERE g.ENG >= 10;
```
-------------------------7624 sample_num
```sql
SELECT playerID, year, (GA * 100.0 / SA) AS goals_against_percentage
FROM Goalies
WHERE SA > 0
ORDER BY goals_against_percentage ASC
LIMIT 1;
```
-------------------------7625 sample_num
```sql
SELECT g.playerID, m.firstName, m.lastName, t.name
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
JOIN Teams t ON g.tmID = t.tmID AND g.year = t.year
WHERE g.year = 2005 AND m.height < 72;
```
-------------------------7626 sample_num
```sql
SELECT m.nameNick, t.tmID, t.year
FROM Master m
JOIN Teams t ON m.playerID = t.tmID
WHERE m.playerID = 'aubinje01';
```
-------------------------7627 sample_num
```sql
SELECT g.playerID, COUNT(g.year) AS seasons_played, AVG(g.Min) AS average_time_per_season
FROM Goalies g
GROUP BY g.playerID
HAVING COUNT(g.year) = (
    SELECT MAX(seasons)
    FROM (
        SELECT COUNT(year) AS seasons
        FROM Goalies
        GROUP BY playerID
    ) AS subquery
);
```
-------------------------7628 sample_num
```sql
SELECT g.playerID, g.year
FROM Goalies g
WHERE (g.SHO / NULLIF(g.GA, 0)) * 100 = 5.00;
```
-------------------------7629 sample_num
```sql
SELECT firstName, lastName 
FROM Master 
WHERE birthCountry != deathCountry 
ORDER BY birthYear;
```
-------------------------7630 sample_num
```sql
SELECT firstName, firstNHL, firstWHA
FROM Master
WHERE firstNHL IS NOT NULL AND firstWHA IS NOT NULL;
```
-------------------------7631 sample_num
```sql
SELECT firstName, pos
FROM Master
WHERE deathYear IS NULL
AND playerID IN (
    SELECT playerID
    FROM Scoring
    GROUP BY playerID
    HAVING COUNT(DISTINCT pos) = 2
);
```
-------------------------7632 sample_num
```sql
SELECT nameNick, lastNHL 
FROM Master 
WHERE height = (SELECT MAX(height) FROM Master) 
AND lastNHL IS NOT NULL;
```
-------------------------7633 sample_num
```sql
SELECT 
    CASE 
        WHEN birthYear >= 1990 THEN '1990 and after' 
        ELSE 'Before 1990' 
    END AS birth_group,
    AVG(height) AS average_height
FROM Master
GROUP BY birth_group;
```
-------------------------7634 sample_num
```sql
SELECT DISTINCT g.playerID, m.firstName, m.lastName, t.name AS teamName
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
JOIN Coaches c ON g.playerID = c.coachID
JOIN Teams t ON g.tmID = t.tmID AND g.year = t.year
WHERE m.shootCatch = 'L' AND m.pos = 'G';
```
-------------------------7635 sample_num
```sql
SELECT g.playerID, g.year, g.tmID, g.lgID, m.firstName, m.lastName
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
WHERE m.deathYear IS NOT NULL AND m.birthCountry = 'Canada';
```
-------------------------7636 sample_num
```sql
SELECT g.playerID, g.year
FROM Goalies g
JOIN Teams t ON g.tmID = t.tmID AND g.year = t.year
WHERE t.name = 'Boston Bruins' AND t.rank = 1;
```
-------------------------7637 sample_num
```sql
SELECT DISTINCT T.name
FROM Goalies G
JOIN Master M ON G.playerID = M.playerID
JOIN Teams T ON G.tmID = T.tmID AND G.year = T.year
WHERE M.firstNHL < 1950 AND M.deathYear IS NULL;
```
-------------------------7638 sample_num
```sql
SELECT m.nameGiven, c.tmID, c.year
FROM Master m
JOIN Coaches c ON m.coachID = c.coachID
WHERE m.playerID IN (
    SELECT playerID
    FROM Goalies
    WHERE year < (SELECT MAX(year) FROM Coaches WHERE coachID = m.coachID)
    UNION
    SELECT playerID
    FROM Scoring
    WHERE year < (SELECT MAX(year) FROM Coaches WHERE coachID = m.coachID)
);
```
-------------------------7639 sample_num
```sql
SELECT c.firstName, c.lastName, t.name
FROM Coaches c
JOIN Teams t ON c.tmID = t.tmID AND c.year = t.year
WHERE c.coachID NOT IN (SELECT DISTINCT coachID FROM Master)
ORDER BY (c.w * 1.0 / c.g) DESC
LIMIT 1;
```
-------------------------7640 sample_num
```sql
SELECT c.coachID, c.year, (c.w * 1.0 / NULLIF(c.g, 0)) * 100 AS winning_percentage
FROM Coaches c
WHERE c.tmID = 'DET'
ORDER BY winning_percentage DESC
LIMIT 1;
```
-------------------------7641 sample_num
```sql
SELECT 
    m.nameGiven AS given_name, 
    CONCAT(m.birthDay, '-', m.birthMon, '-', m.birthYear) AS date_of_birth, 
    GROUP_CONCAT(DISTINCT c.tmID) AS teams_coached
FROM 
    Coaches c
JOIN 
    Master m ON c.coachID = m.coachID
WHERE 
    c.tmID = (SELECT tmID FROM Teams WHERE name = 'Montreal Canadiens')
GROUP BY 
    c.coachID
ORDER BY 
    COUNT(DISTINCT c.year) DESC
LIMIT 1;
```
-------------------------7642 sample_num
```sql
SELECT m.firstName, m.lastName, g.tmID
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
WHERE g.L > g.W
GROUP BY m.playerID, g.tmID
HAVING COUNT(DISTINCT g.year) >= 2;
```
-------------------------7643 sample_num
```sql
SELECT 
    g.playerID, 
    g.year, 
    (g.W * 100.0 / g.GP) AS winning_percentage
FROM 
    Goalies g
JOIN 
    Master m ON g.playerID = m.playerID
WHERE 
    m.birthYear = 1987 
    AND m.shootCatch IS NULL;
```
-------------------------7644 sample_num
```sql
SELECT 
    m.nameGiven AS given_name,
    DIVIDE(SUM(g.Min), SUM(g.GP)) AS average_time_minutes
FROM 
    Master m
JOIN 
    Goalies g ON m.playerID = g.playerID
WHERE 
    m.playerID = 'aebisda01' AND g.pos = 'G'
GROUP BY 
    m.nameGiven;
```
-------------------------7645 sample_num
```sql
SELECT m.lastName, m.firstName
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
WHERE (SUM(g.W) / SUM(g.GP)) * 100 > 50
AND m.deathYear IS NULL
GROUP BY m.lastName, m.firstName;
```
-------------------------7646 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM AwardsPlayers WHERE note = 'posthumous') AS awarded_players,
    (SELECT COUNT(*) FROM AwardsCoaches WHERE note = 'posthumous') AS awarded_coaches;
```
-------------------------7647 sample_num
```sql
SELECT COUNT(DISTINCT p.playerID) AS goalie_count
FROM AwardsPlayers ap
JOIN Master p ON ap.playerID = p.playerID
WHERE ap.year = 1983 AND p.pos = 'G';
```
-------------------------7648 sample_num
```sql
SELECT COUNT(*) 
FROM Coaches 
WHERE year = 2007 AND notes = 'interim';
```
-------------------------7649 sample_num
```sql
SELECT COUNT(*) AS total_shutouts
FROM CombinedShutouts
WHERE year = 1977 AND `R/P` = 'R';
```
-------------------------7650 sample_num
```sql
SELECT COUNT(*) 
FROM CombinedShutouts 
WHERE year = 2005 AND R/P = 'R' AND IDgoalie1 IS NOT NULL;
```
-------------------------7651 sample_num
```sql
SELECT DISTINCT year 
FROM Goalies 
WHERE lgID = 'NHL' AND SA IS NOT NULL;
```
-------------------------7652 sample_num
```sql
SELECT COUNT(*) AS team_count
FROM TeamsPost
WHERE PostW = PostL;
```
-------------------------7653 sample_num
```sql
SELECT name FROM HOF WHERE year = 1978;
```
-------------------------7654 sample_num
```sql
SELECT COUNT(*) 
FROM HOF 
WHERE category = 'Builder';
```
-------------------------7655 sample_num
```sql
SELECT COUNT(*) 
FROM HOF 
WHERE year > 1980 AND category = 'Player';
```
-------------------------7656 sample_num
```sql
SELECT nameNick 
FROM Master 
JOIN HOF ON Master.hofID = HOF.hofID 
WHERE HOF.year = 2007;
```
-------------------------7657 sample_num
```sql
SELECT HOF.year
FROM Master AS M
JOIN HOF ON M.hofID = HOF.hofID
WHERE M.height = (SELECT MAX(height) FROM Master);
```
-------------------------7658 sample_num
```sql
SELECT DISTINCT ac.award
FROM AwardsCoaches ac
JOIN Coaches c ON ac.coachID = c.coachID
JOIN Master m ON c.coachID = m.coachID
WHERE m.birthCountry = 'Canada';
```
-------------------------7659 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) 
FROM Coaches c
JOIN Teams t ON c.tmID = t.tmID AND c.year = t.year
JOIN Master m ON c.coachID = m.coachID
WHERE t.W > 30 AND m.birthCountry = 'USA';
```
-------------------------7660 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) 
FROM Coaches c 
JOIN Master m ON c.coachID = m.coachID 
WHERE m.birthCountry = 'Canada' AND c.lgID = 'NHL';
```
-------------------------7661 sample_num
```sql
SELECT DISTINCT ac.award
FROM AwardsCoaches ac
JOIN Coaches c ON ac.coachID = c.coachID
JOIN Master m ON c.coachID = m.coachID
WHERE m.birthYear = '1952';
```
-------------------------7662 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) 
FROM Coaches c
JOIN AwardsCoaches ac ON c.coachID = ac.coachID
JOIN Master m ON c.coachID = m.coachID
WHERE ac.year = 1940 AND m.birthCity = 'Toronto';
```
-------------------------7663 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) 
FROM Coaches c
JOIN AwardsCoaches a ON c.coachID = a.coachID
JOIN Master m ON c.coachID = m.coachID
WHERE a.year > 1940 AND m.deathYear IS NOT NULL;
```
-------------------------7664 sample_num
```sql
SELECT DISTINCT ac.award
FROM AwardsCoaches ac
JOIN Coaches c ON ac.coachID = c.coachID
JOIN Master m ON c.coachID = m.coachID
WHERE c.lgID = 'NHL' AND m.deathYear IS NOT NULL;
```
-------------------------7665 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) AS HallOfFameCoachesOver195
FROM Coaches c
JOIN Master m ON c.coachID = m.coachID
JOIN HOF h ON m.hofID = h.hofID
WHERE m.weight > 195;
```
-------------------------7666 sample_num
```sql
SELECT DISTINCT m.firstName
FROM Master m
JOIN Goalies g ON m.playerID = g.playerID
JOIN HOF h ON m.hofID = h.hofID
WHERE g.shootCatch IS NULL;
```
-------------------------7667 sample_num
```sql
SELECT COUNT(DISTINCT m.playerID) AS hof_coaches_count
FROM Master m
JOIN Coaches c ON m.coachID = c.coachID
JOIN HOF h ON m.hofID = h.hofID
WHERE m.playerID IS NOT NULL AND c.coachID IS NOT NULL;
```
-------------------------7668 sample_num
```sql
SELECT DISTINCT M.birthCity
FROM AwardsPlayers AP
JOIN Master M ON AP.playerID = M.playerID
WHERE AP.year = 1970;
```
-------------------------7669 sample_num
```sql
SELECT COUNT(DISTINCT p.playerID) AS num_players
FROM Master p
JOIN AwardsPlayers a ON p.playerID = a.playerID
WHERE p.birthCity = 'Toronto' AND a.award = 'All-Rookie';
```
-------------------------7670 sample_num
```sql
SELECT COUNT(DISTINCT p.playerID) AS deceased_players
FROM AwardsPlayers a
JOIN Master p ON a.playerID = p.playerID
WHERE a.award = 'All-Rookie' AND p.deathYear IS NOT NULL;
```
-------------------------7671 sample_num
```sql
SELECT COUNT(DISTINCT mp.playerID) AS award_winners
FROM Master mp
JOIN AwardsPlayers ap ON mp.playerID = ap.playerID
WHERE mp.deathState = 'Massachussets';
```
-------------------------7672 sample_num
```sql
SELECT DISTINCT ap.award
FROM AwardsPlayers ap
JOIN Master m ON ap.playerID = m.playerID
WHERE m.deathCity = 'Arlington';
```
-------------------------7673 sample_num
```sql
SELECT DISTINCT m.nameNick
FROM Master m
JOIN AwardsPlayers a ON m.playerID = a.playerID
WHERE a.award = 'All-Rookie' AND m.birthMon = '3';
```
-------------------------7674 sample_num
```sql
SELECT COUNT(DISTINCT hofID) 
FROM HOF 
WHERE name IN (
    SELECT CONCAT(firstName, ' ', lastName) 
    FROM Master 
    WHERE birthMon IN ('7', '8')
);
```
-------------------------7675 sample_num
```sql
SELECT birthMon
FROM Master
WHERE playerID = (
    SELECT playerID
    FROM AwardsPlayers
    GROUP BY playerID
    ORDER BY COUNT(award) DESC
    LIMIT 1
);
```
-------------------------7676 sample_num
```sql
SELECT birthYear, COUNT(award) AS total_awards
FROM Master
JOIN AwardsPlayers ON Master.playerID = AwardsPlayers.playerID
GROUP BY birthYear
ORDER BY total_awards DESC
LIMIT 1;
```
-------------------------7677 sample_num
```sql
SELECT birthCountry
FROM Master
WHERE playerID IN (
    SELECT playerID
    FROM AwardsPlayers
    GROUP BY playerID
    ORDER BY COUNT(award) DESC
    LIMIT 1
);
```
-------------------------7678 sample_num
```sql
SELECT birthCountry, COUNT(*) AS player_count
FROM Master
JOIN HOF ON Master.hofID = HOF.hofID
GROUP BY birthCountry
ORDER BY player_count DESC
LIMIT 1;
```
-------------------------7679 sample_num
```sql
SELECT DISTINCT M.pos
FROM Master M
JOIN AwardsPlayers A ON M.playerID = A.playerID
WHERE M.birthCountry = 'Canada' AND A.award = 'All-Rookie';
```
-------------------------7680 sample_num
```sql
SELECT AVG(weight / (height * height)) AS average_BMI
FROM Coaches
JOIN HOF ON Coaches.coachID = HOF.hofID;
```
-------------------------7681 sample_num
```sql
SELECT (COUNT(CASE WHEN M.birthCountry = 'USA' THEN 1 END) * 100.0 / COUNT(H.hofID)) AS percentage_american_players
FROM HOF H
JOIN Master M ON H.hofID = M.hofID;
```
-------------------------7682 sample_num
```sql
SELECT MAX(year) - MIN(year) AS years_played
FROM Master
WHERE playerID = 'healygl01';
```
-------------------------7683 sample_num
```sql
SELECT tmID 
FROM Master 
JOIN Scoring ON Master.playerID = Scoring.playerID 
WHERE Master.playerID = 'roypa01' AND Scoring.year = 1992;
```
-------------------------7684 sample_num
```sql
SELECT SUM(GP) AS total_games
FROM Scoring
WHERE playerID = 'rutlewa01' AND year = 1967;
```
-------------------------7685 sample_num
```sql
SELECT Min 
FROM Goalies 
WHERE playerID = 'valiqst01' AND year = 2007;
```
-------------------------7686 sample_num
```sql
SELECT SUM(W) AS TotalWins
FROM Goalies
WHERE playerID = 'vanbijo01' AND year = 1990
```
-------------------------7687 sample_num
```sql
SELECT SUM(T) + SUM(OTL) AS Total_Ties_Overtime_Losses
FROM Goalies
WHERE playerID = 'vernomi01' AND year = 1998;
```
-------------------------7688 sample_num
```sql
SELECT SUM(c.w) AS total_wins
FROM Coaches c
JOIN AwardsCoaches ac ON c.coachID = ac.coachID
WHERE ac.award = 'Second Team All-Star' AND ac.year = 1933;
```
-------------------------7689 sample_num
```sql
SELECT COUNT(*) > 0 AS attended
FROM HOF
JOIN Master ON HOF.name = Master.firstName || ' ' || Master.lastName
WHERE Master.legendsID = 'P194502' AND HOF.note != 'posthumous';
```
-------------------------7690 sample_num
```sql
SELECT pos 
FROM Master 
WHERE firstName = 'Mike' AND lastName = 'Antonovich';
```
-------------------------7691 sample_num
```sql
SELECT CONCAT(m.birthCountry, '-', m.birthState, '-', m.birthCity) AS birth_place
FROM Coaches c
JOIN Master m ON c.coachID = m.coachID
WHERE c.year = 1998 AND c.notes = 'co-coach' AND c.coachID IN (
    SELECT coachID
    FROM Coaches
    WHERE year = 1998 AND tmID IN (
        SELECT tmID
        FROM Coaches
        WHERE year = 1998 AND coachID = (
            SELECT coachID
            FROM Master
            WHERE firstName = 'Dave' AND lastName = 'Lewis'
        )
    )
);
```
-------------------------7692 sample_num
```sql
SELECT CONCAT(m.firstName, ' ', m.lastName) AS fullName
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
WHERE g.stint = 3
ORDER BY m.weight DESC
LIMIT 1;
```
-------------------------7693 sample_num
```sql
SELECT CONCAT(m.firstName, ' ', m.lastName) AS fullName
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
WHERE g.ENG = 10
ORDER BY m.height DESC
LIMIT 1;
```
-------------------------7694 sample_num
```sql
SELECT shootCatch 
FROM Goalies 
WHERE year = 2010 
AND SHO = (SELECT MAX(SHO) FROM Goalies WHERE year = 2010);
```
-------------------------7695 sample_num
```sql
SELECT playerID, birthYear, birthMon, birthDay
FROM Goalies
JOIN Master ON Goalies.playerID = Master.playerID
WHERE year = 2002 AND GA > 150
ORDER BY birthYear DESC, birthMon DESC, birthDay DESC
LIMIT 1;
```
-------------------------7696 sample_num
```sql
SELECT CONCAT(m.firstName, ' ', m.lastName) AS fullName
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
WHERE g.tmID = 'NJD'
ORDER BY (g.SA - g.GA) DESC
LIMIT 1;
```
-------------------------7697 sample_num
```sql
SELECT name
FROM TeamsPost
WHERE year = 2010
ORDER BY BenchMinor DESC
LIMIT 1;
```
-------------------------7698 sample_num
```sql
SELECT Pts
FROM TeamsPost
WHERE year = 1995 AND tmID = (
    SELECT tmID
    FROM Goalies
    WHERE year = 1995
    GROUP BY tmID
    ORDER BY SUM(PostSHO) DESC
    LIMIT 1
);
```
-------------------------7699 sample_num
```sql
SELECT c.coachID, m.nameNick, (c.w * 1.0 / (c.w + c.l)) AS winning_rate
FROM Coaches c
JOIN Master m ON c.coachID = m.coachID
WHERE c.year = 2009
ORDER BY winning_rate DESC
LIMIT 1;
```
-------------------------7700 sample_num
```sql
SELECT CONCAT(m.firstName, ' ', m.lastName) AS fullName
FROM Teams t
JOIN Coaches c ON t.tmID = c.tmID AND t.year = c.year
JOIN Master m ON c.coachID = m.coachID
WHERE t.year = 2011
AND (t.PPG / NULLIF(t.PPC, 0)) = (
    SELECT MAX(PPG / NULLIF(PPC, 0))
    FROM Teams
    WHERE year = 2011
)
```
-------------------------7701 sample_num
```sql
SELECT SUM(GP) AS TotalGames
FROM Scoring
WHERE playerID = 'broadpu01' AND year = 1922;
```
-------------------------7702 sample_num
```sql
SELECT COUNT(DISTINCT year) AS years_to_finals
FROM SeriesPost
WHERE (tmIDWinner IN (SELECT tmID FROM Teams WHERE year = SeriesPost.year AND lgID = 'NHL') 
       OR tmIDLoser IN (SELECT tmID FROM Teams WHERE year = SeriesPost.year AND lgID = 'NHL'))
AND year IN (SELECT DISTINCT year FROM Teams WHERE tmID IN (SELECT tmID FROM Goalies WHERE playerID = 'cleghsp01'));
```
-------------------------7703 sample_num
```sql
SELECT SUM(G) AS total_goals
FROM Scoring
WHERE playerID = 'dyeba01' AND year = 1921 AND tmID IN (
    SELECT tmID
    FROM SeriesPost
    WHERE year = 1921 AND round = 'Finals'
);
```
-------------------------7704 sample_num
```sql
SELECT playerID, year, tmID, MAX(A) AS max_assists
FROM Scoring
WHERE year IN (SELECT year FROM SeriesPost WHERE round = 'Finals')
GROUP BY playerID, year, tmID
ORDER BY max_assists DESC
LIMIT 1;
```
-------------------------7705 sample_num
```sql
SELECT lgID 
FROM Master 
WHERE playerID = 'adamsja01' 
AND firstNHL <= 1920 
AND (lastNHL >= 1920 OR lastNHL IS NULL);
```
-------------------------7706 sample_num
```sql
SELECT pos 
FROM Scoring 
WHERE playerID = 'hartgi01' 
AND year = (SELECT MAX(year) FROM SeriesPost WHERE round = 'Finals');
```
-------------------------7707 sample_num
```sql
SELECT T.W
FROM Teams T
JOIN Goalies G ON T.tmID = G.tmID AND G.year = 2011
WHERE G.year = 2011 AND G.stint = 'Post' 
GROUP BY T.tmID
HAVING COUNT(DISTINCT G.playerID) = 3;
```
-------------------------7708 sample_num
```sql
SELECT birthYear 
FROM Goalies 
WHERE year = 2008 
ORDER BY PostSA DESC 
LIMIT 1;
```
-------------------------7709 sample_num
```sql
SELECT COUNT(DISTINCT year) AS years_after_retirement
FROM Teams
WHERE year > (SELECT MAX(year) - MAX(lastNHL) FROM Master WHERE firstName = 'Don' AND lastName = 'Waddell');
```
-------------------------7710 sample_num
```sql
SELECT shootCatch 
FROM Goalies 
WHERE year = 1996 
AND SHO = (SELECT MAX(SHO) FROM Goalies WHERE year = 1996);
```
-------------------------7711 sample_num
```sql
SELECT CONCAT(birthYear, '/', birthMon, '/', birthDay) AS birthday
FROM Goalies
JOIN Master ON Goalies.playerID = Master.playerID
WHERE year = '1965'
ORDER BY GA DESC
LIMIT 1;
```
-------------------------7712 sample_num
```sql
SELECT CONCAT(m.firstName, ' ', m.lastName) AS fullName
FROM Scoring s
JOIN Master m ON s.playerID = m.playerID
WHERE s.year = '1981'
ORDER BY s.`+/-` DESC
LIMIT 1;
```
-------------------------7713 sample_num
```sql
SELECT weight 
FROM Master 
WHERE playerID = (
    SELECT playerID 
    FROM Scoring 
    WHERE year > 2000 
    ORDER BY PPG DESC 
    LIMIT 1
);
```
-------------------------7714 sample_num
```sql
SELECT shootCatch 
FROM Master 
WHERE playerID IN (
    SELECT playerID 
    FROM Scoring 
    WHERE year = 1989 AND SHG = 7
);
```
-------------------------7715 sample_num
```sql
SELECT CONCAT(m.firstName, ' ', m.lastName) AS fullName
FROM Scoring s
JOIN Master m ON s.playerID = m.playerID
WHERE s.year = 1986
ORDER BY s.GWG DESC
LIMIT 1;
```
-------------------------7716 sample_num
```sql
SELECT SOG 
FROM Scoring 
WHERE playerID = (SELECT playerID FROM Master WHERE firstName = 'Cam' AND lastName = 'Neely') 
AND year = 1990;
```
-------------------------7717 sample_num
```sql
SELECT CONCAT(m.firstName, ' ', m.lastName) AS CoachName
FROM Teams t
JOIN Coaches c ON t.tmID = c.tmID AND t.year = c.year
JOIN Master m ON c.coachID = m.coachID
WHERE t.year = 2003
ORDER BY t.BenchMinor DESC
LIMIT 1;
```
-------------------------7718 sample_num
```sql
SELECT playerID, GA
FROM Goalies
WHERE weight > 190 AND year = 1978
ORDER BY GA DESC
LIMIT 1;
```
-------------------------7719 sample_num
```sql
SELECT 
    (SELECT 
        (SUM(w) / (SUM(w) + SUM(l))) * 100 
     FROM 
        Coaches 
     WHERE 
        tmID = 'VAN' AND year = '2005/2006') - 
    (SELECT 
        (SUM(w) / (SUM(w) + SUM(l))) * 100 
     FROM 
        Coaches 
     WHERE 
        tmID = 'VAN' AND year = '2006') AS winning_rate_improvement;
```
-------------------------7720 sample_num
```sql
SELECT legendsID 
FROM Goalies 
WHERE year = 2011 
ORDER BY (1 - (PostGA / NULLIF(PostSA, 0))) * 100 DESC 
LIMIT 1;
```
-------------------------7721 sample_num
```sql
SELECT COUNT(DISTINCT m.coachID) AS former_athletes_as_coaches
FROM Master m
JOIN Coaches c ON m.coachID = c.coachID
WHERE m.playerID IS NOT NULL;
```
-------------------------7722 sample_num
```sql
SELECT T.name, SUM(COALESCE(TS.BenchMinor, 0)) AS TotalPenalties
FROM Teams T
JOIN TeamsPost TS ON T.year = TS.year AND T.lgID = TS.lgID AND T.tmID = TS.tmID
WHERE T.T > 0
GROUP BY T.name
ORDER BY T.T DESC
LIMIT 1;
```
-------------------------7723 sample_num
```sql
SELECT award, COUNT(*) AS award_count
FROM AwardsCoaches
WHERE coachID = (
    SELECT coachID
    FROM Coaches
    ORDER BY w DESC
    LIMIT 1
)
GROUP BY award
ORDER BY award_count DESC
LIMIT 1;
```
-------------------------7724 sample_num
```sql
SELECT PPG / (PPG + BenchMinor) * 100 AS PowerPlayPercentage
FROM Teams
WHERE L = (SELECT MAX(L) FROM Teams);
```
-------------------------7725 sample_num
```sql
SELECT AVG(player_count) AS average_players_hof
FROM (
    SELECT COUNT(hofID) AS player_count
    FROM HOF
    WHERE year BETWEEN 1950 AND 1980
    GROUP BY year
) AS yearly_counts;
```
-------------------------7726 sample_num
```sql
SELECT birthCountry, COUNT(playerID) AS player_count, MAX(birthYear) AS most_common_birth_year
FROM Master
GROUP BY birthCountry
ORDER BY player_count DESC
LIMIT 1;
```
-------------------------7727 sample_num
```sql
SELECT T.W
FROM Teams T
JOIN Goalies G ON T.tmID = G.tmID
WHERE G.SHO = (SELECT MAX(SHO) FROM Goalies)
```
-------------------------7728 sample_num
```sql
SELECT tmID
FROM TeamSplits
WHERE year = 2005
ORDER BY rW DESC
LIMIT 1;
```
-------------------------7729 sample_num
```sql
SELECT pos 
FROM Master 
ORDER BY birthYear, birthMon, birthDay 
LIMIT 1 OFFSET 8;
```
-------------------------7730 sample_num
```sql
SELECT SUM(GA) AS TotalGoalsAgainst
FROM Goalies
WHERE year = 1924 AND lgID = 'WCHL' AND playerID = (
    SELECT playerID
    FROM Goalies
    WHERE year = 1924 AND lgID = 'WCHL'
    ORDER BY PostGA DESC
    LIMIT 1
);
```
-------------------------7731 sample_num
```sql
SELECT tmID, OctL
FROM Teams
WHERE year = 2006
ORDER BY OctL DESC
LIMIT 1;
```
-------------------------7732 sample_num
```sql
SELECT COUNT(*) 
FROM Master 
WHERE shootCatch IS NULL AND firstNHL = 2011;
```
-------------------------7733 sample_num
```sql
SELECT year, MAX(G) AS max_goals, (year - birthYear) AS age
FROM Scoring
JOIN Master ON Scoring.playerID = Master.playerID
GROUP BY year
ORDER BY max_goals DESC
LIMIT 1;
```
-------------------------7734 sample_num
```sql
SELECT AVG(height) AS average_height, 
       t.name AS team_name
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
JOIN Teams t ON g.tmID = t.tmID AND g.year = t.year
WHERE m.birthYear BETWEEN 1970 AND 1979 
  AND m.shootCatch = 'L'
  AND g.pos = 'G'
  AND t.year = (SELECT MAX(year) 
                FROM Teams 
                WHERE tmID = g.tmID)
GROUP BY t.name
ORDER BY average_height DESC
LIMIT 1;
```
-------------------------7735 sample_num
```sql
SELECT CONCAT(m.nameGiven, ' ', m.lastName) AS fullName, SUM(s.A) AS totalAssists
FROM Scoring s
JOIN Master m ON s.playerID = m.playerID
WHERE s.lgID = 'NHL'
GROUP BY s.playerID
ORDER BY SUM(s.A) DESC
LIMIT 1;
```
-------------------------7736 sample_num
```sql
SELECT 
    t.name AS team_name,
    t.PPG,
    t.PPC,
    (t.PPG * 1.0 / t.PPC) * 100 AS power_play_percentage,
    s.tmIDLoser AS opponent_team_id,
    CASE 
        WHEN s.tmIDWinner = t.tmID THEN 'Victorious' 
        ELSE 'Lost' 
    END AS result
FROM 
    Teams t
JOIN 
    TeamsPost s ON t.tmID = s.tmID
WHERE 
    t.PKC = (SELECT MIN(PKC) FROM Teams)
```
-------------------------7737 sample_num
```sql
SELECT ac.coachID, ac.award
FROM Coaches c
JOIN AwardsCoaches ac ON c.coachID = ac.coachID
WHERE c.tmID = (
    SELECT tmID
    FROM Teams
    WHERE W = (
        SELECT MAX(W)
        FROM Teams
    )
);
```
-------------------------7738 sample_num
```sql
SELECT Teams.name 
FROM SeriesPost 
JOIN Teams ON SeriesPost.tmIDLoser = Teams.tmID 
WHERE SeriesPost.year = 1912 AND SeriesPost.note = 'EX';
```
-------------------------7739 sample_num
```sql
SELECT 
    CONCAT(m.nameGiven, ' ', m.lastName) AS fullName,
    (YEAR(s.year) - m.firstNHL) AS duration
FROM 
    Scoring s
JOIN 
    Master m ON s.playerID = m.playerID
WHERE 
    s.lgID = 'NHL'
GROUP BY 
    s.playerID
ORDER BY 
    MIN(s.`+/-`) ASC
LIMIT 1;
```
-------------------------7740 sample_num
```sql
SELECT firstName
FROM Master m
JOIN Scoring s ON m.playerID = s.playerID
WHERE s.year BETWEEN 2003 AND 2005 AND s.PIM BETWEEN 200 AND 250
GROUP BY m.playerID, m.firstName
HAVING MAX(s.GP) = (
    SELECT MAX(GP)
    FROM Scoring
    WHERE year BETWEEN 2003 AND 2005 AND PIM BETWEEN 200 AND 250
);
```
-------------------------7741 sample_num
```sql
SELECT lastNHL - birthYear AS age
FROM Goalies
JOIN Master ON Goalies.playerID = Master.playerID
WHERE Goalies.GA = (SELECT MIN(GA) FROM Goalies)
```
-------------------------7742 sample_num
```sql
WITH AwardCounts AS (
    SELECT pos, COUNT(award) AS award_count
    FROM AwardsPlayers
    GROUP BY pos
),
MaxAwardCount AS (
    SELECT pos
    FROM AwardCounts
    WHERE award_count = (SELECT MAX(award_count) FROM AwardCounts)
),
RecentAward AS (
    SELECT ap.playerID, ap.award, ap.year, m.nameGiven, m.lastName
    FROM AwardsPlayers ap
    JOIN Master m ON ap.playerID = m.playerID
    WHERE ap.pos IN (SELECT pos FROM MaxAwardCount)
    ORDER BY ap.year DESC
    LIMIT 1
)
SELECT ra.award, CONCAT(ra.nameGiven, ' ', ra.lastName) AS full_name
FROM RecentAward ra;
```
-------------------------7743 sample_num
```sql
SELECT SUM(c.g) AS total_games
FROM Coaches c
JOIN AwardsCoaches ac ON c.coachID = ac.coachID
WHERE ac.award = 'Second Team All-Star'
AND ac.year = (SELECT MIN(year) FROM AwardsCoaches WHERE award = 'Second Team All-Star')
```
-------------------------7744 sample_num
```sql
WITH MostVictories AS (
    SELECT tmID, name, W
    FROM Teams
    JOIN abbrev ON Teams.lgID = abbrev.Code
    WHERE year = 1915
    ORDER BY W DESC
    LIMIT 1
),
OpposingTeams AS (
    SELECT DISTINCT oppID
    FROM TeamVsTeam
    WHERE year = 1915 AND tmID = (SELECT tmID FROM MostVictories)
)
SELECT (SELECT name FROM MostVictories) AS TeamName, COUNT(*) AS OpponentCount, GROUP_CONCAT(DISTINCT oppID) AS OpposingTeams
FROM OpposingTeams;
```
-------------------------7745 sample_num
```sql
SELECT playerID, MAX(GWG) AS max_GWG
FROM Scoring
WHERE SHG BETWEEN 1 AND 5
GROUP BY playerID
ORDER BY max_GWG DESC
LIMIT 1;
```
-------------------------7746 sample_num
```sql
SELECT coachID, SUM(l) AS total_losses
FROM Coaches
WHERE tmID = (SELECT tmID FROM Teams WHERE name = 'Tampa Bay Lightning' AND year = 1997)
  AND year = 1997
  AND notes = 'interim'
GROUP BY coachID;
```
-------------------------7747 sample_num
```sql
SELECT t.year, t.name, t.rank
FROM Teams t
JOIN Scoring s ON t.playerID = s.playerID
WHERE s.SHA >= 7
GROUP BY t.year, t.name, t.rank
ORDER BY SUM(s.A) DESC
LIMIT 1;
```
-------------------------7748 sample_num
```sql
SELECT c.coachID, m.firstName, m.lastName
FROM Coaches c
JOIN Teams t ON c.tmID = t.tmID AND c.year = t.year
JOIN Master m ON c.coachID = m.coachID
WHERE t.rank = 4 AND t.year = 1969;
```
-------------------------7749 sample_num
```sql
SELECT name 
FROM TeamsHalf 
WHERE year BETWEEN 1917 AND 1920 AND rank = 1;
```
-------------------------7750 sample_num
```sql
SELECT CONCAT(m.nameGiven, ' ', m.lastName) AS complete_name, s.year, t.name AS team
FROM Master m
JOIN Scoring s ON m.playerID = s.playerID
JOIN Teams t ON s.tmID = t.tmID AND s.year = t.year
WHERE m.birthCountry = 'Canada'
  AND (m.firstNHL - m.birthYear) BETWEEN 18 AND 24
  AND s.G < 5
GROUP BY m.playerID, s.year, t.name
```
-------------------------7751 sample_num
```sql
SELECT SUM(BenchMinor) AS TotalBenchMinor
FROM Teams
WHERE name = 'St. Louis Blues';
```
-------------------------7752 sample_num
```sql
SELECT DIVIDE(SUM(PPG), SUM(PPC)) AS PowerPlayChances
FROM Teams
WHERE name = 'New York Rangers' AND year = 2009;
```
-------------------------7753 sample_num
```sql
SELECT MAX(Pts) AS highest_total_points
FROM Teams;
```
-------------------------7754 sample_num
```sql
SELECT COUNT(*) 
FROM Teams 
WHERE year = 2006 AND W > L AND Pts > 100;
```
-------------------------7755 sample_num
```sql
SELECT name, SUM(BenchMinor) AS TotalBenchMinor
FROM Teams
WHERE year = 2006
GROUP BY name
ORDER BY TotalBenchMinor DESC
LIMIT 1;
```
-------------------------7756 sample_num
```sql
SELECT name, PIM 
FROM Teams 
WHERE year = 2006 
ORDER BY PIM DESC 
LIMIT 3;
```
-------------------------7757 sample_num
```sql
SELECT name, MAX(PKC) AS highest_PKC
FROM Teams
WHERE year = 1995 AND name IN ('Florida Panthers', 'Edmonton Oilers', 'Los Angeles Kings')
GROUP BY name
ORDER BY highest_PKC DESC
LIMIT 1;
```
-------------------------7758 sample_num
```sql
SELECT name 
FROM Teams 
WHERE year = 1917 AND W > L AND playoff = 'Stanley Cup';
```
-------------------------7759 sample_num
```sql
SELECT tmIDWinner AS TeamID
FROM SeriesPost
WHERE year = 1922;
```
-------------------------7760 sample_num
```sql
SELECT COUNT(tmID) 
FROM Teams 
WHERE year = 1922 AND Pts > 20 AND tmID IN (
    SELECT tmIDWinner FROM SeriesPost WHERE year = 1922
    UNION
    SELECT tmIDLoser FROM SeriesPost WHERE year = 1922
);
```
-------------------------7761 sample_num
```sql
SELECT PIM 
FROM Teams 
WHERE year = 1923 AND rank = 2;
```
-------------------------7762 sample_num
```sql
SELECT name, MAX(W) AS MostWins
FROM TeamsPost
WHERE year IN (SELECT year FROM SeriesPost WHERE round = 'Finals')
GROUP BY name
ORDER BY MostWins DESC
LIMIT 1;
```
-------------------------7763 sample_num
```sql
SELECT SUM(W) AS TotalWins
FROM TeamVsTeam
WHERE year = 1985 AND lgID = 'NHL' AND tmID = (SELECT tmID FROM Teams WHERE name = 'Philadelphia Flyers' AND year = 1985) AND oppID = (SELECT tmID FROM Teams WHERE name = 'Boston Bruins' AND year = 1985);
```
-------------------------7764 sample_num
```sql
SELECT name 
FROM Teams 
WHERE year = 1909 AND T > 0;
```
-------------------------7765 sample_num
```sql
SELECT DISTINCT m.firstName
FROM Coaches c
JOIN Teams t ON c.tmID = t.tmID AND c.year = t.year
JOIN Master m ON c.coachID = m.coachID
WHERE t.name = 'Montreal Canadiens';
```
-------------------------7766 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) 
FROM Coaches c 
JOIN HOF h ON c.coachID = h.hofID 
JOIN Teams t ON c.tmID = t.tmID 
WHERE t.name = 'Montreal Canadiens' AND h.hofID IS NOT NULL;
```
-------------------------7767 sample_num
```sql
SELECT MAX(Master.height) AS tallest_coach_height
FROM Coaches
JOIN Master ON Coaches.coachID = Master.coachID
JOIN Teams ON Coaches.tmID = Teams.tmID
WHERE Teams.name = 'Montreal Canadiens';
```
-------------------------7768 sample_num
```sql
SELECT DISTINCT c.firstName
FROM Coaches c
JOIN Teams t ON c.tmID = t.tmID
WHERE t.year = 1922 AND t.playoff = 'Y';
```
-------------------------7769 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) AS MarchCoaches
FROM Coaches c
JOIN Teams t ON c.tmID = t.tmID
JOIN Master m ON c.coachID = m.coachID
WHERE t.name = 'Philadelphia Flyers' AND m.birthMon = 3;
```
-------------------------7770 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) 
FROM Coaches c
JOIN Master m ON c.coachID = m.coachID
JOIN Teams t ON c.tmID = t.tmID
WHERE m.birthCountry = 'USA' AND t.name = 'Philadelphia Flyers';
```
-------------------------7771 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) 
FROM Coaches c 
JOIN Teams t ON c.tmID = t.tmID 
JOIN Master m ON c.coachID = m.coachID 
WHERE t.name = 'Buffalo Sabres' AND m.deathYear IS NOT NULL;
```
-------------------------7772 sample_num
```sql
SELECT DISTINCT m.nameNick
FROM Coaches c
JOIN Master m ON c.coachID = m.coachID
JOIN Teams t ON c.tmID = t.tmID
WHERE m.birthCountry = 'USA' AND t.name = 'Buffalo Sabres' AND c.coachID IS NOT NULL;
```
-------------------------7773 sample_num
```sql
SELECT COUNT(DISTINCT c.coachID) 
FROM Coaches c
JOIN Teams t ON c.tmID = t.tmID AND c.year = t.year
JOIN SeriesPost s ON t.year = s.year AND (s.tmIDWinner = t.tmID OR s.tmIDLoser = t.tmID)
JOIN Master m ON c.coachID = m.coachID
WHERE s.year = 1922 AND m.birthCountry = 'USA';
```
-------------------------7774 sample_num
```sql
SELECT tmID, COUNT(*) AS games_played
FROM TeamVsTeam
WHERE year = 2000 AND oppID = (SELECT tmID FROM Teams WHERE name = 'Buffalo Sabres')
GROUP BY tmID
ORDER BY games_played DESC
LIMIT 1;
```
-------------------------7775 sample_num
```sql
SELECT DISTINCT t.name
FROM Teams t
JOIN TeamVsTeam tvt ON t.tmID = tvt.oppID
WHERE tvt.year IN (SELECT DISTINCT year FROM Teams WHERE name = 'Buffalo Sabres');
```
-------------------------7776 sample_num
```sql
SELECT SUM(PIM) AS TotalPenaltyMinutes
FROM TeamsPost
WHERE year = 1918 AND name = 'Montreal Canadiens';
```
-------------------------7777 sample_num
```sql
SELECT SUM(W) AS total_wins
FROM Teams
WHERE tmID = (SELECT tmID FROM Teams WHERE name = 'Montreal Canadiens' AND year = (SELECT year FROM TeamsPost WHERE tmID = (SELECT tmID FROM Teams WHERE name = 'Montreal Canadiens') AND PIM = 24))
```
-------------------------7778 sample_num
```sql
SELECT year 
FROM TeamsPost 
WHERE tmID = (SELECT tmID FROM Teams WHERE name = 'Montreal Canadiens') 
AND PIM = 49 
AND year IN (1924, 1923, 1918);
```
-------------------------7779 sample_num
```sql
SELECT firstName 
FROM Coaches 
WHERE tmID = (SELECT tmID FROM Teams WHERE name = 'Montreal Canadiens') 
ORDER BY year ASC 
LIMIT 1;
```
-------------------------7780 sample_num
```sql
SELECT AVG(CAST(W AS FLOAT) / G) AS average_winning_rate
FROM Teams
WHERE name = 'Buffalo Sabres' AND year = 2000;
```
-------------------------7781 sample_num
```sql
SELECT AVG(PIM) AS Average_Penalty_Minutes
FROM TeamsPost
WHERE tmID = (SELECT tmID FROM Teams WHERE name = 'Montreal Canadiens')
AND year IN (SELECT year FROM SeriesPost WHERE round = 'Finals');
```
-------------------------7782 sample_num
```sql
SELECT AVG(W / G) AS average_winning_rate
FROM SeriesPost
WHERE (tmIDWinner = (SELECT tmID FROM Teams WHERE name = 'Montreal Canadiens') OR 
       tmIDLoser = (SELECT tmID FROM Teams WHERE name = 'Montreal Canadiens'))
AND year IN (SELECT DISTINCT year FROM Teams WHERE name = 'Montreal Canadiens');
```
-------------------------7783 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN M.birthCountry = 'USA' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Coaches C
JOIN 
    Master M ON C.coachID = M.coachID
JOIN 
    Teams T ON C.tmID = T.tmID
WHERE 
    T.name = 'Montreal Canadiens';
```
-------------------------7784 sample_num
```sql
SELECT name 
FROM HOF 
WHERE category NOT IN ('player', 'builder') 
ORDER BY year DESC 
LIMIT 1;
```
-------------------------7785 sample_num
```sql
SELECT hofID 
FROM HOF 
WHERE category = 'referee' AND year BETWEEN 1970 AND 1979;
```
-------------------------7786 sample_num
```sql
SELECT COUNT(*) AS total_hall_of_famers
FROM HOF
WHERE year = 1958 AND category = 'player';
```
-------------------------7787 sample_num
```sql
SELECT COUNT(DISTINCT h.hofID) AS HallOfFamersCount
FROM HOF h
JOIN Master m ON h.name = m.name
JOIN Coaches c ON m.coachID = c.coachID
WHERE m.playerID IS NOT NULL AND c.coachID IS NOT NULL;
```
-------------------------7788 sample_num
```sql
SELECT COUNT(*) 
FROM Master 
WHERE lastName = 'Green' 
AND playerID IS NOT NULL 
AND coachID IS NULL;
```
-------------------------7789 sample_num
```sql
SELECT BenchMinor 
FROM Teams 
WHERE tmID = (SELECT tmID 
               FROM Coaches 
               WHERE coachID = (SELECT coachID 
                                FROM Master 
                                WHERE firstName = 'Scotty' AND lastName = 'Bowman') 
               AND year = 1982);
```
-------------------------7790 sample_num
```sql
SELECT CONCAT(firstName, ' ', lastName) AS fullName
FROM Master
WHERE playerID IN (
    SELECT playerID
    FROM Goalies
    WHERE ENG = 10
)
ORDER BY height DESC
LIMIT 1;
```
-------------------------7791 sample_num
```sql
SELECT CONCAT(m.firstName, ' ', m.lastName) AS fullName, g.shootCatch
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
WHERE g.year = 1973 AND g.tmID = 'QUN' AND g.GP = 32;
```
-------------------------7792 sample_num
```sql
SELECT COUNT(DISTINCT g.tmID) AS team_count
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
WHERE m.lastName = 'Young';
```
-------------------------7793 sample_num
```sql
SELECT g.playerID, g.year, g.tmID
FROM Goalies g
JOIN Coaches c ON g.playerID = c.coachID
LEFT JOIN HOF h ON c.coachID = h.hofID
WHERE g.tmID = 'BOS' AND g.year = 1972 AND c.coachID IS NOT NULL AND h.hofID IS NULL;
```
-------------------------7794 sample_num
```sql
SELECT SUM(GP) AS TotalGames
FROM Goalies
WHERE playerID IN (
    SELECT playerID
    FROM Master
    WHERE legendsID = 'P196402'
);
```
-------------------------7795 sample_num
```sql
SELECT CONCAT(m.firstName, ' ', m.lastName) AS fullName
FROM Goalies g
JOIN Master m ON g.playerID = m.playerID
JOIN Teams t ON g.tmID = t.tmID
WHERE t.name = 'Quebec Bulldogs'
GROUP BY g.playerID
ORDER BY MAX(g.Min) DESC
LIMIT 1;
```
-------------------------7796 sample_num
```sql
SELECT COUNT(DISTINCT playerID) 
FROM Goalies 
WHERE tmID = (SELECT tmID FROM Teams WHERE name = 'Calgary Flames');
```
-------------------------7797 sample_num
```sql
SELECT playerID, MAX(GA) AS MaxGoalsAgainst
FROM Goalies
WHERE tmID = (SELECT tmID FROM Teams WHERE name = 'Minnesota North Stars')
GROUP BY playerID
ORDER BY MaxGoalsAgainst DESC
LIMIT 1;
```
-------------------------7798 sample_num
```sql
SELECT COUNT(DISTINCT m.playerID) AS HallOfFameGoalies
FROM Master m
JOIN HOF h ON m.hofID = h.hofID
JOIN Goalies g ON m.playerID = g.playerID
JOIN Teams t ON g.tmID = t.tmID
WHERE t.name = 'Haileybury Hockey Club' AND m.playerID IS NOT NULL;
```
-------------------------7799 sample_num
```sql
SELECT shootCatch 
FROM Goalies 
WHERE year = 2010 
AND SHO = (SELECT MAX(SHO) FROM Goalies WHERE year = 2010);
```
-------------------------7800 sample_num
```sql
SELECT 
    (SUM(GP) FILTER (WHERE year = 2005) - SUM(GP) FILTER (WHERE year = 2006)) / SUM(GP) FILTER (WHERE year = 2005) AS decrease_rate
FROM 
    Goalies
WHERE 
    playerID = (SELECT playerID FROM Master WHERE lastName = 'Aebischer' AND firstName = 'David');
```
-------------------------7801 sample_num
```sql
SELECT DISTINCT m.playerID, c.coachID
FROM Master m
JOIN Coaches c ON m.coachID = c.coachID
WHERE m.playerID IS NOT NULL AND c.coachID IS NOT NULL;
```
-------------------------7802 sample_num
```sql
SELECT playerID 
FROM Master 
WHERE height = 75;
```
-------------------------7803 sample_num
```sql
SELECT playerID 
FROM Master 
ORDER BY weight DESC 
LIMIT 5;
```
-------------------------7804 sample_num
```sql
SELECT firstName, lastName FROM Master WHERE birthCountry = 'Finland';
```
-------------------------7805 sample_num
```sql
SELECT playerID FROM Master WHERE deathYear IS NOT NULL;
```
-------------------------7806 sample_num
```sql
SELECT DISTINCT firstName 
FROM Coaches 
WHERE year > 2000;
```
-------------------------7807 sample_num
```sql
SELECT DISTINCT m.height, m.weight
FROM AwardsCoaches ac
JOIN Coaches c ON ac.coachID = c.coachID
JOIN Master m ON c.coachID = m.coachID
WHERE ac.year = 1930;
```
-------------------------7808 sample_num
```sql
SELECT 
    SUM(S.G) AS total_goals, 
    YEAR(CURDATE()) - M.birthYear AS age 
FROM 
    Scoring S 
JOIN 
    Master M ON S.playerID = M.playerID 
WHERE 
    M.playerID = 'aaltoan01';
```
-------------------------7809 sample_num
```sql
SELECT DISTINCT c.coachID
FROM Coaches c
JOIN AwardsCoaches a ON c.coachID = a.coachID
WHERE c.playerID IS NULL;
```
-------------------------7810 sample_num
```sql
SELECT playerID 
FROM Master 
WHERE pos = 'L' AND weight > 200;
```
-------------------------7811 sample_num
```sql
SELECT SUM(GP) AS total_games_played
FROM Master
JOIN Scoring ON Master.playerID = Scoring.playerID
WHERE Master.birthCountry = 'USA';
```
-------------------------7812 sample_num
```sql
SELECT SUM(Scoring.Pts) AS TotalPoints, Coaches.*
FROM Scoring
JOIN Coaches ON Scoring.tmID = Coaches.tmID
WHERE Scoring.tmID = 'ANA'
GROUP BY Coaches.coachID;
```
-------------------------7813 sample_num
```sql
SELECT SUM(G) AS total_goals
FROM Teams
WHERE year = 1976 AND tmID = 'BIR' AND divID = 'EW';
```
-------------------------7814 sample_num
```sql
SELECT 
    SUM(T.L) AS total_losses,
    SUM(S.A) AS total_assists
FROM 
    Teams T
JOIN 
    Scoring S ON T.tmID = S.tmID AND T.year = S.year
WHERE 
    T.year = 2010 AND T.tmID = 'BOS';
```
-------------------------7815 sample_num
```sql
SELECT SUM(Master.weight) AS total_weight
FROM Master
JOIN Teams ON Master.playerID = Teams.tmID
WHERE Teams.tmID = 'ANA' AND Teams.year = 1997;
```
-------------------------7816 sample_num
```sql
SELECT playerID, tmID 
FROM Master 
WHERE height = (SELECT MIN(height) FROM Master WHERE birthYear BETWEEN 1925 AND 1936);
```
-------------------------7817 sample_num
```sql
SELECT t.tmID, m.birthCountry
FROM Teams t
JOIN Goalies g ON t.tmID = g.tmID AND g.year = 2000
JOIN Master m ON g.playerID = m.playerID
WHERE t.year = 2000
GROUP BY t.tmID, m.birthCountry
HAVING MAX(DIVIDE(COUNT(g.W), COUNT(g.W) + COUNT(g.L))) = (
    SELECT MAX(DIVIDE(COUNT(W), COUNT(W) + COUNT(L)))
    FROM Teams
    WHERE year = 2000
    GROUP BY tmID
);
```
-------------------------7818 sample_num
```sql
SELECT 
    t.tmID, 
    DIVIDE(t.W, t.G) AS wins_per_game, 
    s.playerID, 
    MAX(s.G) AS most_goals
FROM 
    Teams t
JOIN 
    Scoring s ON t.tmID = s.tmID AND s.year = t.year
WHERE 
    t.year = 1998 AND t.tmID = 'CAR'
GROUP BY 
    t.tmID, s.playerID
ORDER BY 
    most_goals DESC
LIMIT 1;
```
-------------------------7819 sample_num
```sql
SELECT Name FROM Country WHERE LifeExpectancy = (SELECT MIN(LifeExpectancy) FROM Country);
```
-------------------------7820 sample_num
```sql
SELECT DISTINCT c.Name 
FROM Country c 
JOIN CountryLanguage cl ON c.Code = cl.CountryCode 
WHERE cl.Language = 'English' AND cl.IsOfficial = 'T' 
LIMIT 5;
```
-------------------------7821 sample_num
```sql
SELECT AVG(Population) AS AveragePopulation
FROM City
WHERE District = 'Karnataka';
```
-------------------------7822 sample_num
```sql
SELECT Language 
FROM CountryLanguage 
WHERE CountryCode = 'USA';
```
-------------------------7823 sample_num
```sql
SELECT COUNT(DISTINCT CountryCode) AS NumberOfCountries
FROM CountryLanguage
WHERE Language = 'Portuguese';
```
-------------------------7824 sample_num
```sql
SELECT COUNT(*) FROM City WHERE District = 'England';
```
-------------------------7825 sample_num
```sql
SELECT COUNT(*) 
FROM City 
WHERE CountryCode = (SELECT Code FROM Country ORDER BY SurfaceArea DESC LIMIT 1);
```
-------------------------7826 sample_num
```sql
SELECT City.Name AS CapitalCity, City.Population
FROM City
JOIN Country ON City.CountryCode = Country.Code
WHERE Country.Name = 'San Marino';
```
-------------------------7827 sample_num
```sql
SELECT Language 
FROM CountryLanguage 
WHERE CountryCode = (SELECT Code FROM Country WHERE Name = 'Turkmenistan');
```
-------------------------7828 sample_num
```sql
SELECT c.Name, c.Capital, cl.Language
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE cl.IsOfficial = 'T' AND c.LifeExpectancy = (SELECT MAX(LifeExpectancy) FROM Country);
```
-------------------------7829 sample_num
```sql
SELECT c.Name AS Country, cl.Language AS OfficialLanguage
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE c.Continent = 'Antarctica' AND cl.IsOfficial = 'T';
```
-------------------------7830 sample_num
```sql
SELECT DISTINCT c.Name 
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE cl.Language = 'English' AND cl.IsOfficial = 'T'
LIMIT 5;
```
-------------------------7831 sample_num
```sql
SELECT cl.Language
FROM CountryLanguage cl
JOIN Country c ON cl.CountryCode = c.Code
WHERE c.Region = 'Baltic Countries' AND cl.Percentage > 80;
```
-------------------------7832 sample_num
```sql
SELECT cl.Language
FROM CountryLanguage cl
JOIN Country c ON cl.CountryCode = c.Code
WHERE c.Region = 'Baltic Countries' AND cl.Percentage > 80;
```
-------------------------7833 sample_num
```sql
SELECT c.Name AS CityName, co.Name AS CountryName, co.LifeExpectancy
FROM City c
JOIN Country co ON c.CountryCode = co.Code
WHERE c.Population = (SELECT MAX(Population) FROM City);
```
-------------------------7834 sample_num
```sql
SELECT c.Name AS CapitalCity, cl.Language
FROM Country c
JOIN City ci ON c.Code = ci.CountryCode
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE c.LifeExpectancy = (SELECT MIN(LifeExpectancy) FROM Country)
AND ci.Name = c.Capital;
```
-------------------------7835 sample_num
```sql
SELECT c.Name AS Country, c.Population, c.Capital, cl.Language AS OfficialLanguage
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE cl.IsOfficial = 'T' AND c.SurfaceArea = (SELECT MIN(SurfaceArea) FROM Country);
```
-------------------------7836 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN cl.Language = 'English' THEN 1 END) * 100.0) / COUNT(*) AS Percentage
FROM 
    Country c
JOIN 
    CountryLanguage cl ON c.Code = cl.CountryCode
WHERE 
    c.Continent = 'North America';
```
-------------------------7837 sample_num
```sql
SELECT District 
FROM City 
WHERE Population = (SELECT MIN(Population) FROM City);
```
-------------------------7838 sample_num
```sql
SELECT Continent 
FROM Country 
WHERE SurfaceArea = (SELECT MIN(SurfaceArea) FROM Country);
```
-------------------------7839 sample_num
```sql
SELECT c.HeadOfState
FROM City ci
JOIN Country c ON ci.CountryCode = c.Code
WHERE ci.Population = (SELECT MAX(Population) FROM City);
```
-------------------------7840 sample_num
```sql
SELECT Name 
FROM Country 
WHERE Code IN (
    SELECT CountryCode 
    FROM CountryLanguage 
    WHERE Language = 'English' AND IsOfficial = 'T'
) 
ORDER BY Capital DESC 
LIMIT 1;
```
-------------------------7841 sample_num
```sql
SELECT City.Name 
FROM City 
JOIN Country ON City.CountryCode = Country.Code 
WHERE Country.LifeExpectancy = 66.4;
```
-------------------------7842 sample_num
```sql
SELECT HeadOfState 
FROM Country 
WHERE Code = (
    SELECT CountryCode 
    FROM CountryLanguage 
    WHERE Language = 'English' 
    ORDER BY Percentage ASC 
    LIMIT 1
);
```
-------------------------7843 sample_num
```sql
SELECT c.SurfaceArea 
FROM Country c 
JOIN City ci ON c.Code = ci.CountryCode 
WHERE ci.Name = 'Sutton Coldfield';
```
-------------------------7844 sample_num
```sql
SELECT cl.Language
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE c.Population < 8000;
```
-------------------------7845 sample_num
```sql
SELECT cl.Language 
FROM CountryLanguage cl 
JOIN Country c ON cl.CountryCode = c.Code 
WHERE c.Name = 'Belgium' AND cl.IsOfficial = 'T';
```
-------------------------7846 sample_num
```sql
SELECT City.Name, City.District 
FROM City 
JOIN Country ON City.CountryCode = Country.Code 
WHERE Country.LocalName = 'Hajastan';
```
-------------------------7847 sample_num
```sql
SELECT COUNT(*) 
FROM CountryLanguage 
WHERE CountryCode = (SELECT Code FROM Country WHERE Name = 'Cyprus');
```
-------------------------7848 sample_num
```sql
SELECT Language 
FROM CountryLanguage 
WHERE CountryCode = (SELECT Code FROM Country WHERE Name = 'Belize');
```
-------------------------7849 sample_num
```sql
SELECT DISTINCT C.District
FROM City C
JOIN Country Co ON C.CountryCode = Co.Code
WHERE Co.HeadOfState = 'Adolf Ogi';
```
-------------------------7850 sample_num
```sql
SELECT c.HeadOfState
FROM City ci
JOIN Country c ON ci.CountryCode = c.Code
WHERE ci.District = 'Santa Catarina';
```
-------------------------7851 sample_num
```sql
SELECT 
    (SUM(CASE WHEN cl.Language = 'English' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS EnglishPercentage
FROM 
    Country c
JOIN 
    CountryLanguage cl ON c.Code = cl.CountryCode
WHERE 
    c.GNP > 1500;
```
-------------------------7852 sample_num
```sql
SELECT 
    ABS(
        (SELECT COUNT(DISTINCT c.Code) 
         FROM Country c 
         JOIN CountryLanguage cl ON c.Code = cl.CountryCode 
         WHERE cl.Language = 'English' AND c.GovernmentForm = 'Republic') - 
        (SELECT COUNT(DISTINCT c.Code) 
         FROM Country c 
         JOIN CountryLanguage cl ON c.Code = cl.CountryCode 
         WHERE cl.Language = 'English' AND c.GovernmentForm = 'Constitutional Monarchy')
    ) AS Difference;
```
-------------------------7853 sample_num
```sql
SELECT Name FROM Country WHERE IndepYear = 1994;
```
-------------------------7854 sample_num
```sql
SELECT Name FROM Country WHERE Continent = 'Asia';
```
-------------------------7855 sample_num
```sql
SELECT Name 
FROM Country 
WHERE Continent = 'Asia' 
ORDER BY GNP DESC 
LIMIT 1;
```
-------------------------7856 sample_num
```sql
SELECT COUNT(*) FROM City WHERE CountryCode = 'PHL';
```
-------------------------7857 sample_num
```sql
SELECT LocalName FROM Country WHERE Name = 'Ukraine';
```
-------------------------7858 sample_num
```sql
SELECT COUNT(*) 
FROM Country 
WHERE GovernmentForm = 'Socialistic Republic';
```
-------------------------7859 sample_num
```sql
SELECT Language 
FROM CountryLanguage 
WHERE CountryCode = (SELECT Code FROM Country WHERE Name = 'China') 
AND IsOfficial = 'T';
```
-------------------------7860 sample_num
```sql
SELECT cl.Percentage
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE c.Name = 'China' AND cl.Language = 'Chinese';
```
-------------------------7861 sample_num
```sql
SELECT c.GovernmentForm 
FROM Country c 
JOIN City ci ON c.Code = ci.CountryCode 
WHERE ci.Name = 'Manila';
```
-------------------------7862 sample_num
```sql
SELECT Name FROM City WHERE ID = (SELECT Capital FROM Country WHERE Name = 'Philippines');
```
-------------------------7863 sample_num
```sql
SELECT DISTINCT cl.Language
FROM CountryLanguage cl
JOIN Country c ON cl.CountryCode = c.Code
WHERE c.Continent = 'Europe';
```
-------------------------7864 sample_num
```sql
SELECT c.HeadOfState
FROM Country c
JOIN City ci ON c.Code = ci.CountryCode
WHERE ci.Name = 'Pyongyang';
```
-------------------------7865 sample_num
```sql
SELECT COUNT(*) 
FROM CountryLanguage 
WHERE CountryCode = (SELECT Code FROM Country WHERE Name = 'Italy') 
AND IsOfficial = 'F';
```
-------------------------7866 sample_num
```sql
SELECT Name FROM City WHERE CountryCode = 'RUS' ORDER BY Population ASC LIMIT 1;
```
-------------------------7867 sample_num
```sql
SELECT City.Name
FROM City
JOIN Country ON City.CountryCode = Country.Code
WHERE Country.LifeExpectancy = (SELECT MAX(LifeExpectancy) FROM Country);
```
-------------------------7868 sample_num
```sql
SELECT Language, IsOfficial 
FROM CountryLanguage 
WHERE CountryCode = (SELECT Code FROM Country WHERE IndepYear = 1830);
```
-------------------------7869 sample_num
```sql
SELECT Capital 
FROM Country 
WHERE Population = (SELECT MAX(Population) FROM Country);
```
-------------------------7870 sample_num
```sql
SELECT DISTINCT c.Name
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE c.Continent = 'Asia' AND cl.Language = 'English' AND cl.IsOfficial = 'F';
```
-------------------------7871 sample_num
```sql
SELECT AVG(C.GNP) AS AverageGNP
FROM Country C
JOIN CountryLanguage CL ON C.Code = CL.CountryCode
WHERE CL.Language = 'Arabic';
```
-------------------------7872 sample_num
```sql
SELECT 
    (SUM(CASE WHEN cl.Language = 'Chinese' THEN c.SurfaceArea ELSE 0 END) / SUM(c.SurfaceArea)) * 100 AS PercentageOfSurfaceAreaUsingChinese
FROM 
    Country c
JOIN 
    CountryLanguage cl ON c.Code = cl.CountryCode
WHERE 
    cl.Language = 'Chinese';
```
-------------------------7873 sample_num
```sql
SELECT Name FROM Country WHERE SurfaceArea = (SELECT MIN(SurfaceArea) FROM Country);
```
-------------------------7874 sample_num
```sql
SELECT Name FROM Country WHERE Population = (SELECT MAX(Population) FROM Country);
```
-------------------------7875 sample_num
```sql
SELECT cl.Language 
FROM Country c 
JOIN CountryLanguage cl ON c.Code = cl.CountryCode 
WHERE c.Population = (SELECT MIN(Population) FROM Country);
```
-------------------------7876 sample_num
```sql
SELECT c.Name
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE cl.Language = 'English' AND cl.IsOfficial = 'T';
```
-------------------------7877 sample_num
```sql
SELECT cl.Language
FROM CountryLanguage cl
JOIN Country c ON cl.CountryCode = c.Code
WHERE cl.IsOfficial = 'T' AND c.IndepYear > 1990;
```
-------------------------7878 sample_num
```sql
SELECT Percentage 
FROM CountryLanguage 
WHERE CountryCode = (SELECT Code FROM Country WHERE Name = 'Australia') 
AND Language = 'English';
```
-------------------------7879 sample_num
```sql
SELECT Language 
FROM CountryLanguage 
WHERE CountryCode = (SELECT Code FROM Country WHERE Name = 'Malaysia');
```
-------------------------7880 sample_num
```sql
SELECT c.Name 
FROM City ci 
JOIN Country c ON ci.CountryCode = c.Code 
WHERE ci.Population = (SELECT MAX(Population) FROM City);
```
-------------------------7881 sample_num
```sql
SELECT c.LifeExpectancy
FROM Country c
JOIN City ci ON c.Code = ci.CountryCode
WHERE ci.Population = (SELECT MAX(Population) FROM City);
```
-------------------------7882 sample_num
```sql
SELECT c.GNP
FROM Country c
JOIN City ci ON c.Code = ci.CountryCode
WHERE ci.Population = (SELECT MIN(Population) FROM City);
```
-------------------------7883 sample_num
```sql
SELECT cl.CountryCode, COUNT(cl.Language) AS LanguageCount
FROM City c
JOIN Country co ON c.CountryCode = co.Code
JOIN CountryLanguage cl ON co.Code = cl.CountryCode
WHERE c.ID IN (
    SELECT ID
    FROM City
    ORDER BY Population DESC
    LIMIT 5
)
GROUP BY cl.CountryCode
ORDER BY LanguageCount DESC
LIMIT 1;
```
-------------------------7884 sample_num
```sql
SELECT c.Name
FROM Country c
JOIN City ci ON c.Code = ci.CountryCode
WHERE c.SurfaceArea = (SELECT MIN(SurfaceArea) FROM Country)
AND ci.Population = (SELECT MAX(Population) FROM City WHERE CountryCode = c.Code);
```
-------------------------7885 sample_num
```sql
SELECT Name FROM City WHERE CountryCode = (SELECT Code FROM Country WHERE Name = 'China');
```
-------------------------7886 sample_num
```sql
SELECT City.Name 
FROM City 
JOIN Country ON City.CountryCode = Country.Code 
WHERE Country.LocalName = 'Â´Uman';
```
-------------------------7887 sample_num
```sql
SELECT AVG(c.LifeExpectancy) AS AverageLifeExpectancy
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE cl.Language = 'Arabic';
```
-------------------------7888 sample_num
```sql
SELECT (c.GNP - c.GNPOld) / c.GNPOld AS GNP_Growth_Rate
FROM Country c
JOIN City ci ON c.Code = ci.CountryCode
WHERE ci.Name = 'Shanghai';
```
-------------------------7889 sample_num
```sql
SELECT District FROM City WHERE Name = 'Zaanstad';
```
-------------------------7890 sample_num
```sql
SELECT Name FROM City ORDER BY Population DESC LIMIT 1;
```
-------------------------7891 sample_num
```sql
SELECT District FROM City WHERE Population = 201843;
```
-------------------------7892 sample_num
```sql
SELECT Name FROM Country WHERE SurfaceArea = (SELECT MAX(SurfaceArea) FROM Country);
```
-------------------------7893 sample_num
```sql
SELECT COUNT(*) 
FROM Country 
WHERE LifeExpectancy = 75.1;
```
-------------------------7894 sample_num
```sql
SELECT IndepYear FROM Country WHERE Name = 'Brunei';
```
-------------------------7895 sample_num
```sql
SELECT COUNT(*) 
FROM Country 
WHERE GNP = 0;
```
-------------------------7896 sample_num
```sql
SELECT AVG(SurfaceArea) AS AverageSurfaceArea FROM Country;
```
-------------------------7897 sample_num
```sql
SELECT COUNT(DISTINCT cl.Language) AS LanguageCount
FROM City c
JOIN Country co ON c.CountryCode = co.Code
JOIN CountryLanguage cl ON co.Code = cl.CountryCode
WHERE c.District = 'Tocantins';
```
-------------------------7898 sample_num
```sql
SELECT DISTINCT C.District
FROM City C
JOIN Country Co ON C.CountryCode = Co.Code
WHERE Co.SurfaceArea = (SELECT MAX(SurfaceArea) FROM Country);
```
-------------------------7899 sample_num
```sql
SELECT COUNT(*) 
FROM City 
WHERE CountryCode = (SELECT Code FROM Country WHERE HeadOfState = 'Kostis Stefanopoulos');
```
-------------------------7900 sample_num
```sql
SELECT cl.Language 
FROM CountryLanguage cl 
JOIN Country c ON cl.CountryCode = c.Code 
WHERE c.Name = 'Greece' AND cl.IsOfficial = 'T';
```
-------------------------7901 sample_num
```sql
SELECT c.Population 
FROM Country c 
JOIN City ci ON c.Code = ci.CountryCode 
WHERE ci.Name = 'Queimados';
```
-------------------------7902 sample_num
```sql
SELECT cl.Language 
FROM CountryLanguage cl 
JOIN Country c ON cl.CountryCode = c.Code 
JOIN City ci ON c.Code = ci.CountryCode 
WHERE cl.IsOfficial = 'T' 
AND c.Code = (SELECT ci2.CountryCode 
              FROM City ci2 
              ORDER BY ci2.Population ASC 
              LIMIT 1);
```
-------------------------7903 sample_num
```sql
SELECT c.SurfaceArea, c.GNP
FROM Country c
JOIN City ci ON c.Code = ci.CountryCode
WHERE ci.District = 'Namibe';
```
-------------------------7904 sample_num
```sql
SELECT c.Name 
FROM Country c 
JOIN CountryLanguage cl ON c.Code = cl.CountryCode 
WHERE cl.Language = 'English' AND cl.IsOfficial = 'T';
```
-------------------------7905 sample_num
```sql
SELECT DISTINCT C.District
FROM City C
JOIN Country Co ON C.CountryCode = Co.Code
WHERE Co.SurfaceArea = (SELECT MIN(SurfaceArea) FROM Country);
```
-------------------------7906 sample_num
```sql
SELECT c.Name
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE c.GNP < 1000 AND cl.Language = 'Dutch';
```
-------------------------7907 sample_num
```sql
SELECT c.GNP 
FROM Country c 
JOIN City ci ON c.Code = ci.CountryCode 
WHERE ci.District = 'Entre Rios';
```
-------------------------7908 sample_num
```sql
SELECT c.LocalName 
FROM City ci 
JOIN Country c ON ci.CountryCode = c.Code 
WHERE ci.Name = 'The Valley';
```
-------------------------7909 sample_num
```sql
SELECT City.Name 
FROM City 
JOIN Country ON City.CountryCode = Country.Code 
WHERE Country.SurfaceArea > 7000000;
```
-------------------------7910 sample_num
```sql
SELECT c.LifeExpectancy
FROM Country c
JOIN CountryLanguage cl ON c.Code = cl.CountryCode
WHERE cl.Language = 'Japanese';
```
-------------------------7911 sample_num
```sql
SELECT COUNT(*) 
FROM City 
WHERE CountryCode = (SELECT Code FROM Country WHERE SurfaceArea = 652090);
```
-------------------------7912 sample_num
```sql
SELECT cl.Language 
FROM CountryLanguage cl 
JOIN Country c ON cl.CountryCode = c.Code 
WHERE c.IndepYear BETWEEN 1980 AND 1995;
```
-------------------------7913 sample_num
```sql
SELECT c.LifeExpectancy 
FROM City ci 
JOIN Country c ON ci.CountryCode = c.Code 
WHERE ci.Name = 'Calama';
```
-------------------------7914 sample_num
```sql
SELECT cl.Language 
FROM Country c 
JOIN CountryLanguage cl ON c.Code = cl.CountryCode 
WHERE c.HeadOfState = 'Pierre Buyoya';
```
-------------------------7915 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.District = 'England' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS Percentage
FROM 
    Country co
JOIN 
    City c ON co.Code = c.CountryCode
WHERE 
    co.GovernmentForm = 'Constitutional Monarchy';
```
-------------------------7916 sample_num
```sql
SELECT DISTINCT c.Name AS Country
FROM City ci
JOIN Country c ON ci.CountryCode = c.Code
WHERE ci.Population BETWEEN 140000 AND 150000
AND c.LifeExpectancy > (SELECT AVG(LifeExpectancy) * 0.8 FROM Country);
```
-------------------------7917 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.GovernmentForm = 'Republic' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS PercentageOfRepublics
FROM 
    CountryLanguage cl
JOIN 
    Country c ON cl.CountryCode = c.Code
WHERE 
    cl.Language = 'Italian';
```
-------------------------7918 sample_num
```sql
SELECT COUNT(*) AS podcast_count
FROM podcasts
WHERE podcast_id IN (
    SELECT podcast_id
    FROM categories
    GROUP BY category
    HAVING COUNT(podcast_id) = (
        SELECT MAX(category_count)
        FROM (
            SELECT COUNT(podcast_id) AS category_count
            FROM categories
            GROUP BY category
        ) AS category_counts
    )
);
```
-------------------------7919 sample_num
```sql
SELECT 
    (COUNT(DISTINCT CASE WHEN category_count >= 4 THEN podcast_id END) * 100.0 / COUNT(DISTINCT podcast_id)) AS percentage
FROM (
    SELECT 
        podcast_id, 
        COUNT(category) AS category_count
    FROM 
        categories
    GROUP BY 
        podcast_id
) AS categorized_podcasts;
```
-------------------------7920 sample_num
```sql
SELECT itunes_id, itunes_url FROM podcasts WHERE title = 'Brown Suga Diaries';
```
-------------------------7921 sample_num
```sql
SELECT title, itunes_url 
FROM podcasts 
WHERE title LIKE '%Dream%';
```
-------------------------7922 sample_num
```sql
SELECT c.category 
FROM categories c 
JOIN podcasts p ON c.podcast_id = p.podcast_id 
WHERE p.title = 'I Heart My Life Show';
```
-------------------------7923 sample_num
```sql
SELECT p.title, p.itunes_url
FROM podcasts p
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE c.category = 'society-culture';
```
-------------------------7924 sample_num
```sql
SELECT COUNT(DISTINCT r.author_id) 
FROM reviews r
JOIN podcasts p ON r.podcast_id = p.podcast_id
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE r.rating = 5 
AND p.title LIKE '%spoiler%' 
AND c.category = 'art';
```
-------------------------7925 sample_num
```sql
SELECT DISTINCT author_id 
FROM reviews 
WHERE podcast_id = (SELECT podcast_id FROM podcasts WHERE title = 'Pop Rocket') 
AND created_at LIKE '2016%' 
AND rating < 5;
```
-------------------------7926 sample_num
```sql
SELECT p.title, c.category
FROM podcasts p
JOIN reviews r ON p.podcast_id = r.podcast_id
JOIN categories c ON p.podcast_id = c.podcast_id
GROUP BY p.title, c.category
HAVING AVG(r.rating) > 3.0;
```
-------------------------7927 sample_num
```sql
SELECT r.content, p.title
FROM reviews r
JOIN podcasts p ON r.podcast_id = p.podcast_id
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE c.category = 'fiction' AND r.rating = 5;
```
-------------------------7928 sample_num
```sql
SELECT p.title, r.content, r.rating
FROM reviews r
JOIN podcasts p ON r.podcast_id = p.podcast_id
WHERE r.title = 'Love it!';
```
-------------------------7929 sample_num
```sql
SELECT author_id, rating, created_at 
FROM reviews 
WHERE podcast_id = (SELECT podcast_id FROM podcasts WHERE title = 'In The Thick');
```
-------------------------7930 sample_num
```sql
SELECT p.title, r.created_at, r.rating
FROM reviews r
JOIN podcasts p ON r.podcast_id = p.podcast_id
ORDER BY r.created_at DESC
LIMIT 1;
```
-------------------------7931 sample_num
```sql
SELECT p.title, r.rating, r.content
FROM podcasts p
JOIN reviews r ON p.podcast_id = r.podcast_id
WHERE r.author_id = '76A4C24B6038145';
```
-------------------------7932 sample_num
```sql
SELECT p.title AS podcast_title, r.title AS review_title, r.content AS review_content
FROM reviews r
JOIN podcasts p ON r.podcast_id = p.podcast_id
WHERE r.rating = 1;
```
-------------------------7933 sample_num
```sql
SELECT p.title, r.rating
FROM reviews r
JOIN podcasts p ON r.podcast_id = p.podcast_id
WHERE r.created_at LIKE '2019-05%';
```
-------------------------7934 sample_num
```sql
SELECT AVG(rating) AS average_rating
FROM reviews
WHERE podcast_id = (
    SELECT podcast_id
    FROM reviews
    GROUP BY podcast_id
    ORDER BY COUNT(podcast_id) DESC
    LIMIT 1
);
```
-------------------------7935 sample_num
```sql
SELECT c.category 
FROM podcasts p 
JOIN categories c ON p.podcast_id = c.podcast_id 
WHERE p.title = 'SciFi Tech Talk';
```
-------------------------7936 sample_num
```sql
SELECT p.title, p.itunes_url
FROM podcasts p
JOIN reviews r ON p.podcast_id = r.podcast_id
WHERE r.title = 'Long time listener, calling it quits';
```
-------------------------7937 sample_num
```sql
SELECT p.title 
FROM podcasts p
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE c.category = 'true crime';
```
-------------------------7938 sample_num
```sql
SELECT r.content 
FROM reviews r 
JOIN podcasts p ON r.podcast_id = p.podcast_id 
WHERE p.title = 'StormCast: The Official Warhammer Age of Sigmar Podcast';
```
-------------------------7939 sample_num
```sql
SELECT r.title, r.content 
FROM reviews r 
JOIN podcasts p ON r.podcast_id = p.podcast_id 
WHERE p.title = 'More Stupider: A 90-Day Fiance Podcast' AND r.rating = 1;
```
-------------------------7940 sample_num
```sql
SELECT COUNT(*) 
FROM reviews r 
JOIN podcasts p ON r.podcast_id = p.podcast_id 
WHERE p.title = 'LifeAfter/The Message' AND r.rating < 3;
```
-------------------------7941 sample_num
```sql
SELECT c.category, AVG(r.rating) AS average_rating
FROM podcasts p
JOIN categories c ON p.podcast_id = c.podcast_id
LEFT JOIN reviews r ON p.podcast_id = r.podcast_id
WHERE p.title = 'More Stupider: A 90-Day Fiance Podcast'
GROUP BY c.category;
```
-------------------------7942 sample_num
```sql
SELECT 
    category, 
    COUNT(podcast_id) AS podcast_count 
FROM 
    categories 
WHERE 
    category IN ('arts-books', 'arts-design') 
GROUP BY 
    category 
ORDER BY 
    podcast_count DESC 
LIMIT 1;

SELECT 
    ABS(
        (SELECT COUNT(podcast_id) FROM categories WHERE category = 'arts-books') - 
        (SELECT COUNT(podcast_id) FROM categories WHERE category = 'arts-design')
    ) AS numerical_difference;
```
-------------------------7943 sample_num
```sql
SELECT SUM(reviews_added) AS total_reviews
FROM runs
WHERE run_at BETWEEN '2022-06-01 00:00:00' AND '2022-06-30 23:59:59';
```
-------------------------7944 sample_num
```sql
SELECT COUNT(*) 
FROM reviews 
WHERE rating = 3 
AND created_at BETWEEN '2015-01-01T00:00:00-07:00' AND '2015-03-31T23:59:59-07:00';
```
-------------------------7945 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.category = 'fiction-science-fiction' THEN p.podcast_id END) * 100.0 / COUNT(p.podcast_id)) AS percentage
FROM 
    podcasts p
LEFT JOIN 
    categories c ON p.podcast_id = c.podcast_id;
```
-------------------------7946 sample_num
```sql
SELECT AVG(rating) AS average_rating
FROM reviews
WHERE created_at BETWEEN '2019-01-01T00:00:00' AND '2019-12-31T23:59:59';
```
-------------------------7947 sample_num
```sql
SELECT 
    YEAR(run_at) AS year,
    (SUM(CASE WHEN run_at LIKE '2021%' THEN reviews_added ELSE 0 END) / SUM(reviews_added) * 100) AS percentage_2021,
    (SUM(CASE WHEN run_at LIKE '2022%' THEN reviews_added ELSE 0 END) / SUM(reviews_added) * 100) AS percentage_2022
FROM 
    runs
GROUP BY 
    YEAR(run_at);
```
-------------------------7948 sample_num
```sql
SELECT p.title 
FROM podcasts p
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE c.category = 'fiction';
```
-------------------------7949 sample_num
```sql
SELECT r.rating, c.category
FROM podcasts p
JOIN reviews r ON p.podcast_id = r.podcast_id
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE p.title = 'Sitcomadon';
```
-------------------------7950 sample_num
```sql
SELECT author_id FROM reviews WHERE podcast_id IN (SELECT podcast_id FROM podcasts WHERE itunes_id = 1516665400);
```
-------------------------7951 sample_num
```sql
SELECT p.title 
FROM podcasts p 
JOIN reviews r ON p.podcast_id = r.podcast_id 
WHERE r.created_at BETWEEN '2018-08-22T11:53:16-07:00' AND '2018-11-20T11:14:20-07:00';
```
-------------------------7952 sample_num
```sql
SELECT c.category 
FROM reviews r 
JOIN categories c ON r.podcast_id = c.podcast_id 
WHERE r.author_id = 'EFB34EAC8E9397C';
```
-------------------------7953 sample_num
```sql
SELECT slug, itunes_url 
FROM podcasts 
JOIN reviews ON podcasts.podcast_id = reviews.podcast_id 
WHERE reviews.content = 'Can''t stop listening';
```
-------------------------7954 sample_num
```sql
SELECT r.created_at 
FROM podcasts p 
JOIN reviews r ON p.podcast_id = r.podcast_id 
WHERE p.title = "Don't Lie To Your Life Coach";
```
-------------------------7955 sample_num
```sql
SELECT DISTINCT c.category
FROM reviews r
JOIN categories c ON r.podcast_id = c.podcast_id
WHERE r.created_at BETWEEN '2016-07-01T00:00:00-07:00' AND '2016-12-31T23:59:59-07:00';
```
-------------------------7956 sample_num
```sql
SELECT AVG(r.rating) AS average_rating
FROM reviews r
JOIN categories c ON r.podcast_id = c.podcast_id
WHERE c.category = 'true-crime';
```
-------------------------7957 sample_num
```sql
SELECT p.title 
FROM podcasts p
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE c.category = 'arts';
```
-------------------------7958 sample_num
```sql
SELECT AVG(rating) AS average_rating
FROM reviews
WHERE podcast_id IN (
    SELECT podcast_id
    FROM categories
    WHERE category = 'arts'
);
```
-------------------------7959 sample_num
```sql
SELECT p.title 
FROM podcasts p
JOIN reviews r ON p.podcast_id = r.podcast_id
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE c.category = 'arts' AND r.created_at LIKE '2018%';
```
-------------------------7960 sample_num
```sql
SELECT p.title 
FROM podcasts p
JOIN reviews r ON p.podcast_id = r.podcast_id
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE c.category = 'music' AND r.rating > 3;
```
-------------------------7961 sample_num
```sql
SELECT p.title 
FROM podcasts p
JOIN reviews r ON p.podcast_id = r.podcast_id
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE r.content = 'love' 
  AND c.category = 'art' 
  AND r.created_at BETWEEN '2018-01-01' AND '2019-12-31';
```
-------------------------7962 sample_num
```sql
SELECT c.category, p.itunes_url 
FROM podcasts p 
JOIN categories c ON p.podcast_id = c.podcast_id 
WHERE p.title = 'Scaling Global';
```
-------------------------7963 sample_num
```sql
SELECT AVG(rating) AS average_rating
FROM reviews
WHERE podcast_id IN (
    SELECT podcast_id
    FROM categories
    WHERE category = 'comedy'
);
```
-------------------------7964 sample_num
```sql
SELECT category
FROM categories
GROUP BY category
ORDER BY COUNT(category) ASC
LIMIT 1;
```
-------------------------7965 sample_num
```sql
SELECT MAX(LENGTH(content)) AS longest_review_length FROM reviews;
```
-------------------------7966 sample_num
```sql
SELECT podcast_id FROM reviews WHERE title = 'Hosts bring the show down';
```
-------------------------7967 sample_num
```sql
SELECT title 
FROM podcasts 
WHERE podcast_id IN (SELECT podcast_id FROM categories WHERE category = 'music') 
ORDER BY LENGTH(title) DESC 
LIMIT 1;
```
-------------------------7968 sample_num
```sql
SELECT c.category
FROM podcasts p
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE p.title LIKE '%jessica%';
```
-------------------------7969 sample_num
```sql
SELECT c.category 
FROM podcasts p 
JOIN categories c ON p.podcast_id = c.podcast_id 
WHERE p.title = 'Moist Boys';
```
-------------------------7970 sample_num
```sql
SELECT r.title AS review_title, r.content AS review_content, c.category
FROM reviews r
JOIN categories c ON r.podcast_id = c.podcast_id
WHERE r.rating = 2;
```
-------------------------7971 sample_num
```sql
SELECT p.*
FROM podcasts p
JOIN reviews r ON p.podcast_id = r.podcast_id
WHERE r.title = 'Inspired & On Fire!';
```
-------------------------7972 sample_num
```sql
SELECT p.title, c.category
FROM podcasts p
JOIN reviews r ON p.podcast_id = r.podcast_id
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE r.content LIKE '%Absolutely fantastic%';
```
-------------------------7973 sample_num
```sql
SELECT c.category, COUNT(r.podcast_id) AS review_count
FROM categories c
JOIN reviews r ON c.podcast_id = r.podcast_id
GROUP BY c.category
ORDER BY review_count DESC
LIMIT 1;
```
-------------------------7974 sample_num
```sql
SELECT p.itunes_url 
FROM podcasts p 
JOIN categories c ON p.podcast_id = c.podcast_id 
WHERE c.category = 'fiction-science-fiction';
```
-------------------------7975 sample_num
```sql
SELECT content 
FROM reviews 
WHERE podcast_id = (SELECT podcast_id FROM podcasts WHERE title = 'Stuff You Should Know') 
ORDER BY created_at ASC 
LIMIT 1;
```
-------------------------7976 sample_num
```sql
SELECT COUNT(*) 
FROM reviews 
WHERE podcast_id = (SELECT podcast_id FROM podcasts WHERE title = 'Planet Money');
```
-------------------------7977 sample_num
```sql
SELECT AVG(rating) AS average_rating 
FROM reviews 
WHERE podcast_id = (SELECT podcast_id FROM podcasts WHERE title = 'crime-junkie');
```
-------------------------7978 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.category = 'technology' THEN 1 END) * 100.0 / COUNT(p.podcast_id)) AS percentage_technology_podcasts,
    p.*
FROM 
    podcasts p
LEFT JOIN 
    categories c ON p.podcast_id = c.podcast_id
GROUP BY 
    p.podcast_id;
```
-------------------------7979 sample_num
```sql
SELECT content 
FROM reviews 
WHERE title = 'really interesting!' AND created_at = '2018-04-24T12:05:16-07:00';
```
-------------------------7980 sample_num
```sql
SELECT c.category 
FROM podcasts p 
JOIN categories c ON p.podcast_id = c.podcast_id 
WHERE p.title = 'Scaling Global';
```
-------------------------7981 sample_num
```sql
SELECT p.title 
FROM podcasts p
JOIN categories c ON p.podcast_id = c.podcast_id
WHERE c.category = 'arts-performing-arts';
```
-------------------------7982 sample_num
```sql
SELECT COUNT(*) 
FROM reviews 
WHERE podcast_id = (SELECT podcast_id FROM podcasts WHERE title = 'Scaling Global');
```
-------------------------7983 sample_num
```sql
SELECT COUNT(*) 
FROM reviews r 
JOIN podcasts p ON r.podcast_id = p.podcast_id 
WHERE p.title = 'Please Excuse My Dead Aunt Sally' 
AND r.created_at LIKE '2019%';
```
-------------------------7984 sample_num
```sql
SELECT p.title 
FROM podcasts p 
JOIN reviews r ON p.podcast_id = r.podcast_id 
WHERE r.author_id = 'F7E5A318989779D';
```
-------------------------7985 sample_num
```sql
SELECT COUNT(*) 
FROM reviews 
WHERE podcast_id = (SELECT podcast_id FROM podcasts WHERE title = 'Please Excuse My Dead Aunt Sally') 
AND rating = 5;
```
-------------------------7986 sample_num
```sql
SELECT AVG(rating) AS average_rating
FROM reviews
JOIN podcasts ON reviews.podcast_id = podcasts.podcast_id
WHERE podcasts.title = 'Please Excuse My Dead Aunt Sally';
```
-------------------------7987 sample_num
```sql
SELECT COUNT(*) 
FROM university_year 
WHERE num_students > 80000 AND year = 2011;
```
-------------------------7988 sample_num
```sql
SELECT ranking_system_id 
FROM ranking_criteria 
WHERE criteria_name = 'Award';
```
-------------------------7989 sample_num
```sql
SELECT COUNT(*) AS state_university_count 
FROM university 
WHERE university_name LIKE '%State%';
```
-------------------------7990 sample_num
```sql
SELECT student_staff_ratio 
FROM university_year 
WHERE student_staff_ratio = (SELECT MAX(student_staff_ratio) FROM university_year);
```
-------------------------7991 sample_num
```sql
SELECT COUNT(*) 
FROM ranking_criteria 
WHERE ranking_system_id = 3;
```
-------------------------7992 sample_num
```sql
SELECT university_id 
FROM university_year 
WHERE pct_international_students = 1 
AND year BETWEEN 2011 AND 2015;
```
-------------------------7993 sample_num
```sql
SELECT c.country_name
FROM country c
JOIN university u ON c.id = u.country_id
GROUP BY c.country_name
ORDER BY COUNT(u.id) DESC
LIMIT 1;
```
-------------------------7994 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_year uy ON u.id = uy.university_id
WHERE uy.pct_international_students = (
    SELECT MAX(pct_international_students)
    FROM university_year
    WHERE university_id = u.id
)
GROUP BY u.id
HAVING COUNT(DISTINCT uy.year) >= 6;
```
-------------------------7995 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE ur.year = 2014 AND rc.criteria_name = 'Publications Rank'
AND ur.score = (
    SELECT MAX(score)
    FROM university_ranking_year
    WHERE year = 2014 AND ranking_criteria_id = rc.id
);
```
-------------------------7996 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_year uy ON u.id = uy.university_id
WHERE uy.num_students = (SELECT MIN(num_students) FROM university_year);
```
-------------------------7997 sample_num
```sql
SELECT COUNT(*) 
FROM university 
WHERE country_id = (SELECT id FROM country WHERE country_name = 'United States of America');
```
-------------------------7998 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN country c ON u.country_id = c.id
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE c.country_name = 'Australia' 
  AND ur.year = 2016 
  AND rc.criteria_name = 'Citations'
ORDER BY ur.score DESC
LIMIT 1;
```
-------------------------7999 sample_num
```sql
SELECT COUNT(DISTINCT ur.university_id) AS universities_with_zero_awards
FROM university_ranking_year ur
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE rc.criteria_name = 'Award' AND ur.score = 0 AND ur.year BETWEEN 2005 AND 2015;
```
-------------------------8000 sample_num
```sql
SELECT c.country_name 
FROM university u 
JOIN country c ON u.country_id = c.id 
WHERE u.university_name = 'University of Oxford';
```
-------------------------8001 sample_num
```sql
SELECT COUNT(*) 
FROM university_ranking_year ur 
JOIN university u ON ur.university_id = u.id 
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id 
WHERE u.university_name = 'Yale University' 
AND rc.criteria_name = 'Quality of Education Rank' 
AND ur.score >= 10;
```
-------------------------8002 sample_num
```sql
SELECT rc.criteria_name
FROM ranking_criteria rc
JOIN ranking_system rs ON rc.ranking_system_id = rs.id
WHERE rs.system_name = 'Center for World University Rankings';
```
-------------------------8003 sample_num
```sql
SELECT university_name 
FROM university 
JOIN university_year ON university.id = university_year.university_id 
WHERE university_year.year = 2012 AND university_year.num_students > 50000;
```
-------------------------8004 sample_num
```sql
SELECT DISTINCT c.country_name
FROM university_year uy
JOIN university u ON uy.university_id = u.id
JOIN country c ON u.country_id = c.id
WHERE uy.year BETWEEN 2011 AND 2016
AND uy.pct_international_students > 50;
```
-------------------------8005 sample_num
```sql
SELECT COUNT(*) AS total_universities,
       SUM(CASE WHEN c.country_name = 'United States of America' THEN 1 ELSE 0 END) AS us_universities
FROM university_year uy
JOIN university u ON uy.university_id = u.id
JOIN country c ON u.country_id = c.id
WHERE uy.year = 2016
  AND (uy.pct_female_students * uy.num_students / 100) >= 20000;
```
-------------------------8006 sample_num
```sql
SELECT university_name
FROM university u
JOIN university_year uy ON u.id = uy.university_id
ORDER BY (uy.num_students * uy.pct_international_students / 100) DESC
LIMIT 5;
```
-------------------------8007 sample_num
```sql
SELECT university_id 
FROM university_year 
WHERE student_staff_ratio = (SELECT MAX(student_staff_ratio) FROM university_year);
```
-------------------------8008 sample_num
```sql
SELECT year 
FROM university_year 
WHERE num_students = (SELECT MIN(num_students) FROM university_year);
```
-------------------------8009 sample_num
```sql
SELECT AVG(pct_female_students) AS average_percentage_female_students
FROM university_year;
```
-------------------------8010 sample_num
```sql
SELECT 
    num_students,
    DIVIDE(MULTIPLY(pct_international_students, num_students), 100) AS international_students
FROM 
    university_year
WHERE 
    university_id = 20 AND year = 2013;
```
-------------------------8011 sample_num
```sql
SELECT id FROM university WHERE university_name = 'Harvard University';
```
-------------------------8012 sample_num
```sql
SELECT university_id 
FROM university_ranking_year 
WHERE year = 2011 AND score = 100;
```
-------------------------8013 sample_num
```sql
SELECT rs.system_name
FROM ranking_criteria rc
JOIN ranking_system rs ON rc.ranking_system_id = rs.id
WHERE rc.criteria_name = 'Quality of Education Rank';
```
-------------------------8014 sample_num
```sql
SELECT uy.student_staff_ratio 
FROM university_year uy 
JOIN university u ON uy.university_id = u.id 
WHERE u.university_name = 'Harvard University' AND uy.year = 2012;
```
-------------------------8015 sample_num
```sql
SELECT c.country_name 
FROM university u 
JOIN country c ON u.country_id = c.id 
WHERE u.id = 112;
```
-------------------------8016 sample_num
```sql
SELECT SUM(u.num_students) AS total_students
FROM university_year u
JOIN university un ON u.university_id = un.id
JOIN country c ON un.country_id = c.id
WHERE c.country_name = 'Sweden';
```
-------------------------8017 sample_num
```sql
SELECT university_ranking_year.ranking_criteria_id 
FROM university 
JOIN university_ranking_year ON university.id = university_ranking_year.university_id 
WHERE university.university_name = 'Brown University' AND university_ranking_year.year = 2014;
```
-------------------------8018 sample_num
```sql
SELECT university_name 
FROM university 
JOIN country ON university.country_id = country.id 
WHERE country_name = 'Spain';
```
-------------------------8019 sample_num
```sql
SELECT rc.criteria_name 
FROM university_ranking_year ur 
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id 
WHERE ur.university_id = 32 AND ur.year = 2015;
```
-------------------------8020 sample_num
```sql
SELECT AVG(ur.score) AS average_score
FROM university u
JOIN country c ON u.country_id = c.id
JOIN university_ranking_year ur ON u.id = ur.university_id
WHERE c.country_name = 'Brazil';
```
-------------------------8021 sample_num
```sql
SELECT c.country_name
FROM university u
JOIN university_year uy ON u.id = uy.university_id
JOIN country c ON u.country_id = c.id
WHERE uy.year = 2014
ORDER BY uy.num_students DESC
LIMIT 1;
```
-------------------------8022 sample_num
```sql
SELECT 
    ury.score, 
    DIVIDE(MULTIPLY(uy.num_students, uy.pct_international_students), 100) AS international_students
FROM 
    university_ranking_year ury
JOIN 
    university_year uy ON ury.university_id = uy.university_id
WHERE 
    ury.university_id = 100 AND ury.year = 2015 AND uy.year = 2015;
```
-------------------------8023 sample_num
```sql
SELECT u.num_students 
FROM university_year u 
JOIN university_ranking_year ur ON u.university_id = ur.university_id 
WHERE ur.score = 98 AND ur.year = 2013;
```
-------------------------8024 sample_num
```sql
SELECT criteria_name 
FROM ranking_criteria 
WHERE ranking_system_id = (SELECT id FROM ranking_system WHERE system_name = 'Center for World University Rankings');
```
-------------------------8025 sample_num
```sql
SELECT c.country_name
FROM university u
JOIN university_year uy ON u.id = uy.university_id
JOIN country c ON u.country_id = c.id
WHERE uy.num_students > (SELECT AVG(num_students) * 0.98 FROM university_year WHERE year = 2013)
AND uy.year = 2013;
```
-------------------------8026 sample_num
```sql
SELECT 
    DIVIDE(SUM(DIVIDE(MULTIPLY(u.num_students, u.pct_international_students), 100)), SUM(u.num_students)) AS international_student_percentage
FROM 
    university_year u
JOIN 
    university_ranking_year r ON u.university_id = r.university_id
WHERE 
    r.year = 2015 AND r.score < 80;
```
-------------------------8027 sample_num
```sql
SELECT SUM(num_students) AS total_students
FROM university_year
WHERE year = 2011;
```
-------------------------8028 sample_num
```sql
SELECT SUM(num_students * pct_female_students / 100) AS total_female_students
FROM university_year
WHERE year = 2011;
```
-------------------------8029 sample_num
```sql
SELECT student_staff_ratio 
FROM university_year 
WHERE student_staff_ratio = (SELECT MAX(student_staff_ratio) FROM university_year);
```
-------------------------8030 sample_num
```sql
SELECT university_id 
FROM university_year 
WHERE year = 2011 
ORDER BY num_students DESC 
LIMIT 1;
```
-------------------------8031 sample_num
```sql
SELECT COUNT(*) 
FROM university_year 
WHERE year = 2011 
  AND num_students > 50000 
  AND pct_international_students > 10;
```
-------------------------8032 sample_num
```sql
SELECT university_id 
FROM university_year 
WHERE year = 2012 
ORDER BY pct_female_students DESC 
LIMIT 1;
```
-------------------------8033 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
WHERE ur.year = 2012
ORDER BY ur.score DESC
LIMIT 1;
```
-------------------------8034 sample_num
```sql
SELECT university_name 
FROM university 
JOIN university_year ON university.id = university_year.university_id 
WHERE university_year.year = 2011 
ORDER BY num_students DESC 
LIMIT 1;
```
-------------------------8035 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE rc.criteria_name = 'Teaching'
ORDER BY ur.score DESC
LIMIT 1;
```
-------------------------8036 sample_num
```sql
SELECT pct_international_students 
FROM university_year 
JOIN university ON university_year.university_id = university.id 
WHERE university.university_name = 'Harvard University' AND university_year.year = 2011;
```
-------------------------8037 sample_num
```sql
SELECT DIVIDE(MULTIPLY(uys.pct_female_students, uys.num_students), 100) AS female_students
FROM university_year uys
JOIN university u ON u.id = uys.university_id
WHERE u.university_name = 'Stanford University' AND uys.year = 2011;
```
-------------------------8038 sample_num
```sql
SELECT c.country_name 
FROM university u 
JOIN country c ON u.country_id = c.id 
WHERE u.university_name = 'Harvard University';
```
-------------------------8039 sample_num
```sql
SELECT rs.system_name
FROM ranking_criteria rc
JOIN ranking_system rs ON rc.ranking_system_id = rs.id
WHERE rc.criteria_name = 'Teaching';
```
-------------------------8040 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN country c ON u.country_id = c.id
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE c.country_name = 'Argentina'
GROUP BY u.id
ORDER BY SUM(ur.score) DESC
LIMIT 1;
```
-------------------------8041 sample_num
```sql
SELECT COUNT(*) 
FROM university 
WHERE country_id = (SELECT id FROM country WHERE country_name = 'Argentina');
```
-------------------------8042 sample_num
```sql
SELECT university.university_name 
FROM university 
JOIN university_year ON university.id = university_year.university_id 
WHERE university_year.year = 2011 AND university_year.num_students > 100000;
```
-------------------------8043 sample_num
```sql
SELECT COUNT(*) 
FROM ranking_criteria 
WHERE ranking_system_id = (SELECT id FROM ranking_system WHERE system_name = 'Center for World University Rankings');
```
-------------------------8044 sample_num
```sql
SELECT u.num_students 
FROM university_year u 
JOIN university_ranking_year ur ON u.university_id = ur.university_id 
WHERE ur.year = 2011 AND ur.score = 90;
```
-------------------------8045 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_year uy ON u.id = uy.university_id
GROUP BY u.id, u.university_name
ORDER BY SUM(uy.pct_international_students * uy.num_students / 100) DESC
LIMIT 3;
```
-------------------------8046 sample_num
```sql
SELECT 
    SUM(num_students) - SUM((pct_international_students * num_students) / 100) AS enrollment_difference
FROM 
    university_year 
WHERE 
    university_id = (SELECT id FROM university WHERE university_name = 'Harvard University') 
    AND year BETWEEN 2011 AND 2012;
```
-------------------------8047 sample_num
```sql
SELECT COUNT(*) 
FROM university_year 
WHERE year = 2011 AND num_students > 30000;
```
-------------------------8048 sample_num
```sql
SELECT country_id FROM university WHERE university_name = 'University of Tokyo';
```
-------------------------8049 sample_num
```sql
SELECT id FROM ranking_system WHERE system_name = 'Center for World University Rankings';
```
-------------------------8050 sample_num
```sql
SELECT id FROM ranking_criteria WHERE criteria_name = 'Publications Rank';
```
-------------------------8051 sample_num
```sql
SELECT COUNT(*) 
FROM university_year 
WHERE year = 2013 AND pct_international_students > 30;
```
-------------------------8052 sample_num
```sql
SELECT COUNT(DISTINCT university_id) 
FROM university_ranking_year 
WHERE ranking_criteria_id = 6 AND year = 2011 AND score < 50;
```
-------------------------8053 sample_num
```sql
SELECT num_students 
FROM university_year 
JOIN university ON university_year.university_id = university.id 
WHERE university.university_name = 'Yale University' AND university_year.year = 2016;
```
-------------------------8054 sample_num
```sql
SELECT university_name 
FROM university 
WHERE country_id = (SELECT id FROM country WHERE country_name = 'Denmark');
```
-------------------------8055 sample_num
```sql
SELECT num_students / student_staff_ratio AS number_of_staff
FROM university_year
JOIN university ON university_year.university_id = university.id
WHERE university.university_name = 'University of Auckland' AND university_year.year = 2015;
```
-------------------------8056 sample_num
```sql
SELECT c.country_name 
FROM country c 
JOIN university u ON c.id = u.country_id 
WHERE u.university_name = 'University of São Paulo';
```
-------------------------8057 sample_num
```sql
SELECT DIVIDE(MULTIPLY(num_students, pct_international_students), 100) AS international_students
FROM university_year
JOIN university ON university_year.university_id = university.id
WHERE university.university_name = 'Harvard University' AND university_year.year = 2012;
```
-------------------------8058 sample_num
```sql
SELECT DIVIDE(MULTIPLY(uys.pct_female_students, uys.num_students), 100) AS female_students
FROM university_year uys
JOIN university u ON u.id = uys.university_id
WHERE u.university_name = 'Arizona State University' AND uys.year = 2014;
```
-------------------------8059 sample_num
```sql
SELECT u.university_name, SUM(ur.score) AS total_score
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
GROUP BY u.id, u.university_name
HAVING total_score = (SELECT MAX(total_score) 
                      FROM (SELECT SUM(score) AS total_score
                            FROM university_ranking_year
                            GROUP BY university_id) AS scores);
```
-------------------------8060 sample_num
```sql
SELECT criteria_name 
FROM ranking_criteria 
WHERE ranking_system_id = (SELECT id FROM ranking_system WHERE system_name = 'Shanghai Ranking');
```
-------------------------8061 sample_num
```sql
SELECT u.university_name, MIN(ur.score) AS lowest_score
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE ur.year = 2011 AND rc.criteria_name = 'Teaching'
GROUP BY u.university_name
ORDER BY lowest_score ASC
LIMIT 1;
```
-------------------------8062 sample_num
```sql
SELECT rs.system_name
FROM ranking_criteria rc
JOIN ranking_system rs ON rc.ranking_system_id = rs.id
WHERE rc.criteria_name = 'Quality of Education Rank';
```
-------------------------8063 sample_num
```sql
WITH scored_universities AS (
    SELECT u.university_name, ur.score
    FROM university u
    JOIN university_ranking_year ur ON u.id = ur.university_id
    JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
    WHERE rc.criteria_name = 'International' AND ur.year = 2016 AND ur.score > 80
),
total_universities AS (
    SELECT COUNT(*) AS total
    FROM university
)

SELECT 
    (COUNT(*) * 100.0 / (SELECT total FROM total_universities)) AS percent_above_80,
    MAX(university_name) AS highest_scoring_university
FROM scored_universities;
```
-------------------------8064 sample_num
```sql
SELECT rc.criteria_name, ury.score
FROM university u
JOIN university_ranking_year ury ON u.id = ury.university_id
JOIN ranking_criteria rc ON ury.ranking_criteria_id = rc.id
WHERE u.university_name = 'Harvard University' AND ury.year = 2005;
```
-------------------------8065 sample_num
```sql
SELECT AVG(score) AS average_score
FROM university_ranking_year
WHERE ranking_criteria_id = (SELECT id FROM ranking_criteria WHERE criteria_name = 'Alumni')
  AND year = 2008;
```
-------------------------8066 sample_num
```sql
SELECT u.university_name, c.country_name
FROM university_year uy
JOIN university u ON uy.university_id = u.id
JOIN country c ON u.country_id = c.id
WHERE uy.year = 2015
ORDER BY (uy.num_students * uy.pct_international_students / 100) DESC
LIMIT 1;
```
-------------------------8067 sample_num
```sql
SELECT num_students 
FROM university_year 
WHERE university_id = 1 AND year = 2011;
```
-------------------------8068 sample_num
```sql
SELECT university_id 
FROM university_year 
WHERE year = 2011 
ORDER BY num_students DESC 
LIMIT 1;
```
-------------------------8069 sample_num
```sql
SELECT university_id 
FROM university_year 
WHERE year = 2011 AND student_staff_ratio > 15;
```
-------------------------8070 sample_num
```sql
SELECT COUNT(*) 
FROM university_year 
WHERE year = 2011 
  AND num_students > 20000 
  AND pct_international_students > 25;
```
-------------------------8071 sample_num
```sql
SELECT university_id 
FROM university_year 
WHERE year = 2011 
ORDER BY pct_female_students DESC 
LIMIT 3;
```
-------------------------8072 sample_num
```sql
SELECT year 
FROM university_year 
WHERE university_id = 1 
ORDER BY num_students DESC 
LIMIT 1;
```
-------------------------8073 sample_num
```sql
SELECT num_students 
FROM university_year 
WHERE university_id = (SELECT id FROM university WHERE university_name = 'Harvard University') 
AND year = 2011;
```
-------------------------8074 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_year uy ON u.id = uy.university_id
WHERE uy.year = 2011
ORDER BY (uy.num_students * uy.pct_international_students / 100) DESC
LIMIT 1;
```
-------------------------8075 sample_num
```sql
SELECT university_name 
FROM university 
WHERE country_id = (SELECT id FROM country WHERE country_name = 'Australia');
```
-------------------------8076 sample_num
```sql
SELECT COUNT(*) 
FROM university u 
JOIN country c ON u.country_id = c.id 
JOIN university_year uy ON u.id = uy.university_id 
WHERE c.country_name = 'Australia' AND uy.year = 2011 AND uy.num_students > 15000;
```
-------------------------8077 sample_num
```sql
SELECT c.country_name 
FROM university u 
JOIN country c ON u.country_id = c.id 
WHERE u.university_name = 'Harvard University';
```
-------------------------8078 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE rc.criteria_name = 'Teaching' AND ur.year = 2011
ORDER BY ur.score DESC
LIMIT 1;
```
-------------------------8079 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE rc.criteria_name = 'Teaching' AND ur.year = 2011 AND ur.score > 90;
```
-------------------------8080 sample_num
```sql
SELECT COUNT(DISTINCT u.id) AS university_count
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
JOIN country c ON u.country_id = c.id
WHERE ur.year = 2011 
  AND rc.criteria_name = 'Teaching' 
  AND ur.score > 90 
  AND c.country_name = 'United States of America';
```
-------------------------8081 sample_num
```sql
SELECT rc.criteria_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE u.university_name = 'Harvard University' AND ur.year = 2011;
```
-------------------------8082 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE ur.year = 2011 AND ur.score = 98 AND rc.criteria_name = 'Teaching';
```
-------------------------8083 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN country c ON u.country_id = c.id
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE c.country_name = 'United States of America'
  AND ur.year = 2011
  AND rc.criteria_name = 'Teaching'
  AND ur.score < 60;
```
-------------------------8084 sample_num
```sql
SELECT COUNT(*) 
FROM university u
JOIN country c ON u.country_id = c.id
JOIN university_year uy ON u.id = uy.university_id
WHERE c.country_name = 'Australia' 
AND uy.year = 2011 
AND uy.student_staff_ratio > 15;
```
-------------------------8085 sample_num
```sql
SELECT DIVIDE(MULTIPLY(uys.pct_female_students, uys.num_students), 100) AS female_students
FROM university_year uys
JOIN university u ON u.id = uys.university_id
WHERE u.university_name = 'Stanford University' AND uys.year = 2011;
```
-------------------------8086 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.country_name = 'United States of America' THEN 1 END) * 100.0) / COUNT(u.id) AS percentage
FROM 
    university u
JOIN 
    university_ranking_year ur ON u.id = ur.university_id
JOIN 
    ranking_criteria rc ON ur.ranking_criteria_id = rc.id
JOIN 
    country c ON u.country_id = c.id
WHERE 
    ur.year = 2011 AND rc.criteria_name = 'Teaching' AND ur.score > 90;
```
-------------------------8087 sample_num
```sql
SELECT id FROM ranking_system WHERE system_name = 'Center for World University Rankings';
```
-------------------------8088 sample_num
```sql
SELECT c.id 
FROM university u 
JOIN country c ON u.country_id = c.id 
WHERE u.university_name = 'University of Veterinary Medicine Vienna';
```
-------------------------8089 sample_num
```sql
SELECT id FROM ranking_criteria WHERE criteria_name = 'Citations Rank';
```
-------------------------8090 sample_num
```sql
SELECT id FROM university WHERE university_name = 'University of Orléans';
```
-------------------------8091 sample_num
```sql
SELECT num_students 
FROM university_year 
WHERE university_id = 268 AND year = 2013;
```
-------------------------8092 sample_num
```sql
SELECT country_name FROM country WHERE id = 66;
```
-------------------------8093 sample_num
```sql
SELECT c.country_name 
FROM university u 
JOIN country c ON u.country_id = c.id 
WHERE u.university_name = 'McMaster University';
```
-------------------------8094 sample_num
```sql
SELECT COUNT(*) 
FROM university 
WHERE country_id = (SELECT id FROM country WHERE country_name = 'Turkey');
```
-------------------------8095 sample_num
```sql
SELECT university_name 
FROM university 
JOIN university_year ON university.id = university_year.university_id 
WHERE university_year.year = 2011 
ORDER BY num_students DESC 
LIMIT 1;
```
-------------------------8096 sample_num
```sql
SELECT num_students 
FROM university_year 
WHERE university_id = (SELECT id FROM university WHERE university_name = 'University of Michigan') 
AND year = 2011;
```
-------------------------8097 sample_num
```sql
SELECT ury.score 
FROM university_ranking_year ury
JOIN university u ON ury.university_id = u.id
JOIN ranking_criteria rc ON ury.ranking_criteria_id = rc.id
WHERE u.university_name = 'Chosun University' 
  AND ury.year = 2015 
  AND rc.criteria_name = 'Influence Rank';
```
-------------------------8098 sample_num
```sql
SELECT pct_international_students 
FROM university_year 
JOIN university ON university_year.university_id = university.id 
WHERE university.university_name = 'University of Oslo' 
AND university_year.year = 2015;
```
-------------------------8099 sample_num
```sql
SELECT c.criteria_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria c ON ur.ranking_criteria_id = c.id
WHERE u.university_name = 'University of Southampton' AND ur.year = 2015
ORDER BY ur.score DESC
LIMIT 1;
```
-------------------------8100 sample_num
```sql
SELECT rs.system_name
FROM ranking_criteria rc
JOIN ranking_system rs ON rc.ranking_system_id = rs.id
WHERE rc.criteria_name = 'Total Shanghai';
```
-------------------------8101 sample_num
```sql
SELECT DIVIDE(MULTIPLY(u.pct_female_students, u.num_students), 100) AS female_students
FROM university_year u
JOIN university un ON u.university_id = un.id
WHERE un.university_name = 'Pierre and Marie Curie University' AND u.year = 2015;
```
-------------------------8102 sample_num
```sql
SELECT ury.score 
FROM university_ranking_year ury
JOIN university u ON ury.university_id = u.id
JOIN ranking_criteria rc ON ury.ranking_criteria_id = rc.id
WHERE u.university_name = 'University of Florida' 
  AND rc.criteria_name = 'N and S' 
  AND ury.year = 2014;
```
-------------------------8103 sample_num
```sql
SELECT DIVIDE(MULTIPLY(u.num_students, u.pct_international_students), 100) AS international_students
FROM university_year u
JOIN university un ON u.university_id = un.id
WHERE un.university_name = 'University of Wisconsin-Madison' AND u.year = 2013;
```
-------------------------8104 sample_num
```sql
SELECT university_name 
FROM university 
JOIN university_year ON university.id = university_year.university_id 
WHERE year = 2015 
ORDER BY num_students ASC 
LIMIT 1;
```
-------------------------8105 sample_num
```sql
SELECT 
    (SELECT SUM(num_students) FROM university_year 
     JOIN university ON university_year.university_id = university.id 
     WHERE university.university_name = 'University of Ottawa' AND university_year.year = 2013) /
    (SELECT SUM(num_students) FROM university_year 
     JOIN university ON university_year.university_id = university.id 
     WHERE university.university_name = 'Joseph Fourier University' AND university_year.year = 2013) AS times_more
```
-------------------------8106 sample_num
```sql
SELECT AVG(criteria_count) AS average_criteria
FROM (
    SELECT COUNT(c.id) AS criteria_count
    FROM ranking_criteria c
    JOIN ranking_system s ON c.ranking_system_id = s.id
    WHERE s.system_name IN ('Times Higher Education World University Ranking', 'Shanghai Ranking', 'Center for World University Rankings')
    GROUP BY s.id
) AS criteria_counts;
```
-------------------------8107 sample_num
```sql
SELECT AVG(num_students) AS average_students
FROM university_year
WHERE year = 2012;
```
-------------------------8108 sample_num
```sql
SELECT score 
FROM university_ranking_year 
WHERE university_id = 68 AND year = 2015;
```
-------------------------8109 sample_num
```sql
SELECT id FROM country WHERE country_name = 'Cyprus';
```
-------------------------8110 sample_num
```sql
SELECT university_id 
FROM university_year 
WHERE pct_international_students = (SELECT MAX(pct_international_students) FROM university_year);
```
-------------------------8111 sample_num
```sql
SELECT criteria_name FROM ranking_criteria WHERE id = 13;
```
-------------------------8112 sample_num
```sql
SELECT AVG(score) AS average_score
FROM university_ranking_year
WHERE year = 2012;
```
-------------------------8113 sample_num
```sql
SELECT SUM((pct_female_students * num_students) / 100) AS total_female_students
FROM university_year
WHERE university_id = 40 AND year BETWEEN 2011 AND 2013;
```
-------------------------8114 sample_num
```sql
SELECT AVG(score) AS average_score
FROM university_ranking_year
WHERE university_id = 79 AND year BETWEEN 2013 AND 2015;
```
-------------------------8115 sample_num
```sql
SELECT student_staff_ratio FROM university_year WHERE university_id = 35;
```
-------------------------8116 sample_num
```sql
SELECT ur.score
FROM university_year uy
JOIN university_ranking_year ur ON uy.university_id = ur.university_id
WHERE uy.year = 2011 AND uy.num_students = (
    SELECT MAX(num_students)
    FROM university_year
    WHERE year = 2011
);
```
-------------------------8117 sample_num
```sql
SELECT rc.criteria_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
JOIN ranking_criteria rc ON ur.ranking_criteria_id = rc.id
WHERE u.university_name = 'Harvard University' AND ur.score = 100;
```
-------------------------8118 sample_num
```sql
SELECT university.id, university.university_name 
FROM university 
JOIN country ON university.country_id = country.id 
WHERE country.country_name = 'Turkey';
```
-------------------------8119 sample_num
```sql
SELECT COUNT(*) 
FROM ranking_criteria 
WHERE ranking_system_id = (SELECT id FROM ranking_system WHERE system_name = 'Shanghai Ranking');
```
-------------------------8120 sample_num
```sql
SELECT u.university_name, ur.score 
FROM university u 
JOIN university_ranking_year ur ON u.id = ur.university_id 
WHERE u.id = 124;
```
-------------------------8121 sample_num
```sql
SELECT DIVIDE(MULTIPLY(num_students, pct_female_students), 100) AS female_students
FROM university_year
JOIN university ON university_year.university_id = university.id
WHERE university.university_name = 'University of Pennsylvania' AND university_year.year = 2011;
```
-------------------------8122 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
WHERE ur.score < 50;
```
-------------------------8123 sample_num
```sql
SELECT COUNT(*) 
FROM university 
WHERE country_id = (SELECT id FROM country WHERE country_name = 'Japan');
```
-------------------------8124 sample_num
```sql
SELECT university_name 
FROM university 
JOIN university_year ON university.id = university_year.university_id 
ORDER BY num_students - (num_students * pct_female_students / 100) DESC 
LIMIT 1;
```
-------------------------8125 sample_num
```sql
SELECT DISTINCT c.country_name
FROM country c
JOIN university u ON c.id = u.country_id
JOIN university_ranking_year ur ON u.id = ur.university_id
WHERE ur.year = 2016 AND ur.score < 70;
```
-------------------------8126 sample_num
```sql
SELECT num_students - (num_students * (100 - pct_female_students) / 100) AS male_students
FROM university_year
JOIN university ON university.id = university_year.university_id
WHERE university.university_name = 'Emory University' AND university_year.year = 2011;
```
-------------------------8127 sample_num
```sql
SELECT c.country_name 
FROM university u 
JOIN country c ON u.country_id = c.id 
WHERE u.university_name = 'Johns Hopkins University';
```
-------------------------8128 sample_num
```sql
SELECT university_name 
FROM university 
JOIN university_year ON university.id = university_year.university_id 
WHERE num_students BETWEEN 400 AND 1000;
```
-------------------------8129 sample_num
```sql
SELECT year 
FROM university_ranking_year 
WHERE university_id = (SELECT id FROM university WHERE university_name = 'Brown University') 
ORDER BY score DESC 
LIMIT 1;
```
-------------------------8130 sample_num
```sql
SELECT AVG(ur.score) AS average_score
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
WHERE u.university_name = 'Emory University' AND ur.year BETWEEN 2011 AND 2016;
```
-------------------------8131 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_year uy ON u.id = uy.university_id
WHERE uy.year = 2015
ORDER BY uy.num_students DESC
LIMIT 1;
```
-------------------------8132 sample_num
```sql
SELECT c.country_name, (u.num_students * u.pct_female_students / 100) AS num_female_students
FROM university u
JOIN country c ON u.country_id = c.id
WHERE u.id = 23 AND u.year = 2011;
```
-------------------------8133 sample_num
```sql
SELECT COUNT(DISTINCT university_id) 
FROM university_ranking_year 
WHERE score = 40 
AND ranking_criteria_id IN (
    SELECT id 
    FROM ranking_criteria 
    WHERE criteria_name = 'Teaching'
);
```
-------------------------8134 sample_num
```sql
SELECT 
    DIVIDE(SUM(DIVIDE(MULTIPLY(u.num_students, u.pct_female_students), 100)), SUM(u.num_students)) AS percentage_female_students
FROM 
    university_year u
JOIN 
    university un ON u.university_id = un.id
JOIN 
    country c ON un.country_id = c.id
WHERE 
    c.country_name = 'United States of America' AND u.year = 2016;
```
-------------------------8135 sample_num
```sql
SELECT 
    SUM(num_students) - SUM(DIVIDE(MULTIPLY(num_students, pct_international_students), 100)) AS difference
FROM 
    university_year 
WHERE 
    university_id = (SELECT id FROM university WHERE university_name = 'University of Tokyo') 
    AND year BETWEEN 2011 AND 2014;
```
-------------------------8136 sample_num
```sql
SELECT u.university_name
FROM university u
JOIN university_ranking_year ur ON u.id = ur.university_id
WHERE ur.year = 2015 AND ur.score < (SELECT AVG(score) * 0.28 FROM university_ranking_year WHERE year = 2015);
```
-------------------------8137 sample_num
```sql
SELECT SUM(units) 
FROM sales_in_weather 
WHERE store_nbr = 1 AND item_nbr = 9 AND date = '2012-01-01';
```
-------------------------8138 sample_num
```sql
SELECT SUM(units) AS total_units
FROM sales_in_weather
WHERE store_nbr = 1 AND item_nbr = 9 AND SUBSTR(date, 1, 4) = '2012' AND SUBSTR(date, 6, 2) = '01';
```
-------------------------8139 sample_num
```sql
SELECT item_nbr 
FROM sales_in_weather 
WHERE date = '2012-01-01' AND store_nbr = 1 
ORDER BY units DESC 
LIMIT 1;
```
-------------------------8140 sample_num
```sql
SELECT (tmax - tmin) AS temperature_range
FROM weather
WHERE station_nbr = 1 AND date = '2012-01-01';
```
-------------------------8141 sample_num
```sql
SELECT w.date
FROM weather w
WHERE w.station_nbr = 2 AND w.depart > 0;
```
-------------------------8142 sample_num
```sql
SELECT 
    date, 
    MAX(avgspeed) AS max_wind_speed
FROM 
    weather
WHERE 
    station_nbr = 1 AND 
    date IN ('2012-01-01', '2012-01-02')
GROUP BY 
    date
ORDER BY 
    max_wind_speed DESC
LIMIT 1;
```
-------------------------8143 sample_num
```sql
SELECT SUM(s.units) AS total_units
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.item_nbr = 5 
  AND s.store_nbr = 3 
  AND SUBSTR(s.date, 1, 4) = '2012' 
  AND w.depart < 0;
```
-------------------------8144 sample_num
```sql
SELECT SUM(s.units) AS total_units
FROM sales_in_weather s
JOIN weather w ON s.date = w.date
JOIN relation r ON s.store_nbr = r.store_nbr AND r.station_nbr = w.station_nbr
WHERE s.item_nbr = 5 
  AND s.store_nbr = 3 
  AND w.tmax = (SELECT MAX(tmax) 
                FROM weather 
                WHERE SUBSTR(date, 1, 4) = '2012')
  AND SUBSTR(s.date, 1, 4) = '2012';
```
-------------------------8145 sample_num
```sql
SELECT w.dewpoint
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.item_nbr = 5 AND s.store_nbr = 3 AND SUBSTR(s.date, 1, 4) = '2012'
ORDER BY s.units DESC
LIMIT 1;
```
-------------------------8146 sample_num
```sql
SELECT COUNT(DISTINCT sw.date) AS days_count
FROM sales_in_weather sw
JOIN relation r ON sw.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND sw.date = w.date
WHERE w.tmax > 90 AND sw.item_nbr = 5 AND sw.store_nbr = 3 AND sw.units > 100;
```
-------------------------8147 sample_num
```sql
SELECT SUM(s.units) AS total_units
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.item_nbr = 5
AND s.store_nbr = 3
AND (w.tmax - w.tmin) = (
    SELECT MAX(tmax - tmin)
    FROM weather
)
```
-------------------------8148 sample_num
```sql
SELECT ws.date, MAX(ws.tmax - ws.tmin) AS max_temp_range
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather ws ON r.station_nbr = ws.station_nbr AND s.date = ws.date
WHERE s.units > 100 AND s.item_nbr = 5 AND s.store_nbr = 3
GROUP BY ws.date
ORDER BY max_temp_range DESC
LIMIT 1;
```
-------------------------8149 sample_num
```sql
SELECT SUM(s.units) AS total_units
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.item_nbr = 5 AND s.store_nbr = 3 AND w.preciptotal > 0.05;
```
-------------------------8150 sample_num
```sql
SELECT s.date
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.item_nbr = 5 AND s.store_nbr = 3 AND s.units > 100 AND w.avgspeed > 10;
```
-------------------------8151 sample_num
```sql
SELECT SUM(s.units) AS total_units
FROM sales_in_weather s
JOIN weather w ON s.date = w.date
JOIN relation r ON s.store_nbr = r.store_nbr
WHERE r.store_nbr = 3 
  AND SUBSTRING(s.date, 1, 4) = '2012'
  AND w.tmax = (SELECT MAX(tmax) 
                FROM weather 
                JOIN relation ON weather.station_nbr = relation.station_nbr 
                JOIN sales_in_weather ON sales_in_weather.date = weather.date 
                WHERE relation.store_nbr = 3 
                  AND SUBSTRING(sales_in_weather.date, 1, 4) = '2012')
```
-------------------------8152 sample_num
```sql
SELECT 
    (SUM(CASE WHEN s.store_nbr = 5 THEN s.units ELSE 0 END) - 
     SUM(CASE WHEN s.store_nbr = 10 THEN s.units ELSE 0 END)) AS units_difference
FROM 
    sales_in_weather s
JOIN 
    weather w ON s.date = w.date
JOIN 
    relation r ON s.store_nbr = r.store_nbr
WHERE 
    s.item_nbr = 16 
    AND w.tmax = (SELECT MAX(tmax) 
                  FROM weather 
                  WHERE SUBSTR(date, 1, 4) = '2012')
    AND SUBSTR(s.date, 1, 4) = '2012'
    AND (s.store_nbr = 5 OR s.store_nbr = 10);
```
-------------------------8153 sample_num
```sql
SELECT item_nbr
FROM sales_in_weather
WHERE store_nbr = 3 AND date IN (
    SELECT date
    FROM weather
    WHERE station_nbr IN (
        SELECT station_nbr
        FROM relation
        WHERE store_nbr = 3
    ) AND tmax = (
        SELECT MAX(tmax)
        FROM weather
        WHERE station_nbr IN (
            SELECT station_nbr
            FROM relation
            WHERE store_nbr = 3
        ) AND SUBSTRING(date, 1, 4) = '2012'
    )
) AND SUBSTRING(date, 1, 4) = '2012'
GROUP BY item_nbr
ORDER BY SUM(units) DESC
LIMIT 1;
```
-------------------------8154 sample_num
```sql
SELECT COUNT(*) AS no_sales_items
FROM sales_in_weather
WHERE store_nbr = 3 AND units = 0
AND date = (
    SELECT date
    FROM weather
    WHERE SUBSTR(date, 1, 4) = '2012'
    ORDER BY tmax DESC
    LIMIT 1
);
```
-------------------------8155 sample_num
```sql
SELECT AVG(total_units) AS average_units
FROM (
    SELECT SUM(s.units) AS total_units, s.date
    FROM sales_in_weather s
    JOIN relation r ON s.store_nbr = r.store_nbr
    JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
    WHERE s.item_nbr = 5 AND s.store_nbr = 3 AND w.tmax > 90
    GROUP BY s.date
) AS daily_sales;
```
-------------------------8156 sample_num
```sql
SELECT 
    (SUM(CASE WHEN siw.item_nbr = 5 THEN siw.units ELSE 0 END) * 100.0 / SUM(siw.units)) AS percentage
FROM 
    sales_in_weather siw
JOIN 
    weather w ON siw.date = w.date
JOIN 
    relation r ON siw.store_nbr = r.store_nbr
WHERE 
    siw.store_nbr = 3 
    AND SUBSTR(siw.date, 1, 4) = '2012' 
    AND w.tmax = (SELECT MAX(tmax) FROM weather WHERE SUBSTR(date, 1, 4) = '2012');
```
-------------------------8157 sample_num
```sql
SELECT item_nbr 
FROM sales_in_weather 
WHERE store_nbr = 1 AND date = '2012-01-01' 
ORDER BY units DESC 
LIMIT 1;
```
-------------------------8158 sample_num
```sql
SELECT SUM(units) 
FROM sales_in_weather 
WHERE item_nbr = 9 AND store_nbr = 11 AND date = '2012-12-07';
```
-------------------------8159 sample_num
```sql
SELECT tavg FROM weather WHERE station_nbr = 20 AND date = '2014-10-17';
```
-------------------------8160 sample_num
```sql
SELECT resultspeed 
FROM weather 
WHERE station_nbr = 9 AND date = '2014-01-15';
```
-------------------------8161 sample_num
```sql
SELECT station_nbr
FROM relation
GROUP BY station_nbr
ORDER BY COUNT(store_nbr) DESC
LIMIT 1;
```
-------------------------8162 sample_num
```sql
SELECT station_nbr FROM relation WHERE store_nbr = 20;
```
-------------------------8163 sample_num
```sql
SELECT (w.tmax - w.tmin) AS temperature_range
FROM weather w
JOIN relation r ON w.station_nbr = r.station_nbr
WHERE r.store_nbr = 7 AND w.date = '2014-04-28';
```
-------------------------8164 sample_num
```sql
SELECT COUNT(DISTINCT r.store_nbr) AS store_count
FROM weather w
JOIN relation r ON w.station_nbr = r.station_nbr
WHERE w.depart = (SELECT MAX(depart) FROM weather);
```
-------------------------8165 sample_num
```sql
SELECT w.dewpoint 
FROM weather w 
JOIN relation r ON w.station_nbr = r.station_nbr 
WHERE r.store_nbr = 15 AND w.date = '2012-02-18';
```
-------------------------8166 sample_num
```sql
SELECT w.wetbulb 
FROM weather w 
JOIN relation r ON w.station_nbr = r.station_nbr 
WHERE r.store_nbr = 6 AND w.date = '2012-02-15';
```
-------------------------8167 sample_num
```sql
SELECT COUNT(DISTINCT r.store_nbr) AS number_of_stores
FROM relation r
JOIN weather w ON r.station_nbr = w.station_nbr
WHERE w.avgspeed = (SELECT MAX(avgspeed) FROM weather);
```
-------------------------8168 sample_num
```sql
SELECT w.tmax 
FROM weather w 
JOIN relation r ON w.station_nbr = r.station_nbr 
WHERE r.store_nbr = 21 AND w.date = '2012-11-09';
```
-------------------------8169 sample_num
```sql
SELECT w.sunrise 
FROM weather w 
JOIN relation r ON w.station_nbr = r.station_nbr 
WHERE r.store_nbr = 30 AND w.date = '2014-02-21';
```
-------------------------8170 sample_num
```sql
SELECT COUNT(DISTINCT r.store_nbr) AS number_of_stores
FROM relation r
JOIN weather w ON r.station_nbr = w.station_nbr
WHERE w.snowfall = (SELECT MAX(snowfall) FROM weather);
```
-------------------------8171 sample_num
```sql
SELECT w.codesum
FROM weather w
JOIN relation r ON w.station_nbr = r.station_nbr
WHERE r.store_nbr = 2 AND w.date = '2013-02-12';
```
-------------------------8172 sample_num
```sql
SELECT w.sealevel 
FROM weather w 
JOIN relation r ON w.station_nbr = r.station_nbr 
WHERE r.store_nbr = 19 AND w.date = '2013-02-24';
```
-------------------------8173 sample_num
```sql
SELECT SUM(w.preciptotal) AS total_precipitation
FROM weather w
JOIN relation r ON w.station_nbr = r.station_nbr
WHERE r.store_nbr = 2 AND w.date = '2012-12-25';
```
-------------------------8174 sample_num
```sql
SELECT w.stnpressure 
FROM weather w 
JOIN relation r ON w.station_nbr = r.station_nbr 
WHERE r.store_nbr = 12 AND w.date = '2012-05-15';
```
-------------------------8175 sample_num
```sql
SELECT 
    (SUM(CASE WHEN s.store_nbr = 10 THEN s.units ELSE 0 END) / SUM(s.units)) * 100 AS percentage
FROM 
    sales_in_weather s
JOIN 
    relation r ON s.store_nbr = r.store_nbr
JOIN 
    weather w ON r.station_nbr = w.station_nbr
WHERE 
    s.date = '2014-10-31' AND w.date = '2014-10-31';
```
-------------------------8176 sample_num
```sql
SELECT 
    ((w2.tavg - w1.tavg) / w1.tavg) * 100 AS increase_percentage
FROM 
    relation r
JOIN 
    weather w1 ON r.station_nbr = w1.station_nbr AND w1.date = '2012-02-02'
JOIN 
    weather w2 ON r.station_nbr = w2.station_nbr AND w2.date = '2012-02-03'
WHERE 
    r.store_nbr = 9;
```
-------------------------8177 sample_num
```sql
SELECT item_nbr 
FROM sales_in_weather 
WHERE store_nbr = 1 AND date = '2012-01-01' 
ORDER BY units DESC 
LIMIT 1;
```
-------------------------8178 sample_num
```sql
SELECT COUNT(store_nbr) 
FROM relation 
WHERE station_nbr = 12;
```
-------------------------8179 sample_num
```sql
SELECT COUNT(DISTINCT item_nbr) 
FROM sales_in_weather 
WHERE store_nbr = 2 AND date = '2012-01-01' AND units = 0;
```
-------------------------8180 sample_num
```sql
SELECT date, MAX(tmax) AS hottest_temp
FROM weather
WHERE station_nbr = 1 AND SUBSTR(date, 1, 4) BETWEEN '2012' AND '2014'
GROUP BY date
ORDER BY hottest_temp DESC
LIMIT 1;
```
-------------------------8181 sample_num
```sql
SELECT station_nbr
FROM relation
GROUP BY station_nbr
ORDER BY COUNT(store_nbr) DESC
LIMIT 1;
```
-------------------------8182 sample_num
```sql
SELECT r.station_nbr
FROM weather w
JOIN relation r ON w.station_nbr = r.station_nbr
WHERE w.depart < 0
  AND SUBSTRING(w.date, 1, 4) = '2014'
  AND SUBSTRING(w.date, 6, 2) = '03'
GROUP BY r.station_nbr
ORDER BY COUNT(w.date) DESC
LIMIT 1;
```
-------------------------8183 sample_num
```sql
SELECT r.station_nbr
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
WHERE s.item_nbr = 9
GROUP BY r.station_nbr
ORDER BY SUM(s.units) DESC
LIMIT 1;
```
-------------------------8184 sample_num
```sql
SELECT COUNT(DISTINCT r.store_nbr) AS store_count
FROM relation r
JOIN weather w ON r.station_nbr = w.station_nbr
WHERE w.avgspeed = (SELECT MAX(avgspeed) FROM weather);
```
-------------------------8185 sample_num
```sql
SELECT DISTINCT s.store_nbr
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
WHERE r.station_nbr = 14
  AND s.item_nbr = 44
  AND s.units >= 300
  AND SUBSTRING(s.date, 1, 7) = '2014-02';
```
-------------------------8186 sample_num
```sql
SELECT item_nbr, SUM(units) AS total_units
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE w.codesum = 'RA' 
  AND SUBSTR(s.date, 1, 7) = '2013-06' 
  AND w.station_nbr = 9
GROUP BY item_nbr
ORDER BY total_units DESC
LIMIT 1;
```
-------------------------8187 sample_num
```sql
SELECT r.station_nbr
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
WHERE s.item_nbr = 5
GROUP BY r.station_nbr
ORDER BY SUM(s.units) DESC
LIMIT 1;
```
-------------------------8188 sample_num
```sql
SELECT MIN(w.sunrise) AS earliest_sunrise
FROM weather w
JOIN relation r ON w.station_nbr = r.station_nbr
WHERE SUBSTR(w.date, 1, 7) = '2012-02'
GROUP BY r.station_nbr
HAVING COUNT(r.store_nbr) <= 1;
```
-------------------------8189 sample_num
```sql
SELECT store_nbr, SUM(units) AS total_units
FROM sales_in_weather
JOIN relation ON sales_in_weather.store_nbr = relation.store_nbr
WHERE relation.station_nbr = 17 
  AND SUBSTR(sales_in_weather.date, 1, 7) = '2012-10' 
  AND sales_in_weather.item_nbr = 45
GROUP BY store_nbr
ORDER BY total_units DESC
LIMIT 1;
```
-------------------------8190 sample_num
```sql
SELECT DISTINCT siw.item_nbr
FROM sales_in_weather siw
JOIN relation r ON siw.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr
WHERE w.snowfall = (SELECT MAX(snowfall) FROM weather);
```
-------------------------8191 sample_num
```sql
SELECT r.station_nbr, MAX(s.units) AS max_units
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
GROUP BY r.station_nbr
ORDER BY max_units DESC
LIMIT 3;
```
-------------------------8192 sample_num
```sql
SELECT COUNT(DISTINCT r.store_nbr) 
FROM relation r 
JOIN weather w ON r.station_nbr = w.station_nbr 
WHERE w.heat = (SELECT MAX(heat) FROM weather);
```
-------------------------8193 sample_num
```sql
SELECT w.tmin 
FROM weather w 
JOIN relation r ON w.station_nbr = r.station_nbr 
WHERE r.store_nbr = 29 AND w.date = '2014-02-08';
```
-------------------------8194 sample_num
```sql
SELECT COUNT(DISTINCT r.station_nbr) 
FROM relation r
JOIN weather w ON r.station_nbr = w.station_nbr
WHERE w.date = '2014-02-18' 
AND w.stnpressure < 30 
AND r.station_nbr IN (
    SELECT station_nbr 
    FROM relation 
    GROUP BY station_nbr 
    HAVING COUNT(store_nbr) = 3
);
```
-------------------------8195 sample_num
```sql
SELECT r.station_nbr, AVG(w.tmax) AS avg_max_temp
FROM relation r
JOIN weather w ON r.station_nbr = w.station_nbr
WHERE w.date LIKE '2012-02%'
GROUP BY r.station_nbr
HAVING COUNT(DISTINCT r.store_nbr) = (
    SELECT MAX(store_count)
    FROM (
        SELECT COUNT(DISTINCT store_nbr) AS store_count
        FROM relation
        GROUP BY station_nbr
    ) AS store_counts
)
```
-------------------------8196 sample_num
```sql
SELECT 
    (SUM(CASE WHEN s.store_nbr = 10 THEN s.units ELSE 0 END) * 100.0 / SUM(s.units)) AS percentage
FROM 
    sales_in_weather s
JOIN 
    relation r ON s.store_nbr = r.store_nbr
WHERE 
    r.station_nbr = 12 
    AND s.item_nbr = 5 
    AND SUBSTR(s.date, 1, 4) = '2014';
```
-------------------------8197 sample_num
```sql
SELECT MAX(avgspeed) AS maximum_average_speed FROM weather;
```
-------------------------8198 sample_num
```sql
SELECT COUNT(DISTINCT w.date) AS days_with_snowfall_over_5_inches
FROM weather w
WHERE w.snowfall > 5;
```
-------------------------8199 sample_num
```sql
SELECT COUNT(*) 
FROM weather 
WHERE sunrise < TIME('05:00:00');
```
-------------------------8200 sample_num
```sql
SELECT MIN(dewpoint) AS minimum_dew_point FROM weather;
```
-------------------------8201 sample_num
```sql
SELECT MAX(tmax) AS max_temperature, MIN(tmin) AS min_temperature 
FROM weather 
WHERE station_nbr = 1 AND date = '2012-01-15';
```
-------------------------8202 sample_num
```sql
SELECT COUNT(DISTINCT r.station_nbr) AS station_count
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
WHERE s.item_nbr = 5 AND SUBSTRING(s.date, 1, 7) = '2014-01';
```
-------------------------8203 sample_num
```sql
SELECT MIN(w.tmin) AS lowest_minimum_temperature
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr
WHERE s.store_nbr = 16 AND SUBSTRING(w.date, 1, 7) = '2012-01';
```
-------------------------8204 sample_num
```sql
SELECT SUM(s.units) AS total_units_sold
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.item_nbr = 7 AND s.store_nbr = 7 AND w.snowfall < 5;
```
-------------------------8205 sample_num
```sql
SELECT SUM(s.units) AS total_units_sold
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.store_nbr = 9 AND w.snowfall > 0 AND w.snowfall IS NOT NULL;
```
-------------------------8206 sample_num
```sql
SELECT r.station_nbr, s.item_nbr
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
WHERE s.store_nbr = 17;
```
-------------------------8207 sample_num
```sql
SELECT DISTINCT sw.date
FROM sales_in_weather sw
JOIN relation r ON sw.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr
WHERE sw.store_nbr = 35 AND w.codesum LIKE '%HZ%';
```
-------------------------8208 sample_num
```sql
SELECT w.sealevel, w.avgspeed
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr
WHERE s.store_nbr IN (3, 4)
GROUP BY w.sealevel, w.avgspeed;
```
-------------------------8209 sample_num
```sql
SELECT item_nbr, MAX(units) AS max_units
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.store_nbr = 1 AND w.codesum LIKE '%RA%'
GROUP BY item_nbr
ORDER BY max_units DESC
LIMIT 1;
```
-------------------------8210 sample_num
```sql
SELECT MAX(w.tmax) / MIN(w.tmin) AS temperature_ratio
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.store_nbr = 11;
```
-------------------------8211 sample_num
```sql
SELECT 
    (SUM(CASE WHEN r.station_nbr = 1 THEN s.units ELSE 0 END) - 
     SUM(CASE WHEN r.station_nbr = 2 THEN s.units ELSE 0 END)) AS units_difference
FROM 
    sales_in_weather s
JOIN 
    relation r ON s.store_nbr = r.store_nbr
WHERE 
    SUBSTRING(s.date, 1, 4) = '2012';
```
-------------------------8212 sample_num
```sql
SELECT 
    ABS(
        (SELECT tavg FROM weather w 
         JOIN relation r ON w.station_nbr = r.station_nbr 
         WHERE r.store_nbr = 18 AND w.date = '2022-09-16') - 
        (SELECT tavg FROM weather w 
         JOIN relation r ON w.station_nbr = r.station_nbr 
         WHERE r.store_nbr = 19 AND w.date = '2022-09-16')
    ) AS average_temperature_difference;
```
-------------------------8213 sample_num
```sql
SELECT SUM(s.units) AS total_units
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.item_nbr = 1 AND w.tavg = 83;
```
-------------------------8214 sample_num
```sql
SELECT 
    SUM(CASE WHEN w.sunset = (SELECT MIN(sunset) FROM weather) THEN s.units ELSE 0 END) -
    SUM(CASE WHEN w.sunset = (SELECT MAX(sunset) FROM weather) THEN s.units ELSE 0 END) AS unit_difference
FROM 
    sales_in_weather s
JOIN 
    relation r ON s.store_nbr = r.store_nbr
JOIN 
    weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE 
    s.item_nbr = 1;
```
-------------------------8215 sample_num
```sql
SELECT SUM(s.units) AS total_units
FROM sales_in_weather s
JOIN relation r ON s.store_nbr = r.store_nbr
JOIN weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE s.item_nbr = 10 AND w.tavg < (SELECT AVG(tavg) FROM weather);
```
-------------------------8216 sample_num
```sql
SELECT 
    (SUM(CASE WHEN r.store_nbr = 6 THEN w.tavg END) / COUNT(CASE WHEN r.store_nbr = 6 THEN w.date END)) - 
    (SUM(CASE WHEN r.store_nbr = 7 THEN w.tavg END) / COUNT(CASE WHEN r.store_nbr = 7 THEN w.date END)) AS avg_temp_difference
FROM 
    sales_in_weather s
JOIN 
    relation r ON s.store_nbr = r.store_nbr
JOIN 
    weather w ON r.station_nbr = w.station_nbr AND s.date = w.date
WHERE 
    SUBSTR(s.date, 1, 7) = '2012-05' AND (r.store_nbr = 6 OR r.store_nbr = 7);
```
-------------------------8217 sample_num
```sql
SELECT Country 
FROM language 
WHERE Name = 'Polish' 
ORDER BY Percentage ASC 
LIMIT 1;
```
-------------------------8218 sample_num
```sql
SELECT Country 
FROM ethnicGroup 
WHERE Name = 'African' AND Percentage > 90;
```
-------------------------8219 sample_num
```sql
SELECT e.Name AS EthnicGroup, e.Percentage AS EthnicPercentage, l.Name AS Language, l.Percentage AS LanguagePercentage
FROM ethnicGroup e
JOIN language l ON e.Country = l.Country
WHERE e.Country = 'Singapore';
```
-------------------------8220 sample_num
```sql
SELECT COUNT(*) * 100.0 / (SELECT COUNT(*) FROM country) AS Independence_Percentage
FROM politics
WHERE Independence = 'Yes' AND Government = 'Republic' AND YEAR(Independence_Date) > 1970;
```
-------------------------8221 sample_num
```sql
SELECT e.GDP, p.Government 
FROM economy e 
JOIN politics p ON e.Country = p.Country 
WHERE e.Country = 'Bosnia and Herzegovina';
```
-------------------------8222 sample_num
```sql
SELECT country.Name, population.Population
FROM country
JOIN population ON country.Name = population.Country
WHERE population.Population_Growth > 2 AND population.Infant_Mortality < 5;
```
-------------------------8223 sample_num
```sql
SELECT e.Name, e.Percentage
FROM ethnicGroup e
JOIN country c ON e.Country = c.Name
WHERE c.Population > 10000000
AND e.Percentage = (
    SELECT MAX(Percentage)
    FROM ethnicGroup
    WHERE Country = c.Name
);
```
-------------------------8224 sample_num
```sql
SELECT c.Name AS Country, eg.Name AS EthnicGroup, eg.Percentage
FROM country c
JOIN ethnicGroup eg ON c.Name = eg.Country
WHERE eg.Percentage = (
    SELECT MAX(ethnic_count)
    FROM (
        SELECT Country, COUNT(*) AS ethnic_count
        FROM ethnicGroup
        GROUP BY Country
    ) AS counts
)
ORDER BY eg.Percentage DESC;
```
-------------------------8225 sample_num
```sql
SELECT country.Name 
FROM country 
JOIN ethnicGroup ON country.Name = ethnicGroup.Country 
WHERE ethnicGroup.Percentage = 100 AND ethnicGroup.Name = 'Africans';
```
-------------------------8226 sample_num
```sql
SELECT p.Infant_Mortality
FROM population p
JOIN ethnicGroup e ON p.Country = e.Country
WHERE e.Name = 'Amerindian'
ORDER BY e.Percentage ASC
LIMIT 1;
```
-------------------------8227 sample_num
```sql
SELECT economy.Agriculture / economy.GDP * 100 AS Agriculture_Percentage
FROM country
JOIN economy ON country.Name = economy.Country
WHERE country.Area > 600000;
```
-------------------------8228 sample_num
```sql
SELECT p.Country
FROM politics p
JOIN population pop ON p.Country = pop.Country
WHERE p.Government = 'Republic'
ORDER BY pop.Population_Growth DESC
LIMIT 1;
```
-------------------------8229 sample_num
```sql
SELECT Independence FROM politics WHERE Country = 'Bulgaria';
```
-------------------------8230 sample_num
```sql
SELECT e.Country, 
       (e.Percentage * c.Population) / 100 AS Arab_Population
FROM ethnicGroup e
JOIN country c ON e.Country = c.Name
WHERE e.Name = 'Arab';
```
-------------------------8231 sample_num
```sql
SELECT (e.Percentage * c.Population) AS African_Population
FROM ethnicGroup e
JOIN country c ON e.Country = c.Name
WHERE e.Name = 'African' AND c.Name = 'Turks and Caicos Islands';
```
-------------------------8232 sample_num
```sql
SELECT 
    p.Population_Growth * c.Population AS Growth_Population
FROM 
    population p
JOIN 
    country c ON p.Country = c.Name
WHERE 
    p.Infant_Mortality = (SELECT MIN(Infant_Mortality) FROM population);
```
-------------------------8233 sample_num
```sql
SELECT Capital, Population 
FROM country 
WHERE GDP > 400000;
```
-------------------------8234 sample_num
```sql
SELECT Economy.Service * Economy.GDP AS Service_GDP
FROM economy AS Economy
JOIN country AS Country ON Economy.Country = Country.Name
WHERE Country.Name = 'Brazil';
```
-------------------------8235 sample_num
```sql
SELECT Country, Population_Growth 
FROM population 
WHERE Infant_Mortality = (SELECT MAX(Infant_Mortality) FROM population);
```
-------------------------8236 sample_num
```sql
SELECT Country, Population, Population_Growth 
FROM population 
WHERE Population_Growth < 0;
```
-------------------------8237 sample_num
```sql
SELECT country.Name, population.Infant_Mortality
FROM country
JOIN population ON country.Name = population.Country
WHERE country.Area BETWEEN 500000 AND 1000000;
```
-------------------------8238 sample_num
```sql
SELECT country.Name, economy.GDP
FROM country
JOIN population ON country.Name = population.Country
JOIN economy ON country.Name = economy.Country
WHERE population.Population_Growth > 3;
```
-------------------------8239 sample_num
```sql
SELECT Infant_Mortality FROM population WHERE Country = 'Ethiopia';
```
-------------------------8240 sample_num
```sql
SELECT GDP * Industry AS Industry_GDP
FROM economy
WHERE Country = 'Singapore';
```
-------------------------8241 sample_num
```sql
SELECT GDP, Agriculture 
FROM economy 
WHERE Country = (SELECT Name 
                 FROM country 
                 ORDER BY Area 
                 LIMIT 1);
```
-------------------------8242 sample_num
```sql
SELECT Country, Percentage 
FROM ethnicGroup 
WHERE Name = 'Albanian' 
ORDER BY Percentage DESC 
LIMIT 1;
```
-------------------------8243 sample_num
```sql
SELECT COUNT(*) 
FROM country 
WHERE Population > 10000000 
AND Name IN (SELECT Country FROM ethnicGroup WHERE Name = 'African');
```
-------------------------8244 sample_num
```sql
SELECT Country
FROM ethnicGroup
GROUP BY Country
HAVING COUNT(Name) > 5;
```
-------------------------8245 sample_num
```sql
SELECT Country, GDP 
FROM economy 
ORDER BY GDP DESC 
LIMIT 1;
```
-------------------------8246 sample_num
```sql
SELECT COUNT(*) 
FROM country c 
JOIN economy e ON c.Name = e.Country 
WHERE c.Population > 10000000 AND e.GDP > 500000;
```
-------------------------8247 sample_num
```sql
SELECT city.Name 
FROM city 
JOIN economy ON city.Country = economy.Country 
WHERE economy.Inflation < 2 AND city.Name = (SELECT country.Capital FROM country WHERE country.Name = city.Country);
```
-------------------------8248 sample_num
```sql
SELECT Country FROM economy ORDER BY Inflation ASC LIMIT 1;
```
-------------------------8249 sample_num
```sql
SELECT COUNT(*) 
FROM country 
WHERE Area > 8000000 
AND Name IN (
    SELECT Country 
    FROM economy 
    WHERE Agriculture < 50
);
```
-------------------------8250 sample_num
```sql
SELECT COUNT(DISTINCT l.City) AS CityCount
FROM located l
JOIN lake la ON l.Lake = la.Name
WHERE la.Type = 'Salt Lake';
```
-------------------------8251 sample_num
```sql
SELECT l.Depth 
FROM lake l 
JOIN located loc ON l.Name = loc.Lake 
WHERE loc.Province = 'Albania';
```
-------------------------8252 sample_num
```sql
SELECT c.Name AS City
FROM lake l
JOIN located loc ON l.Name = loc.Lake
JOIN city c ON loc.City = c.Name
WHERE l.Altitude = (SELECT MAX(Altitude) FROM lake);
```
-------------------------8253 sample_num
```sql
SELECT COUNT(*) 
FROM lake 
WHERE Area > 1000000 AND Name IN (SELECT Lake FROM located WHERE Province = 'Canary Islands');
```
-------------------------8254 sample_num
```sql
SELECT Country, COUNT(Name) AS LanguageCount
FROM language
GROUP BY Country
ORDER BY LanguageCount DESC
LIMIT 1;
```
-------------------------8255 sample_num
```sql
SELECT country.Capital 
FROM country 
JOIN language ON country.Name = language.Country 
WHERE language.Name = 'Armenian' AND language.Percentage > 90;
```
-------------------------8256 sample_num
```sql
SELECT COUNT(DISTINCT Country) 
FROM language 
WHERE Country IN (SELECT Name FROM country WHERE Population < 1000000) 
GROUP BY Country 
HAVING COUNT(Name) > 2;
```
-------------------------8257 sample_num
```sql
SELECT COUNT(*) 
FROM organization o 
JOIN country c ON o.Country = c.Name 
WHERE c.Population < 1000000;
```
-------------------------8258 sample_num
```sql
SELECT COUNT(*) 
FROM organization o 
JOIN economy e ON o.Country = e.Country 
WHERE o.Established > '1999-01-01' AND e.GDP < 500000;
```
-------------------------8259 sample_num
```sql
SELECT COUNT(DISTINCT im.Country) 
FROM isMember im 
JOIN economy e ON im.Country = e.Country 
GROUP BY im.Country 
HAVING COUNT(im.Organization) > 3 AND e.Inflation > 5;
```
-------------------------8260 sample_num
```sql
SELECT COUNT(*) 
FROM organization 
WHERE Country = (
    SELECT Country 
    FROM ethnicGroup 
    GROUP BY Country 
    ORDER BY COUNT(*) DESC 
    LIMIT 1
);
```
-------------------------8261 sample_num
```sql
SELECT DISTINCT o.Name
FROM organization o
JOIN language l ON o.Country = l.Country
WHERE l.Name = 'Dutch';
```
-------------------------8262 sample_num
```sql
SELECT COUNT(*) 
FROM organization 
WHERE Country IN (
    SELECT Country 
    FROM language 
    WHERE Name = 'Bosnian'
);
```
-------------------------8263 sample_num
```sql
SELECT MAX(Infant_Mortality) AS Highest_Infant_Mortality
FROM population p
JOIN economy e ON p.Country = e.Country
WHERE e.Inflation < 3;
```
-------------------------8264 sample_num
```sql
SELECT COUNT(*) 
FROM economy e 
JOIN population p ON e.Country = p.Country 
WHERE e.GDP > 1000000 AND p.Population_Growth > 3;
```
-------------------------8265 sample_num
```sql
SELECT Country, (GDP / Population) AS GDP_per_capita
FROM economy e
JOIN population p ON e.Country = p.Country
ORDER BY GDP_per_capita DESC
LIMIT 1;
```
-------------------------8266 sample_num
```sql
SELECT c.Name AS Country, 
       (SUM(l.Area) / c.Area) * 100 AS Lake_Area_Coverage
FROM country c
JOIN lake l ON c.Name = l.River
GROUP BY c.Name
ORDER BY Lake_Area_Coverage DESC
LIMIT 1;
```
-------------------------8267 sample_num
```sql
SELECT AVG(p.Population_Growth) AS Average_Population_Growth
FROM population p
JOIN (
    SELECT Country
    FROM language
    GROUP BY Country
    HAVING COUNT(Name) > 3
) AS lang_countries ON p.Country = lang_countries.Country;
```
-------------------------8268 sample_num
```sql
SELECT Country 
FROM economy 
WHERE Inflation > 1.3 * (SELECT AVG(Inflation) FROM economy);
```
-------------------------8269 sample_num
```sql
SELECT Country FROM city WHERE Name = 'Baghdad';
```
-------------------------8270 sample_num
```sql
SELECT Name, Percentage 
FROM religion 
WHERE Country = 'Martinique' 
ORDER BY Percentage DESC 
LIMIT 1;
```
-------------------------8271 sample_num
```sql
SELECT Country FROM religion WHERE Name = 'Christian' AND Percentage = 41;
```
-------------------------8272 sample_num
```sql
SELECT DISTINCT country.Name
FROM river
JOIN geo_river ON river.Name = geo_river.River
JOIN country ON geo_river.Country = country.Code
WHERE river.Name = 'Detroit River';
```
-------------------------8273 sample_num
```sql
SELECT Country1, Country2 
FROM borders 
ORDER BY Length DESC 
LIMIT 1;
```
-------------------------8274 sample_num
```sql
SELECT Country1 AS Country
FROM borders
GROUP BY Country1
ORDER BY COUNT(Country2) DESC
LIMIT 1;
```
-------------------------8275 sample_num
```sql
SELECT Country FROM geo_mountain WHERE Mountain = 'Cerro Chirripo';
```
-------------------------8276 sample_num
```sql
SELECT COUNT(*) 
FROM geo_mountain 
WHERE Country = 'Indonesia';
```
-------------------------8277 sample_num
```sql
SELECT COUNT(*) AS MountainCount 
FROM geo_mountain 
WHERE Country = 'Japan';
```
-------------------------8278 sample_num
```sql
SELECT i.Latitude 
FROM island i 
JOIN mountainOnIsland moi ON i.Name = moi.Island 
JOIN mountain m ON moi.Mountain = m.Name 
WHERE m.Name = 'Andrinjitra';
```
-------------------------8279 sample_num
```sql
SELECT c1.Code, c2.Code
FROM mountain m
JOIN geo_mountain gm ON m.Name = gm.Mountain
JOIN country c1 ON gm.Country = c1.Name
JOIN borders b ON b.Country1 = c1.Name OR b.Country2 = c1.Name
JOIN country c2 ON (b.Country1 = c2.Name OR b.Country2 = c2.Name) AND c1.Name <> c2.Name
WHERE m.Height = (SELECT DISTINCT Height FROM mountain ORDER BY Height DESC LIMIT 1 OFFSET 1);
```
-------------------------8280 sample_num
```sql
SELECT (c.Area / SUM(co.Area) * 100) AS Egypt_Area_Percentage
FROM country c
JOIN encompasses e ON c.Name = e.Country
JOIN continent co ON e.Continent = co.Name
WHERE c.Name = 'Egypt' AND co.Name = 'Asia';
```
-------------------------8281 sample_num
```sql
SELECT (c.Area / SUM(co.Area) * 100) AS Egypt_Area_Percentage
FROM country c
JOIN encompasses e ON c.Name = e.Country
JOIN continent co ON e.Continent = co.Name
WHERE c.Name = 'Egypt' AND co.Name = 'Asia';
```
-------------------------8282 sample_num
```sql
SELECT Name 
FROM city 
WHERE Country = 'Japan' 
ORDER BY Population DESC 
LIMIT 1;
```
-------------------------8283 sample_num
```sql
SELECT Capital FROM country WHERE Name = (SELECT Country FROM city WHERE Name = 'Olsztyn');
```
-------------------------8284 sample_num
```sql
SELECT Province 
FROM geo_mountain 
WHERE Height = (SELECT MAX(Height) FROM geo_mountain);
```
-------------------------8285 sample_num
```sql
SELECT Independence FROM politics WHERE Country = 'Uganda';
```
-------------------------8286 sample_num
```sql
SELECT Government FROM politics WHERE Country = 'Iran';
```
-------------------------8287 sample_num
```sql
SELECT Name FROM country WHERE Name = 'Bermuda';
```
-------------------------8288 sample_num
```sql
SELECT c.Capital 
FROM country c 
JOIN ethnicGroup e ON c.Name = e.Country 
WHERE e.Name = 'Malay' 
ORDER BY e.Percentage DESC 
LIMIT 1;
```
-------------------------8289 sample_num
```sql
SELECT Name, Percentage 
FROM ethnicGroup 
WHERE Country = (SELECT Name 
                 FROM country 
                 ORDER BY Population DESC 
                 LIMIT 1 OFFSET 2) 
ORDER BY Percentage DESC 
LIMIT 1;
```
-------------------------8290 sample_num
```sql
SELECT country.Name 
FROM country 
JOIN city ON city.Country = country.Name 
WHERE city.Population = 114339;
```
-------------------------8291 sample_num
```sql
SELECT COUNT(*) 
FROM river r 
JOIN sea s ON r.Sea = s.Name 
WHERE s.Depth = 459;
```
-------------------------8292 sample_num
```sql
SELECT Area FROM country WHERE Name = (SELECT Country FROM politics WHERE Independence = '1921-03-13');
```
-------------------------8293 sample_num
```sql
SELECT (c.Population / c.Area) AS PopulationDensity
FROM country c
JOIN city ci ON c.Name = ci.Country
WHERE ci.Name = 'Petropavl';
```
-------------------------8294 sample_num
```sql
SELECT 
    (SELECT Percentage FROM language WHERE Country = 'United Kingdom' AND Name = 'English') -
    (SELECT Percentage FROM language WHERE Country = 'United Kingdom' AND Name = 'Scottish') AS Difference
```
-------------------------8295 sample_num
```sql
SELECT c.Name
FROM city c
JOIN country co ON c.Country = co.Name
WHERE co.Population / co.Area = (
    SELECT DISTINCT Population / Area
    FROM country
    ORDER BY Population / Area DESC
    LIMIT 1 OFFSET 11
)
ORDER BY c.Population DESC
LIMIT 1;
```
-------------------------8296 sample_num
```sql
SELECT 
    (SELECT MAX(Length) FROM borders WHERE Country1 = 'United States' OR Country2 = 'United States') / 
    (SELECT MIN(Length) FROM borders WHERE Country1 = 'United States' OR Country2 = 'United States') AS times_longer;
```
-------------------------8297 sample_num
```sql
SELECT DISTINCT c.Capital
FROM country c
JOIN geo_mountain gm ON c.Name = gm.Country
GROUP BY c.Name
HAVING COUNT(gm.Mountain) > 4;
```
-------------------------8298 sample_num
```sql
SELECT COUNT(*) 
FROM geo_mountain 
WHERE Country = (SELECT Name 
                 FROM country 
                 ORDER BY Population DESC 
                 LIMIT 1);
```
-------------------------8299 sample_num
```sql
SELECT COUNT(DISTINCT c.Name) 
FROM economy e 
JOIN country c ON e.Country = c.Name 
LEFT JOIN geo_mountain gm ON c.Name = gm.Country 
WHERE e.Agriculture > 40 AND (SELECT COUNT(*) FROM geo_mountain WHERE Country = c.Name) < 2;
```
-------------------------8300 sample_num
```sql
SELECT m.Name
FROM mountain m
JOIN economy e ON m.Country = e.Country
WHERE e.Inflation = (SELECT MIN(Inflation) FROM economy);
```
-------------------------8301 sample_num
```sql
SELECT MAX(desert_count) AS max_deserts
FROM (
    SELECT p.Country, COUNT(gd.Desert) AS desert_count
    FROM politics p
    JOIN geo_desert gd ON p.Country = gd.Country
    WHERE p.Independence = 'Yes' AND p.Government = 'Republic'
    GROUP BY p.Country
) AS desert_counts;
```
-------------------------8302 sample_num
```sql
SELECT d.Name
FROM desert d
JOIN country c ON d.Country = c.Name
WHERE c.Population > 100000 AND c.Area < 500000;
```
-------------------------8303 sample_num
```sql
SELECT COUNT(*) 
FROM desert d 
WHERE d.Country IN (
    SELECT l.Country 
    FROM language l 
    WHERE l.Name = 'Armenian' AND l.Percentage > 90
);
```
-------------------------8304 sample_num
```sql
SELECT m.Name, m.Height, c.Name AS Country
FROM mountain m
JOIN country c ON m.Country = c.Name
JOIN politics p ON c.Name = p.Country
WHERE p.Independence = 'Yes'
ORDER BY m.Height DESC
LIMIT 1;
```
-------------------------8305 sample_num
```sql
SELECT COUNT(*) 
FROM mountain 
WHERE Type = 'Volcanic' 
AND Name IN (
    SELECT Name 
    FROM country 
    WHERE Population <= 5000000
);
```
-------------------------8306 sample_num
```sql
SELECT COUNT(DISTINCT c.Name) 
FROM economy e 
JOIN geo_mountain m ON e.Country = m.Country 
JOIN country c ON e.Country = c.Name 
WHERE e.GDP > 1000000 AND m.Height > 1000;
```
-------------------------8307 sample_num
```sql
SELECT MAX(b.Length) AS Greatest_Border_Length
FROM borders b
JOIN politics p1 ON b.Country1 = p1.Country AND p1.Independent = 'Yes'
JOIN politics p2 ON b.Country2 = p2.Country AND p2.Independent = 'Yes';
```
-------------------------8308 sample_num
```sql
SELECT COUNT(DISTINCT b.Country1) AS RepublicBorderCount
FROM politics p
JOIN borders b ON p.Country = b.Country1 OR p.Country = b.Country2
WHERE p.Government = 'Republic' AND b.Length > 200;
```
-------------------------8309 sample_num
```sql
SELECT Country1, Country2, Length
FROM borders
WHERE Length = (SELECT MIN(Length) FROM borders);
```
-------------------------8310 sample_num
```sql
SELECT AVG(GDP) AS Average_GDP
FROM economy e
JOIN encompasses en ON e.Country = en.Country
WHERE en.Continent = 'Europe';
```
-------------------------8311 sample_num
```sql
SELECT COUNT(*) 
FROM geo_mountain gm 
JOIN encompasses e ON gm.Country = e.Country 
WHERE e.Continent = 'Africa';
```
-------------------------8312 sample_num
```sql
SELECT d.Name, d.Area
FROM desert d
JOIN encompasses e ON d.Country = e.Country
WHERE e.Continent = 'America'
ORDER BY d.Area DESC
LIMIT 1;
```
-------------------------8313 sample_num
```sql
SELECT c.Name 
FROM country c 
JOIN encompasses e ON c.Name = e.Country 
JOIN population p ON c.Name = p.Country 
WHERE e.Continent = 'Europe' AND p.Population_Growth > 3;
```
-------------------------8314 sample_num
```sql
SELECT COUNT(DISTINCT c.Name) AS CountryCount
FROM country c
JOIN politics p ON c.Name = p.Country
JOIN encompasses e ON c.Name = e.Country
WHERE e.Continent = 'Europe' AND p.Infant_Mortality > 100;
```
-------------------------8315 sample_num
```sql
SELECT COUNT(DISTINCT l.Country) 
FROM language l 
JOIN population p ON l.Country = p.Country 
WHERE l.Name = 'Bosnian' AND p.Population_Growth <= 0;
```
-------------------------8316 sample_num
```sql
SELECT AVG(Agriculture / GDP * 100) AS Average_Agriculture_Percentage
FROM economy e
JOIN country c ON e.Country = c.Name
JOIN encompasses en ON c.Name = en.Country
WHERE en.Continent = 'Africa';
```
-------------------------8317 sample_num
```sql
SELECT COUNT(*) 
FROM economy e
JOIN politics p ON e.Country = p.Country
WHERE p.Independence = 'Yes' AND (e.GDP / (SELECT Population FROM country WHERE Name = e.Country)) > 5000;
```
-------------------------8318 sample_num
```sql
SELECT AVG(e.Inflation) AS Average_Inflation
FROM economy e
JOIN encompasses en ON e.Country = en.Country
JOIN continent c ON en.Continent = c.Name
WHERE c.Area = (SELECT MAX(Area) FROM continent);
```
-------------------------8319 sample_num
```sql
SELECT i.Name, i.Area
FROM city c
JOIN locatedOn lo ON c.Name = lo.City
JOIN island i ON lo.Island = i.Name
WHERE c.Name = 'Balikpapan';
```
-------------------------8320 sample_num
```sql
SELECT c.Name, c.Population 
FROM city c 
JOIN locatedOn lo ON c.Name = lo.City 
WHERE lo.Island = 'Sumatra';
```
-------------------------8321 sample_num
```sql
SELECT i.Name, i.Longitude, i.Latitude
FROM island i
JOIN locatedOn lo ON i.Name = lo.Island
JOIN city c ON lo.City = c.Name AND lo.Province = c.Province
WHERE c.Province = 'South Yorkshire';
```
-------------------------8322 sample_num
```sql
SELECT i.Name
FROM island i
JOIN islandIn ii ON i.Name = ii.Island
JOIN located l ON ii.Island = l.City
WHERE l.Province = 'Warwickshire' AND i.Area > (SELECT Area FROM island WHERE Name = (SELECT DISTINCT Island FROM located WHERE Province = 'Warwickshire'));
```
-------------------------8323 sample_num
```sql
SELECT i.Name AS IslandName, l.City AS City
FROM island i
JOIN locatedOn lo ON i.Name = lo.Island
JOIN city l ON lo.City = l.Name AND lo.Province = l.Province AND lo.Country = l.Country
WHERE i.Area < 200;
```
-------------------------8324 sample_num
```sql
SELECT p.Name AS Province, p.Capital 
FROM city c 
JOIN province p ON c.Province = p.Name 
WHERE c.Name = 'Glenrothes';
```
-------------------------8325 sample_num
```sql
SELECT city.Name, city.Population
FROM city
JOIN province ON city.Province = province.Name
WHERE province.Population > 1000000;
```
-------------------------8326 sample_num
```sql
SELECT island.Name AS Coral_Island, located.City, located.Province
FROM island
JOIN islandIn ON island.Name = islandIn.Island
JOIN geo_sea ON islandIn.Sea = geo_sea.Name
JOIN located ON located.Island = island.Name
WHERE island.Type = 'Coral';
```
-------------------------8327 sample_num
```sql
SELECT AVG(c.Population) AS AveragePopulation
FROM city c
JOIN located l ON c.Name = l.City AND c.Province = l.Province AND c.Country = l.Country
JOIN geo_sea gs ON l.Sea = gs.Name
WHERE gs.Name = 'Baltic Sea';
```
-------------------------8328 sample_num
```sql
SELECT (c.Population / p.Population) * 100 AS Population_Percentage
FROM city c
JOIN province p ON c.Province = p.Name
WHERE c.Name = 'Edmonton';
```
-------------------------8329 sample_num
```sql
SELECT r.Name 
FROM river r 
JOIN geo_sea gs ON r.Sea = gs.Name 
WHERE gs.Name = 'Black Sea';
```
-------------------------8330 sample_num
```sql
SELECT l.Name AS LakeName, c.Name AS CityName
FROM lake l
JOIN located loc ON l.Name = loc.Lake
JOIN city c ON loc.City = c.Name
WHERE c.Province = 'Albania';
```
-------------------------8331 sample_num
```sql
SELECT Name, Height 
FROM mountain 
WHERE Type = 'Himalaya' 
ORDER BY Height DESC 
LIMIT 1;
```
-------------------------8332 sample_num
```sql
SELECT Name, Longitude, Latitude 
FROM mountain 
WHERE Type = 'Volcanic';
```
-------------------------8333 sample_num
```sql
SELECT Name FROM mountain WHERE Height BETWEEN 2000 AND 4000 AND Type = 'Volcano';
```
-------------------------8334 sample_num
```sql
SELECT r.Name
FROM river r
JOIN geo_sea gs ON r.Sea = gs.Name
WHERE gs.Name = 'Mediterranean Sea'
ORDER BY r.Length DESC
LIMIT 1;
```
-------------------------8335 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Type != 'volcano' THEN 1 END) * 100.0 / COUNT(*)) AS Percent_Non_Volcanic
FROM 
    mountain
WHERE 
    Mountains = 'Andes';
```
-------------------------8336 sample_num
```sql
SELECT DISTINCT c.Name AS City, c.Province
FROM city c
JOIN located l ON c.Name = l.City AND c.Province = l.Province AND c.Country = l.Country
JOIN river r ON l.River = r.Name
JOIN geo_sea gs ON r.Sea = gs.Name
WHERE gs.Name = 'Atlantic Ocean';
```
-------------------------8337 sample_num
```sql
SELECT r.Name, r.Length
FROM river r
JOIN located l ON r.Name = l.River
WHERE l.City = 'Orleans';
```
-------------------------8338 sample_num
```sql
SELECT m.Height, m.Longitude, m.Latitude
FROM mountain m
JOIN river r ON r.Mountains = m.Name
WHERE r.Name = 'Lech';
```
-------------------------8339 sample_num
```sql
SELECT r.Name AS River, m.Name AS Mountain
FROM located l
JOIN river r ON l.River = r.Name
JOIN geo_source gs ON r.Name = gs.River
JOIN mountain m ON gs.Country = m.Country
WHERE l.Province = 'Lorraine';
```
-------------------------8340 sample_num
```sql
SELECT m.Name, m.Height
FROM geo_source gs
JOIN river r ON gs.River = r.Name
JOIN mountainOnIsland moi ON r.SourceLongitude = moi.Mountain
JOIN mountain m ON moi.Mountain = m.Name
WHERE r.Name = 'Blue Nile';
```
-------------------------8341 sample_num
```sql
SELECT r.Name, r.Length 
FROM river r 
JOIN located l ON r.Name = l.River 
WHERE l.City = 'Little Rock';
```
-------------------------8342 sample_num
```sql
SELECT Name, Province 
FROM river 
WHERE Length > 1000;
```
-------------------------8343 sample_num
```sql
SELECT Province, Country, Height 
FROM geo_mountain 
WHERE Mountain = 'Moldoveanu';
```
-------------------------8344 sample_num
```sql
SELECT Name, Length FROM river WHERE Country = 'USA';
```
-------------------------8345 sample_num
```sql
SELECT AVG(Height) AS Average_Height
FROM mountain
WHERE Country = 'Nepal';
```
-------------------------8346 sample_num
```sql
SELECT MAX(Population) - MIN(Population) AS Population_Difference
FROM city
WHERE Country IN (
    SELECT Country
    FROM located
    WHERE River = 'Seine'
);
```
-------------------------8347 sample_num
```sql
SELECT r.Name, r.Length
FROM river r
JOIN located l ON r.Name = l.River
WHERE l.City = 'Belgrade';
```
-------------------------8348 sample_num
```sql
SELECT Country 
FROM language 
WHERE Name = 'Spanish' AND Percentage = 100;
```
-------------------------8349 sample_num
```sql
SELECT Country 
FROM politics 
WHERE Dependent = 'British Crown';
```
-------------------------8350 sample_num
```sql
SELECT Name FROM river WHERE Country = 'Canada';
```
-------------------------8351 sample_num
```sql
SELECT Country 
FROM economy 
ORDER BY Inflation DESC 
LIMIT 1;
```
-------------------------8352 sample_num
```sql
SELECT Province, Population 
FROM city 
WHERE Country = 'United Kingdom' 
ORDER BY Population DESC 
LIMIT 1 OFFSET 3;
```
-------------------------8353 sample_num
```sql
SELECT (Population * (SELECT Percentage FROM ethnicGroup WHERE Country = 'Moldova' AND Name = 'Jewish')) AS Jewish_Residents
FROM country
WHERE Name = 'Moldova';
```
-------------------------8354 sample_num
```sql
SELECT AVG(Area) AS Average_Area
FROM country
WHERE Code IN (SELECT Country FROM encompasses WHERE Continent = 'Asia');
```
-------------------------8355 sample_num
```sql
SELECT d.Country, d.Longitude, d.Latitude
FROM desert d
WHERE d.Area = (SELECT MIN(Area) FROM desert);
```
-------------------------8356 sample_num
```sql
SELECT Percentage FROM language WHERE Country = 'Montenegro' AND Name = 'Serbian';
```
-------------------------8357 sample_num
```sql
SELECT COUNT(*) 
FROM geo_mountain 
WHERE Country = (SELECT Name 
                 FROM country 
                 ORDER BY Area DESC 
                 LIMIT 1);
```
-------------------------8358 sample_num
```sql
SELECT s.Name AS Sea, c.Name AS Country
FROM sea s
JOIN geo_sea gs ON s.Name = gs.Sea
JOIN country c ON gs.Country = c.Name
ORDER BY s.Depth ASC
LIMIT 1;
```
-------------------------8359 sample_num
```sql
SELECT e.Country, e.GDP
FROM economy e
JOIN politics p ON e.Country = p.Country
WHERE p.Government = 'Communist'
ORDER BY e.GDP ASC
LIMIT 1;
```
-------------------------8360 sample_num
```sql
SELECT p.Government
FROM economy e
JOIN politics p ON e.Country = p.Country
WHERE e.Inflation = (SELECT MAX(Inflation) FROM economy);
```
-------------------------8361 sample_num
```sql
SELECT Country, Infant_Mortality 
FROM population 
JOIN politics ON population.Country = politics.Country 
WHERE politics.Independence = 1960 
ORDER BY Infant_Mortality DESC 
LIMIT 1;
```
-------------------------8362 sample_num
```sql
SELECT b.Length, p1.Government AS Government1, p2.Government AS Government2
FROM borders b
JOIN politics p1 ON b.Country1 = p1.Country
JOIN politics p2 ON b.Country2 = p2.Country
WHERE b.Length = (SELECT MIN(Length) FROM borders);
```
-------------------------8363 sample_num
```sql
SELECT Name, Population 
FROM country 
WHERE Name IN (SELECT Country FROM language WHERE Name = 'Arabic' AND Percentage = 100) 
ORDER BY Population ASC 
LIMIT 1;
```
-------------------------8364 sample_num
```sql
SELECT geo_desert.Province
FROM desert
JOIN geo_desert ON desert.Name = geo_desert.Desert
WHERE desert.Area = (SELECT MAX(Area) FROM desert);
```
-------------------------8365 sample_num
```sql
SELECT COUNT(*) 
FROM lake 
WHERE Country = (
    SELECT Name 
    FROM country 
    WHERE Code IN (
        SELECT Country 
        FROM politics 
        WHERE Government = 'Republic' 
    ) 
    ORDER BY Population DESC 
    LIMIT 1 OFFSET 3
);
```
-------------------------8366 sample_num
```sql
SELECT r.Name, MAX(r.Percentage) AS Max_Percentage
FROM religion r
JOIN country c ON r.Country = c.Name
WHERE c.Province IN (SELECT DISTINCT Province FROM province WHERE Country IN (SELECT Name FROM continent WHERE Name = 'Asia'))
GROUP BY r.Name
ORDER BY Max_Percentage DESC
LIMIT 1;
```
-------------------------8367 sample_num
```sql
SELECT ABS(c1.Population - c2.Population) AS Population_Difference
FROM country c1
JOIN geo_mountain gm ON c1.Name = gm.Country
JOIN mountain m ON gm.Mountain = m.Name
JOIN country c2 ON c2.Name = (SELECT Country FROM geo_mountain WHERE Mountain = m.Name ORDER BY Height DESC LIMIT 1)
WHERE m.Height = (SELECT MAX(Height) FROM mountain);
```
-------------------------8368 sample_num
```sql
SELECT s.Name
FROM sea s
JOIN island i ON i.Name IN (SELECT ii.Island FROM islandIn ii WHERE ii.Sea = s.Name)
WHERE i.Area = (SELECT MAX(Area) FROM island);
```
-------------------------8369 sample_num
```sql
SELECT DISTINCT country.Name
FROM country
JOIN river ON country.Name = river.Name
WHERE river.Sea = 'Atlantic Ocean'
ORDER BY river.Length DESC
LIMIT 3;
```
-------------------------8370 sample_num
```sql
SELECT Population 
FROM city 
WHERE Name = (SELECT Capital 
              FROM country 
              WHERE Independence = '1947-08-15');
```
-------------------------8371 sample_num
```sql
SELECT SUM(ethnicGroup.Percentage * country.Population / 100) AS Total_Afro_Asian
FROM country
JOIN ethnicGroup ON country.Name = ethnicGroup.Country
WHERE country.Province = 'Asia'
AND country.Name = (
    SELECT Name
    FROM country
    WHERE Government = 'Monarchy'
    ORDER BY Population DESC
    LIMIT 1
)
AND ethnicGroup.Name = 'Afro-Asian';
```
-------------------------8372 sample_num
```sql
SELECT c.Name AS City, co.Capital AS CapitalCity
FROM geo_river gr
JOIN located l ON gr.River = l.River
JOIN city c ON l.City = c.Name
JOIN country co ON c.Country = co.Name
WHERE gr.River = 'Euphrat';
```
-------------------------8373 sample_num
```sql
SELECT 
    SUM(CASE WHEN l.Name = 'English' THEN c.Population * l.Percentage / 100 ELSE 0 END) AS English_Speaking_Population,
    SUM(c.Population) AS Total_Population,
    (SUM(CASE WHEN l.Name = 'English' THEN c.Population * l.Percentage / 100 ELSE 0 END) / SUM(c.Population)) AS Proportion_English_Speaking
FROM 
    country c
JOIN 
    isMember im ON c.Name = im.Country
JOIN 
    language l ON c.Name = l.Country
WHERE 
    im.Organization = 'United States';
```
-------------------------8374 sample_num
```sql
SELECT c.Name AS Country, 
       COUNT(p.Name) AS NumberOfProvinces, 
       e.Service AS ServiceGDPPercentage, 
       (c.Population / c.Area) AS PopulationDensity
FROM country c
JOIN province p ON c.Name = p.Country
JOIN economy e ON c.Name = e.Country
WHERE c.Government = 'Federal Republic' AND c.Continent = 'Europe'
GROUP BY c.Name, e.Service
ORDER BY NumberOfProvinces DESC
LIMIT 1;
```
-------------------------8375 sample_num
```sql
SELECT c.Capital, (CAST(ci.Population AS FLOAT) / co.Population) * 100 AS CapitalPopulationRatio
FROM country co
JOIN city ci ON co.Capital = ci.Name
WHERE co.Province IN (SELECT DISTINCT Province FROM country WHERE Continent = 'Asia')
ORDER BY co.Population DESC
LIMIT 1 OFFSET 2;
```
-------------------------8376 sample_num
```sql
SELECT Name 
FROM desert 
ORDER BY Area DESC 
LIMIT 1 OFFSET 1;
```
-------------------------8377 sample_num
```sql
SELECT Name 
FROM language 
WHERE Country = 'MNE' 
ORDER BY Percentage DESC 
LIMIT 1;
```
-------------------------8378 sample_num
```sql
SELECT Percentage FROM language WHERE Country = 'Cayman Islands' AND Name = 'English';
```
-------------------------8379 sample_num
```sql
SELECT Country FROM river WHERE Name = 'Pjandsh';
```
-------------------------8380 sample_num
```sql
SELECT Name 
FROM country 
WHERE Population > 1000000000 
ORDER BY (SELECT GDP FROM economy WHERE economy.Country = country.Name) ASC 
LIMIT 1;
```
-------------------------8381 sample_num
```sql
SELECT c.Capital 
FROM country c 
JOIN geo_mountain gm ON gm.Country = c.Name 
WHERE gm.Mountain = 'Licancabur';
```
-------------------------8382 sample_num
```sql
SELECT SUM(s.Depth) AS Total_Sea_Depth
FROM sea s
JOIN islandIn i ON s.Name = i.Sea
JOIN mountainOnIsland m ON i.Island = m.Island
JOIN mountain mt ON m.Mountain = mt.Name
WHERE mt.Name = 'Kerinci';
```
-------------------------8383 sample_num
```sql
SELECT DISTINCT country.Name
FROM river
JOIN country ON river.Country = country.Code
WHERE river.Name = 'Amazonas';
```
-------------------------8384 sample_num
```sql
SELECT Country FROM politics WHERE Independence = '1492-01-01';
```
-------------------------8385 sample_num
```sql
SELECT COUNT(*) 
FROM city 
WHERE Country = 'France' AND Population > 100000;
```
-------------------------8386 sample_num
```sql
SELECT r.Name, r.Length
FROM river r
JOIN sea s ON r.Sea = s.Name
WHERE s.Depth = 540
ORDER BY r.Length DESC
LIMIT 1;
```
-------------------------8387 sample_num
```sql
SELECT Code 
FROM country 
WHERE Name = (
    SELECT Country 
    FROM geo_mountain 
    ORDER BY Height DESC 
    LIMIT 1 OFFSET 1
);
```
-------------------------8388 sample_num
```sql
SELECT i.Longitude 
FROM mountain m 
JOIN mountainOnIsland mo ON m.Name = mo.Mountain 
JOIN island i ON mo.Island = i.Name 
WHERE m.Name = 'Mount Olympos';
```
-------------------------8389 sample_num
```sql
SELECT Country, GDP 
FROM economy 
WHERE Country IN (SELECT Name FROM country WHERE Area < 100) 
ORDER BY GDP DESC 
LIMIT 1;
```
-------------------------8390 sample_num
```sql
SELECT COUNT(*) AS Total_Cities FROM city WHERE Country = 'Japan';
```
-------------------------8391 sample_num
```sql
SELECT Name 
FROM city 
WHERE Country = 'Bangladesh' AND Name <> (SELECT Capital FROM country WHERE Name = 'Bangladesh') 
ORDER BY Population DESC 
LIMIT 1;
```
-------------------------8392 sample_num
```sql
SELECT Name, Population 
FROM city 
WHERE Name NOT IN (SELECT Capital FROM country) 
ORDER BY Population DESC 
LIMIT 1;
```
-------------------------8393 sample_num
```sql
SELECT country.Name 
FROM city 
JOIN country ON city.Country = country.Code 
WHERE city.Name = 'Grozny';
```
-------------------------8394 sample_num
```sql
SELECT Name 
FROM religion 
WHERE Country = 'Japan' 
ORDER BY Percentage DESC 
LIMIT 1;
```
-------------------------8395 sample_num
```sql
SELECT Country1, Country2 
FROM borders 
WHERE Length = 803;
```
-------------------------8396 sample_num
```sql
SELECT (SUM(CASE WHEN c.Name = 'Europe' THEN c.Area ELSE 0 END) / (SELECT Area FROM country WHERE Name = 'Russia')) * 100 AS Percentage
FROM continent c
JOIN encompasses e ON c.Name = e.Continent
WHERE e.Country = 'Russia';
```
-------------------------8397 sample_num
```sql
SELECT Country
FROM encompasses
GROUP BY Country
HAVING COUNT(DISTINCT Continent) > 1;
```
-------------------------8398 sample_num
```sql
SELECT Population FROM country WHERE Name = (SELECT Country FROM city WHERE Name = 'Fareham');
```
-------------------------8399 sample_num
```sql
SELECT Infant_Mortality * Population * Population_Growth AS Number_Infant_Mortality
FROM population
JOIN country ON population.Country = country.Name
WHERE country.Name = 'Switzerland';
```
-------------------------8400 sample_num
```sql
SELECT COUNT(*) FROM geo_mountain WHERE Country = 'United States';
```
-------------------------8401 sample_num
```sql
SELECT Independence FROM politics WHERE Country = 'Equatorial Guinea';
```
-------------------------8402 sample_num
```sql
SELECT economy.GDP / country.Population AS GDP_per_capita
FROM economy
JOIN country ON economy.Country = country.Name
WHERE country.Name = 'Switzerland';
```
-------------------------8403 sample_num
```sql
SELECT GDP, Service FROM economy WHERE Country = (SELECT Country FROM city WHERE Name = 'Fuenlabrada');
```
-------------------------8404 sample_num
```sql
SELECT 
    (SELECT MAX(Length) FROM river WHERE Country = 'TJ') / 
    (SELECT MIN(Length) FROM river WHERE Country = 'TJ') AS Ratio;
```
-------------------------8405 sample_num
```sql
SELECT c.Population / c.Area AS PopulationDensity
FROM country c
JOIN city ci ON c.Name = ci.Country
WHERE ci.Name = 'Hanoi';
```
-------------------------8406 sample_num
```sql
SELECT Country, Name, Percentage
FROM ethnicGroup
WHERE Country IN (
    SELECT Country
    FROM ethnicGroup
    GROUP BY Country
    HAVING COUNT(*) > 1
)
AND (Country, Percentage) IN (
    SELECT Country, MAX(Percentage)
    FROM ethnicGroup
    GROUP BY Country
);
```
-------------------------8407 sample_num
```sql
SELECT d.Name
FROM desert d
LEFT JOIN geo_desert gd ON d.Name = gd.Desert
GROUP BY d.Name
HAVING COUNT(DISTINCT gd.Country) < 2;
```
-------------------------8408 sample_num
```sql
SELECT geo_river.Province
FROM geo_river
JOIN river ON geo_river.River = river.Name
GROUP BY geo_river.River, geo_river.Province
HAVING COUNT(DISTINCT geo_river.Country) > 1;
```
-------------------------8409 sample_num
```sql
SELECT b.Country2, (b.Length / (SELECT SUM(Length) FROM borders WHERE Country1 = 'Angola')) * 100 AS Border_Percentage
FROM borders b
WHERE b.Country1 = 'Angola';
```
-------------------------8410 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Area <= 300 THEN 1 END) * 100.0 / COUNT(*)) AS Percent
FROM 
    island
WHERE 
    Type = 'Non Volcanic' AND 
    Islands IN (SELECT Name FROM island WHERE Name IN ('Lesser Antilles'));
```
-------------------------8411 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Percentage = 100 THEN Country END) * 100.0 / COUNT(DISTINCT Country)) AS English_Only_Percentage
FROM 
    language
WHERE 
    Name = 'English';
```
-------------------------8412 sample_num
```sql
SELECT Capital 
FROM country 
WHERE Population < (SELECT Population * 0.0005 FROM country ORDER BY Population DESC LIMIT 1);
```
-------------------------8413 sample_num
```sql
SELECT AVG(Length) AS Average_Length
FROM river
WHERE Name IN (
    SELECT River
    FROM geo_estuary
    WHERE River = 'Donau'
);
```
-------------------------8414 sample_num
```sql
SELECT (COUNT(CASE WHEN r.Name != 'Christian' THEN 1 END) * 100.0 / COUNT(*)) AS non_christian_percentage
FROM target t
JOIN religion r ON t.Country = r.Country;
```
-------------------------8415 sample_num
```sql
SELECT DISTINCT c.Name
FROM country c
JOIN city ci ON c.Name = ci.Country
JOIN isMember im ON c.Name = im.Country
JOIN organization o ON im.Organization = o.Name
WHERE ci.Population BETWEEN 50000 AND 300000
  AND o.Established BETWEEN '1991-03-01' AND '1991-04-30'
  AND im.Organization = 'EBRD';
```
-------------------------8416 sample_num
```sql
SELECT Name 
FROM river 
WHERE Length > 500 AND Lake = 'Donau' AND Country = 'Slovenia';
```
-------------------------8417 sample_num
```sql
SELECT located.City
FROM sea
JOIN located ON located.Sea = sea.Name
WHERE sea.Depth = (SELECT Depth - 4232 FROM sea WHERE Name = 'Bay of Bengal');
```
-------------------------8418 sample_num
```sql
SELECT located.City 
FROM located 
JOIN lake ON located.Lake = lake.Name 
WHERE lake.Longitude = -85.35 AND lake.Latitude = 11.6;
```
-------------------------8419 sample_num
```sql
SELECT e.Continent
FROM economy AS ec
JOIN encompasses AS e ON ec.Country = e.Country
ORDER BY ec.Inflation DESC
LIMIT 1;
```
-------------------------8420 sample_num
```sql
SELECT b.Country1, b.Country2 
FROM borders b 
JOIN country c1 ON b.Country1 = c1.Name 
JOIN country c2 ON b.Country2 = c2.Name 
WHERE b.Length = 1782 AND c1.Continent = 'Asia' AND c2.Continent = 'Asia';
```
-------------------------8421 sample_num
```sql
SELECT Name, Depth 
FROM lake 
WHERE Country = 'Bolivia' 
ORDER BY Depth DESC 
LIMIT 1;
```
-------------------------8422 sample_num
```sql
SELECT r.Lake
FROM river r
WHERE r.Name = 'Manicouagan';
```
-------------------------8423 sample_num
```sql
SELECT i.Islands 
FROM mountain m 
JOIN mountainOnIsland moi ON m.Name = moi.Mountain 
JOIN island i ON moi.Island = i.Name 
WHERE m.Name = 'Rinjani';
```
-------------------------8424 sample_num
```sql
SELECT DISTINCT m1.Name AS Sea1, m2.Name AS Sea2
FROM mergesWith
JOIN sea AS m1 ON mergesWith.Sea1 = m1.Name
JOIN sea AS m2 ON mergesWith.Sea2 = m2.Name
WHERE m1.Depth = (SELECT MAX(Depth) FROM sea);
```
-------------------------8425 sample_num
```sql
SELECT c.Name
FROM country c
JOIN encompasses e ON c.Name = e.Country
GROUP BY c.Name
HAVING COUNT(DISTINCT e.Continent) > 1 AND AVG(c.Population / c.Area) <= 10;
```
-------------------------8426 sample_num
```sql
SELECT Name, Population / Area AS PeoplePerSquareMeter
FROM country
WHERE Name IN (SELECT Country FROM religion WHERE Name = 'Hindu')
ORDER BY PeoplePerSquareMeter ASC
LIMIT 1;
```
-------------------------8427 sample_num
```sql
SELECT p.Independence
FROM economy e
JOIN politics p ON e.Country = p.Country
WHERE e.GDP > (SELECT GDP * 4 FROM economy WHERE Country = 'Saint Kitts and Nevis');
```
-------------------------8428 sample_num
```sql
SELECT AVG(population.Area / population.Population) AS average_population_ratio
FROM organization
JOIN country ON organization.Country = country.Name
JOIN population ON country.Name = population.Country
WHERE organization.Established = 1947;
```
-------------------------8429 sample_num
```sql
SELECT Capital, Province, Country FROM country WHERE Name = 'Anguilla';
```
-------------------------8430 sample_num
```sql
SELECT c.Name AS Country, c.Capital, ci.Province
FROM country c
JOIN city ci ON c.Capital = ci.Name
ORDER BY c.Population ASC
LIMIT 1;
```
-------------------------8431 sample_num
```sql
SELECT 
    (SELECT Area FROM continent WHERE Name = 'Asia') - 
    (SELECT Area FROM continent WHERE Name = 'Europe') AS SpaceDifference;
```
-------------------------8432 sample_num
```sql
SELECT Longitude, Latitude 
FROM city 
WHERE Name = 'Aarhus';
```
-------------------------8433 sample_num
```sql
SELECT 
    (SELECT Population FROM country WHERE Name = 'United Kingdom') - 
    (SELECT Population FROM country WHERE Name = 'Italy') AS Population_Gap;
```
-------------------------8434 sample_num
```sql
SELECT city.Name, city.Province
FROM city
JOIN organization ON city.Name = organization.City
WHERE organization.Name = 'European Bank for Reconstruction and Development';
```
-------------------------8435 sample_num
```sql
SELECT Name, Area, Depth 
FROM lake 
ORDER BY Area * Depth DESC 
LIMIT 1;
```
-------------------------8436 sample_num
```sql
SELECT Country1, Country2 
FROM borders 
ORDER BY Length DESC 
LIMIT 1;
```
-------------------------8437 sample_num
```sql
SELECT Name FROM country 
JOIN economy ON country.Name = economy.Country 
ORDER BY GDP DESC LIMIT 1;
```
-------------------------8438 sample_num
```sql
SELECT country.Name 
FROM country 
JOIN language ON country.Name = language.Country 
WHERE language.Percentage = (SELECT MIN(Percentage) FROM language WHERE Country IN (SELECT Name FROM country WHERE Code IN (SELECT DISTINCT Country FROM ethnicGroup WHERE Name LIKE '%African%')))
```
-------------------------8439 sample_num
```sql
SELECT country.Name
FROM country
JOIN religion ON country.Name = religion.Country
JOIN language ON country.Name = language.Country
WHERE religion.Name IN ('Anglicanism', 'Christianity', 'Roman Catholicism')
AND language.Name = 'English'
GROUP BY country.Name
HAVING COUNT(DISTINCT religion.Name) = 3;
```
-------------------------8440 sample_num
```sql
SELECT Country, Inflation 
FROM economy 
ORDER BY Inflation DESC 
LIMIT 3;
```
-------------------------8441 sample_num
```sql
SELECT DISTINCT country.Name
FROM country
JOIN language ON country.Name = language.Country
WHERE language.Name = 'English' AND language.Percentage = 100;
```
-------------------------8442 sample_num
```sql
SELECT COUNT(*) 
FROM organization 
WHERE Established > 1960 AND Country IN (SELECT Country FROM politics WHERE Independence = 'No');
```
-------------------------8443 sample_num
```sql
SELECT located.Province, river.Length
FROM river
JOIN located ON river.Name = located.River
WHERE river.Name = 'Klaeaelv';
```
-------------------------8444 sample_num
```sql
SELECT COUNT(DISTINCT p.Name) AS Italian_Regions_Bordered_By_Mediterranean_Sea, s.Depth
FROM province p
JOIN located l ON p.Name = l.Province AND p.Country = 'Italy'
JOIN geo_sea gs ON l.Sea = gs.Sea
JOIN sea s ON gs.Sea = s.Name
WHERE s.Name = 'Mediterranean Sea';
```
-------------------------8445 sample_num
```sql
SELECT Country FROM politics WHERE Government = 'British Overseas Territories';
```
-------------------------8446 sample_num
```sql
SELECT Country, Agriculture
FROM economy
WHERE Country IN (
    SELECT Country
    FROM economy
    ORDER BY GDP DESC
    LIMIT 3
)
ORDER BY Agriculture ASC
LIMIT 1;
```
-------------------------8447 sample_num
```sql
SELECT SUM(Area) AS Total_Area, COUNT(Name) AS Number_of_Nations
FROM country
WHERE Code IN (SELECT Country FROM encompasses WHERE Continent = 'Africa');
```
-------------------------8448 sample_num
```sql
SELECT Province, COUNT(*) AS CorporateHeadquarters
FROM organization
WHERE Country = 'United States'
GROUP BY Province
ORDER BY CorporateHeadquarters DESC
LIMIT 1;
```
-------------------------8449 sample_num
```sql
SELECT Country 
FROM politics 
WHERE Independence IS NOT NULL 
ORDER BY Independence DESC 
LIMIT 3;
```
-------------------------8450 sample_num
```sql
SELECT Name FROM country WHERE Name IN (SELECT Country FROM politics WHERE Government = 'Republic' AND Independence >= 1991);
```
-------------------------8451 sample_num
```sql
SELECT o.Name 
FROM organization o 
JOIN isMember im ON o.Name = im.Organization 
WHERE im.Type = 'associated';
```
-------------------------8452 sample_num
```sql
SELECT DISTINCT geo_desert.Country
FROM geo_desert
JOIN desert ON geo_desert.Desert = desert.Name
WHERE desert.Name = 'Kalahari';
```
-------------------------8453 sample_num
```sql
SELECT Name 
FROM desert 
WHERE Area = (SELECT MAX(Area) FROM desert WHERE Country = 'Kazakhstan');
```
-------------------------8454 sample_num
```sql
SELECT m.Sea2, s.Depth
FROM mergesWith m
JOIN sea s ON m.Sea1 = s.Name
WHERE m.Sea1 = 'Baltic Sea';
```
-------------------------8455 sample_num
```sql
SELECT country.Name, COUNT(organization.Name) AS OrganizationCount
FROM country
JOIN isMember ON country.Name = isMember.Country
JOIN organization ON isMember.Organization = organization.Name
JOIN politics ON country.Name = politics.Country
WHERE politics.Government = 'Constitutional Monarchy' AND organization.Established > 1907
GROUP BY country.Name
ORDER BY OrganizationCount DESC;
```
-------------------------8456 sample_num
```sql
SELECT m.Type, m.Province, m.Country
FROM mountain m
WHERE m.Name = 'Ampato';
```
-------------------------8457 sample_num
```sql
SELECT m.Name 
FROM mountain m 
JOIN geo_mountain gm ON m.Name = gm.Mountain 
JOIN country c ON gm.Country = c.Name 
WHERE m.Type = 'Volcano' AND c.Province = 'Ecuador';
```
-------------------------8458 sample_num
```sql
SELECT 
    (COUNT(DISTINCT p.Country) * 100.0 / (SELECT COUNT(DISTINCT c.Name) FROM country c)) AS Percentage,
    (SELECT GROUP_CONCAT(DISTINCT c.Name LIMIT 3) 
     FROM country c 
     JOIN politics p ON c.Name = p.Country 
     WHERE p.Independence > '1993-01-01' AND p.Government = 'Parliamentary Democracy') AS Three_Parliamentary_Democracies
FROM 
    politics p
WHERE 
    p.Independence > '1993-01-01' AND p.Government = 'Parliamentary Democracy';
```
-------------------------8459 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM river WHERE Length > 3000) * 100.0 / COUNT(*) AS Proportion,
    (SELECT Name FROM river WHERE Country = 'Russia' AND Length > 3000 LIMIT 1) AS Russian_River
FROM 
    river;
```
-------------------------8460 sample_num
```sql
SELECT Name, Established FROM organization WHERE Abbreviation = 'ABEDA';
```
-------------------------8461 sample_num
```sql
SELECT Name 
FROM organization 
WHERE Established BETWEEN 1970 AND 1980;
```
-------------------------8462 sample_num
```sql
SELECT Name FROM organization WHERE City = 'London';
```
-------------------------8463 sample_num
```sql
SELECT o.Name, o.City
FROM organization o
WHERE o.Country = 'USA';
```
-------------------------8464 sample_num
```sql
SELECT Abbreviation, Name, Established 
FROM organization 
WHERE City = 'Paris' 
ORDER BY Established ASC 
LIMIT 1;
```
-------------------------8465 sample_num
```sql
SELECT Name, City 
FROM organization 
WHERE Name LIKE '%United Nation%';
```
-------------------------8466 sample_num
```sql
SELECT Country1, Country2, Length
FROM borders
ORDER BY Length DESC
LIMIT 1;
```
-------------------------8467 sample_num
```sql
SELECT Country2 AS Country
FROM borders
WHERE Country1 = 'Bulgaria'
UNION
SELECT Country1 AS Country
FROM borders
WHERE Country2 = 'Bulgaria';
```
-------------------------8468 sample_num
```sql
SELECT Country1 AS CountryName
FROM borders
WHERE Length > 4000
UNION
SELECT Country2 AS CountryName
FROM borders
WHERE Length > 4000;
```
-------------------------8469 sample_num
```sql
SELECT c.Name, c.Population
FROM country c
JOIN isMember im ON c.Name = im.Country
WHERE im.Organization = 'IOC'
ORDER BY c.Population DESC
LIMIT 1;
```
-------------------------8470 sample_num
```sql
SELECT Country, Type 
FROM isMember 
WHERE Organization = 'Islamic Development Bank';
```
-------------------------8471 sample_num
```sql
SELECT c.Area, c.Population
FROM country c
JOIN isMember im ON c.Name = im.Country
WHERE im.Organization = 'Asia Pacific Economic Cooperation';
```
-------------------------8472 sample_num
```sql
SELECT Organization 
FROM isMember 
WHERE Type = 'National Society';
```
-------------------------8473 sample_num
```sql
SELECT Country, COUNT(Organization) AS MembershipCount
FROM isMember
GROUP BY Country
ORDER BY MembershipCount ASC
LIMIT 1;
```
-------------------------8474 sample_num
```sql
SELECT country.Name, country.Capital
FROM country
JOIN isMember ON country.Name = isMember.Country
WHERE isMember.Organization = 'IFAD' AND isMember.Type = 'Category III';
```
-------------------------8475 sample_num
```sql
SELECT Organization, COUNT(Country) AS MemberCount
FROM isMember
GROUP BY Organization
ORDER BY MemberCount DESC
LIMIT 1;
```
-------------------------8476 sample_num
```sql
SELECT o.Name AS Organization
FROM country c
LEFT JOIN organization o ON c.Capital = o.City
WHERE c.Name = 'Australia';
```
-------------------------8477 sample_num
```sql
SELECT (COUNT(CASE WHEN City = 'Washington' THEN 1 END) * 100.0 / COUNT(*)) AS Percentage
FROM organization
WHERE Country = 'USA';
```
-------------------------8478 sample_num
```sql
SELECT Length FROM borders WHERE Country1 = 'USA' AND Country2 = 'MEX';
```
-------------------------8479 sample_num
```sql
SELECT o.Name 
FROM organization o 
JOIN isMember im ON o.Name = im.Organization 
WHERE im.Country = 'Singapore' 
ORDER BY o.Established DESC 
LIMIT 1;
```
-------------------------8480 sample_num
```sql
SELECT c.Population 
FROM city c 
JOIN organization o ON c.Country = o.Country 
WHERE o.Name = 'World Tourism Organization';
```
-------------------------8481 sample_num
```sql
SELECT m.Height, g.Province 
FROM mountain m 
JOIN geo_mountain g ON m.Name = g.Mountain 
WHERE m.Name = 'Dhaulagiri';
```
-------------------------8482 sample_num
```sql
SELECT Name, Height 
FROM mountain 
WHERE Country = 'United States' AND Province = 'Alaska';
```
-------------------------8483 sample_num
```sql
SELECT p.Country, c.Population
FROM population p
JOIN country c ON p.Country = c.Name
WHERE p.Infant_Mortality = (SELECT MAX(Infant_Mortality) FROM population);
```
-------------------------8484 sample_num
```sql
SELECT Inflation FROM economy WHERE Country = 'Greece';
```
-------------------------8485 sample_num
```sql
SELECT p.Government
FROM economy e
JOIN politics p ON e.Country = p.Country
WHERE e.Agriculture = (SELECT MAX(Agriculture) FROM economy);
```
-------------------------8486 sample_num
```sql
SELECT country.Name AS Country, country.Capital
FROM country
JOIN politics ON country.Name = politics.Country
WHERE politics.Government = 'Parliamentary democracy';
```
-------------------------8487 sample_num
```sql
SELECT country.Name, country.Population
FROM country
JOIN ethnicGroup ON country.Name = ethnicGroup.Country
WHERE ethnicGroup.Name = 'Chinese' AND ethnicGroup.Percentage > 70;
```
-------------------------8488 sample_num
```sql
SELECT c.Name AS City, 
       c.Population AS CityPopulation, 
       (c.Population * 100.0 / co.Population) AS PercentageOfCountryPopulation
FROM city c
JOIN country co ON c.Country = co.Name
ORDER BY c.Population DESC
LIMIT 1;
```
-------------------------8489 sample_num
```sql
SELECT Independence FROM politics WHERE Country = 'United States of America';
```
-------------------------8490 sample_num
```sql
SELECT Name, Height 
FROM mountain 
WHERE Type = 'Volcanic' 
ORDER BY Height DESC 
LIMIT 1;
```
-------------------------8491 sample_num
```sql
SELECT Name 
FROM organization 
WHERE Country = 'Saudi Arabia' 
ORDER BY Established DESC 
LIMIT 1;
```
-------------------------8492 sample_num
```sql
SELECT Country 
FROM population 
ORDER BY Infant_Mortality DESC 
LIMIT 1 OFFSET 4;
```
-------------------------8493 sample_num
```sql
SELECT Country, COUNT(Name) AS ReligionCount
FROM religion
GROUP BY Country
ORDER BY ReligionCount DESC
LIMIT 1;
```
-------------------------8494 sample_num
```sql
SELECT Name, Length 
FROM river 
ORDER BY Length 
LIMIT 1 OFFSET 16;
```
-------------------------8495 sample_num
```sql
SELECT Independence 
FROM politics 
WHERE Country = (SELECT Name FROM country WHERE Capital = 'Nouakchott');
```
-------------------------8496 sample_num
```sql
SELECT c.Name, e.GDP
FROM country c
JOIN economy e ON c.Name = e.Country
ORDER BY c.Population ASC
LIMIT 1;
```
-------------------------8497 sample_num
```sql
SELECT l.Name, l.Depth
FROM lake l
JOIN country c ON l.River = c.Province
WHERE c.Name = 'Zaire'
ORDER BY l.Depth DESC
LIMIT 1;
```
-------------------------8498 sample_num
```sql
SELECT Height, Type 
FROM mountain 
WHERE Name IN (
    SELECT Mountain 
    FROM mountainOnIsland 
    WHERE Island = 'Madagaskar'
) 
ORDER BY Height ASC 
LIMIT 1;
```
-------------------------8499 sample_num
```sql
SELECT Country, GDP 
FROM economy 
JOIN country ON economy.Country = country.Name 
WHERE country.Population BETWEEN 60000000 AND 99000000 
ORDER BY GDP DESC 
LIMIT 1;
```
-------------------------8500 sample_num
```sql
SELECT Country, Agriculture 
FROM economy 
WHERE Country IN (SELECT Name FROM country WHERE Code IN (SELECT Code FROM continent WHERE Name = 'Asia')) 
ORDER BY Agriculture DESC 
LIMIT 1;
```
-------------------------8501 sample_num
```sql
SELECT p.Government 
FROM economy e 
JOIN politics p ON e.Country = p.Country 
WHERE e.GDP = (SELECT MIN(GDP) FROM economy);
```
-------------------------8502 sample_num
```sql
SELECT YEAR(Established) AS Year, COUNT(*) AS OrganizationCount
FROM organization o
JOIN country c ON o.Country = c.Name
JOIN encompasses e ON c.Name = e.Country
WHERE e.Continent = 'Europe'
GROUP BY Year
ORDER BY OrganizationCount DESC
LIMIT 1;
```
-------------------------8503 sample_num
```sql
SELECT b.Country2, b.Length
FROM borders b
JOIN country c ON b.Country1 = c.Name
WHERE c.Population = (SELECT MAX(Population) FROM country)
```
-------------------------8504 sample_num
```sql
SELECT 
    (c.Population / co.Area) AS PopulationDensity,
    (e.Industry / e.GDP) AS IndustryGDPPortion
FROM 
    city c
JOIN 
    country co ON c.Country = co.Name
JOIN 
    economy e ON co.Name = e.Country
WHERE 
    c.Province = 'Distrito Federal';
```
-------------------------8505 sample_num
```sql
SELECT Country, Government 
FROM politics 
WHERE Government = 'Parliamentary Democracy' 
AND Independence BETWEEN '1950-01-01' AND '1999-12-31';
```
-------------------------8506 sample_num
```sql
SELECT (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM country)) AS Percentage
FROM politics
WHERE Independence = 1960;
```
-------------------------8507 sample_num
```sql
SELECT Name FROM desert WHERE Latitude < 30 OR Latitude > 40;
```
-------------------------8508 sample_num
```sql
SELECT d.Latitude, d.Longitude
FROM desert d
JOIN geo_desert gd ON d.Name = gd.Desert
GROUP BY d.Name, d.Latitude, d.Longitude
HAVING COUNT(DISTINCT gd.Country) > 1;
```
-------------------------8509 sample_num
```sql
SELECT Capital
FROM province
WHERE Population < 80000
ORDER BY Population / Area DESC
LIMIT 1;
```
-------------------------8510 sample_num
```sql
SELECT COUNT(*) 
FROM Customers 
WHERE MARITAL_STATUS = 'Never-married';
```
-------------------------8511 sample_num
```sql
SELECT COUNT(*) AS TeenagerCount
FROM Customers
WHERE age BETWEEN 13 AND 19;
```
-------------------------8512 sample_num
```sql
SELECT OCCUPATION 
FROM Customers 
WHERE EDUCATIONNUM = 11;
```
-------------------------8513 sample_num
```sql
SELECT COUNT(*) AS true_response_count
FROM (
    SELECT C.ID, M.RESPONSE
    FROM Customers C
    JOIN mailings3 M ON C.ID = M.REFID
    WHERE M.RESPONSE = 'true'
    LIMIT 60000
) AS subquery;
```
-------------------------8514 sample_num
```sql
SELECT COUNT(*) 
FROM Customers 
WHERE age > 30 AND OCCUPATION = 'Machine-op-inspct';
```
-------------------------8515 sample_num
```sql
SELECT COUNT(*) 
FROM Customers 
WHERE EDUCATIONNUM > 11 AND SEX = 'Female';
```
-------------------------8516 sample_num
```sql
SELECT COUNT(*) 
FROM Customers 
WHERE SEX = 'Female' 
AND ID IN (
    SELECT C.ID 
    FROM Customers C 
    JOIN mailings3 M ON C.ID = M.REFID 
    WHERE M.RESPONSE = 'true' 
    LIMIT 60000
);
```
-------------------------8517 sample_num
```sql
SELECT DISTINCT Customers.OCCUPATION
FROM Customers
JOIN mailings3 ON Customers.ID = mailings3.REFID
WHERE Customers.age > 40 AND mailings3.RESPONSE = 'true';
```
-------------------------8518 sample_num
```sql
SELECT COUNT(*) 
FROM Customers c
JOIN Demog d ON c.GEOID = d.GEOID
WHERE c.SEX = 'Male' AND d.INHABITANTS_K > 30;
```
-------------------------8519 sample_num
```sql
SELECT COUNT(*) 
FROM Customers 
WHERE GEOID = (SELECT GEOID 
               FROM Demog 
               ORDER BY INCOME_K DESC 
               LIMIT 1);
```
-------------------------8520 sample_num
```sql
SELECT COUNT(*) 
FROM Customers 
WHERE GEOID IN (
    SELECT GEOID 
    FROM Demog 
    WHERE INHABITANTS_K BETWEEN 20 AND 30
) AND OCCUPATION = 'Machine-op-inspct';
```
-------------------------8521 sample_num
```sql
SELECT 
    CASE 
        WHEN (SELECT INHABITANTS_K FROM Demog WHERE GEOID = (SELECT GEOID FROM Customers WHERE ID = 0)) > 
             (SELECT INHABITANTS_K FROM Demog WHERE GEOID = (SELECT GEOID FROM Customers WHERE ID = 1)) 
        THEN 'Customer 0' 
        ELSE 'Customer 1' 
    END AS Customer_With_More_Inhabitants;
```
-------------------------8522 sample_num
```sql
SELECT COUNT(*) 
FROM (
    SELECT c.ID 
    FROM Customers c
    JOIN mailings3 m ON c.ID = m.REFID
    JOIN Demog d ON c.GEOID = d.GEOID
    WHERE m.RESPONSE = 'true' 
    AND d.INHABITANTS_K > 30
    LIMIT 60000
) AS subquery;
```
-------------------------8523 sample_num
```sql
SELECT COUNT(*) 
FROM (
    SELECT c.ID 
    FROM Customers c
    JOIN mailings3 m ON c.ID = m.REFID
    WHERE m.RESPONSE = 'true' 
    AND c.SEX = 'Male' 
    AND c.MARITAL_STATUS = 'Divorced'
    LIMIT 60000
) AS subquery;
```
-------------------------8524 sample_num
```sql
SELECT COUNT(DISTINCT c.ID) AS true_responses
FROM Customers c
JOIN Demog d ON c.GEOID = d.GEOID
JOIN mailings3 m ON c.ID = m.REFID
WHERE d.INCOME_K = (SELECT MAX(INCOME_K) FROM Demog)
  AND m.RESPONSE = 'true'
  AND c.ID IN (SELECT ID FROM Customers ORDER BY ID LIMIT 60000);
```
-------------------------8525 sample_num
```sql
SELECT INHABITANTS_K 
FROM Demog 
WHERE GEOID = (
    SELECT GEOID 
    FROM Customers 
    GROUP BY GEOID 
    ORDER BY COUNT(ID) DESC 
    LIMIT 1
);
```
-------------------------8526 sample_num
```sql
SELECT COUNT(*) 
FROM Customers 
WHERE GEOID IN (SELECT GEOID FROM Demog WHERE INHABITANTS_K = 25746) 
AND SEX = 'Male';
```
-------------------------8527 sample_num
```sql
SELECT COUNT(*) 
FROM Customers 
WHERE ID IN (
    SELECT C.ID 
    FROM Customers C
    JOIN mailings3 M ON C.ID = M.REFID 
    WHERE M.RESPONSE = 'true' 
    LIMIT 60000
) 
AND age BETWEEN 13 AND 19;
```
-------------------------8528 sample_num
```sql
SELECT AVG(C.educationnum) AS average_education_level
FROM Customers C
WHERE C.GEOID = (
    SELECT D.GEOID
    FROM Demog D
    ORDER BY D.INCOME_K DESC
    LIMIT 1
);
```
-------------------------8529 sample_num
```sql
SELECT AVG(age) 
FROM Customers 
WHERE ID IN (
    SELECT C.ID 
    FROM Customers C
    JOIN mailings3 M ON C.ID = M.REFID 
    WHERE M.RESPONSE = 'true' 
    LIMIT 60000
);
```
-------------------------8530 sample_num
```sql
SELECT COUNT(*) AS Male_Customers
FROM Customers
WHERE SEX = 'Male';
```
-------------------------8531 sample_num
```sql
SELECT GEOID 
FROM Customers 
WHERE OCCUPATION = 'Handlers-cleaners';
```
-------------------------8532 sample_num
```sql
SELECT COUNT(*) AS total_customers_below_30
FROM Customers
WHERE age < 30;
```
-------------------------8533 sample_num
```sql
SELECT GEOID 
FROM Demog 
WHERE INCOME_K BETWEEN 2100 AND 2500;
```
-------------------------8534 sample_num
```sql
SELECT COUNT(*) 
FROM Demog 
WHERE GEOID BETWEEN 20 AND 50 AND INHABITANTS_K < 20;
```
-------------------------8535 sample_num
```sql
SELECT INHABITANTS_K, INCOME_K 
FROM Demog 
WHERE GEOID = 239;
```
-------------------------8536 sample_num
```sql
SELECT Customers.EDUCATIONNUM, Customers.OCCUPATION
FROM Customers
JOIN Demog ON Customers.GEOID = Demog.GEOID
WHERE Customers.age BETWEEN 20 AND 35 AND Demog.INCOME_K < 2000;
```
-------------------------8537 sample_num
```sql
SELECT SUM(Demog.INHABITANTS_K) AS Total_Inhabitants
FROM Customers
JOIN Demog ON Customers.GEOID = Demog.GEOID
WHERE Customers.MARITAL_STATUS = 'Divorced' AND Customers.age > 50;
```
-------------------------8538 sample_num
```sql
SELECT c.GEOID, d.INCOME_K
FROM Customers c
JOIN Demog d ON c.GEOID = d.GEOID
WHERE c.age = (SELECT MAX(age) FROM Customers);
```
-------------------------8539 sample_num
```sql
SELECT D.INCOME_K
FROM Customers C
JOIN Demog D ON C.GEOID = D.GEOID
WHERE C.SEX = 'Male' AND C.EDUCATIONNUM < 4;
```
-------------------------8540 sample_num
```sql
SELECT Customers.OCCUPATION, Demog.INCOME_K
FROM Customers
JOIN Demog ON Customers.GEOID = Demog.GEOID
WHERE Customers.SEX = 'Male' AND Customers.EDUCATIONNUM BETWEEN 4 AND 6;
```
-------------------------8541 sample_num
```sql
SELECT COUNT(*) 
FROM Customers c 
JOIN Demog d ON c.GEOID = d.GEOID 
WHERE c.SEX = 'Male' 
AND c.age BETWEEN 40 AND 60 
AND c.MARITAL_STATUS = 'Widowed' 
AND d.INCOME_K >= 3000;
```
-------------------------8542 sample_num
```sql
SELECT DISTINCT Customers.OCCUPATION
FROM Customers
JOIN Demog ON Customers.GEOID = Demog.GEOID
WHERE Demog.INHABITANTS_K BETWEEN 30 AND 40;
```
-------------------------8543 sample_num
```sql
SELECT D.INCOME_K
FROM Customers C
JOIN Demog D ON C.GEOID = D.GEOID
WHERE C.SEX = 'Female' 
  AND C.MARITAL_STATUS = 'Widowed' 
  AND C.EDUCATIONNUM <= 5;
```
-------------------------8544 sample_num
```sql
SELECT MARITAL_STATUS 
FROM Customers 
WHERE age BETWEEN 40 AND 60 
AND GEOID = (SELECT GEOID 
             FROM Demog 
             WHERE INCOME_K = (SELECT MAX(INCOME_K) 
                               FROM Demog 
                               WHERE GEOID IN (SELECT GEOID 
                                               FROM Customers 
                                               WHERE age BETWEEN 40 AND 60)));
```
-------------------------8545 sample_num
```sql
SELECT SUM(Demog.INHABITANTS_K) AS total_inhabitants
FROM Customers
JOIN Demog ON Customers.GEOID = Demog.GEOID
WHERE Customers.SEX = 'Male' 
  AND Customers.age BETWEEN 20 AND 30 
  AND (Customers.OCCUPATION = 'Farming' OR Customers.OCCUPATION = 'Fishing');
```
-------------------------8546 sample_num
```sql
SELECT D.INHABITANTS_K, C.age
FROM Customers C
JOIN Demog D ON C.GEOID = D.GEOID
WHERE C.MARITAL_STATUS = 'married-civ-spouse' AND C.OCCUPATION = 'Machine-op-inspct';
```
-------------------------8547 sample_num
```sql
SELECT COUNT(*) 
FROM Customers c
JOIN Demog d ON c.GEOID = d.GEOID
WHERE c.SEX = 'Female' 
AND c.age BETWEEN 50 AND 60 
AND d.INHABITANTS_K BETWEEN 19 AND 24;
```
-------------------------8548 sample_num
```sql
SELECT D.INCOME_K, D.INHABITANTS_K
FROM Customers C
JOIN Demog D ON C.GEOID = D.GEOID
WHERE C.age > (SELECT AVG(age) * 0.8 FROM Customers);
```
-------------------------8549 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN D.INCOME_K >= 2500 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Customers C
JOIN 
    Demog D ON C.GEOID = D.GEOID
WHERE 
    C.MARITAL_STATUS = 'Never-married';
```
-------------------------8550 sample_num
```sql
SELECT ID, GEOID 
FROM Customers 
WHERE age > 65 AND EDUCATIONNUM < 3;
```
-------------------------8551 sample_num
```sql
SELECT GEOID 
FROM Demog 
WHERE INCOME_K > (SELECT AVG(INCOME_K) FROM Demog);
```
-------------------------8552 sample_num
```sql
SELECT COUNT(DISTINCT c.ID) AS Non_Responding_Customers
FROM Customers c
LEFT JOIN mailings3 m ON c.ID = m.REFID AND m.RESPONSE = 'false'
WHERE m.REF_DATE BETWEEN '2007-02-01 12:00:00.0' AND '2007-02-28 12:00:00.0'
AND m.REFID IS NULL;
```
-------------------------8553 sample_num
```sql
SELECT COUNT(*) 
FROM Customers 
WHERE age BETWEEN 13 AND 19 AND OCCUPATION = 'Machine-op-inspct';
```
-------------------------8554 sample_num
```sql
SELECT COUNT(*) 
FROM Customers c
JOIN Demog d ON c.GEOID = d.GEOID
WHERE c.OCCUPATION = 'Other-service' AND d.INHABITANTS_K > 20;
```
-------------------------8555 sample_num
```sql
SELECT COUNT(*) 
FROM Customers c
JOIN Demog d ON c.GEOID = d.GEOID
WHERE c.SEX = 'Male' 
AND c.age BETWEEN 20 AND 29 
AND d.INCOME_K > 3000;
```
-------------------------8556 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN age > 65 AND MARITAL_STATUS = 'never married' THEN ID END) * 100.0 / COUNT(ID)) AS percentage
FROM 
    Customers
WHERE 
    GEOID = 24;
```
-------------------------8557 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN age BETWEEN 80 AND 89 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Customers
WHERE 
    GEOID IN (SELECT GEOID FROM Demog WHERE INCOME_K > 3000);
```
-------------------------8558 sample_num
```sql
SELECT COUNT(DISTINCT Customers.ID) AS TrueResponseCount
FROM Customers
JOIN mailings3 ON Customers.ID = mailings3.REFID
WHERE mailings3.RESPONSE = 'TRUE';
```
-------------------------8559 sample_num
```sql
SELECT DISTINCT Customers.ID
FROM Customers
JOIN mailings3 ON Customers.ID = mailings3.REFID
WHERE mailings3.RESPONSE = 'true';
```
-------------------------8560 sample_num
```sql
SELECT COUNT(*) 
FROM Customers 
WHERE MARITAL_STATUS = 'Widowed' AND age < 50;
```
-------------------------8561 sample_num
```sql
SELECT GEOID 
FROM Demog 
WHERE INHABITANTS_K < 30;
```
-------------------------8562 sample_num
```sql
SELECT COUNT(*) 
FROM Demog 
WHERE GEOID BETWEEN 10 AND 30 AND INCOME_K < 2000;
```
-------------------------8563 sample_num
```sql
SELECT MARITAL_STATUS 
FROM Customers 
WHERE age = 62 AND EDUCATIONNUM = 7;
```
-------------------------8564 sample_num
```sql
SELECT SUM(Demog.INHABITANTS_K) AS Total_Inhabitants
FROM Customers
JOIN Demog ON Customers.GEOID = Demog.GEOID
JOIN mailings3 ON Customers.ID = mailings3.REFID
WHERE Customers.MARITAL_STATUS = 'widowed' AND mailings3.RESPONSE = 'false';
```
-------------------------8565 sample_num
```sql
SELECT m.RESPONSE, d.INHABITANTS_K
FROM Customers c
JOIN Demog d ON c.GEOID = d.GEOID
JOIN mailings3 m ON c.ID = m.REFID
WHERE c.SEX = 'Female' AND c.age = (SELECT MAX(age) FROM Customers WHERE SEX = 'Female');
```
-------------------------8566 sample_num
```sql
SELECT D.INCOME_K
FROM Customers C
JOIN Demog D ON C.GEOID = D.GEOID
WHERE C.SEX = 'Female' AND C.EDUCATIONNUM <= 3;
```
-------------------------8567 sample_num
```sql
SELECT Customers.EDUCATIONNUM, Demog.INCOME_K
FROM Customers
JOIN Demog ON Customers.GEOID = Demog.GEOID
WHERE Customers.age BETWEEN 30 AND 55
AND Customers.ID IN (SELECT REFID FROM mailings3 WHERE RESPONSE = 'true');
```
-------------------------8568 sample_num
```sql
SELECT COUNT(*) 
FROM Customers c 
JOIN Demog d ON c.GEOID = d.GEOID 
WHERE c.SEX = 'Male' 
AND c.age BETWEEN 30 AND 50 
AND d.INCOME_K BETWEEN 2000 AND 2300;
```
-------------------------8569 sample_num
```sql
SELECT c.EDUCATIONNUM, m.RESPONSE
FROM Customers c
JOIN Demog d ON c.GEOID = d.GEOID
JOIN mailings3 m ON c.ID = m.REFID
WHERE c.age BETWEEN 20 AND 30
AND d.INHABITANTS_K = (SELECT MAX(INHABITANTS_K) FROM Demog)
```
-------------------------8570 sample_num
```sql
SELECT D.INCOME_K
FROM Customers C
JOIN Demog D ON C.GEOID = D.GEOID
WHERE C.SEX = 'Female' AND C.age BETWEEN 30 AND 55 AND C.OCCUPATION = 'machine-op-inspct';
```
-------------------------8571 sample_num
```sql
SELECT MARITAL_STATUS, RESPONSE
FROM Customers
JOIN mailings3 ON Customers.ID = mailings3.REFID
WHERE SEX = 'Female' AND EDUCATIONNUM >= 8;
```
-------------------------8572 sample_num
```sql
SELECT age 
FROM Customers 
JOIN Demog ON Customers.GEOID = Demog.GEOID 
WHERE Customers.SEX = 'Female' AND Demog.INHABITANTS_K < 30;
```
-------------------------8573 sample_num
```sql
SELECT D.INCOME_K, M.RESPONSE
FROM Customers C
JOIN Demog D ON C.GEOID = D.GEOID
JOIN mailings3 M ON C.ID = M.REFID
WHERE C.SEX = 'Male' 
  AND C.MARITAL_STATUS = 'Divorced' 
  AND C.EDUCATIONNUM >= 6;
```
-------------------------8574 sample_num
```sql
SELECT Customers.OCCUPATION, mailings3.RESPONSE
FROM Customers
JOIN Demog ON Customers.GEOID = Demog.GEOID
JOIN mailings3 ON Customers.ID = mailings3.REFID
WHERE Customers.SEX = 'Female' AND Demog.INHABITANTS_K BETWEEN 20 AND 25;
```
-------------------------8575 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN m.RESPONSE = 'true' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Customers c
JOIN 
    mailings3 m ON c.ID = m.REFID
WHERE 
    c.OCCUPATION = 'Handlers-cleaners' 
    AND c.SEX = 'Male';
```
-------------------------8576 sample_num
```sql
SELECT D.INCOME_K, D.INHABITANTS_K
FROM Demog D
JOIN Customers C ON D.GEOID = C.GEOID
WHERE C.ID > (SELECT 0.5 * COUNT(*) FROM mailings3 WHERE RESPONSE = 'false') / (SELECT COUNT(*) FROM mailings3);
```
-------------------------8577 sample_num
```sql
SELECT 
    DIVIDE(
        COUNT(CASE WHEN SEX = 'Male' AND age BETWEEN 13 AND 19 AND EDUCATIONNUM > 10 THEN 1 END),
        COUNT(CASE WHEN SEX = 'Female' AND age BETWEEN 13 AND 19 AND EDUCATIONNUM > 10 THEN 1 END)
    ) AS gender_ratio
FROM 
    Customers;
```
-------------------------8578 sample_num
```sql
SELECT GEOID, SUM(12 * INHABITANTS_K * INCOME_K) AS total_income_per_year
FROM Demog
WHERE INCOME_K > 3300
GROUP BY GEOID;
```
-------------------------8579 sample_num
```sql
SELECT 
    CASE 
        WHEN (SELECT COUNT(REFID) FROM mailings3 WHERE RESPONSE = 'true') > 
             (SELECT COUNT(REFID) FROM mailings3 WHERE RESPONSE = 'false') 
        THEN 'Responding' 
        ELSE 'Not Responding' 
    END AS Greater_Response
```
-------------------------8580 sample_num
```sql
SELECT D.GEOID, (D.INHABITANTS_K * D.INCOME_K * 12) AS YEARLY_INCOME
FROM Demog D
JOIN Customers C ON D.GEOID = C.GEOID
WHERE C.SEX = 'Female' AND C.OCCUPATION = 'Sales';
```
-------------------------8581 sample_num
```sql
SELECT EDUCATIONNUM, OCCUPATION, age 
FROM Customers 
WHERE GEOID IN (SELECT GEOID FROM Demog WHERE INHABITANTS_K = 33.658) 
AND SEX = 'Female' 
AND MARITAL_STATUS = 'Widowed';
```
-------------------------8582 sample_num
```sql
SELECT m3.RESPONSE
FROM mailings3 m3
JOIN Customers c ON m3.REFID = c.ID
WHERE c.GEOID = 134;
```
-------------------------8583 sample_num
```sql
SELECT 
    d.GEOID,
    AVG(d.INCOME_K) AS average_income_per_month,
    (SUM(d.INHABITANTS_K * d.INCOME_K) * 12) AS yearly_income
FROM 
    Demog d
JOIN 
    Customers c ON d.GEOID = c.GEOID
WHERE 
    c.ID IN ('209556', '290135')
GROUP BY 
    d.GEOID;
```
-------------------------8584 sample_num
```sql
SELECT C.EDUCATIONNUM
FROM mailings3 M
JOIN Customers C ON M.REFID = C.ID
WHERE M.REFID < 10 AND M.RESPONSE = 'true';
```
-------------------------8585 sample_num
```sql
SELECT COUNT(*) 
FROM Community_Area 
WHERE side = 'Central';
```
-------------------------8586 sample_num
```sql
SELECT d.district_name
FROM District d
JOIN Community_Area ca ON d.district_no = ca.side
WHERE ca.community_area_name = 'Lincoln Square';
```
-------------------------8587 sample_num
```sql
SELECT d.district_name, COUNT(ca.community_area_no) AS community_area_count
FROM District d
JOIN Crime c ON d.district_no = c.district_no
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
GROUP BY d.district_name
ORDER BY community_area_count DESC
LIMIT 1;
```
-------------------------8588 sample_num
```sql
SELECT community_area_name 
FROM Community_Area 
ORDER BY population ASC 
LIMIT 1;
```
-------------------------8589 sample_num
```sql
SELECT commander 
FROM District 
WHERE district_name = 'Central';
```
-------------------------8590 sample_num
```sql
SELECT email FROM District WHERE district_name = 'Central';
```
-------------------------8591 sample_num
```sql
SELECT ca.community_area_name 
FROM Community_Area ca
JOIN Neighborhood n ON ca.community_area_no = n.community_area_no
WHERE n.neighborhood_name = 'Albany Park';
```
-------------------------8592 sample_num
```sql
SELECT COUNT(*) 
FROM Neighborhood 
WHERE community_area_no = (SELECT community_area_no FROM Community_Area WHERE community_area_name = 'Lincoln Square');
```
-------------------------8593 sample_num
```sql
SELECT n.neighborhood_name
FROM Neighborhood n
JOIN Community_Area ca ON n.community_area_no = ca.community_area_no
WHERE ca.population = (SELECT MAX(population) FROM Community_Area);
```
-------------------------8594 sample_num
```sql
SELECT n.neighborhood_name 
FROM Neighborhood n 
JOIN Community_Area ca ON n.community_area_no = ca.community_area_no 
WHERE ca.side = 'Central';
```
-------------------------8595 sample_num
```sql
SELECT latitude, longitude 
FROM Crime 
WHERE district_no IN (SELECT district_no FROM District WHERE district_name = 'Central');
```
-------------------------8596 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE district_no IN (SELECT district_no FROM District WHERE district_name = 'Central');
```
-------------------------8597 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE district_no IN (SELECT district_no FROM District WHERE district_name = 'Central') 
AND domestic = 'TRUE';
```
-------------------------8598 sample_num
```sql
SELECT case_number 
FROM Crime 
WHERE arrest = 'FALSE' 
AND district_no IN (SELECT district_no FROM District WHERE district_name = 'Central');
```
-------------------------8599 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE community_area_no = (
    SELECT community_area_no 
    FROM Community_Area 
    WHERE population = (SELECT MAX(population) FROM Community_Area)
);
```
-------------------------8600 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE community_area_no IN (
    SELECT community_area_no 
    FROM Community_Area 
    WHERE community_area_name = 'Woodlawn'
) 
AND date LIKE '%1/2018%';
```
-------------------------8601 sample_num
```sql
SELECT community_area_name, COUNT(report_no) AS crime_count
FROM Crime
JOIN Community_Area ON Crime.community_area_no = Community_Area.community_area_no
WHERE date LIKE '%1/2018%'
AND community_area_name IN ('Woodlawn', 'Lincoln Square')
GROUP BY community_area_name
ORDER BY crime_count DESC
LIMIT 1;
```
-------------------------8602 sample_num
```sql
SELECT d.fax
FROM District d
JOIN Crime c ON d.district_no = c.district_no
WHERE c.date LIKE '%1/2018%'
GROUP BY d.district_no
ORDER BY COUNT(c.case_number) DESC
LIMIT 1;
```
-------------------------8603 sample_num
```sql
SELECT AVG(crime_count) AS average_crimes
FROM (
    SELECT COUNT(c.report_no) AS crime_count
    FROM Crime c
    JOIN Neighborhood n ON c.community_area_no = n.community_area_no
    JOIN Community_Area ca ON n.community_area_no = ca.community_area_no
    WHERE ca.side = 'Central'
    GROUP BY n.neighborhood_name
) AS neighborhood_crime_counts;
```
-------------------------8604 sample_num
```sql
SELECT (COUNT(CASE WHEN d.district_name = 'Central' THEN c.case_number END) * 100.0 / COUNT(c.case_number)) AS percentage
FROM Crime c
JOIN District d ON c.district_no = d.district_no;
```
-------------------------8605 sample_num
```sql
SELECT COUNT(*) 
FROM Community_Area 
WHERE side = 'Far North';
```
-------------------------8606 sample_num
```sql
SELECT commander FROM District WHERE district_name = 'Morgan Park';
```
-------------------------8607 sample_num
```sql
SELECT d.district_name 
FROM Crime c 
JOIN District d ON c.district_no = d.district_no 
WHERE c.case_number = 'JB100065';
```
-------------------------8608 sample_num
```sql
SELECT d.district_name
FROM Crime c
JOIN District d ON c.district_no = d.district_no
WHERE c.latitude = 41.66236555 AND c.longitude = -87.63470194;
```
-------------------------8609 sample_num
```sql
SELECT d.commander 
FROM Crime c 
JOIN District d ON c.district_no = d.district_no 
WHERE c.case_number = 'JB524952';
```
-------------------------8610 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE iucr_no IN (
    SELECT iucr_no 
    FROM IUCR 
    WHERE primary_description = 'ASSAULT' AND secondary_description = 'SIMPLE'
) 
AND date LIKE '%9/8/2018%';
```
-------------------------8611 sample_num
```sql
SELECT district_no
FROM Crime
WHERE iucr_no IN (SELECT iucr_no FROM IUCR WHERE secondary_description = 'FIRST DEGREE MURDER')
GROUP BY district_no
ORDER BY COUNT(case_number) DESC
LIMIT 1;
```
-------------------------8612 sample_num
```sql
SELECT IUCR.index_code
FROM Crime
JOIN IUCR ON Crime.iucr_no = IUCR.iucr_no
WHERE Crime.case_number = 'JB296775';
```
-------------------------8613 sample_num
```sql
SELECT ca.community_area_name
FROM Crime c
JOIN IUCR i ON c.iucr_no = i.iucr_no
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
WHERE i.primary_description = 'THEFT' AND i.secondary_description = 'POCKET-PICKING'
GROUP BY ca.community_area_name
ORDER BY COUNT(c.case_number) DESC
LIMIT 1;
```
-------------------------8614 sample_num
```sql
SELECT CONCAT(w.alderman_first_name, ' ', w.alderman_last_name) AS full_name
FROM Crime c
JOIN Ward w ON c.ward_no = w.ward_no
WHERE c.case_number = 'JB103470';
```
-------------------------8615 sample_num
```sql
SELECT n.neighborhood_name 
FROM Neighborhood n 
JOIN Community_Area ca ON n.community_area_no = ca.community_area_no 
WHERE ca.community_area_name = 'West Englewood';
```
-------------------------8616 sample_num
```sql
SELECT COUNT(DISTINCT neighborhood_name) 
FROM Neighborhood 
WHERE community_area_no IN (SELECT community_area_no FROM Community_Area WHERE community_area_name = 'Roseland');
```
-------------------------8617 sample_num
```sql
SELECT f.description 
FROM Crime c 
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no 
WHERE c.case_number = 'JB134191';
```
-------------------------8618 sample_num
```sql
SELECT COUNT(case_number) 
FROM Crime 
JOIN Community_Area ON Crime.community_area_no = Community_Area.community_area_no 
WHERE arrest = 'TRUE' AND Community_Area.community_area_name = 'North Lawndale';
```
-------------------------8619 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN iucr.secondary_description = '$500 AND UNDER' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    Crime c
JOIN 
    IUCR iucr ON c.iucr_no = iucr.iucr_no
JOIN 
    Community_Area ca ON c.community_area_no = ca.community_area_no
WHERE 
    iucr.primary_description = 'THEFT' 
    AND ca.community_area_name = 'West Englewood';
```
-------------------------8620 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN f.title = 'Larceny' THEN c.case_number END) * 100.0 / COUNT(c.case_number)) AS larceny_percentage
FROM 
    Crime c
JOIN 
    Community_Area ca ON c.community_area_no = ca.community_area_no
JOIN 
    FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE 
    ca.community_area_name = 'Edgewater';
```
-------------------------8621 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE block = '018XX S KOMENSKY AVE' 
AND date LIKE '5/%/2018%';
```
-------------------------8622 sample_num
```sql
SELECT community_area_name 
FROM Community_Area 
WHERE population = (SELECT MAX(population) FROM Community_Area);
```
-------------------------8623 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE domestic = 'TRUE' 
AND location_description = 'ABANDONED BUILDING' 
AND date LIKE '%2018%';
```
-------------------------8624 sample_num
```sql
SELECT MIN(total_population) AS least_population
FROM (
    SELECT d.district_no, SUM(ca.population) AS total_population
    FROM District d
    JOIN Crime c ON d.district_no = c.district_no
    JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
    GROUP BY d.district_no
) AS district_population;
```
-------------------------8625 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE arrest = 'TRUE' 
  AND date LIKE '%2018%' 
  AND location_description = 'ANIMAL HOSPITAL' 
  AND fbi_code_no = '08B';
```
-------------------------8626 sample_num
```sql
SELECT *
FROM Crime
WHERE fbi_code_no IN (
    SELECT fbi_code_no
    FROM FBI_Code
    WHERE crime_against = 'Society'
);
```
-------------------------8627 sample_num
```sql
SELECT commander 
FROM District 
WHERE district_no = (
    SELECT district_no 
    FROM Crime 
    JOIN FBI_Code ON Crime.fbi_code_no = FBI_Code.fbi_code_no 
    WHERE FBI_Code.title = 'Disorderly Conduct' 
    GROUP BY district_no 
    ORDER BY COUNT(district_no) DESC 
    LIMIT 1
);
```
-------------------------8628 sample_num
```sql
SELECT f.title, COUNT(*) AS crime_count
FROM Crime c
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
GROUP BY f.title
ORDER BY crime_count DESC
LIMIT 1;
```
-------------------------8629 sample_num
```sql
SELECT COUNT(*) 
FROM Crime c
JOIN District d ON c.district_no = d.district_no
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE d.district_name = 'Albany Park' 
  AND c.location_description = 'APARTMENT' 
  AND f.title = 'Criminal Sexual Abuse';
```
-------------------------8630 sample_num
```sql
SELECT latitude, longitude
FROM Crime
WHERE fbi_code_no = 3
AND community_area_no IN (
    SELECT community_area_no
    FROM Community_Area
    WHERE community_area_name = 'Rogers Park'
)
GROUP BY latitude, longitude
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------8631 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
JOIN IUCR ON Crime.iucr_no = IUCR.iucr_no 
JOIN Community_Area ON Crime.community_area_no = Community_Area.community_area_no 
WHERE IUCR.secondary_description = 'SOLICIT ON PUBLIC WAY' 
  AND IUCR.primary_description = 'PROSTITUTION' 
  AND Crime.arrest = 'TRUE' 
  AND Community_Area.community_area_name = 'West Garfield Park';
```
-------------------------8632 sample_num
```sql
SELECT COUNT(*) AS domestic_violence_incidents
FROM Crime
WHERE domestic = 'TRUE' 
  AND location_description = 'BAR OR TAVERN' 
  AND ward_no = (
      SELECT ward_no
      FROM Ward
      ORDER BY Population DESC
      LIMIT 1
  );
```
-------------------------8633 sample_num
```sql
SELECT COUNT(DISTINCT neighborhood_name) 
FROM Neighborhood 
WHERE community_area_no IN (SELECT community_area_no FROM Community_Area WHERE community_area_name = 'Near North Side');
```
-------------------------8634 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE domestic = 'TRUE' 
AND ward_no = (SELECT ward_no FROM Ward WHERE alderman_first_name = 'Walter' AND alderman_last_name = 'Burnett Jr.');
```
-------------------------8635 sample_num
```sql
SELECT f.title
FROM Crime c
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE ca.population = (SELECT MIN(population) FROM Community_Area)
GROUP BY f.title
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------8636 sample_num
```sql
SELECT w.ward_office_address 
FROM Crime c 
JOIN Ward w ON c.ward_no = w.ward_no 
WHERE c.block = '010XX W LAKE ST';
```
-------------------------8637 sample_num
```sql
SELECT ca.community_area_name
FROM Crime c
JOIN IUCR i ON c.iucr_no = i.iucr_no
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
WHERE i.primary_description = 'PROSTITUTION'
GROUP BY ca.community_area_name
ORDER BY COUNT(c.case_number) DESC
LIMIT 1;
```
-------------------------8638 sample_num
```sql
SELECT COUNT(*) 
FROM Crime c
JOIN Ward w ON c.ward_no = w.ward_no
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE f.title = 'Vandalism' AND c.arrest = 'TRUE' AND w.alderman_first_name = 'Edward' AND w.alderman_last_name = 'Burke';
```
-------------------------8639 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE domestic = 'TRUE' AND date LIKE '5/%/2018%';
```
-------------------------8640 sample_num
```sql
SELECT iucr_no, index_code 
FROM IUCR 
WHERE primary_description = 'HOMICIDE';
```
-------------------------8641 sample_num
```sql
SELECT commander, email 
FROM District 
WHERE district_name = 'Chicago Lawn';
```
-------------------------8642 sample_num
```sql
SELECT CONCAT(ward.alderman_first_name, ' ', ward.alderman_last_name, ' ', ward.alderman_name_suffix) AS full_name
FROM Ward ward
WHERE ward.Population = (SELECT MAX(Population) FROM Ward);
```
-------------------------8643 sample_num
```sql
SELECT community_area_name 
FROM Community_Area 
WHERE side = 'Northwest';
```
-------------------------8644 sample_num
```sql
SELECT f.title, f.description
FROM FBI_Code f
WHERE f.crime_against = 'Persons';
```
-------------------------8645 sample_num
```sql
SELECT iucr.secondary_description, crime.latitude, crime.longitude
FROM IUCR iucr
JOIN Crime crime ON iucr.iucr_no = crime.iucr_no
WHERE iucr.iucr_no = 142;
```
-------------------------8646 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE date LIKE '10/7/2018%' 
AND district_no IN (
    SELECT district_no 
    FROM District 
    WHERE commander = 'Brendan Reilly'
);
```
-------------------------8647 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
JOIN District ON Crime.district_no = District.district_no 
WHERE Crime.arrest = 'TRUE' 
AND Crime.location_description = 'RESTAURANT' 
AND District.district_name = 'Englewood';
```
-------------------------8648 sample_num
```sql
SELECT 
    c.case_number, 
    CONCAT(w.alderman_first_name, ' ', w.alderman_last_name, ' ', w.alderman_name_suffix) AS alderman_full_name, 
    d.district_name 
FROM 
    Crime c 
JOIN 
    Ward w ON c.ward_no = w.ward_no 
JOIN 
    District d ON c.district_no = d.district_no 
WHERE 
    c.block = '0000X N FRANCISCO AVE';
```
-------------------------8649 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE fbi_code_no = (SELECT fbi_code_no FROM FBI_Code WHERE title = 'Misc Non-Index Offense');
```
-------------------------8650 sample_num
```sql
SELECT n.neighborhood_name
FROM Neighborhood n
JOIN Community_Area ca ON n.community_area_no = ca.community_area_no
WHERE ca.community_area_name = 'Douglas';
```
-------------------------8651 sample_num
```sql
SELECT 
    COUNT(c.report_no) / 12 AS average_crime_rate_per_month
FROM 
    Crime c
JOIN 
    Community_Area ca ON c.community_area_no = ca.community_area_no
WHERE 
    ca.population = (SELECT MAX(population) FROM Community_Area);
```
-------------------------8652 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN f.title = 'Larceny' THEN c.report_no END) * 100.0 / COUNT(c.report_no)) AS larceny_percentage
FROM 
    Crime c
JOIN 
    Community_Area ca ON c.community_area_no = ca.community_area_no
JOIN 
    FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE 
    ca.side = 'Central';
```
-------------------------8653 sample_num
```sql
SELECT c.location_description, 
       CONCAT(w.alderman_first_name, ' ', w.alderman_last_name, ' ', w.alderman_name_suffix) AS alderman_full_name
FROM Crime c
JOIN IUCR i ON c.iucr_no = i.iucr_no
JOIN Ward w ON c.ward_no = w.ward_no
WHERE i.primary_description = 'ARSON' 
  AND i.secondary_description = 'BY EXPLOSIVE';
```
-------------------------8654 sample_num
```sql
SELECT date, latitude, longitude 
FROM Crime 
WHERE iucr_no IN (
    SELECT iucr_no 
    FROM IUCR 
    WHERE primary_description = 'DECEPTIVE PRACTICE' 
    AND secondary_description = 'UNLAWFUL USE OF RECORDED SOUND'
);
```
-------------------------8655 sample_num
```sql
SELECT COUNT(*) 
FROM Crime c
JOIN District d ON c.district_no = d.district_no
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE f.title = 'Criminal Sexual Assault' 
AND d.commander = 'Adnardo Gutierrez' 
AND c.location_description = 'RESIDENCE';
```
-------------------------8656 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN arrest = 'TRUE' THEN report_no END) * 100.0 / COUNT(report_no)) AS percent_arrested
FROM 
    Crime 
WHERE 
    domestic = 'TRUE' 
    AND community_area_no IN (SELECT community_area_no FROM Community_Area WHERE community_area_name = 'West Pullman');
```
-------------------------8657 sample_num
```sql
WITH domestic_cases AS (
    SELECT report_no
    FROM Crime
    WHERE domestic = 'TRUE' AND ward_no IN (
        SELECT ward_no
        FROM Ward
        WHERE alderman_first_name = 'Christopher' AND alderman_last_name = 'Taliaferro'
    )
),
total_cases AS (
    SELECT report_no
    FROM Crime
    WHERE ward_no IN (
        SELECT ward_no
        FROM Ward
        WHERE alderman_first_name = 'Christopher' AND alderman_last_name = 'Taliaferro'
    )
),
bank_cases AS (
    SELECT report_no
    FROM Crime
    WHERE location_description = 'BANK' AND ward_no IN (
        SELECT ward_no
        FROM Ward
        WHERE alderman_first_name = 'Christopher' AND alderman_last_name = 'Taliaferro'
    )
)

SELECT 
    (COUNT(dc.report_no) * 100.0 / NULLIF(COUNT(tc.report_no), 0)) AS domestic_percentage,
    STRING_AGG(bc.report_no, ', ') AS bank_report_numbers
FROM domestic_cases dc
JOIN total_cases tc ON 1=1
LEFT JOIN bank_cases bc ON dc.report_no = bc.report_no;
```
-------------------------8658 sample_num
```sql
SELECT COUNT(*) 
FROM Ward 
WHERE alderman_first_name = 'James';
```
-------------------------8659 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE date LIKE '1/1/2018%';
```
-------------------------8660 sample_num
```sql
SELECT AVG(population) AS average_population
FROM Community_Area
WHERE side = 'West';
```
-------------------------8661 sample_num
```sql
SELECT report_no 
FROM Crime 
WHERE ward_no = (SELECT ward_no FROM Ward WHERE alderman_first_name = 'Edward' AND alderman_last_name = 'Burke') 
AND community_area_no = (SELECT community_area_no FROM Community_Area ORDER BY population DESC LIMIT 1) 
ORDER BY beat DESC 
LIMIT 1;
```
-------------------------8662 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE location_description = 'STREET' 
AND fbi_code_no = (SELECT fbi_code_no FROM FBI_Code WHERE title = 'Homicide 1st & 2nd Degree');
```
-------------------------8663 sample_num
```sql
SELECT CONCAT(ward.alderman_first_name, ' ', ward.alderman_last_name, ' ', ward.alderman_name_suffix) AS alderman_name
FROM Crime
JOIN Ward ON Crime.ward_no = Ward.ward_no
WHERE Crime.report_no = 23769;
```
-------------------------8664 sample_num
```sql
SELECT c.case_number
FROM Crime c
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
WHERE c.domestic = 'TRUE' AND ca.community_area_name = 'Lincoln Square';
```
-------------------------8665 sample_num
```sql
SELECT c.case_number 
FROM Crime c 
JOIN Ward w ON c.ward_no = w.ward_no 
WHERE w.ward_office_address = '1958 N. Milwaukee Ave.' 
AND c.location_description = 'APARTMENT';
```
-------------------------8666 sample_num
```sql
SELECT COUNT(beat) 
FROM Crime 
WHERE community_area_no = (SELECT community_area_no FROM Community_Area WHERE community_area_name = 'Bridgeport') 
AND beat < 1000;
```
-------------------------8667 sample_num
```sql
SELECT c.report_no
FROM Crime c
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
WHERE ca.side = 'Far North' AND ca.population > 60000;
```
-------------------------8668 sample_num
```sql
SELECT c.report_no
FROM Crime c
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE f.crime_against = 'Property' AND ca.community_area_name = 'Riverdale';
```
-------------------------8669 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
JOIN Ward ON Crime.ward_no = Ward.ward_no 
WHERE Crime.domestic = 'TRUE' AND Ward.ward_email = 'ward13@cityofchicago.org';
```
-------------------------8670 sample_num
```sql
SELECT d.address 
FROM Crime c 
JOIN District d ON c.district_no = d.district_no 
WHERE c.case_number = 'JB107731';
```
-------------------------8671 sample_num
```sql
SELECT SUM(c.beat) AS total_beat
FROM Crime c
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
WHERE ca.side = 'Central' AND ca.population > 50000;
```
-------------------------8672 sample_num
```sql
SELECT case_number 
FROM Crime 
WHERE fbi_code_no IN (SELECT fbi_code_no FROM FBI_Code WHERE crime_against = 'Society') 
AND date LIKE '6/%/2018%';
```
-------------------------8673 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.domestic = 'TRUE' THEN 1 END) * 100.0 / COUNT(*)) AS domestic_violence_percentage
FROM 
    Crime c
JOIN 
    Community_Area ca ON c.community_area_no = ca.community_area_no
WHERE 
    ca.population = (SELECT MAX(population) FROM Community_Area);
```
-------------------------8674 sample_num
```sql
SELECT c.case_number
FROM Crime c
JOIN Ward w ON c.ward_no = w.ward_no
WHERE w.Population < 52000 
AND c.beat > (SELECT AVG(beat) * 0.9 FROM Crime);
```
-------------------------8675 sample_num
```sql
SELECT community_area_name 
FROM Community_Area 
WHERE side = 'Far North' AND population BETWEEN 50000 AND 70000;
```
-------------------------8676 sample_num
```sql
SELECT latitude, longitude 
FROM Crime 
WHERE location_description = 'ALLEY' AND arrest = 'TRUE';
```
-------------------------8677 sample_num
```sql
SELECT commander, email, phone 
FROM District 
WHERE district_name = 'Ogden';
```
-------------------------8678 sample_num
```sql
SELECT fbi_code_no, description 
FROM FBI_Code 
WHERE title = 'Gambling';
```
-------------------------8679 sample_num
```sql
SELECT (COUNT(CASE WHEN iucr.index_code = 'I' THEN 1 END) * 100.0 / COUNT(iucr.iucr_no)) AS severe_percentage
FROM Crime
JOIN IUCR iucr ON Crime.iucr_no = iucr.iucr_no;
```
-------------------------8680 sample_num
```sql
SELECT location_description, COUNT(case_number) AS crime_count
FROM Crime
WHERE district_no IN (SELECT district_no FROM District WHERE district_name = 'Austin')
GROUP BY location_description
ORDER BY crime_count DESC
LIMIT 1;
```
-------------------------8681 sample_num
```sql
SELECT AVG(community_area_count) AS average_community_areas_per_side
FROM (
    SELECT side, COUNT(DISTINCT community_area_no) AS community_area_count
    FROM Community_Area
    GROUP BY side
) AS side_community_areas;
```
-------------------------8682 sample_num
```sql
SELECT community_area_no
FROM Crime
WHERE location_description = 'STREET'
GROUP BY community_area_no
ORDER BY COUNT(location_description) DESC
LIMIT 1;
```
-------------------------8683 sample_num
```sql
SELECT district.district_name, 
       COUNT(crime.report_no) AS reckless_homicide_count,
       COUNT(crime.district_no) AS total_districts,
       COUNT(crime.report_no) * 1.0 / COUNT(crime.district_no) AS average_reckless_homicides
FROM Crime crime
JOIN IUCR iucr ON crime.iucr_no = iucr.iucr_no
JOIN District district ON crime.district_no = district.district_no
WHERE iucr.secondary_description = 'RECKLESS HOMICIDE'
GROUP BY district.district_name;
```
-------------------------8684 sample_num
```sql
SELECT w.ward_office_address, w.ward_office_phone
FROM Ward w
JOIN Crime c ON w.ward_no = c.ward_no
WHERE c.arrest = 'FALSE'
GROUP BY w.ward_no, w.ward_office_address, w.ward_office_phone
ORDER BY COUNT(c.arrest) DESC
LIMIT 1;
```
-------------------------8685 sample_num
```sql
SELECT case_number, latitude, longitude 
FROM Crime 
WHERE iucr_no IN (SELECT iucr_no FROM IUCR WHERE secondary_description = 'CHILD ABDUCTION');
```
-------------------------8686 sample_num
```sql
SELECT iucr.secondary_description, COUNT(*) AS crime_count
FROM Crime AS c
JOIN IUCR AS iucr ON c.iucr_no = iucr.iucr_no
JOIN Community_Area AS ca ON c.community_area_no = ca.community_area_no
WHERE ca.side = 'Northwest'
GROUP BY iucr.secondary_description
ORDER BY crime_count DESC
LIMIT 1;
```
-------------------------8687 sample_num
```sql
SELECT community_area_no
FROM Crime
WHERE domestic = 'TRUE'
GROUP BY community_area_no
ORDER BY COUNT(*) ASC
LIMIT 1;
```
-------------------------8688 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN iucr.secondary_description LIKE '%CANNABIS%' THEN 1 END) * 100.0 / COUNT(*)) AS cannabis_percentage
FROM 
    Crime c
JOIN 
    IUCR iucr ON c.iucr_no = iucr.iucr_no
JOIN 
    FBI_Code fbi ON c.fbi_code_no = fbi.fbi_code_no
WHERE 
    fbi.title = 'Drug Abuse';
```
-------------------------8689 sample_num
```sql
SELECT COUNT(case_number) / 28.0 AS average_less_severe_crimes_per_day
FROM Crime
WHERE date LIKE '2/%/2018' AND iucr_no IN (SELECT iucr_no FROM IUCR WHERE index_code = 'N');
```
-------------------------8690 sample_num
```sql
SELECT ca.community_area_name, ca.population
FROM Community_Area ca
JOIN Crime c ON ca.community_area_no = c.community_area_no
JOIN IUCR i ON c.iucr_no = i.iucr_no
WHERE i.secondary_description = 'SOLICIT FOR PROSTITUTE'
GROUP BY ca.community_area_no, ca.community_area_name, ca.population
HAVING COUNT(c.iucr_no) > (SELECT COUNT(*) * 1.0 / COUNT(i2.iucr_no)
                            FROM Crime c2
                            JOIN IUCR i2 ON c2.iucr_no = i2.iucr_no
                            WHERE i2.secondary_description = 'SOLICIT FOR PROSTITUTE');
```
-------------------------8691 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN f.title = 'Disorderly Conduct' THEN 1 END) * 100.0 / COUNT(c.report_no)) AS percentage
FROM 
    Crime c
JOIN 
    District d ON c.district_no = d.district_no
JOIN 
    FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE 
    d.district_name = 'Harrison';
```
-------------------------8692 sample_num
```sql
SELECT 
    district_no,
    AVG(CASE WHEN secondary_description = 'VEHICULAR HIJACKING' THEN 1 ELSE 0 END) AS avg_vehicular_hijacking,
    AVG(CASE WHEN secondary_description = 'AGGRAVATED VEHICULAR HIJACKING' THEN 1 ELSE 0 END) AS avg_aggravated_vehicular_hijacking,
    AVG(CASE WHEN secondary_description = 'VEHICULAR HIJACKING' THEN 1 ELSE 0 END) - 
    AVG(CASE WHEN secondary_description = 'AGGRAVATED VEHICULAR HIJACKING' THEN 1 ELSE 0 END) AS difference
FROM 
    Crime
GROUP BY 
    district_no;
```
-------------------------8693 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE longitude = -8772658001;
```
-------------------------8694 sample_num
```sql
SELECT * 
FROM Crime 
WHERE iucr_no IN (
    SELECT iucr_no 
    FROM IUCR 
    WHERE primary_description = 'NARCOTICS'
);
```
-------------------------8695 sample_num
```sql
SELECT alderman_first_name 
FROM Ward 
WHERE Population > 50000;
```
-------------------------8696 sample_num
```sql
SELECT c.report_no
FROM Crime c
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE f.title = 'Drug Abuse';
```
-------------------------8697 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
JOIN District ON Crime.district_no = District.district_no 
JOIN IUCR ON Crime.iucr_no = IUCR.iucr_no 
WHERE District.district_name = 'Calumet' 
AND IUCR.primary_description = 'WEAPON VIOLATION';
```
-------------------------8698 sample_num
```sql
SELECT latitude, longitude 
FROM Crime 
WHERE community_area_no = (SELECT community_area_no FROM Community_Area WHERE community_area_name = 'Belmont Cragin');
```
-------------------------8699 sample_num
```sql
SELECT COUNT(DISTINCT iucr.primary_description) AS different_crime_types
FROM Crime c
JOIN Neighborhood n ON c.community_area_no = n.community_area_no
JOIN IUCR iucr ON c.iucr_no = iucr.iucr_no
WHERE n.neighborhood_name = 'Hermosa';
```
-------------------------8700 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
JOIN District ON Crime.district_no = District.district_no 
WHERE Crime.domestic = 'TRUE' 
AND District.commander = 'Ronald A. Pontecore Jr.';
```
-------------------------8701 sample_num
```sql
SELECT COUNT(*) 
FROM Crime c
JOIN District d ON c.district_no = d.district_no
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE d.district_name = 'Wentworth' AND f.crime_against = 'Society';
```
-------------------------8702 sample_num
```sql
SELECT d.phone 
FROM District d 
JOIN Crime c ON d.district_no = c.district_no 
JOIN Ward w ON c.ward_no = w.ward_no 
WHERE w.alderman_first_name = 'Emma' AND w.alderman_last_name = 'Mitts' 
LIMIT 1;
```
-------------------------8703 sample_num
```sql
SELECT COUNT(*) 
FROM Crime c
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
WHERE f.description = 'The theft of a motor vehicle' 
AND ca.community_area_name = 'Lake View';
```
-------------------------8704 sample_num
```sql
SELECT d.district_name, COUNT(c.case_number) AS intimidation_count
FROM Crime c
JOIN District d ON c.district_no = d.district_no
JOIN IUCR i ON c.iucr_no = i.iucr_no
WHERE i.primary_description = 'INTIMIDATION'
GROUP BY d.district_name
ORDER BY intimidation_count DESC
LIMIT 1;
```
-------------------------8705 sample_num
```sql
SELECT iucr.primary_description, COUNT(*) AS domestic_crime_count
FROM Crime c
JOIN IUCR iucr ON c.iucr_no = iucr.iucr_no
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
WHERE c.domestic = 'TRUE' AND ca.community_area_name = 'North Lawndale'
GROUP BY iucr.primary_description
ORDER BY domestic_crime_count DESC
LIMIT 1;
```
-------------------------8706 sample_num
```sql
SELECT w.ward_no
FROM Ward w
JOIN Crime c ON w.ward_no = c.ward_no
JOIN IUCR i ON c.iucr_no = i.iucr_no
WHERE w.Population > 55000 
  AND i.primary_description = 'INTIMIDATION' 
  AND i.secondary_description = 'EXTORTION'
GROUP BY w.ward_no
ORDER BY COUNT(c.ward_no) DESC;
```
-------------------------8707 sample_num
```sql
SELECT d.commander, COUNT(c.case_number) AS case_count
FROM Crime c
JOIN District d ON c.district_no = d.district_no
JOIN IUCR i ON c.iucr_no = i.iucr_no
WHERE i.secondary_description = 'CRIMINAL SEXUAL ABUSE'
GROUP BY d.commander
ORDER BY case_count DESC
LIMIT 1;
```
-------------------------8708 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN domestic = 'FALSE' THEN case_number END) * 100.0 / COUNT(case_number)) AS percentage_non_domestic
FROM 
    Crime
WHERE 
    district_no = (SELECT district_no FROM District WHERE district_name = 'Jefferson Park');
```
-------------------------8709 sample_num
```sql
SELECT AVG(w.Population) AS average_population
FROM Crime c
JOIN Ward w ON c.ward_no = w.ward_no
WHERE c.location_description = 'APARTMENT' AND c.arrest = 'FALSE';
```
-------------------------8710 sample_num
```sql
SELECT CONCAT(a.alderman_first_name, ' ', a.alderman_last_name) AS full_name
FROM Ward a
ORDER BY a.Population DESC
LIMIT 5;
```
-------------------------8711 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE fbi_code_no IN (SELECT fbi_code_no FROM FBI_Code WHERE crime_against = 'Property');
```
-------------------------8712 sample_num
```sql
SELECT COUNT(*) 
FROM District 
WHERE zip_code = '60608';
```
-------------------------8713 sample_num
```sql
SELECT *
FROM Crime
JOIN FBI_Code ON Crime.fbi_code_no = FBI_Code.fbi_code_no
WHERE FBI_Code.title = 'Criminal Sexual Abuse';
```
-------------------------8714 sample_num
```sql
SELECT ca.community_area_name
FROM Community_Area ca
JOIN Neighborhood n ON ca.community_area_no = n.community_area_no
GROUP BY ca.community_area_name
ORDER BY COUNT(n.neighborhood_name) DESC
LIMIT 1;
```
-------------------------8715 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE latitude = 41.64820151 AND longitude = -87.54430496 AND iucr_no IN (SELECT iucr_no FROM IUCR WHERE index_code = 'I');
```
-------------------------8716 sample_num
```sql
SELECT d.commander
FROM Crime c
JOIN District d ON c.district_no = d.district_no
WHERE c.arrest = 'FALSE'
GROUP BY d.district_no, d.commander
ORDER BY COUNT(c.report_no) DESC
LIMIT 1;
```
-------------------------8717 sample_num
```sql
SELECT iucr.primary_description AS general_description, 
       iucr.secondary_description AS specific_description
FROM Crime c
JOIN IUCR iucr ON c.iucr_no = iucr.iucr_no
WHERE c.location_description = 'AIRCRAFT'
GROUP BY iucr.primary_description, iucr.secondary_description
HAVING COUNT(c.iucr_no) = (
    SELECT MAX(crime_count)
    FROM (
        SELECT COUNT(iucr_no) AS crime_count
        FROM Crime
        WHERE location_description = 'AIRCRAFT'
        GROUP BY iucr_no
    ) AS subquery
);
```
-------------------------8718 sample_num
```sql
SELECT district_no, district_name, COUNT(*) AS crime_count
FROM Crime
WHERE district_no IN (
    SELECT district_no FROM District WHERE district_name IN ('Deering', 'Near West')
) AND location_description = 'LIBRARY'
GROUP BY district_no, district_name
ORDER BY crime_count DESC
LIMIT 1;
```
-------------------------8719 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE iucr_no IN (
    SELECT iucr_no 
    FROM IUCR 
    WHERE primary_description = 'BURGLARY' 
    AND secondary_description = 'FORCIBLE ENTRY'
) 
AND location_description = 'DAY CARE CENTER' 
AND arrest = 'TRUE';
```
-------------------------8720 sample_num
```sql
SELECT d.district_name
FROM Crime c
JOIN District d ON c.district_no = d.district_no
WHERE c.domestic = 'TRUE'
GROUP BY d.district_name
ORDER BY COUNT(c.case_number) DESC
LIMIT 1;
```
-------------------------8721 sample_num
```sql
SELECT location_description
FROM Crime
WHERE community_area_no = (
    SELECT community_area_no
    FROM Community_Area
    WHERE population = (SELECT MIN(population) FROM Community_Area)
)
GROUP BY location_description
ORDER BY COUNT(location_description) DESC
LIMIT 1;
```
-------------------------8722 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE arrest = 'FALSE';
```
-------------------------8723 sample_num
```sql
SELECT latitude, longitude
FROM Crime
WHERE iucr_no IN (SELECT iucr_no FROM IUCR WHERE primary_description = 'Simple Assault')
AND community_area_no = (SELECT community_area_no FROM Community_Area WHERE community_area_name = 'Chatham')
GROUP BY latitude, longitude
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------8724 sample_num
```sql
SELECT ca.community_area_name
FROM Crime c
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE f.description = 'unlawful taking, carrying, leading, or riding away of property from the possession or constructive possession of another person'
AND ca.side = 'South'
GROUP BY ca.community_area_name
ORDER BY COUNT(c.fbi_code_no) DESC
LIMIT 1;
```
-------------------------8725 sample_num
```sql
SELECT COUNT(*) 
FROM Crime c
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE ca.community_area_name = 'Englewood' 
AND f.crime_against = 'Society';
```
-------------------------8726 sample_num
```sql
WITH FraudIncidents AS (
    SELECT 
        location_description,
        COUNT(report_no) AS incident_count
    FROM 
        Crime
    WHERE 
        fbi_code_no IN (SELECT fbi_code_no FROM FBI_Code WHERE title = 'Fraud') AND
        SUBSTR(date, 1, 1) = '1' AND 
        SUBSTR(date, 5, 4) = '2018'
    GROUP BY 
        location_description
),
WeeklyAverage AS (
    SELECT 
        AVG(incident_count) AS weekly_average
    FROM 
        FraudIncidents
)
SELECT 
    weekly_average,
    location_description
FROM 
    WeeklyAverage,
    (SELECT location_description FROM FraudIncidents ORDER BY incident_count DESC LIMIT 1) AS MajorityLocation;
```
-------------------------8727 sample_num
```sql
SELECT community_area_name 
FROM Community_Area 
WHERE population > 50000 
LIMIT 3;
```
-------------------------8728 sample_num
```sql
SELECT community_area_name 
FROM Community_Area 
WHERE side = 'Central';
```
-------------------------8729 sample_num
```sql
SELECT 
    (SELECT COUNT(community_area_no) FROM Community_Area WHERE side = 'South' AND population > 30000) - 
    (SELECT COUNT(community_area_no) FROM Community_Area WHERE side = 'North' AND population > 30000) AS difference;
```
-------------------------8730 sample_num
```sql
SELECT phone, fax, tty, twitter 
FROM District 
WHERE district_name = 'Near West';
```
-------------------------8731 sample_num
```sql
SELECT commander 
FROM District 
WHERE district_name = 'Lincoln';
```
-------------------------8732 sample_num
```sql
SELECT iucr.primary_description AS general_description, iucr.secondary_description AS specific_description
FROM IUCR iucr
WHERE iucr.iucr_no = 275;
```
-------------------------8733 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN iucr.primary_description = 'CRIME SEXUAL ASSAULT' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_severe_sexual_assault
FROM 
    Crime c
JOIN 
    IUCR iucr ON c.iucr_no = iucr.iucr_no
WHERE 
    iucr.index_code = 'I';
```
-------------------------8734 sample_num
```sql
SELECT n.neighborhood_name 
FROM Neighborhood n 
JOIN Community_Area ca ON n.community_area_no = ca.community_area_no 
WHERE ca.community_area_name = 'North Center';
```
-------------------------8735 sample_num
```sql
SELECT COUNT(neighborhood_name) 
FROM Neighborhood 
WHERE community_area_no = (SELECT community_area_no FROM Community_Area WHERE community_area_name = 'Forest Glen');
```
-------------------------8736 sample_num
```sql
SELECT SUM(ca.population) AS total_population
FROM Neighborhood n
JOIN Community_Area ca ON n.community_area_no = ca.community_area_no
WHERE n.neighborhood_name IN ('Avondale Gardens', 'Irving Park', 'Kilbourn Park', 'Merchant Park', 'Old Irving Park', 'The Villa');
```
-------------------------8737 sample_num
```sql
SELECT COUNT(report_no) 
FROM Crime 
WHERE fbi_code_no IN (
    SELECT fbi_code_no 
    FROM FBI_Code 
    WHERE title = 'Weapons Violation'
);
```
-------------------------8738 sample_num
```sql
SELECT DISTINCT case_number
FROM Crime
JOIN FBI_Code ON Crime.fbi_code_no = FBI_Code.fbi_code_no
WHERE FBI_Code.title = 'Criminal Sexual Assault'
AND FBI_Code.crime_against = 'Persons'
AND Crime.arrest = 'TRUE'
LIMIT 3;
```
-------------------------8739 sample_num
```sql
SELECT d.district_name 
FROM Crime c 
JOIN District d ON c.district_no = d.district_no 
WHERE c.case_number = 'JB106545';
```
-------------------------8740 sample_num
```sql
SELECT IUCR.primary_description 
FROM Crime 
JOIN IUCR ON Crime.iucr_no = IUCR.iucr_no 
WHERE Crime.case_number = 'JB106010';
```
-------------------------8741 sample_num
```sql
SELECT DISTINCT ca.community_area_name
FROM Community_Area ca
JOIN Crime c ON ca.community_area_no = c.community_area_no
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE f.title = 'Fraud Incident'
LIMIT 3;
```
-------------------------8742 sample_num
```sql
SELECT f.title AS major_crime_type
FROM Crime c
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE ca.community_area_name = 'Rogers Park'
GROUP BY f.title
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------8743 sample_num
```sql
SELECT d.district_name
FROM Crime c
JOIN District d ON c.district_no = d.district_no
WHERE c.case_number = 'JB120039'
GROUP BY d.district_name
HAVING COUNT(c.case_number) > 1;
```
-------------------------8744 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.fbi_code_no IN (SELECT f.fbi_code_no FROM FBI_Code f WHERE f.title = 'Drug Abuse') AND c.location_description = 'STREET' THEN 1 END) * 100.0) / COUNT(c.fbi_code_no) AS percentage
FROM 
    Crime c;
```
-------------------------8745 sample_num
```sql
SELECT ward_no 
FROM Ward 
ORDER BY Population DESC 
LIMIT 1;
```
-------------------------8746 sample_num
```sql
SELECT beat, location_description 
FROM Crime 
WHERE case_number = 'JB112212';
```
-------------------------8747 sample_num
```sql
SELECT fbi_code_no 
FROM FBI_Code 
WHERE description = 'The killing of one human being by another.';
```
-------------------------8748 sample_num
```sql
SELECT DISTINCT w.ward_office_address
FROM Crime c
JOIN Community_Area ca ON c.community_area_no = ca.community_area_no
JOIN Ward w ON c.ward_no = w.ward_no
WHERE ca.community_area_name = 'Montclare'
LIMIT 5;
```
-------------------------8749 sample_num
```sql
SELECT d.commander
FROM Crime c
JOIN District d ON c.district_no = d.district_no
WHERE c.location_description = 'YARD' AND c.beat = 532;
```
-------------------------8750 sample_num
```sql
SELECT n.neighborhood_name 
FROM Neighborhood n 
JOIN Community_Area ca ON n.community_area_no = ca.community_area_no 
WHERE ca.community_area_name = 'Lake View';
```
-------------------------8751 sample_num
```sql
SELECT n.neighborhood_name 
FROM Crime c 
JOIN Neighborhood n ON c.community_area_no = n.community_area_no 
WHERE c.report_no = 23843;
```
-------------------------8752 sample_num
```sql
SELECT f.description 
FROM Crime c 
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no 
WHERE c.report_no = 23778;
```
-------------------------8753 sample_num
```sql
SELECT c.report_no
FROM Crime c
JOIN District d ON c.district_no = d.district_no
WHERE d.commander = 'Jill M. Stevens';
```
-------------------------8754 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.location_description = 'HOUSE' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_inside_house
FROM 
    Crime c
JOIN 
    Neighborhood n ON c.community_area_no = n.community_area_no
WHERE 
    n.neighborhood_name = 'Avalon Park';
```
-------------------------8755 sample_num
```sql
SELECT CONCAT(alderman_first_name, ' ', alderman_last_name, ' ', alderman_name_suffix) AS full_name
FROM Ward
WHERE ward_no = 21;
```
-------------------------8756 sample_num
```sql
SELECT ward_no 
FROM Ward 
ORDER BY Population DESC 
LIMIT 1;
```
-------------------------8757 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE iucr_no IN (SELECT iucr_no FROM IUCR WHERE primary_description = 'ASSAULT');
```
-------------------------8758 sample_num
```sql
SELECT COUNT(*) AS severe_incidents
FROM Crime
WHERE iucr_no IN (
    SELECT iucr_no
    FROM IUCR
    WHERE index_code = 'I'
);
```
-------------------------8759 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE arrest = 'FALSE' 
AND ward_no = (SELECT ward_no FROM Ward WHERE alderman_first_name = 'Pat' AND alderman_last_name = 'Dowell');
```
-------------------------8760 sample_num
```sql
SELECT CONCAT(w.alderman_first_name, ' ', w.alderman_last_name, ' ', w.alderman_name_suffix) AS full_name
FROM Crime c
JOIN Ward w ON c.ward_no = w.ward_no
WHERE SUBSTR(c.date, 1, 1) = '1' AND SUBSTR(c.date, 5, 4) = '2018'
GROUP BY w.ward_no, w.alderman_first_name, w.alderman_last_name, w.alderman_name_suffix
ORDER BY COUNT(c.ward_no) DESC
LIMIT 1;
```
-------------------------8761 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE ward_no = (
    SELECT ward_no 
    FROM Ward 
    WHERE Population = (SELECT MAX(Population) FROM Ward)
) AND domestic = 'TRUE';
```
-------------------------8762 sample_num
```sql
SELECT latitude, longitude 
FROM Crime 
WHERE ward_no = (SELECT ward_no FROM Ward WHERE alderman_first_name = 'Pat' AND alderman_last_name = 'Dowell');
```
-------------------------8763 sample_num
```sql
SELECT 
    w.alderman_first_name, 
    w.alderman_last_name, 
    COUNT(c.report_no) AS incident_count
FROM 
    Crime c
JOIN 
    Ward w ON c.ward_no = w.ward_no
WHERE 
    SUBSTR(c.date, 1, 2) = '01' AND 
    SUBSTR(c.date, 4, 4) = '2018' AND 
    (w.alderman_first_name = 'Pat' AND w.alderman_last_name = 'Dowell' OR 
     w.alderman_first_name = 'Sophia' AND w.alderman_last_name = 'King')
GROUP BY 
    w.alderman_first_name, 
    w.alderman_last_name
ORDER BY 
    incident_count DESC
LIMIT 1;
```
-------------------------8764 sample_num
```sql
SELECT c.case_number
FROM Crime c
JOIN IUCR i ON c.iucr_no = i.iucr_no
WHERE i.primary_description = 'BATTERY';
```
-------------------------8765 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE iucr_no IN (SELECT iucr_no FROM IUCR WHERE primary_description = 'BATTERY') 
AND arrest = 'FALSE';
```
-------------------------8766 sample_num
```sql
SELECT c.case_number
FROM Crime c
JOIN FBI_Code f ON c.fbi_code_no = f.fbi_code_no
WHERE f.title = 'Homicide 1st & 2nd Degree';
```
-------------------------8767 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
JOIN FBI_Code ON Crime.fbi_code_no = FBI_Code.fbi_code_no 
WHERE Substr(date, 1, 1) = '1' AND Substr(date, 5, 4) = '2018' 
AND FBI_Code.crime_against = 'Property';
```
-------------------------8768 sample_num
```sql
SELECT COUNT(*) 
FROM Crime 
WHERE district_no IN (
    SELECT district_no 
    FROM District 
    WHERE commander = 'Robert A. Rubio'
) 
AND SUBSTR(date, 1, 1) = '1' 
AND SUBSTR(date, 5, 4) = '2018';
```
-------------------------8769 sample_num
```sql
SELECT commander, COUNT(*) AS incident_count
FROM Crime
JOIN District ON Crime.district_no = District.district_no
WHERE (commander = 'Robert A. Rubio' OR commander = 'Glenn White')
AND SUBSTR(date, 1, 2) = '01' AND SUBSTR(date, 7, 4) = '2018'
GROUP BY commander
ORDER BY incident_count DESC
LIMIT 1;
```
-------------------------8770 sample_num
```sql
SELECT DISTINCT c.block
FROM Crime c
JOIN District d ON c.district_no = d.district_no
WHERE d.commander = 'Robert A. Rubio';
```
-------------------------8771 sample_num
```sql
SELECT AVG(monthly_incidents) AS average_incidents_per_month
FROM (
    SELECT COUNT(c.case_number) AS monthly_incidents
    FROM Crime c
    JOIN Ward w ON c.ward_no = w.ward_no
    WHERE w.Population = (SELECT MAX(Population) FROM Ward)
      AND c.date LIKE '%2018%'
    GROUP BY MONTH(c.date)
) AS monthly_counts;
```
-------------------------8772 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN iucr.primary_description = 'BATTERY' THEN 1 END) * 100.0 / COUNT(*)) AS battery_percentage
FROM 
    Crime crime
JOIN 
    IUCR iucr ON crime.iucr_no = iucr.iucr_no
WHERE 
    crime.arrest = 'FALSE';
```
-------------------------8773 sample_num
```sql
SELECT COUNT(*) 
FROM businesses 
WHERE owner_state = 'CA';
```
-------------------------8774 sample_num
```sql
SELECT COUNT(DISTINCT business_id) AS restaurant_count
FROM inspections
WHERE score = 100;
```
-------------------------8775 sample_num
```sql
SELECT COUNT(*) 
FROM inspections 
WHERE YEAR(date) = 2016 AND type = 'Routine - Unscheduled';
```
-------------------------8776 sample_num
```sql
SELECT b.name 
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE i.score = 100;
```
-------------------------8777 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM businesses b 
JOIN inspections i ON b.business_id = i.business_id 
WHERE YEAR(i.date) = 2016 AND b.city IN ('San Francisco', 'SF', 'S.F.', 'SAN FRANCISCO');
```
-------------------------8778 sample_num
```sql
SELECT type 
FROM inspections 
WHERE business_id = (SELECT business_id FROM businesses WHERE name = 'Tiramisu Kitchen') 
AND date = '2014-01-14';
```
-------------------------8779 sample_num
```sql
SELECT COUNT(*) 
FROM violations v
JOIN inspections i ON v.business_id = i.business_id AND v.date = i.date
JOIN businesses b ON i.business_id = b.business_id
WHERE b.name = 'Tiramisu Kitchen' 
AND i.date = '2014-01-14' 
AND v.risk_category = 'Low Risk';
```
-------------------------8780 sample_num
```sql
SELECT DISTINCT b.name
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
JOIN violations v ON b.business_id = v.business_id AND i.date = v.date
WHERE YEAR(i.date) = 2014 AND v.risk_category = 'Low Risk';
```
-------------------------8781 sample_num
```sql
SELECT description 
FROM violations 
WHERE business_id = (SELECT business_id FROM businesses WHERE name = 'Tiramisu Kitchen') 
AND date = '2014-01-14' 
AND risk_category = 'Low Risk';
```
-------------------------8782 sample_num
```sql
SELECT v.description 
FROM violations v 
JOIN businesses b ON v.business_id = b.business_id 
WHERE b.name = 'Tiramisu Kitchen' AND v.risk_category = 'High Risk';
```
-------------------------8783 sample_num
```sql
SELECT COUNT(*) 
FROM inspections 
WHERE business_id = (SELECT business_id FROM businesses WHERE name = 'Tiramisu Kitchen') 
AND type = 'Routine - Unscheduled';
```
-------------------------8784 sample_num
```sql
SELECT COUNT(*) 
FROM inspections 
WHERE business_id = (SELECT business_id FROM businesses WHERE name = 'Tiramisu Kitchen') 
AND type = 'Routine - Unscheduled' 
AND score > 70;
```
-------------------------8785 sample_num
```sql
SELECT name, COUNT(*) AS low_risk_violations
FROM violations
WHERE business_id IN (
    SELECT business_id FROM businesses WHERE name IN ('Tiramisu Kitchen', 'OMNI S.F. Hotel - 2nd Floor Pantry')
) AND risk_category = 'Low Risk'
GROUP BY name
ORDER BY low_risk_violations DESC
LIMIT 1;
```
-------------------------8786 sample_num
```sql
SELECT COUNT(*) AS total_high_risk_violations
FROM violations v
JOIN businesses b ON v.business_id = b.business_id
WHERE b.city IN ('San Francisco', 'SF', 'S.F.', 'SAN FRANCISCO')
AND v.risk_category = 'High Risk';
```
-------------------------8787 sample_num
```sql
SELECT b.name, COUNT(v.violation_type_id) AS high_risk_count
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.risk_category = 'High Risk'
GROUP BY b.business_id
ORDER BY high_risk_count DESC
LIMIT 1;
```
-------------------------8788 sample_num
```sql
SELECT AVG(i.score) AS average_score
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE b.name = 'Tiramisu Kitchen';
```
-------------------------8789 sample_num
```sql
SELECT business_id
FROM inspections
GROUP BY business_id
ORDER BY COUNT(business_id) DESC
LIMIT 1;
```
-------------------------8790 sample_num
```sql
SELECT business_id
FROM violations
GROUP BY business_id
ORDER BY COUNT(business_id) DESC
LIMIT 1;
```
-------------------------8791 sample_num
```sql
SELECT b.name 
FROM businesses b 
JOIN inspections i ON b.business_id = i.business_id 
WHERE i.score = 100 
AND i.type = 'Routine - Unscheduled' 
AND i.date = '2016-09-28';
```
-------------------------8792 sample_num
```sql
SELECT b.name
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.risk_category = 'High'
GROUP BY b.business_id, b.name
ORDER BY COUNT(v.business_id) DESC
LIMIT 1;
```
-------------------------8793 sample_num
```sql
SELECT COUNT(DISTINCT violation_type_id) 
FROM violations 
WHERE business_id = (SELECT business_id FROM businesses WHERE name = 'Stacks Restaurant') 
AND date = '2016-10-04';
```
-------------------------8794 sample_num
```sql
SELECT v.description 
FROM violations v 
JOIN businesses b ON v.business_id = b.business_id 
WHERE b.name = 'Chez Fayala, Inc.' 
AND v.risk_category = 'Moderate Risk' 
AND v.date = '2016-07-01';
```
-------------------------8795 sample_num
```sql
SELECT b.name
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE i.type = 'Routine - Unscheduled' AND i.date = '2016-09-26'
ORDER BY i.score ASC
LIMIT 1;
```
-------------------------8796 sample_num
```sql
SELECT b.name
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE i.type = 'Complaint'
GROUP BY b.business_id, b.name
ORDER BY COUNT(i.business_id) DESC
LIMIT 1;
```
-------------------------8797 sample_num
```sql
SELECT COUNT(*) 
FROM inspections 
JOIN businesses ON inspections.business_id = businesses.business_id 
WHERE businesses.name = 'Soma Restaurant And Bar' 
AND inspections.type = 'Routine - Unscheduled';
```
-------------------------8798 sample_num
```sql
SELECT b.address
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.risk_category = 'Low Risk'
GROUP BY b.business_id, b.address
HAVING COUNT(v.business_id) = (
    SELECT MAX(low_risk_count)
    FROM (
        SELECT COUNT(business_id) AS low_risk_count
        FROM violations
        WHERE risk_category = 'Low Risk'
        GROUP BY business_id
    ) AS counts
);
```
-------------------------8799 sample_num
```sql
SELECT b.name
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.risk_category = 'Low Risk' AND v.description = 'Permit license or inspection report not posted'
ORDER BY v.date ASC
LIMIT 1;
```
-------------------------8800 sample_num
```sql
SELECT COUNT(i.business_id) AS inspection_count
FROM inspections i
JOIN (
    SELECT business_id
    FROM violations
    GROUP BY business_id
    ORDER BY COUNT(*) DESC
    LIMIT 1
) v ON i.business_id = v.business_id;
```
-------------------------8801 sample_num
```sql
SELECT COUNT(*) 
FROM violations 
WHERE business_id = (SELECT business_id FROM businesses WHERE business_certificate = '304977') 
AND date = '2013-10-07';
```
-------------------------8802 sample_num
```sql
SELECT AVG(score) AS average_score
FROM inspections i
JOIN businesses b ON i.business_id = b.business_id
WHERE b.name = 'Chairman Bao' AND i.type = 'Routine - Unscheduled';
```
-------------------------8803 sample_num
```sql
SELECT 
    DIVIDE(COUNT(CASE WHEN v.risk_category = 'Moderate Risk' THEN 1 END), COUNT(v.business_id)) * 100 AS percentage
FROM 
    businesses b
JOIN 
    violations v ON b.business_id = v.business_id
WHERE 
    b.name = 'Melody Lounge';
```
-------------------------8804 sample_num
```sql
SELECT COUNT(*) FROM businesses WHERE city = 'HAYWARD';
```
-------------------------8805 sample_num
```sql
SELECT COUNT(DISTINCT business_id) 
FROM inspections 
WHERE score < 50;
```
-------------------------8806 sample_num
```sql
SELECT COUNT(*) 
FROM businesses 
WHERE application_date BETWEEN '2012-01-01' AND '2012-12-31';
```
-------------------------8807 sample_num
```sql
SELECT COUNT(*) 
FROM inspections 
WHERE type = 'Foodborne Illness Investigation' 
AND date BETWEEN '2014-01-01' AND '2014-12-31';
```
-------------------------8808 sample_num
```sql
SELECT owner_name, COUNT(business_id) AS establishment_count
FROM businesses
GROUP BY owner_name
HAVING COUNT(business_id) >= 5;
```
-------------------------8809 sample_num
```sql
SELECT b.name 
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE i.score = 100 AND YEAR(i.date) = 2013;
```
-------------------------8810 sample_num
```sql
SELECT city, COUNT(DISTINCT b.business_id) AS establishment_count
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.risk_category = 'High Risk' AND YEAR(v.date) = 2016
GROUP BY city
ORDER BY establishment_count DESC
LIMIT 1;
```
-------------------------8811 sample_num
```sql
SELECT b.name 
FROM businesses b 
JOIN inspections i ON b.business_id = i.business_id 
WHERE i.score = (SELECT MIN(score) FROM inspections);
```
-------------------------8812 sample_num
```sql
SELECT COUNT(*) 
FROM violations 
WHERE business_id = (SELECT business_id FROM businesses WHERE name = 'Tiramisu Kitchen') 
AND risk_category = 'High Risk';
```
-------------------------8813 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE b.tax_code = 'H24' AND i.type = 'Complaint'
GROUP BY b.business_id
HAVING COUNT(i.business_id) >= 5;
```
-------------------------8814 sample_num
```sql
SELECT DISTINCT b.name
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.description = 'Contaminated or adulterated food' AND v.date LIKE '2013%';
```
-------------------------8815 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) 
FROM businesses b 
JOIN inspections i ON b.business_id = i.business_id 
WHERE b.postal_code = '94102' AND i.score >= 90 AND YEAR(i.date) = 2015;
```
-------------------------8816 sample_num
```sql
SELECT b.name
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE i.score = 100
GROUP BY b.business_id
HAVING COUNT(DISTINCT YEAR(i.date)) = 4;
```
-------------------------8817 sample_num
```sql
SELECT AVG(i.score) AS average_inspection_score
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE b.owner_name = 'Yiu Tim Chan'
  AND b.address = '808 Pacific Ave'
  AND b.city = 'San Francisco'
  AND YEAR(i.date) BETWEEN 2014 AND 2016;
```
-------------------------8818 sample_num
```sql
SELECT AVG(i.score) AS average_score
FROM inspections i
JOIN businesses b ON i.business_id = b.business_id
WHERE b.owner_name = (
    SELECT owner_name
    FROM businesses
    GROUP BY owner_name
    ORDER BY COUNT(business_id) DESC
    LIMIT 1
);
```
-------------------------8819 sample_num
```sql
SELECT b.name
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.risk_category = 'Low Risk' AND YEAR(v.date) = 2014
GROUP BY b.business_id
ORDER BY COUNT(v.violation_type_id) DESC
LIMIT 1;
```
-------------------------8820 sample_num
```sql
SELECT owner_name
FROM (
    SELECT b.owner_name, COUNT(b.business_id) AS establishment_count
    FROM businesses b
    GROUP BY b.owner_name
    ORDER BY establishment_count DESC
    LIMIT 5
) AS top_owners
JOIN (
    SELECT v.business_id, COUNT(v.risk_category) AS high_risk_count
    FROM violations v
    WHERE v.risk_category = 'High Risk'
    GROUP BY v.business_id
) AS high_risk_violations ON top_owners.owner_name = (SELECT owner_name FROM businesses WHERE business_id = high_risk_violations.business_id)
ORDER BY high_risk_count DESC
LIMIT 1;
```
-------------------------8821 sample_num
```sql
SELECT b.name, AVG(i.score) AS average_score
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
GROUP BY b.business_id
ORDER BY COUNT(i.business_id) DESC
LIMIT 1;
```
-------------------------8822 sample_num
```sql
SELECT COUNT(DISTINCT business_id) 
FROM inspections 
WHERE score = 100 AND YEAR(date) = 2013;
```
-------------------------8823 sample_num
```sql
SELECT business_id 
FROM inspections 
WHERE type = 'Structural Inspection' 
AND YEAR(date) = 2016 
AND MONTH(date) = 2;
```
-------------------------8824 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS low_risk_eateries
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.risk_category = 'Low Risk' 
AND v.description LIKE '%unpermitted food facility%';
```
-------------------------8825 sample_num
```sql
SELECT business_id, risk_category, description 
FROM violations 
WHERE violation_type_id = '103101';
```
-------------------------8826 sample_num
```sql
SELECT MAX(i.date) AS highest_score_date
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE b.city = 'San Bruno' AND i.score = 100;
```
-------------------------8827 sample_num
```sql
SELECT i.type AS inspection_type, v.description AS violation_description
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
JOIN violations v ON b.business_id = v.business_id
WHERE b.name = "ART's CAFÉ" AND v.risk_category = 'Moderate Risk';
```
-------------------------8828 sample_num
```sql
SELECT violation_type_id, description 
FROM violations 
WHERE business_id IN (SELECT business_id FROM businesses WHERE name = 'STARBUCKS') 
AND risk_category = 'High Risk';
```
-------------------------8829 sample_num
```sql
SELECT i.date, i.score, i.type
FROM inspections i
JOIN businesses b ON i.business_id = b.business_id
WHERE b.tax_code = 'AA';
```
-------------------------8830 sample_num
```sql
SELECT b.business_id, b.name, b.address
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE i.date = '2016-07-30';
```
-------------------------8831 sample_num
```sql
SELECT v.date, v.risk_category, v.description, b.name
FROM violations v
JOIN businesses b ON v.business_id = b.business_id
WHERE b.owner_name = 'Jade Chocolates LLC';
```
-------------------------8832 sample_num
```sql
SELECT b.name, v.risk_category, v.description
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.violation_type_id = 103111;
```
-------------------------8833 sample_num
```sql
SELECT b.name, b.city, b.tax_code
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.date = '2014-06-03' AND v.risk_category = 'High Risk'
LIMIT 5;
```
-------------------------8834 sample_num
```sql
SELECT type 
FROM inspections 
WHERE business_id = (SELECT business_id FROM businesses WHERE name = 'El Aji Peruvian Restaurant') 
AND score = (SELECT MAX(score) FROM inspections WHERE business_id = (SELECT business_id FROM businesses WHERE name = 'El Aji Peruvian Restaurant'));
```
-------------------------8835 sample_num
```sql
SELECT DISTINCT b.owner_name
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.risk_category = 'High Risk' 
AND v.description = 'Improper cooking time or temperatures';
```
-------------------------8836 sample_num
```sql
SELECT b.name, b.address
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE i.date = '2015-02-02' AND i.type = 'Reinspection/Followup';
```
-------------------------8837 sample_num
```sql
SELECT b.name, b.business_certificate
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE i.score < 50;
```
-------------------------8838 sample_num
```sql
SELECT COUNT(*) 
FROM businesses 
WHERE address = '1825 POST St #223' AND city = 'San Francisco';
```
-------------------------8839 sample_num
```sql
SELECT owner_name FROM businesses WHERE owner_zip = '94104';
```
-------------------------8840 sample_num
```sql
SELECT COUNT(*) AS total_businesses
FROM businesses
WHERE tax_code = 'H25';
```
-------------------------8841 sample_num
```sql
SELECT COUNT(*) 
FROM violations 
WHERE YEAR(date) = 2014 AND risk_category = 'Low Risk';
```
-------------------------8842 sample_num
```sql
SELECT b.business_id, v.risk_category
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE b.owner_name = 'San Francisco Madeleine, Inc.';
```
-------------------------8843 sample_num
```sql
SELECT b.owner_name 
FROM businesses b 
JOIN inspections i ON b.business_id = i.business_id 
WHERE i.score = 100;
```
-------------------------8844 sample_num
```sql
SELECT COUNT(DISTINCT b.business_id) AS total_high_risk_businesses
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE b.postal_code = '94117' AND v.risk_category = 'High Risk';
```
-------------------------8845 sample_num
```sql
SELECT v.violation_type_id, v.risk_category
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
JOIN violations v ON b.business_id = v.business_id
WHERE i.score BETWEEN 70 AND 80;
```
-------------------------8846 sample_num
```sql
SELECT b.tax_code, i.type
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE b.name = 'Rue Lepic';
```
-------------------------8847 sample_num
```sql
SELECT b.name 
FROM businesses b 
JOIN violations v ON b.business_id = v.business_id 
JOIN inspections i ON b.business_id = i.business_id 
WHERE v.violation_type_id = 103157 
AND v.date = '2016-05-27' 
AND i.type = 'Routine - Unscheduled';
```
-------------------------8848 sample_num
```sql
SELECT b.owner_name
FROM businesses b
JOIN violations v ON b.business_id = v.business_id
WHERE v.violation_type_id = 103109 
  AND v.risk_category = 'High Risk' 
  AND v.description = 'Unclean or unsanitary food contact surfaces';
```
-------------------------8849 sample_num
```sql
SELECT b.name 
FROM businesses b 
JOIN inspections i ON b.business_id = i.business_id 
WHERE b.owner_city = 'Cameron Park' AND i.score = 100;
```
-------------------------8850 sample_num
```sql
SELECT violation_type_id 
FROM violations 
WHERE business_id BETWEEN 30 AND 50 
AND business_id IN (SELECT business_id FROM businesses WHERE address = '747 IRVING St' AND city = 'San Francisco');
```
-------------------------8851 sample_num
```sql
SELECT b.owner_name 
FROM businesses b 
JOIN violations v ON b.business_id = v.business_id 
WHERE v.violation_type_id = 103156 AND v.date = '2014-06-12';
```
-------------------------8852 sample_num
```sql
SELECT i.type
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
WHERE b.owner_address = '500 California St, 2nd Floor' AND b.owner_city = 'SAN FRANCISCO'
ORDER BY i.score DESC
LIMIT 1;
```
-------------------------8853 sample_num
```sql
SELECT COUNT(*) 
FROM violations v
JOIN inspections i ON v.business_id = i.business_id AND v.date = i.date
WHERE YEAR(v.date) = 2016 AND i.type = 'Routine - Unschedule';
```
-------------------------8854 sample_num
```sql
SELECT b.name, v.risk_category
FROM businesses b
JOIN inspections i ON b.business_id = i.business_id
JOIN violations v ON b.business_id = v.business_id
WHERE i.score > (0.8 * (SELECT AVG(score) FROM inspections));
```
-------------------------8855 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN v.risk_category = 'Low Risk' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    businesses b
JOIN 
    inspections i ON b.business_id = i.business_id
JOIN 
    violations v ON b.business_id = v.business_id
WHERE 
    i.score < 95 AND b.postal_code = '94110';
```
-------------------------8856 sample_num
```sql
SELECT DISTINCT b.state
FROM breweries b
JOIN beers br ON b.id = br.brewery_id
WHERE br.ibu = (SELECT MIN(ibu) FROM beers);
```
-------------------------8857 sample_num
```sql
SELECT b.name AS brewery_name, br.city
FROM breweries br
JOIN beers b ON br.id = b.brewery_id
WHERE br.state = 'NY'
ORDER BY b.ibu DESC
LIMIT 1;
```
-------------------------8858 sample_num
```sql
SELECT AVG(abv) AS average_abv
FROM beers
JOIN breweries ON beers.brewery_id = breweries.id
WHERE breweries.name = 'Boston Beer Company' AND beers.ounces = 12;
```
-------------------------8859 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN b.style = 'American Adjunct Lager' THEN 1 END) * 100.0 / COUNT(*)) AS percent_allotted
FROM 
    breweries br
JOIN 
    beers b ON br.id = b.brewery_id
WHERE 
    br.name = 'Stevens Point Brewery';
```
-------------------------8860 sample_num
```sql
WITH BitterBeers AS (
    SELECT b.city, b.state, MAX(be.ibu) AS max_ibu, MIN(be.ibu) AS min_ibu
    FROM breweries b
    JOIN beers be ON b.id = be.brewery_id
    GROUP BY b.city, b.state
),
MostLeastBitter AS (
    SELECT city, state, max_ibu, min_ibu, (max_ibu - min_ibu) AS bitterness_difference
    FROM BitterBeers
)
SELECT mlb.city, mlb.state, mlb.max_ibu, mlb.min_ibu, mlb.bitterness_difference, 
       (SELECT GROUP_CONCAT(be.name) 
        FROM beers be 
        JOIN breweries b ON b.id = be.brewery_id 
        WHERE b.city = mlb.city AND b.state = mlb.state AND be.ibu = mlb.max_ibu) AS most_bitter_beers,
       (SELECT GROUP_CONCAT(be.name) 
        FROM beers be 
        JOIN breweries b ON b.id = be.brewery_id 
        WHERE b.city = mlb.city AND b.state = mlb.state AND be.ibu = mlb.min_ibu) AS least_bitter_beers
FROM MostLeastBitter mlb;
```
-------------------------8861 sample_num
```sql
SELECT 
    (COUNT(DISTINCT b.id) * 100.0 / (SELECT COUNT(*) FROM breweries)) AS percentage
FROM 
    breweries br
JOIN 
    beers b ON br.id = b.brewery_id
WHERE 
    b.style = 'American Blonde Ale' AND br.state = 'Wisconsin';
```
-------------------------8862 sample_num
```sql
SELECT r.title
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
ORDER BY n.total_fat DESC
LIMIT 1;
```
-------------------------8863 sample_num
```sql
SELECT (n.total_fat - n.sat_fat) AS unsaturated_fat
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
WHERE r.title = 'Raspberry Chiffon Pie';
```
-------------------------8864 sample_num
```sql
SELECT r.title 
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
WHERE n.sodium < 5;
```
-------------------------8865 sample_num
```sql
SELECT r.title 
FROM Recipe r 
JOIN Nutrition n ON r.recipe_id = n.recipe_id 
WHERE n.iron > 20;
```
-------------------------8866 sample_num
```sql
SELECT title, vitamin_c 
FROM Recipe 
JOIN Nutrition ON Recipe.recipe_id = Nutrition.recipe_id 
WHERE title IN ('Raspberry Chiffon Pie', 'Fresh Apricot Bavarian') 
ORDER BY vitamin_c DESC 
LIMIT 1;
```
-------------------------8867 sample_num
```sql
SELECT title 
FROM Recipe 
WHERE prep_min > 10 
ORDER BY (SELECT calories FROM Nutrition WHERE recipe_id = Recipe.recipe_id) DESC 
LIMIT 1;
```
-------------------------8868 sample_num
```sql
SELECT calories FROM Nutrition 
JOIN Recipe ON Nutrition.recipe_id = Recipe.recipe_id 
WHERE Recipe.title = 'Raspberry Chiffon Pie';
```
-------------------------8869 sample_num
```sql
SELECT optional 
FROM Quantity q 
JOIN Recipe r ON q.recipe_id = r.recipe_id 
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id 
WHERE i.name = 'graham cracker crumbs' AND r.title = 'Raspberry Chiffon Pie';
```
-------------------------8870 sample_num
```sql
SELECT COUNT(*) AS rationed_ingredients
FROM Quantity q
JOIN Recipe r ON q.recipe_id = r.recipe_id
WHERE r.title = 'Raspberry Chiffon Pie' AND q.max_qty = q.min_qty;
```
-------------------------8871 sample_num
```sql
SELECT i.name 
FROM Ingredient i
JOIN Quantity q ON i.ingredient_id = q.ingredient_id
JOIN Recipe r ON q.recipe_id = r.recipe_id
WHERE r.title = 'Raspberry Chiffon Pie' AND q.preparation IS NULL;
```
-------------------------8872 sample_num
```sql
SELECT COUNT(DISTINCT q.recipe_id) AS recipe_count
FROM Quantity q
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE i.name = 'graham cracker crumbs';
```
-------------------------8873 sample_num
```sql
SELECT MIN(q.max_qty) AS min_cups
FROM Quantity q
JOIN Recipe r ON q.recipe_id = r.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE r.title = 'Raspberry Chiffon Pie' AND i.name = 'graham cracker crumbs' AND q.unit = 'cups';
```
-------------------------8874 sample_num
```sql
SELECT (n.calories * n.pcnt_cal_fat) / 100 AS calories_from_fat
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
WHERE r.title = 'Raspberry Chiffon Pie';
```
-------------------------8875 sample_num
```sql
SELECT AVG(calories) AS average_calories
FROM Nutrition n
JOIN Recipe r ON n.recipe_id = r.recipe_id
WHERE r.source = 'Produce for Better Health Foundation and 5 a Day';
```
-------------------------8876 sample_num
```sql
SELECT calories 
FROM Nutrition 
WHERE recipe_id = (SELECT recipe_id FROM Recipe WHERE title = 'turkey tenderloin bundles');
```
-------------------------8877 sample_num
```sql
SELECT max_qty 
FROM Quantity 
WHERE recipe_id = 1436 AND ingredient_id = (SELECT ingredient_id FROM Ingredient WHERE name = '1% lowfat milk');
```
-------------------------8878 sample_num
```sql
SELECT r.title
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
WHERE n.total_fat = (SELECT MAX(total_fat) FROM Nutrition);
```
-------------------------8879 sample_num
```sql
SELECT COUNT(*) 
FROM Quantity q
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE i.name = 'seedless red grapes';
```
-------------------------8880 sample_num
```sql
SELECT i.name 
FROM Quantity q 
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id 
WHERE q.recipe_id = 1397 AND q.optional = 'TRUE';
```
-------------------------8881 sample_num
```sql
SELECT r.title
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE i.name = 'frozen raspberries in light syrup' AND q.max_qty = q.min_qty
ORDER BY q.max_qty DESC
LIMIT 1;
```
-------------------------8882 sample_num
```sql
SELECT name 
FROM Ingredient 
WHERE ingredient_id = (
    SELECT ingredient_id 
    FROM Quantity 
    GROUP BY ingredient_id 
    ORDER BY COUNT(ingredient_id) DESC 
    LIMIT 1
);
```
-------------------------8883 sample_num
```sql
SELECT preparation 
FROM Quantity q
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
JOIN Recipe r ON q.recipe_id = r.recipe_id
WHERE i.name = 'apple juice' AND r.title = 'raspberry-pear couscous cake';
```
-------------------------8884 sample_num
```sql
SELECT q.max_qty
FROM Quantity q
JOIN Recipe r ON q.recipe_id = r.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE r.title = 'chicken pocket sandwich' AND i.name = 'almonds' AND q.unit = 'cups';
```
-------------------------8885 sample_num
```sql
SELECT r.title 
FROM Recipe r 
JOIN Nutrition n ON r.recipe_id = n.recipe_id 
WHERE n.vitamin_c = (SELECT MAX(vitamin_c) FROM Nutrition);
```
-------------------------8886 sample_num
```sql
SELECT n.vitamin_a 
FROM Recipe r 
JOIN Nutrition n ON r.recipe_id = n.recipe_id 
WHERE r.title = 'Sherried Beef';
```
-------------------------8887 sample_num
```sql
SELECT r.title
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
GROUP BY r.recipe_id, r.title
ORDER BY COUNT(DISTINCT q.ingredient_id) DESC
LIMIT 1;
```
-------------------------8888 sample_num
```sql
SELECT 
    (SELECT sodium FROM Nutrition n JOIN Recipe r ON n.recipe_id = r.recipe_id WHERE r.title = 'Lasagne-Spinach Spirals') / 
    (SELECT sodium FROM Nutrition n JOIN Recipe r ON n.recipe_id = r.recipe_id WHERE r.title = 'Beef and Spinach Pita Pockets') AS sodium_ratio;
```
-------------------------8889 sample_num
```sql
SELECT AVG(n.calories) AS average_calories
FROM Nutrition n
JOIN Quantity q ON n.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE i.name = 'coarsely ground black pepper';
```
-------------------------8890 sample_num
```sql
SELECT r.title 
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
WHERE n.iron > 20;
```
-------------------------8891 sample_num
```sql
SELECT COUNT(*) 
FROM Quantity 
WHERE recipe_id = (SELECT recipe_id FROM Recipe WHERE title = 'Apricot Yogurt Parfaits');
```
-------------------------8892 sample_num
```sql
SELECT i.name 
FROM Ingredient i
JOIN Quantity q ON i.ingredient_id = q.ingredient_id
WHERE q.preparation LIKE '%cook in beef broth%';
```
-------------------------8893 sample_num
```sql
SELECT COUNT(q.ingredient_id) AS ingredient_count
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
JOIN Quantity q ON r.recipe_id = q.recipe_id
WHERE n.vitamin_a = (SELECT MAX(vitamin_a) FROM Nutrition);
```
-------------------------8894 sample_num
```sql
SELECT r.title
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
ORDER BY n.vitamin_c DESC
LIMIT 5;
```
-------------------------8895 sample_num
```sql
SELECT ingredient_id
FROM Quantity
GROUP BY ingredient_id
ORDER BY COUNT(recipe_id) ASC
LIMIT 1;
```
-------------------------8896 sample_num
```sql
SELECT COUNT(*) 
FROM Ingredient i
JOIN Quantity q ON i.ingredient_id = q.ingredient_id
JOIN Recipe r ON q.recipe_id = r.recipe_id
WHERE i.category = 'baking product' AND r.title = 'No-Bake Chocolate Cheesecake';
```
-------------------------8897 sample_num
```sql
SELECT i.name, q.max_qty, q.min_qty, q.unit
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE r.title = 'Strawberry Sorbet';
```
-------------------------8898 sample_num
```sql
SELECT i.name, q.max_qty, q.min_qty, q.unit, q.preparation
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE r.title = 'Warm Chinese Chicken Salad' AND q.optional = 'TRUE';
```
-------------------------8899 sample_num
```sql
SELECT title, MAX(prep_min) AS longest_prep_time
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
WHERE n.alcohol > 10
GROUP BY r.recipe_id, r.title
ORDER BY longest_prep_time DESC
LIMIT 1;
```
-------------------------8900 sample_num
```sql
SELECT servings 
FROM Recipe 
WHERE recipe_id = (
    SELECT recipe_id 
    FROM Nutrition 
    ORDER BY (total_fat - sat_fat) DESC 
    LIMIT 1
);
```
-------------------------8901 sample_num
```sql
SELECT r.title, n.calories
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
WHERE r.source = 'National Potato Board'
ORDER BY n.calories DESC
LIMIT 1;
```
-------------------------8902 sample_num
```sql
SELECT r.recipe_id, r.title, (SUM(q.max_qty) + SUM(q.min_qty) + r.prep_min + r.cook_min + r.stnd_min) AS total_time
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
GROUP BY r.recipe_id
ORDER BY COUNT(q.ingredient_id) DESC
LIMIT 1;
```
-------------------------8903 sample_num
```sql
SELECT 
    i.name, 
    COUNT(q.ingredient_id) AS appearance_count,
    (COUNT(q.ingredient_id) * 100.0 / (SELECT COUNT(*) FROM Quantity)) AS appearance_percentage
FROM 
    Quantity q
JOIN 
    Ingredient i ON q.ingredient_id = i.ingredient_id
GROUP BY 
    i.ingredient_id
ORDER BY 
    appearance_count DESC
LIMIT 1;
```
-------------------------8904 sample_num
```sql
SELECT r.title, (r.prep_min + r.cook_min + r.stnd_min) AS total_time
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
ORDER BY n.total_fat DESC
LIMIT 1;
```
-------------------------8905 sample_num
```sql
SELECT r.title 
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE i.name = 'almond extract';
```
-------------------------8906 sample_num
```sql
SELECT i.name, q.max_qty, q.min_qty, q.unit
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE r.title = 'Tomato-Cucumber Relish';
```
-------------------------8907 sample_num
```sql
SELECT COUNT(*) AS ingredient_count
FROM Quantity q
JOIN Recipe r ON q.recipe_id = r.recipe_id
WHERE r.title = 'Idaho Potato Supreme';
```
-------------------------8908 sample_num
```sql
SELECT i.name, q.max_qty, q.min_qty, q.unit
FROM Ingredient i
JOIN Quantity q ON i.ingredient_id = q.ingredient_id
WHERE q.recipe_id = (
    SELECT recipe_id
    FROM Nutrition
    ORDER BY carbo DESC
    LIMIT 1
);
```
-------------------------8909 sample_num
```sql
SELECT r.title 
FROM Recipe r 
JOIN Nutrition n ON r.recipe_id = n.recipe_id 
WHERE n.iron > 20;
```
-------------------------8910 sample_num
```sql
SELECT i.*
FROM Ingredient i
JOIN Quantity q ON i.ingredient_id = q.ingredient_id
JOIN Recipe r ON q.recipe_id = r.recipe_id
JOIN Nutrition n ON r.recipe_id = n.recipe_id
WHERE n.vitamin_a = (SELECT MAX(vitamin_a) FROM Nutrition);
```
-------------------------8911 sample_num
```sql
SELECT i.name, q.max_qty
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE r.servings = 7;
```
-------------------------8912 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN sodium BETWEEN 0 AND 5 THEN recipe_id END) * 100.0) / COUNT(recipe_id) AS percentage_sodium_free
FROM 
    Recipe r
JOIN 
    Nutrition n ON r.recipe_id = n.recipe_id
WHERE 
    r.source = 'The California Tree Fruit Agreement';
```
-------------------------8913 sample_num
```sql
SELECT * FROM Ingredient 
WHERE ingredient_id IN (
    SELECT ingredient_id FROM Quantity 
    WHERE unit = 'slice(s)'
);
```
-------------------------8914 sample_num
```sql
SELECT COUNT(DISTINCT r.recipe_id) AS recipe_count
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE i.category = 'canned dairy';
```
-------------------------8915 sample_num
```sql
SELECT r.title, (r.prep_min + r.cook_min + r.stnd_min) AS total_time
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE i.name = 'lima beans'
GROUP BY r.recipe_id
HAVING COUNT(DISTINCT i.ingredient_id) = 1;
```
-------------------------8916 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN r.servings >= 10 THEN r.recipe_id END) * 100.0 / COUNT(r.recipe_id)) AS percent_serving_10_or_more
FROM 
    Recipe r
JOIN 
    Quantity q ON r.recipe_id = q.recipe_id
JOIN 
    Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE 
    i.name = 'sea bass';
```
-------------------------8917 sample_num
```sql
SELECT total_fat 
FROM Nutrition 
JOIN Recipe ON Nutrition.recipe_id = Recipe.recipe_id 
WHERE Recipe.title = 'Raspberry Chiffon Pie';
```
-------------------------8918 sample_num
```sql
SELECT n.pcnt_cal_prot 
FROM Recipe r 
JOIN Nutrition n ON r.recipe_id = n.recipe_id 
WHERE r.title = 'Raspberry Chiffon Pie';
```
-------------------------8919 sample_num
```sql
SELECT COUNT(*) AS ingredient_count
FROM Quantity q
JOIN Recipe r ON q.recipe_id = r.recipe_id
WHERE r.title = 'Raspberry Chiffon Pie';
```
-------------------------8920 sample_num
```sql
SELECT r.title 
FROM Recipe r 
JOIN Nutrition n ON r.recipe_id = n.recipe_id 
WHERE n.alcohol = 0;
```
-------------------------8921 sample_num
```sql
SELECT AVG(n.vitamin_c) AS average_vitamin_c
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
WHERE r.title LIKE '%cake%';
```
-------------------------8922 sample_num
```sql
SELECT COUNT(*) 
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE i.category = 'dairy' AND r.servings > 10;
```
-------------------------8923 sample_num
```sql
SELECT r.title
FROM Recipe r
JOIN Nutrition n ON r.recipe_id = n.recipe_id
WHERE n.iron > 20;
```
-------------------------8924 sample_num
```sql
SELECT title, calories 
FROM Recipe 
JOIN Nutrition ON Recipe.recipe_id = Nutrition.recipe_id 
ORDER BY calories DESC 
LIMIT 1;
```
-------------------------8925 sample_num
```sql
SELECT COUNT(DISTINCT r.recipe_id) AS non_dairy_recipes
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE i.category NOT LIKE '%dairy';
```
-------------------------8926 sample_num
```sql
SELECT i.name, q.max_qty, q.min_qty, q.unit
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
JOIN Ingredient i ON q.ingredient_id = i.ingredient_id
WHERE r.title = 'Apricot Yogurt Parfaits';
```
-------------------------8927 sample_num
```sql
SELECT DISTINCT r.recipe_id, r.title
FROM Recipe r
JOIN Quantity q ON r.recipe_id = q.recipe_id
WHERE q.max_qty <> q.min_qty;
```
-------------------------8928 sample_num
```sql
SELECT i.name, i.plural
FROM Ingredient i
JOIN Quantity q ON i.ingredient_id = q.ingredient_id
JOIN Recipe r ON q.recipe_id = r.recipe_id
WHERE r.cook_min = (SELECT MAX(cook_min) FROM Recipe);
```
-------------------------8929 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN n.cholestrl = 0 AND r.cook_min < 20 THEN r.recipe_id END) * 100.0) / COUNT(r.recipe_id) AS percentage_no_cholesterol_fast_cooking
FROM 
    Recipe r
JOIN 
    Nutrition n ON r.recipe_id = n.recipe_id;
```
-------------------------8930 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN n.calories > 200 THEN r.recipe_id END) * 100.0) / COUNT(r.recipe_id) AS percentage
FROM 
    Recipe r
JOIN 
    Quantity q ON r.recipe_id = q.recipe_id
JOIN 
    Ingredient i ON q.ingredient_id = i.ingredient_id
JOIN 
    Nutrition n ON r.recipe_id = n.recipe_id
WHERE 
    i.category = 'cheese';
```
-------------------------8931 sample_num
```sql
SELECT firstname, lastname 
FROM employee 
WHERE salary = (SELECT MAX(salary) FROM employee);
```
-------------------------8932 sample_num
```sql
SELECT COUNT(*) AS good_performance_count
FROM employee
WHERE performance = 'Good';
```
-------------------------8933 sample_num
```sql
SELECT ssn FROM employee WHERE gender = 'M' AND salary > 70000;
```
-------------------------8934 sample_num
```sql
SELECT educationrequired 
FROM position 
WHERE positiontitle = 'Regional Manager';
```
-------------------------8935 sample_num
```sql
SELECT positiontitle, MIN(minsalary) AS min_salary
FROM position
WHERE positiontitle IN ('Account Representative', 'Trainee')
GROUP BY positiontitle
ORDER BY min_salary ASC
LIMIT 1;
```
-------------------------8936 sample_num
```sql
SELECT l.locationcity 
FROM employee e 
JOIN location l ON e.locationID = l.locationID 
WHERE e.firstname = 'Sandy' AND e.lastname = 'Adams';
```
-------------------------8937 sample_num
```sql
SELECT COUNT(*) 
FROM employee e 
JOIN location l ON e.locationID = l.locationID 
WHERE l.state = 'NY' AND e.performance = 'Good';
```
-------------------------8938 sample_num
```sql
SELECT l.officephone 
FROM employee e 
JOIN location l ON e.locationID = l.locationID 
WHERE e.firstname = 'Sandy' AND e.lastname = 'Adams';
```
-------------------------8939 sample_num
```sql
SELECT COUNT(*) 
FROM employee e 
JOIN location l ON e.locationID = l.locationID 
WHERE e.gender = 'M' AND l.address = '450 Peachtree Rd';
```
-------------------------8940 sample_num
```sql
SELECT COUNT(*) 
FROM employee 
WHERE positionID IN (SELECT positionID FROM position WHERE positiontitle = 'Account Representative');
```
-------------------------8941 sample_num
```sql
SELECT e.salary - p.minsalary AS salary_difference
FROM employee e
JOIN position p ON e.positionID = p.positionID
WHERE e.firstname = 'James' AND e.lastname = 'Johnson';
```
-------------------------8942 sample_num
```sql
SELECT COUNT(*) 
FROM employee e 
JOIN position p ON e.positionID = p.positionID 
JOIN location l ON e.locationID = l.locationID 
WHERE p.positiontitle = 'Trainees' AND l.state = 'NY';
```
-------------------------8943 sample_num
```sql
SELECT CONCAT(firstname, ' ', lastname) AS full_name
FROM employee
WHERE positionID IN (SELECT positionID FROM position WHERE positiontitle = 'Trainee');
```
-------------------------8944 sample_num
```sql
SELECT e.firstname, e.lastname, p.educationrequired
FROM employee e
JOIN position p ON e.positionID = p.positionID
WHERE (e.firstname = 'Jose' AND e.lastname = 'Rodriguez') 
   OR (e.firstname = 'Sandy' AND e.lastname = 'Adams')
ORDER BY p.educationrequired DESC
LIMIT 1;
```
-------------------------8945 sample_num
```sql
SELECT DISTINCT l.zipcode
FROM employee e
JOIN location l ON e.locationID = l.locationID
WHERE e.gender = 'M' AND e.performance = 'Good';
```
-------------------------8946 sample_num
```sql
SELECT e.ssn 
FROM employee e 
JOIN location l ON e.locationID = l.locationID 
WHERE l.state = 'CA';
```
-------------------------8947 sample_num
```sql
SELECT COUNT(*) 
FROM employee 
WHERE positionID = (SELECT positionID FROM position WHERE positiontitle = 'Trainee') 
AND salary > 20000;
```
-------------------------8948 sample_num
```sql
SELECT AVG(salary) AS average_salary
FROM employee
WHERE positionID IN (SELECT positionID FROM position WHERE positiontitle = 'Trainee');
```
-------------------------8949 sample_num
```sql
SELECT (AVG(e.salary) - p.minsalary) / p.minsalary * 100 AS percentage_higher
FROM employee e
JOIN position p ON e.positionID = p.positionID
WHERE p.positiontitle = 'Trainee';
```
-------------------------8950 sample_num
```sql
SELECT COUNT(*) AS number_of_female_employees FROM employee WHERE gender = 'F';
```
-------------------------8951 sample_num
```sql
SELECT l.locationcity 
FROM employee e 
JOIN location l ON e.locationID = l.locationID 
WHERE e.firstname = 'Jose' AND e.lastname = 'Rodriguez';
```
-------------------------8952 sample_num
```sql
SELECT l.state 
FROM employee e 
JOIN location l ON e.locationID = l.locationID 
WHERE e.firstname = 'Emily' AND e.lastname = 'Wood';
```
-------------------------8953 sample_num
```sql
SELECT p.educationrequired 
FROM employee e 
JOIN position p ON e.positionID = p.positionID 
WHERE e.firstname = 'David' AND e.lastname = 'Whitehead';
```
-------------------------8954 sample_num
```sql
SELECT COUNT(*) 
FROM employee 
WHERE locationID IN (SELECT locationID FROM location WHERE locationcity = 'Miami');
```
-------------------------8955 sample_num
```sql
SELECT CONCAT(e.firstname, ' ', e.lastname) AS full_name
FROM employee e
JOIN location l ON e.locationID = l.locationID
WHERE l.locationcity = 'Boston'
ORDER BY e.salary DESC
LIMIT 1;
```
-------------------------8956 sample_num
```sql
SELECT e.ssn 
FROM employee e 
JOIN location l ON e.locationID = l.locationID 
WHERE l.locationcity = 'New York City' AND e.performance = 'Good';
```
-------------------------8957 sample_num
```sql
SELECT COUNT(*) 
FROM employee e
JOIN position p ON e.positionID = p.positionID
JOIN location l ON e.locationID = l.locationID
WHERE p.positiontitle = 'account representative' 
AND l.locationcity = 'Chicago' 
AND e.performance = 'Good';
```
-------------------------8958 sample_num
```sql
SELECT p.positiontitle 
FROM employee e 
JOIN position p ON e.positionID = p.positionID 
WHERE e.firstname = 'Kenneth' AND e.lastname = 'Charles';
```
-------------------------8959 sample_num
```sql
SELECT CONCAT(l.address, ', ', l.locationcity, ', ', l.state, ' ', l.zipcode) AS full_address
FROM employee e
JOIN position p ON e.positionID = p.positionID
JOIN location l ON e.locationID = l.locationID
WHERE p.positiontitle = 'manager' AND e.salary = (SELECT MAX(salary) FROM employee WHERE positionID IN (SELECT positionID FROM position WHERE positiontitle = 'manager'));
```
-------------------------8960 sample_num
```sql
SELECT MAX(p.maxsalary) 
FROM employee e 
JOIN position p ON e.positionID = p.positionID 
WHERE e.firstname = 'Tracy' AND e.lastname = 'Coulter';
```
-------------------------8961 sample_num
```sql
SELECT 
    (MAX(p.maxsalary) - e.salary) / e.salary * 100 AS salary_increase_percentage
FROM 
    employee e
JOIN 
    position p ON e.positionID = p.positionID
WHERE 
    e.firstname = 'Jose' AND e.lastname = 'Rodriguez';
```
-------------------------8962 sample_num
```sql
SELECT COUNT(*) 
FROM employee 
WHERE performance = 'Poor' AND salary > 50000;
```
-------------------------8963 sample_num
```sql
SELECT firstname, lastname 
FROM employee 
WHERE salary = (SELECT MAX(salary) FROM employee);
```
-------------------------8964 sample_num
```sql
SELECT COUNT(*) 
FROM position 
WHERE maxsalary <= 100000;
```
-------------------------8965 sample_num
```sql
SELECT salary 
FROM employee 
WHERE hiredate = (SELECT MIN(hiredate) FROM employee);
```
-------------------------8966 sample_num
```sql
SELECT minsalary 
FROM position 
WHERE educationrequired = (SELECT MAX(educationrequired) FROM position);
```
-------------------------8967 sample_num
```sql
SELECT CONCAT(address, ', ', locationcity, ', ', state, ' ', zipcode) AS full_office_location_address
FROM location
WHERE locationID = (
    SELECT locationID
    FROM employee
    GROUP BY locationID
    ORDER BY COUNT(*) DESC
    LIMIT 1
);
```
-------------------------8968 sample_num
```sql
SELECT AVG(salary) AS average_salary
FROM employee
WHERE positionID IN (
    SELECT positionID
    FROM position
    WHERE educationrequired = '2 year degree'
);
```
-------------------------8969 sample_num
```sql
SELECT COUNT(*) 
FROM employee 
WHERE gender = 'M' AND positionID IN (SELECT positionID FROM position WHERE positiontitle = 'Regional Manager');
```
-------------------------8970 sample_num
```sql
SELECT p.positiontitle
FROM employee e
JOIN position p ON e.positionID = p.positionID
WHERE e.performance = 'Poor'
GROUP BY p.positiontitle
ORDER BY COUNT(e.ssn) DESC
LIMIT 1;
```
-------------------------8971 sample_num
```sql
SELECT positionID
FROM employee
WHERE educationrequired = '2 year degree' AND gender = 'F'
GROUP BY positionID
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------8972 sample_num
```sql
SELECT COUNT(*) 
FROM employee e 
JOIN position p ON e.positionID = p.positionID 
JOIN location l ON e.locationID = l.locationID 
WHERE p.positiontitle = 'Account Representative' 
AND l.state = 'Illinois' 
AND e.performance = 'good';
```
-------------------------8973 sample_num
```sql
SELECT AVG(e.salary) AS average_salary
FROM employee e
JOIN position p ON e.positionID = p.positionID
WHERE e.performance = 'Poor' AND p.positiontitle = 'Manager';
```
-------------------------8974 sample_num
```sql
SELECT l.state, COUNT(e.ssn) AS good_performers
FROM employee e
JOIN position p ON e.positionID = p.positionID
JOIN location l ON e.locationID = l.locationID
WHERE e.performance = 'Good' AND p.positiontitle = 'Account Representative'
GROUP BY l.state
ORDER BY good_performers DESC
LIMIT 1;
```
-------------------------8975 sample_num
```sql
SELECT CONCAT(e.firstname, ' ', e.lastname) AS full_name, e.performance
FROM employee e
WHERE e.salary = (
    SELECT MIN(salary)
    FROM employee
    WHERE YEAR(hiredate) = YEAR(e.hiredate)
)
```
-------------------------8976 sample_num
```sql
SELECT locationcity 
FROM location 
WHERE state IN ('CO', 'UT', 'CA');
```
-------------------------8977 sample_num
```sql
SELECT locationcity, address FROM location WHERE zipcode > 90000;
```
-------------------------8978 sample_num
```sql
SELECT positiontitle 
FROM position 
WHERE educationrequired = '4 year degree';
```
-------------------------8979 sample_num
```sql
SELECT maxsalary FROM position WHERE positiontitle = 'Trainer';
```
-------------------------8980 sample_num
```sql
SELECT CONCAT(firstname, ' ', lastname) AS full_name, ssn
FROM employee
WHERE positionID = (SELECT positionID FROM position WHERE positiontitle = 'Account Representative')
AND performance = 'Average';
```
-------------------------8981 sample_num
```sql
SELECT hiredate, positionID, salary 
FROM employee 
WHERE firstname = 'Emily' AND lastname = 'Wood';
```
-------------------------8982 sample_num
```sql
SELECT p.positiontitle, p.minsalary, p.maxsalary
FROM employee e
JOIN position p ON e.positionID = p.positionID
WHERE e.firstname = 'Bill' AND e.lastname = 'Marlin';
```
-------------------------8983 sample_num
```sql
SELECT CONCAT(e.firstname, ' ', e.lastname) AS full_name, e.gender, p.positiontitle
FROM employee e
JOIN location l ON e.locationID = l.locationID
JOIN position p ON e.positionID = p.positionID
WHERE l.locationcity = 'New York City';
```
-------------------------8984 sample_num
```sql
SELECT CONCAT(e.firstname, ' ', e.lastname) AS full_name, e.hiredate, e.performance
FROM employee e
JOIN location l ON e.locationID = l.locationID
WHERE l.state = 'UT';
```
-------------------------8985 sample_num
```sql
SELECT CONCAT(e.firstname, ' ', e.lastname) AS full_name, l.locationcity, l.address, l.zipcode
FROM employee e
JOIN position p ON e.positionID = p.positionID
JOIN location l ON e.locationID = l.locationID
WHERE e.performance = 'Poor' AND p.positiontitle = 'Manager';
```
-------------------------8986 sample_num
```sql
SELECT 
    CONCAT(e.firstname, ' ', e.lastname) AS full_name, 
    e.salary, 
    p.educationrequired 
FROM 
    employee e 
JOIN 
    position p ON e.positionID = p.positionID 
WHERE 
    p.positiontitle = 'Account Representative' 
    AND e.performance = 'Poor';
```
-------------------------8987 sample_num
```sql
SELECT CONCAT(e.firstname, ' ', e.lastname) AS full_name, e.performance, l.locationcity
FROM employee e
JOIN location l ON e.locationID = l.locationID
WHERE e.ssn = '767-74-7373';
```
-------------------------8988 sample_num
```sql
SELECT CONCAT(e.firstname, ' ', e.lastname) AS full_name, 
       p.positiontitle, 
       l.locationcity, 
       l.officephone 
FROM employee e 
JOIN position p ON e.positionID = p.positionID 
JOIN location l ON e.locationID = l.locationID 
WHERE l.state = 'CO';
```
-------------------------8989 sample_num
```sql
SELECT 
    e.firstname, 
    e.lastname, 
    p.positiontitle, 
    l.locationcity, 
    MAX(e.salary) / 12 AS monthly_average_salary
FROM 
    employee e
JOIN 
    position p ON e.positionID = p.positionID
JOIN 
    location l ON e.locationID = l.locationID
WHERE 
    e.salary = (SELECT MAX(salary) FROM employee)
GROUP BY 
    e.firstname, e.lastname, p.positiontitle, l.locationcity;
```
-------------------------8990 sample_num
```sql
SELECT start_station_name, end_station_name
FROM trip
ORDER BY duration DESC
LIMIT 1;
```
-------------------------8991 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN subscription_type = 'Subscriber' THEN 1 END) * 100.0 / COUNT(id)) AS percentage
FROM 
    trip;
```
-------------------------8992 sample_num
```sql
SELECT end_station_name, city 
FROM trip 
JOIN station ON trip.end_station_id = station.id 
WHERE bike_id = 13 
AND end_date = (SELECT MAX(end_date) FROM trip WHERE bike_id = 13);
```
-------------------------8993 sample_num
```sql
SELECT trip.end_station_name, station.city
FROM trip
JOIN station ON trip.end_station_id = station.id
WHERE DATE(trip.start_date) <> DATE(trip.end_date;
```
-------------------------8994 sample_num
```sql
SELECT s.name, s.lat, s.long
FROM station s
JOIN status st ON s.id = st.station_id
WHERE st.bikes_available = 0 AND st.time = '2013-11-03 02:01:01';
```
-------------------------8995 sample_num
```sql
SELECT start_station_name, city
FROM trip
JOIN station ON trip.start_station_id = station.id
GROUP BY start_station_name, city
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------8996 sample_num
```sql
SELECT max_temperature_f 
FROM weather 
WHERE date = (SELECT start_date FROM trip WHERE id = 4080);
```
-------------------------8997 sample_num
```sql
SELECT s.name, st.time, MAX(st.bikes_available) AS max_bikes_available
FROM station s
JOIN status st ON s.id = st.station_id
WHERE s.name = 'San Jose Diridon Caltrain Station'
GROUP BY s.name, st.time
ORDER BY max_bikes_available DESC
LIMIT 1;
```
-------------------------8998 sample_num
```sql
SELECT trip.start_date, trip.duration
FROM trip
JOIN weather ON trip.start_date::date = weather.date
WHERE weather.events = 'Rain';
```
-------------------------8999 sample_num
```sql
SELECT start_date
FROM trip
WHERE end_station_id IN (
    SELECT id
    FROM station
    WHERE lat = 37.331415 AND long = -121.8932
);
```
-------------------------9000 sample_num
```sql
SELECT COUNT(*) AS bikes_borrowed
FROM trip
WHERE start_station_name = 'Redwood City' AND start_date LIKE '8%2013%';
```
-------------------------9001 sample_num
```sql
SELECT 
    trip.start_station_name, 
    trip.end_station_name, 
    weather.mean_temperature_f
FROM 
    trip
JOIN 
    weather ON DATE(trip.start_date) = weather.date
WHERE 
    trip.duration < 300;
```
-------------------------9002 sample_num
```sql
SELECT 
    t.start_date::date AS borrowing_day,
    AVG(w.min_temperature_f) AS average_coldest_temperature
FROM 
    trip t
JOIN 
    weather w ON t.start_date::date = w.date
WHERE 
    t.start_date::date = (
        SELECT 
            t2.start_date::date
        FROM 
            trip t2
        GROUP BY 
            t2.start_date::date
        ORDER BY 
            COUNT(t2.id) DESC
        LIMIT 1
    )
GROUP BY 
    borrowing_day;
```
-------------------------9003 sample_num
```sql
SELECT 
    trip.bike_id,
    SUM(trip.duration) / COUNT(trip.bike_id) AS average_usage,
    SUM(weather.wind_dir_degrees) / COUNT(weather.date) AS average_wind_direction
FROM 
    trip
JOIN 
    weather ON DATE(trip.start_date) = weather.date
WHERE 
    trip.start_date >= '2013-07-01' AND trip.start_date < '2013-10-01'
GROUP BY 
    trip.bike_id;
```
-------------------------9004 sample_num
```sql
SELECT name 
FROM station 
WHERE city = 'San Jose' 
AND installation_date BETWEEN '2014-01-01' AND '2014-12-31';
```
-------------------------9005 sample_num
```sql
SELECT MAX(duration) AS longest_trip_duration
FROM trip
WHERE start_date = '2013-08-29' AND end_date = '2013-08-29';
```
-------------------------9006 sample_num
```sql
SELECT duration / 60 AS duration_minutes
FROM trip
WHERE bike_id = 426
  AND start_station_name = 'Market at 4th'
  AND end_station_name = '2nd at South Park'
  AND start_date::date = '2013-08-29'
  AND end_date::date = '2013-08-29';
```
-------------------------9007 sample_num
```sql
SELECT bike_id
FROM trip
WHERE start_date = '2013-08-29' AND end_date = '2013-08-29'
  AND start_station_name = 'University and Emerson'
  AND end_station_name = 'California Ave Caltrain Station'
ORDER BY duration DESC
LIMIT 1;
```
-------------------------9008 sample_num
```sql
SELECT COUNT(*) 
FROM station 
WHERE city = 'San Francisco' AND dock_count > 20;
```
-------------------------9009 sample_num
```sql
SELECT date
FROM weather
WHERE max_temperature_f = (SELECT MAX(max_temperature_f) FROM weather);
```
-------------------------9010 sample_num
```sql
SELECT max_dew_point_f 
FROM weather 
WHERE date = '2014-07-15' AND zip_code = '94301';
```
-------------------------9011 sample_num
```sql
SELECT YEAR(date) AS year, COUNT(*) AS rain_count
FROM weather
WHERE events = 'Rain'
GROUP BY year
ORDER BY rain_count DESC
LIMIT 1;
```
-------------------------9012 sample_num
```sql
SELECT MIN(duration) AS fastest_trip_duration, bike_id
FROM trip
WHERE start_station_id = (
    SELECT id
    FROM station
    WHERE lat = '37.789625' AND long = '-122.400811'
) AND DATE(start_date) = '2014-10-20';
```
-------------------------9013 sample_num
```sql
SELECT 
    s.dock_count, 
    t.end_station_name 
FROM 
    trip t 
JOIN 
    station s ON t.start_station_name = s.name 
WHERE 
    s.name = 'South Van Ness at Market' 
    AND t.subscription_type = 'Subscriber' 
    AND t.start_date = '2013-12-01' 
ORDER BY 
    t.duration ASC 
LIMIT 1;
```
-------------------------9014 sample_num
```sql
SELECT MAX(w.max_humidity)
FROM trip t
JOIN weather w ON DATE(t.start_date) = w.date
WHERE t.start_station_name = 'Powell Street BART'
  AND t.bike_id = '496'
  AND DATE(t.start_date) = '2013-08-29';
```
-------------------------9015 sample_num
```sql
SELECT 
    w.date, 
    COUNT(t.id) AS total_bikes_borrowed
FROM 
    weather w
JOIN 
    trip t ON DATE(t.start_date) = w.date
WHERE 
    w.zip_code = '94301' 
    AND w.events = 'Fog' 
    AND w.date BETWEEN '2014-11-01' AND '2014-11-30'
GROUP BY 
    w.date;
```
-------------------------9016 sample_num
```sql
SELECT start_station_name, installation_date
FROM trip
JOIN station ON trip.start_station_id = station.id
WHERE subscription_type = 'Customer'
GROUP BY start_station_name, installation_date
ORDER BY COUNT(*) ASC
LIMIT 1;
```
-------------------------9017 sample_num
```sql
SELECT s.name
FROM status st
JOIN station s ON st.station_id = s.id
WHERE st.bikes_available = 0 AND st.time = '11/3/2013';
```
-------------------------9018 sample_num
```sql
SELECT AVG(duration) AS average_duration
FROM trip
WHERE start_station_id IN (
    SELECT id
    FROM station
    WHERE city = 'Palo Alto'
);
```
-------------------------9019 sample_num
```sql
SELECT 
    t.start_station_name, 
    s1.city AS start_city, 
    t.end_station_name, 
    s2.city AS end_city, 
    MAX(t.duration) AS longest_duration
FROM 
    trip t
JOIN 
    station s1 ON t.start_station_id = s1.id
JOIN 
    station s2 ON t.end_station_id = s2.id
GROUP BY 
    t.start_station_name, s1.city, t.end_station_name, s2.city
ORDER BY 
    longest_duration DESC
LIMIT 1;
```
-------------------------9020 sample_num
```sql
SELECT name, installation_date, city 
FROM station 
WHERE installation_date BETWEEN '2013-08-05' AND '2013-12-31';
```
-------------------------9021 sample_num
```sql
SELECT AVG(duration) AS average_duration
FROM trip
WHERE start_station_name = 'Adobe on Almaden' AND end_station_name = 'Ryland Park';
```
-------------------------9022 sample_num
```sql
SELECT s.name, s.lat, s.long, st.time
FROM station s
JOIN status st ON s.id = st.station_id
WHERE st.bikes_available = 0;
```
-------------------------9023 sample_num
```sql
SELECT t.id AS trip_id, s.lat, s.long
FROM trip t
JOIN station s ON t.start_station_id = s.id
WHERE t.start_station_name = t.end_station_name;
```
-------------------------9024 sample_num
```sql
SELECT SUM(dock_count) - MAX(bikes_available) AS bikes_borrowed
FROM status
WHERE station_id = (SELECT id FROM station WHERE name = 'San Jose Diridon Caltrain Station')
AND time = '2013-08-29 18:14:01';
```
-------------------------9025 sample_num
```sql
SELECT trip.id
FROM trip
JOIN weather ON DATE(trip.start_date) = weather.date
WHERE trip.bike_id = '10'
  AND trip.subscription_type = 'Subscriber'
  AND weather.mean_temperature_f > 62;
```
-------------------------9026 sample_num
```sql
SELECT w.max_gust_speed_mph, w.cloud_cover
FROM trip t
JOIN weather w ON DATE(t.start_date) = w.date
WHERE t.bike_id = 10
  AND t.duration = 386
  AND t.start_station_name = 'MLK Library'
  AND t.end_station_name = 'San Salvador';
```
-------------------------9027 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE subscription_type = 'Subscriber' 
  AND start_station_name = '2nd at Folsom' 
  AND end_station_name = 'Civic Center BART (7th at Market)' 
  AND duration < 490 
  AND start_date IN (
      SELECT date 
      FROM weather 
      WHERE mean_visibility_miles < 4
  );
```
-------------------------9028 sample_num
```sql
SELECT docks_available 
FROM status 
WHERE station_id = (SELECT start_station_id FROM trip WHERE id = 912900);
```
-------------------------9029 sample_num
```sql
SELECT trip.id
FROM trip
JOIN weather ON trip.end_date::date = weather.date
WHERE weather.min_temperature_f < 45;
```
-------------------------9030 sample_num
```sql
WITH trip_data AS (
    SELECT 
        duration,
        MIN(duration) OVER () AS min_duration,
        AVG(duration) OVER () AS avg_duration
    FROM trip
    WHERE 
        subscription_type = 'Subscriber' AND 
        start_station_name = '2nd at Folsom' AND 
        end_station_name = '5th at Howard' AND 
        start_date >= '2014-01-01 00:00' AND 
        end_date <= '2014-12-31 23:59'
),
weather_data AS (
    SELECT 
        w.min_temperature_f,
        w.max_gust_speed_mph,
        w.events
    FROM weather w
    JOIN trip t ON DATE(t.start_date) = w.date
    WHERE 
        t.subscription_type = 'Subscriber' AND 
        t.start_station_name = '2nd at Folsom' AND 
        t.end_station_name = '5th at Howard' AND 
        t.start_date >= '2014-01-01 00:00' AND 
        t.end_date <= '2014-12-31 23:59'
)
SELECT 
    td.min_duration,
    td.avg_duration,
    td.avg_duration - td.min_duration AS duration_difference,
    wd.min_temperature_f,
    wd.max_gust_speed_mph,
    wd.events
FROM trip_data td
JOIN weather_data wd ON 1=1
LIMIT 1;
```
-------------------------9031 sample_num
```sql
SELECT AVG(duration) AS average_ride_time
FROM trip
WHERE start_station_name = 'Steuart at Market'
  AND end_station_name = 'Embarcadero at Sansome'
  AND start_date >= '2014-07-01 00:00:00'
  AND end_date <= '2014-07-31 23:59:59';
```
-------------------------9032 sample_num
```sql
SELECT 
    AVG(max_temperature_f) AS average_max_temperature,
    AVG(min_temperature_f) AS average_min_temperature
FROM 
    weather
WHERE 
    date BETWEEN '2015-05-01' AND '2015-05-31'
    AND mean_humidity BETWEEN 65 AND 75;
```
-------------------------9033 sample_num
```sql
SELECT 
    SUM(subscription_type = 'Subscriber') - SUM(subscription_type = 'Customer') AS difference
FROM 
    trip
WHERE 
    start_date BETWEEN '2013-06-01 00:00' AND '2013-06-30 23:59';
```
-------------------------9034 sample_num
```sql
SELECT DISTINCT t.bike_id
FROM trip t
JOIN weather w ON DATE(t.start_date) = w.date
WHERE YEAR(w.date) = 2013 AND w.events = 'Fog-Rain';
```
-------------------------9035 sample_num
```sql
SELECT 
    t.duration,
    w.mean_visibility_miles,
    w.mean_wind_speed_mph,
    w.events,
    s1.name AS start_station_name,
    s1.lat AS start_station_lat,
    s1.long AS start_station_long,
    s2.name AS end_station_name,
    s2.lat AS end_station_lat,
    s2.long AS end_station_long
FROM 
    trip t
JOIN 
    weather w ON DATE(t.start_date) = w.date
JOIN 
    station s1 ON t.start_station_id = s1.id
JOIN 
    station s2 ON t.end_station_id = s2.id
WHERE 
    w.events = 'fog'
ORDER BY 
    t.duration DESC
LIMIT 1;
```
-------------------------9036 sample_num
```sql
SELECT MIN(w.min_temperature_f) AS coldest_temperature
FROM trip t
JOIN weather w ON DATE(t.start_date) = w.date
WHERE t.start_station_name = 'Market at 10th'
  AND t.end_station_name = 'South Van Ness at Market'
  AND t.start_date BETWEEN '2013-08-01 00:00' AND '2013-08-31 12:59';
```
-------------------------9037 sample_num
```sql
SELECT start_station_name, end_station_name, duration
FROM trip
WHERE start_date IN (
    SELECT date
    FROM weather
    WHERE events = 'rain'
)
ORDER BY duration DESC
LIMIT 1;
```
-------------------------9038 sample_num
```sql
SELECT AVG(duration) AS average_ride_duration
FROM trip t
JOIN weather w ON DATE(t.start_date) = w.date
WHERE w.precipitation_inches > 0.8 AND w.events LIKE '%rain%';
```
-------------------------9039 sample_num
```sql
SELECT DISTINCT s.name, s.city
FROM trip t
JOIN station s ON t.start_station_id = s.id
GROUP BY s.id, s.name, s.city
HAVING AVG(t.duration) > (SELECT AVG(duration) FROM trip);
```
-------------------------9040 sample_num
```sql
SELECT COUNT(*) 
FROM station 
WHERE city = 'San Francisco' AND installation_date LIKE '%2014%';
```
-------------------------9041 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE end_station_name IN (
    SELECT name 
    FROM station 
    WHERE city = 'Mountain View'
) 
AND start_date LIKE '%2006%';
```
-------------------------9042 sample_num
```sql
SELECT id 
FROM trip 
WHERE start_station_name IN (SELECT name FROM station WHERE city = 'Redwood City') 
ORDER BY duration DESC 
LIMIT 1;
```
-------------------------9043 sample_num
```sql
SELECT DISTINCT trip.bike_id
FROM trip
JOIN station ON trip.start_station_id = station.id
WHERE station.installation_date LIKE '%2013';
```
-------------------------9044 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE subscription_type = 'Subscriber' 
AND end_station_name IN (SELECT name FROM station WHERE city = 'San Jose');
```
-------------------------9045 sample_num
```sql
SELECT *
FROM trip
WHERE start_station_id = (
    SELECT id
    FROM station
    WHERE dock_count = 15
)
ORDER BY duration ASC
LIMIT 1;
```
-------------------------9046 sample_num
```sql
SELECT EXTRACT(YEAR FROM start_date) AS trip_year, COUNT(*) AS trip_count
FROM trip
JOIN station ON trip.start_station_id = station.id
WHERE station.city = 'San Francisco'
GROUP BY trip_year
ORDER BY trip_count DESC
LIMIT 1;
```
-------------------------9047 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN t.duration > 800 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    trip t
JOIN 
    station s ON t.start_station_id = s.id
WHERE 
    s.city = 'San Jose';
```
-------------------------9048 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE start_date LIKE '%2013%' AND duration > 1000;
```
-------------------------9049 sample_num
```sql
SELECT AVG(duration) AS average_duration
FROM trip
WHERE start_station_name = 'South Van Ness at Market' 
AND YEAR(start_date) = 2015;
```
-------------------------9050 sample_num
```sql
SELECT COUNT(*) AS same_station_trips
FROM trip
WHERE start_station_id = end_station_id;
```
-------------------------9051 sample_num
```sql
SELECT id 
FROM trip 
WHERE start_date = (SELECT date 
                     FROM weather 
                     ORDER BY max_temperature_f DESC 
                     LIMIT 1);
```
-------------------------9052 sample_num
```sql
SELECT *
FROM trip t
JOIN weather w ON DATE(t.end_date) = w.date
WHERE t.start_station_name = 'Mountain View City Hall' AND w.events = 'rain';
```
-------------------------9053 sample_num
```sql
SELECT AVG(duration) AS average_duration
FROM trip
JOIN weather ON DATE(end_date) = date
WHERE events = 'fog';
```
-------------------------9054 sample_num
```sql
SELECT MAX(duration) 
FROM trip 
WHERE DATE(start_date) IN (
    SELECT date 
    FROM weather 
    WHERE max_wind_speed_mph = 30
);
```
-------------------------9055 sample_num
```sql
SELECT AVG(w.mean_temperature_f) AS average_temperature
FROM trip t
JOIN weather w ON DATE(t.start_date) = w.date
WHERE t.start_station_name = 'Market at 4th' AND t.start_date LIKE '%2013%';
```
-------------------------9056 sample_num
```sql
SELECT w.mean_humidity
FROM trip t
JOIN weather w ON DATE(t.start_date) = w.date
WHERE t.id = 4275;
```
-------------------------9057 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN w.events = 'Rain' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    trip t
JOIN 
    weather w ON DATE(t.end_date) = w.date
WHERE 
    t.subscription_type = 'Customer' 
    AND t.end_date LIKE '%2015%';
```
-------------------------9058 sample_num
```sql
SELECT COUNT(*) 
FROM station 
WHERE year(installation_date) > 2013 AND city = 'San Jose';
```
-------------------------9059 sample_num
```sql
SELECT mean_temperature_f 
FROM weather 
WHERE date = '8/29/2013' AND zip_code = '94107';
```
-------------------------9060 sample_num
```sql
SELECT MAX(max_temperature_f) - MIN(min_temperature_f) AS temperature_difference
FROM weather
WHERE date = '2013-08-29' AND zip_code = '94107';
```
-------------------------9061 sample_num
```sql
SELECT bikes_available 
FROM status 
JOIN station ON status.station_id = station.id 
WHERE station.name = 'San Jose Diridon Caltrain Station' 
AND status.time = '2013-08-29 12:06:01';
```
-------------------------9062 sample_num
```sql
SELECT city 
FROM station 
WHERE id = (SELECT start_station_id FROM trip WHERE id = 4069);
```
-------------------------9063 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE start_date LIKE '9%' AND start_date LIKE '%2013' 
AND start_date IN (
    SELECT date 
    FROM weather 
    WHERE max_temperature_f > 70 AND zip_code = '94107'
);
```
-------------------------9064 sample_num
```sql
SELECT DISTINCT trip.start_station_name
FROM trip
JOIN weather ON trip.start_date::date = weather.date
WHERE weather.max_humidity > 80
AND weather.zip_code = '94107'
AND trip.start_date LIKE '%2013%';
```
-------------------------9065 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE subscription_type = 'Subscriber' 
AND start_date LIKE '8%' 
AND start_date LIKE '%2013%' 
AND start_station_id IN (
    SELECT id 
    FROM station 
    WHERE dock_count > 20
);
```
-------------------------9066 sample_num
```sql
SELECT s.lat, s.long
FROM trip t
JOIN station s ON t.start_station_id = s.id
WHERE t.duration = (SELECT MAX(duration) FROM trip);
```
-------------------------9067 sample_num
```sql
SELECT s.docks_available
FROM trip t
JOIN status s ON t.end_station_id = s.station_id
WHERE t.id = 4069;
```
-------------------------9068 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE start_date LIKE '%2013%' 
AND start_station_name = '2nd at Townsend' 
AND start_date IN (
    SELECT date 
    FROM weather 
    WHERE events = 'fog'
);
```
-------------------------9069 sample_num
```sql
SELECT MAX(duration) 
FROM trip 
WHERE start_date LIKE '%2013%' 
AND start_date IN (SELECT date FROM weather WHERE events = 'fog');
```
-------------------------9070 sample_num
```sql
SELECT s.installation_date 
FROM station s 
JOIN trip t ON s.id = t.start_station_id 
WHERE t.id = 4069;
```
-------------------------9071 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE start_station_id IN (
    SELECT id 
    FROM station 
    WHERE city = 'San Francisco'
) AND subscription_type = 'Subscriber';
```
-------------------------9072 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE start_station_name = '2nd at Folsom' 
AND start_date LIKE '%2014%' 
AND DATE(start_date) = (
    SELECT date 
    FROM weather 
    WHERE max_temperature_f = (
        SELECT MAX(max_temperature_f) 
        FROM weather 
        WHERE date LIKE '%2014%'
    )
);
```
-------------------------9073 sample_num
```sql
SELECT AVG(duration) AS average_duration
FROM trip
WHERE start_date LIKE '%2014%'
AND start_date IN (
    SELECT date
    FROM weather
    WHERE max_temperature_f = (
        SELECT MAX(max_temperature_f)
        FROM weather
        WHERE date LIKE '%2014%'
    )
);
```
-------------------------9074 sample_num
```sql
SELECT DISTINCT end_station_name 
FROM trip 
WHERE start_station_name = '2nd at South Park';
```
-------------------------9075 sample_num
```sql
SELECT COUNT(*) 
FROM weather 
WHERE events = 'rain' AND zip_code = 94041;
```
-------------------------9076 sample_num
```sql
SELECT MAX(dock_count) AS total_bikes
FROM station
WHERE city = 'Redwood City' AND YEAR(installation_date) < 2014;
```
-------------------------9077 sample_num
```sql
SELECT MAX(duration) / 86400 AS longest_trip_duration_days FROM trip;
```
-------------------------9078 sample_num
```sql
SELECT 
    date,
    (max_temperature_f - 32) / 1.800 AS Celsius1,
    (mean_temperature_f - 32) / 1.800 AS Celsius2,
    (min_temperature_f - 32) / 1.800 AS Celsius3
FROM 
    weather
WHERE 
    zip_code IN (SELECT DISTINCT zip_code FROM station WHERE city = 'San Francisco')
    AND date BETWEEN '2013-08-01' AND '2013-08-31';
```
-------------------------9079 sample_num
```sql
SELECT 
    SUM(CASE WHEN subscription_type = 'Subscriber' THEN 1 ELSE 0 END) AS subscriber_count,
    SUM(CASE WHEN subscription_type = 'Customer' THEN 1 ELSE 0 END) AS customer_count,
    (SUM(CASE WHEN subscription_type = 'Subscriber' THEN 1 ELSE 0 END) * 1.0 / 
     NULLIF(SUM(CASE WHEN subscription_type = 'Customer' THEN 1 ELSE 0 END), 0)) AS ratio
FROM 
    trip
WHERE 
    start_station_name = '2nd at South Park' 
    AND end_station_name = '2nd at South Park';
```
-------------------------9080 sample_num
```sql
SELECT COUNT(*) = 0 AS all_stations_in_sf
FROM station
WHERE city <> 'San Francisco' AND id IN (
    SELECT station_id
    FROM status
    WHERE station_id IN (
        SELECT id
        FROM station
        WHERE city = 'San Francisco' AND id IN (
            SELECT start_station_id
            FROM trip
            WHERE zip_code = '94107'
        )
    )
);
```
-------------------------9081 sample_num
```sql
SELECT s.name 
FROM station s 
JOIN weather w ON s.city = w.zip_code 
WHERE w.mean_temperature_f = (20 * 1.8 + 32) 
AND w.date LIKE '%2014%';
```
-------------------------9082 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE start_station_id IN (
    SELECT id 
    FROM station 
    WHERE city = 'San Jose'
) 
AND start_date LIKE '8/%/2013%';
```
-------------------------9083 sample_num
```sql
SELECT DISTINCT s1.city AS start_city, s2.city AS end_city
FROM trip t
JOIN station s1 ON t.start_station_id = s1.id
JOIN station s2 ON t.end_station_id = s2.id
WHERE t.start_station_name != t.end_station_name
AND t.start_date LIKE '%2014%';
```
-------------------------9084 sample_num
```sql
SELECT DIVIDE(SUM(duration), 3600) AS hour
FROM trip
WHERE bike_id = 16 AND start_station_name != end_station_name;
```
-------------------------9085 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN subscription_type = 'customer' THEN 1 END) * 1.0) / 
    NULLIF(COUNT(CASE WHEN subscription_type = 'subscriber' THEN 1 END), 0) AS ratio
FROM 
    trip
WHERE 
    start_station_id IN (SELECT id FROM station WHERE city = 'Mountain View')
    OR end_station_id IN (SELECT id FROM station WHERE city = 'Mountain View');
```
-------------------------9086 sample_num
```sql
SELECT DIVIDE(SUM(t.duration), 3600) AS total_trip_duration_hours
FROM trip t
JOIN station s ON t.start_station_id = s.id
WHERE s.city = 'Palo Alto';
```
-------------------------9087 sample_num
```sql
SELECT 
    trip.bike_id, 
    SUM(trip.duration) / 3600 AS total_duration_hours
FROM 
    trip
JOIN 
    station AS start_station ON trip.start_station_id = start_station.id
JOIN 
    station AS end_station ON trip.end_station_id = end_station.id
WHERE 
    start_station.city = end_station.city
GROUP BY 
    trip.bike_id
ORDER BY 
    COUNT(trip.id) ASC
LIMIT 1;
```
-------------------------9088 sample_num
```sql
SELECT COUNT(*) 
FROM trip 
WHERE start_station_name = 'Market at 4th' 
AND subscription_type = 'subscriber';
```
-------------------------9089 sample_num
```sql
SELECT name 
FROM station 
WHERE city = 'Mountain View' AND installation_date = '2013-12-31';
```
-------------------------9090 sample_num
```sql
SELECT city, SUM(dock_count) AS total_dock_count
FROM station
WHERE name = 'Townsend at 7th Station'
GROUP BY city;
```
-------------------------9091 sample_num
```sql
SELECT 
    SUM(s.dock_count) AS total_dock_count,
    COUNT(t.id) AS subscriber_count
FROM 
    station s
LEFT JOIN 
    trip t ON s.name = t.start_station_name
WHERE 
    s.name = 'Evelyn Park and Ride' AND 
    t.subscription_type = 'subscriber';
```
-------------------------9092 sample_num
```sql
SELECT 
    COUNT(DISTINCT trip.id) AS subscriber_count,
    MAX(weather.max_temperature_f) AS hottest_temperature
FROM 
    trip
JOIN 
    weather ON trip.zip_code = weather.zip_code
WHERE 
    trip.subscription_type = 'Subscriber' AND 
    trip.zip_code = '94301';
```
-------------------------9093 sample_num
```sql
SELECT 
    (SUM(CASE WHEN subscription_type = 'customer' THEN 1 ELSE 0 END) * 100.0) / 
    NULLIF(SUM(CASE WHEN subscription_type = 'subscriber' THEN 1 ELSE 0 END), 0) AS percentage
FROM 
    trip
WHERE 
    start_station_id IN (SELECT id FROM station WHERE city = 'San Francisco');
```
-------------------------9094 sample_num
```sql
SELECT AVG(t.duration) AS average_duration, s.lat, s.long
FROM trip t
JOIN station s ON t.start_station_name = s.name
WHERE s.name = 'Santa Clara at Almaden';
```
-------------------------9095 sample_num
```sql
SELECT MIN(t.duration) AS shortest_trip, w.max_wind_Speed_mph
FROM trip t
JOIN weather w ON DATE(t.start_date) = w.date
WHERE t.start_station_name = 'Franklin at Maple';
```
-------------------------9096 sample_num
```sql
SELECT 
    s.lat, 
    s.long, 
    SUM(st.bikes_available) AS bikes_borrowed
FROM 
    station s
JOIN 
    status st ON s.id = st.station_id
WHERE 
    s.name = 'San Jose Diridon Caltrain Station' 
    AND st.time = '2013-10-20 08:11:01'
GROUP BY 
    s.lat, s.long;
```
-------------------------9097 sample_num
```sql
SELECT s.city, s.installation_date
FROM trip t
JOIN station s ON t.start_station_id = s.id
WHERE t.id = 585842;
```
-------------------------9098 sample_num
```sql
SELECT COUNT(DISTINCT s.id) AS station_count, 
       COUNT(t.id) AS customer_count
FROM station s
LEFT JOIN trip t ON s.id = t.start_station_id
WHERE s.installation_date = '2013-08-16' 
  AND t.subscription_type = 'Customer';
```
-------------------------9099 sample_num
```sql
SELECT s.lat, s.long
FROM trip t
JOIN station s ON t.end_station_id = s.id
WHERE t.start_station_name = 'Market at 4th'
  AND t.end_date = '2013-08-29 12:45:00';
```
-------------------------9100 sample_num
```sql
SELECT COUNT(*) AS subscriber_count, s.dock_count
FROM trip t
JOIN station s ON t.end_station_id = s.id
WHERE t.subscription_type = 'subscriber' AND s.name = 'MLK Library';
```
-------------------------9101 sample_num
```sql
SELECT AVG(w.min_temperature_f) AS average_coldest_temperature,
       s.name,
       s.lat,
       s.long
FROM weather w
JOIN station s ON s.city = 'Palo Alto' -- Assuming city for zip code 94301 is Palo Alto
WHERE w.zip_code = '94301'
GROUP BY s.name, s.lat, s.long;
```
-------------------------9102 sample_num
```sql
SELECT 
    AVG(duration) AS average_duration,
    s.installation_date
FROM 
    trip t
JOIN 
    station s ON t.start_station_id = s.id AND t.end_station_id = s.id
WHERE 
    t.subscription_type = 'subscriptions' 
    AND s.name = 'Mountain View City Hall';
```
-------------------------9103 sample_num
```sql
SELECT description FROM film WHERE title = 'ACADEMY DINOSAUR';
```
-------------------------9104 sample_num
```sql
SELECT COUNT(*) AS film_count
FROM film
WHERE rental_duration > 6;
```
-------------------------9105 sample_num
```sql
SELECT title 
FROM film 
WHERE release_year = 2006 AND rental_rate = 2.99;
```
-------------------------9106 sample_num
```sql
SELECT title 
FROM film 
WHERE length = (SELECT MAX(length) FROM film);
```
-------------------------9107 sample_num
```sql
SELECT title, replacement_cost 
FROM film 
WHERE title IN ('ACE GOLDFINGER', 'ACADEMY DINOSAUR') 
ORDER BY replacement_cost DESC 
LIMIT 1;
```
-------------------------9108 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE release_year = 2006 AND rating = 'NC-17';
```
-------------------------9109 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE rental_rate = 2.99 AND special_features LIKE '%Deleted Scenes%';
```
-------------------------9110 sample_num
```sql
SELECT title 
FROM film 
WHERE LENGTH(special_features) - LENGTH(REPLACE(special_features, ',', '')) > 2;
```
-------------------------9111 sample_num
```sql
SELECT email FROM staff WHERE first_name = 'Jon' AND last_name = 'Stephens';
```
-------------------------9112 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM staff
WHERE active = 1;
```
-------------------------9113 sample_num
```sql
SELECT release_year 
FROM film 
WHERE replacement_cost = (SELECT MAX(replacement_cost) FROM film);
```
-------------------------9114 sample_num
```sql
SELECT title 
FROM film 
ORDER BY replacement_cost DESC 
LIMIT 3;
```
-------------------------9115 sample_num
```sql
SELECT l.name 
FROM film f 
JOIN language l ON f.language_id = l.language_id 
WHERE f.title = 'ACADEMY DINOSAUR';
```
-------------------------9116 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE language_id = (SELECT language_id FROM language WHERE name = 'English');
```
-------------------------9117 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'PENELOPE' AND a.last_name = 'GUINESS';
```
-------------------------9118 sample_num
```sql
SELECT COUNT(DISTINCT fa.actor_id) AS actor_count
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
WHERE f.title = 'ACADEMY DINOSAUR';
```
-------------------------9119 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.title = 'ACADEMY DINOSAUR';
```
-------------------------9120 sample_num
```sql
SELECT COUNT(*) 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'PENELOPE' AND a.last_name = 'GUINESS' AND f.release_year = 2006;
```
-------------------------9121 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'PENELOPE' AND a.last_name = 'GUINESS'
ORDER BY f.replacement_cost DESC
LIMIT 1;
```
-------------------------9122 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.replacement_cost = (SELECT MAX(replacement_cost) FROM film);
```
-------------------------9123 sample_num
```sql
SELECT COUNT(f.film_id) AS english_film_count
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
JOIN language l ON f.language_id = l.language_id
WHERE a.first_name = 'PENELOPE' AND a.last_name = 'GUINESS' AND l.name = 'English';
```
-------------------------9124 sample_num
```sql
SELECT f.title
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'PENELOPE' AND a.last_name = 'GUINESS'
ORDER BY f.length DESC
LIMIT 1;
```
-------------------------9125 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Horror';
```
-------------------------9126 sample_num
```sql
SELECT COUNT(f.film_id) AS film_count
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Horror';
```
-------------------------9127 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Horror' AND f.rental_rate = 2.99;
```
-------------------------9128 sample_num
```sql
SELECT COUNT(rental.rental_id) AS rental_count
FROM customer
JOIN rental ON customer.customer_id = rental.customer_id
WHERE customer.first_name = 'RUTH' AND customer.last_name = 'MARTINEZ';
```
-------------------------9129 sample_num
```sql
SELECT f.title
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN customer c ON r.customer_id = c.customer_id
WHERE c.first_name = 'RUTH' AND c.last_name = 'MARTINEZ';
```
-------------------------9130 sample_num
```sql
SELECT COUNT(DISTINCT f.film_id) AS film_count
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
WHERE c.first_name = 'RUTH' AND c.last_name = 'MARTINEZ' AND f.release_year = 2006;
```
-------------------------9131 sample_num
```sql
SELECT f.title
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN customer c ON r.customer_id = c.customer_id
WHERE c.first_name = 'RUTH' AND c.last_name = 'MARTINEZ'
ORDER BY f.replacement_cost DESC
LIMIT 1;
```
-------------------------9132 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
WHERE f.replacement_cost = (SELECT MAX(replacement_cost) FROM film);
```
-------------------------9133 sample_num
```sql
SELECT COUNT(*) 
FROM rental r
JOIN customer c ON r.customer_id = c.customer_id
WHERE c.first_name = 'RUTH' AND c.last_name = 'MARTINEZ' 
AND YEAR(r.return_date) = 2005 AND MONTH(r.return_date) = 8;
```
-------------------------9134 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id
ORDER BY COUNT(r.rental_id) DESC
LIMIT 1;
```
-------------------------9135 sample_num
```sql
SELECT COUNT(DISTINCT c.customer_id) AS active_customers
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
WHERE f.title = 'ACADEMY DINOSAUR' AND c.active = 1;
```
-------------------------9136 sample_num
```sql
SELECT f.title
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
GROUP BY f.film_id, f.title
ORDER BY COUNT(r.rental_id) DESC
LIMIT 1;
```
-------------------------9137 sample_num
```sql
SELECT 
    c.first_name, 
    c.last_name, 
    COUNT(r.rental_id) AS rental_count
FROM 
    customer c
JOIN 
    rental r ON c.customer_id = r.customer_id
WHERE 
    CONCAT(c.first_name, ' ', c.last_name) IN ('RUTH MARTINEZ', 'LINDA WILLIAMS')
GROUP BY 
    c.customer_id
ORDER BY 
    rental_count DESC
LIMIT 1;
```
-------------------------9138 sample_num
```sql
SELECT f.title
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'PENELOPE' AND a.last_name = 'GUINESS'
ORDER BY (f.rental_rate / f.rental_duration) DESC
LIMIT 1;
```
-------------------------9139 sample_num
```sql
SELECT AVG(f.replacement_cost) AS average_replacement_cost
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Horror';
```
-------------------------9140 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.name = 'Music' THEN 1 END) * 100.0 / COUNT(f.film_id)) AS music_percentage
FROM 
    customer cu
JOIN 
    rental r ON cu.customer_id = r.customer_id
JOIN 
    inventory i ON r.inventory_id = i.inventory_id
JOIN 
    film f ON i.film_id = f.film_id
JOIN 
    film_category fc ON f.film_id = fc.film_id
JOIN 
    category c ON fc.category_id = c.category_id
WHERE 
    cu.first_name = 'RUTH' AND cu.last_name = 'MARTINEZ';
```
-------------------------9141 sample_num
```sql
SELECT AVG(f.length) AS average_duration
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'PENELOPE' AND a.last_name = 'GUINESS';
```
-------------------------9142 sample_num
```sql
SELECT email FROM customer WHERE first_name = 'Diane' AND last_name = 'Collins';
```
-------------------------9143 sample_num
```sql
SELECT COUNT(*) AS inactive_customers FROM customer WHERE active = 0;
```
-------------------------9144 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM customer
WHERE email = 'JEREMY.HURTADO@sakilacustomer.org';
```
-------------------------9145 sample_num
```sql
SELECT postal_code FROM address WHERE address_id = 65;
```
-------------------------9146 sample_num
```sql
SELECT COUNT(address_id) AS number_of_addresses
FROM address
WHERE district = 'Nordrhein-Westfalen';
```
-------------------------9147 sample_num
```sql
SELECT phone FROM address WHERE address_id = 72;
```
-------------------------9148 sample_num
```sql
SELECT COUNT(*) AS number_of_films
FROM film
WHERE length = 178;
```
-------------------------9149 sample_num
```sql
SELECT special_features 
FROM film 
WHERE title = 'Uprising Uptown';
```
-------------------------9150 sample_num
```sql
SELECT description FROM film WHERE title = 'ARTIST COLDBLOODED';
```
-------------------------9151 sample_num
```sql
SELECT a.address, a.address2, a.district
FROM store s
JOIN address a ON s.address_id = a.address_id
WHERE s.store_id = 2;
```
-------------------------9152 sample_num
```sql
SELECT c.country
FROM city ci
JOIN country c ON ci.country_id = c.country_id
WHERE ci.city = 'Clarksville';
```
-------------------------9153 sample_num
```sql
SELECT COUNT(fa.actor_id) AS actor_count
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
WHERE f.release_year = 2006 
  AND f.rental_duration = 7 
  AND f.rental_rate = 4.99 
  AND f.length = 98;
```
-------------------------9154 sample_num
```sql
SELECT f.rating 
FROM film f 
JOIN film_actor fa ON f.film_id = fa.film_id 
JOIN actor a ON fa.actor_id = a.actor_id 
WHERE a.first_name = 'Dan' AND a.last_name = 'Harris' 
AND f.length = 77 AND f.replacement_cost = 9.99;
```
-------------------------9155 sample_num
```sql
SELECT COUNT(fa.film_id) AS film_count
FROM film_actor fa
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Daryl' AND a.last_name = 'Wahlberg';
```
-------------------------9156 sample_num
```sql
SELECT return_date 
FROM rental 
JOIN customer ON rental.customer_id = customer.customer_id 
WHERE customer.first_name = 'Sherri' AND customer.last_name = 'Rhodes' 
AND rental.rental_date = '2005-07-28 12:27:27';
```
-------------------------9157 sample_num
```sql
SELECT CONCAT(s.first_name, ' ', s.last_name) AS manager_name
FROM store st
JOIN staff s ON st.manager_staff_id = s.staff_id
WHERE st.store_id = 1;
```
-------------------------9158 sample_num
```sql
SELECT address, address2, district 
FROM address 
WHERE address_id = (SELECT address_id FROM store WHERE store_id = 1);
```
-------------------------9159 sample_num
```sql
SELECT a.address, a.address2, a.district 
FROM staff s 
JOIN address a ON s.address_id = a.address_id 
WHERE s.first_name = 'Jon' AND s.last_name = 'Stephens';
```
-------------------------9160 sample_num
```sql
SELECT COUNT(*) 
FROM address 
WHERE city_id = (SELECT city_id FROM city WHERE city = 'Woodridge');
```
-------------------------9161 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE language_id = (SELECT language_id FROM language WHERE name = 'English');
```
-------------------------9162 sample_num
```sql
SELECT a.address, a.address2, a.district, c.city, co.country
FROM customer AS cu
JOIN address AS a ON cu.address_id = a.address_id
JOIN city AS c ON a.city_id = c.city_id
JOIN country AS co ON c.country_id = co.country_id
WHERE cu.first_name = 'Heather' AND cu.last_name = 'Morris';
```
-------------------------9163 sample_num
```sql
SELECT c.email 
FROM customer c 
JOIN address a ON c.address_id = a.address_id 
WHERE a.address = '1411 Lillydale Drive';
```
-------------------------9164 sample_num
```sql
SELECT amount 
FROM payment 
WHERE customer_id = 297 
AND rental_id IN (
    SELECT rental_id 
    FROM rental 
    WHERE rental_date = '2005-07-28 12:27:27'
);
```
-------------------------9165 sample_num
```sql
SELECT c.name 
FROM film f 
JOIN film_category fc ON f.film_id = fc.film_id 
JOIN category c ON fc.category_id = c.category_id 
WHERE f.title = 'Working Microcosmos';
```
-------------------------9166 sample_num
```sql
SELECT COUNT(f.film_id) AS number_of_documentary_films
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Documentary';
```
-------------------------9167 sample_num
```sql
SELECT c.name
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
GROUP BY c.category_id
ORDER BY COUNT(fc.film_id) DESC
LIMIT 1;
```
-------------------------9168 sample_num
```sql
SELECT f.title 
FROM film f 
JOIN inventory i ON f.film_id = i.film_id 
WHERE i.inventory_id = 3479;
```
-------------------------9169 sample_num
```sql
SELECT 
    (SUM(CASE WHEN s.store_id = 2 THEN p.amount ELSE 0 END) - 
     SUM(CASE WHEN s.store_id = 1 THEN p.amount ELSE 0 END)) / 
    NULLIF(SUM(CASE WHEN s.store_id = 1 THEN p.amount ELSE 0 END), 0) * 100 AS percentage_more
FROM 
    store s
JOIN 
    staff st ON s.store_id = st.store_id
JOIN 
    customer c ON st.staff_id = c.store_id
JOIN 
    payment p ON c.customer_id = p.customer_id
JOIN 
    rental r ON p.rental_id = r.rental_id
WHERE 
    s.store_id IN (1, 2);
```
-------------------------9170 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM city WHERE country_id = (SELECT country_id FROM country WHERE country = 'India')) /
    (SELECT COUNT(*) FROM city WHERE country_id = (SELECT country_id FROM country WHERE country = 'Italy')) AS times;
```
-------------------------9171 sample_num
```sql
SELECT 
    (SELECT COUNT(fa.film_id) 
     FROM film_actor fa 
     JOIN actor a ON fa.actor_id = a.actor_id 
     WHERE a.first_name = 'GINA' AND a.last_name = 'DEGENERES') / 
    (SELECT COUNT(fa.film_id) 
     FROM film_actor fa 
     JOIN actor a ON fa.actor_id = a.actor_id 
     WHERE a.first_name = 'PENELOPE' AND a.last_name = 'GUINESS') AS times_number_of_films;
```
-------------------------9172 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE rating = 'R' AND release_year = 2006;
```
-------------------------9173 sample_num
```sql
SELECT COUNT(DISTINCT actor_id) AS actor_count
FROM film_actor
WHERE film_id = 508;
```
-------------------------9174 sample_num
```sql
SELECT special_features 
FROM film 
WHERE title = 'Smoochy Control';
```
-------------------------9175 sample_num
```sql
SELECT COUNT(DISTINCT customer_id) 
FROM payment 
WHERE amount > 10 AND payment_date LIKE '2005-08%';
```
-------------------------9176 sample_num
```sql
SELECT title 
FROM film 
WHERE length > 180;
```
-------------------------9177 sample_num
```sql
SELECT SUM(amount) AS total_rental_payment
FROM payment
WHERE rental_id BETWEEN 1 AND 10;
```
-------------------------9178 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM staff
WHERE active = 1;
```
-------------------------9179 sample_num
```sql
SELECT first_name, last_name 
FROM staff 
WHERE staff_id = (SELECT manager_staff_id FROM store WHERE store_id = 2);
```
-------------------------9180 sample_num
```sql
SELECT COUNT(*) AS total_rentals_returned
FROM rental
WHERE return_date = '2005-05-27';
```
-------------------------9181 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Laura' AND a.last_name = 'Brody';
```
-------------------------9182 sample_num
```sql
SELECT f.title
FROM film f
JOIN inventory i ON f.film_id = i.film_id
WHERE i.store_id = 2
AND f.film_id NOT IN (
    SELECT i2.film_id
    FROM inventory i2
    WHERE i2.store_id <> 2
);
```
-------------------------9183 sample_num
```sql
SELECT DISTINCT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM rental r
JOIN customer c ON r.customer_id = c.customer_id
WHERE DATEDIFF(r.return_date, r.rental_date) = 7;
```
-------------------------9184 sample_num
```sql
SELECT COUNT(f.film_id) AS horror_film_count
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Horror';
```
-------------------------9185 sample_num
```sql
SELECT f.title
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
GROUP BY f.film_id, f.title
ORDER BY COUNT(r.rental_id) DESC
LIMIT 1;
```
-------------------------9186 sample_num
```sql
SELECT special_features
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Science Fiction'
GROUP BY special_features
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------9187 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
GROUP BY a.actor_id
ORDER BY COUNT(fa.film_id) DESC
LIMIT 1;
```
-------------------------9188 sample_num
```sql
SELECT COUNT(f.film_id) AS comedy_count
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE f.rental_duration = 7 AND c.name = 'Comedy';
```
-------------------------9189 sample_num
```sql
SELECT s.first_name, s.last_name
FROM store AS st
JOIN staff AS s ON st.manager_staff_id = s.staff_id
JOIN customer AS c ON st.store_id = c.store_id
WHERE c.active = 0
GROUP BY st.store_id, s.first_name, s.last_name
ORDER BY COUNT(c.customer_id) DESC
LIMIT 1;
```
-------------------------9190 sample_num
```sql
SELECT MAX(rental_rate / rental_duration) AS rental_price_per_day
FROM film
JOIN film_category ON film.film_id = film_category.film_id
JOIN category ON film_category.category_id = category.category_id
WHERE category.name = 'Children';
```
-------------------------9191 sample_num
```sql
SELECT CONCAT(a.address, ', ', a.address2, ', ', a.district) AS complete_address
FROM store s
JOIN address a ON s.address_id = a.address_id
WHERE s.store_id = 1;
```
-------------------------9192 sample_num
```sql
SELECT COUNT(*) 
FROM customer c
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
WHERE ci.city = 'Lethbridge';
```
-------------------------9193 sample_num
```sql
SELECT COUNT(*) 
FROM city 
WHERE country_id = (SELECT country_id FROM country WHERE country = 'United States');
```
-------------------------9194 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS customer_name
FROM customer c
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
JOIN country co ON ci.country_id = co.country_id
WHERE co.country = 'India';
```
-------------------------9195 sample_num
```sql
SELECT COUNT(f.film_id) 
FROM film f 
JOIN film_category fc ON f.film_id = fc.film_id 
JOIN category c ON fc.category_id = c.category_id 
WHERE c.name = 'Classics' AND f.rental_rate < 1;
```
-------------------------9196 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id
ORDER BY COUNT(r.rental_id) DESC
LIMIT 1;
```
-------------------------9197 sample_num
```sql
SELECT COUNT(rental_id) AS rented_times
FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id
WHERE film.title = 'BLANKET BEVERLY';
```
-------------------------9198 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.rating = 'R'
GROUP BY a.actor_id
ORDER BY COUNT(f.film_id) DESC
LIMIT 1;
```
-------------------------9199 sample_num
```sql
SELECT 
    CONCAT(a.first_name, ' ', a.last_name) AS full_name,
    COUNT(fa.film_id) AS film_count,
    COUNT(fa.film_id) / 5.0 AS average_films
FROM 
    actor a
JOIN 
    film_actor fa ON a.actor_id = fa.actor_id
GROUP BY 
    a.actor_id
ORDER BY 
    film_count DESC
LIMIT 5;
```
-------------------------9200 sample_num
```sql
SELECT actor_id FROM actor WHERE last_name = 'KILMER';
```
-------------------------9201 sample_num
```sql
SELECT title 
FROM film 
WHERE replacement_cost = (SELECT MIN(replacement_cost) FROM film WHERE rating = 'G') 
AND rating = 'G';
```
-------------------------9202 sample_num
```sql
SELECT title, description, special_features
FROM film
WHERE length = (SELECT MAX(length) FROM film)
LIMIT 5;
```
-------------------------9203 sample_num
```sql
SELECT COUNT(rental_id) 
FROM rental 
WHERE rental_date = '2005-05-26' AND return_date = '2005-05-30';
```
-------------------------9204 sample_num
```sql
SELECT customer_id, AVG(amount) AS average_payment
FROM payment
GROUP BY customer_id;
```
-------------------------9205 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS name, email 
FROM staff 
WHERE store_id = 2;
```
-------------------------9206 sample_num
```sql
SELECT (COUNT(customer_id) FILTER (WHERE active = 0) * 100.0 / COUNT(customer_id)) AS inactive_percentage
FROM customer;
```
-------------------------9207 sample_num
```sql
SELECT title, description FROM film WHERE film_id = 996;
```
-------------------------9208 sample_num
```sql
SELECT SUM(amount) AS total_payment
FROM payment
WHERE payment_date LIKE '2005-08%';
```
-------------------------9209 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Emily' AND a.last_name = 'Dee';
```
-------------------------9210 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.title = 'CHOCOLATE DUCK';
```
-------------------------9211 sample_num
```sql
SELECT COUNT(f.film_id) AS film_count
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Horror' AND f.rating = 'PG-13';
```
-------------------------9212 sample_num
```sql
SELECT c.name AS category_name, f.title AS film_title
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE a.first_name = 'Judy' AND a.last_name = 'Dean';
```
-------------------------9213 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Documentary'
LIMIT 5;
```
-------------------------9214 sample_num
```sql
SELECT l.name AS language, (f.rental_rate / f.rental_duration) AS rental_cost_per_day
FROM film f
JOIN language l ON f.language_id = l.language_id
WHERE f.title = 'UNTOUCHABLES SUNRISE';
```
-------------------------9215 sample_num
```sql
SELECT f.title 
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
WHERE r.rental_date LIKE '2005-05-24%';
```
-------------------------9216 sample_num
```sql
SELECT f.title
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN customer c ON r.customer_id = c.customer_id
WHERE c.first_name = 'Brian' AND c.last_name = 'Wyman'
AND YEAR(r.rental_date) = 2005 AND MONTH(r.rental_date) = 7;
```
-------------------------9217 sample_num
```sql
SELECT i.inventory_id, CONCAT(a.first_name, ' ', a.last_name) AS actor_name
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE f.title = 'STREETCAR INTENTIONS';
```
-------------------------9218 sample_num
```sql
SELECT f.title, c.name
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN customer cu ON r.customer_id = cu.customer_id
WHERE cu.first_name = 'Natalie' AND cu.last_name = 'Meyer'
AND YEAR(r.rental_date) = 2006 AND MONTH(r.rental_date) = 2;
```
-------------------------9219 sample_num
```sql
SELECT COUNT(rental.rental_id) 
FROM customer 
JOIN rental ON customer.customer_id = rental.customer_id 
WHERE customer.first_name = 'Eleanor' AND customer.last_name = 'Hunt';
```
-------------------------9220 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name, ci.city
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
WHERE f.title = 'DREAM PICKUP';
```
-------------------------9221 sample_num
```sql
SELECT (COUNT(CASE WHEN c.customer_id IS NOT NULL THEN 1 END) * 100.0 / COUNT(c.customer_id)) AS percentage_customers_in_india
FROM customer c
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
JOIN country co ON ci.country_id = co.country_id
WHERE co.country = 'India';
```
-------------------------9222 sample_num
```sql
SELECT 
    (SUM(CASE WHEN CONCAT(a.first_name, ' ', a.last_name) = 'Mary Keitel' THEN 1 ELSE 0 END) - 
     SUM(CASE WHEN CONCAT(a.first_name, ' ', a.last_name) = 'Angela Witherspoon' THEN 1 ELSE 0 END)) / 
    NULLIF(SUM(CASE WHEN CONCAT(a.first_name, ' ', a.last_name) = 'Angela Witherspoon' THEN 1 ELSE 0 END), 0) * 100 AS percentage_difference
FROM 
    actor a
JOIN 
    film_actor fa ON a.actor_id = fa.actor_id
GROUP BY 
    a.actor_id;
```
-------------------------9223 sample_num
```sql
SELECT c.email, a.address, ci.city, co.country
FROM customer c
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
JOIN country co ON ci.country_id = co.country_id
WHERE c.first_name = 'Lillie' AND c.last_name = 'Kim';
```
-------------------------9224 sample_num
```sql
SELECT DISTINCT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN staff s ON r.staff_id = s.staff_id
WHERE CONCAT(s.first_name, ' ', s.last_name) = 'Mike Hillyer'
LIMIT 5;
```
-------------------------9225 sample_num
```sql
SELECT SUM(p.amount) AS total_payment
FROM payment p
JOIN customer c ON p.customer_id = c.customer_id
WHERE c.first_name = 'Diane' AND c.last_name = 'Collins';
```
-------------------------9226 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name, c.email
FROM customer c
JOIN payment p ON c.customer_id = p.customer_id
GROUP BY c.customer_id
HAVING AVG(p.amount) * 0.7 < (SELECT AVG(amount) FROM payment);
```
-------------------------9227 sample_num
```sql
SELECT COUNT(*) AS film_count
FROM film
WHERE rental_rate = 0.99;
```
-------------------------9228 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE customer_id < 100 AND last_name = 'Thomas';
```
-------------------------9229 sample_num
```sql
SELECT a.last_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.description = 'A Thoughtful Drama of a Composer And a Feminist who must Meet a Secret Agent in The Canadian Rockies';
```
-------------------------9230 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Liza' AND a.last_name = 'Bergman'
ORDER BY f.replacement_cost DESC
LIMIT 1;
```
-------------------------9231 sample_num
```sql
SELECT title 
FROM film 
WHERE film_id IN (
    SELECT film_id 
    FROM inventory 
    WHERE store_id = 2
) 
ORDER BY rental_rate DESC 
LIMIT 1;
```
-------------------------9232 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Angelina' AND a.last_name = 'Astaire' AND f.replacement_cost = 27.99;
```
-------------------------9233 sample_num
```sql
SELECT inventory_id 
FROM inventory 
WHERE film_id = (SELECT film_id FROM film WHERE title = 'African Egg');
```
-------------------------9234 sample_num
```sql
SELECT COUNT(f.film_id) AS film_count
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE f.length = 113 AND CONCAT(a.first_name, ' ', a.last_name) = 'Kirk Jovovich';
```
-------------------------9235 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE film_id IN (
    SELECT film_id 
    FROM inventory 
    WHERE inventory_id BETWEEN 20 AND 60
) AND rating = 'G';
```
-------------------------9236 sample_num
```sql
SELECT COUNT(DISTINCT f.film_id) AS total_films
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE f.rental_rate = 4.99 AND CONCAT(a.first_name, ' ', a.last_name) = 'Bob Fawcett';
```
-------------------------9237 sample_num
```sql
SELECT i.inventory_id
FROM inventory i
JOIN film f ON i.film_id = f.film_id
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Russell' AND a.last_name = 'Close'
AND f.length BETWEEN 110 AND 150;
```
-------------------------9238 sample_num
```sql
SELECT store.store_id, inventory.inventory_id
FROM film
JOIN inventory ON film.film_id = inventory.film_id
JOIN store ON inventory.store_id = store.store_id
WHERE film.length = (SELECT MAX(length) FROM film);
```
-------------------------9239 sample_num
```sql
SELECT f.title
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Elvis' AND a.last_name = 'Marx';
```
-------------------------9240 sample_num
```sql
SELECT i.inventory_id
FROM inventory i
JOIN film f ON i.film_id = f.film_id
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE f.rental_rate = 4.99 AND CONCAT(a.first_name, ' ', a.last_name) = 'Lucille Dee';
```
-------------------------9241 sample_num
```sql
SELECT DISTINCT i.store_id
FROM film f
JOIN inventory i ON f.film_id = i.film_id
WHERE f.rental_rate > (SELECT AVG(rental_rate) * 0.6 FROM film);
```
-------------------------9242 sample_num
```sql
SELECT 
    (SUM(CASE WHEN f.rating = 'G' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage_g_rating
FROM 
    film f
JOIN 
    film_actor fa ON f.film_id = fa.film_id
JOIN 
    actor a ON fa.actor_id = a.actor_id
WHERE 
    a.first_name = 'Nick' AND a.last_name = 'Wahlberg';
```
-------------------------9243 sample_num
```sql
SELECT address 
FROM address 
WHERE district = 'Texas' 
ORDER BY city_id ASC;
```
-------------------------9244 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name, email
FROM customer
WHERE active = 0 AND YEAR(create_date) = 2006;
```
-------------------------9245 sample_num
```sql
SELECT (SUM(CASE WHEN rating = 'PG-13' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS percentage_pg13
FROM film;
```
-------------------------9246 sample_num
```sql
SELECT title, MAX(rental_rate) AS price_per_day
FROM film
GROUP BY title
ORDER BY price_per_day DESC
LIMIT 10;
```
-------------------------9247 sample_num
```sql
SELECT AVG(amount) AS average_rent_amount
FROM payment
WHERE customer_id = 15;
```
-------------------------9248 sample_num
```sql
SELECT COUNT(DISTINCT customer_id) AS above_average_customers
FROM rental
WHERE (return_date - rental_date) > (
    SELECT AVG(return_date - rental_date)
    FROM rental
);
```
-------------------------9249 sample_num
```sql
SELECT (COUNT(CASE WHEN c.name = 'Horror' THEN 1 END) * 100.0 / COUNT(*)) AS horror_percentage
FROM film_category fc
JOIN category c ON fc.category_id = c.category_id
JOIN film f ON fc.film_id = f.film_id;
```
-------------------------9250 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
GROUP BY a.actor_id
ORDER BY COUNT(fa.film_id) DESC
LIMIT 1;
```
-------------------------9251 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film_category fc ON fa.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Drama'
GROUP BY a.actor_id
ORDER BY COUNT(fa.film_id) DESC
LIMIT 1;
```
-------------------------9252 sample_num
```sql
SELECT 
    (SELECT AVG(daily_rentals) FROM (
        SELECT COUNT(rental_id) AS daily_rentals
        FROM rental r
        JOIN customer c ON r.customer_id = c.customer_id
        JOIN address a ON c.address_id = a.address_id
        JOIN city ci ON a.city_id = ci.city_id
        JOIN country co ON ci.country_id = co.country_id
        WHERE co.country = 'Australia'
        GROUP BY DATE(r.rental_date)
    ) AS australia_avg) - 
    (SELECT AVG(daily_rentals) FROM (
        SELECT COUNT(rental_id) AS daily_rentals
        FROM rental r
        JOIN customer c ON r.customer_id = c.customer_id
        JOIN address a ON c.address_id = a.address_id
        JOIN city ci ON a.city_id = ci.city_id
        JOIN country co ON ci.country_id = co.country_id
        WHERE co.country = 'Canada'
        GROUP BY DATE(r.rental_date)
    ) AS canada_avg) AS difference;
```
-------------------------9253 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.name = 'Action' THEN 1 END) * 100.0 / COUNT(*)) AS action_percentage
FROM 
    actor a
JOIN 
    film_actor fa ON a.actor_id = fa.actor_id
JOIN 
    film f ON fa.film_id = f.film_id
JOIN 
    film_category fc ON f.film_id = fc.film_id
JOIN 
    category c ON fc.category_id = c.category_id
WHERE 
    a.first_name = 'Reese' AND a.last_name = 'Kilmer';
```
-------------------------9254 sample_num
```sql
SELECT SUM(p.amount) AS total_rent
FROM payment p
JOIN rental r ON p.rental_id = r.rental_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
WHERE f.title = 'Clockwork Paradice';
```
-------------------------9255 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
JOIN film_category fc ON f.film_id = fc.film_id
GROUP BY c.customer_id
HAVING COUNT(DISTINCT fc.category_id) > 5;
```
-------------------------9256 sample_num
```sql
SELECT AVG(actor_count) AS average_actors
FROM (
    SELECT COUNT(fa.actor_id) AS actor_count
    FROM film_category fc
    JOIN category c ON fc.category_id = c.category_id
    JOIN film f ON fc.film_id = f.film_id
    JOIN film_actor fa ON f.film_id = fa.film_id
    WHERE c.name = 'Comedy'
    GROUP BY f.film_id
) AS actor_counts;
```
-------------------------9257 sample_num
```sql
SELECT f.title, COUNT(r.rental_id) AS rental_count
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
WHERE c.name = 'Children'
GROUP BY f.title
ORDER BY rental_count DESC
LIMIT 1;
```
-------------------------9258 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.amount > (SELECT AVG(amount) FROM payment WHERE customer_id IN (SELECT customer_id FROM customer WHERE store_id = 1)) THEN 1 END) * 100.0) / COUNT(DISTINCT c.customer_id) AS percentage_above_average
FROM 
    payment p
JOIN 
    customer c ON p.customer_id = c.customer_id
WHERE 
    c.store_id = 1;
```
-------------------------9259 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category cat ON fc.category_id = cat.category_id
WHERE cat.name IN ('Family', 'Sci-Fi')
GROUP BY c.customer_id
HAVING SUM(cat.name = 'Family') > SUM(cat.name = 'Sci-Fi');
```
-------------------------9260 sample_num
```sql
SELECT title FROM film WHERE rating = 'NC-17';
```
-------------------------9261 sample_num
```sql
SELECT COUNT(*) FROM actor WHERE last_name = 'Kilmer';
```
-------------------------9262 sample_num
```sql
SELECT COUNT(*) FROM film WHERE length > 100;
```
-------------------------9263 sample_num
```sql
SELECT COUNT(*) AS total_payments
FROM payment
WHERE payment_date LIKE '2005-08%';
```
-------------------------9264 sample_num
```sql
SELECT country.country 
FROM address 
JOIN city ON address.city_id = city.city_id 
JOIN country ON city.country_id = country.country_id 
WHERE address.address = '1386 Nakhon Sawan Boulevard';
```
-------------------------9265 sample_num
```sql
SELECT l.name
FROM film f
JOIN language l ON f.language_id = l.language_id
WHERE f.release_year = 2006
GROUP BY l.language_id
ORDER BY COUNT(f.film_id) DESC
LIMIT 1;
```
-------------------------9266 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Classics';
```
-------------------------9267 sample_num
```sql
SELECT COUNT(r.rental_id) AS total_rentals
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
WHERE c.first_name = 'Ella' AND c.last_name = 'Oliver'
AND r.rental_date BETWEEN '2016-06-01' AND '2016-06-30';
```
-------------------------9268 sample_num
```sql
SELECT COUNT(DISTINCT c.customer_id) AS different_clients
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN staff s ON r.staff_id = s.staff_id
WHERE CONCAT(c.first_name, ' ', c.last_name) = 'Jon Stephens';
```
-------------------------9269 sample_num
```sql
SELECT SUM(amount) AS total_amount
FROM payment
JOIN rental ON payment.rental_id = rental.rental_id
WHERE rental.rental_date = '2005-07-29';
```
-------------------------9270 sample_num
```sql
SELECT first_name 
FROM customer 
WHERE address_id IN (
    SELECT address_id 
    FROM address 
    WHERE postal_code LIKE '76%'
);
```
-------------------------9271 sample_num
```sql
SELECT r.return_date 
FROM rental r 
JOIN inventory i ON r.inventory_id = i.inventory_id 
JOIN film f ON i.film_id = f.film_id 
WHERE f.title = 'BLOOD ARGONAUTS';
```
-------------------------9272 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Cuba' AND a.last_name = 'Allen';
```
-------------------------9273 sample_num
```sql
SELECT COUNT(DISTINCT fa.actor_id) AS actor_count
FROM film_category fc
JOIN film_actor fa ON fc.film_id = fa.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Music';
```
-------------------------9274 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film_category fc ON fa.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Comedy'
GROUP BY a.actor_id
ORDER BY COUNT(fa.film_id) DESC
LIMIT 1;
```
-------------------------9275 sample_num
```sql
SELECT COUNT(DISTINCT c.customer_id) AS non_renting_customers
FROM customer c
LEFT JOIN rental r ON c.customer_id = r.customer_id
LEFT JOIN inventory i ON r.inventory_id = i.inventory_id
LEFT JOIN store s ON i.store_id = s.store_id
LEFT JOIN staff st ON s.manager_staff_id = st.staff_id
WHERE st.first_name != 'Mike' AND r.rental_id IS NULL;
```
-------------------------9276 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS actor_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.rating = 'PG-13' AND f.replacement_cost = (
    SELECT MAX(replacement_cost)
    FROM film
    WHERE rating = 'PG-13'
);
```
-------------------------9277 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS client_name
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
WHERE r.return_date IS NULL
GROUP BY c.customer_id
ORDER BY COUNT(r.rental_id) DESC
LIMIT 1;
```
-------------------------9278 sample_num
```sql
SELECT COUNT(*) 
FROM customer c
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
WHERE ci.city = 'Miyakonojo';
```
-------------------------9279 sample_num
```sql
SELECT COUNT(DISTINCT c.customer_id) AS non_active_clients
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
WHERE c.active = 0 AND r.return_date IS NULL;
```
-------------------------9280 sample_num
```sql
SELECT f.title
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Animation'
ORDER BY f.length ASC
LIMIT 1;
```
-------------------------9281 sample_num
```sql
SELECT country.country
FROM customer
JOIN rental ON customer.customer_id = rental.customer_id
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN store ON inventory.store_id = store.store_id
JOIN address ON store.address_id = address.address_id
JOIN city ON address.city_id = city.city_id
JOIN country ON city.country_id = country.country_id
WHERE customer.first_name = 'Hector' AND customer.last_name = 'Poinexter';
```
-------------------------9282 sample_num
```sql
SELECT AVG(p.amount) AS average_rental_payment
FROM payment p
JOIN rental r ON p.rental_id = r.rental_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Horror';
```
-------------------------9283 sample_num
```sql
SELECT AVG(p.amount) AS average_rent
FROM customer c
JOIN payment p ON c.customer_id = p.customer_id
WHERE c.first_name = 'Christy' AND c.last_name = 'Vargas';
```
-------------------------9284 sample_num
```sql
SELECT 
    (SUM(CASE WHEN f.length < 100 AND c.name = 'Drama' THEN 1 ELSE 0 END) * 100.0 / COUNT(f.film_id)) AS percentage
FROM 
    film f
JOIN 
    film_category fc ON f.film_id = fc.film_id
JOIN 
    category c ON fc.category_id = c.category_id;
```
-------------------------9285 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
WHERE a.first_name = (SELECT first_name FROM actor WHERE last_name = 'Depp' LIMIT 1);
```
-------------------------9286 sample_num
```sql
SELECT address_id 
FROM address 
WHERE district = 'Gansu';
```
-------------------------9287 sample_num
```sql
SELECT category_id, name, last_update 
FROM category 
LIMIT 3;
```
-------------------------9288 sample_num
```sql
SELECT first_name || ' ' || last_name AS full_name
FROM customer
WHERE active = 0
LIMIT 3;
```
-------------------------9289 sample_num
```sql
SELECT DIV(f.rental_rate, f.rental_duration) AS rental_price_per_day
FROM film f
WHERE f.title = 'Airplane Sierra';
```
-------------------------9290 sample_num
```sql
SELECT a.address, a.address2, a.district 
FROM store s 
JOIN address a ON s.address_id = a.address_id 
WHERE s.store_id = 2;
```
-------------------------9291 sample_num
```sql
SELECT city.city 
FROM address 
JOIN city ON address.city_id = city.city_id 
WHERE address.address = '1623 Kingstown Drive';
```
-------------------------9292 sample_num
```sql
SELECT city FROM city WHERE country_id = (SELECT country_id FROM country WHERE country = 'Algeria') LIMIT 3;
```
-------------------------9293 sample_num
```sql
SELECT c.name AS category
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE f.title = 'Agent Truman';
```
-------------------------9294 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'action'
LIMIT 3;
```
-------------------------9295 sample_num
```sql
SELECT 
    (SELECT COUNT(f.film_id) 
     FROM film f 
     JOIN film_category fc ON f.film_id = fc.film_id 
     JOIN category c ON fc.category_id = c.category_id 
     WHERE c.name = 'Children') - 
    (SELECT COUNT(f.film_id) 
     FROM film f 
     JOIN film_category fc ON f.film_id = fc.film_id 
     JOIN category c ON fc.category_id = c.category_id 
     WHERE c.name = 'Action') AS difference;
```
-------------------------9296 sample_num
```sql
SELECT a.district 
FROM customer c 
JOIN address a ON c.address_id = a.address_id 
WHERE c.first_name = 'Maria' AND c.last_name = 'Miller';
```
-------------------------9297 sample_num
```sql
SELECT first_name, last_name 
FROM customer 
JOIN address ON customer.address_id = address.address_id 
WHERE customer.active = 1 
AND address.address = '1795 Santiago de Compostela Way' 
AND address.district = 'Texas';
```
-------------------------9298 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE language_id = (SELECT language_id FROM language WHERE name = 'English') 
AND length > 50 
AND replacement_cost < 10.99;
```
-------------------------9299 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.title = 'ACADEMY DINOSAUR';
```
-------------------------9300 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Penelope' AND a.last_name = 'Guiness'
LIMIT 2;
```
-------------------------9301 sample_num
```sql
SELECT (COUNT(CASE WHEN c.name = 'Documentary' THEN 1 END) * 100.0 / COUNT(f.film_id)) AS percentage_documentary
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id;
```
-------------------------9302 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE language_id = (SELECT language_id FROM language WHERE name = 'English') 
AND rating = 'NC-17';
```
-------------------------9303 sample_num
```sql
SELECT title 
FROM film 
WHERE length = (SELECT MAX(length) FROM film);
```
-------------------------9304 sample_num
```sql
SELECT COUNT(*) FROM actor WHERE first_name = 'Dan';
```
-------------------------9305 sample_num
```sql
SELECT first_name
FROM customer
GROUP BY first_name
ORDER BY COUNT(first_name) DESC
LIMIT 1;
```
-------------------------9306 sample_num
```sql
SELECT rating 
FROM film 
WHERE special_features = 'Behind the Scenes';
```
-------------------------9307 sample_num
```sql
SELECT MAX(rental_count) AS largest_number_of_films_rented
FROM (
    SELECT customer_id, COUNT(rental_id) AS rental_count
    FROM rental
    GROUP BY customer_id
) AS rental_counts;
```
-------------------------9308 sample_num
```sql
SELECT title 
FROM film 
WHERE description LIKE '%Lacklusture%';
```
-------------------------9309 sample_num
```sql
SELECT COUNT(r.rental_id) AS films_rented
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
WHERE c.first_name = 'Francis' AND c.last_name = 'Sikes';
```
-------------------------9310 sample_num
```sql
SELECT s.manager_staff_id, CONCAT(st.first_name, ' ', st.last_name) AS manager_name
FROM store s
JOIN inventory i ON s.store_id = i.store_id
JOIN staff st ON s.manager_staff_id = st.staff_id
GROUP BY s.store_id, s.manager_staff_id, st.first_name, st.last_name
ORDER BY COUNT(i.film_id) DESC
LIMIT 1;
```
-------------------------9311 sample_num
```sql
SELECT a.address, a.address2, a.district, c.city, co.country
FROM customer AS cu
JOIN address AS a ON cu.address_id = a.address_id
JOIN city AS c ON a.city_id = c.city_id
JOIN country AS co ON c.country_id = co.country_id
WHERE cu.active = 0;
```
-------------------------9312 sample_num
```sql
SELECT c.name, COUNT(fc.category_id) AS category_count
FROM film_category fc
JOIN category c ON fc.category_id = c.category_id
GROUP BY c.name
ORDER BY category_count DESC
LIMIT 1;
```
-------------------------9313 sample_num
```sql
SELECT a.first_name, a.last_name
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE f.title = 'Jason trap';
```
-------------------------9314 sample_num
```sql
SELECT c.first_name, c.last_name, SUM(p.amount) AS total_payment
FROM customer c
JOIN payment p ON c.customer_id = p.customer_id
JOIN rental r ON p.rental_id = r.rental_id
GROUP BY c.customer_id
ORDER BY total_payment DESC
LIMIT 1;
```
-------------------------9315 sample_num
```sql
SELECT f.title, COUNT(r.rental_id) AS rental_count
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
GROUP BY f.film_id
ORDER BY rental_count DESC
LIMIT 5;
```
-------------------------9316 sample_num
```sql
SELECT country.country 
FROM city 
JOIN country ON city.country_id = country.country_id 
WHERE city.city = 'Sasebo';
```
-------------------------9317 sample_num
```sql
SELECT a.address, a.address2, a.district, c.city, co.country
FROM store s
JOIN address a ON s.address_id = a.address_id
JOIN city c ON a.city_id = c.city_id
JOIN country co ON c.country_id = co.country_id;
```
-------------------------9318 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Animation';
```
-------------------------9319 sample_num
```sql
SELECT c.city, COUNT(cu.customer_id) AS customer_count
FROM customer cu
JOIN address a ON cu.address_id = a.address_id
JOIN city c ON a.city_id = c.city_id
GROUP BY c.city
ORDER BY customer_count DESC
LIMIT 1;
```
-------------------------9320 sample_num
```sql
SELECT a.first_name, a.last_name, COUNT(fa.film_id) AS film_count
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
GROUP BY a.actor_id
ORDER BY film_count DESC
LIMIT 1;
```
-------------------------9321 sample_num
```sql
SELECT (SUM(c.name = 'Horror') / COUNT(f.film_id)) * 100 AS horror_percentage
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id;
```
-------------------------9322 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name 
FROM actor 
WHERE actor_id = 5;
```
-------------------------9323 sample_num
```sql
SELECT COUNT(film_id) 
FROM film_category 
WHERE category_id = 11;
```
-------------------------9324 sample_num
```sql
SELECT c.name 
FROM film f 
JOIN film_category fc ON f.film_id = fc.film_id 
JOIN category c ON fc.category_id = c.category_id 
WHERE f.title = 'BABY HALL';
```
-------------------------9325 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.rental_rate = (SELECT MAX(rental_rate) FROM film);
```
-------------------------9326 sample_num
```sql
SELECT f.description 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'JENNIFER' AND a.last_name = 'DAVIS';
```
-------------------------9327 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN payment p ON c.customer_id = p.customer_id
WHERE p.amount > 10;
```
-------------------------9328 sample_num
```sql
SELECT address 
FROM address 
WHERE address_id = (SELECT address_id 
                    FROM customer 
                    WHERE first_name = 'SUSAN' AND 
                          address_id IN (SELECT address_id 
                                         FROM address 
                                         WHERE postal_code = '77948'));
```
-------------------------9329 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS customer_name
FROM customer c
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
WHERE ci.city = 'Abu Dhabi';
```
-------------------------9330 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN address a ON c.address_id = a.address_id
WHERE a.address = '692 Joliet Street';
```
-------------------------9331 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE f.length > 120 AND c.name = 'action';
```
-------------------------9332 sample_num
```sql
SELECT a.first_name, a.last_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.title = 'ANONYMOUS HUMAN';
```
-------------------------9333 sample_num
```sql
SELECT f.title
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Horror'
ORDER BY f.rental_rate ASC
LIMIT 1;
```
-------------------------9334 sample_num
```sql
SELECT f.description
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Travel';
```
-------------------------9335 sample_num
```sql
SELECT SUM(p.amount) AS total_payment
FROM payment p
JOIN customer c ON p.customer_id = c.customer_id
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
WHERE a.district = 'Nagasaki';
```
-------------------------9336 sample_num
```sql
SELECT 
    (SUM(p.amount) / (SELECT SUM(amount) FROM payment) * 100) AS percentage
FROM 
    payment p
JOIN 
    customer c ON p.customer_id = c.customer_id
WHERE 
    c.first_name = 'MARGARET' AND c.last_name = 'MOORE';
```
-------------------------9337 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN f.length > 120 AND c.name = 'Horror' THEN 1 END) * 100.0 / COUNT(f.title)) AS horror_percentage
FROM 
    film f
JOIN 
    film_category fc ON f.film_id = fc.film_id
JOIN 
    category c ON fc.category_id = c.category_id;
```
-------------------------9338 sample_num
```sql
SELECT COUNT(title) AS film_count
FROM film
WHERE release_year = 2006;
```
-------------------------9339 sample_num
```sql
SELECT title FROM film WHERE film_id BETWEEN 1 AND 10;
```
-------------------------9340 sample_num
```sql
SELECT film_id 
FROM film 
WHERE rental_duration = (SELECT MAX(rental_duration) FROM film);
```
-------------------------9341 sample_num
```sql
SELECT title 
FROM film 
WHERE rental_rate = (SELECT MAX(rental_rate) FROM film);
```
-------------------------9342 sample_num
```sql
SELECT title FROM film WHERE rating = 'G';
```
-------------------------9343 sample_num
```sql
SELECT l.name 
FROM film f 
JOIN language l ON f.language_id = l.language_id 
WHERE f.title = 'CHILL LUCK';
```
-------------------------9344 sample_num
```sql
SELECT f.last_update
FROM film f
JOIN language l ON f.language_id = l.language_id
WHERE l.name = 'English' AND f.release_year = 2006;
```
-------------------------9345 sample_num
```sql
SELECT COUNT(f.title) AS italian_deleted_scenes_count
FROM film f
JOIN language l ON f.language_id = l.language_id
WHERE l.name = 'Italian' AND f.special_features LIKE '%deleted scenes%';
```
-------------------------9346 sample_num
```sql
SELECT COUNT(f.title) AS adult_animation_count
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Animation' AND f.rating = 'NC-17';
```
-------------------------9347 sample_num
```sql
SELECT DISTINCT f.rating
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'action';
```
-------------------------9348 sample_num
```sql
SELECT f.film_id
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Comedy';
```
-------------------------9349 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'documentary' 
AND f.length = (SELECT MAX(length) FROM film WHERE film_id IN (SELECT film_id FROM film_category WHERE category_id = (SELECT category_id FROM category WHERE name = 'documentary')));
```
-------------------------9350 sample_num
```sql
SELECT c.name AS category
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE f.title = 'BLADE POLISH';
```
-------------------------9351 sample_num
```sql
SELECT r.rental_id 
FROM customer c 
JOIN rental r ON c.customer_id = r.customer_id 
WHERE c.first_name = 'Mary' AND c.last_name = 'Smith';
```
-------------------------9352 sample_num
```sql
SELECT c.first_name 
FROM customer c 
JOIN rental r ON c.customer_id = r.customer_id 
WHERE r.staff_id = 1;
```
-------------------------9353 sample_num
```sql
SELECT c.email 
FROM customer c 
JOIN rental r ON c.customer_id = r.customer_id 
JOIN staff s ON r.staff_id = s.staff_id 
WHERE s.staff_id = 2;
```
-------------------------9354 sample_num
```sql
SELECT fa.actor_id 
FROM film f 
JOIN film_actor fa ON f.film_id = fa.film_id 
WHERE f.title = 'BOUND CHEAPER';
```
-------------------------9355 sample_num
```sql
SELECT i.inventory_id 
FROM inventory i
JOIN film f ON i.film_id = f.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN customer c ON r.customer_id = c.customer_id
WHERE c.first_name = 'Karen' AND c.last_name = 'Jackson';
```
-------------------------9356 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Jane' AND a.last_name = 'Jackman';
```
-------------------------9357 sample_num
```sql
SELECT a.first_name, a.last_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.title = 'BIRD INDEPENDENCE';
```
-------------------------9358 sample_num
```sql
SELECT SUM(f.rental_rate) AS total_rental_rate
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Animation';
```
-------------------------9359 sample_num
```sql
SELECT AVG(f.rental_rate) AS average_rental_rate
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Sci-Fi';
```
-------------------------9360 sample_num
```sql
SELECT 
    (COUNT(f.film_id) FILTER (WHERE c.name = 'Horror') * 100.0 / COUNT(f.film_id)) AS horror_percentage
FROM 
    film f
JOIN 
    film_category fc ON f.film_id = fc.film_id
JOIN 
    category c ON fc.category_id = c.category_id
JOIN 
    language l ON f.language_id = l.language_id
WHERE 
    l.name = 'English';
```
-------------------------9361 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE rating = 'NC-17' AND rental_duration < 4;
```
-------------------------9362 sample_num
```sql
SELECT title 
FROM film 
WHERE rating = 'R' AND length = 71 AND replacement_cost = 29.99;
```
-------------------------9363 sample_num
```sql
SELECT c.email 
FROM customer c 
JOIN rental r ON c.customer_id = r.customer_id 
WHERE c.active = 1 
AND r.rental_date BETWEEN '2005-05-25 19:37:47' AND '2005-05-26 10:06:49';
```
-------------------------9364 sample_num
```sql
SELECT SUM(p.amount) AS total_payment
FROM payment p
JOIN customer c ON p.customer_id = c.customer_id
JOIN rental r ON p.rental_id = r.rental_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
WHERE c.first_name = 'Sarah' AND c.last_name = 'Lewis';
```
-------------------------9365 sample_num
```sql
SELECT COUNT(*) AS payment_count
FROM payment p
JOIN customer c ON p.customer_id = c.customer_id
WHERE c.first_name = 'Susan' AND c.last_name = 'Wilson'
AND p.payment_date BETWEEN '2005-05-30 03:43:54' AND '2005-07-31 22:08:29';
```
-------------------------9366 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.title = 'ALABAMA DEVIL';
```
-------------------------9367 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Sandra' AND a.last_name = 'Kilmer';
```
-------------------------9368 sample_num
```sql
SELECT COUNT(*) 
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'documentary' AND f.rating = 'PG-13';
```
-------------------------9369 sample_num
```sql
SELECT f.title, c.name AS category_name, f.special_features
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE (f.rental_duration * f.rental_rate) > 30;
```
-------------------------9370 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS cast_member_name
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE f.title = 'AFRICAN EGG';
```
-------------------------9371 sample_num
```sql
SELECT COUNT(DISTINCT f.film_id) AS number_of_movies_rented
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
WHERE c.first_name = 'Maria' AND c.last_name = 'Miller';
```
-------------------------9372 sample_num
```sql
SELECT f.title
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN customer c ON r.customer_id = c.customer_id
WHERE c.first_name = 'Dorothy' AND c.last_name = 'Taylor'
ORDER BY r.rental_date DESC
LIMIT 1;
```
-------------------------9373 sample_num
```sql
SELECT COUNT(*) AS action_movie_count
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Action' AND f.film_id IN (SELECT film_id FROM inventory);
```
-------------------------9374 sample_num
```sql
SELECT a.address, f.rental_rate
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN store s ON i.store_id = s.store_id
JOIN address a ON s.address_id = a.address_id
WHERE f.title = 'WYOMING STORM';
```
-------------------------9375 sample_num
```sql
SELECT DATEDIFF(r.return_date, r.rental_date) AS days_taken
FROM rental r
JOIN customer c ON r.customer_id = c.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
WHERE c.first_name = 'Austin' AND c.last_name = 'Cintron' AND f.title = 'DESTINY SATURDAY';
```
-------------------------9376 sample_num
```sql
SELECT COUNT(DISTINCT f.film_id) AS number_of_movies
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Nick' AND a.last_name = 'Stallone';
```
-------------------------9377 sample_num
```sql
SELECT f.title
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
GROUP BY f.film_id
HAVING f.length = (SELECT MIN(length) FROM film)
ORDER BY SUM(f.rental_duration * f.rental_rate) DESC
LIMIT 1;
```
-------------------------9378 sample_num
```sql
SELECT SUM(p.amount) AS total_amount
FROM payment p
JOIN customer c ON p.customer_id = c.customer_id
WHERE c.first_name = 'Stephanie' AND c.last_name = 'Mitchell' 
AND p.payment_date LIKE '2005-06%';
```
-------------------------9379 sample_num
```sql
SELECT AVG(replacement_cost) AS average_replacement_cost
FROM film
WHERE rental_rate = 4.99;
```
-------------------------9380 sample_num
```sql
SELECT AVG(rental_rate) AS average_rental_rate
FROM film
WHERE rating = 'PG-13';
```
-------------------------9381 sample_num
```sql
SELECT (COUNT(CASE WHEN active = 0 THEN 1 END) * 100.0 / COUNT(customer_id)) AS inactive_percentage
FROM customer
WHERE store_id = 1;
```
-------------------------9382 sample_num
```sql
SELECT rental_duration FROM film WHERE title = 'DIRTY ACE';
```
-------------------------9383 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM customer
WHERE email = 'SHEILA.WELLS@sakilacustomer.org';
```
-------------------------9384 sample_num
```sql
SELECT title 
FROM film 
WHERE length = (SELECT MAX(length) FROM film) 
ORDER BY title;
```
-------------------------9385 sample_num
```sql
SELECT COUNT(*) FROM category;
```
-------------------------9386 sample_num
```sql
SELECT 
    COUNT(DISTINCT r.inventory_id) AS total_rentals,
    (COUNT(DISTINCT CASE WHEN MONTH(r.rental_date) = 6 THEN r.inventory_id END) * 100.0 / COUNT(DISTINCT r.inventory_id)) AS percentage_june
FROM 
    customer c
JOIN 
    rental r ON c.customer_id = r.customer_id
WHERE 
    c.first_name = 'Mary' AND c.last_name = 'Smith' AND YEAR(r.rental_date) = 2005;
```
-------------------------9387 sample_num
```sql
SELECT COUNT(*) AS active_customers FROM customer WHERE active = 1;
```
-------------------------9388 sample_num
```sql
SELECT title FROM film WHERE rating = 'PG-13';
```
-------------------------9389 sample_num
```sql
SELECT title 
FROM film 
WHERE rental_duration > 5 
LIMIT 10;
```
-------------------------9390 sample_num
```sql
SELECT city.city 
FROM city 
JOIN country ON city.country_id = country.country_id 
WHERE country.country = 'United Arab Emirates';
```
-------------------------9391 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN payment p ON c.customer_id = p.customer_id
WHERE p.amount > 10
LIMIT 5;
```
-------------------------9392 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Burt' AND a.last_name = 'Dukakis';
```
-------------------------9393 sample_num
```sql
SELECT CONCAT(a.first_name, ' ', a.last_name) AS full_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.title = 'ENDING CROWDS';
```
-------------------------9394 sample_num
```sql
SELECT a.first_name, a.last_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.title = 'BOUND CHEAPER';
```
-------------------------9395 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Karl' AND a.last_name = 'Berr' AND f.rating = 'PG';
```
-------------------------9396 sample_num
```sql
SELECT city.city 
FROM city 
JOIN country ON city.country_id = country.country_id 
WHERE country.country = 'Philippines' 
LIMIT 3;
```
-------------------------9397 sample_num
```sql
SELECT f.title, COUNT(r.customer_id) AS rental_count
FROM film f
LEFT JOIN inventory i ON f.film_id = i.film_id
LEFT JOIN rental r ON i.inventory_id = r.inventory_id
GROUP BY f.film_id
ORDER BY rental_count ASC
LIMIT 10;
```
-------------------------9398 sample_num
```sql
SELECT f.description 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Lucille' AND a.last_name = 'Tracy';
```
-------------------------9399 sample_num
```sql
SELECT c.name 
FROM film f 
JOIN film_category fc ON f.film_id = fc.film_id 
JOIN category c ON fc.category_id = c.category_id 
WHERE f.title = 'BEACH HEARTBREAKERS';
```
-------------------------9400 sample_num
```sql
SELECT f.title
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Horror'
LIMIT 10;
```
-------------------------9401 sample_num
```sql
SELECT DISTINCT a.last_name
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
WHERE f.rating = 'NC-17';
```
-------------------------9402 sample_num
```sql
SELECT AVG(f.rental_rate) AS average_rate
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Lucille' AND a.last_name = 'Tracy';
```
-------------------------9403 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE length BETWEEN 100 AND 110;
```
-------------------------9404 sample_num
```sql
SELECT actor_id FROM actor WHERE last_name = 'Dee';
```
-------------------------9405 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE first_name = 'Nina' AND active = 1;
```
-------------------------9406 sample_num
```sql
SELECT COUNT(*) 
FROM film 
WHERE rating = 'R' 
AND film_id IN (SELECT film_id FROM inventory WHERE store_id = 2);
```
-------------------------9407 sample_num
```sql
SELECT DISTINCT i.store_id
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
JOIN inventory i ON f.film_id = i.film_id
WHERE a.first_name = 'Reese' AND a.last_name = 'West' AND f.length < 100;
```
-------------------------9408 sample_num
```sql
SELECT f.length
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Nick' AND a.last_name = 'Wahlberg'
ORDER BY f.rental_rate DESC
LIMIT 1;
```
-------------------------9409 sample_num
```sql
SELECT f.title 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'Russell' AND a.last_name = 'Close';
```
-------------------------9410 sample_num
```sql
SELECT i.store_id 
FROM film f 
JOIN inventory i ON f.film_id = i.film_id 
WHERE f.title = 'Amadeus Holy';
```
-------------------------9411 sample_num
```sql
SELECT COUNT(DISTINCT f.film_id) AS film_count
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE f.rental_rate = 2.99 AND a.first_name = 'Nina' AND a.last_name = 'Soto';
```
-------------------------9412 sample_num
```sql
SELECT 
    (SELECT COUNT(f.film_id) 
     FROM film f 
     JOIN inventory i ON f.film_id = i.film_id 
     JOIN film_actor fa ON f.film_id = fa.film_id 
     WHERE i.store_id = 1 AND fa.actor_id = (SELECT actor_id FROM actor WHERE first_name = 'Reese' AND last_name = 'West')) AS count_store_1,
    
    (SELECT COUNT(f.film_id) 
     FROM film f 
     JOIN inventory i ON f.film_id = i.film_id 
     JOIN film_actor fa ON f.film_id = fa.film_id 
     WHERE i.store_id = 2 AND fa.actor_id = (SELECT actor_id FROM actor WHERE first_name = 'Reese' AND last_name = 'West')) AS count_store_2,

    (SELECT COUNT(f.film_id) 
     FROM film f 
     JOIN inventory i ON f.film_id = i.film_id 
     JOIN film_actor fa ON f.film_id = fa.film_id 
     WHERE i.store_id = 1 AND fa.actor_id = (SELECT actor_id FROM actor WHERE first_name = 'Reese' AND last_name = 'West')) - 
    (SELECT COUNT(f.film_id) 
     FROM film f 
     JOIN inventory i ON f.film_id = i.film_id 
     JOIN film_actor fa ON f.film_id = fa.film_id 
     WHERE i.store_id = 2 AND fa.actor_id = (SELECT actor_id FROM actor WHERE first_name = 'Reese' AND last_name = 'West')) AS difference;
```
-------------------------9413 sample_num
```sql
SELECT postal_code 
FROM address 
WHERE address = '692 Joliet Street';
```
-------------------------9414 sample_num
```sql
SELECT COUNT(*) AS active_customers FROM customer WHERE active = 1;
```
-------------------------9415 sample_num
```sql
SELECT COUNT(*) 
FROM customer 
WHERE store_id = 1 AND active = 1;
```
-------------------------9416 sample_num
```sql
SELECT a.address, a.address2, a.district, c.city, co.country 
FROM customer AS cu
JOIN address AS a ON cu.address_id = a.address_id
JOIN city AS c ON a.city_id = c.city_id
JOIN country AS co ON c.country_id = co.country_id
WHERE cu.first_name = 'Mary' AND cu.last_name = 'Smith';
```
-------------------------9417 sample_num
```sql
SELECT COUNT(*) 
FROM customer c
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
WHERE c.active = 1 AND ci.city = 'Arlington';
```
-------------------------9418 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
JOIN country co ON ci.country_id = co.country_id
WHERE co.country = 'Italy';
```
-------------------------9419 sample_num
```sql
SELECT country.country 
FROM customer 
JOIN address ON customer.address_id = address.address_id 
JOIN city ON address.city_id = city.city_id 
JOIN country ON city.country_id = country.country_id 
WHERE customer.first_name = 'Mary' AND customer.last_name = 'Smith';
```
-------------------------9420 sample_num
```sql
SELECT MAX(p.amount) 
FROM payment p 
JOIN customer c ON p.customer_id = c.customer_id 
WHERE c.first_name = 'Mary' AND c.last_name = 'Smith';
```
-------------------------9421 sample_num
```sql
SELECT COUNT(rental.rental_id) AS rental_count
FROM customer
JOIN rental ON customer.customer_id = rental.customer_id
WHERE customer.first_name = 'Mary' AND customer.last_name = 'Smith';
```
-------------------------9422 sample_num
```sql
SELECT SUM(p.amount) AS total_spent
FROM payment p
JOIN customer c ON p.customer_id = c.customer_id
WHERE c.first_name = 'Mary' AND c.last_name = 'Smith';
```
-------------------------9423 sample_num
```sql
SELECT COUNT(*) 
FROM rental r
JOIN payment p ON r.rental_id = p.rental_id
JOIN customer c ON r.customer_id = c.customer_id
WHERE c.first_name = 'Mary' AND c.last_name = 'Smith' 
AND YEAR(p.payment_date) = 2005 AND MONTH(p.payment_date) = 6;
```
-------------------------9424 sample_num
```sql
SELECT CONCAT(c.first_name, ' ', c.last_name) AS full_name
FROM customer c
JOIN payment p ON c.customer_id = p.customer_id
ORDER BY p.amount DESC
LIMIT 1;
```
-------------------------9425 sample_num
```sql
SELECT SUM(p.amount) AS total_spent
FROM payment p
JOIN customer c ON p.customer_id = c.customer_id
JOIN address a ON c.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
JOIN country co ON ci.country_id = co.country_id
WHERE co.country = 'Italy';
```
-------------------------9426 sample_num
```sql
SELECT COUNT(*) 
FROM payment p
JOIN customer c ON p.customer_id = c.customer_id
WHERE c.first_name = 'Mary' AND c.last_name = 'Smith' AND p.amount > 4.99;
```
-------------------------9427 sample_num
```sql
SELECT AVG(amount) AS average_amount_spent
FROM payment
JOIN customer ON payment.customer_id = customer.customer_id
JOIN address ON customer.address_id = address.address_id
JOIN city ON address.city_id = city.city_id
JOIN country ON city.country_id = country.country_id
WHERE country.country = 'Italy';
```
-------------------------9428 sample_num
```sql
SELECT MAX("Percent (%) Eligible Free (K-12)") AS Highest_Eligible_Free_Rate
FROM frpm
WHERE "County Name" = 'Alameda';
```
-------------------------9429 sample_num
```sql
SELECT 
    s.School, 
    (f."Free Meal Count (Ages 5-17)"::float / f."Enrollment (Ages 5-17)"::float) AS Eligible_Free_Rate
FROM 
    frpm f
JOIN 
    schools s ON f.CDSCode = s.CDSCode
WHERE 
    f."School Type" = 'Continuation School'
ORDER BY 
    Eligible_Free_Rate ASC
LIMIT 3;
```
-------------------------9430 sample_num
```sql
SELECT DISTINCT s.Zip
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE f.County Name = 'Fresno County Office of Education' AND f.Charter School (Y/N) = 'Y';
```
-------------------------9431 sample_num
```sql
SELECT s.MailStreet, s.MailCity, s.MailZip, s.MailState
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
ORDER BY f."FRPM Count (K-12)" DESC
LIMIT 1;
```
-------------------------9432 sample_num
```sql
SELECT s.Phone 
FROM schools s 
JOIN frpm f ON s.CDSCode = f.CDSCode 
WHERE f.Charter_School_Y_N = 'Y' 
AND f.Charter_Funding_Type = 'Direct' 
AND s.OpenDate > '2000-01-01';
```
-------------------------9433 sample_num
```sql
SELECT COUNT(*) 
FROM satscores s
JOIN schools sch ON s.cds = sch.CDSCode
WHERE s.AvgScrMath < 400 AND sch.Virtual = 'F';
```
-------------------------9434 sample_num
```sql
SELECT s.School, s.District, s.County
FROM satscores sat
JOIN schools s ON sat.cds = s.CDSCode
WHERE sat.NumTstTakr > 500 AND s.Magnet = 1;
```
-------------------------9435 sample_num
```sql
SELECT s.Phone
FROM satscores s
WHERE s.NumTstTakr = (
    SELECT MAX(NumTstTakr)
    FROM satscores
    WHERE NumGE1500 > 0
)
AND s.NumGE1500 > 0
JOIN schools sch ON s.cds = sch.CDSCode;
```
-------------------------9436 sample_num
```sql
SELECT SUM(s.NumTstTakr) AS Total_SAT_Test_Takers
FROM satscores s
JOIN frpm f ON s.cds = f.CDSCode
WHERE f.FRPM_Count_K12 = (
    SELECT MAX(FRPM_Count_K12)
    FROM frpm
)
```
-------------------------9437 sample_num
```sql
SELECT COUNT(*) 
FROM satscores s
JOIN schools sch ON s.cds = sch.CDSCode
WHERE s.AvgScrMath > 560 AND sch.FundingType = 'Charter';
```
-------------------------9438 sample_num
```sql
SELECT f."FRPM Count (Ages 5-17)"
FROM satscores s
JOIN frpm f ON s.cds = f.CDSCode
WHERE s.AvgScrRead = (SELECT MAX(AvgScrRead) FROM satscores);
```
-------------------------9439 sample_num
```sql
SELECT CDSCode 
FROM frpm 
WHERE (Enrollment (K-12) + Enrollment (Ages 5-17)) > 500;
```
-------------------------9440 sample_num
```sql
SELECT MAX((frpm."Free Meal Count (Ages 5-17)"::float / frpm."Enrollment (Ages 5-17)"::float) * 100) AS highest_eligible_free_rate
FROM satscores
JOIN frpm ON satscores.cds = frpm.CDSCode
WHERE (satscores.NumGE1500::float / satscores.NumTstTakr::float) > 0.3;
```
-------------------------9441 sample_num
```sql
SELECT s.Phone
FROM satscores s
WHERE s.NumTstTakr > 0
ORDER BY (s.NumGE1500 * 1.0 / s.NumTstTakr) DESC
LIMIT 3;
```
-------------------------9442 sample_num
```sql
SELECT s.NCESSchool
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
ORDER BY f.[Enrollment (Ages 5-17)] DESC
LIMIT 5;
```
-------------------------9443 sample_num
```sql
SELECT dname, AVG(AvgScrRead) AS AvgReadingScore
FROM satscores s
JOIN schools sch ON s.cds = sch.CDSCode
WHERE sch.StatusType = 'Active'
GROUP BY dname
ORDER BY AvgReadingScore DESC
LIMIT 1;
```
-------------------------9444 sample_num
```sql
SELECT COUNT(*) 
FROM schools s 
JOIN satscores sa ON s.CDSCode = sa.cds 
WHERE s.County = 'Alameda' 
AND sa.NumTstTakr < 100;
```
-------------------------9445 sample_num
```sql
SELECT s."Charter School Number"
FROM satscores sa
JOIN schools s ON sa.cds = s.CDSCode
WHERE sa.AvgScrWrite = 499;
```
-------------------------9446 sample_num
```sql
SELECT COUNT(*) 
FROM schools s 
JOIN satscores sa ON s.CDSCode = sa.cds 
WHERE s.County = 'Contra Costa' 
AND s.FundingType = 'Directly Funded' 
AND sa.NumTstTakr <= 250;
```
-------------------------9447 sample_num
```sql
SELECT s.Phone
FROM satscores ss
JOIN schools s ON ss.cds = s.CDSCode
ORDER BY ss.AvgScrMath DESC
LIMIT 1;
```
-------------------------9448 sample_num
```sql
SELECT COUNT(*) 
FROM frpm 
WHERE County Name = 'Amador' 
AND Low Grade = 9 
AND High Grade = 12;
```
-------------------------9449 sample_num
```sql
SELECT COUNT(*) 
FROM frpm 
WHERE County Name = 'Los Angeles' 
AND Free Meal Count (K-12) > 500 
AND FRPM Count (K-12) < 700;
```
-------------------------9450 sample_num
```sql
SELECT s.School, s.District, s.County, sa.NumTstTakr
FROM schools s
JOIN satscores sa ON s.CDSCode = sa.cds
WHERE s.County = 'Contra Costa'
ORDER BY sa.NumTstTakr DESC
LIMIT 1;
```
-------------------------9451 sample_num
```sql
SELECT s.School, 
       s.Street, 
       s.StreetAbr, 
       s.City, 
       s.Zip, 
       s.State
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE ABS(f.Enrollment (K-12) - f.Enrollment (Ages 5-17)) > 30;
```
-------------------------9452 sample_num
```sql
SELECT s.School
FROM frpm f
JOIN satscores s ON f.CDSCode = s.cds
WHERE f.Percent_Eligible_Free_K12 > 0.1 AND s.NumTstTakr > 0 AND s.NumGE1500 > 0;
```
-------------------------9453 sample_num
```sql
SELECT s.School, s.FundingType
FROM schools s
JOIN satscores sa ON s.CDSCode = sa.cds
WHERE s.County = 'Riverside'
GROUP BY s.School, s.FundingType
HAVING AVG(sa.AvgScrMath) > 400;
```
-------------------------9454 sample_num
```sql
SELECT s.School, 
       CONCAT(s.Street, ', ', s.City, ', ', s.Zip, ', ', s.State) AS FullAddress
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE f.County Name = 'Monterey' 
  AND f.High Grade = '12' 
  AND f.FRPM Count (Ages 5-17) > 800;
```
-------------------------9455 sample_num
```sql
SELECT s.School, AVG(sa.AvgScrWrite) AS AvgWritingScore, s.Phone
FROM schools s
JOIN satscores sa ON s.CDSCode = sa.cds
WHERE s.OpenDate > '1991-01-01' OR s.ClosedDate < '2000-01-01'
GROUP BY s.School, s.Phone;
```
-------------------------9456 sample_num
```sql
WITH EnrollmentDifference AS (
    SELECT 
        s.School AS SchoolName,
        s.DOCType,
        (f."Enrollment (K-12)" - f."Enrollment (Ages 5-17)") AS Difference
    FROM 
        frpm f
    JOIN 
        schools s ON f.CDSCode = s.CDSCode
    WHERE 
        f."Charter Funding Type" = 'Locally Funded'
),
AverageDifference AS (
    SELECT 
        AVG(Difference) AS AvgDiff
    FROM 
        EnrollmentDifference
)
SELECT 
    ed.SchoolName,
    ed.DOCType
FROM 
    EnrollmentDifference ed
JOIN 
    AverageDifference ad ON ed.Difference > ad.AvgDiff;
```
-------------------------9457 sample_num
```sql
SELECT OpenDate 
FROM schools 
WHERE CDSCode = (
    SELECT CDSCode 
    FROM frpm 
    ORDER BY Enrollment DESC 
    LIMIT 1
);
```
-------------------------9458 sample_num
```sql
SELECT City, SUM(Enrollment) AS TotalEnrollment
FROM frpm
JOIN schools ON frpm.CDSCode = schools.CDSCode
WHERE LowGrade <= 1 AND HighGrade >= 12
GROUP BY City
ORDER BY TotalEnrollment ASC
LIMIT 5;
```
-------------------------9459 sample_num
```sql
SELECT 
    School_Name, 
    (Free_Meal_Count_K12 / Enrollment_K12) AS Eligible_Free_Rate
FROM 
    frpm
ORDER BY 
    Enrollment_K12 DESC
LIMIT 10 OFFSET 9;
```
-------------------------9460 sample_num
```sql
SELECT 
    s.School, 
    (f."FRPM Count (K-12)"::float / f."Enrollment (K-12)"::float) AS Eligible_Free_Reduced_Price_Meal_Rate
FROM 
    frpm f
JOIN 
    schools s ON f.CDSCode = s.CDSCode
WHERE 
    s.StatusType = '66' 
    AND f."Enrollment (K-12)" > 0
ORDER BY 
    f."FRPM Count (K-12)" DESC
LIMIT 5;
```
-------------------------9461 sample_num
```sql
SELECT s.Website, s.School
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE f.FreeMealCount_Ages_5_17 BETWEEN 1900 AND 2000;
```
-------------------------9462 sample_num
```sql
SELECT 
    (frpm."Free Meal Count (Ages 5-17)"::float / frpm."Enrollment (Ages 5-17)"::float) * 100 AS free_rate
FROM 
    frpm
JOIN 
    schools ON frpm.CDSCode = schools.CDSCode
WHERE 
    schools.AdmFName1 = 'Kacey' AND schools.AdmLName1 = 'Gibson';
```
-------------------------9463 sample_num
```sql
SELECT s.AdmEmail1
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE f."Charter School (Y/N)" = 'Y'
ORDER BY f."Enrollment (K-12)" ASC
LIMIT 1;
```
-------------------------9464 sample_num
```sql
SELECT CONCAT(sch.AdmFName1, ' ', sch.AdmLName1) AS FullName
FROM satscores sat
JOIN schools sch ON sat.cds = sch.CDSCode
WHERE sat.NumGE1500 = (
    SELECT MAX(NumGE1500)
    FROM satscores
    WHERE NumGE1500 >= 1500
)
```
-------------------------9465 sample_num
```sql
SELECT s.Street, s.City, s.Zip, s.State
FROM satscores s
JOIN (
    SELECT cds, MIN(NumGE1500 / NumTstTakr) AS MinExcellenceRate
    FROM satscores
    WHERE NumTstTakr > 0
    GROUP BY cds
) AS min_rate ON s.cds = min_rate.cds
WHERE (NumGE1500 / NumTstTakr) = min_rate.MinExcellenceRate
LIMIT 1;
```
-------------------------9466 sample_num
```sql
SELECT s.Website 
FROM satscores sat 
JOIN schools s ON sat.cds = s.CDSCode 
WHERE s.County = 'Los Angeles' 
AND sat.NumTstTakr BETWEEN 2000 AND 3000;
```
-------------------------9467 sample_num
```sql
SELECT AVG(NumTstTakr) AS AverageTestTakers
FROM satscores s
JOIN schools sch ON s.cds = sch.CDSCode
WHERE sch.County = 'Fresno' 
AND sch.OpenDate BETWEEN '1980-01-01' AND '1980-12-31';
```
-------------------------9468 sample_num
```sql
SELECT s.Phone
FROM satscores ss
JOIN schools s ON ss.cds = s.CDSCode
WHERE s.District = 'Fresno Unified'
ORDER BY ss.AvgScrRead ASC
LIMIT 1;
```
-------------------------9469 sample_num
```sql
SELECT s.School, s.City, s.County, sa.AvgScrRead
FROM schools s
JOIN satscores sa ON s.CDSCode = sa.cds
WHERE s.Virtual = 'F'
ORDER BY sa.AvgScrRead DESC
LIMIT 5;
```
-------------------------9470 sample_num
```sql
SELECT s.School, s.SchoolType
FROM satscores sat
JOIN schools s ON sat.cds = s.CDSCode
WHERE sat.AvgScrMath = (SELECT MAX(AvgScrMath) FROM satscores);
```
-------------------------9471 sample_num
```sql
SELECT AVG(AvgScrMath) AS AverageMathScore, s.County
FROM satscores s
JOIN (
    SELECT cds, (AvgScrMath + AvgScrRead + AvgScrWrite) AS TotalAvgScore
    FROM satscores
) AS avg_scores ON s.cds = avg_scores.cds
WHERE TotalAvgScore = (
    SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite)
    FROM satscores
)
GROUP BY s.County;
```
-------------------------9472 sample_num
```sql
SELECT s.City, AVG(sa.AvgScrWrite) AS AverageWritingScore
FROM satscores sa
JOIN schools s ON sa.cds = s.CDSCode
WHERE sa.NumTstTakr = (
    SELECT MAX(NumTstTakr)
    FROM satscores
    WHERE NumGE1500 > 0
)
AND sa.NumGE1500 > 0
GROUP BY s.City;
```
-------------------------9473 sample_num
```sql
SELECT s.School, AVG(sa.AvgScrWrite) AS Average_Writing_Score
FROM schools s
JOIN satscores sa ON s.CDSCode = sa.cds
WHERE s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich'
GROUP BY s.School;
```
-------------------------9474 sample_num
```sql
SELECT s.School, SUM(f.Enrollment) AS TotalEnrollment
FROM schools s
JOIN frpm f ON s.CDSCode = f.CDSCode
WHERE s.DOC = 31
GROUP BY s.School
ORDER BY TotalEnrollment DESC
LIMIT 1;
```
-------------------------9475 sample_num
```sql
SELECT COUNT(*) / 12 AS Monthly_Average_Schools_Opened
FROM schools
WHERE County = 'Alameda'
  AND DOC = 52
  AND YEAR(OpenDate) = 1980;
```
-------------------------9476 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM schools WHERE County = 'Orange' AND DOC = 54) AS Unified_School_District_Count,
    (SELECT COUNT(*) FROM schools WHERE County = 'Orange' AND DOC = 52) AS Elementary_School_District_Count,
    (SELECT COUNT(*) FROM schools WHERE County = 'Orange' AND DOC = 54) * 1.0 / NULLIF((SELECT COUNT(*) FROM schools WHERE County = 'Orange' AND DOC = 52), 0) AS Ratio
```
-------------------------9477 sample_num
```sql
SELECT County, School, ClosedDate
FROM schools
WHERE StatusType = 'Closed'
ORDER BY County
GROUP BY County
HAVING COUNT(*) = (
    SELECT MAX(closed_count)
    FROM (
        SELECT COUNT(*) AS closed_count
        FROM schools
        WHERE StatusType = 'Closed'
        GROUP BY County
    ) AS county_closed_counts
);
```
-------------------------9478 sample_num
```sql
SELECT s.Street, s.City, s.Zip, s.State, s.School
FROM satscores ss
JOIN schools s ON ss.cds = s.CDSCode
ORDER BY ss.AvgScrMath DESC
LIMIT 1 OFFSET 5;
```
-------------------------9479 sample_num
```sql
SELECT s.MailStreet, s.School
FROM satscores sat
JOIN schools s ON sat.cds = s.CDSCode
WHERE sat.AvgScrRead = (SELECT MIN(AvgScrRead) FROM satscores)
```
-------------------------9480 sample_num
```sql
SELECT COUNT(*) 
FROM schools s 
JOIN satscores sa ON s.CDSCode = sa.cds 
WHERE (sa.AvgScrRead + sa.AvgScrMath + sa.AvgScrWrite) >= 1500 
AND s.MailCity = 'Lakeport';
```
-------------------------9481 sample_num
```sql
SELECT SUM(s.NumTstTakr) AS TotalTestTakers
FROM satscores s
JOIN schools sch ON s.cds = sch.CDSCode
WHERE sch.MailCity = 'Fresno';
```
-------------------------9482 sample_num
```sql
SELECT s.School, s.MailZip
FROM schools s
WHERE (s.AdmFName1 = 'Avetik' AND s.AdmLName1 = 'Atoian')
   OR (s.AdmFName2 = 'Avetik' AND s.AdmLName2 = 'Atoian')
   OR (s.AdmFName3 = 'Avetik' AND s.AdmLName3 = 'Atoian');
```
-------------------------9483 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM schools WHERE County = 'Colusa' AND MailState = 'CA') * 1.0 / 
    (SELECT COUNT(*) FROM schools WHERE County = 'Humboldt' AND MailState = 'CA') AS ratio
```
-------------------------9484 sample_num
```sql
SELECT COUNT(*) 
FROM schools 
WHERE State = 'CA' AND StatusType = 'Active' AND County = 'San Joaquin';
```
-------------------------9485 sample_num
```sql
SELECT s.Phone, s.Ext
FROM satscores ss
JOIN schools s ON ss.cds = s.CDSCode
ORDER BY ss.AvgScrWrite DESC
LIMIT 1 OFFSET 332;
```
-------------------------9486 sample_num
```sql
SELECT School, Phone, Ext 
FROM schools 
WHERE MailZip = '95203-3704';
```
-------------------------9487 sample_num
```sql
SELECT s.Website 
FROM schools s 
WHERE (s.AdmFName1 = 'Mike' AND s.AdmLName1 = 'Larson') 
   OR (s.AdmFName1 = 'Dante' AND s.AdmLName1 = 'Alvarez');
```
-------------------------9488 sample_num
```sql
SELECT Website 
FROM schools 
WHERE Virtual = 'P' AND Charter = 1 AND County = 'San Joaquin';
```
-------------------------9489 sample_num
```sql
SELECT COUNT(*) 
FROM schools 
WHERE City = 'Hickman' AND DOC = 52 AND Charter = 1;
```
-------------------------9490 sample_num
```sql
SELECT COUNT(*) 
FROM frpm 
WHERE County Name = 'Los Angeles' 
  AND Charter School (Y/N) = 'N' 
  AND (Free Meal Count (K-12) * 100.0 / Enrollment (K-12)) < 0.18;
```
-------------------------9491 sample_num
```sql
SELECT s.School, s.City, 
       CONCAT(s.AdmFName1, ' ', s.AdmLName1) AS Administrator1,
       CONCAT(s.AdmFName2, ' ', s.AdmLName2) AS Administrator2,
       CONCAT(s.AdmFName3, ' ', s.AdmLName3) AS Administrator3
FROM schools s
WHERE s.Charter = 1 AND s.CharterNum = '00D2';
```
-------------------------9492 sample_num
```sql
SELECT COUNT(*) 
FROM schools 
WHERE MailCity = 'Hickman' AND CharterNum = '00D4';
```
-------------------------9493 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN FundingType = 'Locally Funded' THEN 1 END) * 100.0 / COUNT(*)) AS RatioPercentage
FROM 
    schools
WHERE 
    County = 'Santa Clara';
```
-------------------------9494 sample_num
```sql
SELECT COUNT(*) 
FROM schools 
WHERE FundingType = 'Directly Funded' 
AND County = 'Stanislaus' 
AND OpenDate BETWEEN '2000-01-01' AND '2005-12-31';
```
-------------------------9495 sample_num
```sql
SELECT COUNT(*) AS TotalClosure
FROM schools
WHERE StatusType = 'Closed' 
  AND OpenDate <= '1989-12-31' 
  AND ClosedDate >= '1989-01-01' 
  AND City = 'San Francisco' 
  AND SchoolType = 'Community College District';
```
-------------------------9496 sample_num
```sql
SELECT County, COUNT(*) AS ClosureCount
FROM schools
WHERE StatusType = 'Closed' 
  AND SOC = 11 
  AND OpenDate BETWEEN '1980-01-01' AND '1989-12-31'
GROUP BY County
ORDER BY ClosureCount DESC
LIMIT 1;
```
-------------------------9497 sample_num
```sql
SELECT NCESDist 
FROM schools 
WHERE SOC = 31;
```
-------------------------9498 sample_num
```sql
SELECT StatusType, COUNT(*) AS SchoolCount
FROM schools
WHERE County = 'Alpine' AND StatusType IN ('Active', 'Closed') AND SchoolType = 'District Community Day School'
GROUP BY StatusType;
```
-------------------------9499 sample_num
```sql
SELECT District_Code 
FROM schools 
WHERE City = 'Fresno' AND Magnet = 0;
```
-------------------------9500 sample_num
```sql
SELECT SUM(f.Enrollment_Ages_5_17) AS Total_Enrollment
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE s.School = 'State Special School'
  AND s.City = 'Fremont'
  AND f.Academic_Year = '2014-2015';
```
-------------------------9501 sample_num
```sql
SELECT f."FRPM Count (Ages 5-17)"
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE s.School = 'Youth Authority School' AND s.MailStreet = 'PO Box 1040';
```
-------------------------9502 sample_num
```sql
SELECT Low_Grade 
FROM frpm 
JOIN schools ON frpm.CDSCode = schools.CDSCode 
WHERE schools.NCESDist = '613360' AND frpm.Educational_Option_Type = 'SPECON';
```
-------------------------9503 sample_num
```sql
SELECT s.School
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE f.NSLP_Provision_Status = 'Breakfast Provision 2' AND f.County_Code = 37;
```
-------------------------9504 sample_num
```sql
SELECT s.City
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE f.County Name = 'Merced'
  AND f.Low Grade = 9
  AND f.High Grade = 12
  AND f.NSLP Provision Status = '2'
  AND f.EILCode = 'HS';
```
-------------------------9505 sample_num
```sql
SELECT s.School, 
       (f."Free Meal Count (Ages 5-17)"::float / f."Enrollment (Ages 5-17)" * 100) AS "Percent (%) Eligible FRPM (Ages 5-17)"
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE f.LowGrade = 'K' 
  AND f.HighGrade = '9' 
  AND f.County Name = 'Los Angeles';
```
-------------------------9506 sample_num
```sql
SELECT "School Type", COUNT(*) AS count
FROM schools
WHERE City = 'Adelanto'
GROUP BY "School Type"
ORDER BY count DESC
LIMIT 1;
```
-------------------------9507 sample_num
```sql
SELECT County, COUNT(*) AS SchoolCount
FROM schools
WHERE Virtual = 'F' AND County IN ('San Diego', 'Santa Barbara')
GROUP BY County
ORDER BY SchoolCount DESC
LIMIT 1;
```
-------------------------9508 sample_num
```sql
SELECT School, Latitude, School_Type
FROM schools
WHERE Latitude = (SELECT MAX(Latitude) FROM schools);
```
-------------------------9509 sample_num
```sql
SELECT s.City, s.LowGrade, s.School
FROM schools s
WHERE s.State = 'CA'
ORDER BY s.Latitude ASC
LIMIT 1;
```
-------------------------9510 sample_num
```sql
SELECT Low_Grade, High_Grade 
FROM schools 
WHERE Longitude = (SELECT MAX(Longitude) FROM schools);
```
-------------------------9511 sample_num
```sql
SELECT 
    s.City, 
    COUNT(s.School) AS SchoolCount
FROM 
    schools s
WHERE 
    s.GSserved = 'K-8' 
    AND s.Magnet = 1
GROUP BY 
    s.City;
```
-------------------------9512 sample_num
```sql
SELECT AdmFName1 AS FirstName, District, COUNT(*) AS NameCount
FROM schools
GROUP BY AdmFName1, District
ORDER BY NameCount DESC
LIMIT 2;
```
-------------------------9513 sample_num
```sql
SELECT f."District Code"
FROM frpm f
JOIN schools s ON f.CDSCode = s.CDSCode
WHERE s.AdmFName1 = 'Alusine';
```
-------------------------9514 sample_num
```sql
SELECT s.AdmLName1, s.District, s.County, s.School
FROM schools s
WHERE s.CharterNum = 40;
```
-------------------------9515 sample_num
```sql
SELECT AdmEmail1 
FROM schools 
WHERE County = 'San Bernardino' 
  AND District = 'San Bernardino City Unified' 
  AND OpenDate BETWEEN '2009-01-01' AND '2010-12-31' 
  AND (SOC = 62 OR DOC = 54);
```
-------------------------9516 sample_num
```sql
SELECT s.AdmEmail1, s.School
FROM satscores ss
JOIN schools s ON ss.cds = s.CDSCode
WHERE ss.NumGE1500 > 0
ORDER BY ss.NumTstTakr DESC
LIMIT 1;
```
-------------------------9517 sample_num
```sql
SELECT COUNT(DISTINCT a.account_id) 
FROM account a
JOIN trans t ON a.account_id = t.account_id
JOIN district d ON a.district_id = d.district_id
JOIN card c ON a.account_id = c.account_id
WHERE d.A3 = 'East Bohemia' 
AND c.type = 'POPLATEK PO OBRATU';
```
-------------------------9518 sample_num
```sql
SELECT COUNT(DISTINCT a.account_id) 
FROM account a
JOIN district d ON a.district_id = d.district_id
JOIN loan l ON a.account_id = l.account_id
WHERE d.A3 = 'Prague' AND l.status = 'eligible';
```
-------------------------9519 sample_num
```sql
SELECT 
    CASE 
        WHEN AVG(A12) > AVG(A13) THEN '1995 has a higher unemployment ratio'
        WHEN AVG(A12) < AVG(A13) THEN '1996 has a higher unemployment ratio'
        ELSE 'Both years have the same unemployment ratio'
    END AS result
FROM district;
```
-------------------------9520 sample_num
```sql
SELECT COUNT(DISTINCT district_id) AS num_districts
FROM client
JOIN district ON client.district_id = district.district_id
WHERE gender = 'F' AND A11 > 6000 AND A11 < 10000;
```
-------------------------9521 sample_num
```sql
SELECT COUNT(*) 
FROM client c 
JOIN district d ON c.district_id = d.district_id 
WHERE c.gender = 'M' AND d.A3 = 'North Bohemia' AND d.A11 > 8000;
```
-------------------------9522 sample_num
```sql
WITH SalaryStats AS (
    SELECT 
        c.client_id,
        a.account_id,
        c.gender,
        c.birth_date,
        d.A11 AS average_salary
    FROM 
        client c
    JOIN 
        disp d ON c.client_id = d.client_id
    JOIN 
        account a ON d.account_id = a.account_id
    WHERE 
        c.gender = 'F'
),
OldestLowest AS (
    SELECT 
        account_id,
        MIN(average_salary) AS lowest_average_salary
    FROM 
        SalaryStats
    WHERE 
        birth_date = (SELECT MAX(birth_date) FROM SalaryStats)
    GROUP BY 
        account_id
),
HighestSalary AS (
    SELECT 
        MAX(average_salary) AS highest_average_salary
    FROM 
        SalaryStats
)
SELECT 
    o.account_id,
    (h.highest_average_salary - o.lowest_average_salary) AS salary_gap
FROM 
    OldestLowest o, HighestSalary h;
```
-------------------------9523 sample_num
```sql
SELECT c.client_id, a.account_id
FROM client c
JOIN district d ON c.district_id = d.district_id
JOIN account a ON a.account_id = (SELECT account_id FROM disp WHERE client_id = c.client_id)
WHERE d.A11 = (SELECT MAX(A11) FROM district)
ORDER BY c.birth_date DESC
LIMIT 1;
```
-------------------------9524 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id) AS owner_count
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN card ca ON d.disp_id = ca.disp_id
WHERE ca.type = 'POPLATEK TYDNE' AND c.gender = 'Owner';
```
-------------------------9525 sample_num
```sql
SELECT DISTINCT c.client_id
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN card ca ON d.disp_id = ca.disp_id
JOIN trans t ON d.account_id = t.account_id
WHERE ca.type = 'POPLATEK PO OBRATU' AND t.type = 'Disponent';
```
-------------------------9526 sample_num
```sql
SELECT a.account_id, l.amount
FROM loan l
JOIN account a ON l.account_id = a.account_id
WHERE l.status = 'approved' AND YEAR(l.date) = 1997
ORDER BY l.amount ASC
LIMIT 1;
```
-------------------------9527 sample_num
```sql
SELECT a.account_id, l.amount
FROM account a
JOIN loan l ON a.account_id = l.account_id
WHERE l.duration > 12 AND YEAR(a.date) = 1993
ORDER BY l.amount DESC
LIMIT 1;
```
-------------------------9528 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id) AS female_customers
FROM client c
JOIN district d ON c.district_id = d.district_id
JOIN account a ON c.client_id = (SELECT disp.client_id FROM disp disp WHERE disp.account_id = a.account_id)
WHERE c.gender = 'F' 
  AND c.birth_date < '1950-01-01' 
  AND d.A2 = 'Slokolov';
```
-------------------------9529 sample_num
```sql
SELECT account_id 
FROM trans 
WHERE YEAR(date) = 1995 
ORDER BY date ASC 
LIMIT 1;
```
-------------------------9530 sample_num
```sql
SELECT DISTINCT a.account_id
FROM account a
JOIN loan l ON a.account_id = l.account_id
WHERE a.date < '1997-01-01' AND l.amount > 3000;
```
-------------------------9531 sample_num
```sql
SELECT c.client_id 
FROM client c 
JOIN disp d ON c.client_id = d.client_id 
JOIN card ca ON d.disp_id = ca.disp_id 
WHERE ca.issued = '1994-03-03';
```
-------------------------9532 sample_num
```sql
SELECT date FROM account WHERE account_id = (
    SELECT account_id FROM trans WHERE amount = 840 AND date = '1998-10-14'
);
```
-------------------------9533 sample_num
```sql
SELECT a.district_id
FROM loan l
JOIN account a ON l.account_id = a.account_id
WHERE l.date = '1994-08-25' AND l.status = 'approved';
```
-------------------------9534 sample_num
```sql
SELECT MAX(t.amount) AS biggest_transaction
FROM trans t
JOIN card c ON t.account_id = c.account_id
JOIN disp d ON c.disp_id = d.disp_id
JOIN client cl ON d.client_id = cl.client_id
WHERE c.issued = '1996-10-21';
```
-------------------------9535 sample_num
```sql
SELECT c.gender
FROM client c
JOIN account a ON c.client_id = a.account_id
JOIN district d ON c.district_id = d.district_id
WHERE c.birth_date = (
    SELECT MIN(birth_date)
    FROM client c2
    JOIN account a2 ON c2.client_id = a2.account_id
    JOIN district d2 ON c2.district_id = d2.district_id
    WHERE d2.A11 = (
        SELECT MAX(A11)
        FROM district
    )
)
```
-------------------------9536 sample_num
```sql
SELECT t.amount
FROM trans t
JOIN account a ON t.account_id = a.account_id
JOIN loan l ON a.account_id = l.account_id
WHERE l.amount = (
    SELECT MAX(amount)
    FROM loan
)
AND t.date = (
    SELECT MIN(date)
    FROM trans
    WHERE account_id = a.account_id
);
```
-------------------------9537 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id) AS female_clients
FROM client c
JOIN district d ON c.district_id = d.district_id
JOIN account a ON c.client_id = a.account_id
WHERE d.A2 = 'Jesenik' AND c.gender = 'F';
```
-------------------------9538 sample_num
```sql
SELECT d.disp_id
FROM trans t
JOIN disp d ON t.account_id = d.account_id
WHERE t.amount = 5100 AND t.date = '1998-09-02';
```
-------------------------9539 sample_num
```sql
SELECT COUNT(*) 
FROM account a 
JOIN district d ON a.district_id = d.district_id 
WHERE d.A2 = 'Litomerice' AND YEAR(a.date) = 1996;
```
-------------------------9540 sample_num
```sql
SELECT d.A2 
FROM client c 
JOIN account a ON c.district_id = a.district_id 
JOIN district d ON c.district_id = d.district_id 
WHERE c.gender = 'F' AND c.birth_date = '1976-01-29';
```
-------------------------9541 sample_num
```sql
SELECT c.birth_date
FROM client c
JOIN loan l ON c.client_id = (SELECT d.client_id FROM disp d WHERE d.account_id = l.account_id)
WHERE l.amount = 98832 AND l.date = '1996-01-03';
```
-------------------------9542 sample_num
```sql
SELECT a.account_id
FROM account a
JOIN client c ON a.district_id = c.district_id
JOIN district d ON c.district_id = d.district_id
WHERE d.A3 = 'Prague'
ORDER BY a.date
LIMIT 1;
```
-------------------------9543 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.gender = 'M' THEN 1 END) * 100.0 / COUNT(c.client_id)) AS male_percentage
FROM 
    client c
JOIN 
    district d ON c.district_id = d.district_id
WHERE 
    d.A3 = 'South Bohemia'
    AND d.A4 = (SELECT MAX(A4) FROM district WHERE A3 = 'South Bohemia');
```
-------------------------9544 sample_num
```sql
SELECT 
    ((final_balance.balance - initial_balance.balance) / initial_balance.balance) * 100 AS increase_rate
FROM 
    (SELECT 
        t.balance 
     FROM 
        loan l 
     JOIN 
        account a ON l.account_id = a.account_id 
     JOIN 
        trans t ON a.account_id = t.account_id 
     WHERE 
        l.date = '1993-07-05' 
        AND t.date = '1993-03-22') AS initial_balance,
    (SELECT 
        t.balance 
     FROM 
        loan l 
     JOIN 
        account a ON l.account_id = a.account_id 
     JOIN 
        trans t ON a.account_id = t.account_id 
     WHERE 
        l.date = '1993-07-05' 
        AND t.date = '1998-12-27') AS final_balance;
```
-------------------------9545 sample_num
```sql
SELECT 
    (SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) / SUM(amount)) * 100 AS percentage_paid
FROM 
    loan;
```
-------------------------9546 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN l.status = 'C' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_running_accounts
FROM 
    loan l
WHERE 
    l.amount < 100000;
```
-------------------------9547 sample_num
```sql
SELECT a.account_id, d.A2 AS district_name, d.A3 AS district_region
FROM account a
JOIN district d ON a.district_id = d.district_id
JOIN trans t ON a.account_id = t.account_id
JOIN card c ON c.disp_id = t.trans_id
WHERE YEAR(a.date) = 1993 
AND c.type = 'POPLATEK PO OBRATU' 
AND c.issued > t.date;
```
-------------------------9548 sample_num
```sql
SELECT a.account_id, a.frequency
FROM account a
JOIN district d ON a.district_id = d.district_id
JOIN disp disp ON a.account_id = disp.account_id
JOIN client c ON disp.client_id = c.client_id
WHERE d.A2 = 'east Bohemia' 
AND a.date BETWEEN '1995-01-01' AND '2000-12-31';
```
-------------------------9549 sample_num
```sql
SELECT a.account_id, a.date
FROM account a
JOIN district d ON a.district_id = d.district_id
WHERE d.A2 = 'Prachatice';
```
-------------------------9550 sample_num
```sql
SELECT d.A2 AS district, d.A3 AS region
FROM loan l
JOIN account a ON l.account_id = a.account_id
JOIN client c ON a.district_id = c.district_id
JOIN district d ON c.district_id = d.district_id
WHERE l.loan_id = '4990';
```
-------------------------9551 sample_num
```sql
SELECT a.account_id, d.A2 AS district, d.A3 AS region
FROM loan l
JOIN account a ON l.account_id = a.account_id
JOIN district d ON a.district_id = d.district_id
WHERE l.amount > 300000;
```
-------------------------9552 sample_num
```sql
SELECT l.loan_id, d.A3 AS district, d.A11 AS average_salary
FROM loan l
JOIN account a ON l.account_id = a.account_id
JOIN district d ON a.district_id = d.district_id
WHERE l.duration = 60;
```
-------------------------9553 sample_num
```sql
SELECT d.district_id, 
       ((d.A13 - d.A12) / d.A12) * 100 AS unemployment_increment_rate
FROM loan l
JOIN account a ON l.account_id = a.account_id
JOIN disp di ON a.account_id = di.account_id
JOIN client c ON di.client_id = c.client_id
JOIN district d ON c.district_id = d.district_id
WHERE l.status = 'D';
```
-------------------------9554 sample_num
```sql
SELECT 
    (COUNT(a.account_id) * 100.0 / (SELECT COUNT(*) FROM account WHERE YEAR(date) = 1993)) AS percentage
FROM 
    account a
JOIN 
    district d ON a.district_id = d.district_id
WHERE 
    d.A2 = 'Decin' AND YEAR(a.date) = 1993;
```
-------------------------9555 sample_num
```sql
SELECT DISTINCT account_id 
FROM account 
WHERE frequency = 'POPLATEK MESICNE';
```
-------------------------9556 sample_num
```sql
SELECT d.A2 AS district, COUNT(DISTINCT c.client_id) AS female_account_holders
FROM district d
JOIN client c ON d.district_id = c.district_id
JOIN disp di ON c.client_id = di.client_id
JOIN account a ON di.account_id = a.account_id
WHERE c.gender = 'F'
GROUP BY d.A2
ORDER BY female_account_holders DESC
LIMIT 10;
```
-------------------------9557 sample_num
```sql
SELECT d.A2 AS district_name, SUM(t.amount) AS total_withdrawals
FROM trans t
JOIN account a ON t.account_id = a.account_id
JOIN district d ON a.district_id = d.district_id
WHERE t.type = 'VYDAJ' AND t.date LIKE '1996-01%'
GROUP BY d.A2
ORDER BY total_withdrawals DESC
LIMIT 10;
```
-------------------------9558 sample_num
```sql
SELECT COUNT(DISTINCT a.account_id) AS no_credit_card_count
FROM account a
JOIN client c ON a.district_id = c.district_id
JOIN district d ON c.district_id = d.district_id
LEFT JOIN card ca ON a.account_id = ca.account_id
WHERE d.A3 = 'South Bohemia' AND ca.card_id IS NULL;
```
-------------------------9559 sample_num
```sql
SELECT d.A3 AS district_name, COUNT(l.loan_id) AS active_loans
FROM loan l
JOIN account a ON l.account_id = a.account_id
JOIN district d ON a.district_id = d.district_id
WHERE l.status IN ('C', 'D')
GROUP BY d.A3
ORDER BY active_loans DESC
LIMIT 1;
```
-------------------------9560 sample_num
```sql
SELECT AVG(loan.amount) AS average_loan_amount
FROM loan
JOIN account ON loan.account_id = account.account_id
JOIN client ON account.district_id = client.district_id
WHERE client.gender = 'M';
```
-------------------------9561 sample_num
```sql
SELECT A2 AS district_name, A13 AS unemployment_rate
FROM district
WHERE A13 IS NOT NULL
ORDER BY A13 DESC
LIMIT 1;
```
-------------------------9562 sample_num
```sql
SELECT COUNT(a.account_id) AS accounts_opened
FROM account a
JOIN district d ON a.district_id = d.district_id
WHERE d.A16 = (SELECT MAX(A16) FROM district)
```
-------------------------9563 sample_num
```sql
SELECT COUNT(DISTINCT a.account_id) AS negative_balance_accounts
FROM account a
JOIN trans t ON a.account_id = t.account_id
WHERE t.balance < 0
  AND t.operation = 'VYBER KARTOU'
  AND a.frequency = 'POPLATEK MESICNE';
```
-------------------------9564 sample_num
```sql
SELECT COUNT(*) 
FROM loan l
JOIN account a ON l.account_id = a.account_id
WHERE l.date BETWEEN '1995-01-01' AND '1997-12-31' 
  AND l.amount >= 250000 
  AND a.frequency = 'POPLATEK MESICNE' 
  AND l.status = 'approved';
```
-------------------------9565 sample_num
```sql
SELECT COUNT(DISTINCT a.account_id) 
FROM account a
JOIN loan l ON a.account_id = l.account_id
JOIN district d ON a.district_id = d.district_id
WHERE d.A2 = 'Branch location 1' AND (l.status = 'C' OR l.status = 'D');
```
-------------------------9566 sample_num
```sql
SELECT COUNT(*) AS male_client_count
FROM client
WHERE district_id = (
    SELECT district_id
    FROM district
    ORDER BY A15 DESC
    LIMIT 1 OFFSET 1
) AND gender = 'M';
```
-------------------------9567 sample_num
```sql
SELECT COUNT(*) 
FROM card 
WHERE type = 'gold' AND disp_id IN (SELECT disp_id FROM disp WHERE type = 'disponent');
```
-------------------------9568 sample_num
```sql
SELECT COUNT(*) 
FROM account a 
JOIN district d ON a.district_id = d.district_id 
WHERE d.A2 = 'Pisek';
```
-------------------------9569 sample_num
```sql
SELECT DISTINCT d.district_id
FROM district d
JOIN account a ON d.district_id = a.district_id
JOIN trans t ON a.account_id = t.account_id
WHERE t.amount > 10000 AND YEAR(t.date) = 1997;
```
-------------------------9570 sample_num
```sql
SELECT DISTINCT a.account_id
FROM account a
JOIN order o ON a.account_id = o.account_id
JOIN district d ON a.district_id = d.district_id
WHERE o.k_symbol = 'SIPO' AND d.A2 = 'Pisek';
```
-------------------------9571 sample_num
```sql
SELECT DISTINCT a.account_id
FROM account a
JOIN disp d ON a.account_id = d.account_id
JOIN card c ON d.disp_id = c.disp_id
WHERE c.type IN ('gold', 'junior')
GROUP BY a.account_id
HAVING COUNT(DISTINCT c.type) = 2;
```
-------------------------9572 sample_num
```sql
SELECT AVG(amount) AS average_credit_card_withdrawal
FROM trans
WHERE operation = 'VYBER KARTOU'
  AND YEAR(date) = 2021
GROUP BY MONTH(date);
```
-------------------------9573 sample_num
```sql
SELECT DISTINCT c.client_id
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN card ca ON d.disp_id = ca.disp_id
JOIN trans t ON ca.card_id = t.account_id
WHERE t.operation = 'VYBER KARTOU'
  AND YEAR(t.date) = 1998
GROUP BY c.client_id, MONTH(t.date)
HAVING SUM(t.amount) < (SELECT AVG(monthly_spent) 
                         FROM (SELECT SUM(t2.amount) AS monthly_spent
                               FROM trans t2
                               JOIN card ca2 ON t2.account_id = ca2.card_id
                               JOIN disp d2 ON ca2.disp_id = d2.disp_id
                               JOIN client c2 ON d2.client_id = c2.client_id
                               WHERE t2.operation = 'VYBER KARTOU'
                                 AND YEAR(t2.date) = 1998
                               GROUP BY MONTH(t2.date)) AS avg_spent);
```
-------------------------9574 sample_num
```sql
SELECT DISTINCT c.client_id
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN card ca ON d.disp_id = ca.disp_id
JOIN loan l ON d.account_id = l.account_id
WHERE c.gender = 'F';
```
-------------------------9575 sample_num
```sql
SELECT COUNT(DISTINCT a.account_id) 
FROM account a
JOIN client c ON a.district_id = c.district_id
JOIN district d ON c.district_id = d.district_id
WHERE c.gender = 'F' AND d.A3 = 'south Bohemia';
```
-------------------------9576 sample_num
```sql
SELECT a.account_id
FROM account a
JOIN district d ON a.district_id = d.district_id
JOIN disp di ON a.account_id = di.account_id
WHERE d.A2 = 'Tabor' AND di.type = 'OWNER';
```
-------------------------9577 sample_num
```sql
SELECT DISTINCT a.frequency
FROM account a
JOIN district d ON a.district_id = d.district_id
WHERE d.A11 > 8000 AND d.A11 <= 9000 AND a.frequency <> 'OWNER';
```
-------------------------9578 sample_num
```sql
SELECT COUNT(DISTINCT a.account_id) 
FROM account a
JOIN district d ON a.district_id = d.district_id
JOIN trans t ON a.account_id = t.account_id
WHERE d.A3 = 'North Bohemia' AND t.bank = 'AB';
```
-------------------------9579 sample_num
```sql
SELECT DISTINCT d.A2
FROM district d
JOIN account a ON d.district_id = a.district_id
JOIN trans t ON a.account_id = t.account_id
WHERE t.type = 'VYDAJ';
```
-------------------------9580 sample_num
```sql
SELECT AVG(d.A15) AS average_crimes
FROM district d
JOIN account a ON d.district_id = a.district_id
WHERE d.A15 > 4000 AND a.date >= '1997-01-01'
AND a.date < '1998-01-01';
```
-------------------------9581 sample_num
```sql
SELECT COUNT(DISTINCT c.card_id) AS classic_card_eligible_for_loan
FROM card c
JOIN disp d ON c.disp_id = d.disp_id
JOIN account a ON d.account_id = a.account_id
JOIN loan l ON a.account_id = l.account_id
WHERE c.type = 'classic' AND a.frequency = 'OWNER';
```
-------------------------9582 sample_num
```sql
SELECT COUNT(*) 
FROM client c 
JOIN district d ON c.district_id = d.district_id 
WHERE d.A2 = 'Hl.m. Praha' AND c.gender = 'M';
```
-------------------------9583 sample_num
```sql
SELECT (COUNT(CASE WHEN type = 'gold' AND issued < '1998-01-01' THEN 1 END) * 100.0) / COUNT(*) AS percent_gold
FROM card;
```
-------------------------9584 sample_num
```sql
SELECT c.client_id
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN account a ON d.account_id = a.account_id
JOIN loan l ON a.account_id = l.account_id
WHERE l.amount = (SELECT MAX(amount) FROM loan);
```
-------------------------9585 sample_num
```sql
SELECT A15 
FROM district 
WHERE district_id = (SELECT district_id FROM account WHERE account_id = 532);
```
-------------------------9586 sample_num
```sql
SELECT d.district_id 
FROM order o 
JOIN account a ON o.account_id = a.account_id 
JOIN district d ON a.district_id = d.district_id 
WHERE o.order_id = 33333;
```
-------------------------9587 sample_num
```sql
SELECT * 
FROM trans 
WHERE operation = 'VYBER' 
AND account_id IN (SELECT account_id FROM disp WHERE client_id = 3356);
```
-------------------------9588 sample_num
```sql
SELECT COUNT(DISTINCT a.account_id) AS weekly_loan_accounts
FROM account a
JOIN loan l ON a.account_id = l.account_id
WHERE a.frequency = 'POPLATEK TYDNE' AND l.amount < 200000;
```
-------------------------9589 sample_num
```sql
SELECT c.type 
FROM client cl 
JOIN disp d ON cl.client_id = d.client_id 
JOIN card c ON d.disp_id = c.disp_id 
WHERE cl.client_id = 13539;
```
-------------------------9590 sample_num
```sql
SELECT d.A3 
FROM client c 
JOIN district d ON c.district_id = d.district_id 
WHERE c.client_id = 3541;
```
-------------------------9591 sample_num
```sql
SELECT d.district_id, COUNT(a.account_id) AS account_count
FROM district d
JOIN account a ON d.district_id = a.district_id
JOIN loan l ON a.account_id = l.account_id
WHERE l.status = 'A'
GROUP BY d.district_id
ORDER BY account_count DESC
LIMIT 1;
```
-------------------------9592 sample_num
```sql
SELECT c.client_id
FROM order o
JOIN account a ON o.account_id = a.account_id
JOIN disp d ON a.account_id = d.account_id
JOIN client c ON d.client_id = c.client_id
WHERE o.order_id = 32423;
```
-------------------------9593 sample_num
```sql
SELECT * 
FROM trans 
WHERE account_id IN (SELECT account_id FROM account WHERE district_id = 5);
```
-------------------------9594 sample_num
```sql
SELECT COUNT(*) 
FROM account 
WHERE district_id = (SELECT district_id FROM district WHERE A2 = 'Jesenik');
```
-------------------------9595 sample_num
```sql
SELECT DISTINCT c.client_id
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN card ca ON d.disp_id = ca.disp_id
WHERE ca.type = 'junior' AND ca.issued >= '1997-01-01';
```
-------------------------9596 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.gender = 'F' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_women
FROM 
    client c
JOIN 
    district d ON c.district_id = d.district_id
JOIN 
    account a ON c.client_id = a.client_id
WHERE 
    d.A11 > 10000;
```
-------------------------9597 sample_num
```sql
SELECT 
    (SUM(CASE WHEN YEAR(l.date) = 1997 THEN l.amount ELSE 0 END) - 
     SUM(CASE WHEN YEAR(l.date) = 1996 THEN l.amount ELSE 0 END)) / 
     NULLIF(SUM(CASE WHEN YEAR(l.date) = 1996 THEN l.amount ELSE 0 END), 0) * 100 AS growth_rate
FROM 
    loan l
JOIN 
    account a ON l.account_id = a.account_id
JOIN 
    disp d ON a.account_id = d.account_id
JOIN 
    client c ON d.client_id = c.client_id
WHERE 
    c.gender = 'M' AND 
    YEAR(l.date) IN (1996, 1997);
```
-------------------------9598 sample_num
```sql
SELECT COUNT(*) 
FROM trans 
WHERE operation = 'VYBER KARTOU' AND date > '1995-12-31';
```
-------------------------9599 sample_num
```sql
SELECT 
    (SUM(CASE WHEN d.A3 = 'North Bohemia' THEN d.A16 ELSE 0 END) -
     SUM(CASE WHEN d.A3 = 'East Bohemia' THEN d.A16 ELSE 0 END)) AS crime_difference
FROM 
    district d
WHERE 
    d.A16 IS NOT NULL;
```
-------------------------9600 sample_num
```sql
SELECT 
    COUNT(CASE WHEN type = 'owner' THEN 1 END) AS owner_count,
    COUNT(CASE WHEN type = 'disponent' THEN 1 END) AS disponent_count
FROM 
    disp 
WHERE 
    account_id BETWEEN 1 AND 10;
```
-------------------------9601 sample_num
```sql
SELECT 
    COUNT(*) AS statement_requests 
FROM 
    trans 
WHERE 
    account_id = 3 
    AND type = 'statement';

SELECT 
    k_symbol, 
    SUM(amount) AS total_debit 
FROM 
    trans 
WHERE 
    account_id = 3539 
GROUP BY 
    k_symbol;
```
-------------------------9602 sample_num
```sql
SELECT birth_date 
FROM client 
WHERE client_id = (SELECT client_id 
                   FROM disp 
                   WHERE account_id = 130);
```
-------------------------9603 sample_num
```sql
SELECT COUNT(DISTINCT a.account_id) AS account_count
FROM account a
JOIN disp d ON a.account_id = d.account_id
WHERE d.type = 'owner' AND a.frequency = 'POPLATEK PO OBRATU';
```
-------------------------9604 sample_num
```sql
SELECT 
    SUM(loan.amount) AS total_debt,
    SUM(CASE WHEN loan.status = 'paid' THEN loan.payments ELSE 0 END) AS total_paid,
    SUM(CASE WHEN loan.status = 'unpaid' THEN loan.payments ELSE 0 END) AS total_unpaid
FROM 
    client
JOIN 
    disp ON client.client_id = disp.client_id
JOIN 
    account ON disp.account_id = account.account_id
JOIN 
    loan ON account.account_id = loan.account_id
WHERE 
    client.client_id = 992;
```
-------------------------9605 sample_num
```sql
SELECT 
    SUM(t.amount) AS total_amount,
    c.gender
FROM 
    trans t
JOIN 
    account a ON t.account_id = a.account_id
JOIN 
    disp d ON a.account_id = d.account_id
JOIN 
    client c ON d.client_id = c.client_id
WHERE 
    c.client_id = 4 AND 
    t.trans_id = 851
GROUP BY 
    c.gender;
```
-------------------------9606 sample_num
```sql
SELECT c.type 
FROM card c 
JOIN disp d ON c.disp_id = d.disp_id 
WHERE d.client_id = 9;
```
-------------------------9607 sample_num
```sql
SELECT SUM(t.amount) AS total_paid
FROM trans t
JOIN account a ON t.account_id = a.account_id
JOIN disp d ON a.account_id = d.account_id
WHERE d.client_id = 617 AND YEAR(t.date) = 1998;
```
-------------------------9608 sample_num
```sql
SELECT c.client_id
FROM client c
JOIN district d ON c.district_id = d.district_id
JOIN account a ON a.district_id = d.district_id
WHERE c.birth_date BETWEEN '1983-01-01' AND '1987-12-31'
AND d.A2 = 'East Bohemia';
```
-------------------------9609 sample_num
```sql
SELECT c.client_id
FROM client c
JOIN loan l ON c.client_id = l.account_id
WHERE c.gender = 'F'
ORDER BY l.amount DESC
LIMIT 3;
```
-------------------------9610 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id) 
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN loan l ON d.account_id = l.account_id
JOIN trans t ON l.account_id = t.account_id
WHERE c.gender = 'M' 
  AND c.birth_date BETWEEN '1974-01-01' AND '1976-12-31' 
  AND t.type = 'SIPO' 
  AND t.amount > 4000;
```
-------------------------9611 sample_num
```sql
SELECT COUNT(*) 
FROM account a 
JOIN district d ON a.district_id = d.district_id 
WHERE d.A2 = 'Beroun' AND a.date > '1996-01-01';
```
-------------------------9612 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id) AS female_customers_with_junior_card
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN card ca ON d.disp_id = ca.disp_id
WHERE c.gender = 'F' AND ca.type = 'junior';
```
-------------------------9613 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.gender = 'F' THEN 1 END) * 100.0 / COUNT(*)) AS female_proportion
FROM 
    client c
JOIN 
    district d ON c.district_id = d.district_id
JOIN 
    account a ON c.client_id = (SELECT disp.client_id FROM disp disp WHERE disp.account_id = a.account_id LIMIT 1)
WHERE 
    d.A3 = 'Prague';
```
-------------------------9614 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.gender = 'M' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_male_weekly_statements
FROM 
    client c
JOIN 
    disp d ON c.client_id = d.client_id
JOIN 
    account a ON d.account_id = a.account_id
JOIN 
    trans t ON a.account_id = t.account_id
WHERE 
    t.type = 'POPLATEK TYDNE';
```
-------------------------9615 sample_num
```sql
SELECT COUNT(DISTINCT c.client_id) AS client_count
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN account a ON d.account_id = a.account_id
WHERE a.frequency = 'POPLATEK TYDNE';
```
-------------------------9616 sample_num
```sql
SELECT a.account_id, l.amount
FROM account a
JOIN loan l ON a.account_id = l.account_id
WHERE l.duration > 24 AND a.date < '1997-01-01'
ORDER BY l.amount ASC
LIMIT 1;
```
-------------------------9617 sample_num
```sql
SELECT a.account_id
FROM account a
JOIN client c ON a.district_id = c.district_id
JOIN district d ON c.district_id = d.district_id
WHERE c.gender = 'F'
ORDER BY c.birth_date ASC, d.A11 ASC
LIMIT 1;
```
-------------------------9618 sample_num
```sql
SELECT COUNT(*) 
FROM client c 
JOIN district d ON c.district_id = d.district_id 
WHERE YEAR(c.birth_date) = 1920 AND d.A3 = 'East Bohemia';
```
-------------------------9619 sample_num
```sql
SELECT COUNT(*) 
FROM loan l
JOIN account a ON l.account_id = a.account_id
WHERE l.duration = 24 
AND a.frequency = 'POPLATEK TYDNE';
```
-------------------------9620 sample_num
```sql
SELECT AVG(l.amount) AS average_loan_amount
FROM loan l
JOIN trans t ON l.account_id = t.account_id
WHERE l.status IN ('C', 'D')
AND t.type = 'POPLATEK PO OBRATU';
```
-------------------------9621 sample_num
```sql
SELECT DISTINCT c.client_id, c.district_id
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN account a ON d.account_id = a.account_id
LEFT JOIN loan l ON a.account_id = l.account_id
LEFT JOIN order o ON a.account_id = o.account_id
WHERE l.loan_id IS NULL AND o.order_id IS NULL;
```
-------------------------9622 sample_num
```sql
SELECT c.client_id, 
       FLOOR(DATEDIFF(CURDATE(), c.birth_date) / 365) AS age
FROM client c
JOIN disp d ON c.client_id = d.client_id
JOIN card ca ON d.disp_id = ca.disp_id
JOIN loan l ON d.account_id = l.account_id
WHERE ca.type = 'gold' AND l.status = 'eligible';
```
-------------------------9623 sample_num
```sql
SELECT bond_type
FROM bond
GROUP BY bond_type
ORDER BY COUNT(bond_type) DESC
LIMIT 1;
```
-------------------------9624 sample_num
```sql
SELECT COUNT(DISTINCT a.molecule_id) AS chlorine_molecule_count
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
WHERE m.label = '-' AND a.element = 'cl';
```
-------------------------9625 sample_num
```sql
SELECT AVG(oxygen_count) AS average_oxygen_atoms
FROM (
    SELECT m.molecule_id, COUNT(a.atom_id) AS oxygen_count
    FROM molecule m
    JOIN bond b ON m.molecule_id = b.molecule_id
    JOIN connected c ON b.bond_id = c.bond_id
    JOIN atom a ON c.atom_id = a.atom_id
    WHERE b.bond_type = '-' AND a.element = 'o'
    GROUP BY m.molecule_id
) AS oxygen_counts;
```
-------------------------9626 sample_num
```sql
SELECT AVG(single_bonded_count) AS average_single_bonded_carcinogenic
FROM (
    SELECT m.molecule_id, COUNT(c.atom_id) AS single_bonded_count
    FROM molecule m
    JOIN bond b ON m.molecule_id = b.molecule_id AND b.bond_type = '-'
    JOIN connected c ON b.bond_id = c.bond_id
    WHERE m.label = '+'
    GROUP BY m.molecule_id
) AS subquery;
```
-------------------------9627 sample_num
```sql
SELECT COUNT(*) 
FROM atom a 
JOIN molecule m ON a.molecule_id = m.molecule_id 
WHERE a.element = 'na' AND m.label = '-';
```
-------------------------9628 sample_num
```sql
SELECT DISTINCT m.molecule_id, m.label
FROM molecule m
JOIN bond b ON m.molecule_id = b.molecule_id
WHERE b.bond_type = '#' AND m.label = '+';
```
-------------------------9629 sample_num
```sql
SELECT 
    (SUM(a.element = 'c') / COUNT(a.atom_id)) * 100 AS carbon_percentage
FROM 
    atom a
JOIN 
    bond b ON a.molecule_id = b.molecule_id
WHERE 
    b.bond_type = ' = ';
```
-------------------------9630 sample_num
```sql
SELECT COUNT(*) FROM bond WHERE bond_type = '#';
```
-------------------------9631 sample_num
```sql
SELECT COUNT(*) AS atom_count
FROM atom
WHERE element != 'br';
```
-------------------------9632 sample_num
```sql
SELECT COUNT(*) AS carcinogenic_count
FROM molecule
WHERE molecule_id BETWEEN 'TR000' AND 'TR099' AND label = '+';
```
-------------------------9633 sample_num
```sql
SELECT DISTINCT molecule_id 
FROM atom 
WHERE element = 'si';
```
-------------------------9634 sample_num
```sql
SELECT DISTINCT a.element
FROM atom a
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
JOIN bond b ON c.bond_id = b.bond_id
WHERE b.bond_id = 'TR004_8_9';
```
-------------------------9635 sample_num
```sql
SELECT DISTINCT a.element
FROM atom a
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
JOIN bond b ON c.bond_id = b.bond_id
WHERE b.bond_type = ' = ';
```
-------------------------9636 sample_num
```sql
SELECT label
FROM molecule
WHERE molecule_id IN (
    SELECT DISTINCT molecule_id
    FROM atom
    WHERE element = 'h'
)
GROUP BY label
ORDER BY COUNT(*) DESC
LIMIT 1;
```
-------------------------9637 sample_num
```sql
SELECT b.bond_type 
FROM atom a 
JOIN connected c ON a.atom_id = c.atom_id 
JOIN bond b ON c.bond_id = b.bond_id 
WHERE a.element = 'te';
```
-------------------------9638 sample_num
```sql
SELECT a1.atom_id, a2.atom_id2
FROM connected c
JOIN atom a1 ON c.atom_id = a1.atom_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
JOIN bond b ON c.bond_id = b.bond_id
WHERE b.bond_type = '-';
```
-------------------------9639 sample_num
```sql
SELECT a1.atom_id, a2.atom_id2
FROM connected c
JOIN atom a1 ON c.atom_id = a1.atom_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
JOIN molecule m ON a1.molecule_id = m.molecule_id
WHERE m.label = '-';
```
-------------------------9640 sample_num
```sql
SELECT element, COUNT(*) AS element_count
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
WHERE m.label = '-'
GROUP BY element
ORDER BY element_count ASC
LIMIT 1;
```
-------------------------9641 sample_num
```sql
SELECT b.bond_type 
FROM bond b 
JOIN connected c ON b.bond_id = c.bond_id 
WHERE (c.atom_id = 'TR004_8' AND c.atom_id2 = 'TR004_20') 
   OR (c.atom_id = 'TR004_20' AND c.atom_id2 = 'TR004_8');
```
-------------------------9642 sample_num
```sql
SELECT DISTINCT m.label
FROM molecule m
WHERE m.molecule_id NOT IN (
    SELECT DISTINCT a.molecule_id
    FROM atom a
    WHERE a.element = 'sn'
);
```
-------------------------9643 sample_num
```sql
SELECT COUNT(*) 
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
JOIN bond b ON m.molecule_id = b.molecule_id
WHERE (a.element = 'i' OR a.element = 's') AND b.bond_type = '-';
```
-------------------------9644 sample_num
```sql
SELECT a1.atom_id, a2.atom_id
FROM connected c
JOIN atom a1 ON c.atom_id = a1.atom_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
JOIN bond b ON c.bond_id = b.bond_id
WHERE b.bond_type = '#';
```
-------------------------9645 sample_num
```sql
SELECT DISTINCT a2.atom_id
FROM atom a1
JOIN connected c ON a1.atom_id = c.atom_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
WHERE a1.molecule_id = 'TR181';
```
-------------------------9646 sample_num
```sql
SELECT 
    (1 - DIVIDE(SUM(a.element = 'f'), COUNT(DISTINCT m.molecule_id))) * 100 AS percent_non_fluorine_carcinogenic
FROM 
    molecule m
JOIN 
    atom a ON m.molecule_id = a.molecule_id
WHERE 
    m.label = '+';
```
-------------------------9647 sample_num
```sql
SELECT 
    DIVIDE(SUM(bond.bond_type = '#'), COUNT(bond.bond_id)) AS percent
FROM 
    bond
JOIN 
    molecule ON bond.molecule_id = molecule.molecule_id
WHERE 
    molecule.label = '+';
```
-------------------------9648 sample_num
```sql
SELECT DISTINCT element
FROM atom
WHERE molecule_id = 'TR000'
ORDER BY element
LIMIT 3;
```
-------------------------9649 sample_num
```sql
SELECT a.atom_id, a.element
FROM atom a
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
JOIN bond b ON c.bond_id = b.bond_id
WHERE b.molecule_id = 'TR001' AND b.bond_id = 'TR001_2_6';
```
-------------------------9650 sample_num
```sql
SELECT 
    SUM(CASE WHEN label = '+' THEN 1 ELSE 0 END) - 
    SUM(CASE WHEN label = '-' THEN 1 ELSE 0 END) AS difference
FROM 
    molecule;
```
-------------------------9651 sample_num
```sql
SELECT c.atom_id, c.atom_id2
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
WHERE b.bond_id = 'TR_000_2_5';
```
-------------------------9652 sample_num
```sql
SELECT bond_id 
FROM connected 
WHERE atom_id2 = 'TR000_2';
```
-------------------------9653 sample_num
```sql
SELECT DISTINCT m.label
FROM molecule m
JOIN bond b ON m.molecule_id = b.molecule_id
WHERE b.bond_type = ' = '
ORDER BY m.label
LIMIT 5;
```
-------------------------9654 sample_num
```sql
SELECT 
    (SUM(bond_type = ' = ') * 100.0 / COUNT(bond_id)) AS percent 
FROM 
    bond 
WHERE 
    molecule_id = 'TR008';
```
-------------------------9655 sample_num
```sql
SELECT DIVIDE(SUM(label = '+'), COUNT(molecule_id)) AS percent
FROM molecule;
```
-------------------------9656 sample_num
```sql
SELECT DIVIDE(SUM(CASE WHEN element = 'h' THEN 1 ELSE 0 END), COUNT(atom_id)) * 100 AS percent
FROM atom
WHERE molecule_id = 'TR206';
```
-------------------------9657 sample_num
```sql
SELECT b.bond_type 
FROM bond b 
WHERE b.molecule_id = 'TR000';
```
-------------------------9658 sample_num
```sql
SELECT a.element, m.label 
FROM atom a 
JOIN molecule m ON a.molecule_id = m.molecule_id 
WHERE m.molecule_id = 'TR060';
```
-------------------------9659 sample_num
```sql
SELECT bond.bond_type, 
       CASE 
           WHEN molecule.label = '+' THEN 'Carcinogenic' 
           ELSE 'Non-Carcinogenic' 
       END AS carcinogenic_status
FROM bond
JOIN molecule ON bond.molecule_id = molecule.molecule_id
WHERE bond.molecule_id = 'TR018'
GROUP BY bond.bond_type
ORDER BY COUNT(bond.bond_type) DESC
LIMIT 1;
```
-------------------------9660 sample_num
```sql
SELECT DISTINCT m.label
FROM molecule m
JOIN bond b ON m.molecule_id = b.molecule_id
JOIN connected c ON b.bond_id = c.bond_id
WHERE b.bond_type = '-' 
AND m.label = '-'
ORDER BY m.label
LIMIT 3;
```
-------------------------9661 sample_num
```sql
SELECT bond_type 
FROM bond 
WHERE molecule_id = 'TR006' 
ORDER BY bond_type 
LIMIT 2;
```
-------------------------9662 sample_num
```sql
SELECT COUNT(*) 
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
WHERE b.molecule_id = 'TR009' 
AND (c.atom_id = 'TR009_12' OR c.atom_id2 = 'TR009_12');
```
-------------------------9663 sample_num
```sql
SELECT COUNT(DISTINCT m.molecule_id) 
FROM molecule m 
JOIN atom a ON m.molecule_id = a.molecule_id 
WHERE m.label = '+' AND a.element = 'br';
```
-------------------------9664 sample_num
```sql
SELECT b.bond_type, c.atom_id, c.atom_id2
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
WHERE b.molecule_id = 'TR001_6_9';
```
-------------------------9665 sample_num
```sql
SELECT m.label, 
       CASE WHEN m.label = '+' THEN 'Carcinogenic' ELSE 'Not Carcinogenic' END AS carcinogenic_status
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
WHERE a.atom_id = 'TR001_10';
```
-------------------------9666 sample_num
```sql
SELECT COUNT(DISTINCT molecule_id) 
FROM bond 
WHERE bond_type = '#';
```
-------------------------9667 sample_num
```sql
SELECT COUNT(*) AS connection_count
FROM connected
WHERE atom_id = 'TR%_19' OR atom_id2 = 'TR%_19';
```
-------------------------9668 sample_num
```sql
SELECT DISTINCT a.element
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
WHERE m.label = 'TR004';
```
-------------------------9669 sample_num
```sql
SELECT COUNT(*) 
FROM molecule 
WHERE label = '-';
```
-------------------------9670 sample_num
```sql
SELECT DISTINCT m.label
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
WHERE SUBSTRING(a.atom_id, 7, 2) BETWEEN '21' AND '25'
AND m.label = '+';
```
-------------------------9671 sample_num
```sql
SELECT DISTINCT b.bond_id
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
JOIN atom a1 ON c.atom_id = a1.atom_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
WHERE a1.element = 'p' AND a2.element = 'n'
   OR a1.element = 'n' AND a2.element = 'p';
```
-------------------------9672 sample_num
```sql
SELECT CASE 
           WHEN COUNT(b.bond_id) > 0 THEN 
               (SELECT label FROM molecule WHERE molecule_id = m.molecule_id) 
           ELSE 
               'Not Carcinogenic' 
       END AS carcinogenic_status
FROM bond b
JOIN molecule m ON b.molecule_id = m.molecule_id
WHERE b.bond_type = '='
GROUP BY m.molecule_id
ORDER BY COUNT(b.bond_id) DESC
LIMIT 1;
```
-------------------------9673 sample_num
```sql
SELECT AVG(bond_count) AS average_bonds
FROM (
    SELECT a.atom_id, COUNT(c.bond_id) AS bond_count
    FROM atom a
    LEFT JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
    WHERE a.element = 'i'
    GROUP BY a.atom_id
) AS bond_counts;
```
-------------------------9674 sample_num
```sql
SELECT b.bond_type, b.bond_id
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
WHERE c.atom_id = 45 OR c.atom_id2 = 45;
```
-------------------------9675 sample_num
```sql
SELECT DISTINCT a.element
FROM atom a
WHERE a.atom_id NOT IN (SELECT DISTINCT c.atom_id FROM connected c);
```
-------------------------9676 sample_num
```sql
SELECT a.atom_id, a.element
FROM atom a
JOIN bond b ON a.molecule_id = b.molecule_id
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
WHERE b.molecule_id = 'TR447' AND b.bond_type = '#';
```
-------------------------9677 sample_num
```sql
SELECT a.element 
FROM atom a 
JOIN molecule m ON a.molecule_id = m.molecule_id 
JOIN bond b ON m.molecule_id = b.molecule_id 
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 
WHERE b.bond_id = 'TR144_8_19';
```
-------------------------9678 sample_num
```sql
SELECT m.label, COUNT(b.bond_id) AS double_bond_count
FROM molecule m
JOIN bond b ON m.molecule_id = b.molecule_id
WHERE m.label = '+' AND b.bond_type = ' = '
GROUP BY m.label
ORDER BY double_bond_count DESC
LIMIT 1;
```
-------------------------9679 sample_num
```sql
SELECT element
FROM atom
JOIN molecule ON atom.molecule_id = molecule.molecule_id
WHERE molecule.label = '+'
GROUP BY element
ORDER BY COUNT(*) ASC
LIMIT 1;
```
-------------------------9680 sample_num
```sql
SELECT DISTINCT a2.atom_id, a2.element
FROM atom a1
JOIN connected c ON a1.atom_id = c.atom_id
JOIN bond b ON c.bond_id = b.bond_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
WHERE a1.element = 'pb';
```
-------------------------9681 sample_num
```sql
SELECT a.element
FROM atom a
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
JOIN bond b ON c.bond_id = b.bond_id
WHERE b.bond_type = '#';
```
-------------------------9682 sample_num
```sql
SELECT 
    (COUNT(b.bond_id) * 100.0 / 
     (SELECT COUNT(*) FROM bond)) AS percentage
FROM 
    bond b
JOIN 
    connected c ON b.bond_id = c.bond_id
JOIN 
    atom a1 ON c.atom_id = a1.atom_id
JOIN 
    atom a2 ON c.atom_id2 = a2.atom_id
GROUP BY 
    a1.element, a2.element
ORDER BY 
    COUNT(b.bond_id) DESC
LIMIT 1;
```
-------------------------9683 sample_num
```sql
SELECT DIVIDE(SUM(CASE WHEN m.label = '+' THEN 1 ELSE 0 END), COUNT(b.bond_id)) AS proportion
FROM bond b
JOIN molecule m ON b.molecule_id = m.molecule_id
WHERE b.bond_type = '-';
```
-------------------------9684 sample_num
```sql
SELECT COUNT(*) AS total_atoms
FROM atom
WHERE element IN ('c', 'h');
```
-------------------------9685 sample_num
```sql
SELECT c.atom_id2 
FROM atom a 
JOIN connected c ON a.atom_id = c.atom_id 
WHERE a.element = 's';
```
-------------------------9686 sample_num
```sql
SELECT DISTINCT b.bond_type
FROM atom a
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
JOIN bond b ON c.bond_id = b.bond_id
WHERE a.element = 'sn';
```
-------------------------9687 sample_num
```sql
SELECT COUNT(DISTINCT a.element) AS element_count
FROM atom a
JOIN bond b ON a.molecule_id = b.molecule_id
WHERE b.bond_type = '-';
```
-------------------------9688 sample_num
```sql
SELECT COUNT(DISTINCT a.atom_id) AS total_atoms
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
JOIN bond b ON m.molecule_id = b.molecule_id
JOIN connected c ON b.bond_id = c.bond_id
WHERE b.bond_type = '#'
AND (a.element = 'p' OR a.element = 'br');
```
-------------------------9689 sample_num
```sql
SELECT b.bond_id 
FROM bond b 
JOIN molecule m ON b.molecule_id = m.molecule_id 
WHERE m.label = '+';
```
-------------------------9690 sample_num
```sql
SELECT DISTINCT m.molecule_id
FROM molecule m
JOIN bond b ON m.molecule_id = b.molecule_id
WHERE b.bond_type = '-' AND m.label = '-';
```
-------------------------9691 sample_num
```sql
SELECT 
    (SUM(CASE WHEN a.element = 'cl' THEN 1 ELSE 0 END) * 100.0 / COUNT(a.atom_id)) AS percent
FROM 
    atom a
JOIN 
    bond b ON a.molecule_id = b.molecule_id
WHERE 
    b.bond_type = '-';
```
-------------------------9692 sample_num
```sql
SELECT label 
FROM molecule 
WHERE molecule_id IN ('TR000', 'TR001', 'TR002');
```
-------------------------9693 sample_num
```sql
SELECT molecule_id FROM molecule WHERE label = '-';
```
-------------------------9694 sample_num
```sql
SELECT COUNT(*) AS total_carcinogenic_molecules
FROM molecule
WHERE molecule_id BETWEEN 'TR000' AND 'TR030' AND label = '+';
```
-------------------------9695 sample_num
```sql
SELECT b.bond_type
FROM bond b
JOIN molecule m ON b.molecule_id = m.molecule_id
WHERE m.molecule_id BETWEEN 'TR000' AND 'TR050';
```
-------------------------9696 sample_num
```sql
SELECT a.element 
FROM atom a 
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 
JOIN bond b ON c.bond_id = b.bond_id 
WHERE b.bond_id = 'TR001_10_11';
```
-------------------------9697 sample_num
```sql
SELECT COUNT(DISTINCT c.bond_id) AS bond_count
FROM atom a
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
WHERE a.element = 'i';
```
-------------------------9698 sample_num
```sql
SELECT 
    CASE 
        WHEN COUNT(CASE WHEN m.label = '+' THEN 1 END) > COUNT(CASE WHEN m.label = '-' THEN 1 END) THEN 'Mostly Carcinogenic'
        ELSE 'Mostly Non Carcinogenic'
    END AS carcinogenic_status
FROM 
    atom a
JOIN 
    molecule m ON a.molecule_id = m.molecule_id
WHERE 
    a.element = 'ca';
```
-------------------------9699 sample_num
```sql
SELECT COUNT(DISTINCT a.element) = 2
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
JOIN atom a ON c.atom_id = a.atom_id
WHERE b.bond_id = 'TR001_1_8' AND a.element IN ('cl', 'c';
```
-------------------------9700 sample_num
```sql
SELECT DISTINCT m.molecule_id
FROM molecule m
JOIN bond b ON m.molecule_id = b.molecule_id
JOIN connected c ON b.bond_id = c.bond_id
JOIN atom a ON c.atom_id = a.atom_id
WHERE a.element = 'c' 
  AND b.bond_type = '#' 
  AND m.label = '-'
LIMIT 2;
```
-------------------------9701 sample_num
```sql
SELECT 
    (SUM(CASE WHEN a.element = 'cl' THEN 1 ELSE 0 END) * 100.0 / COUNT(DISTINCT m.molecule_id)) AS percentage
FROM 
    molecule m
JOIN 
    atom a ON m.molecule_id = a.molecule_id
WHERE 
    m.label = '+';
```
-------------------------9702 sample_num
```sql
SELECT DISTINCT a.element 
FROM atom a 
WHERE a.molecule_id = 'TR001';
```
-------------------------9703 sample_num
```sql
SELECT molecule_id FROM bond WHERE bond_type = ' = ';
```
-------------------------9704 sample_num
```sql
SELECT c.atom_id, c.atom_id2
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
WHERE b.bond_type = '#';
```
-------------------------9705 sample_num
```sql
SELECT DISTINCT a.element
FROM atom a
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
JOIN bond b ON c.bond_id = b.bond_id
WHERE b.bond_id = 'TR005_16_26';
```
-------------------------9706 sample_num
```sql
SELECT COUNT(DISTINCT m.molecule_id) AS non_carcinogenic_single_bonds
FROM molecule m
JOIN bond b ON m.molecule_id = b.molecule_id
WHERE b.bond_type = '-' AND m.label = '-';
```
-------------------------9707 sample_num
```sql
SELECT m.label 
FROM bond b 
JOIN molecule m ON b.molecule_id = m.molecule_id 
WHERE b.bond_id = 'TR001_10_11';
```
-------------------------9708 sample_num
```sql
SELECT b.bond_id, 
       CASE 
           WHEN m.label = '+' THEN 'Carcinogenic' 
           ELSE 'Non-Carcinogenic' 
       END AS carcinogenic_status
FROM bond b
JOIN molecule m ON b.molecule_id = m.molecule_id
WHERE b.bond_type = '#';
```
-------------------------9709 sample_num
```sql
SELECT a.element
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
WHERE m.label = '+'
AND SUBSTR(a.atom_id, 7, 1) = '4';
```
-------------------------9710 sample_num
```sql
SELECT 
    label, 
    DIVIDE(SUM(CASE WHEN element = 'h' THEN 1 ELSE 0 END), COUNT(*)) AS hydrogen_ratio
FROM 
    atom 
JOIN 
    molecule ON atom.molecule_id = molecule.molecule_id
WHERE 
    atom.molecule_id = 'TR006';
```
-------------------------9711 sample_num
```sql
SELECT m.label
FROM molecule m
JOIN atom a ON m.molecule_id = a.molecule_id
WHERE a.element = 'ca';
```
-------------------------9712 sample_num
```sql
SELECT b.bond_type
FROM bond b
JOIN atom a ON b.molecule_id = a.molecule_id
WHERE a.element = 'te';
```
-------------------------9713 sample_num
```sql
SELECT a1.element AS element1, a2.element AS element2
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
JOIN atom a1 ON c.atom_id = a1.atom_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
WHERE b.bond_id = 'TR001_10_11';
```
-------------------------9714 sample_num
```sql
SELECT 
    (COUNT(DISTINCT m.molecule_id) * 100.0 / (SELECT COUNT(DISTINCT molecule_id) FROM molecule)) AS percent_triple_bond
FROM 
    bond b
JOIN 
    molecule m ON b.molecule_id = m.molecule_id
WHERE 
    b.bond_type = '#';
```
-------------------------9715 sample_num
```sql
SELECT 
    (SUM(bond_type = ' = ') * 100.0 / COUNT(bond_id)) AS percent
FROM 
    bond
WHERE 
    molecule_id = 'TR047';
```
-------------------------9716 sample_num
```sql
SELECT m.label
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
WHERE a.element = 'TR001_1' AND m.label = '+';
```
-------------------------9717 sample_num
```sql
SELECT CASE WHEN label = '+' THEN 'Yes' ELSE 'No' END AS is_carcinogenic
FROM molecule
WHERE label = '+' AND molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR151');
```
-------------------------9718 sample_num
```sql
SELECT DISTINCT a.element
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
WHERE m.label = 'TR151' AND a.element IN ('cl', 'br', 'f', 'i', 'sn', 'pb', 'te');
```
-------------------------9719 sample_num
```sql
SELECT COUNT(*) 
FROM molecule 
WHERE label = '+';
```
-------------------------9720 sample_num
```sql
SELECT a.*
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
WHERE a.element = 'c'
AND SUBSTR(m.molecule_id, 3, 3) > '010' AND SUBSTR(m.molecule_id, 3, 3) < '050';
```
-------------------------9721 sample_num
```sql
SELECT COUNT(a.atom_id) 
FROM atom a 
JOIN molecule m ON a.molecule_id = m.molecule_id 
WHERE m.label = '+';
```
-------------------------9722 sample_num
```sql
SELECT b.bond_id
FROM bond b
JOIN molecule m ON b.molecule_id = m.molecule_id
WHERE b.bond_type = ' = ' AND m.label = '+';
```
-------------------------9723 sample_num
```sql
SELECT COUNT(a.atom_id) 
FROM atom a 
JOIN molecule m ON a.molecule_id = m.molecule_id 
WHERE a.element = 'h' AND m.label = '+';
```
-------------------------9724 sample_num
```sql
SELECT DISTINCT a.molecule_id
FROM atom a
JOIN connected c ON a.atom_id = c.atom_id
JOIN bond b ON c.bond_id = b.bond_id
WHERE b.bond_type = 'TR00_1_2' AND a.element = 'TR00_1';
```
-------------------------9725 sample_num
```sql
SELECT a.atom_id 
FROM atom a 
JOIN molecule m ON a.molecule_id = m.molecule_id 
WHERE a.element = 'c' AND m.label = '-';
```
-------------------------9726 sample_num
```sql
SELECT 
    (SUM(CASE WHEN label = '+' AND element = 'h' THEN 1 ELSE 0 END) * 100.0) / COUNT(molecule_id) AS percentage
FROM 
    molecule 
JOIN 
    atom ON molecule.molecule_id = atom.molecule_id;
```
-------------------------9727 sample_num
```sql
SELECT CASE WHEN label = '+' THEN 'Yes' ELSE 'No' END AS is_carcinogenic
FROM molecule
WHERE label = '+' AND molecule_id = 'TR124';
```
-------------------------9728 sample_num
```sql
SELECT a.atom_id, a.element 
FROM atom a 
WHERE a.molecule_id = (SELECT m.molecule_id FROM molecule m WHERE m.label = 'TR186');
```
-------------------------9729 sample_num
```sql
SELECT b.bond_type 
FROM bond b 
JOIN molecule m ON b.molecule_id = m.molecule_id 
WHERE m.label = 'TR007_4_19';
```
-------------------------9730 sample_num
```sql
SELECT DISTINCT a.element
FROM atom a
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
JOIN bond b ON c.bond_id = b.bond_id
WHERE b.bond_type = 'TR001_2_4';
```
-------------------------9731 sample_num
```sql
SELECT 
    COUNT(b.bond_id) AS double_bond_count,
    m.label
FROM 
    bond b
JOIN 
    molecule m ON b.molecule_id = m.molecule_id
WHERE 
    m.label = '+' OR m.label = '-'
    AND m.molecule_id = 'TR006'
    AND b.bond_type = ' = '
GROUP BY 
    m.label;
```
-------------------------9732 sample_num
```sql
SELECT m.label, a.element
FROM molecule m
JOIN atom a ON m.molecule_id = a.molecule_id
WHERE m.label = '+';
```
-------------------------9733 sample_num
```sql
SELECT b.bond_id, a1.element AS atom1, a2.element AS atom2
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
JOIN atom a1 ON c.atom_id = a1.atom_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
WHERE b.bond_type = '-';
```
-------------------------9734 sample_num
```sql
SELECT DISTINCT m.label, a.element
FROM molecule m
JOIN bond b ON m.molecule_id = b.molecule_id
JOIN connected c ON b.bond_id = c.bond_id
JOIN atom a ON c.atom_id = a.atom_id
WHERE b.bond_type = '#';
```
-------------------------9735 sample_num
```sql
SELECT a.element 
FROM atom a 
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 
JOIN bond b ON c.bond_id = b.bond_id 
WHERE b.bond_type = 'TR000_2_3';
```
-------------------------9736 sample_num
```sql
SELECT COUNT(DISTINCT c.bond_id) AS bond_count
FROM atom a
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
WHERE a.element = 'cl';
```
-------------------------9737 sample_num
```sql
SELECT a.atom_id, COUNT(DISTINCT b.bond_type) AS bond_type_count
FROM atom a
JOIN molecule m ON a.molecule_id = m.molecule_id
JOIN bond b ON m.molecule_id = b.molecule_id
WHERE m.label = 'TR346'
GROUP BY a.atom_id;
```
-------------------------9738 sample_num
```sql
SELECT COUNT(DISTINCT m.molecule_id) AS carcinogenic_molecules_count
FROM bond b
JOIN molecule m ON b.molecule_id = m.molecule_id
WHERE b.bond_type = '=' AND m.label = '+';
```
-------------------------9739 sample_num
```sql
SELECT COUNT(DISTINCT m.molecule_id) 
FROM molecule m
LEFT JOIN atom a ON m.molecule_id = a.molecule_id AND a.element = 's'
LEFT JOIN bond b ON m.molecule_id = b.molecule_id AND b.bond_type = ' = '
WHERE a.atom_id IS NULL AND b.bond_id IS NULL;
```
-------------------------9740 sample_num
```sql
SELECT m.label 
FROM bond b 
JOIN molecule m ON b.molecule_id = m.molecule_id 
WHERE b.bond_id = 'TR001_2_4' AND m.label = '+';
```
-------------------------9741 sample_num
```sql
SELECT COUNT(*) 
FROM atom 
WHERE molecule_id = 'TR005';
```
-------------------------9742 sample_num
```sql
SELECT COUNT(*) AS single_bond_count 
FROM bond 
WHERE bond_type = '-';
```
-------------------------9743 sample_num
```sql
SELECT DISTINCT m.label
FROM molecule m
JOIN atom a ON m.molecule_id = a.molecule_id
WHERE a.element = 'cl' AND m.label = '+';
```
-------------------------9744 sample_num
```sql
SELECT DISTINCT m.molecule_id, m.label
FROM molecule m
JOIN atom a ON m.molecule_id = a.molecule_id
WHERE a.element = 'c' AND m.label = '-';
```
-------------------------9745 sample_num
```sql
SELECT 
    DIVIDE(SUM(CASE WHEN m.label = '+' AND a.element = 'Cl' THEN 1 ELSE 0 END), COUNT(m.molecule_id)) AS percentage
FROM 
    molecule m
JOIN 
    atom a ON m.molecule_id = a.molecule_id
WHERE 
    m.label = '+';
```
-------------------------9746 sample_num
```sql
SELECT molecule_id FROM bond WHERE bond_id = 'TR001_1_7';
```
-------------------------9747 sample_num
```sql
SELECT COUNT(DISTINCT a.element) AS element_count
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
JOIN atom a ON c.atom_id = a.atom_id OR c.atom_id2 = a.atom_id
WHERE b.bond_id = 'TR001_3_4';
```
-------------------------9748 sample_num
```sql
SELECT b.bond_type
FROM bond b
JOIN connected c ON b.bond_id = c.bond_id
JOIN atom a1 ON c.atom_id = a1.atom_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
WHERE a1.element = 'TR000_1' AND a2.element = 'TR000_2';
```
-------------------------9749 sample_num
```sql
SELECT m.label 
FROM molecule m
JOIN atom a1 ON m.molecule_id = a1.molecule_id
JOIN connected c ON a1.atom_id = c.atom_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
WHERE a1.atom_id = 'TR000_2' AND a2.atom_id = 'TR000_4';
```
-------------------------9750 sample_num
```sql
SELECT element FROM atom WHERE atom_id = 'TR000_1';
```
-------------------------9751 sample_num
```sql
SELECT CASE 
           WHEN label = '+' THEN 'Carcinogenic' 
           WHEN label = '-' THEN 'Non-carcinogenic' 
           ELSE 'Unknown' 
       END AS carcinogenic_status
FROM molecule
WHERE molecule_id = 'TR000';
```
-------------------------9752 sample_num
```sql
SELECT 
    (SUM(CASE WHEN b.bond_type = '-' THEN 1 ELSE 0 END) * 100.0 / COUNT(b.bond_id)) AS percentage
FROM 
    bond b
JOIN 
    connected c ON b.bond_id = c.bond_id
JOIN 
    atom a ON c.atom_id = a.atom_id OR c.atom_id2 = a.atom_id
GROUP BY 
    a.molecule_id;
```
-------------------------9753 sample_num
```sql
SELECT COUNT(DISTINCT m.molecule_id) AS carcinogenic_molecule_count
FROM molecule m
JOIN atom a ON m.molecule_id = a.molecule_id
WHERE a.element = 'n' AND m.label = '+';
```
-------------------------9754 sample_num
```sql
SELECT DISTINCT m.label
FROM molecule m
JOIN atom a ON m.molecule_id = a.molecule_id
JOIN connected c ON a.atom_id = c.atom_id
JOIN bond b ON c.bond_id = b.bond_id
WHERE a.element = 's' AND b.bond_type = ' = ';
```
-------------------------9755 sample_num
```sql
SELECT m.molecule_id
FROM molecule m
JOIN atom a ON m.molecule_id = a.molecule_id
WHERE m.label = '-'
GROUP BY m.molecule_id
HAVING COUNT(a.atom_id) > 5;
```
-------------------------9756 sample_num
```sql
SELECT DISTINCT a.element
FROM atom a
JOIN bond b ON a.molecule_id = b.molecule_id
WHERE b.bond_type = '=' AND a.molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR024');
```
-------------------------9757 sample_num
```sql
SELECT m.label, COUNT(a.atom_id) AS atom_count
FROM molecule m
JOIN atom a ON m.molecule_id = a.molecule_id
WHERE m.label = '+'
GROUP BY m.label
ORDER BY atom_count DESC
LIMIT 1;
```
-------------------------9758 sample_num
```sql
SELECT 
    (SUM(CASE WHEN m.label = '+' THEN 1 ELSE 0 END) * 100.0) / COUNT(DISTINCT m.molecule_id) AS carcinogenic_percentage
FROM 
    molecule m
JOIN 
    bond b ON m.molecule_id = b.molecule_id
JOIN 
    connected c ON b.bond_id = c.bond_id
JOIN 
    atom a ON c.atom_id = a.atom_id
WHERE 
    a.element = 'h' AND b.bond_type = '#';
```
-------------------------9759 sample_num
```sql
SELECT COUNT(*) 
FROM molecule 
WHERE label = '+';
```
-------------------------9760 sample_num
```sql
SELECT COUNT(DISTINCT b.molecule_id) AS single_bond_molecule_count
FROM bond b
WHERE b.bond_type = '-' AND b.molecule_id BETWEEN 'TR004' AND 'TR010';
```
-------------------------9761 sample_num
```sql
SELECT COUNT(*) 
FROM atom 
WHERE molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR008') 
AND element = 'c';
```
-------------------------9762 sample_num
```sql
SELECT a.element 
FROM atom a 
JOIN molecule m ON a.molecule_id = m.molecule_id 
WHERE a.atom_id = 'TR004_7' AND m.label = '-';
```
-------------------------9763 sample_num
```sql
SELECT COUNT(DISTINCT m.molecule_id) AS total_molecules
FROM molecule m
JOIN bond b ON m.molecule_id = b.molecule_id
JOIN connected c ON b.bond_id = c.bond_id
JOIN atom a1 ON c.atom_id = a1.atom_id
JOIN atom a2 ON c.atom_id2 = a2.atom_id
WHERE a1.element = 'o' AND a2.element = 'o' AND b.bond_type = ' = ';
```
-------------------------9764 sample_num
```sql
SELECT COUNT(DISTINCT m.molecule_id) AS non_carcinogenic_triple_bond_molecules
FROM bond b
JOIN molecule m ON b.molecule_id = m.molecule_id
WHERE b.bond_type = '#' AND m.label = '-';
```
-------------------------9765 sample_num
```sql
SELECT a.element, b.bond_type
FROM atom a
JOIN bond b ON a.molecule_id = b.molecule_id
WHERE a.molecule_id = 'TR016';
```
-------------------------9766 sample_num
```sql
SELECT a.atom_id 
FROM atom a
JOIN bond b ON a.molecule_id = b.molecule_id
JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2
JOIN molecule m ON a.molecule_id = m.molecule_id
WHERE m.label = 'TR012' AND a.element = 'c' AND b.bond_type = ' = ';
```
-------------------------9767 sample_num
```sql
SELECT a.atom_id 
FROM atom a 
JOIN molecule m ON a.molecule_id = m.molecule_id 
WHERE m.label = '+' AND a.element = 'o';
```
-------------------------9768 sample_num
```sql
SELECT * FROM cards 
WHERE cardKingdomFoilId = cardKingdomId AND cardKingdomId IS NOT NULL;
```
-------------------------9769 sample_num
```sql
SELECT * FROM cards 
WHERE borderColor = 'borderless' 
AND (cardKingdomFoilId IS NULL OR cardKingdomId IS NULL);
```
-------------------------9770 sample_num
```sql
SELECT name 
FROM cards 
WHERE faceConvertedManaCost = (SELECT MAX(faceConvertedManaCost) FROM cards);
```
-------------------------9771 sample_num
```sql
SELECT name 
FROM cards 
WHERE edhrecRank < 100 AND frameVersion = 2015;
```
-------------------------9772 sample_num
```sql
SELECT c.*
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE c.rarity = 'mythic' AND l.status = 'Banned' AND l.format = 'gladiator';
```
-------------------------9773 sample_num
```sql
SELECT legalities.*
FROM cards
JOIN legalities ON cards.uuid = legalities.uuid
WHERE cards.type = 'Artifact'
  AND cards.side IS NULL
  AND legalities.format = 'vintage';
```
-------------------------9774 sample_num
```sql
SELECT c.id, c.artist
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE (c.power = '*' OR c.power IS NULL) 
AND l.format = 'commander' 
AND l.status = 'Legal';
```
-------------------------9775 sample_num
```sql
SELECT 
    c.name AS card_name,
    c.flavorText AS card_flavor_text,
    r.text AS ruling_text,
    CASE 
        WHEN c.hasContentWarning = 1 THEN 'Missing or degraded properties and values'
        ELSE 'No missing or degraded properties and values'
    END AS properties_status
FROM 
    cards c
JOIN 
    rulings r ON c.uuid = r.uuid
WHERE 
    c.artist = 'Stephen Daniele';
```
-------------------------9776 sample_num
```sql
SELECT r.*
FROM rulings r
JOIN cards c ON r.uuid = c.uuid
WHERE c.name = 'Sublime Epiphany' AND c.number = '74s';
```
-------------------------9777 sample_num
```sql
SELECT c.name, c.artist, c.isPromo
FROM cards c
JOIN rulings r ON c.uuid = r.uuid
GROUP BY c.id
ORDER BY COUNT(r.uuid) DESC
LIMIT 1;
```
-------------------------9778 sample_num
```sql
SELECT DISTINCT fd.language 
FROM foreign_data fd 
JOIN cards c ON fd.multiverseid = c.multiverseId 
WHERE c.name = 'Annul' AND c.number = '29';
```
-------------------------9779 sample_num
```sql
SELECT c.name 
FROM cards c 
JOIN foreign_data f ON c.uuid = f.uuid 
WHERE f.language = 'Japanese';
```
-------------------------9780 sample_num
```sql
SELECT (SUM(CASE WHEN language = 'Chinese Simplified' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS percentage
FROM foreign_data;
```
-------------------------9781 sample_num
```sql
SELECT s.name, s.totalSetSize
FROM sets s
JOIN set_translations st ON s.code = st.setCode
WHERE st.language = 'Italian';
```
-------------------------9782 sample_num
```sql
SELECT COUNT(DISTINCT type) AS card_types
FROM cards
WHERE artist = 'Aaron Boyd';
```
-------------------------9783 sample_num
```sql
SELECT keywords FROM cards WHERE name = 'Angel of Mercy';
```
-------------------------9784 sample_num
```sql
SELECT COUNT(*) FROM cards WHERE power = '*';
```
-------------------------9785 sample_num
```sql
SELECT promoTypes FROM cards WHERE name = 'Duress';
```
-------------------------9786 sample_num
```sql
SELECT borderColor FROM cards WHERE name = "Ancestor's Chosen";
```
-------------------------9787 sample_num
```sql
SELECT originalType 
FROM cards 
WHERE name = "Ancestor's Chosen";
```
-------------------------9788 sample_num
```sql
SELECT DISTINCT st.language
FROM cards c
JOIN sets s ON c.setCode = s.code
JOIN set_translations st ON s.code = st.setCode
WHERE c.name = 'Angel of Mercy';
```
-------------------------9789 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
JOIN legalities ON cards.uuid = legalities.uuid 
WHERE legalities.status = 'restricted' AND cards.isTextless = 0;
```
-------------------------9790 sample_num
```sql
SELECT r.text 
FROM rulings r 
JOIN cards c ON r.uuid = c.uuid 
WHERE c.name = 'Condemn';
```
-------------------------9791 sample_num
```sql
SELECT COUNT(DISTINCT c.id) 
FROM cards c 
JOIN legalities l ON c.uuid = l.uuid 
WHERE l.status = 'restricted' AND c.isStarter = 1;
```
-------------------------9792 sample_num
```sql
SELECT legalities.status 
FROM cards 
JOIN legalities ON cards.uuid = legalities.uuid 
WHERE cards.name = 'Cloudchaser Eagle';
```
-------------------------9793 sample_num
```sql
SELECT type FROM cards WHERE name = 'Benalish Knight';
```
-------------------------9794 sample_num
```sql
SELECT legalities.format, legalities.status 
FROM cards 
JOIN legalities ON cards.uuid = legalities.uuid 
WHERE cards.name = 'Benalish Knight';
```
-------------------------9795 sample_num
```sql
SELECT DISTINCT c.artist 
FROM cards c 
JOIN foreign_data f ON c.id = f.multiverseid 
WHERE f.language = 'Phyrexian';
```
-------------------------9796 sample_num
```sql
SELECT (COUNT(CASE WHEN borderColor = 'borderless' THEN 1 END) * 100.0 / COUNT(id)) AS percentage_borderless
FROM cards;
```
-------------------------9797 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
JOIN foreign_data ON cards.uuid = foreign_data.uuid 
WHERE foreign_data.language = 'German' AND cards.isReprint = 1;
```
-------------------------9798 sample_num
```sql
SELECT COUNT(*) 
FROM cards c
JOIN foreign_data f ON c.uuid = f.uuid
WHERE c.borderColor = 'borderless' AND f.language = 'Russian';
```
-------------------------9799 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN f.language = 'French' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_french_story_spotlight
FROM 
    cards c
JOIN 
    foreign_data f ON c.id = f.multiverseid
WHERE 
    c.isStorySpotlight = 1;
```
-------------------------9800 sample_num
```sql
SELECT COUNT(*) FROM cards WHERE toughness = 99;
```
-------------------------9801 sample_num
```sql
SELECT name FROM cards WHERE artist = 'Aaron Boyd';
```
-------------------------9802 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE borderColor = 'black' AND availability = 'mtgo';
```
-------------------------9803 sample_num
```sql
SELECT id FROM cards WHERE convertedManaCost = 0;
```
-------------------------9804 sample_num
```sql
SELECT layout 
FROM cards 
WHERE keywords LIKE '%flying%';
```
-------------------------9805 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE originalType = 'Summon - Angel' 
AND subtypes NOT LIKE '%Angel%';
```
-------------------------9806 sample_num
```sql
SELECT id 
FROM cards 
WHERE hasFoil = 1 AND cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL;
```
-------------------------9807 sample_num
```sql
SELECT id FROM cards WHERE duelDeck = 'a';
```
-------------------------9808 sample_num
```sql
SELECT edhrecRank FROM cards WHERE frameVersion = '2015';
```
-------------------------9809 sample_num
```sql
SELECT DISTINCT f.name AS artist_name
FROM cards c
JOIN foreign_data f ON c.id = f.multiverseid
WHERE f.language = 'Chinese Simplified';
```
-------------------------9810 sample_num
```sql
SELECT DISTINCT c.*
FROM cards c
JOIN foreign_data f ON c.uuid = f.uuid
WHERE c.availability = 'paper' AND f.language = 'Japanese';
```
-------------------------9811 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
JOIN legalities ON cards.uuid = legalities.uuid 
WHERE legalities.status = 'Banned' AND cards.borderColor = 'white';
```
-------------------------9812 sample_num
```sql
SELECT l.uuid, f.language
FROM legalities l
JOIN foreign_data f ON l.uuid = f.uuid
WHERE l.format = 'legacy';
```
-------------------------9813 sample_num
```sql
SELECT r.text 
FROM rulings r 
JOIN cards c ON r.uuid = c.uuid 
WHERE c.name = 'Beacon of Immortality';
```
-------------------------9814 sample_num
```sql
SELECT COUNT(c.id) AS card_count, l.status
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE c.frameVersion = 'future' AND l.status = 'legal'
GROUP BY l.status;
```
-------------------------9815 sample_num
```sql
SELECT name, colors 
FROM cards 
WHERE setCode = 'OGW';
```
-------------------------9816 sample_num
```sql
SELECT c.name, st.language
FROM cards c
JOIN sets s ON c.setCode = s.code
JOIN set_translations st ON s.code = st.setCode
WHERE s.code = '10E' AND c.convertedManaCost = 5;
```
-------------------------9817 sample_num
```sql
SELECT c.name, r.date
FROM cards c
JOIN rulings r ON c.uuid = r.uuid
WHERE c.originalType = 'Creature - Elf';
```
-------------------------9818 sample_num
```sql
SELECT c.colors, l.format
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE c.id BETWEEN 1 AND 20;
```
-------------------------9819 sample_num
```sql
SELECT c.*
FROM cards c
JOIN foreign_data f ON c.uuid = f.uuid
WHERE c.originalType = 'Artifact' AND c.colors = 'B';
```
-------------------------9820 sample_num
```sql
SELECT c.name
FROM cards c
JOIN rulings r ON c.uuid = r.uuid
WHERE c.rarity = 'uncommon'
ORDER BY r.date ASC
LIMIT 3;
```
-------------------------9821 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE artist = 'John Avon' AND cardKingdomFoilId IS NULL;
```
-------------------------9822 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE borderColor = 'white' 
AND cardKingdomFoilId = cardKingdomId 
AND cardKingdomId IS NOT NULL;
```
-------------------------9823 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE artist = 'UDON' 
AND availability = 'mtgo' 
AND hand = -1;
```
-------------------------9824 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE frameVersion = '1993' 
AND availability = 'paper' 
AND hasContentWarning = 1;
```
-------------------------9825 sample_num
```sql
SELECT manaCost 
FROM cards 
WHERE layout = 'normal' 
AND frameVersion = '2003' 
AND borderColor = 'black' 
AND availability IN ('paper', 'mtgo');
```
-------------------------9826 sample_num
```sql
SELECT SUM(convertedManaCost) AS total_unconverted_mana
FROM cards
WHERE artist = 'Rob Alexander';
```
-------------------------9827 sample_num
```sql
SELECT DISTINCT subtypes AS card_type FROM cards WHERE availability = 'arena'
UNION
SELECT DISTINCT supertypes AS card_type FROM cards WHERE availability = 'arena';
```
-------------------------9828 sample_num
```sql
SELECT DISTINCT st.setCode
FROM set_translations st
WHERE st.language = 'Spanish';
```
-------------------------9829 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN hand = '+3' THEN 1 END) * 100.0 / COUNT(id)) AS percentage
FROM 
    cards
WHERE 
    frameEffects = 'legendary';
```
-------------------------9830 sample_num
```sql
SELECT 
    (SUM(CASE WHEN isStorySpotlight = 1 AND isTextless = 0 THEN 1 ELSE 0 END) * 100.0) / 
    NULLIF(COUNT(*), 0) AS percentage,
    id
FROM 
    cards
WHERE 
    isStorySpotlight = 1
GROUP BY 
    id;
```
-------------------------9831 sample_num
```sql
SELECT 
    c.name, 
    (COUNT(f.id) * 100.0 / (SELECT COUNT(*) FROM cards)) AS percentage
FROM 
    cards c
LEFT JOIN 
    foreign_data f ON c.uuid = f.uuid AND f.language = 'Spanish'
GROUP BY 
    c.name;
```
-------------------------9832 sample_num
```sql
SELECT DISTINCT st.language 
FROM sets s 
JOIN set_translations st ON s.code = st.setCode 
WHERE s.baseSetSize = 309;
```
-------------------------9833 sample_num
```sql
SELECT COUNT(*) 
FROM set_translations st 
JOIN sets s ON st.setCode = s.code 
WHERE st.language = 'Portuguese (Brasil)' AND s.block = 'Commander';
```
-------------------------9834 sample_num
```sql
SELECT c.id 
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE c.types LIKE '%Creature%' AND l.status = 'legal';
```
-------------------------9835 sample_num
```sql
SELECT DISTINCT 
    COALESCE(c.subtypes, '') AS type 
FROM 
    cards c 
JOIN 
    foreign_data f ON c.name = f.name 
WHERE 
    f.language = 'German' 
    AND (c.subtypes IS NOT NULL OR c.supertypes IS NOT NULL);
```
-------------------------9836 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE power IS NULL AND text LIKE '%triggered ability%';
```
-------------------------9837 sample_num
```sql
SELECT COUNT(DISTINCT c.id) 
FROM cards c 
JOIN legalities l ON c.uuid = l.uuid 
JOIN rulings r ON c.uuid = r.uuid 
WHERE l.format = 'pre-modern' 
  AND r.text = 'This is a triggered mana ability' 
  AND c.side IS NULL;
```
-------------------------9838 sample_num
```sql
SELECT c.id 
FROM cards c 
JOIN legalities l ON c.uuid = l.uuid 
WHERE c.artist = 'Erica Yang' 
AND l.format = 'pauper' 
AND c.availability = 'paper';
```
-------------------------9839 sample_num
```sql
SELECT artist 
FROM cards 
WHERE id = (SELECT uuid FROM foreign_data WHERE text = 'Das perfekte Gegenmittel zu einer dichten Formation');
```
-------------------------9840 sample_num
```sql
SELECT fd.name 
FROM cards c 
JOIN foreign_data fd ON c.uuid = fd.uuid 
WHERE c.type = 'Creature' 
  AND c.layout = 'normal' 
  AND c.borderColor = 'black' 
  AND c.artist = 'Matthew D. Wilson' 
  AND fd.language = 'French';
```
-------------------------9841 sample_num
```sql
SELECT COUNT(*) 
FROM cards c
JOIN rulings r ON c.uuid = r.uuid
WHERE c.rarity = 'rare' AND r.date = '2009-01-10';
```
-------------------------9842 sample_num
```sql
SELECT st.language 
FROM sets s 
JOIN set_translations st ON s.code = st.setCode 
WHERE s.baseSetSize = 180 AND s.block = 'Ravnica';
```
-------------------------9843 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.hasContentWarning = 0 THEN 1 END) * 100.0 / COUNT(c.id)) AS percentage
FROM 
    cards c
JOIN 
    legalities l ON c.uuid = l.uuid
WHERE 
    l.format = 'commander' AND l.status = 'legal';
```
-------------------------9844 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN f.language = 'French' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    cards c
JOIN 
    foreign_data f ON c.uuid = f.uuid
WHERE 
    c.power IS NULL OR c.power = '*';
```
-------------------------9845 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN s.type = 'expansion' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    sets s
JOIN 
    set_translations st ON s.code = st.setCode
WHERE 
    st.language = 'Japanese';
```
-------------------------9846 sample_num
```sql
SELECT availability FROM cards WHERE artist = 'Daren Bader';
```
-------------------------9847 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE borderColor = 'borderless' AND edhrecRank > 12000 AND colors IS NOT NULL;
```
-------------------------9848 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE isOversized = 1 AND isReprint = 1 AND isPromo = 1;
```
-------------------------9849 sample_num
```sql
SELECT name, power
FROM cards
WHERE (power IS NULL OR power = '*') AND promoTypes = 'arenaleague'
ORDER BY name
LIMIT 3;
```
-------------------------9850 sample_num
```sql
SELECT foreign_data.language 
FROM foreign_data 
WHERE foreign_data.multiverseid = 149934;
```
-------------------------9851 sample_num
```sql
SELECT DISTINCT cardKingdomFoilId, cardKingdomId
FROM cards
WHERE cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL
ORDER BY cardKingdomFoilId
LIMIT 3;
```
-------------------------9852 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN isTextless = 1 AND layout = 'normal' THEN 1 END) * 100.0) / COUNT(*) AS proportion
FROM 
    cards;
```
-------------------------9853 sample_num
```sql
SELECT number 
FROM cards 
WHERE otherFaceIds IS NULL 
AND subtypes LIKE '%Angel%' 
AND subtypes LIKE '%Wizard%';
```
-------------------------9854 sample_num
```sql
SELECT name, code 
FROM sets 
WHERE mtgoCode IS NULL OR mtgoCode = '' 
ORDER BY name 
LIMIT 3;
```
-------------------------9855 sample_num
```sql
SELECT DISTINCT st.language 
FROM sets s 
JOIN set_translations st ON s.code = st.setCode 
WHERE s.mcmName = 'Archenemy' AND s.code = 'ARC';
```
-------------------------9856 sample_num
```sql
SELECT s.name, st.translation 
FROM sets s 
JOIN set_translations st ON s.code = st.setCode 
WHERE s.id = 5;
```
-------------------------9857 sample_num
```sql
SELECT st.language, s.type
FROM sets s
JOIN set_translations st ON s.code = st.setCode
WHERE s.id = 206;
```
-------------------------9858 sample_num
```sql
SELECT s.id, s.name
FROM sets s
JOIN cards c ON s.code = c.setCode
JOIN foreign_data f ON c.uuid = f.uuid
WHERE f.language = 'Italian' AND s.block = 'Shadowmoor'
GROUP BY s.id, s.name
ORDER BY s.name
LIMIT 2;
```
-------------------------9859 sample_num
```sql
SELECT s.id 
FROM sets s 
JOIN foreign_data f ON s.code = f.setCode 
WHERE s.isForeignOnly = 1 
  AND s.isFoilOnly = 1 
  AND f.language = 'Japanese';
```
-------------------------9860 sample_num
```sql
SELECT name, MAX(baseSetSize) AS max_cards
FROM sets
JOIN set_translations ON sets.code = set_translations.setCode
WHERE set_translations.language = 'Russian'
GROUP BY name
ORDER BY max_cards DESC
LIMIT 1;
```
-------------------------9861 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN f.language = 'Chinese Simplified' AND c.isOnlineOnly = 1 THEN 1 END) * 100.0) / 
    COUNT(*) AS percentage
FROM 
    cards c
JOIN 
    foreign_data f ON c.uuid = f.uuid;
```
-------------------------9862 sample_num
```sql
SELECT COUNT(*) 
FROM sets 
WHERE language = 'Japanese' 
AND (mtgoCode IS NULL OR mtgoCode = '');
```
-------------------------9863 sample_num
```sql
SELECT id FROM cards WHERE borderColor = 'black';
```
-------------------------9864 sample_num
```sql
SELECT id FROM cards WHERE frameEffects = 'extendedart';
```
-------------------------9865 sample_num
```sql
SELECT * FROM cards WHERE borderColor = 'black' AND isFullArt = 1;
```
-------------------------9866 sample_num
```sql
SELECT DISTINCT language FROM set_translations WHERE setCode = '174';
```
-------------------------9867 sample_num
```sql
SELECT name FROM sets WHERE code = 'ALL';
```
-------------------------9868 sample_num
```sql
SELECT DISTINCT foreign_data.language 
FROM foreign_data 
JOIN cards ON foreign_data.multiverseid = cards.multiverseId 
WHERE cards.name = 'A Pedra Fellwar';
```
-------------------------9869 sample_num
```sql
SELECT code FROM sets WHERE releaseDate = '2007-07-13';
```
-------------------------9870 sample_num
```sql
SELECT baseSetSize, code 
FROM sets 
WHERE block IN ('Masques', 'Mirage');
```
-------------------------9871 sample_num
```sql
SELECT code FROM sets WHERE type = 'expansion';
```
-------------------------9872 sample_num
```sql
SELECT fd.name, c.type
FROM cards c
JOIN foreign_data fd ON c.uuid = fd.uuid
WHERE c.watermark = 'boros';
```
-------------------------9873 sample_num
```sql
SELECT fd.language, fd.flavorText, c.type
FROM cards c
JOIN foreign_data fd ON c.uuid = fd.uuid
WHERE c.watermark = 'colorpie';
```
-------------------------9874 sample_num
```sql
SELECT (COUNT(CASE WHEN convertedManaCost = 10 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM cards
WHERE setCode = (SELECT code FROM sets WHERE name = 'Abyssal Horror');
```
-------------------------9875 sample_num
```sql
SELECT code FROM sets WHERE type = 'expansion' AND name LIKE '%Commander%';
```
-------------------------9876 sample_num
```sql
SELECT fd.name, c.type 
FROM cards c 
JOIN foreign_data fd ON c.uuid = fd.uuid 
WHERE c.watermark = 'abzan';
```
-------------------------9877 sample_num
```sql
SELECT fd.language, c.type
FROM cards c
JOIN foreign_data fd ON c.uuid = fd.uuid
WHERE c.watermark = 'azorius';
```
-------------------------9878 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE artist = 'Aaron Miller' 
AND cardKingdomFoilId = cardKingdomId 
AND cardKingdomId IS NOT NULL;
```
-------------------------9879 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE availability LIKE '%paper%' AND hand LIKE '+%';
```
-------------------------9880 sample_num
```sql
SELECT name FROM cards WHERE isTextless = 0;
```
-------------------------9881 sample_num
```sql
SELECT convertedManaCost FROM cards WHERE name = 'Ancestor\'s Chosen';
```
-------------------------9882 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE borderColor = 'white' AND (power = '*' OR power IS NULL);
```
-------------------------9883 sample_num
```sql
SELECT name 
FROM cards 
WHERE isPromo = 1 AND side IS NOT NULL;
```
-------------------------9884 sample_num
```sql
SELECT subtypes, supertypes 
FROM cards 
WHERE name = 'Molimo, Maro-Sorcerer';
```
-------------------------9885 sample_num
```sql
SELECT purchaseUrls 
FROM cards 
WHERE promoTypes = 'bundle';
```
-------------------------9886 sample_num
```sql
SELECT COUNT(DISTINCT artist) 
FROM cards 
WHERE borderColor = 'black' 
AND availability LIKE '%arena,mtgo%';
```
-------------------------9887 sample_num
```sql
SELECT name, convertedManaCost 
FROM cards 
WHERE name IN ('Serra Angel', 'Shrine Keeper');
```
-------------------------9888 sample_num
```sql
SELECT artist 
FROM cards 
WHERE flavorName = 'Battra, Dark Destroyer';
```
-------------------------9889 sample_num
```sql
SELECT name 
FROM cards 
WHERE frameVersion = '2003' 
ORDER BY convertedManaCost DESC 
LIMIT 3;
```
-------------------------9890 sample_num
```sql
SELECT st.translation 
FROM cards c 
JOIN sets s ON c.setCode = s.code 
JOIN set_translations st ON s.code = st.setCode 
WHERE c.name = 'Ancestor\'s Chosen' AND st.language = 'Italian';
```
-------------------------9891 sample_num
```sql
SELECT COUNT(st.id) 
FROM set_translations st 
JOIN cards c ON st.setCode = c.setCode 
WHERE c.name = 'Angel of Mercy';
```
-------------------------9892 sample_num
```sql
SELECT c.name 
FROM cards c 
JOIN sets s ON c.setCode = s.code 
JOIN set_translations st ON s.code = st.setCode 
WHERE st.translation = 'Hauptset Zehnte Edition';
```
-------------------------9893 sample_num
```sql
SELECT COUNT(*) > 0 AS has_korean_version
FROM foreign_data fd
JOIN cards c ON fd.uuid = c.uuid
WHERE c.name = 'Ancestor\'s Chosen' AND fd.language = 'Korean';
```
-------------------------9894 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
JOIN sets ON cards.setCode = sets.code 
JOIN set_translations ON sets.code = set_translations.setCode 
WHERE set_translations.translation = 'Hauptset Zehnte Edition' 
AND cards.artist = 'Adam Rex';
```
-------------------------9895 sample_num
```sql
SELECT baseSetSize 
FROM sets 
WHERE id = (SELECT setCode FROM set_translations WHERE translation = 'Hauptset Zehnte Edition');
```
-------------------------9896 sample_num
```sql
SELECT translation 
FROM set_translations 
WHERE setCode = (SELECT code FROM sets WHERE name = 'Eighth Edition') 
AND language = 'Simplified Chinese';
```
-------------------------9897 sample_num
```sql
SELECT s.name 
FROM cards c 
JOIN sets s ON c.setCode = s.code 
WHERE c.name = 'Angel of Mercy' AND s.mtgoCode IS NOT NULL;
```
-------------------------9898 sample_num
```sql
SELECT s.releaseDate 
FROM cards c 
JOIN sets s ON c.setCode = s.code 
WHERE c.name = 'Ancestor''s Chosen';
```
-------------------------9899 sample_num
```sql
SELECT type FROM sets 
WHERE code = (SELECT setCode FROM set_translations 
              WHERE translation = 'Hauptset Zehnte Edition');
```
-------------------------9900 sample_num
```sql
SELECT COUNT(*) 
FROM sets s
JOIN set_translations st ON s.code = st.setCode
WHERE s.block = 'Ice Age' AND st.language = 'Italian';
```
-------------------------9901 sample_num
```sql
SELECT s.isForeignOnly 
FROM cards c 
JOIN sets s ON c.setCode = s.code 
WHERE c.name = 'Adarkar Valkyrie';
```
-------------------------9902 sample_num
```sql
SELECT COUNT(DISTINCT s.id) 
FROM sets s 
JOIN set_translations st ON s.code = st.setCode 
WHERE st.language = 'Italian' AND st.translation IS NOT NULL 
AND s.baseSetSize < 10;
```
-------------------------9903 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE setCode = 'Coldsnap' AND borderColor = 'black';
```
-------------------------9904 sample_num
```sql
SELECT c.name
FROM cards c
JOIN sets s ON c.setCode = s.code
WHERE s.name = 'Coldsnap'
ORDER BY c.convertedManaCost DESC
LIMIT 1;
```
-------------------------9905 sample_num
```sql
SELECT DISTINCT artist 
FROM cards 
WHERE setCode = 'Coldsnap' AND artist IN ('Jeremy Jarvis', 'Aaron Miller', 'Chippy');
```
-------------------------9906 sample_num
```sql
SELECT * FROM cards WHERE setCode = 'Coldsnap' AND number = '4';
```
-------------------------9907 sample_num
```sql
SELECT COUNT(*)
FROM cards T1
JOIN sets T2 ON T1.setCode = T2.code
WHERE T2.name = 'Coldsnap' AND T1.convertedManaCost > 5 AND (T1.power = '*' OR T1.power IS NULL);
```
-------------------------9908 sample_num
```sql
SELECT flavorText FROM foreign_data WHERE language = 'Italian' AND name = 'Ancestor''s Chosen';
```
-------------------------9909 sample_num
```sql
SELECT DISTINCT foreign_data.language
FROM foreign_data
JOIN cards ON foreign_data.multiverseid = cards.multiverseId
WHERE cards.name = 'Ancestor''s Chosen' AND foreign_data.flavorText IS NOT NULL;
```
-------------------------9910 sample_num
```sql
SELECT type FROM foreign_data WHERE name = 'Ancestor''s Chosen' AND language = 'German';
```
-------------------------9911 sample_num
```sql
SELECT r.text 
FROM rulings r
JOIN cards c ON r.uuid = c.uuid
JOIN sets s ON c.setCode = s.code
WHERE s.name = 'Coldsnap' AND r.language = 'Italian';
```
-------------------------9912 sample_num
```sql
SELECT fd.name
FROM cards c
JOIN foreign_data fd ON c.uuid = fd.uuid
JOIN sets s ON c.setCode = s.code
WHERE s.name = 'Coldsnap' AND fd.language = 'Italian'
AND c.convertedManaCost = (
    SELECT MAX(convertedManaCost)
    FROM cards
    WHERE setCode = 'COLD'
);
```
-------------------------9913 sample_num
```sql
SELECT date FROM rulings WHERE uuid IN (SELECT uuid FROM cards WHERE name = 'Reminisce');
```
-------------------------9914 sample_num
```sql
SELECT (SUM(CASE WHEN convertedManaCost = 7 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS percentage
FROM cards
WHERE setCode = (SELECT code FROM sets WHERE name = 'Coldsnap');
```
-------------------------9915 sample_num
```sql
SELECT 
    (SUM(CASE WHEN cardKingdomFoilId = cardKingdomId AND cardKingdomId IS NOT NULL THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS percentage_incredibly_powerful
FROM 
    cards
WHERE 
    setCode = 'Coldsnap';
```
-------------------------9916 sample_num
```sql
SELECT code FROM sets WHERE releaseDate = '2017-07-14';
```
-------------------------9917 sample_num
```sql
SELECT keyruneCode FROM sets WHERE code = 'PKHC';
```
-------------------------9918 sample_num
```sql
SELECT mcmId FROM sets WHERE code = 'SS2';
```
-------------------------9919 sample_num
```sql
SELECT mcmName FROM sets WHERE releaseDate = '2017-06-09';
```
-------------------------9920 sample_num
```sql
SELECT type FROM sets WHERE name LIKE '%From the Vault: Lore%';
```
-------------------------9921 sample_num
```sql
SELECT parentCode FROM sets WHERE name = 'Commander 2014 Oversized';
```
-------------------------9922 sample_num
```sql
SELECT c.name, c.id, r.text AS ruling_text, 
       CASE WHEN c.hasContentWarning = 1 THEN 'Missing or degraded properties and values' 
            ELSE 'No missing or degraded properties and values' END AS properties_status
FROM cards c
JOIN rulings r ON c.uuid = r.uuid
WHERE c.artist = 'Jim Pavelec';
```
-------------------------9923 sample_num
```sql
SELECT s.releaseDate 
FROM cards c 
JOIN sets s ON c.setCode = s.code 
WHERE c.name = 'Evacuation';
```
-------------------------9924 sample_num
```sql
SELECT baseSetSize 
FROM sets 
WHERE id = (SELECT setCode FROM set_translations WHERE translation = 'Rinascita di Alara');
```
-------------------------9925 sample_num
```sql
SELECT type FROM sets 
WHERE code IN (SELECT setCode FROM set_translations WHERE translation = 'Huitième édition');
```
-------------------------9926 sample_num
```sql
SELECT st.translation 
FROM cards c 
JOIN sets s ON c.setCode = s.code 
JOIN set_translations st ON s.code = st.setCode 
WHERE c.name = 'Tendo Ice Bridge' AND st.language = 'French';
```
-------------------------9927 sample_num
```sql
SELECT COUNT(*) 
FROM set_translations 
WHERE setCode = (SELECT code FROM sets WHERE name = 'Salvat 2011') 
AND translation IS NOT NULL;
```
-------------------------9928 sample_num
```sql
SELECT st.translation 
FROM sets s 
JOIN cards c ON s.code = c.setCode 
JOIN set_translations st ON s.code = st.setCode 
WHERE c.name = 'Fellwar Stone' AND st.language = 'Japanese';
```
-------------------------9929 sample_num
```sql
SELECT name 
FROM cards 
WHERE setCode = 'Journey into Nyx Hero''s Path' 
ORDER BY convertedManaCost DESC 
LIMIT 1;
```
-------------------------9930 sample_num
```sql
SELECT s.releaseDate 
FROM sets s 
JOIN set_translations st ON s.code = st.setCode 
WHERE st.translation = 'Ola de frío';
```
-------------------------9931 sample_num
```sql
SELECT sets.type 
FROM sets 
JOIN cards ON sets.code = cards.setCode 
WHERE cards.name = 'Samite Pilgrim';
```
-------------------------9932 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE convertedManaCost = 3 
AND setCode = (SELECT code FROM sets WHERE name = 'World Championship Decks 2004');
```
-------------------------9933 sample_num
```sql
SELECT translation 
FROM set_translations 
WHERE language = 'Chinese Simplified' 
AND setCode = (SELECT code FROM sets WHERE name = 'Mirrodin');
```
-------------------------9934 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.isNonFoilOnly = 1 THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS percentage_non_foil
FROM 
    cards c
JOIN 
    set_translations st ON c.setCode = st.setCode
WHERE 
    st.language = 'Japanese';
```
-------------------------9935 sample_num
```sql
SELECT 
    (SUM(CASE WHEN c.isOnlineOnly = 1 THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS percentage_online_only
FROM 
    cards c
JOIN 
    foreign_data f ON c.name = f.name
WHERE 
    f.language = 'Portuguese (Brazil)';
```
-------------------------9936 sample_num
```sql
SELECT DISTINCT availability 
FROM cards 
WHERE artist = 'Aleksi Briclot' AND isTextless = 1;
```
-------------------------9937 sample_num
```sql
SELECT id 
FROM sets 
WHERE baseSetSize = (SELECT MAX(baseSetSize) FROM sets);
```
-------------------------9938 sample_num
```sql
SELECT artist 
FROM cards 
WHERE otherFaceIds IS NULL 
ORDER BY convertedManaCost DESC 
LIMIT 1;
```
-------------------------9939 sample_num
```sql
SELECT frameEffects, COUNT(*) as count
FROM cards
WHERE cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL
GROUP BY frameEffects
ORDER BY count DESC
LIMIT 1;
```
-------------------------9940 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE (power IS NULL OR power = '*') 
AND hasFoil = 0 
AND duelDeck = 'a';
```
-------------------------9941 sample_num
```sql
SELECT id 
FROM sets 
WHERE type = 'commander' 
ORDER BY totalSetSize DESC 
LIMIT 1;
```
-------------------------9942 sample_num
```sql
SELECT c.name, MAX(c.convertedManaCost) AS highest_unconverted_mana_cost
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE l.format = 'duel'
GROUP BY c.name
ORDER BY highest_unconverted_mana_cost DESC
LIMIT 10;
```
-------------------------9943 sample_num
```sql
SELECT MIN(c.originalReleaseDate) AS oldest_mythic_release_date, l.format
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE c.rarity = 'mythic' AND l.status = 'legal'
GROUP BY l.format;
```
-------------------------9944 sample_num
```sql
SELECT COUNT(*) 
FROM cards c
JOIN foreign_data f ON c.id = f.multiverseid
WHERE c.artist = 'Volkan Baga' AND f.language = 'French';
```
-------------------------9945 sample_num
```sql
SELECT COUNT(*) 
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE c.rarity = 'rare' 
  AND 'Enchantment' IN (SELECT unnest(c.types)) 
  AND c.name = 'Abundance' 
  AND l.status = 'Legal'
GROUP BY c.uuid
HAVING COUNT(DISTINCT l.format) = (SELECT COUNT(DISTINCT format) FROM legalities WHERE uuid = c.uuid);
```
-------------------------9946 sample_num
```sql
SELECT l.format, c.name
FROM legalities l
JOIN cards c ON l.uuid = c.uuid
WHERE l.status = 'banned'
GROUP BY l.format, c.name
HAVING COUNT(*) = (
    SELECT MAX(banned_count)
    FROM (
        SELECT COUNT(*) AS banned_count
        FROM legalities
        WHERE status = 'banned'
        GROUP BY format
    ) AS banned_counts
);
```
-------------------------9947 sample_num
```sql
SELECT DISTINCT st.language 
FROM sets s 
JOIN set_translations st ON s.code = st.setCode 
WHERE s.name = 'Battlebond';
```
-------------------------9948 sample_num
```sql
SELECT l.format, c.artist
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE c.artist = (
    SELECT artist
    FROM cards
    GROUP BY artist
    ORDER BY COUNT(*) ASC
    LIMIT 1
);
```
-------------------------9949 sample_num
```sql
SELECT l.status 
FROM cards c 
JOIN legalities l ON c.uuid = l.uuid 
WHERE c.frameVersion = '1997' 
  AND c.artist = 'D. Alexander Gregory' 
  AND c.hasContentWarning = 1 
  AND l.format = 'legacy';
```
-------------------------9950 sample_num
```sql
SELECT c.name, l.format
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE c.edhrecRank = 1 AND l.status = 'banned';
```
-------------------------9951 sample_num
```sql
SELECT AVG(set_count) AS annual_average_sets, common_language
FROM (
    SELECT YEAR(releaseDate) AS release_year, COUNT(*) AS set_count
    FROM sets
    WHERE releaseDate BETWEEN '2012-01-01' AND '2015-12-31'
    GROUP BY release_year
) AS yearly_sets
CROSS JOIN (
    SELECT language, COUNT(*) AS lang_count
    FROM foreign_data
    GROUP BY language
    ORDER BY lang_count DESC
    LIMIT 1
) AS common_lang;
```
-------------------------9952 sample_num
```sql
SELECT DISTINCT artist 
FROM cards 
WHERE borderColor = 'black' AND availability = 'arena';
```
-------------------------9953 sample_num
```sql
SELECT c.uuid 
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE l.format = 'oldschool' AND (l.status = 'banned' OR l.status = 'restricted');
```
-------------------------9954 sample_num
```sql
SELECT COUNT(*) 
FROM cards 
WHERE artist = 'Matthew D. Wilson' AND availability = 'paper';
```
-------------------------9955 sample_num
```sql
SELECT r.text 
FROM rulings r 
JOIN cards c ON r.uuid = c.uuid 
WHERE c.artist = 'Kev Walker' 
ORDER BY r.date DESC;
```
-------------------------9956 sample_num
```sql
SELECT c.name, l.format
FROM cards c
JOIN sets s ON c.setCode = s.code
JOIN legalities l ON c.uuid = l.uuid
WHERE s.name = 'Hour of Devastation' AND l.status = 'legal';
```
-------------------------9957 sample_num
```sql
SELECT s.name
FROM sets s
LEFT JOIN set_translations st ON s.code = st.setCode
GROUP BY s.id
HAVING SUM(st.language = 'Korean') > 0 AND SUM(st.language LIKE '%Japanese%') = 0;
```
-------------------------9958 sample_num
```sql
SELECT DISTINCT c.frameVersion, c.name
FROM cards c
JOIN legalities l ON c.uuid = l.uuid
WHERE c.artist = 'Allen Williams' OR l.status = 'banned';
```
-------------------------9959 sample_num
```sql
SELECT DisplayName, Reputation 
FROM users 
WHERE DisplayName IN ('Harlan', 'Jarrod Dixon') 
ORDER BY Reputation DESC 
LIMIT 1;
```
-------------------------9960 sample_num
```sql
SELECT DisplayName 
FROM users 
WHERE YEAR(CreationDate) = 2014;
```
-------------------------9961 sample_num
```sql
SELECT COUNT(*) 
FROM users 
WHERE LastAccessDate > '2014-09-01 00:00:00';
```
-------------------------9962 sample_num
```sql
SELECT DisplayName 
FROM users 
WHERE Views = (SELECT MAX(Views) FROM users);
```
-------------------------9963 sample_num
```sql
SELECT COUNT(*) 
FROM users 
WHERE UpVotes > 100 AND DownVotes > 1;
```
-------------------------9964 sample_num
```sql
SELECT COUNT(*) 
FROM users 
WHERE Views > 10 AND CreationDate > '2013-01-01';
```
-------------------------9965 sample_num
```sql
SELECT COUNT(*) 
FROM posts 
WHERE OwnerDisplayName = 'csgillespie';
```
-------------------------9966 sample_num
```sql
SELECT Title 
FROM posts 
WHERE OwnerDisplayName = 'csgillespie';
```
-------------------------9967 sample_num
```sql
SELECT DisplayName 
FROM users 
WHERE Id = (SELECT OwnerUserId 
             FROM posts 
             WHERE Title = 'Eliciting priors from experts');
```
-------------------------9968 sample_num
```sql
SELECT Title 
FROM posts 
WHERE OwnerDisplayName = 'csgillespie' 
ORDER BY ViewCount DESC 
LIMIT 1;
```
-------------------------9969 sample_num
```sql
SELECT u.DisplayName
FROM posts p
JOIN users u ON p.OwnerUserId = u.Id
WHERE p.FavoriteCount = (SELECT MAX(FavoriteCount) FROM posts);
```
-------------------------9970 sample_num
```sql
SELECT SUM(CommentCount) AS TotalComments
FROM posts
WHERE OwnerDisplayName = 'csgillespie';
```
-------------------------9971 sample_num
```sql
SELECT AnswerCount 
FROM posts 
WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie') 
ORDER BY AnswerCount DESC 
LIMIT 1;
```
-------------------------9972 sample_num
```sql
SELECT u.DisplayName 
FROM posts p 
JOIN users u ON p.LastEditorUserId = u.Id 
WHERE p.Title = 'Examples for teaching: Correlation does not mean causation';
```
-------------------------9973 sample_num
```sql
SELECT COUNT(*) AS RootPostCount
FROM posts
WHERE OwnerDisplayName = 'csgillespie' AND ParentId IS NULL;
```
-------------------------9974 sample_num
```sql
SELECT DISTINCT u.DisplayName
FROM users u
JOIN posts p ON u.Id = p.OwnerUserId
WHERE p.ClosedDate IS NOT NULL;
```
-------------------------9975 sample_num
```sql
SELECT COUNT(*) 
FROM posts p
JOIN users u ON p.OwnerUserId = u.Id
WHERE u.Age > 65 AND p.Score >= 20;
```
-------------------------9976 sample_num
```sql
SELECT u.Location 
FROM posts p 
JOIN users u ON p.OwnerUserId = u.Id 
WHERE p.Title = 'Eliciting priors from experts';
```
-------------------------9977 sample_num
```sql
SELECT p.Body
FROM posts p
JOIN tags t ON t.ExcerptPostId = p.Id
WHERE t.TagName = 'bayesian';
```
-------------------------9978 sample_num
```sql
SELECT p.Body
FROM posts p
JOIN tags t ON t.ExcerptPostId = p.Id
WHERE t.Count = (SELECT MAX(Count) FROM tags);
```
-------------------------9979 sample_num
```sql
SELECT COUNT(*) AS BadgeCount
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE u.DisplayName = 'csgillespie';
```
-------------------------9980 sample_num
```sql
SELECT b.Name 
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE u.DisplayName = 'csgillespie';
```
-------------------------9981 sample_num
```sql
SELECT COUNT(*) 
FROM badges 
WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie') 
AND YEAR(Date) = 2011;
```
-------------------------9982 sample_num
```sql
SELECT DisplayName 
FROM users 
WHERE Id = (
    SELECT UserId 
    FROM badges 
    GROUP BY UserId 
    ORDER BY COUNT(Id) DESC 
    LIMIT 1
);
```
-------------------------9983 sample_num
```sql
SELECT AVG(Score) AS AverageScore
FROM posts
WHERE OwnerDisplayName = 'csgillespie';
```
-------------------------9984 sample_num
```sql
SELECT AVG(badge_count) AS average_badges
FROM (
    SELECT u.Id, COUNT(b.Id) AS badge_count
    FROM users u
    LEFT JOIN badges b ON u.Id = b.UserId
    WHERE u.Views > 200
    GROUP BY u.Id
) AS user_badge_counts;
```
-------------------------9985 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN u.Age > 65 THEN p.Id END) * 100.0 / COUNT(p.Id)) AS ElderUserPercentage
FROM 
    posts p
JOIN 
    users u ON p.OwnerUserId = u.Id
WHERE 
    p.Score > 20;
```
-------------------------9986 sample_num
```sql
SELECT COUNT(*) 
FROM votes 
WHERE UserId = 58 AND DATE(CreationDate) = '2010-07-19';
```
-------------------------9987 sample_num
```sql
SELECT CreationDate
FROM votes
GROUP BY CreationDate
ORDER BY COUNT(Id) DESC
LIMIT 1;
```
-------------------------9988 sample_num
```sql
SELECT COUNT(*) AS RevivalBadgeCount 
FROM badges 
WHERE Name = 'Revival';
```
-------------------------9989 sample_num
```sql
SELECT p.Title
FROM posts p
JOIN comments c ON p.Id = c.PostId
WHERE c.Score = (SELECT MAX(Score) FROM comments);
```
-------------------------9990 sample_num
```sql
SELECT COUNT(*) AS CommentCount
FROM comments
WHERE PostId = (SELECT Id FROM posts WHERE ViewCount = 1910);
```
-------------------------9991 sample_num
```sql
SELECT FavoriteCount 
FROM posts 
WHERE Id = (SELECT PostId 
            FROM comments 
            WHERE UserId = '3025' 
            AND CreationDate = '2014-04-23 20:29:39.0');
```
-------------------------9992 sample_num
```sql
SELECT Text 
FROM comments 
WHERE PostId = (SELECT Id FROM posts WHERE ParentId = 107829) 
LIMIT 1;
```
-------------------------9993 sample_num
```sql
SELECT CASE 
           WHEN p.ClosedDate IS NULL THEN 'Yes' 
           ELSE 'No' 
       END AS IsWellFinished
FROM comments c
JOIN posts p ON c.PostId = p.Id
WHERE c.UserId = '23853' 
  AND c.CreationDate = '2013-07-12 09:08:18.0';
```
-------------------------9994 sample_num
```sql
SELECT u.Reputation
FROM posts p
JOIN users u ON p.OwnerUserId = u.Id
WHERE p.Id = 65041;
```
-------------------------9995 sample_num
```sql
SELECT COUNT(*) AS PostCount
FROM posts
WHERE OwnerDisplayName = 'Tiago Pasqualini';
```
-------------------------9996 sample_num
```sql
SELECT u.DisplayName 
FROM votes v 
JOIN users u ON v.UserId = u.Id 
WHERE v.Id = 6347;
```
-------------------------9997 sample_num
```sql
SELECT COUNT(*) AS VoteCount
FROM votes
WHERE PostId IN (
    SELECT Id
    FROM posts
    WHERE Title LIKE '%data visualization%'
);
```
-------------------------9998 sample_num
```sql
SELECT b.Name 
FROM badges b 
JOIN users u ON b.UserId = u.Id 
WHERE u.DisplayName = 'DatEpicCoderGuyWhoPrograms';
```
-------------------------9999 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM posts WHERE OwnerUserId = 24) / 
    NULLIF((SELECT COUNT(*) FROM votes WHERE UserId = 24), 0) AS PostVoteRatio
```
-------------------------10000 sample_num
```sql
SELECT ViewCount 
FROM posts 
WHERE Title = 'Integration of Weka and/or RapidMiner into Informatica PowerCenter/Developer';
```
-------------------------10001 sample_num
```sql
SELECT Text FROM comments WHERE Score = 17;
```
-------------------------10002 sample_num
```sql
SELECT DisplayName 
FROM users 
WHERE WebsiteUrl = 'http://stackoverflow.com';
```
-------------------------10003 sample_num
```sql
SELECT b.Name 
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE u.DisplayName = 'SilentGhost';
```
-------------------------10004 sample_num
```sql
SELECT UserDisplayName 
FROM comments 
WHERE Text = 'thank you user93!';
```
-------------------------10005 sample_num
```sql
SELECT Text 
FROM comments 
WHERE UserDisplayName = 'A Lion.';
```
-------------------------10006 sample_num
```sql
SELECT u.DisplayName, u.Reputation
FROM posts p
JOIN users u ON p.OwnerUserId = u.Id
WHERE p.Title = 'Understanding what Dassault iSight is doing?';
```
-------------------------10007 sample_num
```sql
SELECT c.Text 
FROM comments c 
JOIN posts p ON c.PostId = p.Id 
WHERE p.Title = 'How does gentle boosting differ from AdaBoost?';
```
-------------------------10008 sample_num
```sql
SELECT u.DisplayName
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE b.Name = 'Necromancer'
LIMIT 10;
```
-------------------------10009 sample_num
```sql
SELECT LastEditorDisplayName 
FROM posts 
WHERE Title = 'Open source tools for visualizing multi-dimensional data';
```
-------------------------10010 sample_num
```sql
SELECT Title 
FROM posts 
WHERE LastEditorDisplayName = 'Vebjorn Ljosa';
```
-------------------------10011 sample_num
```sql
SELECT SUM(p.Score) AS TotalScore, u.WebsiteUrl
FROM posts p
JOIN users u ON p.LastEditorUserId = u.Id
WHERE u.DisplayName = 'Yevgeny';
```
-------------------------10012 sample_num
```sql
SELECT c.*
FROM comments c
JOIN posts p ON c.PostId = p.Id
WHERE p.Title = 'Why square the difference instead of taking the absolute value in standard deviation?'
AND p.LastEditorUserId IS NOT NULL;
```
-------------------------10013 sample_num
```sql
SELECT SUM(v.BountyAmount) AS TotalBountyAmount
FROM posts p
JOIN votes v ON p.Id = v.PostId
WHERE p.Title LIKE '%data%';
```
-------------------------10014 sample_num
```sql
SELECT u.DisplayName
FROM votes v
JOIN posts p ON v.PostId = p.Id
JOIN users u ON v.UserId = u.Id
WHERE v.BountyAmount = 50 AND p.Title LIKE '%variance%';
```
-------------------------10015 sample_num
```sql
SELECT p.Title, c.Text, c.Score, AVG(p.ViewCount) AS AverageViewCount
FROM posts p
JOIN tags t ON p.Tags LIKE CONCAT('%', t.TagName, '%')
LEFT JOIN comments c ON p.Id = c.PostId
WHERE t.TagName = 'humor'
GROUP BY p.Id, c.Id;
```
-------------------------10016 sample_num
```sql
SELECT COUNT(*) AS TotalComments
FROM comments
WHERE UserId = 13;
```
-------------------------10017 sample_num
```sql
SELECT Id FROM users ORDER BY Reputation DESC LIMIT 1;
```
-------------------------10018 sample_num
```sql
SELECT Id FROM users ORDER BY Views ASC LIMIT 1;
```
-------------------------10019 sample_num
```sql
SELECT COUNT(DISTINCT UserId) AS SupporterBadgeCount
FROM badges
WHERE Name = 'Supporter' AND YEAR(Date) = 2011;
```
-------------------------10020 sample_num
```sql
SELECT COUNT(DISTINCT UserId) AS UserCount
FROM badges
GROUP BY UserId
HAVING COUNT(Name) > 5;
```
-------------------------10021 sample_num
```sql
SELECT COUNT(DISTINCT u.Id) AS UserCount
FROM users u
JOIN badges b1 ON u.Id = b1.UserId AND b1.Name = 'Supporter'
JOIN badges b2 ON u.Id = b2.UserId AND b2.Name = 'Teacher'
WHERE u.Location = 'New York';
```
-------------------------10022 sample_num
```sql
SELECT u.DisplayName, u.Reputation
FROM posts p
JOIN users u ON p.OwnerUserId = u.Id
WHERE p.Id = 1;
```
-------------------------10023 sample_num
```sql
SELECT u.Id, u.DisplayName
FROM users u
JOIN posts p ON u.Id = p.OwnerUserId
JOIN postHistory ph ON p.Id = ph.PostId
GROUP BY u.Id, u.DisplayName, p.Id
HAVING COUNT(ph.Id) = 1 AND p.ViewCount >= 1000;
```
-------------------------10024 sample_num
```sql
SELECT u.DisplayName, COUNT(c.Id) AS CommentCount, b.Name AS BadgeName
FROM users u
JOIN comments c ON u.Id = c.UserId
LEFT JOIN badges b ON u.Id = b.UserId
GROUP BY u.Id, b.Name
HAVING COUNT(c.Id) = (
    SELECT MAX(CommentCount)
    FROM (
        SELECT COUNT(Id) AS CommentCount
        FROM comments
        GROUP BY UserId
    ) AS subquery
)
ORDER BY u.DisplayName;
```
-------------------------10025 sample_num
```sql
SELECT COUNT(DISTINCT u.Id) AS UserCount
FROM users u
JOIN badges b ON u.Id = b.UserId
WHERE u.Location = 'India' AND b.Name = 'Teacher';
```
-------------------------10026 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN YEAR(Date) = 2010 THEN 1 END) * 100.0 / COUNT(Name)) - 
    (COUNT(CASE WHEN YEAR(Date) = 2011 THEN 1 END) * 100.0 / COUNT(Name)) AS PercentageDifference
FROM 
    badges
WHERE 
    Name = 'Students';
```
-------------------------10027 sample_num
```sql
SELECT PostHistoryTypeId FROM postHistory WHERE PostId = 3720;

SELECT COUNT(DISTINCT UserId) FROM comments WHERE PostId = 3720;
```
-------------------------10028 sample_num
```sql
SELECT p.Id, p.Title, p.ViewCount
FROM posts p
JOIN postLinks pl ON p.Id = pl.RelatedPostId
WHERE pl.PostId = 61217;
```
-------------------------10029 sample_num
```sql
SELECT p.Score, pl.LinkTypeId
FROM posts p
JOIN postLinks pl ON p.Id = pl.PostId
WHERE p.Id = 395;
```
-------------------------10030 sample_num
```sql
SELECT Id AS PostId, OwnerUserId AS UserId
FROM posts
WHERE Score > 60;
```
-------------------------10031 sample_num
```sql
SELECT SUM(FavoriteCount) 
FROM posts 
WHERE OwnerUserId = 686 AND YEAR(CreaionDate) = 2011;
```
-------------------------10032 sample_num
```sql
SELECT 
    AVG(UpVotes) AS AverageUpVotes, 
    AVG(Age) AS AverageAge
FROM 
    users 
WHERE 
    Id IN (
        SELECT OwnerUserId 
        FROM posts 
        GROUP BY OwnerUserId 
        HAVING COUNT(Id) > 10
    );
```
-------------------------10033 sample_num
```sql
SELECT COUNT(DISTINCT UserId) AS UserCount
FROM badges
WHERE Name = 'Announcer';
```
-------------------------10034 sample_num
```sql
SELECT Name FROM badges WHERE Date = '2010-07-19 19:39:08';
```
-------------------------10035 sample_num
```sql
SELECT COUNT(*) AS PositiveCommentCount
FROM comments
WHERE Score > 60;
```
-------------------------10036 sample_num
```sql
SELECT Text FROM comments WHERE CreationDate = '2010-07-19 19:25:47.0';
```
-------------------------10037 sample_num
```sql
SELECT COUNT(*) AS PostCount
FROM posts
WHERE Score = 10;
```
-------------------------10038 sample_num
```sql
SELECT b.Name
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE u.Reputation = (SELECT MAX(Reputation) FROM users);
```
-------------------------10039 sample_num
```sql
SELECT u.Reputation
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE b.Date = '2010-07-19 19:39:08.0';
```
-------------------------10040 sample_num
```sql
SELECT b.Name 
FROM badges b 
JOIN users u ON b.UserId = u.Id 
WHERE u.DisplayName = 'Pierre';
```
-------------------------10041 sample_num
```sql
SELECT b.Date
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE u.Location = 'Rochester, NY';
```
-------------------------10042 sample_num
```sql
SELECT 
    (COUNT(DISTINCT CASE WHEN b.Name = 'Teacher' THEN b.UserId END) * 100.0 / COUNT(DISTINCT u.Id)) AS TeacherBadgePercentage
FROM 
    users u
LEFT JOIN 
    badges b ON u.Id = b.UserId;
```
-------------------------10043 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN u.Age BETWEEN 13 AND 18 THEN 1 END) * 100.0 / COUNT(u.Id)) AS TeenagerPercentage
FROM 
    users u
JOIN 
    badges b ON u.Id = b.UserId
WHERE 
    b.Name = 'Organizer';
```
-------------------------10044 sample_num
```sql
SELECT Score 
FROM comments 
WHERE PostId = (SELECT Id FROM posts WHERE CreationDate = '2010-07-19 19:19:56.0');
```
-------------------------10045 sample_num
```sql
SELECT Text 
FROM comments 
WHERE CreationDate = '2010-07-19 19:37:33.0';
```
-------------------------10046 sample_num
```sql
SELECT u.Age
FROM users u
JOIN badges b ON u.Id = b.UserId
WHERE u.Location = 'Vienna, Austria';
```
-------------------------10047 sample_num
```sql
SELECT COUNT(DISTINCT u.Id) AS AdultSupporters
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE b.Name = 'Supporter' AND u.Age BETWEEN 19 AND 65;
```
-------------------------10048 sample_num
```sql
SELECT SUM(u.Views) AS TotalViews
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE b.Date = '2010-07-19 19:39:08.0';
```
-------------------------10049 sample_num
```sql
SELECT b.Name
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE u.Reputation = (SELECT MIN(Reputation) FROM users);
```
-------------------------10050 sample_num
```sql
SELECT b.Name 
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE u.DisplayName = 'Sharpie';
```
-------------------------10051 sample_num
```sql
SELECT COUNT(DISTINCT u.Id) AS ElderSupporters
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE b.Name = 'Supporter' AND u.Age > 65;
```
-------------------------10052 sample_num
```sql
SELECT DisplayName FROM users WHERE Id = 30;
```
-------------------------10053 sample_num
```sql
SELECT COUNT(*) FROM users WHERE Location = 'New York';
```
-------------------------10054 sample_num
```sql
SELECT COUNT(*) AS VoteCount
FROM votes
WHERE YEAR(CreationDate) = 2010;
```
-------------------------10055 sample_num
```sql
SELECT COUNT(*) AS AdultUserCount
FROM users
WHERE Age BETWEEN 19 AND 65;
```
-------------------------10056 sample_num
```sql
SELECT DisplayName, Views 
FROM users 
ORDER BY Views DESC 
LIMIT 1;
```
-------------------------10057 sample_num
```sql
SELECT 
    DIVIDE(COUNT(CASE WHEN YEAR(CreationDate) = 2010 THEN Id END), 
            COUNT(CASE WHEN YEAR(CreationDate) = 2011 THEN Id END)) AS VoteRatio
FROM votes;
```
-------------------------10058 sample_num
```sql
SELECT t.TagName 
FROM tags t
JOIN posts p ON t.Id = p.Tags
JOIN users u ON p.OwnerUserId = u.Id
WHERE u.DisplayName = 'John Stauffer';
```
-------------------------10059 sample_num
```sql
SELECT COUNT(*) 
FROM posts 
WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'Daniel Vassallo');
```
-------------------------10060 sample_num
```sql
SELECT COUNT(*) 
FROM votes 
WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'Harlan');
```
-------------------------10061 sample_num
```sql
SELECT Id 
FROM posts 
WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'slashnick') 
ORDER BY AnswerCount DESC 
LIMIT 1;
```
-------------------------10062 sample_num
```sql
SELECT OwnerDisplayName, SUM(ViewCount) AS TotalViewCount
FROM posts
WHERE OwnerDisplayName IN ('Harvey Motulsky', 'Noah Snyder')
GROUP BY OwnerDisplayName
ORDER BY TotalViewCount DESC
LIMIT 1;
```
-------------------------10063 sample_num
```sql
SELECT COUNT(DISTINCT p.Id) AS PostCount
FROM posts p
JOIN users u ON p.OwnerUserId = u.Id
JOIN votes v ON p.Id = v.PostId
WHERE u.DisplayName = 'Matt Parker'
GROUP BY p.Id
HAVING COUNT(v.Id) > 4;
```
-------------------------10064 sample_num
```sql
SELECT COUNT(*) 
FROM comments c
JOIN posts p ON c.PostId = p.Id
JOIN users u ON p.OwnerUserId = u.Id
WHERE c.Score < 60 AND u.DisplayName = 'Neil McGuigan';
```
-------------------------10065 sample_num
```sql
SELECT DISTINCT t.TagName
FROM tags t
JOIN posts p ON t.Id IN (SELECT value FROM STRING_SPLIT(p.Tags, ','))
JOIN users u ON p.OwnerUserId = u.Id
LEFT JOIN comments c ON p.Id = c.PostId
WHERE u.DisplayName = 'Mark Meckes' AND c.Id IS NULL;
```
-------------------------10066 sample_num
```sql
SELECT u.DisplayName
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE b.Name = 'Organizer';
```
-------------------------10067 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN t.TagName = 'r' THEN p.Id END) * 100.0 / COUNT(CASE WHEN u.DisplayName = 'Community' THEN p.Id END)) AS percentage
FROM 
    posts p
JOIN 
    users u ON p.OwnerUserId = u.Id
JOIN 
    postTags pt ON p.Id = pt.PostId
JOIN 
    tags t ON pt.TagId = t.Id
WHERE 
    u.DisplayName = 'Community';
```
-------------------------10068 sample_num
```sql
SELECT 
    (SELECT SUM(ViewCount) FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'Mornington') - 
    (SELECT SUM(ViewCount) FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'Amos') AS ViewCountDifference;
```
-------------------------10069 sample_num
```sql
SELECT COUNT(DISTINCT UserId) 
FROM badges 
WHERE Name = 'commentator' AND YEAR(Date) = 2014;
```
-------------------------10070 sample_num
```sql
SELECT COUNT(*) 
FROM posts 
WHERE CreationDate BETWEEN '2010-07-21 00:00:00' AND '2010-07-21 23:59:59';
```
-------------------------10071 sample_num
```sql
SELECT DisplayName, Age 
FROM users 
WHERE Views = (SELECT MAX(Views) FROM users);
```
-------------------------10072 sample_num
```sql
SELECT LastEditDate, LastEditorUserId 
FROM posts 
WHERE Title = 'Detecting a given face in a database of facial images';
```
-------------------------10073 sample_num
```sql
SELECT COUNT(*) 
FROM comments 
WHERE UserId = 13 AND Score < 60;
```
-------------------------10074 sample_num
```sql
SELECT p.Title, c.UserDisplayName
FROM posts p
JOIN comments c ON p.Id = c.PostId
WHERE c.Score > 60;
```
-------------------------10075 sample_num
```sql
SELECT b.Name 
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE YEAR(b.Date) = 2011 AND u.Location = 'North Pole';
```
-------------------------10076 sample_num
```sql
SELECT users.DisplayName, users.WebsiteUrl
FROM posts
JOIN users ON posts.OwnerUserId = users.Id
WHERE posts.FavoriteCount > 150;
```
-------------------------10077 sample_num
```sql
SELECT 
    p.Title,
    COUNT(ph.Id) AS PostHistoryCount,
    MAX(ph.CreationDate) AS LastEditDate
FROM 
    posts p
LEFT JOIN 
    postHistory ph ON p.Id = ph.PostId
WHERE 
    p.Title = 'What is the best introductory Bayesian statistics textbook?'
GROUP BY 
    p.Title;
```
-------------------------10078 sample_num
```sql
SELECT u.LastAccessDate, u.Location
FROM users u
JOIN badges b ON u.Id = b.UserId
WHERE b.Name = 'Outliers';
```
-------------------------10079 sample_num
```sql
SELECT p2.Title 
FROM posts p1
JOIN postLinks pl ON p1.Id = pl.PostId
JOIN posts p2 ON pl.RelatedPostId = p2.Id
WHERE p1.Title = 'How to tell if something happened in a data set which monitors a value over time';
```
-------------------------10080 sample_num
```sql
SELECT p.Id AS PostId, b.Name AS BadgeName
FROM posts p
JOIN users u ON p.OwnerUserId = u.Id
JOIN badges b ON u.Id = b.UserId
WHERE u.DisplayName = 'Samuel' AND YEAR(p.CreaionDate) = 2013 AND YEAR(b.Date) = 2013;
```
-------------------------10081 sample_num
```sql
SELECT OwnerDisplayName 
FROM posts 
WHERE ViewCount = (SELECT MAX(ViewCount) FROM posts);
```
-------------------------10082 sample_num
```sql
SELECT u.DisplayName, u.Location
FROM users u
JOIN posts p ON u.Id = p.OwnerUserId
JOIN tags t ON p.Id = t.ExcerptPostId
WHERE t.TagName = 'hypothesis-testing';
```
-------------------------10083 sample_num
```sql
SELECT pl.RelatedPostId, pl.LinkTypeId
FROM postLinks pl
JOIN posts p ON pl.PostId = p.Id
WHERE p.Title = 'What are principal component scores?';
```
-------------------------10084 sample_num
```sql
SELECT u.DisplayName
FROM posts p
JOIN users u ON p.OwnerUserId = u.Id
WHERE p.ParentId IS NOT NULL
ORDER BY p.Score DESC
LIMIT 1;
```
-------------------------10085 sample_num
```sql
SELECT u.DisplayName, u.WebsiteUrl
FROM votes v
JOIN users u ON v.UserId = u.Id
WHERE v.VoteTypeId = 8
AND v.BountyAmount = (SELECT MAX(BountyAmount) FROM votes WHERE VoteTypeId = 8);
```
-------------------------10086 sample_num
```sql
SELECT Title 
FROM posts 
ORDER BY ViewCount DESC 
LIMIT 5;
```
-------------------------10087 sample_num
```sql
SELECT COUNT(*) 
FROM tags 
WHERE Count BETWEEN 5000 AND 7000;
```
-------------------------10088 sample_num
```sql
SELECT OwnerUserId 
FROM posts 
WHERE FavoriteCount = (SELECT MAX(FavoriteCount) FROM posts);
```
-------------------------10089 sample_num
```sql
SELECT Age 
FROM users 
WHERE Reputation = (SELECT MAX(Reputation) FROM users);
```
-------------------------10090 sample_num
```sql
SELECT COUNT(DISTINCT p.Id) AS PostCount
FROM posts p
JOIN votes v ON p.Id = v.PostId
WHERE YEAR(p.CreaionDate) = 2011 AND v.BountyAmount = 50;
```
-------------------------10091 sample_num
```sql
SELECT Id FROM users WHERE Age = (SELECT MIN(Age) FROM users);
```
-------------------------10092 sample_num
```sql
SELECT p.Score
FROM posts p
JOIN tags t ON FIND_IN_SET(t.TagName, p.Tags)
WHERE t.Count = (SELECT MAX(Count) FROM tags);
```
-------------------------10093 sample_num
```sql
SELECT DIVIDE(COUNT(Id), 12) AS AverageMonthlyLinks
FROM postLinks
WHERE YEAR(CreationDate) = 2010
AND PostId IN (
    SELECT Id
    FROM posts
    WHERE AnswerCount <= 2
);
```
-------------------------10094 sample_num
```sql
SELECT PostId 
FROM votes 
WHERE UserId = 1465 
ORDER BY (SELECT FavoriteCount FROM posts WHERE Id = PostId) DESC 
LIMIT 1;
```
-------------------------10095 sample_num
```sql
SELECT p.Title
FROM posts p
JOIN postLinks pl ON p.Id = pl.PostId
WHERE pl.CreationDate = (SELECT MIN(CreationDate) FROM postLinks);
```
-------------------------10096 sample_num
```sql
SELECT u.DisplayName
FROM users u
JOIN badges b ON u.Id = b.UserId
GROUP BY u.Id
ORDER BY COUNT(b.Name) DESC
LIMIT 1;
```
-------------------------10097 sample_num
```sql
SELECT MIN(CreationDate) AS FirstVoteDate
FROM votes v
JOIN users u ON v.UserId = u.Id
WHERE u.DisplayName = 'chl';
```
-------------------------10098 sample_num
```sql
SELECT MIN(p.CreaionDate) AS FirstPostDate
FROM users u
JOIN posts p ON u.Id = p.OwnerUserId
WHERE u.Age = (SELECT MIN(Age) FROM users);
```
-------------------------10099 sample_num
```sql
SELECT u.DisplayName
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE b.Name = 'Autobiographer'
ORDER BY b.Date ASC
LIMIT 1;
```
-------------------------10100 sample_num
```sql
SELECT COUNT(DISTINCT u.Id) AS UserCount
FROM users u
JOIN posts p ON u.Id = p.OwnerUserId
WHERE u.Location = 'United Kingdom' AND p.FavoriteCount >= 4;
```
-------------------------10101 sample_num
```sql
SELECT AVG(vote_count) AS AveragePostsVoted
FROM (
    SELECT COUNT(v.PostId) AS vote_count
    FROM votes v
    JOIN users u ON v.UserId = u.Id
    WHERE u.Age = (SELECT MAX(Age) FROM users)
    GROUP BY u.Id
) AS user_votes;
```
-------------------------10102 sample_num
```sql
SELECT DisplayName 
FROM users 
WHERE Reputation = (SELECT MAX(Reputation) FROM users);
```
-------------------------10103 sample_num
```sql
SELECT COUNT(*) 
FROM users 
WHERE Reputation > 2000 AND Views > 1000;
```
-------------------------10104 sample_num
```sql
SELECT DisplayName FROM users WHERE Age BETWEEN 19 AND 65;
```
-------------------------10105 sample_num
```sql
SELECT COUNT(*) 
FROM posts 
WHERE OwnerDisplayName = 'Jay Stevens' AND YEAR(CreationDate) = 2010;
```
-------------------------10106 sample_num
```sql
SELECT Id, Title 
FROM posts 
WHERE OwnerDisplayName = 'Harvey Motulsky' 
ORDER BY ViewCount DESC 
LIMIT 1;
```
-------------------------10107 sample_num
```sql
SELECT Id, Title 
FROM posts 
WHERE Score = (SELECT MAX(Score) FROM posts);
```
-------------------------10108 sample_num
```sql
SELECT AVG(p.Score) AS AverageScore
FROM posts p
JOIN users u ON p.OwnerUserId = u.Id
WHERE u.DisplayName = 'Stephen Turner';
```
-------------------------10109 sample_num
```sql
SELECT DISTINCT u.DisplayName
FROM users u
JOIN posts p ON u.Id = p.OwnerUserId
WHERE p.ViewCount > 20000 AND YEAR(p.CreaionDate) = 2011;
```
-------------------------10110 sample_num
```sql
SELECT Id, OwnerDisplayName 
FROM posts 
WHERE YEAR(CreaionDate) = 2010 
ORDER BY FavoriteCount DESC 
LIMIT 1;
```
-------------------------10111 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.CreaionDate BETWEEN '2011-01-01' AND '2011-12-31' AND u.Reputation > 1000 THEN p.Id END) * 100.0) / 
    COUNT(CASE WHEN p.CreaionDate BETWEEN '2011-01-01' AND '2011-12-31' THEN p.Id END) AS percentage
FROM 
    posts p
JOIN 
    users u ON p.OwnerUserId = u.Id
WHERE 
    p.CreaionDate BETWEEN '2011-01-01' AND '2011-12-31';
```
-------------------------10112 sample_num
```sql
SELECT 
    DIVIDE(COUNT(CASE WHEN Age BETWEEN 13 AND 18 THEN Id END), COUNT(Id)) AS percentage
FROM 
    users;
```
-------------------------10113 sample_num
```sql
SELECT p.ViewCount, u.DisplayName
FROM posts p
JOIN users u ON p.LastEditorUserId = u.Id
WHERE p.Title = 'Computer Game Datasets';
```
-------------------------10114 sample_num
```sql
SELECT COUNT(*) AS TotalPostsAboveAverage
FROM posts
WHERE ViewCount > (SELECT AVG(ViewCount) FROM posts);
```
-------------------------10115 sample_num
```sql
SELECT COUNT(*) 
FROM comments 
WHERE PostId = (SELECT Id FROM posts ORDER BY Score DESC LIMIT 1);
```
-------------------------10116 sample_num
```sql
SELECT COUNT(*) 
FROM posts 
WHERE ViewCount > 35000 AND CommentCount = 0;
```
-------------------------10117 sample_num
```sql
SELECT u.DisplayName, u.Location
FROM posts p
JOIN users u ON p.LastEditorUserId = u.Id
WHERE p.Id = 183
ORDER BY p.LastEditDate DESC
LIMIT 1;
```
-------------------------10118 sample_num
```sql
SELECT Name 
FROM badges 
WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'Emmett') 
ORDER BY Date DESC 
LIMIT 1;
```
-------------------------10119 sample_num
```sql
SELECT COUNT(*) AS AdultUserCount
FROM users
WHERE Age BETWEEN 19 AND 65 AND UpVotes > 5000;
```
-------------------------10120 sample_num
```sql
SELECT DATEDIFF(b.Date, u.CreationDate) AS DaysToGetBadge
FROM badges b
JOIN users u ON b.UserId = u.Id
WHERE u.DisplayName = 'Zolomon';
```
-------------------------10121 sample_num
```sql
SELECT 
    COUNT(DISTINCT p.Id) AS PostCount, 
    COUNT(DISTINCT c.Id) AS CommentCount
FROM 
    users u
LEFT JOIN 
    posts p ON u.Id = p.OwnerUserId
LEFT JOIN 
    comments c ON u.Id = c.UserId
WHERE 
    u.CreationDate = (SELECT MAX(CreationDate) FROM users);
```
-------------------------10122 sample_num
```sql
SELECT c.Text, c.UserDisplayName
FROM comments c
JOIN posts p ON c.PostId = p.Id
WHERE p.Title = 'Analysing wind data with R'
ORDER BY c.CreationDate DESC
LIMIT 1;
```
-------------------------10123 sample_num
```sql
SELECT COUNT(*) AS UserCount
FROM badges
WHERE Name = 'Citizen Patrol';
```
-------------------------10124 sample_num
```sql
SELECT COUNT(p.Id) AS PostCount
FROM posts p
JOIN postLinks pl ON p.Id = pl.PostId
JOIN tags t ON pl.RelatedPostId = t.Id
WHERE t.TagName = 'careers';
```
-------------------------10125 sample_num
```sql
SELECT u.Reputation, p.ViewCount
FROM users u
JOIN posts p ON u.Id = p.OwnerUserId
WHERE u.DisplayName = 'Jarrod Dixon';
```
-------------------------10126 sample_num
```sql
SELECT 
    COUNT(c.Id) AS CommentCount, 
    COUNT(CASE WHEN p.PostTypeId = 2 THEN 1 END) AS AnswerCount
FROM 
    posts p
LEFT JOIN 
    comments c ON p.Id = c.PostId
WHERE 
    p.Title = 'Clustering 1D data';
```
-------------------------10127 sample_num
```sql
SELECT CreationDate FROM users WHERE DisplayName = 'IrishStat';
```
-------------------------10128 sample_num
```sql
SELECT COUNT(*) AS NumberOfPostsWithBounty
FROM votes
WHERE BountyAmount > 30;
```
-------------------------10129 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN p.Score > 50 THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM 
    posts p
JOIN 
    users u ON p.OwnerUserId = u.Id
WHERE 
    u.Reputation = (SELECT MAX(Reputation) FROM users);
```
-------------------------10130 sample_num
```sql
SELECT COUNT(*) FROM posts WHERE Score < 20;
```
-------------------------10131 sample_num
```sql
SELECT COUNT(*) 
FROM tags 
WHERE Id < 15 AND Count <= 20;
```
-------------------------10132 sample_num
```sql
SELECT ExcerptPostId, WikiPostId 
FROM tags 
WHERE TagName = 'sample';
```
-------------------------10133 sample_num
```sql
SELECT u.Reputation, u.UpVotes
FROM users u
JOIN comments c ON u.Id = c.UserId
WHERE c.Text = 'fine, you win :)';
```
-------------------------10134 sample_num
```sql
SELECT c.Text
FROM comments c
JOIN posts p ON c.PostId = p.Id
WHERE p.Title LIKE '%linear regression%';
```
-------------------------10135 sample_num
```sql
SELECT c.Text
FROM comments c
JOIN posts p ON c.PostId = p.Id
WHERE p.ViewCount BETWEEN 100 AND 150
ORDER BY c.Score DESC
LIMIT 1;
```
-------------------------10136 sample_num
```sql
SELECT u.CreationDate, u.Age
FROM comments c
JOIN users u ON c.UserId = u.Id
WHERE c.Text LIKE '%http://%';
```
-------------------------10137 sample_num
```sql
SELECT COUNT(DISTINCT c.PostId) AS PostCount
FROM comments c
JOIN posts p ON c.PostId = p.Id
WHERE c.Score = 0 AND p.ViewCount < 5;
```
-------------------------10138 sample_num
```sql
SELECT COUNT(*) AS CommentsWithZeroScore
FROM comments c
JOIN posts p ON c.PostId = p.Id
WHERE p.CommentCount = 1 AND c.Score = 0;
```
-------------------------10139 sample_num
```sql
SELECT COUNT(DISTINCT u.Id) AS TotalUsers
FROM comments c
JOIN users u ON c.UserId = u.Id
WHERE c.Score = 0 AND u.Age = 40;
```
-------------------------10140 sample_num
```sql
SELECT p.Id AS PostId, c.Text AS Comment
FROM posts p
JOIN comments c ON p.Id = c.PostId
WHERE p.Title = 'Group differences on a five point Likert item';
```
-------------------------10141 sample_num
```sql
SELECT u.UpVotes
FROM comments c
JOIN users u ON c.UserId = u.Id
WHERE c.Text = 'R is also lazy evaluated.';
```
-------------------------10142 sample_num
```sql
SELECT * FROM comments WHERE UserDisplayName = 'Harvey Motulsky';
```
-------------------------10143 sample_num
```sql
SELECT DISTINCT c.UserDisplayName
FROM comments c
JOIN users u ON c.UserId = u.Id
WHERE c.Score BETWEEN 1 AND 5 AND u.DownVotes = 0;
```
-------------------------10144 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN u.UpVotes = 0 THEN 1 END) * 100.0 / COUNT(c.UserId)) AS percentage
FROM 
    comments c
JOIN 
    users u ON c.UserId = u.Id
WHERE 
    c.Score BETWEEN 5 AND 10;
```
-------------------------10145 sample_num
```sql
SELECT sp.power_name
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE s.superhero_name = '3-D Man';
```
-------------------------10146 sample_num
```sql
SELECT COUNT(DISTINCT hp.hero_id) AS superhero_count
FROM hero_power hp
JOIN superpower sp ON hp.power_id = sp.id
WHERE sp.power_name = 'Super Strength';
```
-------------------------10147 sample_num
```sql
SELECT COUNT(DISTINCT sh.id) 
FROM superhero sh
JOIN hero_power hp ON sh.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE sp.power_name = 'Super Strength' AND sh.height_cm > 200;
```
-------------------------10148 sample_num
```sql
SELECT sh.full_name
FROM superhero sh
JOIN hero_power hp ON sh.id = hp.hero_id
GROUP BY sh.full_name
HAVING COUNT(hp.power_id) > 15;
```
-------------------------10149 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE eye_colour_id = (SELECT id FROM colour WHERE colour = 'Blue');
```
-------------------------10150 sample_num
```sql
SELECT c.colour 
FROM superhero s 
JOIN colour c ON s.skin_colour_id = c.id 
WHERE s.superhero_name = 'Apocalypse';
```
-------------------------10151 sample_num
```sql
SELECT COUNT(DISTINCT sh.id) AS superhero_count
FROM superhero sh
JOIN colour c ON sh.eye_colour_id = c.id
JOIN hero_power hp ON sh.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE c.colour = 'Blue' AND sp.power_name = 'Agility';
```
-------------------------10152 sample_num
```sql
SELECT superhero.superhero_name 
FROM superhero 
JOIN colour AS eye_colour ON superhero.eye_colour_id = eye_colour.id 
JOIN colour AS hair_colour ON superhero.hair_colour_id = hair_colour.id 
WHERE eye_colour.colour = 'Blue' AND hair_colour.colour = 'Blond';
```
-------------------------10153 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics');
```
-------------------------10154 sample_num
```sql
SELECT full_name 
FROM superhero 
WHERE height_cm = (SELECT MAX(height_cm) 
                   FROM superhero 
                   WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics'));
```
-------------------------10155 sample_num
```sql
SELECT p.publisher_name 
FROM superhero s 
JOIN publisher p ON s.publisher_id = p.id 
WHERE s.superhero_name = 'Sauron';
```
-------------------------10156 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
JOIN publisher ON superhero.publisher_id = publisher.id 
JOIN colour ON superhero.eye_colour_id = colour.id 
WHERE publisher.publisher_name = 'Marvel Comics' AND colour.colour = 'Blue';
```
-------------------------10157 sample_num
```sql
SELECT AVG(height_cm) AS average_height
FROM superhero
JOIN publisher ON superhero.publisher_id = publisher.id
WHERE publisher.publisher_name = 'Marvel Comics';
```
-------------------------10158 sample_num
```sql
SELECT 
    (SUM(sp.power_name = 'Super Strength') * 100.0 / COUNT(sh.id)) AS percentage
FROM 
    superhero sh
JOIN 
    publisher p ON sh.publisher_id = p.id
JOIN 
    hero_power hp ON sh.id = hp.hero_id
JOIN 
    superpower sp ON hp.power_id = sp.id
WHERE 
    p.publisher_name = 'Marvel Comics';
```
-------------------------10159 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'DC Comics');
```
-------------------------10160 sample_num
```sql
SELECT p.publisher_name
FROM superhero s
JOIN hero_attribute ha ON s.id = ha.hero_id
JOIN attribute a ON ha.attribute_id = a.id
JOIN publisher p ON s.publisher_id = p.id
WHERE a.attribute_name = 'Speed'
ORDER BY ha.attribute_value ASC
LIMIT 1;
```
-------------------------10161 sample_num
```sql
SELECT COUNT(*) 
FROM superhero s
JOIN colour c ON s.eye_colour_id = c.id
JOIN publisher p ON s.publisher_id = p.id
WHERE c.colour = 'Gold' AND p.publisher_name = 'Marvel Comics';
```
-------------------------10162 sample_num
```sql
SELECT publisher.publisher_name 
FROM superhero 
JOIN publisher ON superhero.publisher_id = publisher.id 
WHERE superhero.superhero_name = 'Blue Beetle II';
```
-------------------------10163 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE hair_colour_id = (SELECT id FROM colour WHERE colour = 'Blond');
```
-------------------------10164 sample_num
```sql
SELECT s.superhero_name 
FROM superhero s
JOIN hero_attribute ha ON s.id = ha.hero_id
JOIN attribute a ON ha.attribute_id = a.id
WHERE a.attribute_name = 'Intelligence' 
AND ha.attribute_value = (
    SELECT MIN(attribute_value) 
    FROM hero_attribute ha2 
    JOIN attribute a2 ON ha2.attribute_id = a2.id 
    WHERE a2.attribute_name = 'Intelligence'
);
```
-------------------------10165 sample_num
```sql
SELECT r.race 
FROM superhero s 
JOIN race r ON s.race_id = r.id 
WHERE s.superhero_name = 'Copycat';
```
-------------------------10166 sample_num
```sql
SELECT COUNT(DISTINCT ha.hero_id) AS superhero_count
FROM hero_attribute ha
JOIN attribute a ON ha.attribute_id = a.id
WHERE a.attribute_name = 'Durability' AND ha.attribute_value < 50;
```
-------------------------10167 sample_num
```sql
SELECT s.superhero_name 
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE sp.power_name = 'Death Touch';
```
-------------------------10168 sample_num
```sql
SELECT COUNT(DISTINCT sh.id) AS female_superheroes_with_strength_100
FROM superhero sh
JOIN gender g ON sh.gender_id = g.id
JOIN hero_attribute ha ON sh.id = ha.hero_id
JOIN attribute a ON ha.attribute_id = a.id
WHERE g.gender = 'Female' AND a.attribute_name = 'Strength' AND ha.attribute_value = 100;
```
-------------------------10169 sample_num
```sql
SELECT s.superhero_name
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
GROUP BY s.superhero_name
ORDER BY COUNT(hp.power_id) DESC
LIMIT 1;
```
-------------------------10170 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE race_id = (SELECT id FROM race WHERE race = 'Vampire');
```
-------------------------10171 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN a.alignment = 'Bad' THEN 1 END) * 100.0 / COUNT(s.id)) AS percentage,
    COUNT(CASE WHEN a.alignment = 'Bad' AND p.publisher_name = 'Marvel Comics' THEN 1 END) AS marvel_count
FROM 
    superhero s
JOIN 
    alignment a ON s.alignment_id = a.id
JOIN 
    publisher p ON s.publisher_id = p.id;
```
-------------------------10172 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics')) -
    (SELECT COUNT(*) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'DC Comics')) AS difference
```
-------------------------10173 sample_num
```sql
SELECT id FROM publisher WHERE publisher_name = 'Star Trek';
```
-------------------------10174 sample_num
```sql
SELECT AVG(attribute_value) AS average_attribute_value
FROM hero_attribute;
```
-------------------------10175 sample_num
```sql
SELECT COUNT(*) AS total_superheroes_without_full_name 
FROM superhero 
WHERE full_name IS NULL;
```
-------------------------10176 sample_num
```sql
SELECT c.colour 
FROM superhero s 
JOIN colour c ON s.eye_colour_id = c.id 
WHERE s.id = 75;
```
-------------------------10177 sample_num
```sql
SELECT sp.power_name 
FROM superhero s 
JOIN hero_power hp ON s.id = hp.hero_id 
JOIN superpower sp ON hp.power_id = sp.id 
WHERE s.superhero_name = 'Deathlok';
```
-------------------------10178 sample_num
```sql
SELECT AVG(weight_kg) AS average_weight
FROM superhero
WHERE gender_id = 2;
```
-------------------------10179 sample_num
```sql
SELECT DISTINCT sp.power_name
FROM superhero s
JOIN gender g ON s.gender_id = g.id
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE g.gender = 'Male'
LIMIT 5;
```
-------------------------10180 sample_num
```sql
SELECT superhero_name FROM superhero WHERE race_id = (SELECT id FROM race WHERE race = 'Alien');
```
-------------------------10181 sample_num
```sql
SELECT superhero_name 
FROM superhero 
WHERE height_cm BETWEEN 170 AND 190 AND eye_colour_id = 1;
```
-------------------------10182 sample_num
```sql
SELECT sp.power_name 
FROM hero_power hp 
JOIN superpower sp ON hp.power_id = sp.id 
WHERE hp.hero_id = 56;
```
-------------------------10183 sample_num
```sql
SELECT full_name 
FROM superhero 
WHERE race_id = (SELECT id FROM race WHERE race = 'Demi-God') 
LIMIT 5;
```
-------------------------10184 sample_num
```sql
SELECT COUNT(*) FROM superhero WHERE alignment_id = (SELECT id FROM alignment WHERE alignment = 'Bad');
```
-------------------------10185 sample_num
```sql
SELECT race.race 
FROM superhero 
JOIN race ON superhero.race_id = race.id 
WHERE superhero.weight_kg = 169;
```
-------------------------10186 sample_num
```sql
SELECT c.colour
FROM superhero s
JOIN race r ON s.race_id = r.id
JOIN colour c ON s.hair_colour_id = c.id
WHERE s.height_cm = 185 AND r.race = 'human';
```
-------------------------10187 sample_num
```sql
SELECT c.colour
FROM superhero s
JOIN colour c ON s.eye_colour_id = c.id
WHERE s.weight_kg = (SELECT MAX(weight_kg) FROM superhero);
```
-------------------------10188 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN publisher_id = 13 THEN 1 END) * 100.0 / COUNT(*)) AS percentage_marvel_heroes
FROM 
    superhero
WHERE 
    height_cm BETWEEN 150 AND 180;
```
-------------------------10189 sample_num
```sql
SELECT full_name 
FROM superhero 
WHERE gender_id = (SELECT id FROM gender WHERE gender = 'male') 
AND weight_kg > (SELECT AVG(weight_kg) * 0.79 FROM superhero);
```
-------------------------10190 sample_num
```sql
SELECT power_name, COUNT(*) AS power_count
FROM hero_power hp
JOIN superpower sp ON hp.power_id = sp.id
GROUP BY power_name
ORDER BY power_count DESC
LIMIT 1;
```
-------------------------10191 sample_num
```sql
SELECT ha.attribute_value 
FROM superhero s 
JOIN hero_attribute ha ON s.id = ha.hero_id 
WHERE s.superhero_name = 'Abomination';
```
-------------------------10192 sample_num
```sql
SELECT sp.power_name 
FROM hero_power hp 
JOIN superpower sp ON hp.power_id = sp.id 
WHERE hp.hero_id = 1;
```
-------------------------10193 sample_num
```sql
SELECT COUNT(DISTINCT hp.hero_id) AS hero_count
FROM hero_power hp
JOIN superpower sp ON hp.power_id = sp.id
WHERE sp.power_name = 'stealth';
```
-------------------------10194 sample_num
```sql
SELECT sh.full_name 
FROM superhero sh
JOIN hero_attribute ha ON sh.id = ha.hero_id
JOIN attribute a ON ha.attribute_id = a.id
WHERE a.attribute_name = 'strength'
AND ha.attribute_value = (
    SELECT MAX(attribute_value) 
    FROM hero_attribute 
    JOIN attribute ON hero_attribute.attribute_id = attribute.id 
    WHERE attribute.attribute_name = 'strength'
);
```
-------------------------10195 sample_num
```sql
SELECT DIVIDE(COUNT(superhero.id), SUM(skin_colour_id = 1)) AS average_no_skin_colour
FROM superhero
WHERE skin_colour_id IS NULL;
```
-------------------------10196 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Dark Horse Comics');
```
-------------------------10197 sample_num
```sql
SELECT sh.superhero_name
FROM superhero sh
JOIN publisher p ON sh.publisher_id = p.id
JOIN hero_attribute ha ON sh.id = ha.hero_id
JOIN attribute a ON ha.attribute_id = a.id
WHERE a.attribute_name = 'durability' AND p.publisher_name = 'Dark Horse Comics'
ORDER BY ha.attribute_value DESC
LIMIT 1;
```
-------------------------10198 sample_num
```sql
SELECT colour.colour 
FROM superhero 
JOIN colour ON superhero.eye_colour_id = colour.id 
WHERE superhero.full_name = 'Abraham Sapien';
```
-------------------------10199 sample_num
```sql
SELECT s.superhero_name
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE sp.power_name = 'Flight';
```
-------------------------10200 sample_num
```sql
SELECT s.eye_colour_id, s.hair_colour_id, s.skin_colour_id
FROM superhero s
JOIN gender g ON s.gender_id = g.id
JOIN publisher p ON s.publisher_id = p.id
WHERE g.gender = 'Female' AND p.publisher_name = 'Dark Horse Comics';
```
-------------------------10201 sample_num
```sql
SELECT s.superhero_name, p.publisher_name
FROM superhero s
JOIN publisher p ON s.publisher_id = p.id
WHERE s.eye_colour_id = s.hair_colour_id AND s.hair_colour_id = s.skin_colour_id;
```
-------------------------10202 sample_num
```sql
SELECT r.race 
FROM superhero s 
JOIN race r ON s.race_id = r.id 
WHERE s.superhero_name = 'A-Bomb';
```
-------------------------10203 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.colour = 'Blue' THEN 1 END) * 100.0 / COUNT(*)) AS blue_female_percentage
FROM 
    superhero s
JOIN 
    gender g ON s.gender_id = g.id
JOIN 
    colour c ON s.eye_colour_id = c.id
WHERE 
    g.gender = 'Female';
```
-------------------------10204 sample_num
```sql
SELECT superhero_name, race.race 
FROM superhero 
JOIN race ON superhero.race_id = race.id 
WHERE superhero.full_name = 'Charles Chandler';
```
-------------------------10205 sample_num
```sql
SELECT g.gender 
FROM superhero s 
JOIN gender g ON s.gender_id = g.id 
WHERE s.superhero_name = 'Agent 13';
```
-------------------------10206 sample_num
```sql
SELECT s.superhero_name 
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE sp.power_name = 'Adaptation';
```
-------------------------10207 sample_num
```sql
SELECT COUNT(*) 
FROM hero_power hp 
JOIN superhero s ON hp.hero_id = s.id 
WHERE s.superhero_name = 'Amazo';
```
-------------------------10208 sample_num
```sql
SELECT sp.power_name 
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE s.full_name = 'Hunter Zolomon';
```
-------------------------10209 sample_num
```sql
SELECT superhero.height_cm 
FROM superhero 
JOIN colour ON superhero.eye_colour_id = colour.id 
WHERE colour.colour = 'Amber';
```
-------------------------10210 sample_num
```sql
SELECT superhero_name 
FROM superhero 
WHERE eye_colour_id = (SELECT id FROM colour WHERE colour = 'Black') 
AND hair_colour_id = (SELECT id FROM colour WHERE colour = 'Black');
```
-------------------------10211 sample_num
```sql
SELECT DISTINCT c1.colour AS eye_colour
FROM superhero s
JOIN colour c1 ON s.eye_colour_id = c1.id
JOIN colour c2 ON s.skin_colour_id = c2.id
WHERE c2.colour = 'Gold';
```
-------------------------10212 sample_num
```sql
SELECT full_name 
FROM superhero 
WHERE race_id = (SELECT id FROM race WHERE race = 'Vampire');
```
-------------------------10213 sample_num
```sql
SELECT superhero_name 
FROM superhero 
WHERE alignment_id = (SELECT id FROM alignment WHERE alignment = 'Neutral');
```
-------------------------10214 sample_num
```sql
SELECT COUNT(DISTINCT ha.hero_id) AS hero_count
FROM hero_attribute ha
JOIN attribute a ON ha.attribute_id = a.id
WHERE a.attribute_name = 'Strength' AND ha.attribute_value = (
    SELECT MAX(attribute_value)
    FROM hero_attribute
    JOIN attribute ON hero_attribute.attribute_id = attribute.id
    WHERE attribute.attribute_name = 'Strength'
);
```
-------------------------10215 sample_num
```sql
SELECT r.race, a.alignment
FROM superhero s
JOIN race r ON s.race_id = r.id
JOIN alignment a ON s.alignment_id = a.id
WHERE s.superhero_name = 'Cameron Hicks';
```
-------------------------10216 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN g.gender = 'Female' THEN 1 END) * 100.0 / COUNT(*)) AS female_percentage
FROM 
    superhero s
JOIN 
    gender g ON s.gender_id = g.id
JOIN 
    publisher p ON s.publisher_id = p.id
WHERE 
    p.publisher_name = 'Marvel Comics';
```
-------------------------10217 sample_num
```sql
SELECT AVG(weight_kg) AS average_weight
FROM superhero
WHERE race_id = (SELECT id FROM race WHERE race = 'Alien');
```
-------------------------10218 sample_num
```sql
SELECT 
    (SELECT weight_kg FROM superhero WHERE full_name = 'Emil Blonsky') - 
    (SELECT weight_kg FROM superhero WHERE full_name = 'Charles Chandler') AS weight_difference;
```
-------------------------10219 sample_num
```sql
SELECT AVG(height_cm) AS average_height
FROM superhero;
```
-------------------------10220 sample_num
```sql
SELECT sp.power_name 
FROM superhero s 
JOIN hero_power hp ON s.id = hp.hero_id 
JOIN superpower sp ON hp.power_id = sp.id 
WHERE s.superhero_name = 'Abomination';
```
-------------------------10221 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE race_id = 21 AND gender_id = 1;
```
-------------------------10222 sample_num
```sql
SELECT s.superhero_name
FROM superhero s
JOIN hero_attribute ha ON s.id = ha.hero_id
JOIN attribute a ON ha.attribute_id = a.id
WHERE a.attribute_name = 'Speed'
ORDER BY ha.attribute_value DESC
LIMIT 1;
```
-------------------------10223 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE alignment_id = 3;
```
-------------------------10224 sample_num
```sql
SELECT a.attribute_name, ha.attribute_value
FROM superhero s
JOIN hero_attribute ha ON s.id = ha.hero_id
JOIN attribute a ON ha.attribute_id = a.id
WHERE s.superhero_name = '3-D Man';
```
-------------------------10225 sample_num
```sql
SELECT superhero_name 
FROM superhero 
WHERE eye_colour_id = 7 AND hair_colour_id = 9;
```
-------------------------10226 sample_num
```sql
SELECT p.publisher_name 
FROM superhero s 
JOIN publisher p ON s.publisher_id = p.id 
WHERE s.superhero_name IN ('Hawkman', 'Karate Kid', 'Speedy');
```
-------------------------10227 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE publisher_id = 1;
```
-------------------------10228 sample_num
```sql
SELECT (COUNT(CASE WHEN eye_colour_id = 7 THEN 1 END) * 100.0 / COUNT(*)) AS percentage_blue_eyes
FROM superhero;
```
-------------------------10229 sample_num
```sql
SELECT 
    SUM(CASE WHEN gender_id = 1 THEN 1 ELSE 0 END) * 1.0 / 
    NULLIF(SUM(CASE WHEN gender_id = 2 THEN 1 ELSE 0 END), 0) AS gender_ratio
FROM 
    superhero;
```
-------------------------10230 sample_num
```sql
SELECT superhero_name 
FROM superhero 
ORDER BY height_cm DESC 
LIMIT 1;
```
-------------------------10231 sample_num
```sql
SELECT id FROM superpower WHERE power_name = 'cryokinesis';
```
-------------------------10232 sample_num
```sql
SELECT superhero_name FROM superhero WHERE id = 294;
```
-------------------------10233 sample_num
```sql
SELECT full_name 
FROM superhero 
WHERE weight_kg = 0 OR weight_kg IS NULL;
```
-------------------------10234 sample_num
```sql
SELECT colour.colour 
FROM superhero 
JOIN colour ON superhero.eye_colour_id = colour.id 
WHERE superhero.full_name = 'Karen Beecher-Duncan';
```
-------------------------10235 sample_num
```sql
SELECT sp.power_name 
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE s.full_name = 'Helen Parr';
```
-------------------------10236 sample_num
```sql
SELECT r.race 
FROM superhero s 
JOIN race r ON s.race_id = r.id 
WHERE s.weight_kg = 108 AND s.height_cm = 188;
```
-------------------------10237 sample_num
```sql
SELECT publisher.publisher_name 
FROM superhero 
JOIN publisher ON superhero.publisher_id = publisher.id 
WHERE superhero.id = 38;
```
-------------------------10238 sample_num
```sql
SELECT r.race
FROM superhero s
JOIN hero_attribute ha ON s.id = ha.hero_id
JOIN race r ON s.race_id = r.id
WHERE ha.attribute_value = (
    SELECT MAX(attribute_value)
    FROM hero_attribute
)
```
-------------------------10239 sample_num
```sql
SELECT a.alignment, sp.power_name
FROM superhero s
JOIN alignment a ON s.alignment_id = a.id
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE s.superhero_name = 'Atom IV';
```
-------------------------10240 sample_num
```sql
SELECT superhero.full_name 
FROM superhero 
JOIN colour ON superhero.eye_colour_id = colour.id 
WHERE colour.colour = 'Blue' 
LIMIT 5;
```
-------------------------10241 sample_num
```sql
SELECT AVG(ha.attribute_value) AS average_attribute_value
FROM superhero s
JOIN alignment a ON s.alignment_id = a.id
JOIN hero_attribute ha ON s.id = ha.hero_id
WHERE a.id = 3;
```
-------------------------10242 sample_num
```sql
SELECT colour.colour
FROM superhero
JOIN colour ON superhero.skin_colour_id = colour.id
JOIN hero_attribute ON superhero.id = hero_attribute.hero_id
WHERE hero_attribute.attribute_value = 100;
```
-------------------------10243 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE alignment_id = 1 AND gender_id = 2;
```
-------------------------10244 sample_num
```sql
SELECT s.superhero_name
FROM superhero s
JOIN hero_attribute ha ON s.id = ha.hero_id
WHERE ha.attribute_value BETWEEN 75 AND 80;
```
-------------------------10245 sample_num
```sql
SELECT r.race 
FROM superhero s
JOIN gender g ON s.gender_id = g.id
JOIN colour c ON s.hair_colour_id = c.id
JOIN race r ON s.race_id = r.id
WHERE g.gender = 'male' AND c.colour = 'blue';
```
-------------------------10246 sample_num
```sql
SELECT 
    (SUM(CASE WHEN g.id = 2 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS female_percentage
FROM 
    superhero s
JOIN 
    alignment a ON s.alignment_id = a.id
JOIN 
    gender g ON s.gender_id = g.id
WHERE 
    a.id = 2;
```
-------------------------10247 sample_num
```sql
SELECT 
    (SUM(CASE WHEN s.eye_colour_id = 7 THEN 1 ELSE 0 END) - 
     SUM(CASE WHEN s.eye_colour_id = 1 THEN 1 ELSE 0 END)) AS difference
FROM 
    superhero s
WHERE 
    s.weight_kg = 0 OR s.weight_kg IS NULL;
```
-------------------------10248 sample_num
```sql
SELECT ha.attribute_value 
FROM superhero s 
JOIN hero_attribute ha ON s.id = ha.hero_id 
JOIN attribute a ON ha.attribute_id = a.id 
WHERE s.superhero_name = 'Hulk' AND a.attribute_name = 'Strength';
```
-------------------------10249 sample_num
```sql
SELECT sp.power_name 
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE s.superhero_name = 'Ajax';
```
-------------------------10250 sample_num
```sql
SELECT COUNT(*) 
FROM superhero 
WHERE skin_colour_id = (SELECT id FROM colour WHERE colour = 'Green') 
AND alignment_id = (SELECT id FROM alignment WHERE alignment = 'Bad');
```
-------------------------10251 sample_num
```sql
SELECT COUNT(*) 
FROM superhero s
JOIN gender g ON s.gender_id = g.id
JOIN publisher p ON s.publisher_id = p.id
WHERE g.gender = 'Female' AND p.publisher_name = 'Marvel Comics';
```
-------------------------10252 sample_num
```sql
SELECT s.superhero_name 
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE sp.power_name = 'Wind Control'
ORDER BY s.superhero_name ASC;
```
-------------------------10253 sample_num
```sql
SELECT g.gender
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
JOIN gender g ON s.gender_id = g.id
WHERE sp.power_name = 'Phoenix Force';
```
-------------------------10254 sample_num
```sql
SELECT superhero_name 
FROM superhero 
WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'DC Comics') 
ORDER BY weight_kg DESC 
LIMIT 1;
```
-------------------------10255 sample_num
```sql
SELECT AVG(height_cm) AS average_height
FROM superhero
JOIN publisher ON superhero.publisher_id = publisher.id
JOIN race ON superhero.race_id = race.id
WHERE race.race <> 'Human' AND publisher.publisher_name = 'Dark Horse Comics';
```
-------------------------10256 sample_num
```sql
SELECT COUNT(DISTINCT ha.hero_id) AS fastest_superheroes
FROM hero_attribute ha
JOIN attribute a ON ha.attribute_id = a.id
WHERE a.attribute_name = 'Speed' AND ha.attribute_value = 100;
```
-------------------------10257 sample_num
```sql
SELECT 
    SUM(CASE WHEN publisher_name = 'DC Comics' THEN 1 ELSE 0 END) AS dc_count,
    SUM(CASE WHEN publisher_name = 'Marvel Comics' THEN 1 ELSE 0 END) AS marvel_count,
    ABS(SUM(CASE WHEN publisher_name = 'DC Comics' THEN 1 ELSE 0 END) - 
        SUM(CASE WHEN publisher_name = 'Marvel Comics' THEN 1 ELSE 0 END)) AS difference
FROM 
    superhero
JOIN 
    publisher ON superhero.publisher_id = publisher.id;
```
-------------------------10258 sample_num
```sql
SELECT a.attribute_name
FROM hero_attribute ha
JOIN attribute a ON ha.attribute_id = a.id
JOIN superhero s ON ha.hero_id = s.id
WHERE s.superhero_name = 'Black Panther'
ORDER BY ha.attribute_value ASC
LIMIT 1;
```
-------------------------10259 sample_num
```sql
SELECT colour.colour 
FROM superhero 
JOIN colour ON superhero.eye_colour_id = colour.id 
WHERE superhero.superhero_name = 'Abomination';
```
-------------------------10260 sample_num
```sql
SELECT superhero_name FROM superhero ORDER BY height_cm DESC LIMIT 1;
```
-------------------------10261 sample_num
```sql
SELECT superhero_name FROM superhero WHERE full_name = 'Charles Chandler';
```
-------------------------10262 sample_num
```sql
SELECT 
    (SUM(CASE WHEN g.gender = 'Female' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS female_percentage
FROM 
    superhero s
JOIN 
    gender g ON s.gender_id = g.id
JOIN 
    publisher p ON s.publisher_id = p.id
WHERE 
    p.publisher_name = 'George Lucas';
```
-------------------------10263 sample_num
```sql
SELECT 
    (SUM(CASE WHEN a.alignment = 'Good' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS good_superhero_percentage
FROM 
    superhero s
JOIN 
    publisher p ON s.publisher_id = p.id
JOIN 
    alignment a ON s.alignment_id = a.id
WHERE 
    p.publisher_name = 'Marvel Comics';
```
-------------------------10264 sample_num
```sql
SELECT COUNT(*) AS total_superheroes
FROM superhero
WHERE full_name LIKE 'John%';
```
-------------------------10265 sample_num
```sql
SELECT ha.hero_id 
FROM hero_attribute ha 
WHERE ha.attribute_value = (SELECT MIN(attribute_value) FROM hero_attribute);
```
-------------------------10266 sample_num
```sql
SELECT full_name FROM superhero WHERE superhero_name = 'Alien';
```
-------------------------10267 sample_num
```sql
SELECT full_name 
FROM superhero 
WHERE weight_kg < 100 AND eye_colour_id = (SELECT id FROM colour WHERE colour = 'brown');
```
-------------------------10268 sample_num
```sql
SELECT ha.attribute_value 
FROM superhero s 
JOIN hero_attribute ha ON s.id = ha.hero_id 
WHERE s.superhero_name = 'Aquababy';
```
-------------------------10269 sample_num
```sql
SELECT weight_kg, race_id FROM superhero WHERE id = 40;
```
-------------------------10270 sample_num
```sql
SELECT AVG(height_cm) AS average_height
FROM superhero
WHERE alignment_id = (SELECT id FROM alignment WHERE alignment = 'Neutral');
```
-------------------------10271 sample_num
```sql
SELECT superhero.id 
FROM superhero 
JOIN hero_power ON superhero.id = hero_power.hero_id 
JOIN superpower ON hero_power.power_id = superpower.id 
WHERE superpower.power_name = 'Intelligence';
```
-------------------------10272 sample_num
```sql
SELECT colour.colour 
FROM superhero 
JOIN colour ON superhero.eye_colour_id = colour.id 
WHERE superhero.superhero_name = 'Blackwulf';
```
-------------------------10273 sample_num
```sql
SELECT sp.power_name
FROM superhero s
JOIN hero_power hp ON s.id = hp.hero_id
JOIN superpower sp ON hp.power_id = sp.id
WHERE s.height_cm > (SELECT AVG(height_cm) * 0.8 FROM superhero);
```
-------------------------10274 sample_num
```sql
SELECT d.driverRef
FROM qualifying q
JOIN drivers d ON q.driverId = d.driverId
WHERE q.raceId = 18 AND q.q1 IS NOT NULL
ORDER BY q.q1 ASC
LIMIT 5;
```
-------------------------10275 sample_num
```sql
SELECT d.surname
FROM qualifying q
JOIN drivers d ON q.driverId = d.driverId
WHERE q.raceId = 19
ORDER BY q.q2 ASC
LIMIT 1;
```
-------------------------10276 sample_num
```sql
SELECT DISTINCT r.year
FROM races r
JOIN circuits c ON r.circuitId = c.circuitId
WHERE c.name = 'Shanghai';
```
-------------------------10277 sample_num
```sql
SELECT r.url 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE c.name = 'Circuit de Barcelona-Catalunya';
```
-------------------------10278 sample_num
```sql
SELECT r.name 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE c.country = 'Germany';
```
-------------------------10279 sample_num
```sql
SELECT c.name, c.location, c.country
FROM circuits c
JOIN results r ON c.circuitId = r.raceId
JOIN constructors co ON r.constructorId = co.constructorId
WHERE co.name = 'Renault';
```
-------------------------10280 sample_num
```sql
SELECT COUNT(*) 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE r.year = 2010 
AND c.country NOT IN ('Asia', 'Europe');
```
-------------------------10281 sample_num
```sql
SELECT r.name 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE c.country = 'Spain';
```
-------------------------10282 sample_num
```sql
SELECT lat, lng 
FROM circuits 
WHERE circuitId IN (
    SELECT circuitId 
    FROM races 
    WHERE name LIKE '%Australian Grand Prix%'
);
```
-------------------------10283 sample_num
```sql
SELECT r.url 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE c.name = 'Sepang International Circuit';
```
-------------------------10284 sample_num
```sql
SELECT r.time 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE c.circuitRef = 'sepang';
```
-------------------------10285 sample_num
```sql
SELECT lat, lng FROM circuits WHERE name = 'Abu Dhabi Grand Prix';
```
-------------------------10286 sample_num
```sql
SELECT c.country
FROM constructors c
JOIN constructorResults cr ON c.constructorId = cr.constructorId
WHERE cr.points = 1 AND cr.raceId = 24;
```
-------------------------10287 sample_num
```sql
SELECT q1 
FROM qualifying 
WHERE raceId = 354 AND driverId = (SELECT driverId FROM drivers WHERE forename = 'Bruno' AND surname = 'Senna');
```
-------------------------10288 sample_num
```sql
SELECT d.nationality 
FROM qualifying q 
JOIN drivers d ON q.driverId = d.driverId 
WHERE q.raceId = 355 AND q.q2 = '0:01:40';
```
-------------------------10289 sample_num
```sql
SELECT d.number 
FROM qualifying q 
JOIN drivers d ON q.driverId = d.driverId 
WHERE q.raceId = 903 AND q.q3 = '0:01:54';
```
-------------------------10290 sample_num
```sql
SELECT COUNT(DISTINCT d.driverId) AS drivers_not_finished
FROM drivers d
JOIN results r ON d.driverId = r.driverId
JOIN races ra ON r.raceId = ra.raceId
WHERE ra.name = 'Bahrain Grand Prix' AND ra.year = 2007 AND r.statusId != (SELECT statusId FROM status WHERE status = 'Finished');
```
-------------------------10291 sample_num
```sql
SELECT s.year, s.url
FROM seasons s
JOIN races r ON s.year = r.year
WHERE r.raceId = 901;
```
-------------------------10292 sample_num
```sql
SELECT COUNT(DISTINCT driverId) AS finished_drivers
FROM results
WHERE raceId = (SELECT raceId FROM races WHERE date = '2015-11-29');
```
-------------------------10293 sample_num
```sql
SELECT d.*
FROM results r
JOIN drivers d ON r.driverId = d.driverId
WHERE r.raceId = 592 AND r.time IS NOT NULL
ORDER BY d.dob ASC
LIMIT 1;
```
-------------------------10294 sample_num
```sql
SELECT d.url 
FROM lapTimes lt 
JOIN drivers d ON lt.driverId = d.driverId 
WHERE lt.raceId = 161 AND lt.time = '00:01:27';
```
-------------------------10295 sample_num
```sql
SELECT d.nationality
FROM results r
JOIN drivers d ON r.driverId = d.driverId
WHERE r.raceId = 933 AND r.fastestLapSpeed = (
    SELECT MAX(fastestLapSpeed)
    FROM results
    WHERE raceId = 933
);
```
-------------------------10296 sample_num
```sql
SELECT lat, lng 
FROM circuits 
WHERE name = 'Malaysian Grand Prix';
```
-------------------------10297 sample_num
```sql
SELECT c.url
FROM constructors c
JOIN constructorResults cr ON c.constructorId = cr.constructorId
WHERE cr.raceId = 9
ORDER BY cr.points DESC
LIMIT 1;
```
-------------------------10298 sample_num
```sql
SELECT q1 
FROM qualifying 
WHERE raceId = 345 AND driverId = (SELECT driverId FROM drivers WHERE forename = 'Lucas' AND surname = 'di Grassi');
```
-------------------------10299 sample_num
```sql
SELECT d.nationality 
FROM drivers d 
JOIN qualifying q ON d.driverId = q.driverId 
WHERE q.raceId = 347 AND q.q2 = '0:01:15';
```
-------------------------10300 sample_num
```sql
SELECT d.code 
FROM drivers d 
JOIN qualifying q ON d.driverId = q.driverId 
WHERE q.raceId = 45 AND q.q3 = '0:01:33';
```
-------------------------10301 sample_num
```sql
SELECT r.time 
FROM results r 
JOIN drivers d ON r.driverId = d.driverId 
WHERE d.forename = 'Bruce' AND d.surname = 'McLaren' AND r.raceId = 743;
```
-------------------------10302 sample_num
```sql
SELECT d.forename, d.surname 
FROM results r 
JOIN races ra ON r.raceId = ra.raceId 
JOIN drivers d ON r.driverId = d.driverId 
WHERE ra.name = 'San Marino Grand Prix' AND ra.year = 2006 AND r.position = 2;
```
-------------------------10303 sample_num
```sql
SELECT s.year, s.url
FROM seasons s
JOIN races r ON s.year = r.year
WHERE r.raceId = 901;
```
-------------------------10304 sample_num
```sql
SELECT COUNT(DISTINCT driverId) AS numberOfDrivers
FROM results
WHERE raceId = (SELECT raceId FROM races WHERE date = '2015-11-29');
```
-------------------------10305 sample_num
```sql
SELECT driverId, MIN(dob) AS youngest_dob
FROM results
JOIN drivers ON results.driverId = drivers.driverId
WHERE raceId = 872 AND time IS NOT NULL
GROUP BY driverId
ORDER BY youngest_dob ASC
LIMIT 1;
```
-------------------------10306 sample_num
```sql
SELECT CONCAT(d.forename, ' ', d.surname) AS full_name
FROM lapTimes lt
JOIN drivers d ON lt.driverId = d.driverId
WHERE lt.raceId = 348
ORDER BY lt.time ASC
LIMIT 1;
```
-------------------------10307 sample_num
```sql
SELECT d.nationality
FROM results r
JOIN drivers d ON r.driverId = d.driverId
WHERE r.fastestLapSpeed = (SELECT MAX(fastestLapSpeed) FROM results);
```
-------------------------10308 sample_num
```sql
SELECT 
    (SELECT fastestLapSpeed FROM results WHERE raceId = 853 AND driverId = (SELECT driverId FROM drivers WHERE driverRef = 'di Resta')) AS fastestLapSpeed853,
    (SELECT fastestLapSpeed FROM results WHERE raceId = 854 AND driverId = (SELECT driverId FROM drivers WHERE driverRef = 'di Resta')) AS fastestLapSpeed854,
    ((SELECT fastestLapSpeed FROM results WHERE raceId = 853 AND driverId = (SELECT driverId FROM drivers WHERE driverRef = 'di Resta')) - 
     (SELECT fastestLapSpeed FROM results WHERE raceId = 854 AND driverId = (SELECT driverId FROM drivers WHERE driverRef = 'di Resta'))) / 
     (SELECT fastestLapSpeed FROM results WHERE raceId = 853 AND driverId = (SELECT driverId FROM drivers WHERE driverRef = 'di Resta')) * 100 AS percentage
```
-------------------------10309 sample_num
```sql
SELECT 
    (COUNT(r.driverId) FILTER (WHERE r.time IS NOT NULL) * 100.0 / COUNT(r.driverId)) AS race_completion_rate
FROM 
    results r
JOIN 
    races ra ON r.raceId = ra.raceId
WHERE 
    ra.date = '1983-07-16';
```
-------------------------10310 sample_num
```sql
SELECT MIN(year) AS first_singapore_grand_prix_year
FROM races
WHERE circuitId = (SELECT circuitId FROM circuits WHERE circuitRef = 'singapore');
```
-------------------------10311 sample_num
```sql
SELECT COUNT(*) AS race_count, name 
FROM races 
WHERE year = 2005 
GROUP BY name 
ORDER BY name DESC;
```
-------------------------10312 sample_num
```sql
SELECT * FROM races
WHERE YEAR(date) = (SELECT YEAR(MIN(date)) FROM races)
AND MONTH(date) = (SELECT MONTH(MIN(date)) FROM races);
```
-------------------------10313 sample_num
```sql
SELECT r.name, r.date 
FROM races r 
WHERE r.year = 1999 
AND r.round = (SELECT MAX(round) FROM races WHERE year = 1999);
```
-------------------------10314 sample_num
```sql
SELECT year, COUNT(*) AS race_count
FROM races
GROUP BY year
ORDER BY race_count DESC
LIMIT 1;
```
-------------------------10315 sample_num
```sql
SELECT r.name 
FROM races r 
WHERE r.year = 2017 
AND r.raceId NOT IN (SELECT raceId FROM races WHERE year = 2000);
```
-------------------------10316 sample_num
```sql
SELECT c.name AS circuit, c.location, c.country
FROM races r
JOIN circuits c ON r.circuitId = c.circuitId
WHERE r.name = 'European Grand Prix'
AND r.year = (SELECT MIN(year) FROM races WHERE name = 'European Grand Prix');
```
-------------------------10317 sample_num
```sql
SELECT MAX(s.year) AS last_season
FROM seasons s
JOIN races r ON s.year = r.year
JOIN circuits c ON r.circuitId = c.circuitId
WHERE c.name = 'Brands Hatch' AND r.name = 'British Grand Prix';
```
-------------------------10318 sample_num
```sql
SELECT COUNT(DISTINCT s.year) AS seasons_count
FROM races r
JOIN circuits c ON r.circuitId = c.circuitId
JOIN seasons s ON r.year = s.year
WHERE c.name = 'Silverstone Circuit' AND r.name = 'British Grand Prix';
```
-------------------------10319 sample_num
```sql
SELECT d.forename, d.surname
FROM drivers d
JOIN results r ON d.driverId = r.driverId
JOIN races ra ON r.raceId = ra.raceId
WHERE ra.year = 2010 AND ra.name = 'Singapore Grand Prix'
ORDER BY r.positionOrder;
```
-------------------------10320 sample_num
```sql
SELECT CONCAT(d.forename, ' ', d.surname) AS full_name, SUM(ds.points) AS total_points
FROM drivers d
JOIN driverStandings ds ON d.driverId = ds.driverId
GROUP BY d.driverId
ORDER BY total_points DESC
LIMIT 1;
```
-------------------------10321 sample_num
```sql
SELECT d.forename, d.surname, ds.points
FROM driverStandings ds
JOIN drivers d ON ds.driverId = d.driverId
JOIN races r ON ds.raceId = r.raceId
WHERE r.year = 2017 AND r.name = 'Chinese Grand Prix'
ORDER BY ds.points DESC
LIMIT 3;
```
-------------------------10322 sample_num
```sql
SELECT d.forename, d.surname, r.name AS race_name, MIN(lt.time) AS best_lap_time
FROM lapTimes lt
JOIN drivers d ON lt.driverId = d.driverId
JOIN races r ON lt.raceId = r.raceId
GROUP BY d.driverId, r.raceId
ORDER BY best_lap_time ASC
LIMIT 1;
```
-------------------------10323 sample_num
```sql
SELECT AVG(lt.time) AS average_lap_time
FROM lapTimes lt
JOIN results r ON lt.raceId = r.raceId AND lt.driverId = r.driverId
JOIN drivers d ON r.driverId = d.driverId
JOIN races ra ON r.raceId = ra.raceId
WHERE d.forename = 'Sebastian' AND d.surname = 'Vettel' 
AND ra.year = 2009 AND ra.name = 'Chinese Grand Prix';
```
-------------------------10324 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN d.surname = 'Hamilton' AND r.year >= 2010 AND rs.position > 1 THEN 1 END) * 100.0) / 
    COUNT(CASE WHEN d.surname = 'Hamilton' AND r.year >= 2010 THEN 1 END) AS percentage
FROM 
    results rs
JOIN 
    races r ON rs.raceId = r.raceId
JOIN 
    drivers d ON rs.driverId = d.driverId
WHERE 
    d.surname = 'Hamilton' AND r.year >= 2010;
```
-------------------------10325 sample_num
```sql
SELECT d.forename, d.surname, d.nationality, AVG(ds.points) AS average_points
FROM drivers d
JOIN driverStandings ds ON d.driverId = ds.driverId
JOIN (
    SELECT driverId, COUNT(wins) AS total_wins
    FROM driverStandings
    GROUP BY driverId
) AS win_counts ON d.driverId = win_counts.driverId
WHERE win_counts.total_wins = (
    SELECT MAX(total_wins)
    FROM (
        SELECT driverId, COUNT(wins) AS total_wins
        FROM driverStandings
        GROUP BY driverId
    ) AS subquery
)
GROUP BY d.driverId;
```
-------------------------10326 sample_num
```sql
SELECT CONCAT(forename, ' ', surname) AS name, 
       (2022 - YEAR(dob) + 1) AS age
FROM drivers
WHERE nationality = 'Japanese'
ORDER BY dob DESC
LIMIT 1;
```
-------------------------10327 sample_num
```sql
SELECT c.name, c.location, c.country
FROM circuits c
JOIN races r ON c.circuitId = r.circuitId
WHERE YEAR(r.date) BETWEEN 1990 AND 2000
GROUP BY c.circuitId
HAVING COUNT(r.raceId) = 4;
```
-------------------------10328 sample_num
```sql
SELECT c.name AS circuit_name, c.location AS circuit_location, r.name AS race_name
FROM circuits c
JOIN races r ON c.circuitId = r.circuitId
WHERE c.country = 'USA' AND r.year = 2006;
```
-------------------------10329 sample_num
```sql
SELECT r.name AS race_name, c.name AS circuit_name, c.location 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE MONTH(r.date) = 9 AND YEAR(r.date) = 2005;
```
-------------------------10330 sample_num
```sql
SELECT r.name, r.date 
FROM results res 
JOIN races r ON res.raceId = r.raceId 
JOIN drivers d ON res.driverId = d.driverId 
WHERE d.forename = 'Alex' AND d.surname = 'Yoong' AND res.positionOrder < 10;
```
-------------------------10331 sample_num
```sql
SELECT COUNT(*) AS wins
FROM results r
JOIN races ra ON r.raceId = ra.raceId
JOIN circuits c ON ra.circuitId = c.circuitId
JOIN drivers d ON r.driverId = d.driverId
WHERE d.forename = 'Michael' AND d.surname = 'Schumacher' 
AND c.circuitRef = 'sepang'
AND r.points = (SELECT MAX(points) FROM results WHERE raceId = r.raceId);
```
-------------------------10332 sample_num
```sql
SELECT r.name AS race, r.year
FROM results res
JOIN races r ON res.raceId = r.raceId
JOIN drivers d ON res.driverId = d.driverId
WHERE d.forename = 'Michael' AND d.surname = 'Schumacher'
AND res.fastestLap = 1
ORDER BY res.fastestLapTime ASC
LIMIT 1;
```
-------------------------10333 sample_num
```sql
SELECT AVG(ds.points) AS average_points
FROM driverStandings ds
JOIN races r ON ds.raceId = r.raceId
JOIN drivers d ON ds.driverId = d.driverId
WHERE d.forename = 'Eddie' AND d.surname = 'Irvine' AND r.year = 2000;
```
-------------------------10334 sample_num
```sql
SELECT r.date, drs.points
FROM races r
JOIN results res ON r.raceId = res.raceId
JOIN drivers d ON res.driverId = d.driverId
JOIN driverStandings drs ON r.raceId = drs.raceId AND d.driverId = drs.driverId
WHERE d.forename = 'Lewis' AND d.surname = 'Hamilton'
ORDER BY r.date ASC
LIMIT 1;
```
-------------------------10335 sample_num
```sql
SELECT r.name, c.country 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE r.year = 2017 
ORDER BY r.date;
```
-------------------------10336 sample_num
```sql
SELECT r.name AS race_name, r.year, c.location
FROM races r
JOIN circuits c ON r.circuitId = c.circuitId
JOIN results res ON r.raceId = res.raceId
GROUP BY r.raceId
ORDER BY COUNT(res.laps) DESC
LIMIT 1;
```
-------------------------10337 sample_num
```sql
SELECT (COUNT(CASE WHEN c.country = 'Germany' THEN 1 END) * 100.0 / COUNT(*)) AS percentage
FROM races r
JOIN circuits c ON r.circuitId = c.circuitId
WHERE r.name = 'European Grand Prix';
```
-------------------------10338 sample_num
```sql
SELECT lat, lng FROM circuits WHERE name = 'Silverstone Circuit';
```
-------------------------10339 sample_num
```sql
SELECT name, lat 
FROM circuits 
WHERE name IN ('Silverstone Circuit', 'Hockenheimring', 'Hungaroring') 
ORDER BY lat DESC 
LIMIT 1;
```
-------------------------10340 sample_num
```sql
SELECT circuitRef FROM circuits WHERE name = 'Marina Bay Street Circuit';
```
-------------------------10341 sample_num
```sql
SELECT country 
FROM circuits 
WHERE alt = (SELECT MAX(alt) FROM circuits);
```
-------------------------10342 sample_num
```sql
SELECT COUNT(*) AS drivers_without_code
FROM drivers
WHERE code IS NULL;
```
-------------------------10343 sample_num
```sql
SELECT nationality 
FROM drivers 
WHERE dob = (SELECT MIN(dob) FROM drivers);
```
-------------------------10344 sample_num
```sql
SELECT surname FROM drivers WHERE nationality = 'italian';
```
-------------------------10345 sample_num
```sql
SELECT url FROM drivers WHERE forename = 'Anthony' AND surname = 'Davidson';
```
-------------------------10346 sample_num
```sql
SELECT driverRef FROM drivers WHERE forename = 'Lewis' AND surname = 'Hamilton';
```
-------------------------10347 sample_num
```sql
SELECT c.name 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE r.year = 2009 AND r.name = 'Spanish Grand Prix';
```
-------------------------10348 sample_num
```sql
SELECT DISTINCT s.year
FROM races r
JOIN circuits c ON r.circuitId = c.circuitId
JOIN seasons s ON r.year = s.year
WHERE c.name = 'Silverstone Circuit';
```
-------------------------10349 sample_num
```sql
SELECT r.*, c.url 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE c.name = 'Silverstone';
```
-------------------------10350 sample_num
```sql
SELECT r.time 
FROM races r 
JOIN circuits c ON r.circuitId = c.circuitId 
WHERE c.name = 'Abu Dhabi Circuit' AND r.year BETWEEN 2010 AND 2019;
```
-------------------------10351 sample_num
```sql
SELECT COUNT(*) 
FROM races 
WHERE circuitId IN (SELECT circuitId FROM circuits WHERE country = 'Italy');
```
-------------------------10352 sample_num
```sql
SELECT r.date
FROM races r
JOIN circuits c ON r.circuitId = c.circuitId
WHERE c.name = 'Barcelona-Catalunya';
```
-------------------------10353 sample_num
```sql
SELECT c.url 
FROM circuits c 
JOIN races r ON c.circuitId = r.circuitId 
WHERE r.year = 2009 AND r.name LIKE '%Spanish Grand Prix%';
```
-------------------------10354 sample_num
```sql
SELECT MIN(fastestLapTime) AS fastestLapTime
FROM results r
JOIN drivers d ON r.driverId = d.driverId
WHERE d.forename = 'Lewis' AND d.surname = 'Hamilton';
```
-------------------------10355 sample_num
```sql
SELECT d.forename, d.surname
FROM results r
JOIN drivers d ON r.driverId = d.driverId
WHERE r.fastestLapSpeed = (
    SELECT MAX(fastestLapSpeed)
    FROM results
);
```
-------------------------10356 sample_num
```sql
SELECT d.driverRef 
FROM results r 
JOIN drivers d ON r.driverId = d.driverId 
JOIN races ra ON r.raceId = ra.raceId 
WHERE ra.name = 'Australian Grand Prix' AND ra.year = 2008 AND r.positionOrder = 1;
```
-------------------------10357 sample_num
```sql
SELECT r.name, r.date, r.time 
FROM races r
JOIN results res ON r.raceId = res.raceId
JOIN drivers d ON res.driverId = d.driverId
WHERE d.forename = 'Lewis' AND d.surname = 'Hamilton';
```
-------------------------10358 sample_num
```sql
SELECT r.name, r.date, r.time, d.position, d.rank
FROM results d
JOIN races r ON d.raceId = r.raceId
JOIN drivers dr ON d.driverId = dr.driverId
WHERE dr.forename = 'Lewis' AND dr.surname = 'Hamilton'
ORDER BY d.rank ASC
LIMIT 1;
```
-------------------------10359 sample_num
```sql
SELECT MAX(fastestLapSpeed) AS fastest_lap_speed
FROM results
JOIN races ON results.raceId = races.raceId
WHERE races.year = 2009 AND races.name = 'Spanish Grand Prix';
```
-------------------------10360 sample_num
```sql
SELECT DISTINCT s.year
FROM drivers d
JOIN results r ON d.driverId = r.driverId
JOIN races ra ON r.raceId = ra.raceId
JOIN seasons s ON ra.year = s.year
WHERE d.forename = 'Lewis' AND d.surname = 'Hamilton';
```
-------------------------10361 sample_num
```sql
SELECT positionOrder 
FROM results 
WHERE driverId = (SELECT driverId FROM drivers WHERE forename = 'Lewis' AND surname = 'Hamilton') 
AND raceId = (SELECT raceId FROM races WHERE year = 2008 AND round = 1);
```
-------------------------10362 sample_num
```sql
SELECT d.forename, d.surname
FROM results r
JOIN drivers d ON r.driverId = d.driverId
JOIN races ra ON r.raceId = ra.raceId
WHERE ra.year = 2008 AND ra.name = 'Australian Grand Prix' AND r.grid = 4;
```
-------------------------10363 sample_num
```sql
SELECT COUNT(DISTINCT driverId) AS finished_drivers
FROM results
WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix')
AND time IS NOT NULL;
```
-------------------------10364 sample_num
```sql
SELECT fastestLapTime 
FROM results r 
JOIN drivers d ON r.driverId = d.driverId 
JOIN races ra ON r.raceId = ra.raceId 
WHERE d.forename = 'Lewis' AND d.surname = 'Hamilton' 
AND ra.year = 2008 AND ra.name = 'Australian Grand Prix';
```
-------------------------10365 sample_num
```sql
SELECT r.time 
FROM results r 
JOIN races ra ON r.raceId = ra.raceId 
WHERE ra.year = 2008 AND ra.name = 'Australian Grand Prix' AND r.positionOrder = 2;
```
-------------------------10366 sample_num
```sql
SELECT d.forename, d.surname, d.url 
FROM results r 
JOIN drivers d ON r.driverId = d.driverId 
JOIN races ra ON r.raceId = ra.raceId 
WHERE ra.year = 2008 AND ra.name = 'Australian Grand Prix' AND r.positionOrder = 1;
```
-------------------------10367 sample_num
```sql
SELECT COUNT(DISTINCT d.driverId) AS driver_count
FROM drivers d
JOIN results r ON d.driverId = r.driverId
JOIN races ra ON r.raceId = ra.raceId
WHERE d.nationality = 'American' AND ra.year = 2008 AND ra.name = 'Australian Grand Prix';
```
-------------------------10368 sample_num
```sql
SELECT COUNT(DISTINCT d.driverId) AS participating_drivers
FROM results r
JOIN drivers d ON r.driverId = d.driverId
WHERE r.raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix')
AND r.position IS NOT NULL;
```
-------------------------10369 sample_num
```sql
SELECT SUM(ds.points) AS total_points
FROM driverStandings ds
JOIN drivers d ON ds.driverId = d.driverId
WHERE d.forename = 'Lewis' AND d.surname = 'Hamilton';
```
-------------------------10370 sample_num
```sql
SELECT AVG(TIME_TO_SEC(STR_TO_DATE(fastestLapTime, '%i:%s.%f'))) AS average_fastest_lap_time
FROM results
JOIN drivers ON results.driverId = drivers.driverId
WHERE drivers.forename = 'Lewis' AND drivers.surname = 'Hamilton';
```
-------------------------10371 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN r.time IS NOT NULL THEN r.raceId END) * 1.0 / COUNT(r.raceId)) AS completion_rate
FROM 
    results r
JOIN 
    races ra ON r.raceId = ra.raceId
WHERE 
    ra.year = 2008 AND ra.name = 'Australian Grand Prix';
```
-------------------------10372 sample_num
```sql
SELECT 
    (TIMESTAMPDIFF(MICROSECOND, 
        (SELECT time FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND round = 1) AND positionOrder = 1 AND time IS NOT NULL), 
        (SELECT time FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND round = 1) AND positionOrder = (SELECT MAX(positionOrder) FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND round = 1) AND time IS NOT NULL) AND time IS NOT NULL)
    ) / 
    (SELECT time FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND round = 1) AND positionOrder = (SELECT MAX(positionOrder) FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND round = 1) AND time IS NOT NULL) AND time IS NOT NULL)
    ) * 100 AS percentage_faster
FROM dual;
```
-------------------------10373 sample_num
```sql
SELECT COUNT(*) FROM circuits WHERE location = 'Melbourne' AND country = 'Australia';
```
-------------------------10374 sample_num
```sql
SELECT lat, lng FROM circuits WHERE country = 'USA';
```
-------------------------10375 sample_num
```sql
SELECT COUNT(*) 
FROM drivers 
WHERE nationality = 'British' AND dob > '1980-01-01';
```
-------------------------10376 sample_num
```sql
SELECT AVG(cr.points) AS average_points
FROM constructorResults cr
JOIN constructors c ON cr.constructorId = c.constructorId
WHERE c.nationality = 'British';
```
-------------------------10377 sample_num
```sql
SELECT c.name, SUM(cr.points) AS total_points
FROM constructors c
JOIN constructorResults cr ON c.constructorId = cr.constructorId
GROUP BY c.constructorId
ORDER BY total_points DESC
LIMIT 1;
```
-------------------------10378 sample_num
```sql
SELECT c.name 
FROM constructors c
LEFT JOIN constructorResults cr ON c.constructorId = cr.constructorId AND cr.raceId = 291
WHERE cr.points = 0 OR cr.constructorResultsId IS NULL;
```
-------------------------10379 sample_num
```sql
SELECT COUNT(DISTINCT c.constructorId) AS japaneseConstructorsWithZeroPoints
FROM constructors c
JOIN constructorResults cr ON c.constructorId = cr.constructorId
WHERE c.nationality = 'Japanese' AND cr.points = 0
GROUP BY c.constructorId
HAVING COUNT(cr.raceId) = 2;
```
-------------------------10380 sample_num
```sql
SELECT DISTINCT c.name
FROM constructors c
JOIN constructorStandings cs ON c.constructorId = cs.constructorId
WHERE cs.position = 1;
```
-------------------------10381 sample_num
```sql
SELECT COUNT(DISTINCT c.constructorId) AS FrenchConstructorCount
FROM constructors c
JOIN results r ON c.constructorId = r.constructorId
JOIN races ra ON r.raceId = ra.raceId
JOIN lapTimes lt ON r.raceId = lt.raceId
WHERE c.nationality = 'French' AND lt.lap > 50;
```
-------------------------10382 sample_num
```sql
SELECT 
    (COUNT(r.resultId) * 100.0 / NULLIF(COUNT(DISTINCT r.driverId), 0)) AS race_completion_percentage
FROM 
    results r
JOIN 
    drivers d ON r.driverId = d.driverId
JOIN 
    races ra ON r.raceId = ra.raceId
WHERE 
    d.nationality = 'Japanese' 
    AND ra.year BETWEEN 2007 AND 2009 
    AND r.time IS NOT NULL;
```
-------------------------10383 sample_num
```sql
SELECT s.year, AVG(TIME_TO_SEC(r.time)) AS average_time_seconds
FROM results r
JOIN driverStandings ds ON r.raceId = ds.raceId AND r.driverId = ds.driverId
JOIN seasons s ON r.raceId = (SELECT raceId FROM races WHERE year = s.year ORDER BY round LIMIT 1)
WHERE ds.position = 1 AND r.time IS NOT NULL
GROUP BY s.year;
```
-------------------------10384 sample_num
```sql
SELECT d.forename, d.surname
FROM drivers d
JOIN driverStandings ds ON d.driverId = ds.driverId
WHERE YEAR(d.dob) > 1975 AND ds.position = 2;
```
-------------------------10385 sample_num
```sql
SELECT COUNT(DISTINCT d.driverId) AS ItalianDriversNotFinished
FROM drivers d
JOIN results r ON d.driverId = r.driverId
WHERE d.nationality = 'Italian' AND r.time IS NULL;
```
-------------------------10386 sample_num
```sql
SELECT d.forename, d.surname
FROM drivers d
JOIN results r ON d.driverId = r.driverId
WHERE r.fastestLap = 1
ORDER BY r.fastestLapTime ASC
LIMIT 1;
```
-------------------------10387 sample_num
```sql
SELECT r.lap AS fastest_lap_number
FROM results r
JOIN driverStandings ds ON r.driverId = ds.driverId
WHERE ds.raceId = r.raceId AND ds.position = 1 AND ds.year = 2009
ORDER BY r.fastestLapTime ASC
LIMIT 1;
```
-------------------------10388 sample_num
```sql
SELECT AVG(fastestLapSpeed) AS average_fastest_lap_speed
FROM results
JOIN races ON results.raceId = races.raceId
WHERE races.name = 'Spanish Grand Prix' AND races.year = 2009;
```
-------------------------10389 sample_num
```sql
SELECT r.name, r.year
FROM results res
JOIN races r ON res.raceId = r.raceId
WHERE res.milliseconds IS NOT NULL
ORDER BY res.milliseconds ASC
LIMIT 1;
```
-------------------------10390 sample_num
```sql
SELECT 
    (COUNT(DISTINCT d.driverId) * 100.0 / NULLIF(COUNT(DISTINCT d2.driverId), 0)) AS percentage
FROM 
    drivers d
JOIN 
    results r ON d.driverId = r.driverId
JOIN 
    races ra ON r.raceId = ra.raceId
WHERE 
    d.dob < '1985-01-01' 
    AND ra.year BETWEEN 2000 AND 2005 
    AND r.laps > 50;
```
-------------------------10391 sample_num
```sql
SELECT COUNT(DISTINCT d.driverId) AS FrenchDriverCount
FROM drivers d
JOIN lapTimes l ON d.driverId = l.driverId
WHERE d.nationality = 'French' AND l.time < '00:02:00';
```
-------------------------10392 sample_num
```sql
SELECT code FROM drivers WHERE nationality = 'America';
```
-------------------------10393 sample_num
```sql
SELECT raceId FROM races WHERE year = 2009;
```
-------------------------10394 sample_num
```sql
SELECT COUNT(DISTINCT driverId) AS driver_count
FROM results
WHERE raceId = 18;
```
-------------------------10395 sample_num
```sql
SELECT driverId, YEAR(dob) AS birth_year
FROM drivers
ORDER BY dob DESC
LIMIT 3;
```

```sql
SELECT COUNT(*) AS netherlandic_drivers
FROM drivers
WHERE driverId IN (
    SELECT driverId
    FROM drivers
    ORDER BY dob DESC
    LIMIT 3
) AND nationality = 'Dutch';
```
-------------------------10396 sample_num
```sql
SELECT driverRef FROM drivers WHERE forename = 'Robert' AND surname = 'Kubica';
```
-------------------------10397 sample_num
```sql
SELECT COUNT(*) 
FROM drivers 
WHERE nationality = 'Australian' AND YEAR(dob) = 1980;
```
-------------------------10398 sample_num
```sql
SELECT d.driverId, d.forename, d.surname, MIN(lt.time) AS earliest_lap_time
FROM drivers d
JOIN lapTimes lt ON d.driverId = lt.driverId
WHERE d.nationality = 'German' AND YEAR(d.dob) BETWEEN 1980 AND 1990
GROUP BY d.driverId, d.forename, d.surname
ORDER BY earliest_lap_time
LIMIT 3;
```
-------------------------10399 sample_num
```sql
SELECT driverRef 
FROM drivers 
WHERE nationality = 'German' 
ORDER BY dob ASC 
LIMIT 1;
```
-------------------------10400 sample_num
```sql
SELECT d.driverId, d.code
FROM drivers d
JOIN results r ON d.driverId = r.driverId
WHERE YEAR(d.dob) = 1971 AND r.fastestLapTime IS NOT NULL;
```
-------------------------10401 sample_num
```sql
SELECT d.driverId, d.forename, d.surname, MAX(lt.time) AS latest_lap_time
FROM drivers d
JOIN lapTimes lt ON d.driverId = lt.driverId
WHERE d.nationality = 'Spanish' AND YEAR(d.dob) < 1982
GROUP BY d.driverId, d.forename, d.surname
ORDER BY latest_lap_time DESC
LIMIT 10;
```
-------------------------10402 sample_num
```sql
SELECT r.year
FROM races r
JOIN results res ON r.raceId = res.raceId
WHERE res.fastestLapTime IS NOT NULL
ORDER BY res.fastestLapTime ASC
LIMIT 1;
```
-------------------------10403 sample_num
```sql
SELECT year, MAX(lapTimes.time) AS lowest_speed_lap_time
FROM seasons
JOIN races ON seasons.year = races.year
JOIN lapTimes ON races.raceId = lapTimes.raceId
GROUP BY year
ORDER BY lowest_speed_lap_time ASC
LIMIT 1;
```
-------------------------10404 sample_num
```sql
SELECT driverId
FROM lapTimes
WHERE lap = 1
GROUP BY driverId
ORDER BY MIN(time) ASC
LIMIT 5;
```
-------------------------10405 sample_num
```sql
SELECT COUNT(*) 
FROM results 
WHERE raceId > 50 AND raceId < 100 AND statusId = 2 AND time IS NOT NULL;
```
-------------------------10406 sample_num
```sql
SELECT c.name, c.location, c.country, c.lat, c.lng, COUNT(r.raceId) AS timesHeld
FROM circuits c
JOIN races r ON c.circuitId = r.circuitId
WHERE c.country = 'Austria'
GROUP BY c.name, c.location, c.country, c.lat, c.lng;
```
-------------------------10407 sample_num
```sql
SELECT r.round AS race_number, COUNT(r.resultId) AS finisher_count
FROM results r
WHERE r.time IS NOT NULL
GROUP BY r.round
ORDER BY finisher_count DESC
LIMIT 1;
```
-------------------------10408 sample_num
```sql
SELECT d.driverRef, d.nationality, d.dob
FROM drivers d
JOIN qualifying q ON d.driverId = q.driverId
WHERE q.raceId = 23 AND q.q2 IS NOT NULL;
```
-------------------------10409 sample_num
```sql
SELECT r.year, r.name, r.date, r.time
FROM drivers d
JOIN qualifying q ON d.driverId = q.driverId
JOIN races r ON q.raceId = r.raceId
WHERE d.dob = (SELECT MIN(dob) FROM drivers)
ORDER BY r.date, r.time
LIMIT 1;
```
-------------------------10410 sample_num
```sql
SELECT COUNT(DISTINCT d.driverId) AS disqualified_american_drivers
FROM drivers d
JOIN results r ON d.driverId = r.driverId
WHERE d.nationality = 'American' AND r.statusId = 2;
```
-------------------------10411 sample_num
```sql
SELECT c.name, c.url
FROM constructors c
JOIN constructorStandings cs ON c.constructorId = cs.constructorId
WHERE c.nationality = 'Italian'
ORDER BY cs.points DESC
LIMIT 1;
```
-------------------------10412 sample_num
```sql
SELECT c.url
FROM constructors c
JOIN constructorStandings cs ON c.constructorId = cs.constructorId
GROUP BY c.constructorId, c.url
ORDER BY SUM(cs.wins) DESC
LIMIT 1;
```
-------------------------10413 sample_num
```sql
SELECT d.forename, d.surname, MAX(lt.time) AS slowest_time
FROM lapTimes lt
JOIN races r ON lt.raceId = r.raceId
JOIN drivers d ON lt.driverId = d.driverId
WHERE r.name = 'French Grand Prix' AND lt.lap = 3
GROUP BY d.driverId
ORDER BY slowest_time DESC
LIMIT 1;
```
-------------------------10414 sample_num
```sql
SELECT r.name AS race_name, MIN(lt.time) AS fastest_first_lap_time
FROM lapTimes lt
JOIN races r ON lt.raceId = r.raceId
WHERE lt.lap = 1
GROUP BY r.raceId
ORDER BY fastest_first_lap_time ASC
LIMIT 1;
```
-------------------------10415 sample_num
```sql
SELECT AVG(fastestLapTime) AS average_fastest_lap_time
FROM results
JOIN races ON results.raceId = races.raceId
WHERE races.year = 2006 AND races.name = 'United States Grand Prix' AND results.positionOrder < 11;
```
-------------------------10416 sample_num
```sql
SELECT d.driverId, d.forename, d.surname, AVG(p.duration) AS avg_duration
FROM drivers d
JOIN pitStops p ON d.driverId = p.driverId
WHERE d.nationality = 'German' AND YEAR(d.dob) BETWEEN 1980 AND 1985
GROUP BY d.driverId, d.forename, d.surname
ORDER BY avg_duration ASC
LIMIT 5;
```
-------------------------10417 sample_num
```sql
SELECT d.forename, d.surname, r.time
FROM results r
JOIN races ra ON r.raceId = ra.raceId
JOIN drivers d ON r.driverId = d.driverId
WHERE ra.year = 2008 AND ra.name = 'Canadian Grand Prix' AND r.positionOrder = 1;
```
-------------------------10418 sample_num
```sql
SELECT c.constructorRef, c.url
FROM constructorResults cr
JOIN results r ON cr.raceId = r.raceId AND cr.constructorId = r.constructorId
JOIN constructors c ON cr.constructorId = c.constructorId
WHERE r.raceId = (SELECT raceId FROM races WHERE year = 2009 AND name = 'Singapore Grand Prix')
AND cr.points = (SELECT MAX(points) FROM constructorResults WHERE raceId = (SELECT raceId FROM races WHERE year = 2009 AND name = 'Singapore Grand Prix'));
```
-------------------------10419 sample_num
```sql
SELECT CONCAT(forename, ' ', surname) AS full_name, dob 
FROM drivers 
WHERE nationality = 'Austrian' AND YEAR(dob) BETWEEN 1981 AND 1991;
```
-------------------------10420 sample_num
```sql
SELECT CONCAT(forename, ' ', surname) AS full_name, url AS wikipedia_page, dob
FROM drivers
WHERE nationality = 'German' AND YEAR(dob) BETWEEN 1971 AND 1985
ORDER BY dob DESC;
```
-------------------------10421 sample_num
```sql
SELECT location, country, lat, lng 
FROM circuits 
WHERE circuitRef = 'hungaroring';
```
-------------------------10422 sample_num
```sql
SELECT 
    SUM(cr.points) AS score, 
    c.name, 
    c.nationality 
FROM 
    races r 
JOIN 
    constructorResults cr ON r.raceId = cr.raceId 
JOIN 
    constructors c ON cr.constructorId = c.constructorId 
WHERE 
    r.name = 'Monaco Grand Prix' 
    AND r.year BETWEEN 1980 AND 2010 
GROUP BY 
    c.constructorId 
ORDER BY 
    score DESC 
LIMIT 1;
```
-------------------------10423 sample_num
```sql
SELECT AVG(ds.points) AS average_score
FROM driverStandings ds
JOIN races r ON ds.raceId = r.raceId
JOIN drivers d ON ds.driverId = d.driverId
WHERE d.forename = 'Lewis' AND d.surname = 'Hamilton' AND r.name LIKE '%Turkish Grand Prix%';
```
-------------------------10424 sample_num
```sql
SELECT AVG(race_count) AS annual_average_races
FROM (
    SELECT YEAR(date) AS year, COUNT(*) AS race_count
    FROM races
    WHERE date BETWEEN '2000-01-01' AND '2010-12-31'
    GROUP BY YEAR(date)
) AS yearly_races;
```
-------------------------10425 sample_num
```sql
SELECT nationality, COUNT(*) as count
FROM drivers
GROUP BY nationality
ORDER BY count DESC
LIMIT 1;
```
-------------------------10426 sample_num
```sql
SELECT COUNT(*) AS victories
FROM driverStandings ds
JOIN results r ON ds.raceId = r.raceId AND ds.driverId = r.driverId
WHERE ds.position = 91 AND r.positionOrder = 1;
```
-------------------------10427 sample_num
```sql
SELECT r.name
FROM results res
JOIN races r ON res.raceId = r.raceId
WHERE res.fastestLapSpeed = (
    SELECT MIN(fastestLapSpeed)
    FROM results
)
```
-------------------------10428 sample_num
```sql
SELECT CONCAT(c.location, ', ', c.country) AS full_location
FROM races r
JOIN circuits c ON r.circuitId = c.circuitId
WHERE r.date = (SELECT MAX(date) FROM races);
```
-------------------------10429 sample_num
```sql
SELECT CONCAT(d.forename, ' ', d.surname) AS full_name
FROM qualifying q
JOIN races r ON q.raceId = r.raceId
JOIN drivers d ON q.driverId = d.driverId
JOIN circuits c ON r.circuitId = c.circuitId
WHERE r.year = 2008 AND r.round = 3 AND c.circuitRef = 'marina_bay' AND q.position = 1;
```
-------------------------10430 sample_num
```sql
SELECT CONCAT(d.forename, ' ', d.surname) AS full_name, d.nationality, r.name AS first_race
FROM drivers d
JOIN results res ON d.driverId = res.driverId
JOIN races r ON res.raceId = r.raceId
WHERE d.dob = (SELECT MAX(dob) FROM drivers)
ORDER BY r.date ASC
LIMIT 1;
```
-------------------------10431 sample_num
```sql
SELECT COUNT(*) AS accident_count
FROM results
WHERE raceId = (SELECT raceId FROM races WHERE name = 'Canadian Grand Prix')
AND driverId = (SELECT driverId 
                FROM results 
                WHERE raceId = (SELECT raceId FROM races WHERE name = 'Canadian Grand Prix') 
                AND statusId = 3 
                GROUP BY driverId 
                ORDER BY COUNT(*) DESC 
                LIMIT 1)
AND statusId = 3;
```
-------------------------10432 sample_num
```sql
SELECT CONCAT(forename, ' ', surname) AS full_name, COUNT(results.resultId) AS wins
FROM drivers
JOIN results ON drivers.driverId = results.driverId
WHERE dob = (SELECT MIN(dob) FROM drivers)
GROUP BY full_name;
```
-------------------------10433 sample_num
```sql
SELECT MAX(duration) AS longestPitStopTime
FROM pitStops;
```
-------------------------10434 sample_num
```sql
SELECT MIN(time) AS fastest_lap_time
FROM lapTimes;
```
-------------------------10435 sample_num
```sql
SELECT MAX(duration) AS longest_pit_stop_time
FROM pitStops
JOIN drivers ON pitStops.driverId = drivers.driverId
WHERE drivers.forename = 'Lewis' AND drivers.surname = 'Hamilton';
```
-------------------------10436 sample_num
```sql
SELECT pitStops.lap 
FROM pitStops 
JOIN races ON pitStops.raceId = races.raceId 
JOIN drivers ON pitStops.driverId = drivers.driverId 
WHERE drivers.forename = 'Lewis' 
AND drivers.surname = 'Hamilton' 
AND races.year = 2011 
AND races.name = 'Australian Grand Prix';
```
-------------------------10437 sample_num
```sql
SELECT p.driverId, p.duration
FROM pitStops p
JOIN races r ON p.raceId = r.raceId
WHERE r.year = 2011 AND r.name = 'Australian Grand Prix';
```
-------------------------10438 sample_num
```sql
SELECT MIN(lapTimes.time) AS lap_record
FROM lapTimes
JOIN results ON lapTimes.raceId = results.raceId AND lapTimes.driverId = results.driverId
JOIN drivers ON results.driverId = drivers.driverId
WHERE drivers.forename = 'Lewis' AND drivers.surname = 'Hamilton';
```
-------------------------10439 sample_num
```sql
SELECT CONCAT(d.forename, ' ', d.surname) AS full_name
FROM lapTimes lt
JOIN drivers d ON lt.driverId = d.driverId
WHERE lt.time = (SELECT MIN(time) FROM lapTimes);
```
-------------------------10440 sample_num
```sql
SELECT r.position
FROM results r
JOIN lapTimes l ON r.raceId = l.raceId AND r.driverId = l.driverId
JOIN drivers d ON r.driverId = d.driverId
WHERE d.forename = 'Lewis' AND d.surname = 'Hamilton' 
AND l.time = (SELECT MIN(time) FROM lapTimes WHERE raceId = r.raceId AND driverId = r.driverId);
```
-------------------------10441 sample_num
```sql
SELECT MIN(lapTimes.time) AS lap_record
FROM lapTimes
JOIN races ON lapTimes.raceId = races.raceId
JOIN circuits ON races.circuitId = circuits.circuitId
WHERE circuits.circuitRef = 'austrian' AND races.name LIKE '%Grand Prix%';
```
-------------------------10442 sample_num
```sql
SELECT l.raceId, l.driverId, l.lap, l.time, l.milliseconds, c.name AS circuitName
FROM lapTimes l
JOIN races r ON l.raceId = r.raceId
JOIN circuits c ON r.circuitId = c.circuitId
WHERE c.country = 'Italy' AND l.time = (
    SELECT MIN(time)
    FROM lapTimes
    WHERE raceId = l.raceId
)
ORDER BY l.raceId, l.lap;
```
-------------------------10443 sample_num
```sql
SELECT r.name, l.time
FROM races r
JOIN lapTimes l ON r.raceId = l.raceId
JOIN circuits c ON r.circuitId = c.circuitId
WHERE c.name = 'Austrian Grand Prix'
ORDER BY l.time ASC
LIMIT 1;
```
-------------------------10444 sample_num
```sql
SELECT p.duration
FROM races r
JOIN lapTimes l ON r.raceId = l.raceId
JOIN pitStops p ON r.raceId = p.raceId AND l.driverId = p.driverId
WHERE r.circuitId = (SELECT circuitId FROM circuits WHERE circuitRef = 'austrian')
AND l.time = (SELECT MIN(time) FROM lapTimes WHERE raceId = r.raceId);
```
-------------------------10445 sample_num
```sql
SELECT c.lat, c.lng
FROM circuits c
JOIN results r ON c.circuitId = r.circuitId
WHERE r.fastestLapTime = '1:29.488';
```
-------------------------10446 sample_num
```sql
SELECT AVG(duration) AS average_pit_stop_time
FROM pitStops
JOIN drivers ON pitStops.driverId = drivers.driverId
WHERE drivers.forename = 'Lewis' AND drivers.surname = 'Hamilton';
```
-------------------------10447 sample_num
```sql
SELECT AVG(lapTimes.milliseconds) AS average_lap_time
FROM lapTimes
JOIN races ON lapTimes.raceId = races.raceId
JOIN circuits ON races.circuitId = circuits.circuitId
WHERE circuits.country = 'Italy';
```
-------------------------10448 sample_num
```sql
SELECT player_api_id 
FROM Player_Attributes 
WHERE overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes);
```
-------------------------10449 sample_num
```sql
SELECT player_name, height 
FROM Player 
ORDER BY height DESC 
LIMIT 1;
```
-------------------------10450 sample_num
```sql
SELECT preferred_foot 
FROM Player_Attributes 
WHERE potential = (SELECT MIN(potential) FROM Player_Attributes);
```
-------------------------10451 sample_num
```sql
SELECT COUNT(*) 
FROM Player_Attributes 
WHERE overall_rating >= 60 AND overall_rating < 65 
AND defensive_work_rate = 'low';
```
-------------------------10452 sample_num
```sql
SELECT player_api_id
FROM Player_Attributes
ORDER BY crossing DESC
LIMIT 5;
```
-------------------------10453 sample_num
```sql
SELECT l.name, SUM(m.home_team_goal + m.away_team_goal) AS total_goals
FROM Match m
JOIN League l ON m.league_id = l.id
WHERE m.season = '2015/2016'
GROUP BY l.name
ORDER BY total_goals DESC
LIMIT 1;
```
-------------------------10454 sample_num
```sql
SELECT home_team_api_id, COUNT(*) AS lost_matches
FROM Match
WHERE season = '2015/2016' AND (home_team_goal - away_team_goal) < 0
GROUP BY home_team_api_id
ORDER BY lost_matches ASC
LIMIT 1;
```
-------------------------10455 sample_num
```sql
SELECT player_name
FROM Player_Attributes
ORDER BY penalties DESC
LIMIT 10;
```
-------------------------10456 sample_num
```sql
SELECT away_team_api_id, COUNT(*) AS away_wins
FROM Match
WHERE league_id = (SELECT id FROM League WHERE name = 'Scotland Premier League')
  AND season = '2009/2010'
  AND away_team_goal > home_team_goal
GROUP BY away_team_api_id
ORDER BY away_wins DESC
LIMIT 1;
```
-------------------------10457 sample_num
```sql
SELECT team_fifa_api_id, buildUpPlaySpeed
FROM Team_Attributes
ORDER BY buildUpPlaySpeed DESC
LIMIT 4;
```
-------------------------10458 sample_num
```sql
SELECT l.name, COUNT(*) AS draw_count
FROM Match m
JOIN League l ON m.league_id = l.id
WHERE m.season = '2015/2016' AND m.home_team_goal = m.away_team_goal
GROUP BY l.id
ORDER BY draw_count DESC
LIMIT 1;
```
-------------------------10459 sample_num
```sql
SELECT 
    player_name, 
    FLOOR(DATEDIFF(CURDATE(), birthday) / 365) AS age
FROM 
    Player 
JOIN 
    Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id
WHERE 
    sprint_speed >= 97 
    AND date >= '2013-01-01 00:00:00' 
    AND date <= '2015-12-31 00:00:00';
```
-------------------------10460 sample_num
```sql
SELECT L.name, COUNT(M.id) AS match_count
FROM Match M
JOIN League L ON M.league_id = L.id
GROUP BY L.id
ORDER BY match_count DESC
LIMIT 1;
```
-------------------------10461 sample_num
```sql
SELECT AVG(height) AS average_height
FROM Player
WHERE birthday >= '1990-01-01 00:00:00' AND birthday < '1996-01-01 00:00:00';
```
-------------------------10462 sample_num
```sql
SELECT player_api_id 
FROM Player_Attributes 
WHERE overall_rating > (SELECT AVG(overall_rating) 
                         FROM Player_Attributes 
                         WHERE substr(date, 1, 4) = '2010') 
  AND substr(date, 1, 4) = '2010'
GROUP BY player_api_id;
```
-------------------------10463 sample_num
```sql
SELECT team_fifa_api_id 
FROM Team_Attributes 
WHERE buildUpPlaySpeed BETWEEN 51 AND 59;
```
-------------------------10464 sample_num
```sql
SELECT t.team_long_name
FROM Team_Attributes t
WHERE t.date BETWEEN '2012-01-01' AND '2012-12-31'
AND t.buildUpPlayPassing > (
    SELECT AVG(buildUpPlayPassing)
    FROM Team_Attributes
    WHERE buildUpPlayPassing IS NOT NULL
    AND strftime('%Y', date) = '2012'
)
```
-------------------------10465 sample_num
```sql
SELECT 
    (SUM(CASE WHEN preferred_foot = 'left' THEN 1 ELSE 0 END) * 1.0 / COUNT(player_fifa_api_id)) * 100 AS percentage_left_foot
FROM 
    Player
WHERE 
    birthday BETWEEN '1987-01-01 00:00:00' AND '1992-12-31 00:00:00';
```
-------------------------10466 sample_num
```sql
SELECT L.name, SUM(M.home_team_goal + M.away_team_goal) AS total_goals
FROM Match M
JOIN League L ON M.league_id = L.id
GROUP BY L.id
ORDER BY total_goals ASC
LIMIT 5;
```
-------------------------10467 sample_num
```sql
SELECT AVG(long_shots) AS average_long_shots
FROM Player_Attributes
WHERE player_fifa_api_id = (SELECT player_fifa_api_id FROM Player WHERE player_name = 'Ahmed Samir Farag');
```
-------------------------10468 sample_num
```sql
SELECT p.player_name
FROM Player p
JOIN Player_Attributes pa ON p.player_fifa_api_id = pa.player_fifa_api_id
WHERE p.height > 180
GROUP BY p.player_name
ORDER BY AVG(pa.heading_accuracy) DESC
LIMIT 10;
```
-------------------------10469 sample_num
```sql
SELECT t.team_long_name, ta.chanceCreationPassing
FROM Team_Attributes ta
JOIN Team t ON ta.team_fifa_api_id = t.team_fifa_api_id
WHERE ta.buildUpPlayDribblingClass = 'Normal'
AND ta.date >= '2014-01-01 00:00:00' AND ta.date <= '2014-01-31 00:00:00'
AND ta.chanceCreationPassing < (
    SELECT AVG(chanceCreationPassing)
    FROM Team_Attributes
    WHERE date >= '2014-01-01 00:00:00' AND date <= '2014-01-31 00:00:00'
)
ORDER BY ta.chanceCreationPassing DESC;
```
-------------------------10470 sample_num
```sql
SELECT L.name
FROM Match M
JOIN League L ON M.league_id = L.id
WHERE M.season = '2009/2010'
GROUP BY L.name
HAVING AVG(M.home_team_goal) > AVG(M.away_team_goal;
```
-------------------------10471 sample_num
```sql
SELECT team_short_name 
FROM Team 
WHERE team_long_name = 'Queens Park Rangers';
```
-------------------------10472 sample_num
```sql
SELECT player_name 
FROM Player 
WHERE substr(birthday, 1, 4) = '1970' AND substr(birthday, 6, 2) = '10';
```
-------------------------10473 sample_num
```sql
SELECT pa.attacking_work_rate 
FROM Player_Attributes pa 
JOIN Player p ON pa.player_api_id = p.player_api_id 
WHERE p.player_name = 'Franco Zennaro';
```
-------------------------10474 sample_num
```sql
SELECT buildUpPlayPositioningClass 
FROM Team_Attributes 
WHERE team_fifa_api_id = (SELECT team_fifa_api_id FROM Team WHERE team_long_name = 'ADO Den Haag');
```
-------------------------10475 sample_num
```sql
SELECT heading_accuracy 
FROM Player_Attributes 
WHERE player_fifa_api_id = (SELECT player_fifa_api_id FROM Player WHERE player_name = 'Francois Affolter') 
AND date = '2014-09-18 00:00:00';
```
-------------------------10476 sample_num
```sql
SELECT pa.overall_rating 
FROM Player_Attributes pa 
JOIN Player p ON pa.player_api_id = p.player_api_id 
WHERE p.player_name = 'Gabriel Tamas' AND strftime('%Y', pa.date) = '2011';
```
-------------------------10477 sample_num
```sql
SELECT COUNT(*) 
FROM Match m 
JOIN League l ON m.league_id = l.id 
WHERE l.name = 'Scotland Premier League' AND m.season = '2015/2016';
```
-------------------------10478 sample_num
```sql
SELECT preferred_foot 
FROM Player 
ORDER BY birthday DESC 
LIMIT 1;
```
-------------------------10479 sample_num
```sql
SELECT player_name, potential 
FROM Player 
JOIN Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id 
WHERE potential = (SELECT MAX(potential) FROM Player_Attributes);
```
-------------------------10480 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE weight < 130 AND preferred_foot = 'left';
```
-------------------------10481 sample_num
```sql
SELECT team_short_name 
FROM Team_Attributes 
WHERE chanceCreationPassingClass = 'Risky';
```
-------------------------10482 sample_num
```sql
SELECT pa.defensive_work_rate 
FROM Player_Attributes pa 
JOIN Player p ON pa.player_api_id = p.player_api_id 
WHERE p.player_name = 'David Wilson';
```
-------------------------10483 sample_num
```sql
SELECT p.birthday 
FROM Player p 
JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id 
WHERE pa.overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes);
```
-------------------------10484 sample_num
```sql
SELECT League.name 
FROM League 
JOIN Country ON League.country_id = Country.id 
WHERE Country.name = 'Netherlands';
```
-------------------------10485 sample_num
```sql
SELECT AVG(home_team_goal) 
FROM Match 
JOIN Country ON Match.country_id = Country.id 
WHERE Country.name = 'Poland' AND Match.season = '2010/2011';
```
-------------------------10486 sample_num
```sql
SELECT AVG(pa.finishing) AS average_finishing_rate
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE p.height = (SELECT MAX(height) FROM Player)
   OR p.height = (SELECT MIN(height) FROM Player)
GROUP BY p.height
ORDER BY average_finishing_rate DESC
LIMIT 1;
```
-------------------------10487 sample_num
```sql
SELECT player_name FROM Player WHERE height > 180;
```
-------------------------10488 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE strftime('%Y', birthday) > '1990';
```
-------------------------10489 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE player_name LIKE 'Adam%' AND weight > 170;
```
-------------------------10490 sample_num
```sql
SELECT p.player_name 
FROM Player_Attributes pa 
JOIN Player p ON pa.player_api_id = p.player_api_id 
WHERE pa.overall_rating > 80 
AND strftime('%Y', pa.date) BETWEEN '2008' AND '2010';
```
-------------------------10491 sample_num
```sql
SELECT potential 
FROM Player_Attributes 
WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Aaron Doran');
```
-------------------------10492 sample_num
```sql
SELECT * FROM Player WHERE player_api_id IN (SELECT player_api_id FROM Player_Attributes WHERE preferred_foot = 'left');
```
-------------------------10493 sample_num
```sql
SELECT team_long_name 
FROM Team_Attributes 
WHERE buildUpPlaySpeedClass = 'Fast';
```
-------------------------10494 sample_num
```sql
SELECT buildUpPlayPassingClass 
FROM Team_Attributes 
WHERE team_short_name = 'CLB';
```
-------------------------10495 sample_num
```sql
SELECT team_short_name 
FROM Team_Attributes 
WHERE buildUpPlayPassing > 70;
```
-------------------------10496 sample_num
```sql
SELECT AVG(pa.overall_rating) AS average_overall_rating
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE strftime('%Y', pa.date) BETWEEN '2010' AND '2015' 
AND p.height > 170;
```
-------------------------10497 sample_num
```sql
SELECT player_name, height 
FROM Player 
ORDER BY height ASC 
LIMIT 1;
```
-------------------------10498 sample_num
```sql
SELECT Country.name 
FROM League 
JOIN Country ON League.country_id = Country.id 
WHERE League.name = 'Italy Serie A';
```
-------------------------10499 sample_num
```sql
SELECT team_short_name 
FROM Team_Attributes 
WHERE buildUpPlaySpeed = 31 
  AND buildUpPlayDribbling = 53 
  AND buildUpPlayPassing = 32;
```
-------------------------10500 sample_num
```sql
SELECT AVG(pa.overall_rating) AS average_overall_rating
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE p.player_name = 'Aaron Doran';
```
-------------------------10501 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE league_id = (SELECT id FROM League WHERE name = 'Germany 1. Bundesliga') 
AND strftime('%Y-%m', date) BETWEEN '2008-08' AND '2008-10';
```
-------------------------10502 sample_num
```sql
SELECT T.team_short_name 
FROM Match M 
JOIN Team T ON M.home_team_api_id = T.team_api_id 
WHERE M.home_team_goal = 10;
```
-------------------------10503 sample_num
```sql
SELECT p.player_name
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE pa.balance = (SELECT MAX(balance) FROM Player_Attributes WHERE potential = 61)
AND pa.potential = 61;
```
-------------------------10504 sample_num
```sql
SELECT 
    (SELECT AVG(pa.ball_control) FROM Player_Attributes pa 
     JOIN Player p ON pa.player_api_id = p.player_api_id 
     WHERE p.player_name = 'Abdou Diallo') - 
    (SELECT AVG(pa.ball_control) FROM Player_Attributes pa 
     JOIN Player p ON pa.player_api_id = p.player_api_id 
     WHERE p.player_name = 'Aaron Appindangoye') AS ball_control_difference;
```
-------------------------10505 sample_num
```sql
SELECT team_long_name FROM Team WHERE team_short_name = 'GEN';
```
-------------------------10506 sample_num
```sql
SELECT player_name, birthday 
FROM Player 
WHERE player_name IN ('Aaron Lennon', 'Abdelaziz Barrada') 
ORDER BY birthday ASC 
LIMIT 1;
```
-------------------------10507 sample_num
```sql
SELECT player_name, height 
FROM Player 
WHERE height = (SELECT MAX(height) FROM Player);
```
-------------------------10508 sample_num
```sql
SELECT COUNT(*) 
FROM Player_Attributes 
WHERE preferred_foot = 'left' 
AND attacking_work_rate = 'low';
```
-------------------------10509 sample_num
```sql
SELECT Country.name 
FROM League 
JOIN Country ON League.country_id = Country.id 
WHERE League.name = 'Belgium Jupiler League';
```
-------------------------10510 sample_num
```sql
SELECT name FROM League WHERE country_id = (SELECT id FROM Country WHERE name = 'Germany');
```
-------------------------10511 sample_num
```sql
SELECT player_name, overall_rating 
FROM Player 
JOIN Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id 
WHERE overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes);
```
-------------------------10512 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
JOIN Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id 
WHERE strftime('%Y', birthday) < '1986' 
AND defensive_work_rate = 'high';
```
-------------------------10513 sample_num
```sql
SELECT player_name, MAX(crossing) AS best_crossing
FROM Player_Attributes
JOIN Player ON Player_Attributes.player_api_id = Player.player_api_id
WHERE player_name IN ('Alexis', 'Ariel Borysiuk', 'Arouna Kone')
GROUP BY player_name
ORDER BY best_crossing DESC
LIMIT 1;
```
-------------------------10514 sample_num
```sql
SELECT pa.heading_accuracy 
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE p.player_name = 'Ariel Borysiuk';
```
-------------------------10515 sample_num
```sql
SELECT COUNT(DISTINCT p.id) 
FROM Player p 
JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id 
WHERE p.height > 180 AND pa.volleys > 70;
```
-------------------------10516 sample_num
```sql
SELECT p.player_name
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE pa.volleys > 70 AND pa.dribbling > 70;
```
-------------------------10517 sample_num
```sql
SELECT COUNT(*) 
FROM Match m 
JOIN Country c ON m.country_id = c.id 
WHERE c.name = 'Belgium' AND m.season = '2008/2009';
```
-------------------------10518 sample_num
```sql
SELECT long_passing 
FROM Player_Attributes 
WHERE player_api_id = (
    SELECT player_api_id 
    FROM Player 
    ORDER BY birthday ASC 
    LIMIT 1
);
```
-------------------------10519 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE league_id = (SELECT id FROM League WHERE name = 'Belgium Jupiler League') 
AND strftime('%Y', date) = '2009' 
AND strftime('%m', date) = '04';
```
-------------------------10520 sample_num
```sql
SELECT league_id, COUNT(*) AS match_count
FROM Match
WHERE season = '2008/2009'
GROUP BY league_id
ORDER BY match_count DESC
LIMIT 1;
```
-------------------------10521 sample_num
```sql
SELECT AVG(overall_rating) AS average_overall_rating
FROM Player_Attributes
JOIN Player ON Player_Attributes.player_api_id = Player.player_api_id
WHERE strftime('%Y', birthday) < '1986';
```
-------------------------10522 sample_num
```sql
SELECT 
    (SELECT overall_rating FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Ariel Borysiuk')) -
    (SELECT overall_rating FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Paulin Puel')) AS difference,
    ((SELECT overall_rating FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Ariel Borysiuk')) -
    (SELECT overall_rating FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Paulin Puel'))) /
    (SELECT overall_rating FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Paulin Puel')) * 100 AS percentage_difference;
```
-------------------------10523 sample_num
```sql
SELECT AVG(ta.buildUpPlaySpeed) AS average_build_up_play_speed
FROM Team_Attributes ta
JOIN Team t ON ta.team_fifa_api_id = t.team_fifa_api_id
WHERE t.team_long_name = 'Heart of Midlothian';
```
-------------------------10524 sample_num
```sql
SELECT AVG(T1.overall_rating) AS average_overall_rating
FROM Player_Attributes T1
JOIN Player T2 ON T1.player_api_id = T2.player_api_id
WHERE T2.player_name = 'Pietro Marino';
```
-------------------------10525 sample_num
```sql
SELECT SUM(pa.crossing) AS total_crossing_score
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE p.player_name = 'Aaron Lennox';
```
-------------------------10526 sample_num
```sql
SELECT MAX(chanceCreationPassing) AS highest_chance_creation_passing_score, 
       chanceCreationPassingClass 
FROM Team_Attributes 
WHERE team_fifa_api_id = (SELECT team_fifa_api_id FROM Team WHERE team_long_name = 'Ajax');
```
-------------------------10527 sample_num
```sql
SELECT preferred_foot 
FROM Player 
JOIN Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id 
WHERE player_name = 'Abdou Diallo';
```
-------------------------10528 sample_num
```sql
SELECT MAX(pa.overall_rating) AS highest_overall_rating
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE p.player_name = 'Dorlan Pabon';
```
-------------------------10529 sample_num
```sql
SELECT AVG(away_team_goal) AS average_goals
FROM Match m
JOIN Team t ON m.away_team_api_id = t.team_api_id
WHERE t.team_long_name = 'Parma' AND m.country_id = (SELECT id FROM Country WHERE name = 'Italy');
```
-------------------------10530 sample_num
```sql
SELECT player_name 
FROM Player 
WHERE player_api_id IN (
    SELECT player_api_id 
    FROM Player_Attributes 
    WHERE overall_rating = 77 AND date = '2016-06-23'
) 
ORDER BY birthday ASC 
LIMIT 1;
```
-------------------------10531 sample_num
```sql
SELECT pa.overall_rating 
FROM Player_Attributes pa 
JOIN Player p ON pa.player_api_id = p.player_api_id 
WHERE p.player_name = 'Aaron Mooy' AND pa.date = '2016-02-04 00:00:00';
```
-------------------------10532 sample_num
```sql
SELECT potential 
FROM Player_Attributes 
WHERE player_fifa_api_id = (SELECT player_fifa_api_id FROM Player WHERE player_name = 'Francesco Parravicini') 
AND date = '2010-08-30 00:00:00';
```
-------------------------10533 sample_num
```sql
SELECT pa.attacking_work_rate 
FROM Player_Attributes pa 
JOIN Player p ON pa.player_api_id = p.player_api_id 
WHERE p.player_name = 'Francesco Migliore' AND pa.date = '2015-05-01 00:00:00';
```
-------------------------10534 sample_num
```sql
SELECT pa.defensive_work_rate 
FROM Player_Attributes pa 
JOIN Player p ON pa.player_api_id = p.player_api_id 
WHERE p.player_name = 'Kevin Berigaud' AND pa.date = '2013-02-22 00:00:00';
```
-------------------------10535 sample_num
```sql
SELECT date 
FROM Player_Attributes 
WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Kevin Constant') 
AND crossing = (SELECT MAX(crossing) FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Kevin Constant')) 
ORDER BY date 
LIMIT 1;
```
-------------------------10536 sample_num
```sql
SELECT ta.buildUpPlaySpeedClass 
FROM Team_Attributes ta 
JOIN Team t ON ta.team_fifa_api_id = t.team_fifa_api_id 
WHERE t.team_long_name = 'Willem II' AND ta.date = '2012-02-22 00:00:00';
```
-------------------------10537 sample_num
```sql
SELECT buildUpPlayDribblingClass 
FROM Team_Attributes 
WHERE team_fifa_api_id = (SELECT team_fifa_api_id FROM Team WHERE team_short_name = 'LEI') 
AND date = '2015-09-10 00:00:00';
```
-------------------------10538 sample_num
```sql
SELECT buildUpPlayPassingClass 
FROM Team_Attributes 
WHERE team_fifa_api_id = (SELECT team_fifa_api_id FROM Team WHERE team_long_name = 'FC Lorient') 
AND date = '2010-02-22';
```
-------------------------10539 sample_num
```sql
SELECT chanceCreationPassingClass 
FROM Team_Attributes 
WHERE team_fifa_api_id = (SELECT team_fifa_api_id FROM Team WHERE team_long_name = 'PEC Zwolle') 
AND date = '2013-09-20 00:00:00';
```
-------------------------10540 sample_num
```sql
SELECT ta.chanceCreationCrossingClass 
FROM Team_Attributes ta 
JOIN Team t ON ta.team_fifa_api_id = t.team_fifa_api_id 
WHERE t.team_long_name = 'Hull City' AND ta.date = '2010-02-22 00:00:00';
```
-------------------------10541 sample_num
```sql
SELECT defenceAggressionClass 
FROM Team_Attributes 
WHERE team_fifa_api_id = (SELECT team_fifa_api_id FROM Team WHERE team_long_name = 'Hannover 96') 
AND date = '2015-09-10 00:00:00';
```
-------------------------10542 sample_num
```sql
SELECT AVG(pa.overall_rating) AS average_overall_rating
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE p.player_name = 'Marko Arnautovic'
AND pa.date BETWEEN '2007-02-22 00:00:00' AND '2016-04-21 00:00:00';
```
-------------------------10543 sample_num
```sql
SELECT 
    (SELECT overall_rating FROM Player_Attributes 
     WHERE player_fifa_api_id = (SELECT player_fifa_api_id FROM Player WHERE player_name = 'Landon Donovan') 
     AND date = '2013-07-12') AS landon_rating,
    (SELECT overall_rating FROM Player_Attributes 
     WHERE player_fifa_api_id = (SELECT player_fifa_api_id FROM Player WHERE player_name = 'Jordan Bowery') 
     AND date = '2013-07-12') AS jordan_rating,
    ((SELECT overall_rating FROM Player_Attributes 
      WHERE player_fifa_api_id = (SELECT player_fifa_api_id FROM Player WHERE player_name = 'Landon Donovan') 
      AND date = '2013-07-12') - 
     (SELECT overall_rating FROM Player_Attributes 
      WHERE player_fifa_api_id = (SELECT player_fifa_api_id FROM Player WHERE player_name = 'Jordan Bowery') 
      AND date = '2013-07-12')) / 
    (SELECT overall_rating FROM Player_Attributes 
     WHERE player_fifa_api_id = (SELECT player_fifa_api_id FROM Player WHERE player_name = 'Landon Donovan') 
     AND date = '2013-07-12') * 100 AS percentage_difference
```
-------------------------10544 sample_num
```sql
SELECT player_name 
FROM Player 
ORDER BY height DESC 
LIMIT 5;
```
-------------------------10545 sample_num
```sql
SELECT player_api_id 
FROM Player 
ORDER BY weight DESC 
LIMIT 10;
```
-------------------------10546 sample_num
```sql
SELECT player_name 
FROM Player 
WHERE datetime('now', 'localtime') - datetime(birthday) > 34 * 365.25;
```
-------------------------10547 sample_num
```sql
SELECT SUM(m.home_team_goal) AS total_home_goals
FROM Match m
JOIN Player p ON FIND_IN_SET(p.player_api_id, m.home_player_X1, m.home_player_X2, m.home_player_X3, m.home_player_X4, m.home_player_X5, m.home_player_X6, m.home_player_X7, m.home_player_X8, m.home_player_X9, m.home_player_X10, m.home_player_X11)
WHERE p.player_name = 'Aaron Lennon';
```
-------------------------10548 sample_num
```sql
SELECT SUM(m.away_team_goal) AS total_away_goals
FROM Match m
JOIN Player p1 ON p1.player_api_id = m.away_player_X1 OR p1.player_api_id = m.away_player_X2 OR p1.player_api_id = m.away_player_X3 OR p1.player_api_id = m.away_player_X4 OR p1.player_api_id = m.away_player_X5 OR p1.player_api_id = m.away_player_X6 OR p1.player_api_id = m.away_player_X7 OR p1.player_api_id = m.away_player_X8 OR p1.player_api_id = m.away_player_X9 OR p1.player_api_id = m.away_player_X10 OR p1.player_api_id = m.away_player_X11
JOIN Player p2 ON p2.player_api_id = m.away_player_Y1 OR p2.player_api_id = m.away_player_Y2 OR p2.player_api_id = m.away_player_Y3 OR p2.player_api_id = m.away_player_Y4 OR p2.player_api_id = m.away_player_Y5 OR p2.player_api_id = m.away_player_Y6 OR p2.player_api_id = m.away_player_Y7 OR p2.player_api_id = m.away_player_Y8 OR p2.player_api_id = m.away_player_Y9 OR p2.player_api_id = m.away_player_Y10 OR p2.player_api_id = m.away_player_Y11
WHERE (p1.player_name = 'Daan Smith' OR p2.player_name = 'Filipe Ferreira');
```
-------------------------10549 sample_num
```sql
SELECT SUM(m.home_team_goal) AS total_home_goals
FROM Match m
JOIN Player p ON m.home_player_1 = p.player_api_id OR m.home_player_2 = p.player_api_id OR m.home_player_3 = p.player_api_id OR m.home_player_4 = p.player_api_id OR m.home_player_5 = p.player_api_id OR m.home_player_6 = p.player_api_id OR m.home_player_7 = p.player_api_id OR m.home_player_8 = p.player_api_id OR m.home_player_9 = p.player_api_id OR m.home_player_10 = p.player_api_id OR m.home_player_11 = p.player_api_id
WHERE (strftime('%Y', 'now') - strftime('%Y', p.birthday)) <= 30;
```
-------------------------10550 sample_num
```sql
SELECT player_name 
FROM Player 
JOIN Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id 
ORDER BY overall_rating DESC 
LIMIT 10;
```
-------------------------10551 sample_num
```sql
SELECT p.player_name 
FROM Player p 
JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id 
WHERE pa.potential = (SELECT MAX(potential) FROM Player_Attributes);
```
-------------------------10552 sample_num
```sql
SELECT player_name 
FROM Player 
JOIN Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id 
WHERE attacking_work_rate = 'high';
```
-------------------------10553 sample_num
```sql
SELECT player_name 
FROM Player 
WHERE player_api_id IN (
    SELECT player_api_id 
    FROM Player_Attributes 
    WHERE finishing = 1
) 
ORDER BY birthday ASC 
LIMIT 1;
```
-------------------------10554 sample_num
```sql
SELECT p.player_name 
FROM Player p 
JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id 
JOIN Team t ON pa.player_fifa_api_id = t.team_fifa_api_id 
JOIN Match m ON t.team_api_id = m.home_team_api_id OR t.team_api_id = m.away_team_api_id 
JOIN League l ON m.league_id = l.id 
JOIN Country c ON l.country_id = c.id 
WHERE c.name = 'Belgium';
```
-------------------------10555 sample_num
```sql
SELECT p.player_name, c.name AS country
FROM Player p
JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id
JOIN Team t ON p.player_api_id = t.team_api_id
JOIN Match m ON t.team_api_id = m.home_team_api_id OR t.team_api_id = m.away_team_api_id
JOIN Country c ON m.country_id = c.id
WHERE pa.vision > 89;
```
-------------------------10556 sample_num
```sql
SELECT c.name AS country_name, AVG(p.weight) AS average_weight
FROM Player p
JOIN Team t ON p.player_api_id = t.team_api_id
JOIN Match m ON t.team_api_id = m.home_team_api_id OR t.team_api_id = m.away_team_api_id
JOIN League l ON m.league_id = l.id
JOIN Country c ON l.country_id = c.id
GROUP BY c.name
ORDER BY average_weight DESC
LIMIT 1;
```
-------------------------10557 sample_num
```sql
SELECT team_long_name 
FROM Team_Attributes 
WHERE buildUpPlaySpeedClass = 'Slow';
```
-------------------------10558 sample_num
```sql
SELECT DISTINCT t.team_short_name
FROM Team_Attributes ta
JOIN Team t ON ta.team_fifa_api_id = t.team_fifa_api_id
WHERE ta.chanceCreationPassingClass = 'Safe';
```
-------------------------10559 sample_num
```sql
SELECT AVG(p.height) AS average_height
FROM Player p
JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id
JOIN Team t ON pa.player_fifa_api_id = t.team_fifa_api_id
JOIN Match m ON t.team_api_id = m.home_team_api_id OR t.team_api_id = m.away_team_api_id
JOIN League l ON m.league_id = l.id
JOIN Country c ON l.country_id = c.id
WHERE c.name = 'Italy';
```
-------------------------10560 sample_num
```sql
SELECT player_name 
FROM Player 
WHERE height > 180 
ORDER BY player_name 
LIMIT 3;
```
-------------------------10561 sample_num
```sql
SELECT COUNT(*) 
FROM Player 
WHERE player_name LIKE 'Aaron%' AND birthday > '1990-12-31';
```
-------------------------10562 sample_num
```sql
SELECT 
    (SELECT jumping FROM Player_Attributes WHERE player_api_id = 6) - 
    (SELECT jumping FROM Player_Attributes WHERE player_api_id = 23) AS jumping_difference;
```
-------------------------10563 sample_num
```sql
SELECT player_api_id 
FROM Player_Attributes 
WHERE potential = (SELECT MIN(potential) FROM Player_Attributes) 
AND preferred_foot = 'right' 
LIMIT 3;
```
-------------------------10564 sample_num
```sql
SELECT COUNT(*) 
FROM Player_Attributes 
WHERE crossing = (SELECT MAX(crossing) FROM Player_Attributes) 
AND preferred_foot = 'left';
```
-------------------------10565 sample_num
```sql
SELECT 
    (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM Player_Attributes)) AS percentage
FROM 
    Player_Attributes
WHERE 
    strength > 80 AND stamina > 80;
```
-------------------------10566 sample_num
```sql
SELECT c.name 
FROM League l 
JOIN Country c ON l.country_id = c.id 
WHERE l.name = 'Ekstraklasa' AND c.name = 'Poland';
```
-------------------------10567 sample_num
```sql
SELECT home_team_goal, away_team_goal 
FROM Match 
WHERE date LIKE '2008-09-24%' 
AND league_id = (SELECT id FROM League WHERE name = 'Belgian Jupiler League');
```
-------------------------10568 sample_num
```sql
SELECT pa.sprint_speed, pa.agility, pa.acceleration
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE p.player_name = 'Alexis Blin';
```
-------------------------10569 sample_num
```sql
SELECT buildUpPlaySpeedClass 
FROM Team_Attributes 
WHERE team_fifa_api_id = (SELECT team_fifa_api_id FROM Team WHERE team_long_name = 'KSV Cercle Brugge');
```
-------------------------10570 sample_num
```sql
SELECT COUNT(*) 
FROM Match 
WHERE season = '2015/2016' AND league_id = (SELECT id FROM League WHERE name = 'Serie A' AND country_id = (SELECT id FROM Country WHERE name = 'Italy'));
```
-------------------------10571 sample_num
```sql
SELECT MAX(home_team_goal) AS highest_home_score
FROM Match
WHERE league_id = (SELECT id FROM League WHERE name = 'Eredivisie' AND country_id = (SELECT id FROM Country WHERE name = 'Netherlands'));
```
-------------------------10572 sample_num
```sql
SELECT pa.finishing, pa.curve
FROM Player_Attributes pa
JOIN Player p ON pa.player_api_id = p.player_api_id
WHERE p.weight = (SELECT MAX(weight) FROM Player);
```
-------------------------10573 sample_num
```sql
SELECT l.name, COUNT(m.id) AS game_count
FROM Match m
JOIN League l ON m.league_id = l.id
WHERE m.season = '2015/2016'
GROUP BY l.name
ORDER BY game_count DESC
LIMIT 1;
```
-------------------------10574 sample_num
```sql
SELECT t.team_long_name
FROM Match m
JOIN Team t ON m.away_team_api_id = t.team_api_id
WHERE m.away_team_goal = (SELECT MAX(away_team_goal) FROM Match)
```
-------------------------10575 sample_num
```sql
SELECT player_name 
FROM Player 
JOIN Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id 
WHERE overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes);
```
-------------------------10576 sample_num
```sql
SELECT (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM Player WHERE height IS NOT NULL)) AS percentage
FROM Player p
JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id
WHERE p.height < 180 AND pa.overall_rating > 70;
```
-------------------------10577 sample_num
```sql
SELECT 
    (SELECT COUNT(ID) FROM Patient WHERE SEX = 'M' AND Admission = '+') AS Inpatient_Male,
    (SELECT COUNT(ID) FROM Patient WHERE SEX = 'M' AND Admission = '-') AS Outpatient_Male,
    (SELECT 
        (COUNT(ID) WHERE SEX = 'M' AND Admission = '+') - 
        (COUNT(ID) WHERE SEX = 'M' AND Admission = '-') 
     FROM Patient) AS Male_Deviation
FROM Patient;
```
-------------------------10578 sample_num
```sql
SELECT 
    (COUNT(ID) * 100.0 / (SELECT COUNT(ID) FROM Patient WHERE SEX = 'F')) AS FemalePercentage
FROM 
    Patient
WHERE 
    YEAR(Birthday) > 1930 AND SEX = 'F';
```
-------------------------10579 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Admission = '+' THEN 1 END) * 100.0 / COUNT(*)) AS inpatient_percentage
FROM 
    Patient
WHERE 
    Birthday BETWEEN '1930-01-01' AND '1940-12-31';
```
-------------------------10580 sample_num
```sql
SELECT 
    DIVIDE(
        COUNT(ID) WHERE Diagnosis = 'SLE' AND Admission = '+', 
        COUNT(ID) WHERE Diagnosis = 'SLE' AND Admission = '-'
    ) AS ratio
FROM Patient
WHERE Diagnosis = 'SLE';
```
-------------------------10581 sample_num
```sql
SELECT p.Diagnosis, l.Date 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE p.ID = '30609';
```
-------------------------10582 sample_num
```sql
SELECT Patient.SEX, Patient.Birthday, Examination.Examination_Date, Examination.Symptoms
FROM Patient
JOIN Examination ON Patient.ID = Examination.ID
WHERE Patient.ID = '163109';
```
-------------------------10583 sample_num
```sql
SELECT Patient.ID, Patient.SEX, Patient.Birthday
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.LDH > 500;
```
-------------------------10584 sample_num
```sql
SELECT Patient.ID, 
       SUBTRACT(YEAR(CURRENT_TIMESTAMP), YEAR(Patient.Birthday)) AS age
FROM Patient
JOIN Examination ON Patient.ID = Examination.ID
WHERE Examination.RVVT = '+';
```
-------------------------10585 sample_num
```sql
SELECT Patient.ID, Patient.SEX, Patient.Diagnosis
FROM Patient
JOIN Examination ON Patient.ID = Examination.ID
WHERE Examination.Thrombosis = 2;
```
-------------------------10586 sample_num
```sql
SELECT Patient.ID, Patient.SEX, Patient.Birthday, Patient.Description, Patient.First_Date, Patient.Admission, Patient.Diagnosis
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE YEAR(Patient.Birthday) = '1937' AND Laboratory.T-CHO >= '250';
```
-------------------------10587 sample_num
```sql
SELECT Patient.ID, Patient.SEX, Patient.Diagnosis
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.ALB < 3.5;
```
-------------------------10588 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN P.SEX = 'F' AND L.TP < 6.0 OR L.TP > 8.5 THEN 1 END) * 100.0) / COUNT(P.ID) AS Percentage_Female_Abnormal_TP
FROM 
    Patient P
JOIN 
    Laboratory L ON P.ID = L.ID
WHERE 
    P.SEX = 'F';
```
-------------------------10589 sample_num
```sql
SELECT AVG(Examination.aCL_IgG) AS average_aCL_IgG
FROM Patient
JOIN Examination ON Patient.ID = Examination.ID
WHERE Patient.Admission = '+' 
AND (YEAR(CURRENT_TIMESTAMP) - YEAR(Patient.Birthday)) >= 50;
```
-------------------------10590 sample_num
```sql
SELECT COUNT(*) 
FROM Patient 
WHERE SEX = 'F' AND YEAR(Description) = 1997 AND Admission = '-';
```
-------------------------10591 sample_num
```sql
SELECT MIN(YEAR(`First Date`) - YEAR(Birthday)) AS Youngest_Age
FROM Patient;
```
-------------------------10592 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) AS WomenWithSeriousThrombosis
FROM Examination e
JOIN Patient p ON e.ID = p.ID
WHERE e.Thrombosis = '1' AND p.SEX = 'F' AND YEAR(e.Examination_Date) = 1997;
```
-------------------------10593 sample_num
```sql
SELECT MAX(YEAR(Birthday)) - MIN(YEAR(Birthday)) AS age_gap
FROM Patient
WHERE ID IN (
    SELECT ID
    FROM Laboratory
    WHERE TG < 200
)
```
-------------------------10594 sample_num
```sql
SELECT E.Symptoms, P.Diagnosis
FROM Examination E
JOIN Patient P ON E.ID = P.ID
WHERE P.Birthday = (SELECT MIN(Birthday) FROM Patient);
```
-------------------------10595 sample_num
```sql
SELECT DIVIDE(COUNT(L.ID), 12) AS Average_Male_Patients
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE P.SEX = 'M' AND L.Date BETWEEN '1998-01-01' AND '1998-12-31';
```
-------------------------10596 sample_num
```sql
SELECT 
    MAX(L.Date) AS Lab_Work_Completion_Date, 
    YEAR(P.First_Date) - YEAR(P.Birthday) AS Age_At_Admission
FROM 
    Patient P
JOIN 
    Laboratory L ON P.ID = L.ID
WHERE 
    P.Diagnosis = 'SJS'
GROUP BY 
    P.ID
ORDER BY 
    P.Birthday ASC
LIMIT 1;
```
-------------------------10597 sample_num
```sql
SELECT 
    SUM(CASE WHEN SEX = 'M' AND UA <= 8.0 THEN 1 ELSE 0 END) AS Male_Abnormal,
    SUM(CASE WHEN SEX = 'F' AND UA <= 6.5 THEN 1 ELSE 0 END) AS Female_Abnormal,
    CASE 
        WHEN SUM(CASE WHEN SEX = 'F' AND UA <= 6.5 THEN 1 ELSE 0 END) = 0 THEN NULL
        ELSE SUM(CASE WHEN SEX = 'M' AND UA <= 8.0 THEN 1 ELSE 0 END) * 1.0 / SUM(CASE WHEN SEX = 'F' AND UA <= 6.5 THEN 1 ELSE 0 END)
    END AS Male_to_Female_Ratio
FROM 
    Patient p
JOIN 
    Laboratory l ON p.ID = l.ID
WHERE 
    (SEX = 'M' AND UA <= 8.0) OR (SEX = 'F' AND UA <= 6.5);
```
-------------------------10598 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) AS PatientCount
FROM Patient p
LEFT JOIN Examination e ON p.ID = e.ID
WHERE e.ID IS NULL OR (YEAR(e.Examination_Date) - YEAR(p.First_Date)) >= 1;
```
-------------------------10599 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) AS UnderagePatientCount
FROM Patient p
JOIN Examination e ON p.ID = e.ID
WHERE YEAR(p.Birthday) > 1975
AND e.Examination_Date BETWEEN '1990-01-01' AND '1993-12-31';
```
-------------------------10600 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE p.SEX = 'M' AND l.T-BIL > 2.0;
```
-------------------------10601 sample_num
```sql
SELECT Diagnosis, COUNT(Diagnosis) AS DiagnosisCount
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.Date BETWEEN '1985-01-01' AND '1995-12-31'
GROUP BY Diagnosis
ORDER BY DiagnosisCount DESC
LIMIT 1;
```
-------------------------10602 sample_num
```sql
SELECT AVG(YEAR('1991-10-01') - YEAR(P.Birthday)) AS Average_Age
FROM Patient P
JOIN Examination E ON P.ID = E.ID
JOIN Laboratory L ON P.ID = L.ID
WHERE L.Date BETWEEN '1991-10-01' AND '1991-10-31';
```
-------------------------10603 sample_num
```sql
SELECT 
    SUBTRACT(YEAR(e.`Examination Date`), YEAR(p.Birthday)) AS Age,
    p.Diagnosis
FROM 
    Examination e
JOIN 
    Patient p ON e.ID = p.ID
JOIN 
    Laboratory l ON e.ID = l.ID
WHERE 
    l.HGB = (SELECT MAX(HGB) FROM Laboratory)
```
-------------------------10604 sample_num
```sql
SELECT ANA 
FROM Examination 
WHERE ID = 3605340 AND Examination_Date = '1996-12-02';
```
-------------------------10605 sample_num
```sql
SELECT T-CHO < 250 AS Is_Normal
FROM Laboratory
WHERE ID = 2927464 AND Date = '1995-09-04';
```
-------------------------10606 sample_num
```sql
SELECT SEX 
FROM Patient 
WHERE Diagnosis = 'AORTITIS' 
ORDER BY First Date 
LIMIT 1;
```
-------------------------10607 sample_num
```sql
SELECT e.aCL_IgM
FROM Examination e
JOIN Patient p ON e.ID = p.ID
WHERE p.Diagnosis = 'SLE' 
AND p.First_Date = '1994-02-19' 
AND e.Examination_Date = '1993-11-12';
```
-------------------------10608 sample_num
```sql
SELECT SEX 
FROM Patient 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE GPT = '9' AND Date = '1992-06-12';
```
-------------------------10609 sample_num
```sql
SELECT SUBTRACT('1991', YEAR(P.Birthday)) AS Age
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE L.UA = '8.4' AND L.Date = '1991-10-21';
```
-------------------------10610 sample_num
```sql
SELECT COUNT(Laboratory.ID) AS Total_Laboratory_Tests
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Patient.First_Date = '1991-06-13' 
  AND Patient.Diagnosis = 'SJS' 
  AND YEAR(Laboratory.Date) = 1995;
```
-------------------------10611 sample_num
```sql
SELECT p.Diagnosis 
FROM Patient p 
WHERE p.ID IN (
    SELECT e.ID 
    FROM Examination e 
    WHERE e.Diagnosis = 'SLE' AND e.Examination_Date = '1997-01-27'
) 
AND p.First_Date = (
    SELECT MIN(First_Date) 
    FROM Patient 
    WHERE ID = p.ID
);
```
-------------------------10612 sample_num
```sql
SELECT E.Symptoms 
FROM Examination E 
JOIN Patient P ON E.ID = P.ID 
WHERE P.Birthday = '1959-03-01' AND E.Examination_Date = '1993-09-27';
```
-------------------------10613 sample_num
```sql
SELECT 
    (SUM(CASE WHEN Date LIKE '1981-11-%' THEN T-CHO ELSE 0 END) - 
     SUM(CASE WHEN Date LIKE '1981-12-%' THEN T-CHO ELSE 0 END)) AS Decrease_Rate
FROM 
    Laboratory 
WHERE 
    ID IN (SELECT ID FROM Patient WHERE Birthday = '1959-02-18');
```
-------------------------10614 sample_num
```sql
SELECT DISTINCT Patient.ID
FROM Patient
JOIN Examination ON Patient.ID = Examination.ID
WHERE Patient.Diagnosis = 'Behcet'
AND Examination.Examination_Date >= '1997-01-01'
AND Examination.Examination_Date <= '1997-12-31';
```
-------------------------10615 sample_num
```sql
SELECT DISTINCT Patient.ID
FROM Examination
JOIN Laboratory ON Examination.ID = Laboratory.ID
WHERE Examination.Examination_Date BETWEEN '1987-07-06' AND '1996-01-31'
AND Laboratory.GPT > 30
AND Laboratory.ALB < 4;
```
-------------------------10616 sample_num
```sql
SELECT ID 
FROM Patient 
WHERE SEX = 'F' AND YEAR(Birthday) = 1964 AND Admission = '+';
```
-------------------------10617 sample_num
```sql
SELECT COUNT(*) 
FROM Examination 
WHERE Thrombosis = 2 
AND ANA = 'S' 
AND aCL_IgM > (SELECT AVG(aCL_IgM) * 1.2 FROM Examination);
```
-------------------------10618 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN UA <= 6.5 THEN 1 END) * 100.0 / COUNT(CASE WHEN U_PRO > 0 AND U_PRO < 30 THEN 1 END)) AS percentage
FROM 
    Laboratory
WHERE 
    U_PRO > 0 AND U_PRO < 30;
```
-------------------------10619 sample_num
```sql
SELECT 
    (SUM(CASE WHEN Diagnosis = 'BEHCET' THEN 1 ELSE 0 END) * 100.0) / COUNT(*) AS Percentage
FROM 
    Patient
WHERE 
    SEX = 'M' AND 
    YEAR(`First Date`) = 1981;
```
-------------------------10620 sample_num
```sql
SELECT DISTINCT Patient.ID
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Patient.Admission = '-'
AND Laboratory.Date LIKE '1991-10%'
AND Laboratory.T-BIL < 2.0;
```
-------------------------10621 sample_num
```sql
SELECT COUNT(*) 
FROM Patient 
WHERE SEX = 'F' 
AND Birthday BETWEEN '1980-01-01' AND '1989-12-31' 
AND ID NOT IN (SELECT ID FROM Examination WHERE [ANA Pattern] = 'p');
```
-------------------------10622 sample_num
```sql
SELECT P.SEX 
FROM Patient P 
JOIN Examination E ON P.ID = E.ID 
JOIN Laboratory L ON P.ID = L.ID 
WHERE E.Diagnosis = 'PSS' 
AND L.CRP > 2 
AND L.CRE = 1 
AND L.LDH = 123;
```
-------------------------10623 sample_num
```sql
SELECT AVG(LAB.ALB) AS Average_Albumin_Level
FROM Patient PAT
JOIN Laboratory LAB ON PAT.ID = LAB.ID
WHERE PAT.SEX = 'F' AND LAB.PLT > 400 AND PAT.Diagnosis = 'SLE';
```
-------------------------10624 sample_num
```sql
SELECT Symptoms, COUNT(*) as Count
FROM Examination
WHERE Diagnosis = 'SLE'
GROUP BY Symptoms
ORDER BY Count DESC
LIMIT 1;
```
-------------------------10625 sample_num
```sql
SELECT MIN(First Date) AS First_Documented_Date, Diagnosis 
FROM Patient 
WHERE ID = 48473;
```
-------------------------10626 sample_num
```sql
SELECT COUNT(*) 
FROM Patient 
WHERE SEX = 'F' AND Diagnosis = 'APS';
```
-------------------------10627 sample_num
```sql
SELECT COUNT(DISTINCT Patient.ID) 
FROM Laboratory 
JOIN Patient ON Laboratory.ID = Patient.ID 
WHERE YEAR(Date) = 1997 
AND (TP < 6 OR TP > 8.5);
```
-------------------------10628 sample_num
```sql
SELECT 
    (SUM(CASE WHEN P.Diagnosis LIKE '%SLE%' THEN 1 ELSE 0 END) * 100.0) / 
    NULLIF(SUM(CASE WHEN E.Symptoms LIKE '%thrombocytopenia%' THEN 1 ELSE 0 END), 0) AS Proportion
FROM 
    Patient P
JOIN 
    Examination E ON P.ID = E.ID
WHERE 
    E.Symptoms LIKE '%thrombocytopenia%';
```
-------------------------10629 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN SEX = 'F' THEN 1 END) * 100.0) / COUNT(*) AS percentage_women
FROM 
    Patient
WHERE 
    YEAR(Birthday) = 1980 AND Diagnosis = 'RA';
```
-------------------------10630 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) 
FROM Patient p 
JOIN Examination e ON p.ID = e.ID 
WHERE p.SEX = 'M' 
  AND e.Examination_Date BETWEEN '1995-01-01' AND '1997-12-31' 
  AND p.Diagnosis = 'BEHCET' 
  AND p.Admission = '-';
```
-------------------------10631 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE p.SEX = 'F' AND l.WBC < 3.5;
```
-------------------------10632 sample_num
```sql
SELECT DATEDIFF(E.`Examination Date`, P.`First Date`) AS Days_Between
FROM Patient P
JOIN Examination E ON P.ID = E.ID
WHERE P.ID = 821298
ORDER BY E.`Examination Date` ASC
LIMIT 1;
```
-------------------------10633 sample_num
```sql
SELECT 
    CASE 
        WHEN (SEX = 'M' AND UA <= 8.0) OR (SEX = 'F' AND UA <= 6.5) THEN 'No' 
        ELSE 'Yes' 
    END AS Is_UA_Normal
FROM 
    Patient 
JOIN 
    Laboratory ON Patient.ID = Laboratory.ID 
WHERE 
    Patient.ID = 57266;
```
-------------------------10634 sample_num
```sql
SELECT Date 
FROM Laboratory 
WHERE ID = '48473' AND GOT >= 60;
```
-------------------------10635 sample_num
```sql
SELECT Patient.SEX, Patient.Birthday
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.GOT < 60 AND YEAR(Laboratory.Date) = 1994;
```
-------------------------10636 sample_num
```sql
SELECT DISTINCT Patient.ID
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Patient.SEX = 'M' AND Laboratory.GPT >= 60;
```
-------------------------10637 sample_num
```sql
SELECT DISTINCT Patient.Diagnosis
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.GPT > 60
ORDER BY Patient.Birthday ASC;
```
-------------------------10638 sample_num
```sql
SELECT AVG(LDH) AS average_LDH
FROM Laboratory
WHERE LDH < 500;
```
-------------------------10639 sample_num
```sql
SELECT Patient.ID, 
       SUBTRACT(YEAR(CURRENT_TIMESTAMP), YEAR(Patient.Birthday)) AS age
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.LDH BETWEEN 600 AND 800;
```
-------------------------10640 sample_num
```sql
SELECT Patient.ID, Patient.Admission
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.ALP < 300;
```
-------------------------10641 sample_num
```sql
SELECT p.ID, 
       CASE 
           WHEN l.ALP < 300 THEN 'Within normal range' 
           ELSE 'Not within normal range' 
       END AS ALP_Status
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
WHERE p.Birthday = '1982-04-01';
```
-------------------------10642 sample_num
```sql
SELECT Patient.ID, Patient.SEX, Patient.Birthday
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.TP < 6.0;
```
-------------------------10643 sample_num
```sql
SELECT P.ID, (L.TP - 8.5) AS TP_Deviation
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE P.SEX = 'F' AND L.TP > 8.5;
```
-------------------------10644 sample_num
```sql
SELECT P.*
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE P.SEX = 'M' AND (L.ALB <= 3.5 OR L.ALB >= 5.5)
ORDER BY P.Birthday DESC;
```
-------------------------10645 sample_num
```sql
SELECT P.ID, 
       CASE 
           WHEN L.ALB BETWEEN 3.5 AND 5.5 THEN 'Within Normal Range' 
           ELSE 'Outside Normal Range' 
       END AS Albumin_Status
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE YEAR(P.Birthday) = 1982;
```
-------------------------10646 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN UA > 6.5 THEN 1 END) * 100.0 / COUNT(*)) AS female_percentage
FROM 
    Patient p
JOIN 
    Laboratory l ON p.ID = l.ID
WHERE 
    p.SEX = 'F';
```
-------------------------10647 sample_num
```sql
SELECT AVG(L.UA) AS Average_UA
FROM Laboratory L
JOIN Patient P ON L.ID = P.ID
WHERE (P.SEX = 'M' AND L.UA < 8.0) OR (P.SEX = 'F' AND L.UA < 6.5)
AND L.Date = (SELECT MAX(Date) FROM Laboratory WHERE ID = P.ID);
```
-------------------------10648 sample_num
```sql
SELECT Patient.ID, Patient.SEX, Patient.Birthday
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.UN = 29;
```
-------------------------10649 sample_num
```sql
SELECT Patient.ID, Patient.SEX, Patient.Birthday
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Patient.Diagnosis = 'RA' AND Laboratory.UN < 30;
```
-------------------------10650 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE p.SEX = 'M' AND l.CRE >= 1.5;
```
-------------------------10651 sample_num
```sql
SELECT 
    (SUM(CASE WHEN SEX = 'M' AND CRE >= 1.5 THEN 1 ELSE 0 END) > 
     SUM(CASE WHEN SEX = 'F' AND CRE >= 1.5 THEN 1 ELSE 0 END)) AS result
FROM 
    Patient p
JOIN 
    Laboratory l ON p.ID = l.ID;
```
-------------------------10652 sample_num
```sql
SELECT p.ID, p.SEX, p.Birthday
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
WHERE l.T-BIL = (SELECT MAX(T-BIL) FROM Laboratory);
```
-------------------------10653 sample_num
```sql
SELECT Patient.SEX, COUNT(Patient.ID) AS TotalPatients
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.T-BIL >= 2.0
GROUP BY Patient.SEX;
```
-------------------------10654 sample_num
```sql
SELECT p.ID, l.T-CHO
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
WHERE p.Birthday = (SELECT MIN(Birthday) FROM Patient)
AND l.T-CHO = (SELECT MAX(T-CHO) FROM Laboratory)
```
-------------------------10655 sample_num
```sql
SELECT AVG(YEAR(CURDATE()) - YEAR(Birthday)) AS average_age
FROM Patient
WHERE SEX = 'M' AND ID IN (
    SELECT ID
    FROM Laboratory
    WHERE T-CHO >= 250
);
```
-------------------------10656 sample_num
```sql
SELECT Patient.ID, Patient.Diagnosis
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.TG > 300;
```
-------------------------10657 sample_num
```sql
SELECT COUNT(*) 
FROM Patient 
WHERE ID IN (
    SELECT ID 
    FROM Laboratory 
    WHERE TG >= 200
) 
AND (YEAR(CURRENT_TIMESTAMP) - YEAR(Birthday)) > 50;
```
-------------------------10658 sample_num
```sql
SELECT DISTINCT ID 
FROM Laboratory 
WHERE Admission = '-' AND CPK < 250;
```
-------------------------10659 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE YEAR(p.Birthday) BETWEEN 1936 AND 1956 
AND p.SEX = 'M' 
AND l.CPK >= 250;
```
-------------------------10660 sample_num
```sql
SELECT P.ID, P.SEX, YEAR(CURRENT_TIMESTAMP) - YEAR(P.Birthday) AS Age
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE L.GLU >= 180 AND L.T_CHO < 250;
```
-------------------------10661 sample_num
```sql
SELECT Patient.ID, Laboratory.GLU
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE YEAR(Patient.First Date) = 1991 AND Laboratory.GLU < 180;
```
-------------------------10662 sample_num
```sql
SELECT P.ID, P.SEX, P.Birthday
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE L.WBC <= 3.5 OR L.WBC >= 9.0
GROUP BY P.SEX, P.ID, P.Birthday
ORDER BY YEAR(CURDATE()) - YEAR(P.Birthday) ASC;
```
-------------------------10663 sample_num
```sql
SELECT Patient.ID, 
       SUBTRACT(YEAR(CURRENT_TIMESTAMP), YEAR(Patient.Birthday)) AS Age, 
       Patient.Diagnosis 
FROM Patient 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE Laboratory.RBC < 3.5;
```
-------------------------10664 sample_num
```sql
SELECT P.ID, P.ADMISSION
FROM Patient P
WHERE P.SEX = 'F'
AND (YEAR(CURRENT_TIMESTAMP) - YEAR(P.Birthday)) >= 50
AND (P.ID IN (SELECT ID FROM Laboratory WHERE RBC <= 3.5 OR RBC >= 6.0));
```
-------------------------10665 sample_num
```sql
SELECT DISTINCT Patient.ID, Patient.SEX
FROM Patient
JOIN Examination ON Patient.ID = Examination.ID
WHERE Patient.Admission = '-' AND Examination.HGB < 10;
```
-------------------------10666 sample_num
```sql
SELECT ID, SEX 
FROM Patient 
WHERE Diagnosis = 'SLE' 
AND ID IN (
    SELECT ID 
    FROM Laboratory 
    WHERE HGB > 10 AND HGB < 17
) 
ORDER BY Birthday ASC 
LIMIT 1;
```
-------------------------10667 sample_num
```sql
SELECT p.ID, SUBTRACT(YEAR(CURRENT_TIMESTAMP), YEAR(p.Birthday)) AS age
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
WHERE l.HCT >= 52
GROUP BY p.ID
HAVING COUNT(l.ID) > 2;
```
-------------------------10668 sample_num
```sql
SELECT AVG(HCT) AS Average_HCT
FROM Laboratory
WHERE Date LIKE '1991%' AND HCT < 29;
```
-------------------------10669 sample_num
```sql
SELECT 
    SUM(CASE WHEN PLT < 100 THEN 1 ELSE 0 END) AS Lower_Than_Normal,
    SUM(CASE WHEN PLT > 400 THEN 1 ELSE 0 END) AS Higher_Than_Normal
FROM 
    Laboratory
WHERE 
    PLT < 100 OR PLT > 400;
```
-------------------------10670 sample_num
```sql
SELECT p.ID, p.SEX, p.Birthday, p.Description, p.First_Date, p.Admission, p.Diagnosis
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
WHERE l.Date LIKE '1984%'
AND (YEAR(CURRENT_TIMESTAMP) - YEAR(p.Birthday)) < 50
AND l.PLT BETWEEN 100 AND 400;
```
-------------------------10671 sample_num
```sql
SELECT 
    (SUM(CASE WHEN SEX = 'F' AND PT >= 14 THEN 1 ELSE 0 END) * 1.0 / NULLIF(SUM(PT >= 14), 0)) * 100 AS female_abnormal_pt_percentage
FROM 
    Patient p
JOIN 
    Laboratory l ON p.ID = l.ID
WHERE 
    SUBTRACT(YEAR(CURRENT_TIMESTAMP), YEAR(Birthday)) > 55;
```
-------------------------10672 sample_num
```sql
SELECT DISTINCT Patient.ID, Patient.Description
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE YEAR(Patient.`First Date`) > 1992 AND Laboratory.PT < 14;
```
-------------------------10673 sample_num
```sql
SELECT COUNT(*) 
FROM Examination e 
JOIN Laboratory l ON e.ID = l.ID 
WHERE e.Examination_Date > '1997-01-01' AND l.APTT < 45;
```
-------------------------10674 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) AS MildThrombosisCount
FROM Patient p
JOIN Examination e ON p.ID = e.ID
WHERE e.APTT > 45 AND e.Thrombosis = 3;
```
-------------------------10675 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) AS AbnormalFibrinogenCount
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
WHERE p.SEX = 'M'
  AND l.WBC BETWEEN 3.5 AND 9.0
  AND (l.FG <= 150 OR l.FG >= 450);
```
-------------------------10676 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE p.Birthday > '1980-01-01' AND (l.FG < 150 OR l.FG > 450);
```
-------------------------10677 sample_num
```sql
SELECT DISTINCT Patient.Diagnosis
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.U-PRO >= 30;
```
-------------------------10678 sample_num
```sql
SELECT ID 
FROM Patient 
WHERE Diagnosis = 'SLE' 
AND ID IN (
    SELECT ID 
    FROM Laboratory 
    WHERE U-PRO > 0 AND U-PRO < 30
);
```
-------------------------10679 sample_num
```sql
SELECT COUNT(DISTINCT Patient.ID) 
FROM Patient 
JOIN Examination ON Patient.ID = Examination.ID 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE Laboratory.IGG < 900 AND Examination.Symptoms = 'abortion';
```
-------------------------10680 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p
JOIN Examination e ON p.ID = e.ID
JOIN Laboratory l ON p.ID = l.ID
WHERE l.IGG BETWEEN 900 AND 2000 AND e.Symptoms IS NOT NULL;
```
-------------------------10681 sample_num
```sql
SELECT p.Diagnosis
FROM Laboratory l
JOIN Patient p ON l.ID = p.ID
WHERE l.IGA BETWEEN 80 AND 500
ORDER BY l.IGA DESC
LIMIT 1;
```
-------------------------10682 sample_num
```sql
SELECT COUNT(*) 
FROM Patient 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE Laboratory.IGA BETWEEN 80 AND 500 
AND YEAR(Patient.`First Date`) >= 1990;
```
-------------------------10683 sample_num
```sql
SELECT Diagnosis, COUNT(Diagnosis) AS DiagnosisCount
FROM Patient p
JOIN Examination e ON p.ID = e.ID
WHERE e.aCL_IgM NOT BETWEEN 40 AND 400
GROUP BY Diagnosis
ORDER BY DiagnosisCount DESC
LIMIT 1;
```
-------------------------10684 sample_num
```sql
SELECT COUNT(*) 
FROM Patient 
WHERE Description IS NULL 
AND ID NOT IN (
    SELECT ID 
    FROM Laboratory 
    WHERE CRP LIKE '+' OR CRP LIKE '-' OR CRP < 1.0
);
```
-------------------------10685 sample_num
```sql
SELECT COUNT(DISTINCT P.ID) 
FROM Patient P 
JOIN Laboratory L ON P.ID = L.ID 
WHERE L.CRP NOT IN ('+-', '-') AND L.CRP >= 1.0 
AND (YEAR(CURDATE()) - YEAR(P.Birthday)) < 18;
```
-------------------------10686 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) 
FROM Patient p 
JOIN Examination e ON p.ID = e.ID 
WHERE p.RA = '-' AND e.KCT = '+';
```
-------------------------10687 sample_num
```sql
SELECT DISTINCT Patient.Diagnosis
FROM Patient
WHERE YEAR(Patient.Birthday) >= 1995
AND Patient.RA IN ('-', '+-');
```
-------------------------10688 sample_num
```sql
SELECT Patient.ID 
FROM Patient 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE Laboratory.RF < 20 AND (YEAR(CURDATE()) - YEAR(Patient.Birthday)) > 60;
```
-------------------------10689 sample_num
```sql
SELECT COUNT(DISTINCT Patient.ID) 
FROM Patient 
JOIN Examination ON Patient.ID = Examination.ID 
WHERE Patient.Diagnosis = 'normal RF' AND Examination.RF < 20 AND Examination.Thrombosis = '0';
```
-------------------------10690 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) 
FROM Patient p 
JOIN Examination e ON p.ID = e.ID 
JOIN Laboratory l ON p.ID = l.ID 
WHERE l.C3 > 35 AND e.ANA_Pattern = 'P';
```
-------------------------10691 sample_num
```sql
SELECT p.ID
FROM Patient p
JOIN Examination e ON p.ID = e.ID
WHERE e.HCT < 29 OR e.HCT > 52
ORDER BY e.aCL_IgA DESC
LIMIT 1;
```
-------------------------10692 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) AS Normal_C4_Patients
FROM Patient p
JOIN Examination e ON p.ID = e.ID
JOIN Laboratory l ON p.ID = l.ID
WHERE e.Thrombosis = 'Yes' AND l.C4 > 10;
```
-------------------------10693 sample_num
```sql
SELECT COUNT(DISTINCT Patient.ID) 
FROM Patient 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE (Laboratory.RNP = '-' OR Laboratory.RNP = '+-') 
AND Patient.Admission = '+';
```
-------------------------10694 sample_num
```sql
SELECT Birthday 
FROM Patient 
WHERE ID IN (
    SELECT ID 
    FROM Laboratory 
    WHERE RNP NOT IN ('-', '+-')
) 
ORDER BY Birthday DESC 
LIMIT 1;
```
-------------------------10695 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p
JOIN Examination e ON p.ID = e.ID
JOIN Laboratory l ON p.ID = l.ID
WHERE l.SM IN ('-', '0') AND e.Thrombosis = '1';
```
-------------------------10696 sample_num
```sql
SELECT ID 
FROM Patient 
WHERE ID IN (SELECT ID FROM Laboratory WHERE SM NOT IN ('-', '+-')) 
ORDER BY Birthday DESC 
LIMIT 3;
```
-------------------------10697 sample_num
```sql
SELECT DISTINCT Patient.ID
FROM Patient
JOIN Examination ON Patient.ID = Examination.ID
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Examination.`Examination Date` >= '1997-01-01'
AND Laboratory.SC170 IN ('-', '+-');
```
-------------------------10698 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) AS Male_Vertigo_Patients
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
WHERE l.SC170 IN ('-', '+-') AND p.SEX = 'M' AND p.Symptoms = 'vertigo';
```
-------------------------10699 sample_num
```sql
SELECT COUNT(DISTINCT Patient.ID) 
FROM Patient 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE Laboratory.SSA IN ('-', '+-') 
AND YEAR(Patient.`First Date`) < 1990;
```
-------------------------10700 sample_num
```sql
SELECT ID 
FROM Patient 
WHERE ID IN (
    SELECT ID 
    FROM Laboratory 
    WHERE SSA NOT IN ('-', '+-')
) 
ORDER BY `First Date` 
LIMIT 1;
```
-------------------------10701 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) 
FROM Patient p 
JOIN Examination e ON p.ID = e.ID 
WHERE e.SSB IN ('-', '+-') AND p.Diagnosis = 'SLE';
```
-------------------------10702 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) AS DistinctPatientsWithSymptoms
FROM Patient p
JOIN Examination e ON p.ID = e.ID
JOIN Laboratory l ON p.ID = l.ID
WHERE l.SSB IN ('-', '+-') AND e.Symptoms IS NOT NULL;
```
-------------------------10703 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE l.CENTROMEA IN ('-', '+-') 
AND l.SSB IN ('-', '+-') 
AND p.SEX = 'M';
```
-------------------------10704 sample_num
```sql
SELECT DISTINCT Patient.Diagnosis
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.DNA >= 8;
```
-------------------------10705 sample_num
```sql
SELECT COUNT(DISTINCT P.ID) AS UniquePatients
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE L.DNA < 8 AND P.Description IS NULL;
```
-------------------------10706 sample_num
```sql
SELECT COUNT(DISTINCT Patient.ID) 
FROM Patient 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE Laboratory.DNA-II >= 8 AND Patient.Admission = '+';
```
-------------------------10707 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN L.GOT >= 60 AND P.Diagnosis = 'SLE' THEN 1 END) * 1.0 / COUNT(CASE WHEN L.GOT >= 60 THEN 1 END)) * 100 AS percentage
FROM 
    Laboratory L
JOIN 
    Patient P ON L.ID = P.ID;
```
-------------------------10708 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE p.SEX = 'M' AND l.GOT < 60;
```
-------------------------10709 sample_num
```sql
SELECT MAX(P.Birthday) AS Youngest_Birthday
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE L.GOT >= 60;
```
-------------------------10710 sample_num
```sql
SELECT p.Birthday
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
WHERE l.GPT < 60
ORDER BY l.GPT DESC
LIMIT 3;
```
-------------------------10711 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE l.GOT < 60 AND p.SEX = 'M';
```
-------------------------10712 sample_num
```sql
SELECT MIN(P.First_Date) AS First_Recorded_Date
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE L.LDH < 500
AND L.LDH = (SELECT MAX(LDH) FROM Laboratory WHERE LDH < 500);
```
-------------------------10713 sample_num
```sql
SELECT MAX(L.Date) AS Latest_Medical_Data
FROM Patient P
JOIN Laboratory L ON P.ID = L.ID
WHERE P.First_Date = (SELECT MAX(First_Date) FROM Patient)
AND L.LDH >= 500;
```
-------------------------10714 sample_num
```sql
SELECT COUNT(*) 
FROM Laboratory l 
JOIN Patient p ON l.ID = p.ID 
WHERE l.ALP >= 300 AND p.Admission = '+';
```
-------------------------10715 sample_num
```sql
SELECT COUNT(*) 
FROM Patient 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE Patient.Admission = '-' AND Laboratory.ALP < 300;
```
-------------------------10716 sample_num
```sql
SELECT DISTINCT Patient.Diagnosis
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Laboratory.TP < 6.0;
```
-------------------------10717 sample_num
```sql
SELECT COUNT(*) 
FROM Patient 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE Patient.Diagnosis = 'SJS' 
AND Laboratory.TP > 6.0 
AND Laboratory.TP < 8.5;
```
-------------------------10718 sample_num
```sql
SELECT e.Examination_Date
FROM Examination e
JOIN Laboratory l ON e.ID = l.ID
WHERE l.ALB = (SELECT MAX(ALB) FROM Laboratory WHERE ALB > 3.5 AND ALB < 5.5);
```
-------------------------10719 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
WHERE p.SEX = 'M' 
AND l.ALB > 3.5 AND l.ALB < 5.5 
AND l.TP BETWEEN 6.0 AND 8.5;
```
-------------------------10720 sample_num
```sql
SELECT aCL_IgG, aCL_IgM, aCL_IgA
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
JOIN Examination e ON p.ID = e.ID
WHERE p.SEX = 'F' AND l.UA <= 6.50
ORDER BY l.UA DESC
LIMIT 1;
```
-------------------------10721 sample_num
```sql
SELECT MAX(ANA) AS Highest_ANA
FROM Examination e
JOIN Patient p ON e.ID = p.ID
JOIN Laboratory l ON p.ID = l.ID
WHERE l.CRE < 1.5;
```
-------------------------10722 sample_num
```sql
SELECT p.ID
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
JOIN Examination e ON p.ID = e.ID
WHERE l.CRE < 1.5
GROUP BY p.ID
HAVING e.aCL_IgA = (SELECT MAX(e2.aCL_IgA) FROM Examination e2 WHERE e2.ID = p.ID);
```
-------------------------10723 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) 
FROM Patient p
JOIN Examination e ON p.ID = e.ID
JOIN Laboratory l ON p.ID = l.ID
WHERE l."T-BIL" >= 2.0 AND e."ANA Pattern" LIKE '%P%';
```
-------------------------10724 sample_num
```sql
SELECT ANA 
FROM Examination 
WHERE ID = (SELECT ID 
            FROM Laboratory 
            WHERE T-BIL = (SELECT MAX(T-BIL) 
                           FROM Laboratory 
                           WHERE T-BIL < 2.0));
```
-------------------------10725 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p
JOIN Examination e ON p.ID = e.ID
JOIN Laboratory l ON p.ID = l.ID
WHERE l.T-CHO >= 250 AND e.KCT = '-';
```
-------------------------10726 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) AS PatientCount
FROM Patient p
JOIN Examination e ON p.ID = e.ID
JOIN Laboratory l ON p.ID = l.ID
WHERE l.T-CHO < 250 AND e.ANA_Pattern = 'P';
```
-------------------------10727 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p
JOIN Examination e ON p.ID = e.ID
JOIN Laboratory l ON p.ID = l.ID
WHERE l.TG < 200 AND e.Symptoms IS NOT NULL;
```
-------------------------10728 sample_num
```sql
SELECT p.Diagnosis
FROM Laboratory l
JOIN Patient p ON l.ID = p.ID
WHERE l.TG < 200
ORDER BY l.TG DESC
LIMIT 1;
```
-------------------------10729 sample_num
```sql
SELECT DISTINCT Patient.ID
FROM Patient
JOIN Examination ON Patient.ID = Examination.ID
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE Examination.Thrombosis = 0 AND Laboratory.CPK < 250;
```
-------------------------10730 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) 
FROM Patient p
JOIN Examination e ON p.ID = e.ID
JOIN Laboratory l ON p.ID = l.ID
WHERE l.CPK < 250 
AND (e.KCT = '+' OR e.RVVT = '+' OR e.LAC = '+');
```
-------------------------10731 sample_num
```sql
SELECT MIN(Birthday) AS Oldest_Birthday
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE GLU > 180;
```
-------------------------10732 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
JOIN Examination e ON p.ID = e.ID
WHERE l.GLU < 180 AND e.Thrombosis = 0;
```
-------------------------10733 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE p.Admission = '+' AND l.WBC BETWEEN 3.5 AND 9.0;
```
-------------------------10734 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p 
JOIN Laboratory l ON p.ID = l.ID 
WHERE p.Diagnosis = 'SLE' AND l.WBC BETWEEN 3.5 AND 9.0;
```
-------------------------10735 sample_num
```sql
SELECT DISTINCT Patient.ID
FROM Patient
JOIN Laboratory ON Patient.ID = Laboratory.ID
WHERE (Laboratory.RBC <= 3.5 OR Laboratory.RBC >= 6.0)
AND Patient.Admission = '-';
```
-------------------------10736 sample_num
```sql
SELECT COUNT(*) 
FROM Patient p 
JOIN Examination e ON p.ID = e.ID 
JOIN Laboratory l ON p.ID = l.ID 
WHERE l.PLT > 100 AND l.PLT < 400 AND p.Diagnosis IS NOT NULL;
```
-------------------------10737 sample_num
```sql
SELECT Laboratory.PLT 
FROM Patient 
JOIN Laboratory ON Patient.ID = Laboratory.ID 
WHERE Laboratory.PLT > 100 AND Laboratory.PLT < 400 
AND Patient.Diagnosis = 'MCTD';
```
-------------------------10738 sample_num
```sql
SELECT AVG(PT) AS Average_Prothrombin_Time
FROM Patient p
JOIN Laboratory l ON p.ID = l.ID
WHERE p.SEX = 'M' AND l.PT < 14;
```
-------------------------10739 sample_num
```sql
SELECT COUNT(DISTINCT p.ID) 
FROM Patient p 
JOIN Examination e ON p.ID = e.ID 
JOIN Laboratory l ON p.ID = l.ID 
WHERE e.Thrombosis IN (1, 2) AND l.PT < 14;
```
-------------------------10740 sample_num
```sql
SELECT major.major_name 
FROM member 
JOIN major ON member.link_to_major = major.major_id 
WHERE member.first_name = 'Angela' AND member.last_name = 'Sanders';
```
-------------------------10741 sample_num
```sql
SELECT COUNT(*) 
FROM member m
JOIN major j ON m.link_to_major = j.major_id
WHERE j.college = 'Engineering';
```
-------------------------10742 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name
FROM member m
JOIN major maj ON m.link_to_major = maj.major_id
WHERE maj.department = 'Art and Design';
```
-------------------------10743 sample_num
```sql
SELECT COUNT(DISTINCT a.link_to_member) AS student_count
FROM attendance a
JOIN event e ON a.link_to_event = e.event_id
WHERE e.event_name = 'Women''s Soccer';
```
-------------------------10744 sample_num
```sql
SELECT m.phone 
FROM member m
JOIN attendance a ON m.member_id = a.link_to_member
JOIN event e ON a.link_to_event = e.event_id
WHERE e.event_name = 'Women''s Soccer';
```
-------------------------10745 sample_num
```sql
SELECT COUNT(*) 
FROM member 
JOIN attendance ON member.member_id = attendance.link_to_member 
JOIN event ON attendance.link_to_event = event.event_id 
WHERE event.event_name = 'Women''s Soccer' AND member.t_shirt_size = 'Medium';
```
-------------------------10746 sample_num
```sql
SELECT e.event_name, COUNT(a.link_to_event) AS attendance
FROM event e
JOIN attendance a ON e.event_id = a.link_to_event
GROUP BY e.event_id
ORDER BY attendance DESC
LIMIT 1;
```
-------------------------10747 sample_num
```sql
SELECT major.college 
FROM member 
JOIN major ON member.link_to_major = major.major_id 
WHERE member.position = 'Vice President';
```
-------------------------10748 sample_num
```sql
SELECT e.event_name 
FROM event e
JOIN attendance a ON e.event_id = a.link_to_event
JOIN member m ON a.link_to_member = m.member_id
WHERE m.first_name = 'Maya' AND m.last_name = 'Mclean';
```
-------------------------10749 sample_num
```sql
SELECT COUNT(e.event_id) AS events_attended
FROM event e
JOIN attendance a ON e.event_id = a.link_to_event
JOIN member m ON a.link_to_member = m.member_id
WHERE m.first_name = 'Sacha' AND m.last_name = 'Harrison' AND YEAR(e.event_date) = 2019;
```
-------------------------10750 sample_num
```sql
SELECT COUNT(DISTINCT e.event_id) AS meeting_count
FROM event e
JOIN attendance a ON e.event_id = a.link_to_event
GROUP BY e.event_id
HAVING COUNT(a.link_to_member) > 10 AND e.type = 'Meeting';
```
-------------------------10751 sample_num
```sql
SELECT e.event_name
FROM event e
JOIN attendance a ON e.event_id = a.link_to_event
GROUP BY e.event_id, e.event_name
HAVING COUNT(a.link_to_member) > 20;
```
-------------------------10752 sample_num
```sql
SELECT DIVIDE(COUNT(event_id), COUNT(DISTINCT event_name)) AS average_attendance
FROM event
WHERE type = 'Meeting' AND YEAR(event_date) = 2020;
```
-------------------------10753 sample_num
```sql
SELECT expense_description, MAX(cost) AS max_cost
FROM expense
WHERE link_to_budget IN (SELECT budget_id FROM budget WHERE link_to_event IS NOT NULL)
GROUP BY expense_description
ORDER BY max_cost DESC
LIMIT 1;
```
-------------------------10754 sample_num
```sql
SELECT COUNT(*) 
FROM member 
WHERE link_to_major = (SELECT major_id FROM major WHERE major_name = 'Environmental Engineering');
```
-------------------------10755 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name
FROM member m
JOIN attendance a ON m.member_id = a.link_to_member
JOIN event e ON a.link_to_event = e.event_id
WHERE e.event_name = 'Laugh Out Loud';
```
-------------------------10756 sample_num
```sql
SELECT m.last_name 
FROM member m 
JOIN major j ON m.link_to_major = j.major_id 
WHERE j.major_name = 'Law and Constitutional Studies';
```
-------------------------10757 sample_num
```sql
SELECT z.county 
FROM member m 
JOIN zip_code z ON m.zip = z.zip_code 
WHERE m.first_name = 'Sherri' AND m.last_name = 'Ramsey';
```
-------------------------10758 sample_num
```sql
SELECT college 
FROM major 
JOIN member ON major.major_id = member.link_to_major 
WHERE member.first_name = 'Tyler' AND member.last_name = 'Hewitt';
```
-------------------------10759 sample_num
```sql
SELECT SUM(i.amount) AS total_funds_received
FROM income i
JOIN member m ON i.link_to_member = m.member_id
WHERE m.position = 'Vice President';
```
-------------------------10760 sample_num
```sql
SELECT SUM(b.spent) AS total_spent_on_food
FROM budget b
JOIN event e ON b.link_to_event = e.event_id
WHERE b.category = 'Food' AND e.event_name = 'September Meeting';
```
-------------------------10761 sample_num
```sql
SELECT z.city, z.state
FROM member m
JOIN zip_code z ON m.zip = z.zip_code
WHERE m.position = 'President';
```
-------------------------10762 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM member
WHERE zip IN (SELECT zip_code FROM zip_code WHERE state = 'IL');
```
-------------------------10763 sample_num
```sql
SELECT SUM(e.cost) AS total_spent
FROM expense e
JOIN budget b ON e.link_to_budget = b.budget_id
JOIN event ev ON b.link_to_event = ev.event_id
WHERE b.category = 'Advertisement' AND ev.event_name = 'September Meeting';
```
-------------------------10764 sample_num
```sql
SELECT m.major_id, ma.department
FROM member m
JOIN major ma ON m.link_to_major = ma.major_id
WHERE m.first_name IN ('Pierce', 'Guidi');
```
-------------------------10765 sample_num
```sql
SELECT SUM(amount) AS total_budgeted_amount 
FROM budget 
WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'October Speaker');
```
-------------------------10766 sample_num
```sql
SELECT e.expense_id, e.expense_description, e.approved
FROM expense e
JOIN budget b ON e.link_to_budget = b.budget_id
JOIN event ev ON b.link_to_event = ev.event_id
WHERE ev.event_name = 'October Meeting' AND ev.event_date = '2019-10-08';
```
-------------------------10767 sample_num
```sql
SELECT AVG(e.cost) AS average_cost
FROM expense e
JOIN member m ON e.link_to_member = m.member_id
WHERE m.first_name = 'Elijah' AND m.last_name = 'Allen'
AND MONTH(e.expense_date) IN (9, 10;
```
-------------------------10768 sample_num
```sql
SELECT 
    SUM(CASE WHEN YEAR(e.event_date) = 2019 THEN b.spent ELSE 0 END) - 
    SUM(CASE WHEN YEAR(e.event_date) = 2020 THEN b.spent ELSE 0 END) AS amount_difference
FROM 
    event e
JOIN 
    budget b ON e.event_id = b.link_to_event
WHERE 
    YEAR(e.event_date) IN (2019, 2020);
```
-------------------------10769 sample_num
```sql
SELECT location FROM event WHERE event_name = 'Spring Budget Review';
```
-------------------------10770 sample_num
```sql
SELECT cost 
FROM expense 
WHERE expense_description = 'Posters' 
AND expense_date = '2019-09-04';
```
-------------------------10771 sample_num
```sql
SELECT remaining 
FROM budget 
WHERE amount = (SELECT MAX(amount) FROM budget WHERE category = 'Food');
```
-------------------------10772 sample_num
```sql
SELECT notes 
FROM income 
WHERE source = 'Fundraising' AND date_received = '2019-09-14';
```
-------------------------10773 sample_num
```sql
SELECT COUNT(*) FROM major WHERE college = 'College of Humanities and Social Sciences';
```
-------------------------10774 sample_num
```sql
SELECT phone FROM member WHERE first_name = 'Carlo' AND last_name = 'Jacobs';
```
-------------------------10775 sample_num
```sql
SELECT z.county 
FROM member m 
JOIN zip_code z ON m.zip = z.zip_code 
WHERE m.first_name = 'Adela' AND m.last_name = 'O\'Gallagher';
```
-------------------------10776 sample_num
```sql
SELECT COUNT(*) 
FROM budget 
WHERE link_to_event IN (SELECT event_id FROM event WHERE event_name = 'November Meeting') 
AND remaining < 0;
```
-------------------------10777 sample_num
```sql
SELECT SUM(amount) AS total_budget_amount
FROM budget
WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'September Speaker');
```
-------------------------10778 sample_num
```sql
SELECT e.status 
FROM event e
JOIN budget b ON e.event_id = b.link_to_event
JOIN expense ex ON b.budget_id = ex.link_to_budget
WHERE ex.expense_description = 'Post Cards, Posters' 
AND ex.expense_date = '2019-08-20';
```
-------------------------10779 sample_num
```sql
SELECT major.major_name 
FROM member 
JOIN major ON member.link_to_major = major.major_id 
WHERE member.first_name = 'Brent' AND member.last_name = 'Thomason';
```
-------------------------10780 sample_num
```sql
SELECT COUNT(*) 
FROM member 
WHERE link_to_major IN (SELECT major_id FROM major WHERE major_name = 'Human Development and Family Studies') 
AND t_shirt_size = 'Large';
```
-------------------------10781 sample_num
```sql
SELECT z.type 
FROM member m 
JOIN zip_code z ON m.zip = z.zip_code 
WHERE m.first_name = 'Christof' AND m.last_name = 'Nielson';
```
-------------------------10782 sample_num
```sql
SELECT major.major_name 
FROM member 
JOIN major ON member.link_to_major = major.major_id 
WHERE member.position = 'Vice President';
```
-------------------------10783 sample_num
```sql
SELECT z.state 
FROM member m 
JOIN zip_code z ON m.zip = z.zip_code 
WHERE m.first_name = 'Sacha' AND m.last_name = 'Harrison';
```
-------------------------10784 sample_num
```sql
SELECT m.major_id, maj.department
FROM member m
JOIN major maj ON m.link_to_major = maj.major_id
WHERE m.position = 'President';
```
-------------------------10785 sample_num
```sql
SELECT date_received 
FROM income 
WHERE link_to_member = (SELECT member_id FROM member WHERE first_name = 'Connor' AND last_name = 'Hilton') 
AND source = 'Dues';
```
-------------------------10786 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name
FROM income i
JOIN member m ON i.link_to_member = m.member_id
WHERE i.source = 'Dues'
ORDER BY i.date_received ASC
LIMIT 1;
```
-------------------------10787 sample_num
```sql
SELECT 
    (SELECT SUM(amount) 
     FROM budget b 
     JOIN event e ON b.link_to_event = e.event_id 
     WHERE b.category = 'Advertisement' AND e.event_name = 'Yearly Kickoff') / 
    (SELECT SUM(amount) 
     FROM budget b 
     JOIN event e ON b.link_to_event = e.event_id 
     WHERE b.category = 'Advertisement' AND e.event_name = 'October Meeting') AS budget_ratio;
```
-------------------------10788 sample_num
```sql
SELECT (SUM(b.amount) / (SELECT SUM(b2.amount) FROM budget b2 
                         JOIN event e ON b2.link_to_event = e.event_id 
                         WHERE e.event_name = 'November Speaker') * 100) AS parking_percentage
FROM budget b
JOIN event e ON b.link_to_event = e.event_id
WHERE b.category = 'Parking' AND e.event_name = 'November Speaker';
```
-------------------------10789 sample_num
```sql
SELECT SUM(cost) AS total_cost_of_pizzas
FROM expense
WHERE expense_description = 'Pizza';
```
-------------------------10790 sample_num
```sql
SELECT COUNT(DISTINCT city) 
FROM zip_code 
WHERE county = 'Orange County' AND state = 'Virginia';
```
-------------------------10791 sample_num
```sql
SELECT department FROM major WHERE college = 'College of Humanities and Social Sciences';
```
-------------------------10792 sample_num
```sql
SELECT z.city, z.county, z.state
FROM member m
JOIN zip_code z ON m.zip = z.zip_code
WHERE m.first_name = 'Amy' AND m.last_name = 'Firth';
```
-------------------------10793 sample_num
```sql
SELECT e.expense_description
FROM expense e
JOIN budget b ON e.link_to_budget = b.budget_id
WHERE b.remaining = (SELECT MIN(remaining) FROM budget);
```
-------------------------10794 sample_num
```sql
SELECT m.first_name, m.last_name, m.email
FROM member m
JOIN attendance a ON m.member_id = a.link_to_member
JOIN event e ON a.link_to_event = e.event_id
WHERE e.event_name = 'October Meeting';
```
-------------------------10795 sample_num
```sql
SELECT major.college
FROM member
JOIN major ON member.link_to_major = major.major_id
GROUP BY major.college
ORDER BY COUNT(member.member_id) DESC
LIMIT 1;
```
-------------------------10796 sample_num
```sql
SELECT major.major_name 
FROM member 
JOIN major ON member.link_to_major = major.major_id 
WHERE member.phone = '809-555-3360';
```
-------------------------10797 sample_num
```sql
SELECT e.event_name 
FROM event e 
JOIN budget b ON e.event_id = b.link_to_event 
ORDER BY b.amount DESC 
LIMIT 1;
```
-------------------------10798 sample_num
```sql
SELECT e.expense_id, e.expense_description, e.expense_date, e.cost
FROM expense e
JOIN member m ON e.link_to_member = m.member_id
WHERE m.position = 'Vice President';
```
-------------------------10799 sample_num
```sql
SELECT COUNT(DISTINCT a.link_to_member) AS member_count
FROM attendance a
JOIN event e ON a.link_to_event = e.event_id
WHERE e.event_name = 'Women''s Soccer';
```
-------------------------10800 sample_num
```sql
SELECT i.date_received 
FROM income i 
JOIN member m ON i.link_to_member = m.member_id 
WHERE m.first_name = 'Casey' AND m.last_name = 'Mason';
```
-------------------------10801 sample_num
```sql
SELECT COUNT(*) 
FROM member m
JOIN zip_code z ON m.zip = z.zip_code
WHERE z.state = 'MD';
```
-------------------------10802 sample_num
```sql
SELECT COUNT(a.link_to_event) AS event_count
FROM attendance a
JOIN member m ON a.link_to_member = m.member_id
WHERE m.phone = '954-555-6240';
```
-------------------------10803 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name
FROM member m
JOIN major maj ON m.link_to_major = maj.major_id
WHERE maj.department = 'School of Applied Sciences, Technology and Education';
```
-------------------------10804 sample_num
```sql
SELECT event.event_name, MAX(budget.spent / budget.amount) AS spend_to_budget_ratio
FROM event
JOIN budget ON event.event_id = budget.link_to_event
WHERE event.status = 'Closed'
GROUP BY event.event_name
ORDER BY spend_to_budget_ratio DESC
LIMIT 1;
```
-------------------------10805 sample_num
```sql
SELECT COUNT(*) AS president_count
FROM member
WHERE position = 'President';
```
-------------------------10806 sample_num
```sql
SELECT MAX(spent) AS highest_budget_spend FROM budget;
```
-------------------------10807 sample_num
```sql
SELECT COUNT(*) 
FROM event 
WHERE type = 'Meeting' AND YEAR(event_date) = 2020;
```
-------------------------10808 sample_num
```sql
SELECT SUM(spent) AS total_amount_spent_for_food
FROM budget
WHERE category = 'Food';
```
-------------------------10809 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name
FROM member m
JOIN attendance a ON m.member_id = a.link_to_member
GROUP BY m.member_id
HAVING COUNT(a.link_to_event) > 7;
```
-------------------------10810 sample_num
```sql
SELECT m.first_name, m.last_name, m.email
FROM member m
JOIN major j ON m.link_to_major = j.major_id
JOIN attendance a ON m.member_id = a.link_to_member
JOIN event e ON a.link_to_event = e.event_id
WHERE j.major_name = 'Interior Design' AND e.event_name = 'Community Theater';
```
-------------------------10811 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name
FROM member m
JOIN zip_code z ON m.zip = z.zip_code
WHERE z.city = 'Georgetown' AND z.state = 'SC';
```
-------------------------10812 sample_num
```sql
SELECT SUM(income.amount) AS total_income
FROM income
JOIN member ON income.link_to_member = member.member_id
WHERE member.first_name = 'Grant' AND member.last_name = 'Gilmour';
```
-------------------------10813 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name
FROM member m
JOIN income i ON m.member_id = i.link_to_member
WHERE i.amount > 40;
```
-------------------------10814 sample_num
```sql
SELECT SUM(e.cost) AS total_expense
FROM expense e
JOIN budget b ON e.link_to_budget = b.budget_id
JOIN event ev ON b.link_to_event = ev.event_id
WHERE ev.event_name = 'Yearly Kickoff';
```
-------------------------10815 sample_num
```sql
SELECT m.first_name, m.last_name
FROM member m
JOIN budget b ON m.member_id = b.link_to_member
JOIN event e ON b.link_to_event = e.event_id
WHERE e.event_name = 'Yearly Kickoff';
```
-------------------------10816 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name, i.source
FROM income i
JOIN member m ON i.link_to_member = m.member_id
WHERE i.amount = (SELECT MAX(amount) FROM income);
```
-------------------------10817 sample_num
```sql
SELECT e.event_name 
FROM event e 
JOIN budget b ON e.event_id = b.link_to_event 
WHERE b.spent = (SELECT MIN(spent) FROM budget);
```
-------------------------10818 sample_num
```sql
SELECT 
    (SUM(CASE WHEN e.event_name = 'Yearly Kickoff' THEN ex.cost ELSE 0 END) / SUM(ex.cost)) * 100 AS percentage_cost
FROM 
    event e
JOIN 
    attendance a ON e.event_id = a.link_to_event
JOIN 
    expense ex ON a.link_to_member = ex.link_to_member
GROUP BY 
    e.event_name;
```
-------------------------10819 sample_num
```sql
SELECT 
    DIVIDE(SUM(CASE WHEN major_name = 'Finance' THEN 1 ELSE 0 END), 
           SUM(CASE WHEN major_name = 'Physics' THEN 1 ELSE 0 END)) AS ratio
FROM 
    member 
JOIN 
    major ON member.link_to_major = major.major_id;
```
-------------------------10820 sample_num
```sql
SELECT source, SUM(amount) AS total_amount
FROM income
WHERE date_received BETWEEN '2019-09-01' AND '2019-09-30'
GROUP BY source
ORDER BY total_amount DESC
LIMIT 1;
```
-------------------------10821 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name, email 
FROM member 
WHERE position = 'Secretary';
```
-------------------------10822 sample_num
```sql
SELECT COUNT(*) 
FROM member 
WHERE link_to_major = (SELECT major_id FROM major WHERE major_name = 'Physics Teaching');
```
-------------------------10823 sample_num
```sql
SELECT COUNT(a.link_to_member) AS member_count
FROM attendance a
JOIN event e ON a.link_to_event = e.event_id
WHERE e.event_name = 'Community Theater' AND YEAR(e.event_date) = 2019;
```
-------------------------10824 sample_num
```sql
SELECT COUNT(a.link_to_event) AS event_count, m.link_to_major
FROM member m
JOIN attendance a ON m.member_id = a.link_to_member
WHERE m.first_name = 'Luisa' AND m.last_name = 'Guidi'
GROUP BY m.link_to_major;
```
-------------------------10825 sample_num
```sql
SELECT DIVIDE(SUM(b.spent), COUNT(b.spent)) AS average_spent_on_food
FROM budget b
WHERE b.category = 'Food' AND b.event_status = 'Closed';
```
-------------------------10826 sample_num
```sql
SELECT e.event_name
FROM event e
JOIN budget b ON e.event_id = b.link_to_event
WHERE b.category = 'Advertisement'
ORDER BY b.spent DESC
LIMIT 1;
```
-------------------------10827 sample_num
```sql
SELECT a.link_to_event 
FROM attendance a 
JOIN event e ON a.link_to_event = e.event_id 
JOIN member m ON a.link_to_member = m.member_id 
WHERE m.first_name = 'Maya' AND m.last_name = 'Mclean' AND e.event_name = 'Women''s Soccer';
```
-------------------------10828 sample_num
```sql
SELECT 
    (SUM(CASE WHEN type = 'Community Service' THEN 1 ELSE 0 END) * 100.0) / COUNT(event_id) AS percentage_share
FROM 
    event
WHERE 
    event_date BETWEEN '2019-01-01' AND '2019-12-31';
```
-------------------------10829 sample_num
```sql
SELECT e.event_name, ex.cost 
FROM event e 
JOIN budget b ON e.event_id = b.link_to_event 
JOIN expense ex ON b.budget_id = ex.link_to_budget 
WHERE e.event_name = 'September Speaker' AND ex.expense_description = 'Posters';
```
-------------------------10830 sample_num
```sql
SELECT t_shirt_size, COUNT(t_shirt_size) AS size_count
FROM member
GROUP BY t_shirt_size
ORDER BY size_count DESC
LIMIT 1;
```
-------------------------10831 sample_num
```sql
SELECT e.event_name
FROM event e
JOIN budget b ON e.event_id = b.link_to_event
WHERE e.status = 'Closed' AND b.remaining < 0
ORDER BY b.remaining ASC
LIMIT 1;
```
-------------------------10832 sample_num
```sql
SELECT e.expense_description, SUM(e.cost) AS total_value
FROM expense e
JOIN budget b ON e.link_to_budget = b.budget_id
JOIN event ev ON b.link_to_event = ev.event_id
WHERE ev.event_name = 'October Meeting' AND e.approved = 1
GROUP BY e.expense_description;
```
-------------------------10833 sample_num
```sql
SELECT category, amount 
FROM budget 
WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'April Speaker') 
ORDER BY amount ASC;
```
-------------------------10834 sample_num
```sql
SELECT MAX(amount) AS highest_budgeted_amount
FROM budget
WHERE category = 'Food';
```
-------------------------10835 sample_num
```sql
SELECT *
FROM budget
WHERE category = 'Advertising'
ORDER BY amount DESC
LIMIT 3;
```
-------------------------10836 sample_num
```sql
SELECT SUM(cost) AS total_cost_spent_for_parking
FROM expense
WHERE expense_description = 'Parking';
```
-------------------------10837 sample_num
```sql
SELECT SUM(cost) AS total_expense 
FROM expense 
WHERE expense_date = '2019-08-20';
```
-------------------------10838 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name, SUM(e.cost) AS total_cost
FROM member m
JOIN expense e ON m.member_id = e.link_to_member
WHERE m.member_id = 'rec4BLdZHS2Blfp4v'
GROUP BY m.member_id;
```
-------------------------10839 sample_num
```sql
SELECT expense_description 
FROM expense 
WHERE link_to_member = (SELECT member_id FROM member WHERE first_name = 'Sacha' AND last_name = 'Harrison');
```
-------------------------10840 sample_num
```sql
SELECT DISTINCT e.expense_description
FROM expense e
JOIN member m ON e.link_to_member = m.member_id
WHERE m.t_shirt_size = 'X-Large';
```
-------------------------10841 sample_num
```sql
SELECT m.zip
FROM member m
JOIN expense e ON m.member_id = e.link_to_member
WHERE e.cost < 50;
```
-------------------------10842 sample_num
```sql
SELECT major.major_name 
FROM member 
JOIN major ON member.link_to_major = major.major_id 
WHERE member.first_name = 'Phillip' AND member.last_name = 'Cullen';
```
-------------------------10843 sample_num
```sql
SELECT m.position 
FROM member m 
JOIN major j ON m.link_to_major = j.major_id 
WHERE j.major_name = 'Business';
```
-------------------------10844 sample_num
```sql
SELECT COUNT(*) 
FROM member 
JOIN major ON member.link_to_major = major.major_id 
WHERE major.major_name = 'Business' AND member.t_shirt_size = 'Medium';
```
-------------------------10845 sample_num
```sql
SELECT DISTINCT e.type
FROM event e
JOIN budget b ON e.event_id = b.link_to_event
WHERE b.remaining > 30;
```
-------------------------10846 sample_num
```sql
SELECT DISTINCT type 
FROM event 
WHERE location = 'MU 215';
```
-------------------------10847 sample_num
```sql
SELECT e.type 
FROM event e 
WHERE e.event_date = '2020-03-24T12:00:00';
```
-------------------------10848 sample_num
```sql
SELECT major.major_name 
FROM member 
JOIN major ON member.link_to_major = major.major_id 
WHERE member.position = 'Vice President';
```
-------------------------10849 sample_num
```sql
SELECT (SUM(CASE WHEN m.position = 'Member' AND maj.major_name = 'Mathematics' THEN 1 ELSE 0 END) * 100.0) / COUNT(m.member_id) AS percentage_mathematics_members
FROM member m
JOIN major maj ON m.link_to_major = maj.major_id;
```
-------------------------10850 sample_num
```sql
SELECT DISTINCT type 
FROM event 
WHERE location = 'MU 215';
```
-------------------------10851 sample_num
```sql
SELECT COUNT(*) FROM income WHERE amount = 50;
```
-------------------------10852 sample_num
```sql
SELECT COUNT(*) 
FROM member 
WHERE position = 'Member' AND t_shirt_size = 'X-Large';
```
-------------------------10853 sample_num
```sql
SELECT COUNT(*) 
FROM major 
WHERE department = 'School of Applied Sciences, Technology and Education' 
AND college = 'College of Agriculture and Applied Sciences';
```
-------------------------10854 sample_num
```sql
SELECT m.last_name, maj.department, maj.college
FROM member m
JOIN major maj ON m.link_to_major = maj.major_id
WHERE maj.major_name = 'Environmental Engineering';
```
-------------------------10855 sample_num
```sql
SELECT b.category
FROM event e
JOIN budget b ON e.event_id = b.link_to_event
WHERE e.location = 'MU 215' 
  AND e.type = 'Guest Speaker' 
  AND b.spent = 0;
```
-------------------------10856 sample_num
```sql
SELECT z.city, z.state
FROM member m
JOIN major maj ON m.link_to_major = maj.major_id
JOIN zip_code z ON m.zip = z.zip_code
WHERE maj.department = 'Electrical and Computer Engineering' AND m.position = 'Member';
```
-------------------------10857 sample_num
```sql
SELECT e.event_name 
FROM event e 
JOIN attendance a ON e.event_id = a.link_to_event 
JOIN member m ON a.link_to_member = m.member_id 
WHERE e.type = 'Social' 
AND m.position = 'Vice President' 
AND e.location = '900 E. Washington St.';
```
-------------------------10858 sample_num
```sql
SELECT m.last_name, m.position
FROM expense e
JOIN member m ON e.link_to_member = m.member_id
WHERE e.expense_description = 'Pizza' AND e.expense_date = '2019-09-10';
```
-------------------------10859 sample_num
```sql
SELECT m.last_name 
FROM member m
JOIN attendance a ON m.member_id = a.link_to_member
JOIN event e ON a.link_to_event = e.event_id
WHERE m.position = 'Member' AND e.event_name = 'Women\'s Soccer';
```
-------------------------10860 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN i.amount = 50 THEN 1 END) * 100.0 / COUNT(m.member_id)) AS percentage
FROM 
    member m
LEFT JOIN 
    income i ON m.member_id = i.link_to_member
WHERE 
    m.t_shirt_size = 'Medium' AND m.position = 'Member';
```
-------------------------10861 sample_num
```sql
SELECT DISTINCT state
FROM zip_code
WHERE type = 'PO Box';
```
-------------------------10862 sample_num
```sql
SELECT zip_code 
FROM zip_code 
WHERE type = 'PO Box' 
AND county = 'San Juan Municipio' 
AND state = 'Puerto Rico';
```
-------------------------10863 sample_num
```sql
SELECT event_name 
FROM event 
WHERE type = 'Game' 
AND status = 'Closed' 
AND event_date BETWEEN '2019-03-15' AND '2020-03-20';
```
-------------------------10864 sample_num
```sql
SELECT DISTINCT a.link_to_event
FROM attendance a
JOIN expense e ON a.link_to_member = e.link_to_member
WHERE e.cost > 50;
```
-------------------------10865 sample_num
```sql
SELECT m.member_id, m.first_name, m.last_name, a.link_to_event
FROM member m
JOIN expense e ON m.member_id = e.link_to_member
JOIN attendance a ON a.link_to_member = m.member_id
WHERE e.approved = 'true' 
AND e.expense_date BETWEEN '2019-01-10' AND '2019-11-19';
```
-------------------------10866 sample_num
```sql
SELECT major.college 
FROM member 
JOIN major ON member.link_to_major = major.major_id 
WHERE member.first_name = 'Katy' AND member.link_to_major = 'rec1N0upiVLy5esTO';
```
-------------------------10867 sample_num
```sql
SELECT m.phone 
FROM member m 
JOIN major j ON m.link_to_major = j.major_id 
WHERE j.major_name = 'Business' AND j.college = 'College of Agriculture and Applied Sciences';
```
-------------------------10868 sample_num
```sql
SELECT DISTINCT m.email
FROM income i
JOIN member m ON i.link_to_member = m.member_id
WHERE i.date_received BETWEEN '2019-09-10' AND '2019-11-19' AND i.amount > 20;
```
-------------------------10869 sample_num
```sql
SELECT COUNT(*) 
FROM member m 
JOIN major j ON m.link_to_major = j.major_id 
WHERE j.major_name = 'education' AND j.college = 'College of Education & Human Services';
```
-------------------------10870 sample_num
```sql
SELECT (SUM(CASE WHEN remaining < 0 THEN 1 ELSE 0 END) * 100.0 / COUNT(event_id)) AS percentage_over_budget
FROM budget;
```
-------------------------10871 sample_num
```sql
SELECT event_id, location, status 
FROM event 
WHERE event_date BETWEEN '2019-11-01' AND '2020-03-31';
```
-------------------------10872 sample_num
```sql
SELECT expense_description
FROM expense
GROUP BY expense_description
HAVING AVG(cost) > 50;
```
-------------------------10873 sample_num
```sql
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM member
WHERE t_shirt_size = 'X-Large';
```
-------------------------10874 sample_num
```sql
SELECT (SUM(CASE WHEN type = 'PO Box' THEN 1 ELSE 0 END) * 100.0 / COUNT(zip_code)) AS percentage_po_boxes
FROM zip_code;
```
-------------------------10875 sample_num
```sql
SELECT e.event_name, e.location
FROM event e
JOIN budget b ON e.event_id = b.link_to_event
WHERE b.remaining > 0;
```
-------------------------10876 sample_num
```sql
SELECT e.event_name, e.event_date
FROM event e
JOIN budget b ON e.event_id = b.link_to_event
JOIN expense ex ON b.budget_id = ex.link_to_budget
WHERE ex.expense_description = 'Pizza' AND ex.cost > 50 AND ex.cost < 100;
```
-------------------------10877 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name, maj.major_name
FROM member m
JOIN expense e ON m.member_id = e.link_to_member
JOIN major maj ON m.link_to_major = maj.major_id
WHERE e.cost > 100;
```
-------------------------10878 sample_num
```sql
SELECT z.city, z.county
FROM event e
JOIN income i ON e.event_id = i.link_to_event
JOIN zip_code z ON e.location = z.zip_code
GROUP BY e.event_id
HAVING COUNT(i.income_id) > 40;
```
-------------------------10879 sample_num
```sql
SELECT e.link_to_member, SUM(exp.cost) AS total_cost
FROM expense exp
JOIN attendance a ON exp.link_to_member = a.link_to_member
GROUP BY e.link_to_member
HAVING COUNT(DISTINCT a.link_to_event) > 1
ORDER BY total_cost DESC
LIMIT 1;
```
-------------------------10880 sample_num
```sql
SELECT AVG(cost) AS average_amount_paid
FROM expense e
JOIN member m ON e.link_to_member = m.member_id
WHERE m.position != 'Member';
```
-------------------------10881 sample_num
```sql
SELECT e.event_name
FROM event e
JOIN budget b ON e.event_id = b.link_to_event
WHERE b.category = 'Parking' AND b.spent < (SELECT AVG(spent) FROM budget WHERE category = 'Parking');
```
-------------------------10882 sample_num
```sql
SELECT 
    (SUM(e.cost) / COUNT(ev.event_id)) * 100 AS percentage_of_game_event_cost
FROM 
    event ev
JOIN 
    attendance a ON ev.event_id = a.link_to_event
JOIN 
    expense e ON a.link_to_member = e.link_to_member
WHERE 
    ev.type = 'Game';
```
-------------------------10883 sample_num
```sql
SELECT b.budget_id, MAX(e.cost) AS max_cost
FROM budget b
JOIN expense e ON b.budget_id = e.link_to_budget
WHERE e.expense_description = 'Water, chips, cookies'
GROUP BY b.budget_id
ORDER BY max_cost DESC
LIMIT 1;
```
-------------------------10884 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name, SUM(e.cost) AS total_spent
FROM member m
JOIN expense e ON m.member_id = e.link_to_member
GROUP BY m.member_id
ORDER BY total_spent DESC
LIMIT 5;
```
-------------------------10885 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name, m.phone
FROM member m
JOIN expense e ON m.member_id = e.link_to_member
GROUP BY m.member_id
HAVING SUM(e.cost) > (SELECT AVG(cost) FROM expense);
```
-------------------------10886 sample_num
```sql
SELECT 
    (SUM(CASE WHEN state = 'Maine' THEN 1 ELSE 0 END) * 100.0 / COUNT(CASE WHEN position = 'Member' THEN 1 END)) - 
    (SUM(CASE WHEN state = 'Vermont' THEN 1 ELSE 0 END) * 100.0 / COUNT(CASE WHEN position = 'Member' THEN 1 END)) AS percentage_difference
FROM member
JOIN zip_code ON member.zip = zip_code.zip_code;
```
-------------------------10887 sample_num
```sql
SELECT m.first_name, m.last_name, maj.major_name, maj.department
FROM member m
JOIN major maj ON m.link_to_major = maj.major_id
WHERE m.first_name = 'Garrett' AND m.last_name = 'Gerke';
```
-------------------------10888 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name, e.cost
FROM expense e
JOIN member m ON e.link_to_member = m.member_id
WHERE e.expense_description IN ('Water', 'Veggie tray', 'supplies');
```
-------------------------10889 sample_num
```sql
SELECT m.last_name, m.phone
FROM member m
JOIN major j ON m.link_to_major = j.major_id
WHERE j.major_name = 'Elementary Education';
```
-------------------------10890 sample_num
```sql
SELECT b.category, b.amount
FROM budget b
JOIN event e ON b.link_to_event = e.event_id
WHERE e.event_name = 'January Speaker';
```
-------------------------10891 sample_num
```sql
SELECT e.event_name 
FROM event e
JOIN budget b ON e.event_id = b.link_to_event
WHERE b.category = 'Food';
```
-------------------------10892 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name, i.amount
FROM income i
JOIN member m ON i.link_to_member = m.member_id
WHERE i.date_received = '2019-09-09';
```
-------------------------10893 sample_num
```sql
SELECT b.category 
FROM expense e 
JOIN budget b ON e.link_to_budget = b.budget_id 
WHERE e.expense_description = 'Posters';
```
-------------------------10894 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name, maj.college
FROM member m
JOIN major maj ON m.link_to_major = maj.major_id
WHERE m.position = 'Secretary';
```
-------------------------10895 sample_num
```sql
SELECT e.event_name, SUM(b.spent) AS total_spent
FROM budget b
JOIN event e ON b.link_to_event = e.event_id
WHERE b.category = 'Speaker Gifts'
GROUP BY e.event_name;
```
-------------------------10896 sample_num
```sql
SELECT z.city 
FROM member m 
JOIN zip_code z ON m.zip = z.zip_code 
WHERE m.first_name = 'Garrett' AND m.last_name = 'Girke';
```
-------------------------10897 sample_num
```sql
SELECT CONCAT(m.first_name, ' ', m.last_name) AS full_name, m.position
FROM member m
JOIN zip_code z ON m.zip = z.zip_code
WHERE z.city = 'Lincolnton' AND z.state = 'North Carolina';
```
-------------------------10898 sample_num
```sql
SELECT COUNT(*) 
FROM gasstations g 
JOIN products p ON g.GasStationID = p.ProductID 
WHERE g.Country = 'CZE' AND p.Description = 'Premium gas';
```
-------------------------10899 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM customers WHERE Currency = 'EUR') * 1.0 / 
    (SELECT COUNT(*) FROM customers WHERE Currency = 'CZK') AS ratio
```
-------------------------10900 sample_num
```sql
SELECT CustomerID, SUM(Consumption) AS TotalConsumption
FROM yearmonth
WHERE Date BETWEEN 201201 AND 201212
AND CustomerID IN (SELECT CustomerID FROM customers WHERE Segment = 'LAM')
GROUP BY CustomerID
ORDER BY TotalConsumption ASC
LIMIT 1;
```
-------------------------10901 sample_num
```sql
SELECT AVG(Consumption) / 12 AS AverageMonthlyConsumption
FROM yearmonth
WHERE CustomerID IN (
    SELECT CustomerID
    FROM customers
    WHERE Segment = 'SME'
)
AND Date BETWEEN 201301 AND 201312;
```
-------------------------10902 sample_num
```sql
SELECT c.CustomerID, SUM(t.Amount) AS TotalGas
FROM customers c
JOIN transactions_1k t ON c.CustomerID = t.CustomerID
WHERE c.Currency = 'CZK' AND t.Date BETWEEN 201101 AND 201112
GROUP BY c.CustomerID
ORDER BY TotalGas DESC
LIMIT 1;
```
-------------------------10903 sample_num
```sql
SELECT COUNT(DISTINCT y.CustomerID) 
FROM yearmonth y 
JOIN customers c ON y.CustomerID = c.CustomerID 
WHERE c.Segment = 'KAM' 
AND y.Consumption < 30000 
AND y.Date BETWEEN 201201 AND 201212;
```
-------------------------10904 sample_num
```sql
SELECT 
    (SELECT SUM(Consumption) 
     FROM yearmonth 
     WHERE CustomerID IN (SELECT CustomerID FROM customers WHERE Currency = 'CZK') 
     AND Date BETWEEN 201201 AND 201212) - 
    (SELECT SUM(Consumption) 
     FROM yearmonth 
     WHERE CustomerID IN (SELECT CustomerID FROM customers WHERE Currency = 'EUR') 
     AND Date BETWEEN 201201 AND 201212) AS ConsumptionDifference;
```
-------------------------10905 sample_num
```sql
SELECT YEAR(t.Date) AS Year, SUM(t.Amount) AS TotalGasUse
FROM transactions_1k t
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.Currency = 'EUR'
GROUP BY YEAR(t.Date)
ORDER BY TotalGasUse DESC
LIMIT 1;
```
-------------------------10906 sample_num
```sql
SELECT Segment, SUM(Consumption) AS TotalConsumption
FROM customers c
JOIN yearmonth y ON c.CustomerID = y.CustomerID
GROUP BY Segment
ORDER BY TotalConsumption ASC
LIMIT 1;
```
-------------------------10907 sample_num
```sql
SELECT SUBSTRING(Date, 1, 4) AS Year, SUM(Consumption) AS TotalConsumption
FROM yearmonth
JOIN customers ON yearmonth.CustomerID = customers.CustomerID
WHERE customers.Currency = 'CZK'
GROUP BY Year
ORDER BY TotalConsumption DESC
LIMIT 1;
```
-------------------------10908 sample_num
```sql
SELECT YEAR(Date) AS Year, MONTH(Date) AS Month, SUM(Consumption) AS TotalConsumption
FROM yearmonth
JOIN customers ON yearmonth.CustomerID = customers.CustomerID
WHERE customers.Segment = 'SME' AND YEAR(Date) = 2013
GROUP BY Year, Month
ORDER BY TotalConsumption DESC
LIMIT 1;
```
-------------------------10909 sample_num
```sql
WITH AnnualConsumption AS (
    SELECT 
        c.Segment,
        SUM(ym.Consumption) AS TotalConsumption,
        COUNT(DISTINCT c.CustomerID) AS CustomerCount
    FROM 
        customers c
    JOIN 
        yearmonth ym ON c.CustomerID = ym.CustomerID
    WHERE 
        ym.Date BETWEEN 201301 AND 201312
        AND c.Currency = 'CZK'
    GROUP BY 
        c.Segment
),
LowestConsumption AS (
    SELECT 
        Segment,
        TotalConsumption / CustomerCount AS AnnualAverage
    FROM 
        AnnualConsumption
    WHERE 
        TotalConsumption = (SELECT MIN(TotalConsumption) FROM AnnualConsumption AS ac WHERE ac.Segment = AnnualConsumption.Segment)
)
SELECT 
    (SELECT AnnualAverage FROM LowestConsumption WHERE Segment = 'SME') - 
    (SELECT AnnualAverage FROM LowestConsumption WHERE Segment = 'LAM') AS SME_LAM_Difference,
    (SELECT AnnualAverage FROM LowestConsumption WHERE Segment = 'LAM') - 
    (SELECT AnnualAverage FROM LowestConsumption WHERE Segment = 'KAM') AS LAM_KAM_Difference,
    (SELECT AnnualAverage FROM LowestConsumption WHERE Segment = 'KAM') - 
    (SELECT AnnualAverage FROM LowestConsumption WHERE Segment = 'SME') AS KAM_SME_Difference
```
-------------------------10910 sample_num
```sql
WITH ConsumptionData AS (
    SELECT 
        c.Segment,
        SUM(CASE WHEN ym.Date BETWEEN '201201' AND '201212' THEN ym.Consumption ELSE 0 END) AS Consumption_2012,
        SUM(CASE WHEN ym.Date BETWEEN '201301' AND '201312' THEN ym.Consumption ELSE 0 END) AS Consumption_2013
    FROM 
        yearmonth ym
    JOIN 
        customers c ON ym.CustomerID = c.CustomerID
    WHERE 
        c.Currency = 'EUR'
    GROUP BY 
        c.Segment
),
PercentageChange AS (
    SELECT 
        Segment,
        Consumption_2012,
        Consumption_2013,
        (Consumption_2013 - Consumption_2012) AS Increase,
        (CASE 
            WHEN Consumption_2013 != 0 THEN (Consumption_2013 - Consumption_2012) / Consumption_2013 * 100 
            ELSE NULL 
        END) AS Percentage_Increase
    FROM 
        ConsumptionData
)
SELECT 
    Segment,
    Percentage_Increase
FROM 
    PercentageChange
ORDER BY 
    Percentage_Increase ASC;
```
-------------------------10911 sample_num
```sql
SELECT SUM(Amount) AS TotalConsumption
FROM transactions_1k
WHERE CustomerID = 6 AND Date BETWEEN '20130801' AND '20131130';
```
-------------------------10912 sample_num
```sql
SELECT 
    (SELECT COUNT(*) FROM gasstations WHERE Country = 'Czech Republic' AND Segment = 'discount') -
    (SELECT COUNT(*) FROM gasstations WHERE Country = 'Slovakia' AND Segment = 'discount') AS More_Discount_Gas_Stations;
```
-------------------------10913 sample_num
```sql
SELECT 
    (SELECT Consumption FROM yearmonth WHERE CustomerID = 7 AND Date = 201304) - 
    (SELECT Consumption FROM yearmonth WHERE CustomerID = 5 AND Date = 201304) AS ConsumptionDifference;
```
-------------------------10914 sample_num
```sql
SELECT 
    (SELECT COUNT(DISTINCT t.CustomerID) 
     FROM transactions_1k t 
     JOIN customers c ON t.CustomerID = c.CustomerID 
     WHERE c.Segment = 'SME' AND c.Currency = 'CZK') -
    (SELECT COUNT(DISTINCT t.CustomerID) 
     FROM transactions_1k t 
     JOIN customers c ON t.CustomerID = c.CustomerID 
     WHERE c.Segment = 'SME' AND c.Currency = 'EUR') AS Difference
```
-------------------------10915 sample_num
```sql
SELECT c.CustomerID, y.Consumption
FROM customers c
JOIN yearmonth y ON c.CustomerID = y.CustomerID
WHERE c.Segment = 'LAM' 
  AND c.Currency = 'Euro' 
  AND y.Date = 201310
ORDER BY y.Consumption DESC
LIMIT 1;
```
-------------------------10916 sample_num
```sql
SELECT c.CustomerID, SUM(t.Amount) AS TotalConsumption
FROM customers c
JOIN transactions_1k t ON c.CustomerID = t.CustomerID
WHERE c.Segment = 'KAM'
GROUP BY c.CustomerID
ORDER BY TotalConsumption DESC
LIMIT 1;
```
-------------------------10917 sample_num
```sql
SELECT SUM(t.Amount) AS TotalConsumption
FROM transactions_1k t
JOIN customers c ON t.CustomerID = c.CustomerID
JOIN yearmonth ym ON c.CustomerID = ym.CustomerID
WHERE c.Segment = 'KAM' AND ym.Date = 201305;
```
-------------------------10918 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN Consumption > 46.73 THEN 1 END) * 100.0 / COUNT(*)) AS Percentage
FROM 
    customers c
JOIN 
    yearmonth ym ON c.CustomerID = ym.CustomerID
WHERE 
    c.Segment = 'LAM';
```
-------------------------10919 sample_num
```sql
SELECT g.Country, COUNT(*) AS ValueForMoneyGasStations
FROM gasstations g
WHERE g.Segment = 'value for money'
GROUP BY g.Country;
```
-------------------------10920 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.Currency = 'EUR' THEN 1 END) * 100.0 / COUNT(*)) AS Percentage_KAM_Euros
FROM 
    customers c
WHERE 
    c.Segment = 'KAM';
```
-------------------------10921 sample_num
```sql
SELECT 
    (COUNT(DISTINCT y.CustomerID) * 100.0 / (SELECT COUNT(DISTINCT CustomerID) FROM yearmonth WHERE Date = '201202')) AS Percentage
FROM 
    yearmonth y
WHERE 
    y.Date = '201202' AND y.Consumption > 528.3;
```
-------------------------10922 sample_num
```sql
SELECT (COUNT(CASE WHEN Segment = 'premium' THEN 1 END) * 100.0 / COUNT(*)) AS PremiumPercentage
FROM gasstations
WHERE Country = 'Slovakia';
```
-------------------------10923 sample_num
```sql
SELECT CustomerID
FROM yearmonth
WHERE Date = '201309'
ORDER BY Consumption DESC
LIMIT 1;
```
-------------------------10924 sample_num
```sql
SELECT c.Segment, SUM(ym.Consumption) AS TotalConsumption
FROM yearmonth ym
JOIN customers c ON ym.CustomerID = c.CustomerID
WHERE ym.Date = '201309'
GROUP BY c.Segment
ORDER BY TotalConsumption ASC
LIMIT 1;
```
-------------------------10925 sample_num
```sql
SELECT c.CustomerID, SUM(ym.Consumption) AS TotalConsumption
FROM customers c
JOIN yearmonth ym ON c.CustomerID = ym.CustomerID
WHERE c.Segment = 'SME' AND ym.Date = '201206'
GROUP BY c.CustomerID
ORDER BY TotalConsumption ASC
LIMIT 1;
```
-------------------------10926 sample_num
```sql
SELECT MAX(Consumption) AS HighestMonthlyConsumption
FROM yearmonth
WHERE SUBSTR(Date, 1, 4) = '2012';
```
-------------------------10927 sample_num
```sql
SELECT MAX(MonthlyConsumption) AS BiggestMonthlyConsumption
FROM (
    SELECT SUM(Consumption) / 12 AS MonthlyConsumption
    FROM yearmonth ym
    JOIN customers c ON ym.CustomerID = c.CustomerID
    WHERE c.Currency = 'euro'
    GROUP BY ym.CustomerID
) AS MonthlyConsumptions;
```
-------------------------10928 sample_num
```sql
SELECT p.Description
FROM transactions_1k t
JOIN products p ON t.ProductID = p.ProductID
WHERE t.Date LIKE '201309%';
```
-------------------------10929 sample_num
```sql
SELECT DISTINCT g.Country
FROM gasstations g
JOIN transactions_1k t ON g.GasStationID = t.GasStationID
WHERE t.Date LIKE '201306%';
```
-------------------------10930 sample_num
```sql
SELECT DISTINCT gs.ChainID
FROM gasstations gs
JOIN transactions_1k t ON gs.GasStationID = t.GasStationID
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.Currency = 'euro';
```
-------------------------10931 sample_num
```sql
SELECT p.Description
FROM transactions_1k t
JOIN customers c ON t.CustomerID = c.CustomerID
JOIN products p ON t.ProductID = p.ProductID
WHERE c.Currency = 'EUR';
```
-------------------------10932 sample_num
```sql
SELECT AVG(Price) AS AverageTotalPrice
FROM transactions_1k
WHERE Date LIKE '2012-01%';
```
-------------------------10933 sample_num
```sql
SELECT COUNT(DISTINCT c.CustomerID) 
FROM customers c 
JOIN yearmonth ym ON c.CustomerID = ym.CustomerID 
WHERE c.Currency = 'euro' AND ym.Consumption > 1000;
```
-------------------------10934 sample_num
```sql
SELECT p.Description
FROM transactions_1k t
JOIN gasstations g ON t.GasStationID = g.GasStationID
JOIN products p ON t.ProductID = p.ProductID
WHERE g.Country = 'CZE';
```
-------------------------10935 sample_num
```sql
SELECT DISTINCT t.Time
FROM transactions_1k t
JOIN gasstations g ON t.GasStationID = g.GasStationID
WHERE g.ChainID = 11;
```
-------------------------10936 sample_num
```sql
SELECT COUNT(*) 
FROM transactions_1k t
JOIN gasstations g ON t.GasStationID = g.GasStationID
WHERE g.Country = 'CZE' AND t.Price > 1000;
```
-------------------------10937 sample_num
```sql
SELECT COUNT(*) 
FROM transactions_1k t
JOIN gasstations g ON t.GasStationID = g.GasStationID
WHERE g.Country = 'CZE' AND t.Date > '2012-01-01';
```
-------------------------10938 sample_num
```sql
SELECT AVG(Price) AS AverageTotalPrice
FROM transactions_1k t
JOIN gasstations g ON t.GasStationID = g.GasStationID
WHERE g.Country = 'CZE';
```
-------------------------10939 sample_num
```sql
SELECT AVG(TotalPrice) AS AverageTotalPrice
FROM (
    SELECT CustomerID, SUM(Price) AS TotalPrice
    FROM transactions_1k
    WHERE CustomerID IN (
        SELECT CustomerID
        FROM customers
        WHERE Currency = 'euro'
    )
    GROUP BY CustomerID
) AS CustomerTotals;
```
-------------------------10940 sample_num
```sql
SELECT CustomerID, SUM(Amount) AS TotalPaid
FROM transactions_1k
WHERE Date = '2012-08-25'
GROUP BY CustomerID
ORDER BY TotalPaid DESC
LIMIT 1;
```
-------------------------10941 sample_num
```sql
SELECT g.Country
FROM transactions_1k t
JOIN gasstations g ON t.GasStationID = g.GasStationID
WHERE t.Date = '2012-08-25'
ORDER BY t.Time
LIMIT 1;
```
-------------------------10942 sample_num
```sql
SELECT c.Currency 
FROM transactions_1k t 
JOIN customers c ON t.CustomerID = c.CustomerID 
WHERE t.Time = '16:25:00' AND t.Date = '2012-08-24';
```
-------------------------10943 sample_num
```sql
SELECT c.Segment 
FROM customers c
JOIN transactions_1k t ON c.CustomerID = t.CustomerID
WHERE t.Date = '2012-08-23' AND t.Time = '21:20:00';
```
-------------------------10944 sample_num
```sql
SELECT COUNT(*) 
FROM transactions_1k t
JOIN customers c ON t.CustomerID = c.CustomerID
WHERE c.Currency = 'EUR' 
AND t.Date = '2012-08-26' 
AND t.Time < '13:00:00';
```
-------------------------10945 sample_num
```sql
SELECT Segment 
FROM customers 
WHERE CustomerID = (SELECT CustomerID FROM customers ORDER BY CustomerID LIMIT 1);
```
-------------------------10946 sample_num
```sql
SELECT g.Country 
FROM transactions_1k t 
JOIN gasstations g ON t.GasStationID = g.GasStationID 
WHERE t.Date = '2012-08-24' AND t.Time = '12:42:00';
```
-------------------------10947 sample_num
```sql
SELECT ProductID 
FROM transactions_1k 
WHERE Date = '2012-08-23' AND Time = '21:20:00';
```
-------------------------10948 sample_num
```sql
SELECT Date, SUM(Amount) AS TotalSpent
FROM transactions_1k
WHERE CustomerID = (
    SELECT CustomerID
    FROM transactions_1k
    WHERE Amount = 124.05 AND Date = '2012-08-24'
) AND Date >= '2012-01-01' AND Date < '2012-02-01'
GROUP BY Date;
```
-------------------------10949 sample_num
```sql
SELECT COUNT(*) 
FROM transactions_1k t
JOIN gasstations g ON t.GasStationID = g.GasStationID
WHERE g.Country = 'CZE' 
AND t.Date = '2012-08-26' 
AND t.Time BETWEEN '08:00:00' AND '09:00:00';
```
-------------------------10950 sample_num
```sql
SELECT c.Currency 
FROM customers c 
JOIN transactions_1k t ON c.CustomerID = t.CustomerID 
JOIN yearmonth ym ON c.CustomerID = ym.CustomerID 
WHERE ym.Date LIKE '201306%' 
AND t.Amount = 214582.17 
LIMIT 1;
```
-------------------------10951 sample_num
```sql
SELECT g.Country 
FROM transactions_1k t 
JOIN gasstations g ON t.GasStationID = g.GasStationID 
WHERE t.CardID = 667467;
```
-------------------------10952 sample_num
```sql
SELECT c.Country 
FROM customers c 
JOIN transactions_1k t ON c.CustomerID = t.CustomerID 
JOIN gasstations g ON t.GasStationID = g.GasStationID 
WHERE t.Amount = 548.4 AND t.Date = '2012-08-24';
```
-------------------------10953 sample_num
```sql
SELECT 
    (COUNT(DISTINCT t.CustomerID) * 100.0 / (SELECT COUNT(DISTINCT CustomerID) FROM customers WHERE Currency = 'EUR')) AS Percentage
FROM 
    transactions_1k t
JOIN 
    customers c ON t.CustomerID = c.CustomerID
WHERE 
    c.Currency = 'EUR' AND t.Date = '2012-08-25';
```
-------------------------10954 sample_num
```sql
SELECT 
    (y1.Consumption - y2.Consumption) / y1.Consumption AS ConsumptionDecreaseRate
FROM 
    transactions_1k t
JOIN 
    yearmonth y1 ON t.CustomerID = y1.CustomerID AND y1.Date = '2012-08-25'
JOIN 
    yearmonth y2 ON t.CustomerID = y2.CustomerID AND y2.Date = '2013-08-25'
WHERE 
    t.Amount = 634.8 AND 
    t.Date = '2012-08-25';
```
-------------------------10955 sample_num
```sql
SELECT GasStationID, SUM(Amount) AS TotalRevenue
FROM transactions_1k
GROUP BY GasStationID
ORDER BY TotalRevenue DESC
LIMIT 1;
```
-------------------------10956 sample_num
```sql
SELECT 
    (COUNT(CASE WHEN c.Segment = 'premium' THEN 1 END) * 100.0 / COUNT(*)) AS premium_percentage
FROM 
    customers c
JOIN 
    gasstations g ON c.CustomerID = g.Segment
WHERE 
    g.Country = 'SVK';
```
-------------------------10957 sample_num
```sql
SELECT 
    SUM(Amount) AS TotalSpent,
    (SELECT SUM(Amount) 
     FROM transactions_1k 
     WHERE CustomerID = '38508' AND Date = '201201') AS January2012Spent
FROM 
    transactions_1k 
WHERE 
    CustomerID = '38508';
```
-------------------------10958 sample_num
```sql
SELECT p.Description, SUM(t.Amount) AS TotalSales
FROM transactions_1k t
JOIN products p ON t.ProductID = p.ProductID
GROUP BY p.Description
ORDER BY TotalSales DESC
LIMIT 5;
```
-------------------------10959 sample_num
```sql
SELECT 
    c.CustomerID, 
    AVG(t.Price / t.Amount) AS AveragePricePerItem, 
    c.Currency
FROM 
    transactions_1k t
JOIN 
    customers c ON t.CustomerID = c.CustomerID
GROUP BY 
    c.CustomerID
ORDER BY 
    SUM(t.Price) DESC
LIMIT 1;
```
-------------------------10960 sample_num
```sql
SELECT g.Country
FROM gasstations g
JOIN transactions_1k t ON g.GasStationID = t.GasStationID
WHERE t.ProductID = 2
ORDER BY t.Price DESC
LIMIT 1;
```
-------------------------10961 sample_num
```sql
SELECT y.CustomerID, y.Consumption
FROM transactions_1k t
JOIN yearmonth y ON t.CustomerID = y.CustomerID
WHERE t.ProductID = 5 
  AND t.Price / t.Amount > 29.00 
  AND y.Date LIKE '201208%';
```
